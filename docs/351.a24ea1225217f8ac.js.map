{"version":3,"file":"351.a24ea1225217f8ac.js","mappings":"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","names":["TGraph2DPainter","ObjectPainter","decodeOptions","opt","gr","d","DrawOptions","this","options","res","Color","check","Line","Error","matchObjectType","Circles","Markers","fMarkerSize","fMarkerStyle","storeDrawOpt","createHistogram","getObject","asymm","xmin","fX","xmax","ymin","fY","ymax","zmin","fZ","zmax","p","fNpoints","x","y","z","Math","min","fEXlow","fEX","max","fEXhigh","fEYlow","fEY","fEYhigh","fEZlow","fEZ","fEZhigh","dx","dy","dz","uxmin","uxmax","uymin","uymax","uzmin","uzmax","graph","fMinimum","kNoZoom","fMaximum","histo","fName","fTitle","fXaxis","fXmin","fXmax","fYaxis","fZaxis","kNoStats","BIT","fBits","graph2DTooltip","intersect","Number","isInteger","index","console","error","REVISION","indx","floor","nvertex","length","sqr","v","painter","grx","gry","grz","check_next","point","grx1","gry1","grz1","x1","scale0","x2","y1","y2","z1","z2","color","tip_color","lines","tip_name","axisAsText","redraw","main","_this","getMainPainter","fp","getFramePainter","step","mode3d","countSelected","cnt","i","scale_xmin","scale_xmax","scale_ymin","scale_ymax","settings","webgl","numselected","scale_zmin","scale_zmax","sizelimit","markeratt","TAttMarkerHandler","palette","levels","scale","size_x3d","getFullSize","promises","usesvg","getContourLevels","getHistPalette","lvl","lvl_zmin","lvl_zmax","size","pnts","select","Int32Array","icnt","err","line","ierr","iline","PointsCreator","Float32Array","addPoint","lcolor","getColor","fLineColor","material","LineBasicMaterial","linewidth","fLineWidth","linemesh","createLineSegments","toplevel","add","getObjectHint","fMarkerColor","tooltip","errmesh","fcolor","calcColor","pr","createPoints","style","then","mesh","push","Promise","all","render3D","static","dom","promise","resolve","fHistogram","TH2Painter","ownhisto","addToPadPrimitives"],"sourceRoot":"webpack:///","sources":["../node_modules/jsroot/modules/hist/TGraph2DPainter.mjs"],"sourcesContent":["import { BIT, settings, createHistogram, kNoZoom } from '../core.mjs';\nimport { REVISION, Color, LineBasicMaterial } from '../three.mjs';\nimport { DrawOptions } from '../base/BasePainter.mjs';\nimport { ObjectPainter } from '../base/ObjectPainter.mjs';\nimport { TAttMarkerHandler } from '../base/TAttMarkerHandler.mjs';\nimport { TH2Painter } from './TH2Painter.mjs';\nimport { createLineSegments, PointsCreator } from '../base/base3d.mjs';\n\n/**\n * @summary Painter for TGraph2D classes\n * @private\n */\n\nclass TGraph2DPainter extends ObjectPainter {\n\n   /** @summary Decode options string  */\n   decodeOptions(opt, gr) {\n      let d = new DrawOptions(opt);\n\n      if (!this.options)\n         this.options = {};\n\n      let res = this.options;\n\n      res.Color = d.check('COL');\n      res.Line = d.check('LINE');\n      res.Error = d.check('ERR') && (this.matchObjectType('TGraph2DErrors') || this.matchObjectType('TGraph2DAsymmErrors'));\n      res.Circles = d.check('P0');\n      res.Markers = d.check('P');\n\n      if (!res.Markers && !res.Error && !res.Circles && !res.Line) {\n         if ((gr.fMarkerSize == 1) && (gr.fMarkerStyle == 1))\n            res.Circles = true;\n         else\n            res.Markers = true;\n      }\n      if (!res.Markers) res.Color = false;\n\n      this.storeDrawOpt(opt);\n   }\n\n   /** @summary Create histogram for axes drawing */\n   createHistogram() {\n      let gr = this.getObject(),\n          asymm = this.matchObjectType('TGraph2DAsymmErrors'),\n          xmin = gr.fX[0], xmax = xmin,\n          ymin = gr.fY[0], ymax = ymin,\n          zmin = gr.fZ[0], zmax = zmin;\n\n      for (let p = 0; p < gr.fNpoints;++p) {\n\n         let x = gr.fX[p], y = gr.fY[p], z = gr.fZ[p];\n\n         if (this.options.Error) {\n            xmin = Math.min(xmin, x - (asymm ? gr.fEXlow[p] : gr.fEX[p]));\n            xmax = Math.max(xmax, x + (asymm ? gr.fEXhigh[p] : gr.fEX[p]));\n            ymin = Math.min(ymin, y - (asymm ? gr.fEYlow[p] : gr.fEY[p]));\n            ymax = Math.max(ymax, y + (asymm ? gr.fEYhigh[p] : gr.fEY[p]));\n            zmin = Math.min(zmin, z - (asymm ? gr.fEZlow[p] : gr.fEZ[p]));\n            zmax = Math.max(zmax, z + (asymm ? gr.fEZhigh[p] : gr.fEZ[p]));\n         } else {\n            xmin = Math.min(xmin, x);\n            xmax = Math.max(xmax, x);\n            ymin = Math.min(ymin, y);\n            ymax = Math.max(ymax, y);\n            zmin = Math.min(zmin, z);\n            zmax = Math.max(zmax, z);\n         }\n      }\n\n      if (xmin >= xmax) xmax = xmin+1;\n      if (ymin >= ymax) ymax = ymin+1;\n      if (zmin >= zmax) zmax = zmin+1;\n      let dx = (xmax-xmin)*0.02, dy = (ymax-ymin)*0.02, dz = (zmax-zmin)*0.02,\n          uxmin = xmin - dx, uxmax = xmax + dx,\n          uymin = ymin - dy, uymax = ymax + dy,\n          uzmin = zmin - dz, uzmax = zmax + dz;\n\n      if ((uxmin < 0) && (xmin >= 0)) uxmin = xmin*0.98;\n      if ((uxmax > 0) && (xmax <= 0)) uxmax = 0;\n\n      if ((uymin < 0) && (ymin >= 0)) uymin = ymin*0.98;\n      if ((uymax > 0) && (ymax <= 0)) uymax = 0;\n\n      if ((uzmin < 0) && (zmin >= 0)) uzmin = zmin*0.98;\n      if ((uzmax > 0) && (zmax <= 0)) uzmax = 0;\n\n      let graph = this.getObject();\n\n      if (graph.fMinimum != kNoZoom) uzmin = graph.fMinimum;\n      if (graph.fMaximum != kNoZoom) uzmax = graph.fMaximum;\n\n      let histo = createHistogram('TH2I', 10, 10);\n      histo.fName = graph.fName + '_h';\n      histo.fTitle = graph.fTitle;\n      histo.fXaxis.fXmin = uxmin;\n      histo.fXaxis.fXmax = uxmax;\n      histo.fYaxis.fXmin = uymin;\n      histo.fYaxis.fXmax = uymax;\n      histo.fZaxis.fXmin = uzmin;\n      histo.fZaxis.fXmax = uzmax;\n      histo.fMinimum = uzmin;\n      histo.fMaximum = uzmax;\n      let kNoStats = BIT(9);\n      histo.fBits = histo.fBits | kNoStats;\n      return histo;\n   }\n\n   /** @summary Function handles tooltips in the mesh */\n   graph2DTooltip(intersect) {\n      if (!Number.isInteger(intersect.index)) {\n         console.error(`intersect.index not provided, three.js version ${REVISION}`);\n         return null;\n      }\n\n      let indx = Math.floor(intersect.index / this.nvertex);\n      if ((indx < 0) || (indx >= this.index.length)) return null;\n      let sqr = v => v*v;\n\n      indx = this.index[indx];\n\n      let p = this.painter, gr = this.graph,\n          grx = p.grx(gr.fX[indx]),\n          gry = p.gry(gr.fY[indx]),\n          grz = p.grz(gr.fZ[indx]);\n\n      if (this.check_next && indx+1<gr.fX.length) {\n         let d = intersect.point,\n             grx1 = p.grx(gr.fX[indx+1]),\n             gry1 = p.gry(gr.fY[indx+1]),\n             grz1 = p.grz(gr.fZ[indx+1]);\n         if (sqr(d.x-grx1)+sqr(d.y-gry1)+sqr(d.z-grz1) < sqr(d.x-grx)+sqr(d.y-gry)+sqr(d.z-grz)) {\n            grx = grx1; gry = gry1; grz = grz1; indx++;\n         }\n      }\n\n      return {\n         x1: grx - this.scale0,\n         x2: grx + this.scale0,\n         y1: gry - this.scale0,\n         y2: gry + this.scale0,\n         z1: grz - this.scale0,\n         z2: grz + this.scale0,\n         color: this.tip_color,\n         lines: [ this.tip_name,\n                  'pnt: ' + indx,\n                  'x: ' + p.axisAsText('x', gr.fX[indx]),\n                  'y: ' + p.axisAsText('y', gr.fY[indx]),\n                  'z: ' + p.axisAsText('z', gr.fZ[indx])\n                ]\n      };\n   }\n\n   /** @summary Actual drawing of TGraph2D object\n     * @return {Promise} for drawing ready */\n   async redraw() {\n\n      let main = this.getMainPainter(),\n          fp = this.getFramePainter(),\n          graph = this.getObject(),\n          step = 1;\n\n      if (!graph || !main || !fp || !fp.mode3d)\n         return this;\n\n      let countSelected = (zmin, zmax) => {\n         let cnt = 0;\n         for (let i = 0; i < graph.fNpoints; ++i) {\n            if ((graph.fX[i] < fp.scale_xmin) || (graph.fX[i] > fp.scale_xmax) ||\n                (graph.fY[i] < fp.scale_ymin) || (graph.fY[i] > fp.scale_ymax) ||\n                (graph.fZ[i] < zmin) || (graph.fZ[i] >= zmax)) continue;\n\n            ++cnt;\n         }\n         return cnt;\n      };\n\n      // try to define scale-down factor\n      if ((settings.OptimizeDraw > 0) && !fp.webgl) {\n         let numselected = countSelected(fp.scale_zmin, fp.scale_zmax),\n             sizelimit = 50000;\n\n         if (numselected > sizelimit) {\n            step = Math.floor(numselected / sizelimit);\n            if (step <= 2) step = 2;\n         }\n      }\n\n      let markeratt = new TAttMarkerHandler(graph),\n          palette = null,\n          levels = [fp.scale_zmin, fp.scale_zmax],\n          scale = fp.size_x3d / 100 * markeratt.getFullSize(),\n          promises = [];\n\n      if (this.options.Circles) scale = 0.06*fp.size_x3d;\n\n      if (fp.usesvg) scale *= 0.3;\n\n      if (this.options.Color) {\n         levels = main.getContourLevels();\n         palette = main.getHistPalette();\n      }\n\n      for (let lvl = 0; lvl < levels.length-1; ++lvl) {\n\n         let lvl_zmin = Math.max(levels[lvl], fp.scale_zmin),\n             lvl_zmax = Math.min(levels[lvl+1], fp.scale_zmax);\n\n         if (lvl_zmin >= lvl_zmax) continue;\n\n         let size = Math.floor(countSelected(lvl_zmin, lvl_zmax) / step),\n             pnts = null, select = 0,\n             index = new Int32Array(size), icnt = 0,\n             err = null, asymm = false, line = null, ierr = 0, iline = 0;\n\n         if (this.options.Markers || this.options.Circles)\n            pnts = new PointsCreator(size, fp.webgl, scale/3);\n\n         if (this.options.Error) {\n            err = new Float32Array(size*6*3);\n            asymm = this.matchObjectType('TGraph2DAsymmErrors');\n          }\n\n         if (this.options.Line)\n            line = new Float32Array((size-1)*6);\n\n         for (let i = 0; i < graph.fNpoints; ++i) {\n            if ((graph.fX[i] < fp.scale_xmin) || (graph.fX[i] > fp.scale_xmax) ||\n                (graph.fY[i] < fp.scale_ymin) || (graph.fY[i] > fp.scale_ymax) ||\n                (graph.fZ[i] < lvl_zmin) || (graph.fZ[i] >= lvl_zmax)) continue;\n\n            if (step > 1) {\n               select = (select+1) % step;\n               if (select !== 0) continue;\n            }\n\n            index[icnt++] = i; // remember point index for tooltip\n\n            let x = fp.grx(graph.fX[i]),\n                y = fp.gry(graph.fY[i]),\n                z = fp.grz(graph.fZ[i]);\n\n            if (pnts) pnts.addPoint(x,y,z);\n\n            if (err) {\n               err[ierr]   = fp.grx(graph.fX[i] - (asymm ? graph.fEXlow[i] : graph.fEX[i]));\n               err[ierr+1] = y;\n               err[ierr+2] = z;\n               err[ierr+3] = fp.grx(graph.fX[i] + (asymm ? graph.fEXhigh[i] : graph.fEX[i]));\n               err[ierr+4] = y;\n               err[ierr+5] = z;\n               ierr+=6;\n               err[ierr]   = x;\n               err[ierr+1] = fp.gry(graph.fY[i] - (asymm ? graph.fEYlow[i] : graph.fEY[i]));\n               err[ierr+2] = z;\n               err[ierr+3] = x;\n               err[ierr+4] = fp.gry(graph.fY[i] + (asymm ? graph.fEYhigh[i] : graph.fEY[i]));\n               err[ierr+5] = z;\n               ierr+=6;\n               err[ierr]   = x;\n               err[ierr+1] = y;\n               err[ierr+2] = fp.grz(graph.fZ[i] - (asymm ? graph.fEZlow[i] : graph.fEZ[i]));\n               err[ierr+3] = x;\n               err[ierr+4] = y;\n               err[ierr+5] = fp.grz(graph.fZ[i] + (asymm ? graph.fEZhigh[i] : graph.fEZ[i]));\n               ierr+=6;\n            }\n\n            if (line) {\n               if (iline>=6) {\n                  line[iline] = line[iline-3];\n                  line[iline+1] = line[iline-2];\n                  line[iline+2] = line[iline-1];\n                  iline+=3;\n               }\n               line[iline] = x;\n               line[iline+1] = y;\n               line[iline+2] = z;\n               iline+=3;\n            }\n         }\n\n         if (line && (iline > 3) && (line.length == iline)) {\n            let lcolor = this.getColor(graph.fLineColor),\n                material = new LineBasicMaterial({ color: new Color(lcolor), linewidth: graph.fLineWidth }),\n                linemesh = createLineSegments(line, material);\n            fp.toplevel.add(linemesh);\n\n            linemesh.graph = graph;\n            linemesh.index = index;\n            linemesh.painter = fp;\n            linemesh.scale0 = 0.7*scale;\n            linemesh.tip_name = this.getObjectHint();\n            linemesh.tip_color = (graph.fMarkerColor === 3) ? 0xFF0000 : 0x00FF00;\n            linemesh.nvertex = 2;\n            linemesh.check_next = true;\n\n            linemesh.tooltip = this.graph2DTooltip;\n         }\n\n         if (err) {\n            let lcolor = this.getColor(graph.fLineColor),\n                material = new LineBasicMaterial({ color: new Color(lcolor), linewidth: graph.fLineWidth }),\n                errmesh = createLineSegments(err, material);\n            fp.toplevel.add(errmesh);\n\n            errmesh.graph = graph;\n            errmesh.index = index;\n            errmesh.painter = fp;\n            errmesh.scale0 = 0.7*scale;\n            errmesh.tip_name = this.getObjectHint();\n            errmesh.tip_color = (graph.fMarkerColor === 3) ? 0xFF0000 : 0x00FF00;\n            errmesh.nvertex = 6;\n\n            errmesh.tooltip = this.graph2DTooltip;\n         }\n\n         if (pnts) {\n            let fcolor = 'blue';\n\n            if (!this.options.Circles)\n               fcolor = palette ? palette.calcColor(lvl, levels.length)\n                                : this.getColor(graph.fMarkerColor);\n\n            let pr = pnts.createPoints({ color: fcolor, style: this.options.Circles ? 4 : graph.fMarkerStyle }).then(mesh => {\n               mesh.graph = graph;\n               mesh.painter = fp;\n               mesh.tip_color = (graph.fMarkerColor === 3) ? 0xFF0000 : 0x00FF00;\n               mesh.scale0 = 0.3*scale;\n               mesh.index = index;\n\n               mesh.tip_name = this.getObjectHint();\n               mesh.tooltip = this.graph2DTooltip;\n               fp.toplevel.add(mesh);\n            });\n\n            promises.push(pr);\n         }\n      }\n\n      return Promise.all(promises).then(() => {\n         fp.render3D(100);\n         return this;\n      });\n   }\n\n   /** @summary draw TGraph2D object */\n   static async draw(dom, gr, opt) {\n      let painter = new TGraph2DPainter(dom, gr);\n      painter.decodeOptions(opt, gr);\n\n      let promise = Promise.resolve(true);\n\n      if (!painter.getMainPainter()) {\n         if (!gr.fHistogram)\n            gr.fHistogram = painter.createHistogram();\n         promise = TH2Painter.draw(dom, gr.fHistogram, 'lego;axis');\n         painter.ownhisto = true;\n      }\n\n      return promise.then(() => {\n         painter.addToPadPrimitives();\n         return painter.redraw();\n      });\n   }\n\n} // class TGraph2DPainter\n\nexport { TGraph2DPainter };\n"],"x_google_ignoreList":[0]}