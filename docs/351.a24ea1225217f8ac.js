"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[351],{7351:(H,Y,T)=>{T.r(Y),T.d(Y,{TGraph2DPainter:()=>w});var j=T(5835),Z=T(9542),v=T(9900),A=T(3675),L=T(6458),b=T(6417),F=T(8189),k=T(1968);class w extends L.tK{decodeOptions(i,a){let t=new A.pc(i);this.options||(this.options={});let e=this.options;e.Color=t.check("COL"),e.Line=t.check("LINE"),e.Error=t.check("ERR")&&(this.matchObjectType("TGraph2DErrors")||this.matchObjectType("TGraph2DAsymmErrors")),e.Circles=t.check("P0"),e.Markers=t.check("P"),!e.Markers&&!e.Error&&!e.Circles&&!e.Line&&(1==a.fMarkerSize&&1==a.fMarkerStyle?e.Circles=!0:e.Markers=!0),e.Markers||(e.Color=!1),this.storeDrawOpt(i)}createHistogram(){let i=this.getObject(),a=this.matchObjectType("TGraph2DAsymmErrors"),t=i.fX[0],e=t,n=i.fY[0],p=n,c=i.fZ[0],x=c;for(let s=0;s<i.fNpoints;++s){let m=i.fX[s],o=i.fY[s],h=i.fZ[s];this.options.Error?(t=Math.min(t,m-(a?i.fEXlow[s]:i.fEX[s])),e=Math.max(e,m+(a?i.fEXhigh[s]:i.fEX[s])),n=Math.min(n,o-(a?i.fEYlow[s]:i.fEY[s])),p=Math.max(p,o+(a?i.fEYhigh[s]:i.fEY[s])),c=Math.min(c,h-(a?i.fEZlow[s]:i.fEZ[s])),x=Math.max(x,h+(a?i.fEZhigh[s]:i.fEZ[s]))):(t=Math.min(t,m),e=Math.max(e,m),n=Math.min(n,o),p=Math.max(p,o),c=Math.min(c,h),x=Math.max(x,h))}t>=e&&(e=t+1),n>=p&&(p=n+1),c>=x&&(x=c+1);let _=.02*(e-t),M=.02*(p-n),X=.02*(x-c),g=t-_,u=e+_,C=n-M,d=p+M,z=c-X,O=x+X;g<0&&t>=0&&(g=.98*t),u>0&&e<=0&&(u=0),C<0&&n>=0&&(C=.98*n),d>0&&p<=0&&(d=0),z<0&&c>=0&&(z=.98*c),O>0&&x<=0&&(O=0);let P=this.getObject();P.fMinimum!=Z.kNoZoom&&(z=P.fMinimum),P.fMaximum!=Z.kNoZoom&&(O=P.fMaximum);let E=(0,Z.createHistogram)("TH2I",10,10);E.fName=P.fName+"_h",E.fTitle=P.fTitle,E.fXaxis.fXmin=g,E.fXaxis.fXmax=u,E.fYaxis.fXmin=C,E.fYaxis.fXmax=d,E.fZaxis.fXmin=z,E.fZaxis.fXmax=O,E.fMinimum=z,E.fMaximum=O;let f=(0,Z.BIT)(9);return E.fBits=E.fBits|f,E}graph2DTooltip(i){if(!Number.isInteger(i.index))return console.error(`intersect.index not provided, three.js version ${v.UZH}`),null;let a=Math.floor(i.index/this.nvertex);if(a<0||a>=this.index.length)return null;let t=_=>_*_;a=this.index[a];let e=this.painter,n=this.graph,p=e.grx(n.fX[a]),c=e.gry(n.fY[a]),x=e.grz(n.fZ[a]);if(this.check_next&&a+1<n.fX.length){let _=i.point,M=e.grx(n.fX[a+1]),X=e.gry(n.fY[a+1]),g=e.grz(n.fZ[a+1]);t(_.x-M)+t(_.y-X)+t(_.z-g)<t(_.x-p)+t(_.y-c)+t(_.z-x)&&(p=M,c=X,x=g,a++)}return{x1:p-this.scale0,x2:p+this.scale0,y1:c-this.scale0,y2:c+this.scale0,z1:x-this.scale0,z2:x+this.scale0,color:this.tip_color,lines:[this.tip_name,"pnt: "+a,"x: "+e.axisAsText("x",n.fX[a]),"y: "+e.axisAsText("y",n.fY[a]),"z: "+e.axisAsText("z",n.fZ[a])]}}redraw(){var i=this;return(0,j.Z)(function*(){let a=i.getMainPainter(),t=i.getFramePainter(),e=i.getObject(),n=1;if(!(e&&a&&t&&t.mode3d))return i;let p=(g,u)=>{let C=0;for(let d=0;d<e.fNpoints;++d)e.fX[d]<t.scale_xmin||e.fX[d]>t.scale_xmax||e.fY[d]<t.scale_ymin||e.fY[d]>t.scale_ymax||e.fZ[d]<g||e.fZ[d]>=u||++C;return C};if(Z.settings.OptimizeDraw>0&&!t.webgl){let g=p(t.scale_zmin,t.scale_zmax),u=5e4;g>u&&(n=Math.floor(g/u),n<=2&&(n=2))}let c=new b.M(e),x=null,_=[t.scale_zmin,t.scale_zmax],M=t.size_x3d/100*c.getFullSize(),X=[];i.options.Circles&&(M=.06*t.size_x3d),t.usesvg&&(M*=.3),i.options.Color&&(_=a.getContourLevels(),x=a.getHistPalette());for(let g=0;g<_.length-1;++g){let u=Math.max(_[g],t.scale_zmin),C=Math.min(_[g+1],t.scale_zmax);if(u>=C)continue;let d=Math.floor(p(u,C)/n),z=null,O=0,P=new Int32Array(d),E=0,f=null,s=!1,m=null,o=0,h=0;(i.options.Markers||i.options.Circles)&&(z=new k.B_(d,t.webgl,M/3)),i.options.Error&&(f=new Float32Array(6*d*3),s=i.matchObjectType("TGraph2DAsymmErrors")),i.options.Line&&(m=new Float32Array(6*(d-1)));for(let r=0;r<e.fNpoints;++r){if(e.fX[r]<t.scale_xmin||e.fX[r]>t.scale_xmax||e.fY[r]<t.scale_ymin||e.fY[r]>t.scale_ymax||e.fZ[r]<u||e.fZ[r]>=C||n>1&&(O=(O+1)%n,0!==O))continue;P[E++]=r;let y=t.grx(e.fX[r]),l=t.gry(e.fY[r]),D=t.grz(e.fZ[r]);z&&z.addPoint(y,l,D),f&&(f[o]=t.grx(e.fX[r]-(s?e.fEXlow[r]:e.fEX[r])),f[o+1]=l,f[o+2]=D,f[o+3]=t.grx(e.fX[r]+(s?e.fEXhigh[r]:e.fEX[r])),f[o+4]=l,f[o+5]=D,o+=6,f[o]=y,f[o+1]=t.gry(e.fY[r]-(s?e.fEYlow[r]:e.fEY[r])),f[o+2]=D,f[o+3]=y,f[o+4]=t.gry(e.fY[r]+(s?e.fEYhigh[r]:e.fEY[r])),f[o+5]=D,o+=6,f[o]=y,f[o+1]=l,f[o+2]=t.grz(e.fZ[r]-(s?e.fEZlow[r]:e.fEZ[r])),f[o+3]=y,f[o+4]=l,f[o+5]=t.grz(e.fZ[r]+(s?e.fEZhigh[r]:e.fEZ[r])),o+=6),m&&(h>=6&&(m[h]=m[h-3],m[h+1]=m[h-2],m[h+2]=m[h-1],h+=3),m[h]=y,m[h+1]=l,m[h+2]=D,h+=3)}if(m&&h>3&&m.length==h){let r=i.getColor(e.fLineColor),y=new v.nls({color:new v.Ilk(r),linewidth:e.fLineWidth}),l=(0,k.Qy)(m,y);t.toplevel.add(l),l.graph=e,l.index=P,l.painter=t,l.scale0=.7*M,l.tip_name=i.getObjectHint(),l.tip_color=3===e.fMarkerColor?16711680:65280,l.nvertex=2,l.check_next=!0,l.tooltip=i.graph2DTooltip}if(f){let r=i.getColor(e.fLineColor),y=new v.nls({color:new v.Ilk(r),linewidth:e.fLineWidth}),l=(0,k.Qy)(f,y);t.toplevel.add(l),l.graph=e,l.index=P,l.painter=t,l.scale0=.7*M,l.tip_name=i.getObjectHint(),l.tip_color=3===e.fMarkerColor?16711680:65280,l.nvertex=6,l.tooltip=i.graph2DTooltip}if(z){let r="blue";i.options.Circles||(r=x?x.calcColor(g,_.length):i.getColor(e.fMarkerColor));let y=z.createPoints({color:r,style:i.options.Circles?4:e.fMarkerStyle}).then(l=>{l.graph=e,l.painter=t,l.tip_color=3===e.fMarkerColor?16711680:65280,l.scale0=.3*M,l.index=P,l.tip_name=i.getObjectHint(),l.tooltip=i.graph2DTooltip,t.toplevel.add(l)});X.push(y)}}return Promise.all(X).then(()=>(t.render3D(100),i))})()}static draw(i,a,t){return(0,j.Z)(function*(){let e=new w(i,a);e.decodeOptions(t,a);let n=Promise.resolve(!0);return e.getMainPainter()||(a.fHistogram||(a.fHistogram=e.createHistogram()),n=F.TH2Painter.draw(i,a.fHistogram,"lego;axis"),e.ownhisto=!0),n.then(()=>(e.addToPadPrimitives(),e.redraw()))})()}}}}]);
//# sourceMappingURL=351.a24ea1225217f8ac.js.map