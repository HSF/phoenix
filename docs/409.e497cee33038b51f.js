"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[409],{4409:(F,A,w)=>{w.r(A),w.d(A,{RHistStatsPainter:()=>b,RLegendPainter:()=>E,RPavePainter:()=>P,RPaveTextPainter:()=>T});var u=w(5072),v=w(8872),S=w(2843),C=w(1985),y=w(9964),R=w(5638),O=w(7900);class P extends C.D{drawContent(){var t=this;return(0,u.A)(function*(){return t})()}drawPave(){var t=this;return(0,u.A)(function*(){const e=t.getPadPainter().getPadRect(),i=t.getFramePainter();t.onFrame=i&&t.v7EvalAttr("onFrame",!0),t.corner=t.v7EvalAttr("corner",2);const a=t.v7EvalAttr("visible",!0),n=t.v7EvalLength("offsetX",e.width,.02),f=t.v7EvalLength("offsetY",e.height,.02),h=t.v7EvalLength("width",e.width,.3),r=t.v7EvalLength("height",e.height,.3);if(t.createG(),t.draw_g.classed("most_upper_primitives",!0),!a)return t;t.createv7AttLine("border_"),t.createv7AttFill();const s=t.onFrame?i.getFrameRect():e;let o=0,g=0;switch(t.corner){case 1:o=s.x+n,g=s.y+f;break;case 3:o=s.x+n,g=s.y+s.height-f-r;break;case 4:o=s.x+s.width-n-h,g=s.y+s.height-f-r;break;default:o=s.x+s.width-n-h,g=s.y+f}return(0,S.bk)(t.draw_g,o,g),t.draw_g.append("svg:rect").attr("x",0).attr("width",h).attr("y",0).attr("height",r).call(t.lineatt.func).call(t.fillatt.func),t.pave_width=h,t.pave_height=r,t.drawContent().then(()=>(t.isBatchMode()||(v.settings.ContextMenu&&t.paveContextMenu&&t.draw_g.on("contextmenu",c=>t.paveContextMenu(c)),(0,R.WJ)(t,{x:o,y:g,width:h,height:r,minwidth:20,minheight:20,redraw:c=>t.sizeChanged(c)})),t))})()}sizeChanged(t){this.pave_width=t.width,this.pave_height=t.height;const e=t.x,i=t.y,a=this.getPadPainter().getPadRect(),n=this.onFrame?this.getFramePainter().getFrameRect():a,f={};let h=0,r=0;switch(this.corner){case 1:h=e-n.x,r=i-n.y;break;case 3:h=e-n.x,r=n.y+n.height-i-this.pave_height;break;case 4:h=n.x+n.width-e-this.pave_width,r=n.y+n.height-i-this.pave_height;break;default:h=n.x+n.width-e-this.pave_width,r=i-n.y}this.v7AttrChange(f,"offsetX",h/a.width),this.v7AttrChange(f,"offsetY",r/a.height),this.v7AttrChange(f,"width",this.pave_width/a.width),this.v7AttrChange(f,"height",this.pave_height/a.height),this.v7SendAttrChanges(f,!1),this.draw_g.selectChild("rect").attr("width",this.pave_width).attr("height",this.pave_height),this.drawContent()}redraw(){var t=this;return(0,u.A)(function*(){return t.drawPave()})()}static draw(t,e,i){return(0,u.A)(function*(){const a=new P(t,e,i,"pave");return(0,y.ensureRCanvas)(a,!1).then(()=>a.drawPave())})()}}class E extends P{drawContent(){var t=this;return(0,u.A)(function*(){const e=t.getObject(),i=t.v7EvalFont("text",{size:12,color:"black",align:22}),a=t.pave_width,n=t.pave_height,f=t.getPadPainter();let h=e.fEntries.length;if(e.fTitle&&h++,!h||!f)return t;const r=n/h,s=.02*a;return i.setSize(n/(1.2*h)),t.startTextDrawingAsync(i,"font").then(()=>{let o=0;e.fTitle&&(t.drawText({latex:1,width:a-2*s,height:r,x:s,y:o,text:e.fTitle}),o+=r);for(let g=0;g<e.fEntries.length;++g){const c=e.fEntries[g],_=Math.round(a/4);let l=null;t.drawText({latex:1,width:.75*a-3*s,height:r,x:2*s+_,y:o,text:c.fLabel}),"custom"!==c.fDrawableId?l=f.findSnap(c.fDrawableId,!0):c.fDrawable.fIO&&(l=new C.D(t.getPadPainter(),c.fDrawable.fIO),c.fLine&&l.createv7AttLine(),c.fFill&&l.createv7AttFill(),c.fMarker&&l.createv7AttMarker()),c.fFill&&l?.fillatt&&t.draw_g.append("svg:path").attr("d",`M${Math.round(s)},${Math.round(o+.1*r)}h${_}v${Math.round(.8*r)}h${-_}z`).call(l.fillatt.func),c.fLine&&l?.lineatt&&t.draw_g.append("svg:path").attr("d",`M${Math.round(s)},${Math.round(o+r/2)}h${_}`).call(l.lineatt.func),c.fError&&l?.lineatt&&t.draw_g.append("svg:path").attr("d",`M${Math.round(s+a/8)},${Math.round(o+.2*r)}v${Math.round(.6*r)}`).call(l.lineatt.func),c.fMarker&&l?.markeratt&&t.draw_g.append("svg:path").attr("d",l.markeratt.create(s+a/8,o+r/2)).call(l.markeratt.func),o+=r}return t.finishTextDrawing()})})()}static draw(t,e,i){return(0,u.A)(function*(){const a=new E(t,e,i,"legend");return(0,y.ensureRCanvas)(a,!1).then(()=>a.drawPave())})()}}class T extends P{drawContent(){var t=this;return(0,u.A)(function*(){const e=t.getObject(),i=t.v7EvalFont("text",{size:12,color:"black",align:22}),a=t.pave_width,n=t.pave_height,f=e.fText.length;if(!f)return;const h=n/f,r=.02*a;return i.setSize(n/(1.2*f)),t.startTextDrawingAsync(i,"font").then(()=>{for(let s=0,o=0;s<e.fText.length;++s,o+=h)t.drawText({latex:1,width:a-2*r,height:h,x:r,y:o,text:e.fText[s]});return t.finishTextDrawing(void 0,!0)})})()}static draw(t,e,i){return(0,u.A)(function*(){const a=new T(t,e,i,"pavetext");return(0,y.ensureRCanvas)(a,!1).then(()=>a.drawPave())})()}}class b extends P{clearStat(){this.stats_lines=[]}addText(t){this.stats_lines.push(t)}updateStatistic(t){this.stats_lines=t.lines,this.drawStatistic(this.stats_lines)}fillStatistic(){if(this.getPadPainter()?._fast_drawing)return!1;const e=this.getObject();if(void 0!==e.fLines)return this.stats_lines=e.fLines,delete e.fLines,!0;if(this.v7OfflineMode()){const i=this.getMainPainter();return!!(0,v.isFunc)(i?.fillStatistic)&&i.fillStatistic(this,v.gStyle.fOptStat,v.gStyle.fOptFit)}return void 0!==this.stats_lines}format(t,e){switch(e||(e="stat"),e){case"stat":e=v.gStyle.fStatFormat;break;case"fit":e=v.gStyle.fFitFormat;break;case"entries":if(Math.abs(t)<1e9&&Math.round(t)===t)return t.toFixed(0);e="14.7g";break;case"last":e=this.lastformat}const i=(0,S.lg)(t,e||"6.4g",!0);return this.lastformat=i[1],i[0]}drawContent(){var t=this;return(0,u.A)(function*(){return t.fillStatistic()?t.drawStatistic(t.stats_lines):t})()}changeMask(t){const e=this.getObject(),i=1<<t;e.fShowMask=e.fShowMask&i?e.fShowMask&~i:e.fShowMask|i,this.fillStatistic()&&this.drawStatistic(this.stats_lines)}statsContextMenu(t){t.preventDefault(),t.stopPropagation(),(0,O.ES)(t,this).then(e=>{const i=this.getObject(),a=this.changeMask.bind(this);e.header("Stat Box");for(let n=0;n<i.fEntries.length;++n)e.addchk(i.fShowMask&1<<n,i.fEntries[n],n,a);return this.fillObjectExecMenu(e)}).then(e=>e.show())}drawStatistic(t){var e=this;return(0,u.A)(function*(){if(!t)return e;const i=e.v7EvalFont("stats_text",{size:12,color:"black",align:22}),a=e.pave_width,n=e.pave_height,f=t.length;let h=0,r=0,s=0;for(let l=0;l<f;++l){const d=t[l];if(l>0&&(s=Math.max(s,d.length)),0===l||d.indexOf("|")<0)continue;0===h&&(h=l);const k=d.split("|");k.length>r&&(r=k.length)}const o=n/f,g=.02*a;let c=!1,_=e.draw_g.selectChild(".statlines");return _.empty()?_=e.draw_g.append("svg:g").attr("class","statlines"):_.selectAll("*").remove(),i.setSize(n/(1.2*f)),e.startTextDrawingAsync(i,"font",_).then(()=>{if(1===f)e.drawText({width:a,height:n,text:t[0],latex:1,draw_g:_});else for(let d=0;d<f;++d){const k=d*o;if(h&&d>=h){const m=t[d].split("|");for(let x=0;x<m.length;++x)e.drawText({align:"middle",x:a*x/r,y:k,latex:0,width:a/r,height:o,text:m[x],draw_g:_})}else if(t[d].indexOf("=")<0){if(0===d){c=!0;const m=Math.max(s,Math.round((a-2*g)/o/.65));t[d].length>m+5&&(t[d]=t[d].slice(0,m+2)+"...")}e.drawText({align:0===d?"middle":"start",x:g,y:k,width:a-2*g,height:o,text:t[d],draw_g:_})}else{const m=t[d].split("="),x=[];for(let M=0;M<2;++M)x.push({align:0===M?"start":"end",x:g,y:k,width:a-2*g,height:o,text:m[M],draw_g:_,_expected_width:a-2*g,_args:x,post_process(L){this._args[0].ready&&this._args[1].ready&&L.scaleTextDrawing(1.05*(this._args[0].result_width&&this._args[1].result_width)/this.__expected_width,this.draw_g)}});for(let M=0;M<2;++M)e.drawText(x[M])}}let l="";if(c&&(l+="M0,"+Math.round(o)+"h"+a),h>0&&r>1){for(let d=h;d<f;++d)l+="M0,"+Math.round(d*o)+"h"+a;for(let d=0;d<r-1;++d)l+="M"+Math.round(a/r*(d+1))+","+Math.round(h*o)+"V"+n}return l&&e.draw_g.append("svg:path").attr("d",l),e.finishTextDrawing(_)})})()}redraw(t){var e=this;return(0,u.A)(function*(){if(t&&(0,v.isStr)(t)&&0===t.indexOf("zoom")&&e.v7NormalMode()){const i={_typename:`${v.nsREX}RHistStatBoxBase::RRequest`,mask:e.getObject().fShowMask};e.v7SubmitRequest("stat",i,a=>e.updateStatistic(a))}return e.drawPave()})()}static draw(t,e,i){return(0,u.A)(function*(){const a=new b(t,e,i,e);return(0,y.ensureRCanvas)(a,!1).then(()=>a.drawPave())})()}}}}]);
//# sourceMappingURL=409.e497cee33038b51f.js.map