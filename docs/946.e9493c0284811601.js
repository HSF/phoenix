"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[946],{8946:(D,y,o)=>{o.r(y),o.d(y,{TEfficiencyPainter:()=>E});var H=o(4788),l=o(9542),M=o(6458),p=o(8241),x=o(9428),A=o(7823),C=o(6976);const T=(0,l.BIT)(14),L=(0,l.BIT)(15),B=(0,l.BIT)(17),w=(0,l.BIT)(18),m=(c,t)=>c.fBeta_bin_params.length>t?c.fBeta_bin_params[t].first:c.fBeta_alpha,u=(c,t)=>c.fBeta_bin_params.length>t?c.fBeta_bin_params[t].second:c.fBeta_beta;class E extends M.tK{getEfficiency(t,a){let f=t.fTotalHistogram.fArray[a],n=t.fPassedHistogram.fArray[a];if(t.TestBit(T)){let _,h,e=t.TestBit(B)?m(t,a):t.fBeta_alpha,r=t.TestBit(B)?u(t,a):t.fBeta_beta;if(t.TestBit(w)){let g=f,P=t.fTotalHistogram.fSumw2?t.fTotalHistogram.fSumw2[a]:Math.abs(f);if(P<=0)return n/g;let O=g/P;_=n*O+e,h=(g-n)*O+r}else _=n+e,h=f-n+r;return t.TestBit(L)?((e,r)=>{if(e<=0||r<=0)return 0;if(e<=1||r<=1){if(e<r)return 0;if(e>r)return 1;if(e==r)return.5}return(e-1)/(e+r-2)})(_,h):((e,r)=>e<=0||r<=0?0:e/(e+r))(_,h)}return f?n/f:0}getEfficiencyErrorLow(t,a,i){let s=t.fTotalHistogram.fArray[a],f=t.fPassedHistogram.fArray[a],n=0,e=0;return t.TestBit(T)&&(n=t.TestBit(B)?m(t,a):t.fBeta_alpha,e=t.TestBit(B)?u(t,a):t.fBeta_beta),i-this.fBoundary(s,f,t.fConfLevel,!1,n,e)}getEfficiencyErrorUp(t,a,i){let s=t.fTotalHistogram.fArray[a],f=t.fPassedHistogram.fArray[a],n=0,e=0;return t.TestBit(T)&&(n=t.TestBit(B)?m(t,a):t.fBeta_alpha,e=t.TestBit(B)?u(t,a):t.fBeta_beta),this.fBoundary(s,f,t.fConfLevel,!0,n,e)-i}copyAttributes(t,a){["fLineColor","fLineStyle","fLineWidth","fFillColor","fFillStyle","fMarkerColor","fMarkerStyle","fMarkerSize"].forEach(i=>t[i]=a[i])}createGraph(){let t=(0,l.create)(p.clTGraphAsymmErrors);return t.fName="eff_graph",t}createHisto(t){const s=(0,l.createHistogram)("TH2F",t.fTotalHistogram.fXaxis.fNbins,t.fTotalHistogram.fYaxis.fNbins);return Object.assign(s.fXaxis,t.fTotalHistogram.fXaxis),Object.assign(s.fYaxis,t.fTotalHistogram.fYaxis),s.fName="eff_histo",s}fillGraph(t,a){const i=this.getObject(),s=i.fTotalHistogram.fXaxis,f=s.fNbins,n=a.indexOf("e0")>=0;for(let e=0,r=0;e<f;++e){if(!n&&0===i.fTotalHistogram.getBinContent(e+1))continue;let _=this.getEfficiency(i,e+1);t.fX[r]=s.GetBinCenter(e+1),t.fY[r]=_,t.fEXlow[r]=s.GetBinCenter(e+1)-s.GetBinLowEdge(e+1),t.fEXhigh[r]=s.GetBinLowEdge(e+2)-s.GetBinCenter(e+1),t.fEYlow[r]=this.getEfficiencyErrorLow(i,e+1,_),t.fEYhigh[r]=this.getEfficiencyErrorUp(i,e+1,_),t.fNpoints=++r}t.fTitle=i.fTitle,this.copyAttributes(t,i)}fillHisto(t){const a=this.getObject(),i=t.fXaxis.fNbins,s=t.fYaxis.fNbins,f=(0,l.BIT)(9);for(let n=0;n<i+2;++n)for(let e=0;e<s+2;++e){let r=t.getBin(n,e),_=this.getEfficiency(a,r);t.fArray[r]=_}t.fTitle=a.fTitle,t.fBits=t.fBits|f,this.copyAttributes(t,a)}drawFunction(t){const a=this.getObject();return!a||!a.fFunctions||t>=a.fFunctions.arr.length?this:x.TF1Painter.draw(this.getDom(),a.fFunctions.arr[t],a.fFunctions.opt[t]).then(()=>this.drawFunction(t+1))}static draw(t,a,i){return(0,H.Z)(function*(){if(!a||!a.fTotalHistogram)return null;(!i||!(0,l.isStr)(i))&&(i=""),i=i.toLowerCase();let s=0;if(0==a.fTotalHistogram._typename.indexOf(l.clTH1))s=1;else{if(0!=a.fTotalHistogram._typename.indexOf(l.clTH2))return null;s=2}let n,f=new E(t,a);if(f.ndim=s,f.fBoundary=(0,C.getTEfficiencyBoundaryFunc)(a.fStatisticOption,a.TestBit(T)),1==s){i||(i="ap"),i.indexOf("same")<0&&i.indexOf("a")<0&&(i+="a"),i.indexOf("p")<0&&(i+="p");let e=f.createGraph(a);f.fillGraph(e,i),n=p.TGraphPainter.draw(t,e,i)}else{i||(i="col");let e=f.createHisto(a);f.fillHisto(e,i),n=A.S.draw(t,e,i)}return n.then(()=>(f.addToPadPrimitives(),f.drawFunction(0)))})()}}}}]);
//# sourceMappingURL=946.e9493c0284811601.js.map