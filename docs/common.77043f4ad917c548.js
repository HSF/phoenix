"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[76],{4755:(O,v,o)=>{o.r(v),o.d(v,{TLinePainter:()=>y});var p=o(5774),x=o(4186),E=o(2481),M=o(2725),P=o(9606),l=o(9646);const r=(0,x.BIT)(14);class y extends E.JW{moveStart(n,i){const t=Math.sqrt((this.x1-this.x2)**2+(this.y1-this.y2)**2),e=Math.sqrt((n-this.x1)**2+(i-this.y1)**2)/t,a=Math.sqrt((n-this.x2)**2+(i-this.y2)**2)/t;this.side=e>.9?1:a>.9?-1:0}moveDrag(n,i){1!==this.side&&(this.x1+=n,this.y1+=i),-1!==this.side&&(this.x2+=n,this.y2+=i),this.draw_g.select("path").attr("d",this.createPath())}moveEnd(n){if(n)return;const i=this.getObject();let t="";i.fX1=this.svgToAxis("x",this.x1,this.isndc),i.fX2=this.svgToAxis("x",this.x2,this.isndc),i.fY1=this.svgToAxis("y",this.y1,this.isndc),i.fY2=this.svgToAxis("y",this.y2,this.isndc),1!==this.side&&(t+=`SetX1(${i.fX1});;SetY1(${i.fY1});;`),-1!==this.side&&(t+=`SetX2(${i.fX2});;SetY2(${i.fY2});;`),this.submitCanvExec(t+"Notify();;")}prepareDraw(){const n=this.getObject();this.isndc=n.TestBit(r);const i=this.getAxisToSvgFunc(this.isndc,!0,!0);this.x1=i.x(n.fX1),this.y1=i.y(n.fY1),this.x2=i.x(n.fX2),this.y2=i.y(n.fY2),this.createAttLine({attr:n})}createPath(){const n=Math.round(this.x1),i=Math.round(this.x2),t=Math.round(this.y1),e=Math.round(this.y2);return`M${n},${t}`+(n===i?`V${e}`:t===e?`H${i}`:`L${i},${e}`)}addExtras(){}redraw(){this.createG(),this.prepareDraw();const n=this.draw_g.append("svg:path").attr("d",this.createPath()).call(this.lineatt.func);return this.getObject()?.$do_not_draw?n.remove():(this.addExtras(n),(0,P.X2)(this),(0,l.wh)(this,l.Ew)),this}static draw(n,i,t){return(0,p.A)(function*(){const e=new y(n,i,t);return(0,M.ensureTCanvas)(e,!1).then(()=>e.redraw())})()}}},3873:(O,v,o)=>{o.d(v,{Y:()=>M});var p=o(5774),x=o(4186),E=o(2009);function M(){return P.apply(this,arguments)}function P(){return(P=(0,p.A)(function*(){const l=this.$fp||this.getFramePainter();if(delete this.$fp,!((0,x.isObject)(l)&&l.grx&&l.gry&&l.grz))return this;const r=this.getObject(),_=r.fP;let n=1,i=0;for(let s=0;s<_.length;s+=3)_[s]<l.scale_xmin||_[s]>l.scale_xmax||_[s+1]<l.scale_ymin||_[s+1]>l.scale_ymax||_[s+2]<l.scale_zmin||_[s+2]>l.scale_zmax||++i;x.settings.OptimizeDraw>0&&i>5e4&&(n=Math.floor(i/5e4),n<=2&&(n=2));const t=Math.floor(i/n),e=new E._l(t,l.webgl,l.size_x3d/100),a=new Int32Array(t);let c=0,h=0;for(let s=0;s<_.length;s+=3)_[s]<l.scale_xmin||_[s]>l.scale_xmax||_[s+1]<l.scale_ymin||_[s+1]>l.scale_ymax||_[s+2]<l.scale_zmin||_[s+2]>l.scale_zmax||n>1&&(c=(c+1)%n,0!==c)||(a[h++]=s,e.addPoint(l.grx(_[s]),l.gry(_[s+1]),l.grz(_[s+2])));return e.createPoints({color:this.getColor(r.fMarkerColor),style:r.fMarkerStyle}).then(s=>(s.tip_color=3===r.fMarkerColor?16711680:65280,s.tip_name=r.fName||"Poly3D",s.poly=r,s.fp=l,s.scale0=.7*e.scale,s.index=a,l.add3DMesh(s,this,!0),s.tooltip=function(d){let f=Math.floor(d.index/this.nvertex);if(f<0||f>=this.index.length)return null;f=this.index[f];const g=this.fp,D=g.grx(this.poly.fP[f]),m=g.gry(this.poly.fP[f+1]),u=g.grz(this.poly.fP[f+2]);return{x1:D-this.scale0,x2:D+this.scale0,y1:m-this.scale0,y2:m+this.scale0,z1:u-this.scale0,z2:u+this.scale0,color:this.tip_color,lines:[this.tip_name,"pnt: "+f/3,"x: "+g.axisAsText("x",this.poly.fP[f]),"y: "+g.axisAsText("y",this.poly.fP[f+1]),"z: "+g.axisAsText("z",this.poly.fP[f+2])]}},l.render3D(100),this))})).apply(this,arguments)}},9754:(O,v,o)=>{o.r(v),o.d(v,{TF1Painter:()=>n,produceTAxisLogScale:()=>y,scanTF1Options:()=>_});var p=o(5774),x=o(4186),E=o(165),M=o(2481),P=o(2105),l=o(1194),r=o(9489);function y(i,t,e,a){let c,h;a>0?(h=Math.log(a),c=e>0?Math.log(e):h-5):(h=-10,c=-15),i.fNbins=t,i.fXbins=new Array(t+1);for(let s=0;s<=t;++s)i.fXbins[s]=Math.exp(c+s/t*(h-c));i.fXmin=Math.exp(c),i.fXmax=Math.exp(h)}function _(i){(0,x.isStr)(i)||(i="");let t=i.indexOf(";webcanv_hist"),e=!1,a=0;return t>=0&&(e=!0,i=i.slice(0,t)),t=i.indexOf(";force_saved"),t>=0&&(a=2,i=i.slice(0,t)),t=i.indexOf(";prefer_saved"),t>=0&&(a=1,i=i.slice(0,t)),{opt:i,webcanv_hist:e,use_saved:a}}class n extends l.N{getObjectName(){return this.$func?.fName??"func"}getClassName(){return this.$func?._typename??x.clTF1}isTF1(){return!0}getPrimaryObject(){return this.$func}updateObject(t){if(!t||this.getClassName()!==t._typename)return!1;delete t.evalPar;const e=this.getHisto();if(this.webcanv_hist){const a=this.getPadPainter()?.findInPrimitives("Func",x.clTH1D);a&&this.updateAxes(e,a,this.getFramePainter())}return this.$func=t,this.createTF1Histogram(t,e),this.scanContent(),!0}redraw(t){return!this._use_saved_points&&("logx"===t||"zoom"===t)&&(this.createTF1Histogram(this.$func,this.getHisto()),this.scanContent()),super.redraw(t)}createTF1Histogram(t,e){const a=this.getFramePainter(),c=this.getPadPainter()?.getRootPad(!0),h=c?.fLogx,s=a?.getGrFuncs(this.second_x,this.second_y);let d=t.fXmin,f=t.fXmax,g=Math.max(t.fNpx,100);if(s?.zoom_xmin!==s?.zoom_xmax){const m=(f-d)/g;d<s.zoom_xmin&&s.zoom_xmin<f&&(d=Math.max(d,s.zoom_xmin-m)),d<s.zoom_xmax&&s.zoom_xmax<f&&(f=Math.min(f,s.zoom_xmax+m))}this._use_saved_points=t.fSave.length>3&&(x.settings.PreferSavedPoints||this.use_saved>1);const D=m=>{e.fNcells!==m+2&&(e.fNcells=m+2,e.fArray=new Float32Array(e.fNcells)),e.fArray.fill(0),e.fXaxis.fNbins=m,e.fXaxis.fXbins=[]};if(delete this._fail_eval,!this._use_saved_points){let m=!1;if(!t.evalPar)try{(0,r.Dx)(t)||(m=!0)}catch{m=!0}D(g),h?y(e.fXaxis,g,d,f):(e.fXaxis.fXmin=d,e.fXaxis.fXmax=f);for(let u=0;u<g&&!m;u++){const T=e.fXaxis.GetBinCenter(u+1);let A=0;try{A=t.evalPar(T)}catch{m=!0}m||e.setBinContent(u+1,Number.isFinite(A)?A:0)}m&&(this._fail_eval=!0),m&&t.fSave.length>3&&(this._use_saved_points=!0)}if(this._use_saved_points){g=t.fSave.length-3;let m=null;if(d=t.fSave[g+1],f=t.fSave[g+2],d===f){const u=this.getMainPainter();(0,x.isFunc)(u?.getHisto)&&(m=u?.getHisto()?.fXaxis)}if(m){D(e.fXaxis.fNbins),Object.assign(e.fXaxis,m);for(let u=0;u<g;++u){const T=t.fSave[u];e.setBinContent(u+1,Number.isFinite(T)?T:0)}}else{D(t.fNpx),e.fXaxis.fXmin=t.fXmin,e.fXaxis.fXmax=t.fXmax;for(let u=0;u<t.fNpx;++u){const T=(0,r.YI)(t,e.fXaxis.GetBinCenter(u+1));e.setBinContent(u+1,Number.isFinite(T)?T:0)}}}e.fName="Func",(0,x.setHistogramTitle)(e,t.fTitle),e.fMinimum=t.fMinimum,e.fMaximum=t.fMaximum,e.fLineColor=t.fLineColor,e.fLineStyle=t.fLineStyle,e.fLineWidth=t.fLineWidth,e.fFillColor=t.fFillColor,e.fFillStyle=t.fFillStyle,e.fMarkerColor=t.fMarkerColor,e.fMarkerStyle=t.fMarkerStyle,e.fMarkerSize=t.fMarkerSize,e.fBits|=x.kNoStats}extractAxesProperties(t){super.extractAxesProperties(t);const e=this.$func,a=e?.fSave.length??0;a>3&&this._use_saved_points&&(this.xmin=Math.min(this.xmin,e.fSave[a-2]),this.xmax=Math.max(this.xmax,e.fSave[a-1])),e&&(this.xmin=Math.min(this.xmin,e.fXmin),this.xmax=Math.max(this.xmax,e.fXmax))}canZoomInside(t,e,a){const c=this.$func?.fSave.length??0;if(c>3&&this._use_saved_points&&"x"===t){const h=c-2;return Math.abs(this.$func.fSave[c-1]-this.$func.fSave[c-2])/h<Math.abs(a-e)}return"x"===t||"y"===t}getTF1Tooltips(t){delete this.$tmp_tooltip;const e=[this.getObjectHint()],a=this.getFramePainter()?.getGrFuncs(this.options.second_x,this.options.second_y);if(!a||!(0,x.isFunc)(this.$func?.evalPar))return e.push("grx = "+t.x,"gry = "+t.y),e;const c=a.revertAxis("x",t.x);let h=0,s=0,d=!1;try{h=this.$func.evalPar(c),s=Math.round(a.gry(h))}catch{d=!0}return e.push("x = "+a.axisAsText("x",c),"value = "+(d?"<fail>":(0,E.lg)(h,x.gStyle.fStatFormat))),d||(this.$tmp_tooltip={y:h,gry:s}),e}processTooltipEvent(t){if(this._use_saved_points)return super.processTooltipEvent(t);let e=this.draw_g?.selectChild(".tooltip_bin");if(!this.draw_g||!t)return e?.remove(),null;const a={name:this.$func?.fName,title:this.$func?.fTitle,x:t.x,y:t.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getTF1Tooltips(t),exact:!0,menu:!0};return t.disabled?e.remove():(e.empty()&&(e=this.draw_g.append("svg:circle").attr("class","tooltip_bin").style("pointer-events","none").style("fill","none").attr("r",(this.lineatt?.width??1)+4)),e.attr("cx",t.x).attr("cy",this.$tmp_tooltip.gry??t.y).call(this.lineatt?.func)),a}fillWebObjectOptions(t){t.fcust=this._fail_eval&&!this.use_saved?"func_fail":""}static draw(t,e,a){return(0,p.A)(function*(){const c=_(a);let h;a=c.opt,delete c.opt,c.webcanv_hist&&(h=new M.JW(t).getPadPainter()?.findInPrimitives("Func",x.clTH1D)),h||(h=(0,x.createHistogram)(x.clTH1D,100),h.fBits|=x.kNoStats),!a&&(0,M.Nn)(t)&&(a="same");const s=new n(t,h);return s.$func=e,Object.assign(s,c),s.createTF1Histogram(e,h),P.mf._drawHist(s,a)})()}}},5659:(O,v,o)=>{o.d(v,{k:()=>P});var p=o(5774),x=o(825),E=o(3752),M=o(2009);class P extends x.TGraphPainter{drawBins3D(r,y){if(!(r.mode3d&&r.grx&&r.gry&&r.grz&&r.toplevel))return console.log("Frame painter missing base 3d elements");if(r.zoom_xmin!==r.zoom_xmax&&(this.options.pos3d<r.zoom_xmin||this.options.pos3d>r.zoom_xmax))return;this.createGraphDrawAttributes(!0);const _=this.optimizeBins(1e3);let n=0,i=_.length-1;if(r.zoom_ymin!==r.zoom_ymax){for(;n<i&&_[n].x<r.zoom_ymin;)n++;for(;n<i&&_[i].x>r.zoom_ymax;)i--}if(n===i)return;const t=[],e=r.grx(this.options.pos3d);let a=_[n];for(let h=n+1;h<=i;++h){const s=_[h];t.push(e,r.gry(a.x),r.grz(a.y),e,r.gry(s.x),r.grz(s.y)),a=s}const c=(0,M.Fc)(t,(0,M.DH)(this,y));r.add3DMesh(c,this,!0),r.render3D(100)}drawAxisHisto(){var r=this;return(0,p.A)(function*(){return E.TH1Painter.draw(r.getDom(),r.createHistogram(),r.options.Axis)})()}static draw(r,y,_){return(0,p.A)(function*(){return P._drawGraph(new P(r,y),_)})()}}}}]);
//# sourceMappingURL=common.77043f4ad917c548.js.map