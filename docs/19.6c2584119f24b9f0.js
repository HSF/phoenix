"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[19],{3019:(F,S,p)=>{p.r(S),p.d(S,{RHistStatsPainter:()=>b,RLegendPainter:()=>y,RPavePainter:()=>k,RPaveTextPainter:()=>T});var w=p(5774),x=p(4186),C=p(165),R=p(7635),E=p(7919),A=p(1564),D=p(9646);class k extends R.D{drawContent(){var t=this;return(0,w.A)(function*(){return t})()}drawPave(){var t=this;return(0,w.A)(function*(){const e=t.getPadPainter().getPadRect(),i=t.getFramePainter();t.onFrame=i&&t.v7EvalAttr("onFrame",!0),t.corner=t.v7EvalAttr("corner",2);const a=t.v7EvalAttr("visible",!0),s=t.v7EvalLength("offsetX",e.width,.02),d=t.v7EvalLength("offsetY",e.height,.02),o=t.v7EvalLength("width",e.width,.3),n=t.v7EvalLength("height",e.height,.3);if(t.createG(),t.draw_g.classed("most_upper_primitives",!0),!a)return t;t.createv7AttLine("border_"),t.createv7AttFill();const r=t.onFrame?i.getFrameRect():e;let l=0,c=0;switch(t.corner){case 1:l=r.x+s,c=r.y+d;break;case 3:l=r.x+s,c=r.y+r.height-d-n;break;case 4:l=r.x+r.width-s-o,c=r.y+r.height-d-n;break;default:l=r.x+r.width-s-o,c=r.y+d}return(0,C.bk)(t.draw_g,l,c),t.draw_g.append("svg:rect").attr("x",0).attr("width",o).attr("y",0).attr("height",n).call(t.lineatt.func).call(t.fillatt.func),t.pave_width=o,t.pave_height=n,t.drawContent().then(()=>(t.isBatchMode()||(x.settings.ContextMenu&&t.paveContextMenu&&t.draw_g.on("contextmenu",g=>t.paveContextMenu(g)),(0,A.WJ)(t,{x:l,y:c,width:o,height:n,minwidth:20,minheight:20,redraw:g=>t.sizeChanged(g)})),t))})()}sizeChanged(t){this.pave_width=t.width,this.pave_height=t.height;const e=t.x,i=t.y,a=this.getPadPainter().getPadRect(),s=this.onFrame?this.getFramePainter().getFrameRect():a,d={};let o=0,n=0;switch(this.corner){case 1:o=e-s.x,n=i-s.y;break;case 3:o=e-s.x,n=s.y+s.height-i-this.pave_height;break;case 4:o=s.x+s.width-e-this.pave_width,n=s.y+s.height-i-this.pave_height;break;default:o=s.x+s.width-e-this.pave_width,n=i-s.y}this.v7AttrChange(d,"offsetX",o/a.width),this.v7AttrChange(d,"offsetY",n/a.height),this.v7AttrChange(d,"width",this.pave_width/a.width),this.v7AttrChange(d,"height",this.pave_height/a.height),this.v7SendAttrChanges(d,!1),this.draw_g.selectChild("rect").attr("width",this.pave_width).attr("height",this.pave_height),this.drawContent()}redraw(){var t=this;return(0,w.A)(function*(){return t.drawPave()})()}static draw(t,e,i){return(0,w.A)(function*(){const a=new k(t,e,i,"pave");return(0,E.ensureRCanvas)(a,!1).then(()=>a.drawPave())})()}}class y extends k{drawContent(){var t=this;return(0,w.A)(function*(){const e=t.getObject(),i=t.v7EvalFont("text",{size:12,color:"black",align:22}),a=t.pave_width,s=t.pave_height,d=t.getPadPainter();let o=e.fEntries.length;if(e.fTitle&&o++,!o||!d)return t;const n=s/o,r=.02*a;let l=0;i.setSize(s/(1.2*o)),t.startTextDrawing(i,"font"),e.fTitle&&(t.drawText({latex:1,width:a-2*r,height:n,x:r,y:l,text:e.fTitle}),l+=n);for(let c=0;c<e.fEntries.length;++c){const g=e.fEntries[c],_=Math.round(a/4);let f=null;t.drawText({latex:1,width:.75*a-3*r,height:n,x:2*r+_,y:l,text:g.fLabel}),"custom"!==g.fDrawableId?f=d.findSnap(g.fDrawableId,!0):g.fDrawable.fIO&&(f=new R.D(t.getDom(),g.fDrawable.fIO),g.fLine&&f.createv7AttLine(),g.fFill&&f.createv7AttFill(),g.fMarker&&f.createv7AttMarker()),g.fFill&&f?.fillatt&&t.draw_g.append("svg:path").attr("d",`M${Math.round(r)},${Math.round(l+.1*n)}h${_}v${Math.round(.8*n)}h${-_}z`).call(f.fillatt.func),g.fLine&&f?.lineatt&&t.draw_g.append("svg:path").attr("d",`M${Math.round(r)},${Math.round(l+n/2)}h${_}`).call(f.lineatt.func),g.fError&&f?.lineatt&&t.draw_g.append("svg:path").attr("d",`M${Math.round(r+a/8)},${Math.round(l+.2*n)}v${Math.round(.6*n)}`).call(f.lineatt.func),g.fMarker&&f?.markeratt&&t.draw_g.append("svg:path").attr("d",f.markeratt.create(r+a/8,l+n/2)).call(f.markeratt.func),l+=n}return t.finishTextDrawing()})()}static draw(t,e,i){return(0,w.A)(function*(){const a=new y(t,e,i,"legend");return(0,E.ensureRCanvas)(a,!1).then(()=>a.drawPave())})()}}class T extends k{drawContent(){const t=this.getObject(),e=this.v7EvalFont("text",{size:12,color:"black",align:22}),i=this.pave_width,a=this.pave_height,s=t.fText.length;if(!s)return;const d=a/s,o=.02*i;let n=0;e.setSize(a/(1.2*s)),this.startTextDrawing(e,"font");for(let r=0;r<t.fText.length;++r)this.drawText({latex:1,width:i-2*o,height:d,x:o,y:n,text:t.fText[r]}),n+=d;return this.finishTextDrawing(void 0,!0)}static draw(t,e,i){return(0,w.A)(function*(){const a=new T(t,e,i,"pavetext");return(0,E.ensureRCanvas)(a,!1).then(()=>a.drawPave())})()}}class b extends k{clearStat(){this.stats_lines=[]}addText(t){this.stats_lines.push(t)}updateStatistic(t){this.stats_lines=t.lines,this.drawStatistic(this.stats_lines)}fillStatistic(){if(this.getPadPainter()?._fast_drawing)return!1;const e=this.getObject();if(void 0!==e.fLines)return this.stats_lines=e.fLines,delete e.fLines,!0;if(this.v7OfflineMode()){const i=this.getMainPainter();return!!(0,x.isFunc)(i?.fillStatistic)&&i.fillStatistic(this,x.gStyle.fOptStat,x.gStyle.fOptFit)}return void 0!==this.stats_lines}format(t,e){switch(e||(e="stat"),e){case"stat":e=x.gStyle.fStatFormat;break;case"fit":e=x.gStyle.fFitFormat;break;case"entries":if(Math.abs(t)<1e9&&Math.round(t)===t)return t.toFixed(0);e="14.7g";break;case"last":e=this.lastformat}const i=(0,C.lg)(t,e||"6.4g",!0);return this.lastformat=i[1],i[0]}drawContent(){var t=this;return(0,w.A)(function*(){return t.fillStatistic()?t.drawStatistic(t.stats_lines):t})()}changeMask(t){const e=this.getObject(),i=1<<t;e.fShowMask=e.fShowMask&i?e.fShowMask&~i:e.fShowMask|i,this.fillStatistic()&&this.drawStatistic(this.stats_lines)}statsContextMenu(t){t.preventDefault(),t.stopPropagation(),(0,D.ES)(t,this).then(e=>{const i=this.getObject(),a=this.changeMask.bind(this);e.add("header: StatBox");for(let s=0;s<i.fEntries.length;++s)e.addchk(i.fShowMask&1<<s,i.fEntries[s],s,a);return this.fillObjectExecMenu(e)}).then(e=>e.show())}drawStatistic(t){var e=this;return(0,w.A)(function*(){if(!t)return e;const i=e.v7EvalFont("stats_text",{size:12,color:"black",align:22}),a=e.pave_width,s=e.pave_height,d=t.length;let o=0,n=0,r=0;for(let h=0;h<d;++h){const P=t[h];if(h>0&&(r=Math.max(r,P.length)),0===h||P.indexOf("|")<0)continue;0===o&&(o=h);const u=P.split("|");u.length>n&&(n=u.length)}const l=s/d,c=.02*a;let g=!1,_=e.draw_g.selectChild(".statlines");if(_.empty()?_=e.draw_g.append("svg:g").attr("class","statlines"):_.selectAll("*").remove(),i.setSize(s/(1.2*d)),e.startTextDrawing(i,"font",_),1===d)e.drawText({width:a,height:s,text:t[0],latex:1,draw_g:_});else for(let h=0;h<d;++h){const P=h*l;if(o&&h>=o){const u=t[h].split("|");for(let M=0;M<u.length;++M)e.drawText({align:"middle",x:a*M/n,y:P,latex:0,width:a/n,height:l,text:u[M],draw_g:_})}else if(t[h].indexOf("=")<0){if(0===h){g=!0;const u=Math.max(r,Math.round((a-2*c)/l/.65));t[h].length>u+5&&(t[h]=t[h].slice(0,u+2)+"...")}e.drawText({align:0===h?"middle":"start",x:c,y:P,width:a-2*c,height:l,text:t[h],draw_g:_})}else{const u=t[h].split("="),M=[];for(let m=0;m<2;++m)M.push({align:0===m?"start":"end",x:c,y:P,width:a-2*c,height:l,text:u[m],draw_g:_,_expected_width:a-2*c,_args:M,post_process(L){this._args[0].ready&&this._args[1].ready&&L.scaleTextDrawing(1.05*(this._args[0].result_width&&this._args[1].result_width)/this.__expected_width,this.draw_g)}});for(let m=0;m<2;++m)e.drawText(M[m])}}let f="";if(g&&(f+="M0,"+Math.round(l)+"h"+a),o>0&&n>1){for(let h=o;h<d;++h)f+="M0,"+Math.round(h*l)+"h"+a;for(let h=0;h<n-1;++h)f+="M"+Math.round(a/n*(h+1))+","+Math.round(o*l)+"V"+s}return f&&e.draw_g.append("svg:path").attr("d",f),e.finishTextDrawing(_)})()}redraw(t){var e=this;return(0,w.A)(function*(){if(t&&(0,x.isStr)(t)&&0===t.indexOf("zoom")&&e.v7NormalMode()){const i={_typename:`${x.nsREX}RHistStatBoxBase::RRequest`,mask:e.getObject().fShowMask};e.v7SubmitRequest("stat",i,a=>e.updateStatistic(a))}return e.drawPave()})()}static draw(t,e,i){return(0,w.A)(function*(){const a=new b(t,e,i,e);return(0,E.ensureRCanvas)(a,!1).then(()=>a.drawPave())})()}}}}]);
//# sourceMappingURL=19.6c2584119f24b9f0.js.map