"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[781],{2781:(U,z,f)=>{f.r(z),f.d(z,{TF2Painter:()=>X});var B=f(5072),n=f(8872),D=f(4355),H=f(247),A=f(8868),N=f(9640),L=f(2843),Y=f(4615);class X extends D.TH2Painter{getObjectName(){return this.$func?.fName??"func"}getClassName(){return this.$func?._typename??n.clTF2}isTF1(){return!0}getPrimaryObject(){return this.$func}updateObject(e){if(!e||this.getClassName()!==e._typename)return!1;delete e.evalPar;const t=this.getHisto();if(this.webcanv_hist){const i=this.getPadPainter()?.findInPrimitives("Func",n.clTH2F);i&&this.updateAxes(t,i,this.getFramePainter())}return this.$func=e,this.createTF2Histogram(e,t),this.scanContent(),!0}redraw(e){return!this._use_saved_points&&("logx"===e||"logy"===e||"zoom"===e)&&(this.createTF2Histogram(this.$func,this.getHisto()),this.scanContent()),super.redraw(e)}createTF2Histogram(e,t){let i=e.fSave.length-6;i>0&&i!==(e.fSave[i+4]+1)*(e.fSave[i+5]+1)&&(i=0),this._use_saved_points=i>0&&(n.settings.PreferSavedPoints||this.use_saved>1);const x=this.getFramePainter(),y=this.getPadPainter()?.getRootPad(!0),d=y?.fLogx,r=y?.fLogy,s=x?.getGrFuncs(this.second_x,this.second_y);let c=e.fXmin,u=e.fXmax,g=e.fYmin,M=e.fYmax,o=Math.max(e.fNpx,20),P=Math.max(e.fNpy,20);if(s?.zoom_xmin!==s?.zoom_xmax){const a=(u-c)/o;c<s.zoom_xmin&&s.zoom_xmin<u&&(c=Math.max(c,s.zoom_xmin-a)),c<s.zoom_xmax&&s.zoom_xmax<u&&(u=Math.min(u,s.zoom_xmax+a))}if(s?.zoom_ymin!==s?.zoom_ymax){const a=(M-g)/P;g<s.zoom_ymin&&s.zoom_ymin<M&&(g=Math.max(g,s.zoom_ymin-a)),g<s.zoom_ymax&&s.zoom_ymax<M&&(M=Math.min(M,s.zoom_ymax+a))}const b=(a,m)=>{t.fNcells!==(a+2)*(m+2)&&(t.fNcells=(a+2)*(m+2),t.fArray=new Float32Array(t.fNcells)),t.fArray.fill(0),t.fXaxis.fNbins=a,t.fXaxis.fXbins=[],t.fYaxis.fNbins=m,t.fYaxis.fXbins=[]};if(delete this._fail_eval,!this._use_saved_points){let a=!1;!e.evalPar&&!(0,H.Dx)(e)&&(a=!0),b(o,P),t.fXaxis.fXmin=c,t.fXaxis.fXmax=u,t.fYaxis.fXmin=g,t.fYaxis.fXmax=M,d&&(0,A.produceTAxisLogScale)(t.fXaxis,o,c,u),r&&(0,A.produceTAxisLogScale)(t.fYaxis,P,g,M);for(let m=0;m<P&&!a;++m)for(let _=0;_<o&&!a;++_){const C=t.fXaxis.GetBinCenter(_+1),T=t.fYaxis.GetBinCenter(m+1);let v=0;try{v=e.evalPar(C,T)}catch{a=!0}a||t.setBinContent(t.getBin(_+1,m+1),Number.isFinite(v)?v:0)}a&&(this._fail_eval=!0),a&&i>6&&(this._use_saved_points=!0)}if(this._use_saved_points){let j=function(h,p){if(h<a||h>m||T<=0||p<_||p>C||v<=0)return 0;const l=Math.min(o-1,Math.floor((h-a)/T)),S=Math.min(P-1,Math.floor((p-_)/v)),E=(h-(a+l*T))/T,O=(p-(_+S*v))/v;return(1-E)*(1-O)*e.fSave[S*(o+1)+l]+E*(1-O)*e.fSave[S*(o+1)+l+1]+E*O*e.fSave[(S+1)*(o+1)+l+1]+(1-E)*O*e.fSave[(S+1)*(o+1)+l]};o=Math.round(e.fSave[i+4]),P=Math.round(e.fSave[i+5]);const a=e.fSave[i],m=e.fSave[i+1],_=e.fSave[i+2],C=e.fSave[i+3],T=(m-a)/o,v=(C-_)/P;b(e.fNpx,e.fNpy),t.fXaxis.fXmin=e.fXmin,t.fXaxis.fXmax=e.fXmax,t.fYaxis.fXmin=e.fYmin,t.fYaxis.fXmax=e.fYmax;for(let h=0;h<e.fNpy;++h){const p=t.fYaxis.GetBinCenter(h+1);for(let l=0;l<e.fNpx;++l){const F=j(t.fXaxis.GetBinCenter(l+1),p);t.setBinContent(t.getBin(l+1,h+1),Number.isFinite(F)?F:0)}}}return t.fName="Func",(0,n.setHistogramTitle)(t,e.fTitle),t.fMinimum=e.fMinimum,t.fMaximum=e.fMaximum,t.fLineColor=e.fLineColor,t.fLineStyle=e.fLineStyle,t.fLineWidth=e.fLineWidth,t.fFillColor=e.fFillColor,t.fFillStyle=e.fFillStyle,t.fMarkerColor=e.fMarkerColor,t.fMarkerStyle=e.fMarkerStyle,t.fMarkerSize=e.fMarkerSize,t.fBits|=n.kNoStats,t}extractAxesProperties(e){super.extractAxesProperties(e);const t=this.$func,i=t?.fSave.length??0;i>6&&this._use_saved_points&&(this.xmin=Math.min(this.xmin,t.fSave[i-6]),this.xmax=Math.max(this.xmax,t.fSave[i-5]),this.ymin=Math.min(this.ymin,t.fSave[i-4]),this.ymax=Math.max(this.ymax,t.fSave[i-3])),t&&(this.xmin=Math.min(this.xmin,t.fXmin),this.xmax=Math.max(this.xmax,t.fXmax),this.ymin=Math.min(this.ymin,t.fYmin),this.ymax=Math.max(this.ymax,t.fYmax))}getTF2Tooltips(e){const t=[this.getObjectHint()],i=this.getFramePainter()?.getGrFuncs(this.options.second_x,this.options.second_y);if(!i||!(0,n.isFunc)(this.$func?.evalPar))return t.push("grx = "+e.x,"gry = "+e.y),t;const x=i.revertAxis("x",e.x),y=i.revertAxis("y",e.y);let d=0,r=!1;try{d=this.$func.evalPar(x,y)}catch{r=!0}return t.push("x = "+i.axisAsText("x",x),"y = "+i.axisAsText("y",y),"value = "+(r?"<fail>":(0,L.lg)(d,n.gStyle.fStatFormat))),t}processTooltipEvent(e){if(this._use_saved_points)return super.processTooltipEvent(e);let t=this.draw_g?.selectChild(".tooltip_bin");if(!this.draw_g||!e)return t?.remove(),null;const i={name:this.$func?.fName,title:this.$func?.fTitle,x:e.x,y:e.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getTF2Tooltips(e),exact:!0,menu:!0};return e.disabled?t.remove():(t.empty()&&(t=this.draw_g.append("svg:circle").attr("class","tooltip_bin").style("pointer-events","none").style("fill","none").attr("r",(this.lineatt?.width??1)+4)),t.attr("cx",e.x).attr("cy",e.y),this.lineatt&&t.call(this.lineatt.func)),i}fillWebObjectOptions(e){e.fcust=this._fail_eval&&!this.use_saved?"func_fail":""}static draw(e,t,i){return(0,B.A)(function*(){const x=(0,A.scanTF1Options)(i);i=x.opt,delete x.opt;const y=new L.nC(i);y.empty()?i="cont3":"SAME"===y.opt&&(i="cont2 same");const d=(0,n.isStr)(i)?i.toUpperCase():"";let r;("SAMECOLORZ"===d||"SAMECOLOR"===d||"SAMECOLZ"===d)&&(i="samecol"),(0===i.indexOf("same")||0===i.indexOf("SAME"))&&((0,N.Nn)(e)||(i="A_ADJUST_FRAME_"+i.slice(4))),x.webcanv_hist&&(r=new N.JW(e).getPadPainter()?.findInPrimitives("Func",n.clTH2F)),r||(r=(0,n.createHistogram)(n.clTH2F,20,20),r.fBits|=n.kNoStats);const s=new X(e,r);return s.$func=t,Object.assign(s,x),s.createTF2Histogram(t,r),Y.mf._drawHist(s,i)})()}}}}]);
//# sourceMappingURL=781.a22f730445f0e89b.js.map