"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[580],{2580:(N,v,l)=>{l.r(v),l.d(v,{drawLeafPlayer:()=>S,drawTree:()=>U,drawTreePlayer:()=>P,drawTreePlayerKey:()=>k});var x=l(5835),n=l(9542),R=l(2253),y=l(8538),_=l(3414),O=l(3675),f=l(6458),$=l(629),B=l(8189),M=l(5906),A=l(3761),K=l(7822),c=l(9622);function b(i,t,e){return T.apply(this,arguments)}function T(){return(T=(0,x.Z)(function*(i,t,e){let s=t?._typename;return s&&(0,n.isStr)(s)?0==s.indexOf(n.clTH1)?$.TH1Painter.draw(i,t,e):0==s.indexOf(n.clTH2)?B.TH2Painter.draw(i,t,e):0==s.indexOf(n.clTH3)?M.TH3Painter.draw(i,t,e):0==s.indexOf(n.clTGraph)?A.o.draw(i,t,e):s==n.clTPolyMarker3D&&t.$hist?M.TH3Painter.draw(i,t.$hist,e).then(()=>{let r=new f.tK(i,t,e);return r.addToPadPrimitives(),r.redraw=K.Y,r.redraw()}):Promise.reject(Error(`Object of type ${s} cannot be draw with TTree`)):Promise.reject(Error("Object without type cannot be draw with TTree"))})).apply(this,arguments)}function I(i,t){return g.apply(this,arguments)}function g(){return(g=(0,x.Z)(function*(i,t){if(t||this.last_pr){if(this.dump||this.testio){if(!t)return;if((0,n.isBatchMode)()){let s=new O.be(this.drawid);return s.selectDom().property("_json_object_",i),s}if((0,n.isFunc)(n.internals.drawInspector))return n.internals.drawInspector(this.drawid,i);let e=(0,n.create)(n.clTObjString);return e.fString=(0,n.toJSON)(i,2),(0,f.VE)(this.drawid,e)}return this.last_pr||(this.last_pr=Promise.resolve(!0)),this.last_pr.then(()=>(this.last_pr=this.obj_painter?this.obj_painter.redrawObject(i).then(()=>this.obj_painter):b(this.drawid,i).then(e=>(this.obj_painter=e,t||(this.last_pr=null),e)),t?this.last_pr:null))}})).apply(this,arguments)}function C(i){return i.draw_first=!0,i.configureOnline=function(t,e,s,r,a){this.setItemName(t,"",this),this.url=e,this.root_version=r,this.askey=s,this.draw_expr=a},i.configureTree=function(t){this.local_tree=t},i.showExtraButtons=function(t){let e=this.selectDom(),s=this.local_tree?this.local_tree.fEntries:0;e.select(".treedraw_more").remove(),e.select(".treedraw_buttons").node().innerHTML+=`Cut: <input class="treedraw_cut ui-corner-all ui-widget" style="width:8em;margin-left:5px" title="cut expression"></input>Opt: <input class="treedraw_opt ui-corner-all ui-widget" style="width:5em;margin-left:5px" title="histogram draw options"></input>Num: <input class="treedraw_number" type='number' min="0" max="${s}" step="1000" style="width:7em;margin-left:5px" title="number of entries to process (default all)"></input>First: <input class="treedraw_first" type='number' min="0" max="${s}" step="1000" style="width:7em;margin-left:5px" title="first entry to process (default first)"></input><button class="treedraw_clear" title="Clear drawing">Clear</button>`,e.select(".treedraw_exe").on("click",()=>this.performDraw()),e.select(".treedraw_cut").property("value",t?.parse_cut||"").on("change",()=>this.performDraw()),e.select(".treedraw_opt").property("value",t?.drawopt||"").on("change",()=>this.performDraw()),e.select(".treedraw_number").attr("value",t?.numentries||""),e.select(".treedraw_first").attr("value",t?.firstentry||""),e.select(".treedraw_clear").on("click",()=>(0,f.Eq)(this.drawid))},i.showPlayer=function(t){let e=this.selectDom();this.drawid="jsroot_tree_player_"+n.internals.id_counter+++"_draw";let s=t?.parse_cut||t?.numentries||t?.firstentry;e.html(`<div style="display:flex; flex-flow:column; height:100%; width:100%;"><div class="treedraw_buttons" style="flex: 0 1 auto;margin-top:0.2em;"><button class="treedraw_exe" title="Execute draw expression" style="margin-left:0.5em">Draw</button>Expr:<input class="treedraw_varexp treedraw_varexp_info" style="width:12em;margin-left:5px" title="draw expression"></input><label class="treedraw_varexp_info">\u24d8</label><button class="treedraw_more">More</button></div><div style="flex: 0 1 auto"><hr/></div><div id="${this.drawid}" style="flex: 1 1 auto; overflow:hidden;"></div></div>`),this.setTopPainter(),this.local_tree&&e.select(".treedraw_buttons").attr("title","Tree draw player for: "+this.local_tree.fName),e.select(".treedraw_exe").on("click",()=>this.performDraw()),e.select(".treedraw_varexp").attr("value",t?.parse_expr||this.draw_expr||"px:py").on("change",()=>this.performDraw()),e.select(".treedraw_varexp_info").attr("title","Example of valid draw expressions:\n  px - 1-dim draw\n  px:py - 2-dim draw\n  px:py:pz - 3-dim draw\n  px+py:px-py - use any expressions\n  px:py>>Graph - create and draw TGraph\n  px:py>>dump - dump extracted variables\n  px:py>>h(50,-5,5,50,-5,5) - custom histogram\n  px:py;hbins:100 - custom number of bins"),s?this.showExtraButtons(t):e.select(".treedraw_more").on("click",()=>this.showExtraButtons(t)),this.checkResize(),(0,c.MG)(this)},i.getValue=function(t){const e=this.selectDom().select(t);if(e.empty())return;const s=e.property("value");return void 0!==s?s:e.attr("value")},i.performLocalDraw=function(){if(!this.local_tree)return;const t=this.selectDom(),e={expr:this.getValue(".treedraw_varexp")};t.select(".treedraw_more").empty()&&(e.cut=this.getValue(".treedraw_cut"),e.cut||delete e.cut,e.drawopt=this.getValue(".treedraw_opt"),"dump"===e.drawopt&&(e.dump=!0,e.drawopt=""),e.drawopt||delete e.drawopt,e.numentries=parseInt(this.getValue(".treedraw_number")),Number.isInteger(e.numentries)||delete e.numentries,e.firstentry=parseInt(this.getValue(".treedraw_first")),Number.isInteger(e.firstentry)||delete e.firstentry),(0,f.Eq)(this.drawid),e.drawid=this.drawid,e.progress=I.bind(e),(0,_.treeDraw)(this.local_tree,e).then(s=>e.progress(s,!0))},i.getDrawOpt=function(){let t="player",e=this.getValue(".treedraw_varexp");return e&&(t+=":"+e),t},i.performDraw=function(){if(this.local_tree)return this.performLocalDraw();let t=this.selectDom(),e=this.url+"/exe.json.gz?compact=3&method=Draw",s=this.getValue(".treedraw_varexp"),r="h_tree_draw",a="",o=s.indexOf(">>");if(o<0)s+=">>"+r;else{r=s.slice(o+2),"+"==r[0]&&(r=r.slice(1));let u=r.indexOf("(");u>0&&(r=r.slice(0,u))}if(t.select(".treedraw_more").empty()){let u=this.getValue(".treedraw_cut"),h=this.getValue(".treedraw_number"),p=this.getValue(".treedraw_first");a=this.getValue(".treedraw_opt"),e+=`&prototype="const char*,const char*,Option_t*,Long64_t,Long64_t"&varexp="${s}"&selection="${u}"`,""==h&&(h=this.root_version>=394499?"TTree::kMaxEntries":"1000000000"),""==p&&(p="0"),e+=`&option="${a}"&nentries=${h}&firstentry=${p}`}else e+=`&prototype="Option_t*"&opt="${s}"`;e+="&_ret_object_="+r;const d=()=>{(0,n.httpRequest)(e,"object").then(u=>{(0,f.Eq)(this.drawid),b(this.drawid,u,a)})};this.draw_expr=s,this.askey?(this.askey=!1,(0,n.httpRequest)(this.url+"/root.json.gz?compact=3","text").then(d)):d()},i.checkResize=function(){(0,f.SI)(this.drawid)},i}function P(i,t,e,s){let r=i.findItem(t),a=i.getTopOnlineItem(r),o="",d=0;if(!r||!a)return null;if(s){for(o=r._name;r&&!r._ttree;)r=r._parent;if(!r)return null;t=i.itemFullName(r)}let u=i.getOnlineItemUrl(t);if(!u)return null;let h=a._root_version||400129,p=i.getDisplay();if(!p)return null;let L=p.findFrame(t,!0);if(!L)return null;let V=(0,R.Ys)(L).attr("id"),w=new O.be(V);if(r._childs&&!s)for(let E=0;E<r._childs.length;++E){let m=r._childs[E];m&&m._kind&&0==m._kind.indexOf("ROOT.TLeaf")&&d<2&&(d++>0&&(o+=":"),o+=m._name)}return C(w),w.configureOnline(t,u,e,h,o),w.showPlayer(),w}function k(i,t){return P(i,t,!0)}function S(i,t){return P(i,t,!1,!0)}function U(i,t,e){return D.apply(this,arguments)}function D(){return(D=(0,x.Z)(function*(i,t,e){let a,o,s=t,r=e;if(t._typename==_.clTBranchFunc?(r={expr:`.${t.func}()`,branch:t.branch},e&&0==e.indexOf("dump")?r.expr+=">>"+e:e&&(r.expr+=e),s=t.branch.$tree):t.$branch?(r={expr:`.${t.fName}${e||""}`,branch:t.$branch},(r.branch.fType===_.kClonesNode||r.branch.fType===_.kSTLNode)&&(r.expr=e,r.direct_branch=!0),s=t.$branch.$tree):t.$tree?(!e&&t.fStreamerType&&t.fStreamerType!==y.kt&&t.fStreamerType>=y.C5&&t.fStreamerType<=y.R1&&(e="dump"),r={expr:e,branch:t},s=t.$tree):(r||(r="player"),(0,n.isStr)(r)&&(r={expr:r})),!s)throw Error("No TTree object available for TTree::Draw");if((0,n.isStr)(r.expr)){let d=r.expr.indexOf("player");0==d?(r.player=!0,r.expr=r.expr.slice(6),":"==r.expr[0]&&(r.expr=r.expr.slice(1))):d>=0&&d==r.expr.length-6&&(r.player=!0,r.expr=r.expr.slice(0,d),d>0&&";"==r.expr[d-1]&&(r.expr=r.expr.slice(0,d-1)))}if(r.player?(a=new f.tK(i,t,e),C(a),a.configureTree(s),a.showPlayer(r),r.drawid=a.drawid):r.drawid=i,r.progress=I.bind(r),"testio"===r.expr)r.testio=!0,r.showProgress=c.Ae,o=(0,_.treeIOTest)(s,r);else{if(!r.expr&&!r.branch)return a;o=(0,_.treeDraw)(s,r)}return o.then(d=>r.progress(d,!0))})).apply(this,arguments)}_.TDrawSelector.prototype.ShowProgress=function(i){if(typeof document>"u"||(0,n.isBatchMode)())return;if(void 0===i||!Number.isFinite(i))return(0,c.Ae)();if(this.last_progress!==i){let a=i-this.last_progress;this.aver_diff||(this.aver_diff=a),this.aver_diff=.3*a+.7*this.aver_diff}let t=0;this.aver_diff<=0?t=0:this.aver_diff<1e-4?t=3:this.aver_diff<.001?t=2:this.aver_diff<.01&&(t=1);let e=document.createElement("p"),s=document.createTextNode("TTree draw "+(100*i).toFixed(t)+" %  "),r=this;e.appendChild(s),e.title="Click on element to break drawing",e.onclick=function(){if(++r._break<3)return e.title="Tree draw will break after next I/O operation",s.nodeValue="Breaking ... ";r.Abort(),(0,c.Ae)()},(0,c.Ae)(e),this.last_progress=i}}}]);
//# sourceMappingURL=580.4e80292c5f9c68b1.js.map