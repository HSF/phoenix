"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[76],{801:(D,v,l)=>{l.r(v),l.d(v,{TLinePainter:()=>_});var p=l(5072),x=l(8872),E=l(2843),M=l(9640),y=l(4483),h=l(5992),a=l(7900);const P=(0,x.BIT)(14);class _ extends M.JW{moveStart(s,t){const e=Math.sqrt((this.x1-this.x2)**2+(this.y1-this.y2)**2),n=Math.sqrt((s-this.x1)**2+(t-this.y1)**2)/e,r=Math.sqrt((s-this.x2)**2+(t-this.y2)**2)/e;this.side=n>.9?1:r>.9?-1:0}moveDrag(s,t){1!==this.side&&(this.x1+=s,this.y1+=t),-1!==this.side&&(this.x2+=s,this.y2+=t),this.draw_g.select("path").attr("d",this.createPath())}moveEnd(s){if(s)return;const t=this.getObject();let e="",n=this.svgToAxis("x",this.x1,this.isndc),r=this.svgToAxis("x",this.x2,this.isndc),o=this.svgToAxis("y",this.y1,this.isndc),i=this.svgToAxis("y",this.y2,this.isndc);this.swap_xy&&([n,o,r,i]=[o,n,i,r]),t.fX1=n,t.fX2=r,t.fY1=o,t.fY2=i,1!==this.side&&(e+=`SetX1(${n});;SetY1(${o});;`),-1!==this.side&&(e+=`SetX2(${r});;SetY2(${i});;`),this.submitCanvExec(e+"Notify();;")}getUserRanges(){const s=this.getObject();if(s.TestBit(P))return null;const e=Math.min(s.fX1,s.fX2),n=Math.max(s.fX1,s.fX2);return{minx:e,miny:Math.min(s.fY1,s.fY2),maxx:n,maxy:Math.max(s.fY1,s.fY2)}}prepareDraw(){const s=this.getObject();this.isndc=s.TestBit(P);const t=!this.isndc&&new E.nC(this.getDrawOpt()).check("FRAME");this.createG(t?"frame2d":void 0),this.swap_xy=t&&this.getFramePainter()?.swap_xy;const e=this.getAxisToSvgFunc(this.isndc,!0);this.x1=e.x(s.fX1),this.y1=e.y(s.fY1),this.x2=e.x(s.fX2),this.y2=e.y(s.fY2),this.swap_xy&&([this.x1,this.y1,this.x2,this.y2]=[this.y1,this.x1,this.y2,this.x2]),this.createAttLine({attr:s})}createPath(){const s=Math.round(this.x1),t=Math.round(this.x2),e=Math.round(this.y1),n=Math.round(this.y2);return`M${s},${e}`+(s===t?`V${n}`:e===n?`H${t}`:`L${t},${n}`)}addExtras(){}redraw(){this.prepareDraw();const s=this.draw_g.append("svg:path").attr("d",this.createPath()).call(this.lineatt.func);return this.getObject()?.$do_not_draw?s.remove():(this.addExtras(s),(0,h.X2)(this),(0,a.wh)(this,a.Ew)),this}static draw(s,t,e){return(0,p.A)(function*(){const n=new _(s,t,e);return(0,y.ensureTCanvas)(n,!1).then(()=>n.redraw())})()}}},643:(D,v,l)=>{l.d(v,{Y:()=>M});var p=l(5072),x=l(8872),E=l(7615);function M(){return y.apply(this,arguments)}function y(){return(y=(0,p.A)(function*(){const h=this.$fp||this.getFramePainter();if(delete this.$fp,!((0,x.isObject)(h)&&h.grx&&h.gry&&h.grz))return this;const a=this.getObject(),_=a.fP;let u=1,s=0;for(let i=0;i<_.length;i+=3)_[i]<h.scale_xmin||_[i]>h.scale_xmax||_[i+1]<h.scale_ymin||_[i+1]>h.scale_ymax||_[i+2]<h.scale_zmin||_[i+2]>h.scale_zmax||++s;x.settings.OptimizeDraw>0&&s>5e4&&(u=Math.floor(s/5e4),u<=2&&(u=2));const t=Math.floor(s/u),e=new E._l(t,h.webgl,h.size_x3d/100),n=new Int32Array(t);let r=0,o=0;for(let i=0;i<_.length;i+=3)_[i]<h.scale_xmin||_[i]>h.scale_xmax||_[i+1]<h.scale_ymin||_[i+1]>h.scale_ymax||_[i+2]<h.scale_zmin||_[i+2]>h.scale_zmax||u>1&&(r=(r+1)%u,0!==r)||(n[o++]=i,e.addPoint(h.grx(_[i]),h.gry(_[i+1]),h.grz(_[i+2])));return e.createPoints({color:this.getColor(a.fMarkerColor),style:a.fMarkerStyle}).then(i=>(i.tip_color=3===a.fMarkerColor?16711680:65280,i.tip_name=a.fName||"Poly3D",i.poly=a,i.fp=h,i.scale0=.7*e.scale,i.index=n,h.add3DMesh(i,this,!0),i.tooltip=function(d){let f=Math.floor(d.index/this.nvertex);if(f<0||f>=this.index.length)return null;f=this.index[f];const g=this.fp,O=g.grx(this.poly.fP[f]),c=g.gry(this.poly.fP[f+1]),m=g.grz(this.poly.fP[f+2]);return{x1:O-this.scale0,x2:O+this.scale0,y1:c-this.scale0,y2:c+this.scale0,z1:m-this.scale0,z2:m+this.scale0,color:this.tip_color,lines:[this.tip_name,"pnt: "+f/3,"x: "+g.axisAsText("x",this.poly.fP[f]),"y: "+g.axisAsText("y",this.poly.fP[f+1]),"z: "+g.axisAsText("z",this.poly.fP[f+2])]}},h.render3D(100),this))})).apply(this,arguments)}},8868:(D,v,l)=>{l.r(v),l.d(v,{TF1Painter:()=>u,produceTAxisLogScale:()=>P,scanTF1Options:()=>_});var p=l(5072),x=l(8872),E=l(2843),M=l(9640),y=l(4615),h=l(212),a=l(247);function P(s,t,e,n){let r,o;n>0?(o=Math.log(n),r=e>0?Math.log(e):o-5):(o=-10,r=-15),s.fNbins=t,s.fXbins=new Array(t+1);for(let i=0;i<=t;++i)s.fXbins[i]=Math.exp(r+i/t*(o-r));s.fXmin=Math.exp(r),s.fXmax=Math.exp(o)}function _(s){(0,x.isStr)(s)||(s="");let t=s.indexOf(";webcanv_hist"),e=!1,n=0;return t>=0&&(e=!0,s=s.slice(0,t)),t=s.indexOf(";force_saved"),t>=0&&(n=2,s=s.slice(0,t)),t=s.indexOf(";prefer_saved"),t>=0&&(n=1,s=s.slice(0,t)),{opt:s,webcanv_hist:e,use_saved:n}}class u extends h.N{getObjectName(){return this.$func?.fName??"func"}getClassName(){return this.$func?._typename??x.clTF1}isTF1(){return!0}getPrimaryObject(){return this.$func}updateObject(t){if(!t||this.getClassName()!==t._typename)return!1;delete t.evalPar;const e=this.getHisto();if(this.webcanv_hist){const n=this.getPadPainter()?.findInPrimitives("Func",x.clTH1D);n&&this.updateAxes(e,n,this.getFramePainter())}return this.$func=t,this.createTF1Histogram(t,e),this.scanContent(),!0}redraw(t){return!this._use_saved_points&&("logx"===t||"zoom"===t)&&(this.createTF1Histogram(this.$func,this.getHisto()),this.scanContent()),super.redraw(t)}createTF1Histogram(t,e){const n=this.getFramePainter(),r=this.getPadPainter()?.getRootPad(!0),o=r?.fLogx,i=n?.getGrFuncs(this.second_x,this.second_y);let d=t.fXmin,f=t.fXmax,g=Math.max(t.fNpx,100);if(i?.zoom_xmin!==i?.zoom_xmax){const c=(f-d)/g;d<i.zoom_xmin&&i.zoom_xmin<f&&(d=Math.max(d,i.zoom_xmin-c)),d<i.zoom_xmax&&i.zoom_xmax<f&&(f=Math.min(f,i.zoom_xmax+c))}this._use_saved_points=t.fSave.length>3&&(x.settings.PreferSavedPoints||this.use_saved>1);const O=c=>{e.fNcells!==c+2&&(e.fNcells=c+2,e.fArray=new Float32Array(e.fNcells)),e.fArray.fill(0),e.fXaxis.fNbins=c,e.fXaxis.fXbins=[]};if(delete this._fail_eval,!this._use_saved_points){let c=!1;if(!t.evalPar)try{(0,a.Dx)(t)||(c=!0)}catch{c=!0}O(g),o?P(e.fXaxis,g,d,f):(e.fXaxis.fXmin=d,e.fXaxis.fXmax=f);for(let m=0;m<g&&!c;m++){const T=e.fXaxis.GetBinCenter(m+1);let A=0;try{A=t.evalPar(T)}catch{c=!0}c||e.setBinContent(m+1,Number.isFinite(A)?A:0)}c&&(this._fail_eval=!0),c&&t.fSave.length>3&&(this._use_saved_points=!0)}if(this._use_saved_points){g=t.fSave.length-3;let c=null;if(d=t.fSave[g+1],f=t.fSave[g+2],d===f){const m=this.getMainPainter();(0,x.isFunc)(m?.getHisto)&&(c=m?.getHisto()?.fXaxis)}if(c){O(e.fXaxis.fNbins),Object.assign(e.fXaxis,c);for(let m=0;m<g;++m){const T=t.fSave[m];e.setBinContent(m+1,Number.isFinite(T)?T:0)}}else{O(t.fNpx),e.fXaxis.fXmin=t.fXmin,e.fXaxis.fXmax=t.fXmax;for(let m=0;m<t.fNpx;++m){const T=(0,a.YI)(t,e.fXaxis.GetBinCenter(m+1));e.setBinContent(m+1,Number.isFinite(T)?T:0)}}}e.fName="Func",(0,x.setHistogramTitle)(e,t.fTitle),e.fMinimum=t.fMinimum,e.fMaximum=t.fMaximum,e.fLineColor=t.fLineColor,e.fLineStyle=t.fLineStyle,e.fLineWidth=t.fLineWidth,e.fFillColor=t.fFillColor,e.fFillStyle=t.fFillStyle,e.fMarkerColor=t.fMarkerColor,e.fMarkerStyle=t.fMarkerStyle,e.fMarkerSize=t.fMarkerSize,e.fBits|=x.kNoStats}extractAxesProperties(t){super.extractAxesProperties(t);const e=this.$func,n=e?.fSave.length??0;n>3&&this._use_saved_points&&(this.xmin=Math.min(this.xmin,e.fSave[n-2]),this.xmax=Math.max(this.xmax,e.fSave[n-1])),e&&(this.xmin=Math.min(this.xmin,e.fXmin),this.xmax=Math.max(this.xmax,e.fXmax))}canZoomInside(t,e,n){const r=this.$func?.fSave.length??0;if(r>3&&this._use_saved_points&&"x"===t){const o=r-2;return Math.abs(this.$func.fSave[r-1]-this.$func.fSave[r-2])/o<Math.abs(n-e)}return"x"===t||"y"===t}getTF1Tooltips(t){delete this.$tmp_tooltip;const e=[this.getObjectHint()],n=this.getFramePainter()?.getGrFuncs(this.options.second_x,this.options.second_y);if(!n||!(0,x.isFunc)(this.$func?.evalPar))return e.push("grx = "+t.x,"gry = "+t.y),e;const r=n.revertAxis("x",t.x);let o=0,i=0,d=!1;try{o=this.$func.evalPar(r),i=Math.round(n.gry(o))}catch{d=!0}return e.push("x = "+n.axisAsText("x",r),"value = "+(d?"<fail>":(0,E.lg)(o,x.gStyle.fStatFormat))),d||(this.$tmp_tooltip={y:o,gry:i}),e}processTooltipEvent(t){if(this._use_saved_points)return super.processTooltipEvent(t);let e=this.draw_g?.selectChild(".tooltip_bin");if(!this.draw_g||!t)return e?.remove(),null;const n={name:this.$func?.fName,title:this.$func?.fTitle,x:t.x,y:t.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getTF1Tooltips(t),exact:!0,menu:!0};return t.disabled?e.remove():(e.empty()&&(e=this.draw_g.append("svg:circle").attr("class","tooltip_bin").style("pointer-events","none").style("fill","none").attr("r",(this.lineatt?.width??1)+4)),e.attr("cx",t.x).attr("cy",this.$tmp_tooltip.gry??t.y),this.lineatt&&e.call(this.lineatt.func)),n}fillWebObjectOptions(t){t.fcust=this._fail_eval&&!this.use_saved?"func_fail":""}static draw(t,e,n){return(0,p.A)(function*(){const r=_(n);let o;n=r.opt,delete r.opt,r.webcanv_hist&&(o=new M.JW(t).getPadPainter()?.findInPrimitives("Func",x.clTH1D)),o||(o=(0,x.createHistogram)(x.clTH1D,100),o.fBits|=x.kNoStats),!n&&(0,M.Nn)(t)&&(n="same");const i=new u(t,o);return i.$func=e,Object.assign(i,r),i.createTF1Histogram(e,o),y.mf._drawHist(i,n)})()}}},7917:(D,v,l)=>{l.d(v,{k:()=>y});var p=l(5072),x=l(2679),E=l(8142),M=l(7615);class y extends x.TGraphPainter{drawBins3D(a,P){if(!(a.mode3d&&a.grx&&a.gry&&a.grz&&a.toplevel))return console.log("Frame painter missing base 3d elements");if(a.zoom_xmin!==a.zoom_xmax&&(this.options.pos3d<a.zoom_xmin||this.options.pos3d>a.zoom_xmax))return;this.createGraphDrawAttributes(!0);const _=this.optimizeBins(1e3);let u=0,s=_.length-1;if(a.zoom_ymin!==a.zoom_ymax){for(;u<s&&_[u].x<a.zoom_ymin;)u++;for(;u<s&&_[s].x>a.zoom_ymax;)s--}if(u===s)return;const t=[],e=a.grx(this.options.pos3d);let n=_[u];for(let o=u+1;o<=s;++o){const i=_[o];t.push(e,a.gry(n.x),a.grz(n.y),e,a.gry(i.x),a.grz(i.y)),n=i}const r=(0,M.Fc)(t,(0,M.DH)(this,P));a.add3DMesh(r,this,!0),a.render3D(100)}drawAxisHisto(){var a=this;return(0,p.A)(function*(){return E.TH1Painter.draw(a.getDrawDom(),a.createHistogram(),a.options.Axis)})()}static draw(a,P,_){return(0,p.A)(function*(){return y._drawGraph(new y(a,P),_)})()}}}}]);
//# sourceMappingURL=common.200aa7d4f8b041fe.js.map