"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[805],{8805:(O,C,P)=>{P.r(C),P.d(C,{TRatioPlotPainter:()=>T});var m=P(5774),c=P(4186),v=P(2481),F=P(2725),L=P(4755);class T extends v.JW{setGridsRange(i,t,n,e,s){const a=this.getObject();if(i===t){const r=this.getPadPainter()?.findPainterFor(a.fLowerPad,"lower_pad",c.clTPad)?.getFramePainter()?.x_handle;if(!r)return;0===i?(i=r.full_min,t=r.full_max):(i=r.scale_min,t=r.scale_max)}a.fGridlines.forEach(r=>{r.fX1=i,r.fX2=t});const o=Math.min(a.fGridlines.length,a.fGridlinePositions.length);for(let r=0;r<o;++r){const _=a.fGridlinePositions[r],f=a.fGridlines[r];"ignorey"!==n&&(f.$do_not_draw=n!==e&&(_<n||_>e),f.fY1=f.fY2=_),s?.findPainterFor(f)?.redraw()}}configureInteractive(){const i=this.getObject(),t=this.getPadPainter(),n=t.findPainterFor(i.fUpperPad,"upper_pad",c.clTPad),e=n?.getFramePainter(),s=t.findPainterFor(i.fLowerPad,"lower_pad",c.clTPad),a=s?.getFramePainter();!n||!s||(s.forEachPainterInPad(o=>{(0,c.isFunc)(o?.testEditable)&&o.testEditable(!1)}),this.setGridsRange(a.scale_xmin,a.scale_xmax,a.scale_ymin,a.scale_ymax,s),(!n._ratio_interactive||!s._ratio_interactive)&&(n._ratio_interactive=!0,s._ratio_interactive=!0,e.o_zoom=e.zoom,e._ratio_low_fp=a,e._ratio_painter=this,e.zoom=function(o,r,_,f,p,d){return this.o_zoom(o,r,_,f,p,d).then(h=>(this._ratio_painter.setGridsRange(e.scale_xmin,e.scale_xmax,"ignory"),this._ratio_low_fp.o_zoom(e.scale_xmin,e.scale_xmax).then(()=>h)))},e.o_sizeChanged=e.sizeChanged,e.sizeChanged=function(){this.o_sizeChanged(),this._ratio_low_fp.fX1NDC=this.fX1NDC,this._ratio_low_fp.fX2NDC=this.fX2NDC,this._ratio_low_fp.o_sizeChanged()},a.o_zoom=a.zoom,a._ratio_up_fp=e,a._ratio_painter=this,a.zoom=function(o,r,_,f,p,d){return o===r?(o=e.xmin,r=e.xmax):(o<e.xmin&&(o=e.xmin),r>e.xmax&&(r=e.xmax)),this._ratio_painter.setGridsRange(o,r,_,f),this._ratio_up_fp.o_zoom(o,r).then(()=>this.o_zoom(o,r,_,f,p,d))},a.o_sizeChanged=a.sizeChanged,a.sizeChanged=function(){this.o_sizeChanged(),this._ratio_up_fp.fX1NDC=this.fX1NDC,this._ratio_up_fp.fX2NDC=this.fX2NDC,this._ratio_up_fp.o_sizeChanged()}))}redrawOld(){var i=this;return(0,m.A)(function*(){const t=i.getObject(),n=i.getPadPainter(),e=n.findPainterFor(t.fTopPad,"top_pad",c.clTPad),s=n.getRootPad(),a=0===s.fFrameFillStyle?1:0,o=s.fTickx||a,r=s.fTicky||a;e?.disablePadDrawing();const _=n.findPainterFor(t.fUpperPad,"upper_pad",c.clTPad),f=_?.getMainPainter(),p=_?.getFramePainter(),d=n.findPainterFor(t.fLowerPad,"lower_pad",c.clTPad),h=d?.getMainPainter(),w=d?.getFramePainter();let z=Promise.resolve(!0);if(_&&f&&p&&w&&!_._ratio_configured){_._ratio_configured=!0,f.options.Axis=0;const u=f.getHisto();u.fYaxis.$use_top_pad=!0,u.fXaxis.fLabelSize=0,u.fXaxis.fTitle="",_.getRootPad().fTickx=o,_.getRootPad().fTicky=r,z=_.redrawPad()}return z.then(()=>{if(!d||!h||!w||!p||d._ratio_configured)return i;d._ratio_configured=!0,h.options.Axis=0;const u=h.getHisto();u.fXaxis.fTitle="x",u.fXaxis.$use_top_pad=!0,u.fYaxis.$use_top_pad=!0,d.getRootPad().fTickx=o,d.getRootPad().fTicky=r;const x=[];let g;return t.fGridlinePositions.length>0&&t.fGridlines.length<t.fGridlinePositions.length&&t.fGridlinePositions.forEach(D=>{let E=!1;if(t.fGridlines.forEach(l=>{l.fY1===l.fY2&&Math.abs(l.fY1-D)<1e-6&&(E=!0)}),!E){const l=(0,c.create)(c.clTLine);l.fX1=p.scale_xmin,l.fX2=p.scale_xmax,l.fY1=l.fY2=D,l.fLineStyle=2,t.fGridlines.push(l),void 0===g&&(g=i.selectCurrentPad(t.fLowerPad.fName)),x.push(L.TLinePainter.draw(i.getDom(),l))}}),Promise.all(x).then(()=>(void 0!==g&&i.selectCurrentPad(g),w.zoom(p.scale_xmin,p.scale_xmax)))})})()}redraw(){var i=this;return(0,m.A)(function*(){const t=i.getObject(),n=i.getPadPainter();if(void 0===i.$oldratio&&(i.$oldratio=!!n.findPainterFor(t.fTopPad,"top_pad",c.clTPad)),n.$userInteractive=()=>i.configureInteractive(),i.$oldratio)return i.redrawOld();const e=n.getRootPad(),s=0===e.fFrameFillStyle?1:0,a=e.fTickx||s,o=e.fTicky||s;return t.fTopPad.$disable_drawing=!0,t.fUpperPad.$ratio_pad="up",t.fUpperPad.fTickx=a,t.fUpperPad.fTicky=o,t.fLowerPad.$ratio_pad="low",t.fLowerPad.fTickx=a,t.fLowerPad.fTicky=o,i})()}static draw(i,t,n){return(0,m.A)(function*(){const e=new T(i,t,n);return(0,F.ensureTCanvas)(e,!1).then(()=>e.redraw())})()}}}}]);
//# sourceMappingURL=805.227e3b019e1b8134.js.map