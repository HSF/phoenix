(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[792],{8096:(Gr,xt,Te)=>{"use strict";function be(n,e){return Object.is(n,e)}let v=null,V=!1,Le=1;const xe=Symbol("SIGNAL");function Je(n){const e=v;return v=n,e}const Re={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Qe(n){if(V)throw new Error("");if(null===v)return;v.consumerOnSignalRead(n);const e=v.nextProducerIndex++;P(v),e<v.producerNode.length&&v.producerNode[e]!==n&&x(v)&&D(v.producerNode[e],v.producerIndexOfThis[e]),v.producerNode[e]!==n&&(v.producerNode[e]=n,v.producerIndexOfThis[e]=x(v)?G(n,v,e):0),v.producerLastReadVersion[e]=n.version}function L(n){if((!x(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==Le)){if(!n.producerMustRecompute(n)&&!ce(n))return n.dirty=!1,void(n.lastCleanEpoch=Le);n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Le}}function he(n){if(void 0===n.liveConsumerNode)return;const e=V;V=!0;try{for(const t of n.liveConsumerNode)t.dirty||fe(t)}finally{V=e}}function re(){return!1!==v?.consumerAllowSignalWrites}function fe(n){n.dirty=!0,he(n),n.consumerMarkedDirty?.(n)}function de(n){return n&&(n.nextProducerIndex=0),Je(n)}function pe(n,e){if(Je(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(x(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)D(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function ce(n){P(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(L(t),i!==t.version))return!0}return!1}function K(n){if(P(n),x(n))for(let e=0;e<n.producerNode.length;e++)D(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function G(n,e,t){if(w(n),0===n.liveConsumerNode.length&&b(n))for(let i=0;i<n.producerNode.length;i++)n.producerIndexOfThis[i]=G(n.producerNode[i],n,i);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function D(n,e){if(w(n),1===n.liveConsumerNode.length&&b(n))for(let i=0;i<n.producerNode.length;i++)D(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];P(r),r.producerIndexOfThis[i]=e}}function x(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function P(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function w(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function b(n){return void 0!==n.producerNode}const C=Symbol("UNSET"),N=Symbol("COMPUTING"),O=Symbol("ERRORED"),H={...Re,value:C,dirty:!0,error:null,equal:be,producerMustRecompute:n=>n.value===C||n.value===N,producerRecomputeValue(n){if(n.value===N)throw new Error("Detected cycle in computations.");const e=n.value;n.value=N;const t=de(n);let i;try{i=n.computation()}catch(r){i=O,n.error=r}finally{pe(n,t)}e!==C&&e!==O&&i!==O&&n.equal(e,i)?n.value=e:(n.value=i,n.version++)}};let ie=function X(){throw new Error};function z(){ie()}let I=null;function ee(n,e){re()||z(),n.equal(n.value,e)||(n.value=e,function De(n){n.version++,function Ie(){Le++}(),he(n),I?.()}(n))}const Se={...Re,equal:be,value:void 0};const ct=()=>{},$={...Re,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{null!==n.schedule&&n.schedule(n.ref)},hasRun:!1,cleanupFn:ct};function We(n){return"function"==typeof n}function Ne(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Fe=Ne(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function ht(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class pt{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(We(i))try{i()}catch(s){e=s instanceof Fe?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{_t(s)}catch(o){e=e??[],o instanceof Fe?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Fe(e)}}add(e){var t;if(e&&e!==this)if(this.closed)_t(e);else{if(e instanceof pt){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ht(t,e)}remove(e){const{_finalizers:t}=this;t&&ht(t,e),e instanceof pt&&e._removeParent(this)}}pt.EMPTY=(()=>{const n=new pt;return n.closed=!0,n})();const dt=pt.EMPTY;function rt(n){return n instanceof pt||n&&"closed"in n&&We(n.remove)&&We(n.add)&&We(n.unsubscribe)}function _t(n){We(n)?n():n.unsubscribe()}const Yt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},kt={setTimeout(n,e,...t){const{delegate:i}=kt;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=kt;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Tt(n){kt.setTimeout(()=>{const{onUnhandledError:e}=Yt;if(!e)throw n;e(n)})}function fn(){}const ln=Sn("C",void 0,void 0);function Sn(n,e,t){return{kind:n,value:e,error:t}}let cn=null;function gn(n){if(Yt.useDeprecatedSynchronousErrorHandling){const e=!cn;if(e&&(cn={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=cn;if(cn=null,t)throw i}}else n()}class Ln extends pt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,rt(e)&&e.add(this)):this.destination=fs}static create(e,t,i){return new qi(e,t,i)}next(e){this.isStopped?ms(function jt(n){return Sn("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?ms(function mn(n){return Sn("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?ms(ln,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Zn=Function.prototype.bind;function ui(n,e){return Zn.call(n,e)}class hi{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Mr(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Mr(i)}else Mr(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Mr(t)}}}class qi extends Ln{constructor(e,t,i){let r;if(super(),We(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&Yt.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&ui(e.next,s),error:e.error&&ui(e.error,s),complete:e.complete&&ui(e.complete,s)}):r=e}this.destination=new hi(r)}}function Mr(n){Yt.useDeprecatedSynchronousErrorHandling?function Cn(n){Yt.useDeprecatedSynchronousErrorHandling&&cn&&(cn.errorThrown=!0,cn.error=n)}(n):Tt(n)}function ms(n,e){const{onStoppedNotification:t}=Yt;t&&kt.setTimeout(()=>t(n,e))}const fs={closed:!0,next:fn,error:function Sr(n){throw n},complete:fn},wt="function"==typeof Symbol&&Symbol.observable||"@@observable";function W(n){return n}function _e(n){return 0===n.length?W:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Be=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function Mt(n){return n&&n instanceof Ln||function Et(n){return n&&We(n.next)&&We(n.error)&&We(n.complete)}(n)&&rt(n)}(t)?t:new qi(t,i,r);return gn(()=>{const{operator:o,source:l}=this;s.add(o?o.call(s,l):l?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=gt(i))((r,s)=>{const o=new qi({next:l=>{try{t(l)}catch(h){s(h),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[wt](){return this}pipe(...t){return _e(t)(this)}toPromise(t){return new(t=gt(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function gt(n){var e;return null!==(e=n??Yt.Promise)&&void 0!==e?e:Promise}const Nt=Ne(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Qt=(()=>{class n extends Be{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Zt(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new Nt}next(t){gn(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){gn(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){gn(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?dt:(this.currentObservers=null,s.push(t),new pt(()=>{this.currentObservers=null,ht(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Be;return t.source=this,t}}return n.create=(e,t)=>new Zt(e,t),n})();class Zt extends Qt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:dt}}class dn extends Qt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function vn(n){return We(n?.lift)}function Fn(n){return e=>{if(vn(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ai(n,e,t,i,r){return new $n(n,e,t,i,r)}class $n extends Ln{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(l){try{t(l)}catch(h){e.error(h)}}:super._next,this._error=r?function(l){try{r(l)}catch(h){e.error(h)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function kn(n,e){return Fn((t,i)=>{let r=0;t.subscribe(ai(i,s=>{i.next(n.call(e,s,r++))}))})}typeof navigator<"u"&&navigator,typeof navigator<"u"&&!/Opera/.test(navigator.userAgent)&&navigator,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||navigator),typeof navigator<"u"&&!/Opera|WebKit/.test(navigator.userAgent)&&navigator,typeof navigator<"u"&&navigator;const rl="https://g.co/ng/security#xss";class xi extends Error{constructor(e,t){super(function Jf(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function wc(n){return{toString:n}.toString()}const Hh="__parameters__";function Lp(n,e,t){return wc(()=>{const i=function Rm(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return l.annotation=o,l;function l(h,u,f){const y=h.hasOwnProperty(Hh)?h[Hh]:Object.defineProperty(h,Hh,{value:[]})[Hh];for(;y.length<=f;)y.push(null);return(y[f]=y[f]||[]).push(o),h}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}const Cs=globalThis;function qo(n){for(let e in n)if(n[e]===qo)return e;throw Error("Could not find renamed property on target object.")}function Fm(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function zl(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(zl).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function cf(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const Ey=qo({__forward_ref__:qo});function Ma(n){return n.__forward_ref__=Ma,n.toString=function(){return zl(this())},n}function Us(n){return tp(n)?n():n}function tp(n){return"function"==typeof n&&n.hasOwnProperty(Ey)&&n.__forward_ref__===Ma}function $i(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function oa(n){return{providers:n.providers||[],imports:n.imports||[]}}function zp(n){return ud(n,uf)||ud(n,Hp)}function ud(n,e){return n.hasOwnProperty(e)?n[e]:null}function Gh(n){return n&&(n.hasOwnProperty(np)||n.hasOwnProperty(Rc))?n[np]:null}const uf=qo({\u0275prov:qo}),np=qo({\u0275inj:qo}),Hp=qo({ngInjectableDef:qo}),Rc=qo({ngInjectorDef:qo});class Ai{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=$i({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function rp(n){return n&&!!n.\u0275providers}const FA=qo({\u0275cmp:qo}),K0=qo({\u0275dir:qo}),Dd=qo({\u0275pipe:qo}),sp=qo({\u0275mod:qo}),Kl=qo({\u0275fac:qo}),ff=qo({__NG_ELEMENT_ID__:qo}),mo=qo({__NG_ENV_ID__:qo});function uo(n){return"string"==typeof n?n:null==n?"":String(n)}function zm(n,e){throw new xi(-201,!1)}var Xo=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Xo||{});let Zc;function By(){return Zc}function sl(n){const e=Zc;return Zc=n,e}function op(n,e,t){const i=zp(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Xo.Optional?null:void 0!==e?e:void zm()}const Il={},pf="__NG_DI_FLAG__",tl="ngTempTokenPath",Qh=/\n/gm,wv="__source";let qp;function vu(n){const e=qp;return qp=n,e}function Z0(n,e=Xo.Default){if(void 0===qp)throw new xi(-203,!1);return null===qp?op(n,void 0,e):qp.get(n,e&Xo.Optional?null:void 0,e)}function Wn(n,e=Xo.Default){return(By()||Z0)(Us(n),e)}function oi(n,e=Xo.Default){return Wn(n,kc(e))}function kc(n){return typeof n>"u"||"number"==typeof n?n:(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function OA(n){const e=[];for(let t=0;t<n.length;t++){const i=Us(n[t]);if(Array.isArray(i)){if(0===i.length)throw new xi(900,!1);let r,s=Xo.Default;for(let o=0;o<i.length;o++){const l=i[o],h=Ry(l);"number"==typeof h?-1===h?r=l.token:s|=h:r=l}e.push(Wn(r,s))}else e.push(Wn(i))}return e}function LA(n,e){return n[pf]=e,n.prototype[pf]=e,n}function Ry(n){return n[pf]}const xu=LA(Lp("Optional"),8),Hm=LA(Lp("SkipSelf"),4);function mf(n,e){return n.hasOwnProperty(Kl)?n[Kl]:null}function Vm(n,e){n.forEach(t=>Array.isArray(t)?Vm(t,e):e(t))}function Qp(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Al(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function gl(n,e,t){let i=Bl(n,e);return i>=0?n[1|i]=t:(i=~i,function Yg(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function jh(n,e){const t=Bl(n,e);if(t>=0)return n[1|t]}function Bl(n,e){return function Af(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const Bh={},Ba=[],_l=new Ai(""),is=new Ai("",-1),Jc=new Ai("");class Kg{get(e,t=Il){if(t===Il){const i=new Error(`NullInjectorError: No provider for ${zl(e)}!`);throw i.name="NullInjectorError",i}return t}}var jp=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(jp||{}),Zl=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Zl||{}),Id=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Id||{});function i_(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function jc(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],l=t[i++];n.setAttribute(e,o,l,s)}else{const s=r,o=t[++i];Gm(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function Wh(n){return 3===n||4===n||6===n}function Gm(n){return 64===n.charCodeAt(0)}function gf(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||Bd(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function Bd(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const l=n[s++];if("number"==typeof l){if(l===e){o=-1;break}if(l>e){o=s-1;break}}}for(;s<n.length;){const l=n[s];if("number"==typeof l)break;if(l===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const Pd="ng-template";function qm(n,e,t,i){let r=0;if(i){for(;r<e.length&&"string"==typeof e[r];r+=2)if("class"===e[r]&&-1!==i_(e[r+1].toLowerCase(),t,0))return!0}else if(_f(n))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&"string"==typeof(s=e[r]);)if(s.toLowerCase()===t)return!0}return!1}function _f(n){return 4===n.type&&n.value!==Pd}function Wp(n,e,t){return e===(4!==n.type||t?n.value:Pd)}function pd(n,e,t){let i=4;const r=n.attrs,s=null!==r?function jm(n){for(let e=0;e<n.length;e++)if(Wh(n[e]))return e;return n.length}(r):0;let o=!1;for(let l=0;l<e.length;l++){const h=e[l];if("number"!=typeof h){if(!o)if(4&i){if(i=2|1&i,""!==h&&!Wp(n,h,t)||""===h&&1===e.length){if(Cc(i))return!1;o=!0}}else if(8&i){if(null===r||!qm(n,r,h,t)){if(Cc(i))return!1;o=!0}}else{const u=e[++l],f=UA(h,r,_f(n),t);if(-1===f){if(Cc(i))return!1;o=!0;continue}if(""!==u){let y;if(y=f>s?"":r[f+1].toLowerCase(),2&i&&u!==y){if(Cc(i))return!1;o=!0}}}}else{if(!o&&!Cc(i)&&!Cc(h))return!1;if(o&&Cc(h))continue;o=!1,i=h|1&i}}return Cc(i)||o}function Cc(n){return!(1&n)}function UA(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let l=e[++r];for(;"string"==typeof l;)l=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function ky(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function Rd(n,e,t=!1){for(let i=0;i<e.length;i++)if(pd(n,e[i],t))return!0;return!1}function zA(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function Wm(n,e){return n?":not("+e.trim()+")":e}function hc(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const l=n[++t];r+="["+o+(l.length>0?'="'+l+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Cc(o)&&(e+=Wm(s,r),r=""),i=o,s=s||!Cc(i);t++}return""!==r&&(e+=Wm(s,r)),e}function wr(n){return wc(()=>{const e=$p(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===jp.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Zl.Emulated,styles:n.styles||Ba,_:null,schemas:n.schemas||null,tView:null,id:""};$m(t);const i=n.dependencies;return t.directiveDefs=wu(i,!1),t.pipeDefs=wu(i,!0),t.id=function cp(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)|0;return e+=2147483648,"c"+e}(t),t})}function Rh(n){return Ro(n)||vl(n)}function $u(n){return null!==n}function ua(n){return wc(()=>({type:n.type,bootstrap:n.bootstrap||Ba,declarations:n.declarations||Ba,imports:n.imports||Ba,exports:n.exports||Ba,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function ap(n,e){if(null==n)return Bh;const t={};for(const i in n)if(n.hasOwnProperty(i)){const r=n[i];let s,o,l=Id.None;Array.isArray(r)?(l=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(t[s]=l!==Id.None?[i,l]:i,e[s]=o):t[s]=i}return t}function mr(n){return wc(()=>{const e=$p(n);return $m(e),e})}function yl(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Ro(n){return n[FA]||null}function vl(n){return n[K0]||null}function Gl(n){return n[Dd]||null}function ql(n,e){const t=n[sp]||null;if(!t&&!0===e)throw new Error(`Type ${zl(n)} does not have '\u0275mod' property.`);return t}function $p(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Bh,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||Ba,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ap(n.inputs,e),outputs:ap(n.outputs),debugInfo:null}}function $m(n){n.features?.forEach(e=>e(n))}function wu(n,e){if(!n)return null;const t=e?Gl:Rh;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter($u)}function Fy(...n){return{\u0275providers:Cu(0,n),\u0275fromNgModule:!0}}function Cu(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return Vm(e,o=>{const l=o;Zg(l,s,[],i)&&(r||=[],r.push(l))}),void 0!==r&&Oy(r,s),t}function Oy(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];eh(r,s=>{e(s,i)})}}function Zg(n,e,t,i){if(!(n=Us(n)))return!1;let r=null,s=Gh(n);const o=!s&&Ro(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const h=n.ngModule;if(s=Gh(h),!s)return!1;r=h}const l=i.has(r);if(o){if(l)return!1;if(i.add(r),o.dependencies){const h="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const u of h)Zg(u,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!l){let u;i.add(r);try{Vm(s.imports,f=>{Zg(f,e,t,i)&&(u||=[],u.push(f))})}finally{}void 0!==u&&Oy(u,e)}if(!l){const u=mf(r)||(()=>new r);e({provide:r,useFactory:u,deps:Ba},r),e({provide:Jc,useValue:r,multi:!0},r),e({provide:_l,useValue:()=>Wn(r),multi:!0},r)}const h=s.providers;if(null!=h&&!l){const u=n;eh(h,f=>{e(f,u)})}}}return r!==n&&void 0!==n.providers}function eh(n,e){for(let t of n)rp(t)&&(t=t.\u0275providers),Array.isArray(t)?eh(t,e):e(t)}const Ym=qo({provide:String,useValue:qo});function r_(n){return null!==n&&"object"==typeof n&&Ym in n}function Yp(n){return"function"==typeof n}const HA=new Ai(""),Km={},yf={};let md;function Zm(){return void 0===md&&(md=new Kg),md}class th{}class hp extends th{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,s_(e,o=>this.processProvider(o)),this.records.set(is,kd(void 0,this)),r.has("environment")&&this.records.set(th,kd(void 0,this));const s=this.records.get(HA);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Jc,Ba,Xo.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const e=Je(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Je(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=vu(this),i=sl(void 0);try{return e()}finally{vu(t),sl(i)}}get(e,t=Il,i=Xo.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(mo))return e[mo](this);i=kc(i);const s=vu(this),o=sl(void 0);try{if(!(i&Xo.SkipSelf)){let h=this.records.get(e);if(void 0===h){const u=function Wc(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ai}(e)&&zp(e);h=u&&this.injectableDefInScope(u)?kd(Jg(e),Km):null,this.records.set(e,h)}if(null!=h)return this.hydrate(e,h)}return(i&Xo.Self?Zm():this.parent).get(e,t=i&Xo.Optional&&t===Il?null:t)}catch(l){if("NullInjectorError"===l.name){if((l[tl]=l[tl]||[]).unshift(zl(e)),s)throw l;return function bu(n,e,t,i){const r=n[tl];throw e[wv]&&r.unshift(e[wv]),n.message=function dd(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=zl(e);if(Array.isArray(e))r=e.map(zl).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let l=e[o];s.push(o+":"+("string"==typeof l?JSON.stringify(l):zl(l)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Qh,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[tl]=null,n}(l,e,"R3InjectorError",this.source)}throw l}finally{sl(o),vu(s)}}resolveInjectorInitializers(){const e=Je(null),t=vu(this),i=sl(void 0);try{const s=this.get(_l,Ba,Xo.Self);for(const o of s)o()}finally{vu(t),sl(i),Je(e)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(zl(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new xi(205,!1)}processProvider(e){let t=Yp(e=Us(e))?e:Us(e&&e.provide);const i=function Kp(n){return r_(n)?kd(void 0,n.useValue):kd(e0(n),Km)}(e);if(!Yp(e)&&!0===e.multi){let r=this.records.get(t);r||(r=kd(void 0,Km,!0),r.factory=()=>OA(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){const i=Je(null);try{return t.value===Km&&(t.value=yf,t.value=t.factory()),"object"==typeof t.value&&t.value&&function t0(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Je(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Us(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function Jg(n){const e=zp(n),t=null!==e?e.factory:mf(n);if(null!==t)return t;if(n instanceof Ai)throw new xi(204,!1);if(n instanceof Function)return function nh(n){if(n.length>0)throw new xi(204,!1);const t=function Wu(n){return n&&(n[uf]||n[Hp])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new xi(204,!1)}function e0(n,e,t){let i;if(Yp(n)){const r=Us(n);return mf(r)||Jg(r)}if(r_(n))i=()=>Us(n.useValue);else if(function Xp(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...OA(n.deps||[]));else if(function Ly(n){return!(!n||!n.useExisting)}(n))i=()=>Wn(Us(n.useExisting));else{const r=Us(n&&(n.useClass||n.provide));if(!function Ny(n){return!!n.deps}(n))return mf(r)||Jg(r);i=()=>new r(...OA(n.deps))}return i}function kd(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function s_(n,e){for(const t of n)Array.isArray(t)?s_(t,e):t&&rp(t)?s_(t.\u0275providers,e):e(t)}function Fd(n,e){n instanceof hp&&n.assertNotDestroyed();const i=vu(n),r=sl(void 0);try{return e()}finally{vu(i),sl(r)}}function Na(){return void 0!==By()||null!=function Yx(){return qp}()}function o_(n){if(!Na())throw new xi(-203,!1)}const Ml=0,vr=1,Ys=2,uc=3,Xu=4,ih=5,$c=6,up=7,hl=8,Ec=9,Ld=10,_o=11,Nd=12,r0=13,vf=14,Pl=15,Zp=16,tA=17,Ud=18,Jp=19,s0=20,bf=21,QA=22,Yh=23,Fs=25,o0=1,Kh=7,tm=9,ec=10;var WA=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(WA||{});function Sc(n){return Array.isArray(n)&&"object"==typeof n[o0]}function rh(n){return Array.isArray(n)&&!0===n[o0]}function l_(n){return!!(4&n.flags)}function nm(n){return n.componentOffset>-1}function xf(n){return!(1&~n.flags)}function Yu(n){return!!n.template}function bl(n){return!!(512&n[Ys])}class kv{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function p_(n,e,t,i){null!==e?e.applyValueToInputSignal(e,i):n[t]=i}function dc(){return Gy}function Gy(n){return n.type.prototype.ngOnChanges&&(n.setInput=m_),SM}function SM(){const n=Fv(this),e=n?.current;if(e){const t=n.previous;if(t===Bh)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function m_(n,e,t,i,r){const s=this.declaredInputs[i],o=Fv(n)||function Jx(n,e){return n[Cf]=e}(n,{previous:Bh,current:null}),l=o.current||(o.current={}),h=o.previous,u=h[s];l[s]=new kv(u&&u.currentValue,t,h===Bh),p_(n,e,r,t)}dc.ngInherit=!0;const Cf="__ngSimpleChanges__";function Fv(n){return n[Cf]||null}const fp=function(n,e,t){},A_="svg";function Pa(n){for(;Array.isArray(n);)n=n[Ml];return n}function rs(n,e){return Pa(e[n])}function Tc(n,e){return Pa(e[n.index])}function tc(n,e){return n.data[e]}function im(n,e){return n[e]}function Js(n,e){const t=e[n];return Sc(t)?t:t[Ml]}function YA(n){return!(128&~n[Ys])}function Ql(n,e){return null==e?null:n[e]}function rA(n){n[tA]=0}function sh(n){1024&n[Ys]||(n[Ys]|=1024,YA(n)&&__(n))}function sA(n){return!!(9216&n[Ys]||n[Yh]?.dirty)}function g_(n){n[Ld].changeDetectionScheduler?.notify(8),64&n[Ys]&&(n[Ys]|=1024),sA(n)&&__(n)}function __(n){n[Ld].changeDetectionScheduler?.notify(0);let e=Mf(n);for(;null!==e&&!(8192&e[Ys])&&(e[Ys]|=8192,YA(e));)e=Mf(e)}function ZA(n,e){if(!(256&~n[Ys]))throw new xi(911,!1);null===n[bf]&&(n[bf]=[]),n[bf].push(e)}function Mf(n){const e=n[uc];return rh(e)?e[uc]:e}const Br={lFrame:Kn(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let JA=!1;function Ef(){return Br.bindingsEnabled}function nc(){return null!==Br.skipHydrationRootTNode}function gi(){return Br.lFrame.lView}function fo(){return Br.lFrame.tView}function pi(n){return Br.lFrame.contextLView=n,n[hl]}function fi(n){return Br.lFrame.contextLView=null,n}function qa(){let n=tg();for(;null!==n&&64===n.type;)n=n.parent;return n}function tg(){return Br.lFrame.currentTNode}function Zh(n,e){const t=Br.lFrame;t.currentTNode=n,t.isParent=e}function Vd(){return Br.lFrame.isParent}function c0(){Br.lFrame.isParent=!1}function d0(){return JA}function ng(n){JA=n}function jl(){const n=Br.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Eu(){return Br.lFrame.bindingIndex++}function gd(n){const e=Br.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function te(n,e){const t=Br.lFrame;t.bindingIndex=t.bindingRootIndex=n,ae(e)}function ae(n){Br.lFrame.currentDirectiveIndex=n}function qe(){return Br.lFrame.currentQueryIndex}function ft(n){Br.lFrame.currentQueryIndex=n}function Pt(n){const e=n[vr];return 2===e.type?e.declTNode:1===e.type?n[ih]:null}function on(n,e,t){if(t&Xo.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&Xo.Host||(r=Pt(s),null===r||(s=s[vf],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Br.lFrame=Vn();return i.currentTNode=e,i.lView=n,!0}function sn(n){const e=Vn(),t=n[vr];Br.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Vn(){const n=Br.lFrame,e=null===n?null:n.child;return null===e?Kn(n):e}function Kn(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function li(){const n=Br.lFrame;return Br.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Ni=li;function us(){const n=li();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Cr(){return Br.lFrame.selectedIndex}function Co(n){Br.lFrame.selectedIndex=n}function kr(){const n=Br.lFrame;return tc(n.tView,n.selectedIndex)}function Fr(){Br.lFrame.currentNamespace=A_}function vo(){!function Mo(){Br.lFrame.currentNamespace=null}()}let ga=!0;function aa(){return ga}function Ks(n){ga=n}function Ea(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:l,ngAfterViewInit:h,ngAfterViewChecked:u,ngOnDestroy:f}=s;o&&(n.contentHooks??=[]).push(-t,o),l&&((n.contentHooks??=[]).push(t,l),(n.contentCheckHooks??=[]).push(t,l)),h&&(n.viewHooks??=[]).push(-t,h),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),null!=f&&(n.destroyHooks??=[]).push(t,f)}}function Ra(n,e,t){Tf(n,e,3,t)}function ka(n,e,t,i){(3&n[Ys])===t&&Tf(n,e,t,i)}function Fc(n,e){let t=n[Ys];(3&t)===e&&(t&=16383,t+=1,n[Ys]=t)}function Tf(n,e,t,i){const s=i??-1,o=e.length-1;let l=0;for(let h=void 0!==i?65535&n[tA]:0;h<o;h++)if("number"==typeof e[h+1]){if(l=e[h],null!=i&&l>=i)break}else e[h]<0&&(n[tA]+=65536),(l<s||-1==s)&&(Jh(n,t,e,h),n[tA]=(4294901760&n[tA])+h+2),h++}function kh(n,e){fp(4,n,e);const t=Je(null);try{e.call(n)}finally{Je(t),fp(5,n,e)}}function Jh(n,e,t,i){const r=t[i]<0,s=t[i+1],l=n[r?-t[i]:t[i]];r?n[Ys]>>14<n[tA]>>16&&(3&n[Ys])===e&&(n[Ys]+=16384,kh(l,s)):kh(l,s)}const Zu=-1;class eu{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}const am={};class sg{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=kc(i);const r=this.injector.get(e,am,i);return r!==am||t===am?r:this.parentInjector.get(e,t,i)}}function Yy(n){return n!==Zu}function v_(n){return 32767&n}function b_(n,e){let t=function TM(n){return n>>16}(n),i=e;for(;t>0;)i=i[vf],t--;return i}let Nv=!0;function Ky(n){const e=Nv;return Nv=n,e}const ew=255,tw=5;let IM=0;const yp={};function Zy(n,e){const t=nw(n,e);if(-1!==t)return t;const i=e[vr];i.firstCreatePass&&(n.injectorIndex=e.length,Uv(i.data,n),Uv(e,null),Uv(i.blueprint,null));const r=Jy(n,e),s=n.injectorIndex;if(Yy(r)){const o=v_(r),l=b_(r,e),h=l[vr].data;for(let u=0;u<8;u++)e[s+u]=l[o+u]|h[o+u]}return e[s+8]=r,s}function Uv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function nw(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Jy(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=Xt(r),null===i)return Zu;if(t++,r=r[vf],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Zu}function Gd(n,e,t){!function BM(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(ff)&&(i=t[ff]),null==i&&(i=t[ff]=IM++);const r=i&ew;e.data[n+(r>>tw)]|=1<<r}(n,e,t)}function zv(n,e,t){if(t&Xo.Optional||void 0!==n)return n;zm()}function vp(n,e,t,i){if(t&Xo.Optional&&void 0===i&&(i=null),!(t&(Xo.Self|Xo.Host))){const r=n[Ec],s=sl(void 0);try{return r?r.get(e,i,t&Xo.Optional):op(e,i,t&Xo.Optional)}finally{sl(s)}}return zv(i,0,t)}function iw(n,e,t,i=Xo.Default,r){if(null!==n){if(2048&e[Ys]&&!(i&Xo.Self)){const o=function $t(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[Ys]&&!(512&o[Ys]);){const l=rw(s,o,t,i|Xo.Self,yp);if(l!==yp)return l;let h=s.parent;if(!h){const u=o[s0];if(u){const f=u.get(t,yp,i);if(f!==yp)return f}h=Xt(o),o=o[vf]}s=h}return r}(n,e,t,i,yp);if(o!==yp)return o}const s=rw(n,e,t,i,yp);if(s!==yp)return s}return vp(e,t,i,r)}function rw(n,e,t,i,r){const s=function e3(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(ff)?n[ff]:void 0;return"number"==typeof e?e>=0?e&ew:mt:e}(t);if("function"==typeof s){if(!on(e,n,i))return i&Xo.Host?zv(r,0,i):vp(e,t,i,r);try{let o;if(o=s(i),null!=o||i&Xo.Optional)return o;zm()}finally{Ni()}}else if("number"==typeof s){let o=null,l=nw(n,e),h=Zu,u=i&Xo.Host?e[Pl][ih]:null;for((-1===l||i&Xo.SkipSelf)&&(h=-1===l?Jy(n,e):e[l+8],h!==Zu&&q(i,!1)?(o=e[vr],l=v_(h),e=b_(h,e)):l=-1);-1!==l;){const f=e[vr];if(_(s,l,f.data)){const y=RM(l,e,t,o,i,u);if(y!==yp)return y}h=e[l+8],h!==Zu&&q(i,e[vr].data[l+8]===u)&&_(s,l,e)?(o=f,l=v_(h),e=b_(h,e)):l=-1}}return r}function RM(n,e,t,i,r,s){const o=e[vr],l=o.data[n+8],f=e1(l,o,t,null==i?nm(l)&&Nv:i!=o&&!!(3&l.type),r&Xo.Host&&s===l);return null!==f?og(e,o,f,l):yp}function e1(n,e,t,i,r){const s=n.providerIndexes,o=e.data,l=1048575&s,h=n.directiveStart,f=s>>20,T=r?l+f:n.directiveEnd;for(let B=i?l:l+f;B<T;B++){const j=o[B];if(B<h&&t===j||B>=h&&j.type===t)return B}if(r){const B=o[h];if(B&&Yu(B)&&B.type===t)return h}return null}function og(n,e,t,i){let r=n[t];const s=e.data;if(function Ap(n){return n instanceof eu}(r)){const o=r;o.resolving&&function yu(n,e){throw e&&e.join(" > "),new xi(-200,n)}(function $o(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():uo(n)}(s[t]));const l=Ky(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?sl(o.injectImpl):null;on(n,i,Xo.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function El(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=Gy(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==u&&sl(u),Ky(l),o.resolving=!1,Ni()}}return r}function _(n,e,t){return!!(t[e+(n>>tw)]&1<<n)}function q(n,e){return!(n&Xo.Self||n&Xo.Host&&e)}class Ze{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return iw(this._tNode,this._lView,e,kc(i),t)}}function mt(){return new Ze(qa(),gi())}function yt(n){return wc(()=>{const e=n.prototype.constructor,t=e[Kl]||It(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Kl]||It(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function It(n){return tp(n)?()=>{const e=It(Us(n));return e&&e()}:mf(n)}function Xt(n){const e=n[vr],t=e.type;return 2===t?e.declTNode:1===t?n[ih]:null}function an(n){return function PM(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(Wh(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(qa(),n)}function fc(n,e=null,t=null,i){const r=pc(n,e,t,i);return r.resolveInjectorInitializers(),r}function pc(n,e=null,t=null,i,r=new Set){const s=[t||Ba,Fy(n)];return i=i||("object"==typeof n?void 0:zl(n)),new hp(s,e||Zm(),i||null,r)}class Dr{static#e=this.THROW_IF_NOT_FOUND=Il;static#t=this.NULL=new Kg;static create(e,t){if(Array.isArray(e))return fc({name:""},t,e,"");{const i=e.name??"";return fc({name:i},e.parent,e.providers,i)}}static#n=this.\u0275prov=$i({token:Dr,providedIn:"any",factory:()=>Wn(is)});static#i=this.__NG_ELEMENT_ID__=-1}new Ai("").__NG_ELEMENT_ID__=n=>{const e=qa();if(null===e)throw new xi(204,!1);if(2&e.type)return e.value;if(n&Xo.Optional)return null;throw new xi(204,!1)};function Ah(n){return n.ngOriginalError}const tu=!0;let mc=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=f0;static#t=this.__NG_ENV_ID__=t=>t}return n})();class bp extends mc{constructor(e){super(),this._lView=e}onDestroy(e){return ZA(this._lView,e),()=>function $y(n,e){if(null===n[bf])return;const t=n[bf].indexOf(e);-1!==t&&n[bf].splice(t,1)}(this._lView,e)}}function f0(){return new bp(gi())}let ed=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new dn(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#e=this.\u0275prov=$i({token:n,providedIn:"root",factory:()=>new n})}return n})();const os=class p0 extends Qt{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,Na()&&(this.destroyRef=oi(mc,{optional:!0})??void 0,this.pendingTasks=oi(ed,{optional:!0})??void 0)}emit(e){const t=Je(null);try{super.next(e)}finally{Je(t)}}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const h=e;r=h.next?.bind(h),s=h.error?.bind(h),o=h.complete?.bind(h)}this.__isAsync&&(s=this.wrapInTimeout(s),r&&(r=this.wrapInTimeout(r)),o&&(o=this.wrapInTimeout(o)));const l=super.subscribe({next:r,error:s,complete:o});return e instanceof pt&&e.add(l),l}wrapInTimeout(e){return t=>{const i=this.pendingTasks?.add();setTimeout(()=>{e(t),void 0!==i&&this.pendingTasks?.remove(i)})}}};function lA(...n){}function m0(n){let e,t;function i(){n=lA;try{void 0!==t&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(t),void 0!==e&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),"function"==typeof requestAnimationFrame&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function A0(n){return queueMicrotask(()=>n()),()=>{n=lA}}const la="isAngularZone",_a=la+"_ID";let Ir=0;class ns{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new os(!1),this.onMicrotaskEmpty=new os(!1),this.onStable=new os(!1),this.onError=new os(!1);const{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:s=tu}=e;if(typeof Zone>"u")throw new xi(908,!1);Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&i,o.shouldCoalesceRunChangeDetection=r,o.callbackScheduled=!1,o.scheduleInRootZone=s,function ag(n){const e=()=>{!function _d(n){function e(){m0(()=>{n.callbackScheduled=!1,n1(n),n.isCheckStableRunning=!0,nu(n),n.isCheckStableRunning=!1})}n.isCheckStableRunning||n.callbackScheduled||(n.callbackScheduled=!0,n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),n1(n))}(n)},t=Ir++;n._inner=n._inner.fork({name:"angular",properties:{[la]:!0,[_a]:t,[_a+t]:!0},onInvokeTask:(i,r,s,o,l,h)=>{if(function GP(n){return r3(n,"__ignore_ng_zone__")}(h))return i.invokeTask(s,o,l,h);try{return t3(n),i.invokeTask(s,o,l,h)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&e(),n3(n)}},onInvoke:(i,r,s,o,l,h,u)=>{try{return t3(n),i.invoke(s,o,l,h,u)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!function r1(n){return r3(n,"__scheduler_tick__")}(h)&&e(),n3(n)}},onHasTask:(i,r,s,o)=>{i.hasTask(s,o),r===s&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,n1(n),nu(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(i,r,s,o)=>(i.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get(la)}static assertInAngularZone(){if(!ns.isInAngularZone())throw new xi(909,!1)}static assertNotInAngularZone(){if(ns.isInAngularZone())throw new xi(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,wl,lA,lA);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const wl={};function nu(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function n1(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&!0===n.callbackScheduled)}function t3(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function n3(n){n._nesting--,nu(n)}class kM{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new os,this.onMicrotaskEmpty=new os,this.onStable=new os,this.onError=new os}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}function r3(n,e){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0]?.data?.[e]}class qd{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Ah(e);for(;t&&Ah(t);)t=Ah(t);return t||null}}const qP=new Ai("",{providedIn:"root",factory:()=>{const n=oi(ns),e=oi(qd);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function QP(){return lg(qa(),gi())}function lg(n,e){return new ro(Tc(n,e))}let ro=(()=>{class n{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=QP}return n})();function o1(n){return n instanceof ro?n.nativeElement:n}function x_(){return this._results[Symbol.iterator]()}class Bf{static#e=Symbol.iterator;get changes(){return this._changes??=new os}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const t=Bf.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=x_)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;const i=function Ih(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function t_(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}function cg(n){return!(128&~n.flags)}const w_=new Map;let a3=0;function l1(n){w_.delete(n[Jp])}const hw="__ngContext__";function iu(n,e){Sc(e)?(n[hw]=e[Jp],function c3(n){w_.set(n[Jp],n)}(e)):n[hw]=e}function f3(n){return p3(n[Nd])}function VM(n){return p3(n[Xu])}function p3(n){for(;null!==n&&!rh(n);)n=n[Xu];return n}let h1;const uA=new Ai("",{providedIn:"root",factory:()=>gw}),gw="ng",_w=new Ai(""),td=new Ai("",{providedIn:"platform",factory:()=>"unknown"}),gh=new Ai(""),u1=new Ai("",{providedIn:"root",factory:()=>function hA(){if(void 0!==h1)return h1;if(typeof document<"u")return document;throw new xi(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let E3=()=>null;function Mw(n,e,t=!1){return E3(n,e,t)}const Rw=new Ai("",{providedIn:"root",factory:()=>!1});let nb;function XM(n){return function Ow(){if(void 0===nb&&(nb=null,Cs.trustedTypes))try{nb=Cs.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return nb}()?.createScriptURL(n)||n}class g0{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${rl})`}}function oh(n){return n instanceof g0?n.changingThisBreaksApplicationSecurity:n}function fA(n,e){const t=function M_(n){return n instanceof g0&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${rl})`)}return t===e}const g1=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var su=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(su||{});function T_(n){const e=D_();return e?e.sanitize(su.URL,n)||"":fA(n,"URL")?oh(n):function cm(n){return(n=String(n)).match(g1)?n:"unsafe:"+n}(uo(n))}function ZM(n){const e=D_();if(e)return XM(e.sanitize(su.RESOURCE_URL,n)||"");if(fA(n,"ResourceURL"))return XM(oh(n));throw new xi(904,!1)}function D_(){const n=gi();return n&&n[Ld].sanitizer}const G3=/^>|^->|<!--|-->|--!>|<!-$/g,eE=/(<|>)/g,cR="\u200b$1\u200b";function Pf(n){return n instanceof Function?n():n}function Qd(n){return"browser"===(n??oi(Dr)).get(td)}var um=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(um||{});let lE;function P_(n,e){return lE(n,e)}function mg(n,e,t,i,r){if(null!=i){let s,o=!1;rh(i)?s=i:Sc(i)&&(o=!0,i=i[Ml]);const l=Pa(i);0===n&&null!==t?null==r?fE(e,t,l):E1(e,t,l,r||null,!0):1===n&&null!==t?E1(e,t,l,r||null,!0):2===n?function T1(n,e,t){n.removeChild(null,e,t)}(e,l,o):3===n&&e.destroyNode(l),null!=s&&function a(n,e,t,i,r){const s=t[Kh];s!==Pa(t)&&mg(e,n,i,s,r);for(let l=ec;l<t.length;l++){const h=t[l];Kw(h[vr],h,n,e,i,s)}}(e,n,s,t,r)}}function hE(n,e){return n.createComment(function tE(n){return n.replace(G3,e=>e.replace(eE,cR))}(e))}function M1(n,e,t){return n.createElement(e,t)}function Y3(n,e){e[Ld].changeDetectionScheduler?.notify(9),Kw(n,e,e[_o],2,null,null)}function uE(n,e){const t=n[tm],i=e[uc];(Sc(i)||e[Pl]!==i[uc][Pl])&&(n[Ys]|=WA.HasTransplantedViews),null===t?n[tm]=[e]:t.push(e)}function jw(n,e){const t=n[tm],i=t.indexOf(e);t.splice(i,1)}function Ww(n,e){if(n.length<=ec)return;const t=ec+e,i=n[t];if(i){const r=i[Zp];null!==r&&r!==n&&jw(r,i),e>0&&(n[t-1][Xu]=i[Xu]);const s=Al(n,ec+e);!function X3(n,e){Y3(n,e),e[Ml]=null,e[ih]=null}(i[vr],i);const o=s[Ud];null!==o&&o.detachView(s[vr]),i[uc]=null,i[Xu]=null,i[Ys]&=-129}return i}function R_(n,e){if(!(256&e[Ys])){const t=e[_o];t.destroyNode&&Kw(n,e,t,3,null,null),function E8(n){let e=n[Nd];if(!e)return dE(n[vr],n);for(;e;){let t=null;if(Sc(e))t=e[Nd];else{const i=e[ec];i&&(t=i)}if(!t){for(;e&&!e[Xu]&&e!==n;)Sc(e)&&dE(e[vr],e),e=e[uc];null===e&&(e=n),Sc(e)&&dE(e[vr],e),t=e&&e[Xu]}e=t}}(e)}}function dE(n,e){if(256&e[Ys])return;const t=Je(null);try{e[Ys]&=-129,e[Ys]|=256,e[Yh]&&K(e[Yh]),function K3(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof eu)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const l=r[s[o]],h=s[o+1];fp(4,l,h);try{h.call(l)}finally{fp(5,l,h)}}else{fp(4,r,s);try{s.call(r)}finally{fp(5,r,s)}}}}}(n,e),function S8(n,e){const t=n.cleanup,i=e[up];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[up]=null);const r=e[bf];if(null!==r){e[bf]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[vr].type&&e[_o].destroy();const i=e[Zp];if(null!==i&&rh(e[uc])){i!==e[uc]&&jw(i,e);const r=e[Ud];null!==r&&r.detachView(n)}l1(e)}finally{Je(t)}}function $w(n,e,t){return function v0(n,e,t){let i=e;for(;null!==i&&168&i.type;)i=(e=i).parent;if(null===i)return t[Ml];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Zl.None||s===Zl.Emulated)return null}return Tc(i,t)}}(n,e.parent,t)}function E1(n,e,t,i,r){n.insertBefore(e,t,i,r)}function fE(n,e,t){n.appendChild(e,t)}function bR(n,e,t,i,r){null!==i?E1(n,e,t,i,r):fE(n,e,t)}function Z3(n,e){return n.parentNode(e)}function eD(n,e,t){return Xw(n,e,t)}let mE,Xw=function pE(n,e,t){return 40&n.type?Tc(n,t):null};function Yw(n,e,t,i){const r=$w(n,i,e),s=e[_o],l=eD(i.parent||e[ih],i,e);if(null!=r)if(Array.isArray(t))for(let h=0;h<t.length;h++)bR(s,r,t[h],l,!1);else bR(s,r,t,l,!1);void 0!==mE&&mE(s,i,e,t,r)}function S1(n,e){if(null!==e){const t=e.type;if(3&t)return Tc(e,n);if(4&t)return _E(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return S1(n,i);{const r=n[e.index];return rh(r)?_E(-1,r):Pa(r)}}if(128&t)return S1(n,e.next);if(32&t)return P_(e,n)()||Pa(n[e.index]);{const i=gE(n,e);return null!==i?Array.isArray(i)?i[0]:S1(Mf(n[Pl]),i):S1(n,e.next)}}return null}function gE(n,e){return null!==e?n[Pl][ih].projection[e.projection]:null}function _E(n,e){const t=ec+n+1;if(t<e.length){const i=e[t],r=i[vr].firstChild;if(null!==r)return S1(i,r)}return e[Kh]}function yE(n,e,t,i,r,s,o){for(;null!=t;){if(128===t.type){t=t.next;continue}const l=i[t.index],h=t.type;if(o&&0===e&&(l&&iu(Pa(l),i),t.flags|=2),32&~t.flags)if(8&h)yE(n,e,t.child,i,r,s,!1),mg(e,n,r,l,s);else if(32&h){const u=P_(t,i);let f;for(;f=u();)mg(e,n,r,f,s);mg(e,n,r,l,s)}else 16&h?M(n,e,i,t,r,s):mg(e,n,r,l,s);t=o?t.projectionNext:t.next}}function Kw(n,e,t,i,r,s){yE(t,i,n.firstChild,e,r,s,!1)}function M(n,e,t,i,r,s){const o=t[Pl],h=o[ih].projection[i.projection];if(Array.isArray(h))for(let u=0;u<h.length;u++)mg(e,n,r,h[u],s);else{let u=h;const f=o[uc];cg(i)&&(u.flags|=128),yE(n,e,u,f,r,s,!0)}}function p(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function S(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&jc(n,e,i),null!==r&&p(n,e,r),null!==s&&function d(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}const U={};function F(n=1){ue(fo(),gi(),Cr()+n,!1)}function ue(n,e,t,i){if(!i)if(3&~e[Ys]){const s=n.preOrderHooks;null!==s&&ka(e,s,0,t)}else{const s=n.preOrderCheckHooks;null!==s&&Ra(e,s,t)}Co(t)}function Q(n,e=Xo.Default){const t=gi();return null===t?Wn(n,e):iw(qa(),t,Us(n),e)}function Me(){throw new Error("invalid")}function ke(n,e,t,i,r,s){const o=Je(null);try{let l=null;r&Id.SignalBased&&(l=e[i][xe]),null!==l&&void 0!==l.transformFn&&(s=l.transformFn(s)),r&Id.HasDecoratorInputTransform&&(s=n.inputTransforms[i].call(e,s)),null!==n.setInput?n.setInput(e,l,s,t,i):p_(e,l,i,s)}finally{Je(o)}}function Ge(n,e,t,i,r,s,o,l,h,u,f){const y=e.blueprint.slice();return y[Ml]=r,y[Ys]=204|i,(null!==u||n&&2048&n[Ys])&&(y[Ys]|=2048),rA(y),y[uc]=y[vf]=n,y[hl]=t,y[Ld]=o||n&&n[Ld],y[_o]=l||n&&n[_o],y[Ec]=h||n&&n[Ec]||null,y[ih]=s,y[Jp]=function l3(){return a3++}(),y[$c]=f,y[s0]=u,y[Pl]=2==e.type?n[Pl]:y,y}function et(n,e,t,i,r){let s=n.data[e];if(null===s)s=function vt(n,e,t,i,r){const s=tg(),o=Vd(),h=n.data[e]=function Yn(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,l=0;return nc()&&(l|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:l,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=h),null!==s&&(o?null==s.child&&null!==h.parent&&(s.child=h):null===s.next&&(s.next=h,h.prev=s)),h}(n,e,t,i,r),function ig(){return Br.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function sm(){const n=Br.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Zh(s,!0),s}function Ye(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function je(n,e,t,i,r){const s=Cr(),o=2&i;try{Co(-1),o&&e.length>Fs&&ue(n,e,Fs,!1),fp(o?2:0,r),t(i,r)}finally{Co(s),fp(o?3:1,r)}}function Rt(n,e,t){if(l_(e)){const i=Je(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const l=n.data[o];l.contentQueries&&l.contentQueries(1,t[o],o)}}finally{Je(i)}}}function At(n,e,t){Ef()&&(function bo(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;nm(t)&&function fr(n,e,t){const i=Tc(e,n),r=Pn(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const l=zi(n,Ge(n,r,null,o,i,e,null,n[Ld].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=l}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Zy(t,e),iu(i,e);const o=t.initialInputs;for(let l=r;l<s;l++){const h=n.data[l],u=og(e,n,l,t);iu(u,e),null!==o&&Zs(0,l-r,u,h,0,o),Yu(h)&&(Js(t.index,e)[hl]=og(e,n,l,t))}}(n,e,t,Tc(t,e)),!(64&~t.flags)&&eo(n,e,t))}function Ht(n,e,t=Tc){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],l=-1===o?t(e,n):n[o];n[r++]=l}}}function Pn(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=yn(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function yn(n,e,t,i,r,s,o,l,h,u,f){const y=Fs+i,T=y+r,B=function xn(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:U);return t}(y,T),j="function"==typeof u?u():u;return B[vr]={type:n,blueprint:B,template:t,queries:null,viewQuery:l,declTNode:e,data:B.slice().fill(null,y),bindingStartIndex:y,expandoStartIndex:T,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:h,consts:j,incompleteFirstPass:!1,ssrId:f}}let Ut=()=>null;function Qi(n,e,t,i,r){for(let s in e){if(!e.hasOwnProperty(s))continue;const o=e[s];if(void 0===o)continue;i??={};let l,h=Id.None;Array.isArray(o)?(l=o[0],h=o[1]):l=o;let u=s;if(null!==r){if(!r.hasOwnProperty(s))continue;u=r[s]}0===n?Oi(i,t,u,l,h):Oi(i,t,u,l)}return i}function Oi(n,e,t,i,r){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,i):s=n[t]=[e,i],void 0!==r&&s.push(r)}function Vi(n,e,t,i,r,s,o,l){const h=Tc(e,t);let f,u=e.inputs;!l&&null!=u&&(f=u[i])?(cs(n,t,f,i,r),nm(e)&&function Vr(n,e){const t=Js(e,n);16&t[Ys]||(t[Ys]|=64)}(t,e.index)):3&e.type&&(i=function Xi(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(h,i,r))}function Yo(n,e,t,i){if(Ef()){const r=null===i?null:{"":-1},s=function fa(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(Rd(e,o.selectors,!1))if(i||(i=[]),Yu(o))if(null!==o.findHostDirectiveDefs){const l=[];r=r||new Map,o.findHostDirectiveDefs(o,l,r),i.unshift(...l,o),Ao(n,e,l.length)}else i.unshift(o),Ao(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,l;null===s?o=l=null:[o,l]=s,null!==o&&Hi(n,e,t,o,r,l),r&&function On(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new xi(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=gf(t.mergedAttrs,t.attrs)}function Hi(n,e,t,i,r,s){for(let u=0;u<i.length;u++)Gd(Zy(t,e),n,i[u].type);!function Zi(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let u=0;u<i.length;u++){const f=i[u];f.providersResolver&&f.providersResolver(f)}let o=!1,l=!1,h=Ye(n,e,i.length,null);for(let u=0;u<i.length;u++){const f=i[u];t.mergedAttrs=gf(t.mergedAttrs,f.hostAttrs),$r(n,t,e,h,f),Zr(h,f,r),null!==f.contentQueries&&(t.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(t.flags|=64);const y=f.type.prototype;!o&&(y.ngOnChanges||y.ngOnInit||y.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!l&&(y.ngOnChanges||y.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),l=!0),h++}!function er(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,l=[];let h=null,u=null;for(let f=e.directiveStart;f<r;f++){const y=s[f],T=t?t.get(y):null,j=T?T.outputs:null;h=Qi(0,y.inputs,f,h,T?T.inputs:null),u=Qi(1,y.outputs,f,u,j);const ne=null===h||null===o||_f(e)?null:za(h,f,o);l.push(ne)}null!==h&&(h.hasOwnProperty("class")&&(e.flags|=8),h.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=l,e.inputs=h,e.outputs=u}(n,t,s)}function eo(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function Z(){return Br.lFrame.currentDirectiveIndex}();try{Co(s);for(let l=i;l<r;l++){const h=n.data[l],u=e[l];ae(l),(null!==h.hostBindings||0!==h.hostVars||null!==h.hostAttrs)&&Qs(h,u)}}finally{Co(-1),ae(o)}}function Qs(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Ao(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function Zr(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Yu(e)&&(t[""]=n)}}function $r(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=mf(r.type)),o=new eu(s,Yu(r),Q);n.blueprint[i]=o,t[i]=o,function Or(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const l=~e.index;(function Ds(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=l&&o.push(l),o.push(t,i,s)}}(n,e,i,Ye(n,t,r.hostVars,U),r)}function As(n,e,t,i,r,s){const o=Tc(n,e);!function Ms(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const l=null==o?uo(s):o(s,i||"",r);n.setAttribute(e,r,l,t)}}(e[_o],o,s,n.value,t,i,r)}function Zs(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let l=0;l<o.length;)ke(i,t,o[l++],o[l++],o[l++],o[l++])}function za(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let l=0;l<o.length;l+=3)if(o[l]===e){i.push(s,o[l+1],o[l+2],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function wn(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function Gt(n,e){const t=n.contentQueries;if(null!==t){const i=Je(null);try{for(let r=0;r<t.length;r+=2){const o=t[r+1];if(-1!==o){const l=n.data[o];ft(t[r]),l.contentQueries(2,e[o],o)}}}finally{Je(i)}}}function zi(n,e){return n[Nd]?n[r0][Xu]=e:n[Nd]=e,n[r0]=e,e}function ji(n,e,t){ft(0);const i=Je(null);try{e(n,t)}finally{Je(i)}}function br(n){return n[up]??=[]}function ta(n){return n.cleanup??=[]}function Xr(n,e){const t=n[Ec],i=t?t.get(qd,null):null;i&&i.handleError(e)}function cs(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],l=t[s++],h=t[s++];ke(n.data[o],e[o],i,l,h,r)}}function Yr(n,e){const t=Js(e,n),i=t[vr];!function _h(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[Ml];null!==r&&null===t[$c]&&(t[$c]=Mw(r,t[Ec])),Sa(i,t,t[hl])}function Sa(n,e,t){sn(e);try{const i=n.viewQuery;null!==i&&ji(1,i,t);const r=n.template;null!==r&&je(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Ud]?.finishViewCreation(n),n.staticContentQueries&&Gt(n,e),n.staticViewQueries&&ji(2,n.viewQuery,t);const s=n.components;null!==s&&function So(n,e){for(let t=0;t<e.length;t++)Yr(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Ys]&=-5,us()}}function $s(n,e,t,i){const r=Je(null);try{const s=e.tView,h=Ge(n,s,t,4096&n[Ys]?4096:16,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);h[Zp]=n[e.index];const f=n[Ud];return null!==f&&(h[Ud]=f.createEmbeddedView(s)),Sa(s,h,t),h}finally{Je(r)}}function po(n,e){const t=ec+e;if(t<n.length)return n[t]}function ya(n,e){return!e||null===e.firstChild||cg(n)}function Qo(n,e,t,i=!0){const r=e[vr];if(function vR(n,e,t,i){const r=ec+i,s=t.length;i>0&&(t[r-1][Xu]=e),i<s-ec?(e[Xu]=t[r],Qp(t,ec+i,e)):(t.push(e),e[Xu]=null),e[uc]=t;const o=e[Zp];null!==o&&t!==o&&uE(o,e);const l=e[Ud];null!==l&&l.insertView(n),g_(e),e[Ys]|=128}(r,e,n,t),i){const o=_E(t,n),l=e[_o],h=Z3(l,n[Kh]);null!==h&&function yR(n,e,t,i,r,s){i[Ml]=r,i[ih]=e,Kw(n,i,t,1,r,s)}(r,n[ih],l,e,h,o)}const s=e[$c];null!==s&&null!==s.firstChild&&(s.firstChild=null)}function rc(n,e){const t=Ww(n,e);return void 0!==t&&R_(t[vr],t),t}function Jn(n,e,t,i,r=!1){for(;null!==t;){if(128===t.type){t=r?t.projectionNext:t.next;continue}const s=e[t.index];null!==s&&i.push(Pa(s)),rh(s)&&gs(s,i);const o=t.type;if(8&o)Jn(n,e,t.child,i);else if(32&o){const l=P_(t,e);let h;for(;h=l();)i.push(h)}else if(16&o){const l=gE(e,t);if(Array.isArray(l))i.push(...l);else{const h=Mf(e[Pl]);Jn(h[vr],h,l,i,!0)}}t=r?t.projectionNext:t.next}return i}function gs(n,e){for(let t=ec;t<n.length;t++){const i=n[t],r=i[vr].firstChild;null!==r&&Jn(i[vr],i,r,e)}n[Kh]!==n[Ml]&&e.push(n[Kh])}let Bi=[];const sc={...Re,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{__(n.lView)},consumerOnSignalRead(){this.lView[Yh]=this}},xp={...Re,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{let e=Mf(n.lView);for(;e&&!Wl(e[vr]);)e=Mf(e);e&&sh(e)},consumerOnSignalRead(){this.lView[Yh]=this}};function Wl(n){return 2!==n.type}const bd=100;function Rf(n,e=!0,t=0){const i=n[Ld],r=i.rendererFactory;r.begin?.();try{!function tD(n,e){const t=d0();try{ng(!0),xE(n,e);let i=0;for(;sA(n);){if(i===bd)throw new xi(103,!1);i++,xE(n,1)}}finally{ng(t)}}(n,t)}catch(o){throw e&&Xr(n,o),o}finally{r.end?.(),i.inlineEffectRunner?.flush()}}function Zw(n,e,t,i){const r=e[Ys];if(!(256&~r))return;e[Ld].inlineEffectRunner?.flush(),sn(e);let l=!0,h=null,u=null;Wl(n)?(u=function ts(n){return n[Yh]??function Es(n){const e=Bi.pop()??Object.create(sc);return e.lView=n,e}(n)}(e),h=de(u)):null===function st(){return v}()?(l=!1,u=function Tu(n){const e=n[Yh]??Object.create(xp);return e.lView=n,e}(e),h=de(u)):e[Yh]&&(K(e[Yh]),e[Yh]=null);try{rA(e),function aA(n){return Br.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&je(n,e,t,2,i);const f=!(3&~r);if(f){const B=n.preOrderCheckHooks;null!==B&&Ra(e,B,null)}else{const B=n.preOrderHooks;null!==B&&ka(e,B,0,null),Fc(e,0)}if(function Jw(n){for(let e=f3(n);null!==e;e=VM(e)){if(!(e[Ys]&WA.HasTransplantedViews))continue;const t=e[tm];for(let i=0;i<t.length;i++)sh(t[i])}}(e),vE(e,0),null!==n.contentQueries&&Gt(n,e),f){const B=n.contentCheckHooks;null!==B&&Ra(e,B)}else{const B=n.contentHooks;null!==B&&ka(e,B,1),Fc(e,1)}!function Oe(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)Co(~r);else{const s=r,o=t[++i],l=t[++i];te(o,s),l(2,e[s])}}}finally{Co(-1)}}(n,e);const y=n.components;null!==y&&rD(e,y,0);const T=n.viewQuery;if(null!==T&&ji(2,T,i),f){const B=n.viewCheckHooks;null!==B&&Ra(e,B)}else{const B=n.viewHooks;null!==B&&ka(e,B,2),Fc(e,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[QA]){for(const B of e[QA])B();e[QA]=null}e[Ys]&=-73}catch(f){throw __(e),f}finally{null!==u&&(pe(u,h),l&&function Qa(n){n.lView[Yh]!==n&&(n.lView=null,Bi.push(n))}(u)),us()}}function vE(n,e){for(let t=f3(n);null!==t;t=VM(t))for(let i=ec;i<t.length;i++)bE(t[i],e)}function iD(n,e,t){bE(Js(e,n),t)}function bE(n,e){YA(n)&&xE(n,e)}function xE(n,e){const i=n[vr],r=n[Ys],s=n[Yh];let o=!!(0===e&&16&r);if(o||=!!(64&r&&0===e),o||=!!(1024&r),o||=!(!s?.dirty||!ce(s)),o||=!1,s&&(s.dirty=!1),n[Ys]&=-9217,o)Zw(i,n,i.template,n[hl]);else if(8192&r){vE(n,1);const l=i.components;null!==l&&rD(n,l,1)}}function rD(n,e,t){for(let i=0;i<e.length;i++)iD(n,e[i],t)}function fb(n,e){const t=d0()?64:1088;for(n[Ld].changeDetectionScheduler?.notify(e);n;){n[Ys]|=t;const i=Mf(n);if(bl(n)&&!i)return n;n=i}return null}class hn{get rootNodes(){const e=this._lView,t=e[vr];return Jn(t,e,t.firstChild,[])}constructor(e,t,i=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[hl]}set context(e){this._lView[hl]=e}get destroyed(){return!(256&~this._lView[Ys])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[uc];if(rh(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Ww(e,i),Al(t,i))}this._attachedToViewContainer=!1}R_(this._lView[vr],this._lView)}onDestroy(e){ZA(this._lView,e)}markForCheck(){fb(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Ys]&=-129}reattach(){g_(this._lView),this._lView[Ys]|=128}detectChanges(){this._lView[Ys]|=1024,Rf(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new xi(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const e=bl(this._lView),t=this._lView[Zp];null!==t&&!e&&jw(t,this._lView),Y3(this._lView[vr],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new xi(902,!1);this._appRef=e;const t=bl(this._lView),i=this._lView[Zp];null!==i&&!t&&uE(i,this._lView),g_(this._lView)}}let ni=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=Mi}return n})();const Pi=ni,Li=class extends Pi{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=$s(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:i});return new hn(r)}};function Mi(){return Ts(qa(),gi())}function Ts(n,e){return 4&n.type?new Li(e,n,lg(n,e)):null}let V8=()=>null;function gb(n,e){return V8(n,e)}class n2{}const TE=new Ai("",{providedIn:"root",factory:()=>!1}),G8=new Ai(""),IR=new Ai("");class hJ{}class q8{}class dJ{resolveComponentFactory(e){throw function uJ(n){const e=Error(`No component factory found for ${zl(n)}.`);return e.ngComponent=n,e}(e)}}class _b{static#e=this.NULL=new dJ}class hD{}let L_=(()=>{class n{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function fJ(){const n=gi(),t=Js(qa().index,n);return(Sc(t)?t:n)[_o]}()}return n})(),pJ=(()=>{class n{static#e=this.\u0275prov=$i({token:n,providedIn:"root",factory:()=>null})}return n})();function dD(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const l=e[o];"number"==typeof l?s=l:1==s?r=cf(r,l):2==s&&(i=cf(i,l+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}class $8 extends _b{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Ro(e);return new BE(t,this.ngModule)}}function X8(n,e){const t=[];for(const i in n){if(!n.hasOwnProperty(i))continue;const r=n[i];if(void 0===r)continue;const s=Array.isArray(r),o=s?r[0]:r;t.push(e?{propName:o,templateName:i,isSignal:!!((s?r[1]:Id.None)&Id.SignalBased)}:{propName:o,templateName:i})}return t}class BE extends q8{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=X8(e.inputs,!0);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return X8(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Ph(n){return n.map(hc).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){const s=Je(null);try{let o=(r=r||this.ngModule)instanceof th?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const l=o?new sg(e,o):e,h=l.get(hD,null);if(null===h)throw new xi(407,!1);const y={rendererFactory:h,sanitizer:l.get(pJ,null),inlineEffectRunner:null,changeDetectionScheduler:l.get(n2,null)},T=h.createRenderer(null,this.componentDef),B=this.componentDef.selectors[0][0]||"div",j=i?function qn(n,e,t,i){const s=i.get(Rw,!1)||t===Zl.ShadowDom,o=n.selectRootElement(e,s);return function wi(n){Ut(n)}(o),o}(T,i,this.componentDef.encapsulation,l):M1(T,B,function gJ(n){const e=n.toLowerCase();return"svg"===e?A_:"math"===e?"math":null}(B));let ne=512;this.componentDef.signals?ne|=4096:this.componentDef.onPush||(ne|=16);let se=null;null!==j&&(se=Mw(j,l,!0));const le=yn(0,null,null,1,0,null,null,null,null,null,null),Ee=Ge(null,le,null,ne,null,null,y,T,l,null,se);sn(Ee);let Pe,Ve,Ft=null;try{const Ct=this.componentDef;let Lt,Kt=null;Ct.findHostDirectiveDefs?(Lt=[],Kt=new Map,Ct.findHostDirectiveDefs(Ct,Lt,Kt),Lt.push(Ct)):Lt=[Ct];const Bt=function yJ(n,e){const t=n[vr],i=Fs;return n[i]=e,et(t,i,2,"#host",null)}(Ee,j);Ft=function vJ(n,e,t,i,r,s,o){const l=r[vr];!function bJ(n,e,t,i){for(const r of n)e.mergedAttrs=gf(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(dD(e,e.mergedAttrs,!0),null!==t&&S(i,t,e))}(i,n,e,o);let h=null;null!==e&&(h=Mw(e,r[Ec]));const u=s.rendererFactory.createRenderer(e,t);let f=16;t.signals?f=4096:t.onPush&&(f=64);const y=Ge(r,Pn(t),null,f,r[n.index],n,s,u,null,null,h);return l.firstCreatePass&&Ao(l,n,i.length-1),zi(r,y),r[n.index]=y}(Bt,j,Ct,Lt,Ee,y,T),Ve=tc(le,Fs),j&&function wJ(n,e,t,i){if(i)jc(n,t,["ng-version","18.2.2"]);else{const{attrs:r,classes:s}=function $h(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Cc(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&jc(n,t,r),s&&s.length>0&&p(n,t,s.join(" "))}}(T,Ct,j,i),void 0!==t&&function CJ(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(Ve,this.ngContentSelectors,t),Pe=function xJ(n,e,t,i,r,s){const o=qa(),l=r[vr],h=Tc(o,r);Hi(l,r,o,t,null,i);for(let f=0;f<t.length;f++)iu(og(r,l,o.directiveStart+f,o),r);eo(l,r,o),h&&iu(h,r);const u=og(r,l,o.directiveStart+o.componentOffset,o);if(n[hl]=r[hl]=u,null!==s)for(const f of s)f(u,e);return Rt(l,o,r),u}(Ft,Ct,Lt,Kt,Ee,[MJ]),Sa(le,Ee,null)}catch(Ct){throw null!==Ft&&l1(Ft),l1(Ee),Ct}finally{us()}return new _J(this.componentType,Pe,lg(Ve,Ee),Ee,Ve)}finally{Je(s)}}}class _J extends hJ{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new hn(r,void 0,!1),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;cs(s[vr],s,r,e,t),this.previousInputValues.set(e,t),fb(Js(this._tNode.index,s),1)}}get injector(){return new Ze(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function MJ(){const n=qa();Ea(gi()[vr],n)}let Fh=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=EJ}return n})();function EJ(){return Z8(qa(),gi())}const SJ=Fh,Y8=class extends SJ{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return lg(this._hostTNode,this._hostLView)}get injector(){return new Ze(this._hostTNode,this._hostLView)}get parentInjector(){const e=Jy(this._hostTNode,this._hostLView);if(Yy(e)){const t=b_(e,this._hostLView),i=v_(e);return new Ze(t[vr].data[i+8],t)}return new Ze(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=K8(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-ec}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const o=gb(this._lContainer,e.ssrId),l=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(l,r,ya(this._hostTNode,o)),l}createComponent(e,t,i,r,s){const o=e&&!function Jm(n){return"function"==typeof n}(e);let l;if(o)l=t;else{const j=t||{};l=j.index,i=j.injector,r=j.projectableNodes,s=j.environmentInjector||j.ngModuleRef}const h=o?e:new BE(Ro(e)),u=i||this.parentInjector;if(!s&&null==h.ngModule){const ne=(o?u:this.parentInjector).get(th,null);ne&&(s=ne)}const f=Ro(h.componentType??{}),y=gb(this._lContainer,f?.id??null),B=h.create(u,r,y?.firstChild??null,s);return this.insertImpl(B.hostView,l,ya(this._hostTNode,y)),B}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){const r=e._lView;if(function Wy(n){return rh(n[uc])}(r)){const l=this.indexOf(e);if(-1!==l)this.detach(l);else{const h=r[uc],u=new Y8(h,h[ih],h[uc]);u.detach(u.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;return Qo(o,r,s,i),e.attachToViewContainerRef(),Qp(RR(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=K8(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Ww(this._lContainer,t);i&&(Al(RR(this._lContainer),t),R_(i[vr],i))}detach(e){const t=this._adjustIndex(e,-1),i=Ww(this._lContainer,t);return i&&null!=Al(RR(this._lContainer),t)?new hn(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function K8(n){return n[8]}function RR(n){return n[8]||(n[8]=[])}function Z8(n,e){let t;const i=e[n.index];return rh(i)?t=i:(t=wn(i,e,null,n),e[n.index]=t,zi(e,t)),J8(t,e,n,i),new Y8(t,n,e)}let J8=function tU(n,e,t,i){if(n[Kh])return;let r;r=8&t.type?Pa(i):function TJ(n,e){const t=n[_o],i=t.createComment(""),r=Tc(e,n);return E1(t,Z3(t,r),i,function J3(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[Kh]=r},kR=()=>!1;class FR{constructor(e){this.queryList=e,this.matches=null}clone(){return new FR(this.queryList)}setDirty(){this.queryList.setDirty()}}class OR{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new OR(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==HR(e,t).matches&&this.queries[t].setDirty()}}class nU{constructor(e,t,i=null){this.flags=t,this.read=i,this.predicate="string"==typeof e?function OJ(n){return n.split(",").map(e=>e.trim())}(e):e}}class LR{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new LR(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class NR{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new NR(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1&~this.metadata.flags){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,PJ(t,s)),this.matchTNodeWithReadOption(e,t,e1(t,e,s,!1,!1))}else i===ni?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,e1(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===ro||r===Fh||r===ni&&4&t.type)this.addMatch(t.index,-2);else{const s=e1(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function PJ(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function kJ(n,e,t,i){return-1===t?function RJ(n,e){return 11&n.type?lg(n,e):4&n.type?Ts(n,e):null}(e,n):-2===t?function FJ(n,e,t){return t===ro?lg(e,n):t===ni?Ts(e,n):t===Fh?Z8(e,n):void 0}(n,e,i):og(n,n[vr],t,e)}function iU(n,e,t,i){const r=e[Ud].queries[i];if(null===r.matches){const s=n.data,o=t.matches,l=[];for(let h=0;null!==o&&h<o.length;h+=2){const u=o[h];l.push(u<0?null:kJ(e,s[u],o[h+1],t.metadata.read))}r.matches=l}return r.matches}function UR(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=iU(n,e,r,t);for(let l=0;l<s.length;l+=2){const h=s[l];if(h>0)i.push(o[l/2]);else{const u=s[l+1],f=e[-h];for(let y=ec;y<f.length;y++){const T=f[y];T[Zp]===T[uc]&&UR(T[vr],T,u,i)}if(null!==f[tm]){const y=f[tm];for(let T=0;T<y.length;T++){const B=y[T];UR(B[vr],B,u,i)}}}}}return i}function rU(n,e,t){const i=new Bf(!(4&~t));return function lr(n,e,t,i){const r=br(e);r.push(t),n.firstCreatePass&&ta(n).push(i,r.length-1)}(n,e,i,i.destroy),(e[Ud]??=new OR).queries.push(new FR(i))-1}function aU(n,e,t){null===n.queries&&(n.queries=new LR),n.queries.track(new NR(e,t))}function HR(n,e){return n.queries.getByIndex(e)}function lU(n,e){const t=n[vr],i=HR(t,e);return i.crossesNgTemplate?UR(t,n,e,[]):iU(t,n,i,e)}const cU=new Set;function Of(n){cU.has(n)||(cU.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function fD(n){return"function"==typeof n&&void 0!==n[xe]}function N_(n,e){Of("NgSignals");const t=function A(n){const e=Object.create(Se);e.value=n;const t=()=>(Qe(e),e.value);return t[xe]=e,t}(n),i=t[xe];return e?.equal&&(i.equal=e.equal),t.set=r=>ee(i,r),t.update=r=>function ge(n,e){re()||z(),ee(n,e(n.value))}(i,r),t.asReadonly=hU.bind(t),t}function hU(){const n=this[xe];if(void 0===n.readonlyFn){const e=()=>this();e[xe]=n,n.readonlyFn=e}return n.readonlyFn}function uU(n){return fD(n)&&"function"==typeof n.set}function Fo(n){let e=function xU(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Yu(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new xi(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=mD(n.inputs),o.inputTransforms=mD(n.inputTransforms),o.declaredInputs=mD(n.declaredInputs),o.outputs=mD(n.outputs);const l=r.hostBindings;l&&KJ(n,l);const h=r.viewQuery,u=r.contentQueries;if(h&&XJ(n,h),u&&YJ(n,u),WJ(n,r),Fm(n.outputs,r.outputs),Yu(r)&&r.data.animation){const f=n.data;f.animation=(f.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const l=s[o];l&&l.ngInherit&&l(n),l===Fo&&(t=!1)}}e=Object.getPrototypeOf(e)}!function $J(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=gf(r.hostAttrs,t=gf(t,r.hostAttrs))}}(i)}function WJ(n,e){for(const t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;const i=e.inputs[t];if(void 0!==i&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t],null!==e.inputTransforms)){const r=Array.isArray(i)?i[0]:i;if(!e.inputTransforms.hasOwnProperty(r))continue;n.inputTransforms??={},n.inputTransforms[r]=e.inputTransforms[r]}}}function mD(n){return n===Bh?{}:n===Ba?[]:n}function XJ(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function YJ(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function KJ(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function wU(n){const e=t=>{const i=(Array.isArray(n)?n:n()).map(r=>"function"==typeof r?{directive:Us(r),inputs:Bh,outputs:Bh}:{directive:Us(r.directive),inputs:MU(r.inputs),outputs:MU(r.outputs)});null===t.hostDirectives?(t.findHostDirectiveDefs=CU,t.hostDirectives=i):t.hostDirectives.unshift(...i)};return e.ngInherit=!0,e}function CU(n,e,t){if(null!==n.hostDirectives)for(const i of n.hostDirectives){const r=vl(i.directive);tee(r.declaredInputs,i.inputs),CU(r,e,t),t.set(r,i),e.push(r)}}function MU(n){if(void 0===n||0===n.length)return Bh;const e={};for(let t=0;t<n.length;t+=2)e[n[t]]=n[t+1];return e}function tee(n,e){for(const t in e)e.hasOwnProperty(t)&&(n[e[t]]=n[t])}function kl(n){const e=n.inputConfig,t={};for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];Array.isArray(r)&&r[3]&&(t[i]=r[3])}n.inputTransforms=t}class yb{}class SU{}class GR extends yb{constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new $8(this);const s=ql(e);this._bootstrapComponents=Pf(s.bootstrap),this._r3Injector=pc(e,t,[{provide:yb,useValue:this},{provide:_b,useValue:this.componentFactoryResolver},...i],zl(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class qR extends SU{constructor(e){super(),this.moduleType=e}create(e){return new GR(this.moduleType,e,[])}}class TU extends yb{constructor(e){super(),this.componentFactoryResolver=new $8(this),this.instance=null;const t=new hp([...e.providers,{provide:yb,useValue:this},{provide:_b,useValue:this.componentFactoryResolver}],e.parent||Zm(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function AD(n,e,t=null){return new TU({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}function gD(n){return!!QR(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function QR(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function b0(n,e,t){return n[e]=t}function Oh(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function vb(n,e,t,i){const r=Oh(n,e,t);return Oh(n,e+1,i)||r}function kE(n,e,t,i,r,s,o,l,h,u){const f=t+Fs,y=e.firstCreatePass?function lee(n,e,t,i,r,s,o,l,h){const u=e.consts,f=et(e,n,4,o||null,l||null);Yo(e,t,f,Ql(u,h)),Ea(e,f);const y=f.tView=yn(2,f,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return null!==e.queries&&(e.queries.template(e,f),y.queries=e.queries.embeddedTView(f)),f}(f,e,n,i,r,s,o,l,h):e.data[f];Zh(y,!1);const T=DU(e,n,y,t);aa()&&Yw(e,n,T,y),iu(T,n);const B=wn(T,n,T,y);return n[f]=B,zi(n,B),function eU(n,e,t){return kR(n,e,t)}(B,y,n),xf(y)&&At(e,n,y),null!=h&&Ht(n,y,u),y}function Rs(n,e,t,i,r,s,o,l){const h=gi(),u=fo();return kE(h,u,n,e,t,i,r,Ql(u.consts,s),o,l),Rs}let DU=function IU(n,e,t,i){return Ks(!0),e[_o].createComment("")};var a2=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(a2||{});let OU=(()=>{class n{constructor(){this.impl=null}execute(){this.impl?.execute()}static#e=this.\u0275prov=$i({token:n,providedIn:"root",factory:()=>new n})}return n})();class LE{constructor(){this.ngZone=oi(ns),this.scheduler=oi(n2),this.errorHandler=oi(qd,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static#e=this.PHASES=[a2.EarlyRead,a2.Write,a2.MixedReadWrite,a2.Read];execute(){this.executing=!0;for(const e of LE.PHASES)for(const t of this.sequences)if(!t.erroredOrDestroyed&&t.hooks[e])try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(i){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(i)}this.executing=!1;for(const e of this.sequences)e.afterRun(),e.once&&this.sequences.delete(e);for(const e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static#t=this.\u0275prov=$i({token:LE,providedIn:"root",factory:()=>new LE})}class dee{constructor(e,t,i,r){this.impl=e,this.hooks=t,this.once=i,this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.unregisterOnDestroy=r.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0}destroy(){this.impl.unregister(this),this.unregisterOnDestroy()}}function AA(n,e){!e?.injector&&o_();const t=e?.injector??oi(Dr);return Qd(t)?(Of("NgAfterNextRender"),NU(n,t,e,!0)):UU}function NU(n,e,t,i){const r=e.get(OU);r.impl??=e.get(LE);const o=new dee(r.impl,function fee(n,e){if(n instanceof Function){const t=[void 0,void 0,void 0,void 0];return t[e]=n,t}return[n.earlyRead,n.write,n.mixedReadWrite,n.read]}(n,t?.phase??a2.MixedReadWrite),i,e.get(mc));return r.impl.register(o),o}const UU={destroy(){}};function ja(n,e,t,i){const r=gi();return Oh(r,Eu(),e)&&(fo(),As(kr(),r,n,e,t,i)),ja}function p2(n,e,t,i){return Oh(n,Eu(),t)?e+uo(t)+i:U}function m2(n,e,t,i,r,s){const l=vb(n,function mh(){return Br.lFrame.bindingIndex}(),t,r);return gd(2),l?e+uo(t)+i+uo(r)+s:U}function x2(n,e,t,i,r,s,o,l){const h=gi(),u=m2(h,e,t,i,r,s);return u!==U&&As(kr(),h,n,u,o,l),x2}function CD(n,e){return n<<17|e<<2}function R1(n){return n>>17&32767}function nk(n){return 2|n}function xb(n){return(131068&n)>>2}function ik(n,e){return-131069&n|e<<2}function rk(n){return 1|n}function h7(n,e,t,i){const r=n[t+1],s=null===e;let o=i?R1(r):xb(r),l=!1;for(;0!==o&&(!1===l||s);){const u=n[o+1];Xee(n[o],e)&&(l=!0,n[o+1]=i?rk(u):nk(u)),o=i?R1(u):xb(u)}l&&(n[t+1]=i?nk(r):rk(r))}function Xee(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Bl(n,e)>=0}const Bu={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function u7(n){return n.substring(Bu.key,Bu.keyEnd)}function Yee(n){return n.substring(Bu.value,Bu.valueEnd)}function d7(n,e){const t=Bu.textEnd;return t===e?-1:(e=Bu.keyEnd=function Jee(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,Bu.key=e,t),w2(n,e,t))}function f7(n,e){const t=Bu.textEnd;let i=Bu.key=w2(n,e,t);return t===i?-1:(i=Bu.keyEnd=function ete(n,e,t){let i;for(;e<t&&(45===(i=n.charCodeAt(e))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)e++;return e}(n,i,t),i=m7(n,i,t),i=Bu.value=w2(n,i,t),i=Bu.valueEnd=function tte(n,e,t){let i=-1,r=-1,s=-1,o=e,l=o;for(;o<t;){const h=n.charCodeAt(o++);if(59===h)return l;34===h||39===h?l=o=A7(n,h,o,t):e===o-4&&85===s&&82===r&&76===i&&40===h?l=o=A7(n,41,o,t):h>32&&(l=o),s=r,r=i,i=-33&h}return l}(n,i,t),m7(n,i,t))}function p7(n){Bu.key=0,Bu.keyEnd=0,Bu.value=0,Bu.valueEnd=0,Bu.textEnd=n.length}function w2(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function m7(n,e,t,i){return(e=w2(n,e,t))<t&&e++,e}function A7(n,e,t,i){let r=-1,s=t;for(;s<i;){const o=n.charCodeAt(s++);if(o==e&&92!==r)return s;r=92==o&&92===r?0:o}throw new Error}function jn(n,e,t){const i=gi();return Oh(i,Eu(),e)&&Vi(fo(),kr(),i,n,e,i[_o],t,!1),jn}function sk(n,e,t,i,r){const o=r?"class":"style";cs(n,t,e.inputs[o],o,i)}function UE(n,e,t){return yg(n,e,t,!1),UE}function Ka(n,e){return yg(n,e,null,!0),Ka}function nte(n,e){for(let t=function Zee(n){return p7(n),f7(n,w2(n,0,Bu.textEnd))}(e);t>=0;t=f7(e,t))y7(n,u7(e),Yee(e))}function gA(n){vg(lte,x0,n,!0)}function x0(n,e){for(let t=function Kee(n){return p7(n),d7(n,w2(n,0,Bu.textEnd))}(e);t>=0;t=d7(e,t))gl(n,u7(e),!0)}function yg(n,e,t,i){const r=gi(),s=fo(),o=gd(2);s.firstUpdatePass&&_7(s,n,o,i),e!==U&&Oh(r,o,e)&&v7(s,s.data[Cr()],r,r[_o],n,r[o+1]=function hte(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=zl(oh(n)))),n}(e,t),i,o)}function vg(n,e,t,i){const r=fo(),s=gd(2);r.firstUpdatePass&&_7(r,null,s,i);const o=gi();if(t!==U&&Oh(o,s,t)){const l=r.data[Cr()];if(x7(l,i)&&!g7(r,s)){let h=i?l.classesWithoutHost:l.stylesWithoutHost;null!==h&&(t=cf(h,t||"")),sk(r,l,o,t,i)}else!function cte(n,e,t,i,r,s,o,l){r===U&&(r=Ba);let h=0,u=0,f=0<r.length?r[0]:null,y=0<s.length?s[0]:null;for(;null!==f||null!==y;){const T=h<r.length?r[h+1]:void 0,B=u<s.length?s[u+1]:void 0;let ne,j=null;f===y?(h+=2,u+=2,T!==B&&(j=y,ne=B)):null===y||null!==f&&f<y?(h+=2,j=f):(u+=2,j=y,ne=B),null!==j&&v7(n,e,t,i,j,ne,o,l),f=h<r.length?r[h]:null,y=u<s.length?s[u]:null}}(r,l,o,o[_o],o[s+1],o[s+1]=function ate(n,e,t){if(null==t||""===t)return Ba;const i=[],r=oh(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}function g7(n,e){return e>=n.expandoStartIndex}function _7(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Cr()],o=g7(n,t);x7(s,i)&&null===e&&!o&&(e=!1),e=function ite(n,e,t,i){const r=function oe(n){const e=Br.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=zE(t=ok(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=ok(r,n,e,t,i),null===s){let h=function rte(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==xb(i))return n[R1(i)]}(n,e,i);void 0!==h&&Array.isArray(h)&&(h=ok(null,n,e,h[1],i),h=zE(h,e.attrs,i),function ste(n,e,t,i){n[R1(t?e.classBindings:e.styleBindings)]=i}(n,e,i,h))}else s=function ote(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=zE(i,n[s].hostAttrs,t);return zE(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function Wee(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,l=R1(o),h=xb(o);n[i]=t;let f,u=!1;if(Array.isArray(t)?(f=t[1],(null===f||Bl(t,f)>0)&&(u=!0)):f=t,r)if(0!==h){const T=R1(n[l+1]);n[i+1]=CD(T,l),0!==T&&(n[T+1]=ik(n[T+1],i)),n[l+1]=function Qee(n,e){return 131071&n|e<<17}(n[l+1],i)}else n[i+1]=CD(l,0),0!==l&&(n[l+1]=ik(n[l+1],i)),l=i;else n[i+1]=CD(h,0),0===l?l=i:n[h+1]=ik(n[h+1],i),h=i;u&&(n[i+1]=nk(n[i+1])),h7(n,f,i,!0),h7(n,f,i,!1),function $ee(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Bl(s,e)>=0&&(t[i+1]=rk(t[i+1]))}(e,f,n,i,s),o=CD(l,h),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function ok(n,e,t,i,r){let s=null;const o=t.directiveEnd;let l=t.directiveStylingLast;for(-1===l?l=t.directiveStart:l++;l<o&&(s=e[l],i=zE(i,s.hostAttrs,r),s!==n);)l++;return null!==n&&(t.directiveStylingLast=l),i}function zE(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),gl(n,o,!!t||e[++s]))}return void 0===n?null:n}function y7(n,e,t){gl(n,e,oh(t))}function lte(n,e,t){const i=String(e);""!==i&&!i.includes(" ")&&gl(n,i,t)}function v7(n,e,t,i,r,s,o,l){if(!(3&e.type))return;const h=n.data,u=h[l+1],f=function jee(n){return!(1&~n)}(u)?b7(h,e,t,r,xb(u),o):void 0;MD(f)||(MD(s)||function qee(n){return!(2&~n)}(u)&&(s=b7(h,null,t,r,l,o)),function c(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:um.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=um.Important),n.setStyle(t,i,r,s))}}(i,o,rs(Cr(),t),r,s))}function b7(n,e,t,i,r,s){const o=null===e;let l;for(;r>0;){const h=n[r],u=Array.isArray(h),f=u?h[1]:h,y=null===f;let T=t[r+1];T===U&&(T=y?Ba:void 0);let B=y?jh(T,i):f===i?T:void 0;if(u&&!MD(B)&&(B=jh(h,i)),MD(B)&&(l=B,o))return l;const j=n[r+1];r=o?R1(j):xb(j)}if(null!==e){let h=s?e.residualClasses:e.residualStyles;null!=h&&(l=jh(h,i))}return l}function MD(n){return void 0!==n}function x7(n,e){return!!(n.flags&(e?8:16))}class bte{destroy(e){}updateValue(e,t){}swap(e,t){const i=Math.min(e,t),r=Math.max(e,t),s=this.detach(r);if(r-i>1){const o=this.detach(i);this.attach(i,s),this.attach(r,o)}else this.attach(i,s)}move(e,t){this.attach(t,this.detach(e))}}function ak(n,e,t,i,r){return n===t&&Object.is(e,i)?1:Object.is(r(n,e),r(t,i))?-1:0}function lk(n,e,t,i){return!(void 0===e||!e.has(i)||(n.attach(t,e.get(i)),e.delete(i),0))}function w7(n,e,t,i,r){if(lk(n,e,i,t(i,r)))n.updateValue(i,r);else{const s=n.create(i,r);n.attach(i,s)}}function C7(n,e,t,i){const r=new Set;for(let s=e;s<=t;s++)r.add(i(s,n.at(s)));return r}class M7{constructor(){this.kvMap=new Map,this._vMap=void 0}has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;const t=this.kvMap.get(e);return void 0!==this._vMap&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);void 0===this._vMap&&(this._vMap=new Map);const r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),void 0!==this._vMap){const r=this._vMap;for(;r.has(i);)i=r.get(i),e(i,t)}}}function U_(n,e){Of("NgControlFlow");const t=gi(),i=Eu(),r=t[i]!==U?t[i]:-1,s=-1!==r?TD(t,Fs+r):void 0;if(Oh(t,i,n)){const l=Je(null);try{if(void 0!==s&&rc(s,0),-1!==n){const h=Fs+n,u=TD(t,h),f=hk(t[vr],h),y=gb(u,f.tView.ssrId);Qo(u,$s(t,f,e,{dehydratedView:y}),0,ya(f,y))}}finally{Je(l)}}else if(void 0!==s){const l=po(s,0);void 0!==l&&(l[hl]=e)}}class wte{constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-ec}}function E7(n){return n}class Cte{constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}}class Mte extends bte{constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i,this.operationsCounter=void 0,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-ec}at(e){return this.getLView(e)[hl].$implicit}attach(e,t){const i=t[$c];this.needsIndexUpdate||=e!==this.length,Qo(this.lContainer,t,e,ya(this.templateTNode,i))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,function Ete(n,e){return Ww(n,e)}(this.lContainer,e)}create(e,t){const i=gb(this.lContainer,this.templateTNode.tView.ssrId),r=$s(this.hostLView,this.templateTNode,new wte(this.lContainer,t,e),{dehydratedView:i});return this.operationsCounter?.recordCreate(),r}destroy(e){R_(e[vr],e),this.operationsCounter?.recordDestroy()}updateValue(e,t){this.getLView(e)[hl].$implicit=t}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[hl].$index=e}getLView(e){return function Ste(n,e){return po(n,e)}(this.lContainer,e)}}function TD(n,e){return n[e]}function hk(n,e){return tc(n,e)}function Wt(n,e,t,i){const r=gi(),s=fo(),o=Fs+n,l=r[_o],h=s.firstCreatePass?function Tte(n,e,t,i,r,s){const o=e.consts,h=et(e,n,2,i,Ql(o,r));return Yo(e,t,h,Ql(o,s)),null!==h.attrs&&dD(h,h.attrs,!1),null!==h.mergedAttrs&&dD(h,h.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,h),h}(o,s,r,e,t,i):s.data[o],u=S7(s,r,h,l,e,n);r[o]=u;const f=xf(h);return Zh(h,!0),S(l,u,h),!function s2(n){return!(32&~n.flags)}(h)&&aa()&&Yw(s,r,u,h),0===function l0(){return Br.lFrame.elementDepthCount}()&&iu(u,r),function Lv(){Br.lFrame.elementDepthCount++}(),f&&(At(s,r,h),Rt(s,h,r)),null!==i&&Ht(r,h),Wt}function un(){let n=qa();Vd()?c0():(n=n.parent,Zh(n,!1));const e=n;(function y_(n){return Br.skipHydrationRootTNode===n})(e)&&function Hd(){Br.skipHydrationRootTNode=null}(),function oA(){Br.lFrame.elementDepthCount--}();const t=fo();return t.firstCreatePass&&(Ea(t,n),l_(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function If(n){return!!(8&n.flags)}(e)&&sk(t,e,gi(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function om(n){return!!(16&n.flags)}(e)&&sk(t,e,gi(),e.stylesWithoutHost,!1),un}function Er(n,e,t,i){return Wt(n,e,t,i),un(),Er}let S7=(n,e,t,i,r,s)=>(Ks(!0),M1(i,r,function as(){return Br.lFrame.currentNamespace}()));function bg(n,e,t){const i=gi(),r=fo(),s=n+Fs,o=r.firstCreatePass?function Bte(n,e,t,i,r){const s=e.consts,o=Ql(s,i),l=et(e,n,8,"ng-container",o);return null!==o&&dD(l,o,!0),Yo(e,t,l,Ql(s,r)),null!==e.queries&&e.queries.elementStart(e,l),l}(s,r,i,e,t):r.data[s];Zh(o,!0);const l=T7(r,i,o,n);return i[s]=l,aa()&&Yw(r,i,l,o),iu(l,i),xf(o)&&(At(r,i,o),Rt(r,o,i)),null!=t&&Ht(i,o),bg}function xg(){let n=qa();const e=fo();return Vd()?c0():(n=n.parent,Zh(n,!1)),e.firstCreatePass&&(Ea(e,n),l_(n)&&e.queries.elementEnd(n)),xg}function C2(n,e,t){return bg(n,e,t),xg(),C2}let T7=(n,e,t,i)=>(Ks(!0),hE(e[_o],""));function zo(){return gi()}function k1(n,e,t){const i=gi();return Oh(i,Eu(),e)&&Vi(fo(),kr(),i,n,e,i[_o],t,!0),k1}const wb=void 0;var Fte=["en",[["a","p"],["AM","PM"],wb],[["AM","PM"],wb,wb],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],wb,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],wb,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",wb,"{1} 'at' {0}",wb],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function kte(n){const t=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let M2={};function Lf(n){const e=function Ote(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=B7(e);if(t)return t;const i=e.split("-")[0];if(t=B7(i),t)return t;if("en"===i)return Fte;throw new xi(701,!1)}function B7(n){return n in M2||(M2[n]=Cs.ng&&Cs.ng.common&&Cs.ng.common.locales&&Cs.ng.common.locales[n]),M2[n]}var Dc=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(Dc||{});const DD="en-US";let P7=DD,Y7=(n,e,t)=>{};function mi(n,e,t,i){const r=gi(),s=fo(),o=qa();return fk(s,r,r[_o],o,n,e,i),mi}function fk(n,e,t,i,r,s,o){const l=xf(i),u=n.firstCreatePass&&ta(n),f=e[hl],y=br(e);let T=!0;if(3&i.type||o){const ne=Tc(i,e),se=o?o(ne):ne,le=y.length,Ee=o?Ve=>o(Pa(Ve[i.index])):i.index;let Pe=null;if(!o&&l&&(Pe=function Cne(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const l=e[up],h=r[s+2];return l.length>h?l[h]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==Pe)(Pe.__ngLastListenerFn__||Pe).__ngNextListenerFn__=s,Pe.__ngLastListenerFn__=s,T=!1;else{s=e9(i,e,f,s),Y7(ne,r,s);const Ve=t.listen(se,r,s);y.push(s,Ve),u&&u.push(r,Ee,le,le+1)}}else s=e9(i,e,f,s);const B=i.outputs;let j;if(T&&null!==B&&(j=B[r])){const ne=j.length;if(ne)for(let se=0;se<ne;se+=2){const Ft=e[j[se]][j[se+1]].subscribe(s),Ct=y.length;y.push(s,Ft),u&&u.push(r,i.index,Ct,-(Ct+1))}}}function J7(n,e,t,i){const r=Je(null);try{return fp(6,e,t),!1!==t(i)}catch(s){return Xr(n,s),!1}finally{fp(7,e,t),Je(r)}}function e9(n,e,t,i){return function r(s){if(s===Function)return i;fb(n.componentOffset>-1?Js(n.index,e):e,5);let l=J7(e,t,i,s),h=r.__ngNextListenerFn__;for(;h;)l=J7(e,t,h,s)&&l,h=h.__ngNextListenerFn__;return l}}function pr(n=1){return function Pr(n){return(Br.lFrame.contextLView=function KA(n,e){for(;n>0;)e=e[vf],n--;return e}(n,Br.lFrame.contextLView))[hl]}(n)}function Mne(n,e){let t=null;const i=function Qm(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?Rd(n,s,!0):zA(i,s))return r}else t=r}return t}function xd(n){const e=gi()[Pl][ih];if(!e.projection){const i=e.projection=function Vl(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){if(128!==s.type){const o=n?Mne(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s)}s=s.next}}}function ou(n,e=0,t,i,r,s){const o=gi(),l=fo(),h=i?n+1:null;null!==h&&kE(o,l,h,i,r,s,null,t);const u=et(l,Fs+n,16,null,t||null);null===u.projection&&(u.projection=e),c0();const y=!o[$c]||nc();null===o[Pl][ih].projection[u.projection]&&null!==h?function Ene(n,e,t){const i=Fs+t,r=e.data[i],s=n[i],o=gb(s,r.tView.ssrId);Qo(s,$s(n,r,void 0,{dehydratedView:o}),0,ya(r,o))}(o,l,h):y&&32&~u.flags&&function xR(n,e,t){M(e[_o],0,e,t,$w(n,t,e),eD(t.parent||e[ih],t,e))}(l,o,u)}function pk(n,e,t){return mk(n,"",e,"",t),pk}function mk(n,e,t,i,r){const s=gi(),o=p2(s,e,t,i);return o!==U&&Vi(fo(),kr(),s,n,o,s[_o],r,!1),mk}function Cp(n,e,t,i){!function oU(n,e,t,i){const r=fo();if(r.firstCreatePass){const s=qa();aU(r,new nU(e,t,i),s.index),function LJ(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),!(2&~t)&&(r.staticContentQueries=!0)}return rU(r,gi(),t)}(n,e,t,i)}function ul(n,e,t){!function sU(n,e,t){const i=fo();return i.firstCreatePass&&(aU(i,new nU(n,e,t),-1),!(2&~e)&&(i.staticViewQueries=!0)),rU(i,gi(),e)}(n,e,t)}function ia(n){const e=gi(),t=fo(),i=qe();ft(i+1);const r=HR(t,i);if(n.dirty&&function nl(n){return!(4&~n[Ys])}(e)===!(2&~r.metadata.flags)){if(null===r.matches)n.reset([]);else{const s=lU(e,i);n.reset(s,o1),n.notifyOnChanges()}return!0}return!1}function ra(){return function zR(n,e){return n[Ud].queries[e].queryList}(gi(),qe())}function Ha(n){return im(function pp(){return Br.lFrame.contextLView}(),Fs+n)}function ki(n,e=""){const t=gi(),i=fo(),r=n+Fs,s=i.firstCreatePass?et(i,r,1,e,null):i.data[r],o=_9(i,t,s,e,n);t[r]=o,aa()&&Yw(i,t,o,s),Zh(s,!1)}let _9=(n,e,t,i,r)=>(Ks(!0),function cE(n,e){return n.createText(e)}(e[_o],i));function _A(n){return dl("",n,""),_A}function dl(n,e,t){const i=gi(),r=p2(i,n,e,t);return r!==U&&function Eo(n,e,t){const i=rs(e,n);!function $3(n,e,t){n.setValue(e,t)}(n[_o],i,t)}(i,Cr(),r),dl}function w0(n,e,t){uU(e)&&(e=e());const i=gi();return Oh(i,Eu(),e)&&Vi(fo(),kr(),i,n,e,i[_o],t,!1),w0}function z_(n,e){const t=uU(n);return t&&n.set(e),t}function C0(n,e){const t=gi(),i=fo(),r=qa();return fk(i,t,t[_o],r,n,e),C0}function gk(n,e,t,i,r){if(n=Us(n),Array.isArray(n))for(let s=0;s<n.length;s++)gk(n[s],e,t,i,r);else{const s=fo(),o=gi(),l=qa();let h=Yp(n)?n:Us(n.provide);const u=e0(n),f=1048575&l.providerIndexes,y=l.directiveStart,T=l.providerIndexes>>20;if(Yp(n)||!n.multi){const B=new eu(u,r,Q),j=yk(h,e,r?f:f+T,y);-1===j?(Gd(Zy(l,o),s,h),_k(s,n,e.length),e.push(h),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(B),o.push(B)):(t[j]=B,o[j]=B)}else{const B=yk(h,e,f+T,y),j=yk(h,e,f,f+T),se=j>=0&&t[j];if(r&&!se||!r&&!(B>=0&&t[B])){Gd(Zy(l,o),s,h);const le=function jne(n,e,t,i,r){const s=new eu(n,t,Q);return s.multi=[],s.index=e,s.componentProviders=0,D9(s,r,i&&!t),s}(r?Qne:qne,t.length,r,i,u);!r&&se&&(t[j].providerFactory=le),_k(s,n,e.length,0),e.push(h),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(le),o.push(le)}else _k(s,n,B>-1?B:j,D9(t[r?j:B],u,!r&&i));!r&&i&&se&&t[j].componentProviders++}}}function _k(n,e,t,i){const r=Yp(e),s=function Mv(n){return!!n.useClass}(e);if(r||s){const h=(s?Us(e.useClass):e).prototype.ngOnDestroy;if(h){const u=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const f=u.indexOf(t);-1===f?u.push(t,[i,h]):u[f+1].push(i,h)}else u.push(t,h)}}}function D9(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function yk(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function qne(n,e,t,i){return vk(this.multi,[])}function Qne(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,l=og(t,t[vr],this.providerFactory.index,i);s=l.slice(0,o),vk(r,s);for(let h=o;h<l.length;h++)s.push(l[h])}else s=[],vk(r,s);return s}function vk(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Bo(n,e=[]){return t=>{t.providersResolver=(i,r)=>function Gne(n,e,t){const i=fo();if(i.firstCreatePass){const r=Yu(n);gk(t,i.data,i.blueprint,r,!0),gk(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}let Wne=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=Cu(0,t.type),r=i.length>0?AD([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=$i({token:n,providedIn:"environment",factory:()=>new n(Wn(th))})}return n})();function ah(n){Of("NgStandalone"),n.getStandaloneInjector=e=>e.get(Wne).getOrCreateStandaloneInjector(n)}function jd(n,e,t,i){return R9(gi(),jl(),n,e,t,i)}function P9(n,e,t,i,r,s){return function F9(n,e,t,i,r,s,o,l){const h=e+t;return function _D(n,e,t,i,r){const s=vb(n,e,t,i);return Oh(n,e+2,r)||s}(n,h,r,s,o)?b0(n,h+3,l?i.call(l,r,s,o):i(r,s,o)):jE(n,h+3)}(gi(),jl(),n,e,t,i,r,s)}function jE(n,e){const t=n[e];return t===U?void 0:t}function R9(n,e,t,i,r,s){const o=e+t;return Oh(n,o,r)?b0(n,o+1,s?i.call(s,r):i(r)):jE(n,o+1)}function k9(n,e,t,i,r,s,o){const l=e+t;return vb(n,l,r,s)?b0(n,l+2,o?i.call(o,r,s):i(r,s)):jE(n,l+2)}function WE(n,e){const t=fo();let i;const r=n+Fs;t.firstCreatePass?(i=function rie(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=mf(i.type)),l=sl(Q);try{const h=Ky(!1),u=s();return Ky(h),function Ak(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,gi(),r,u),u}finally{sl(l)}}function FD(n,e,t,i){const r=n+Fs,s=gi(),o=im(s,r);return $E(s,r)?k9(s,jl(),e,o.transform,t,i,o):o.transform(t,i)}function $E(n,e){return n[vr].data[e].pure}function xk(n,e){return Ts(n,e)}let ez=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const sz=new Ai(""),ND=new Ai("");let Ik,Tk=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,Ik||(function ere(n){Ik=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ns.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t()},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ns),Wn(Dk),Wn(ND))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})(),Dk=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return Ik?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function KE(n){return!!n&&"function"==typeof n.then}function oz(n){return!!n&&"function"==typeof n.subscribe}const Bk=new Ai("");let az=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=oi(Bk,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(KE(s))t.push(s);else if(oz(s)){const o=new Promise((l,h)=>{s.subscribe({complete:l,error:h})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const UD=new Ai("");function cz(n,e){return Array.isArray(e)?e.reduce(cz,n):{...n,...e}}let yA=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=oi(qP),this.afterRenderManager=oi(OU),this.zonelessEnabled=oi(TE),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new Qt,this.afterTick=new Qt,this.componentTypes=[],this.components=[],this.isStable=oi(ed).hasPendingTasks.pipe(kn(t=>!t)),this._injector=oi(th)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof q8;if(!this._injector.get(az).done)throw!r&&function Xh(n){const e=Ro(n)||vl(n)||Gl(n);return null!==e&&e.standalone}(t),new xi(405,!1);let o;o=r?t:this._injector.get(_b).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const l=function tre(n){return n.isBoundToModule}(o)?void 0:this._injector.get(yb),u=o.create(Dr.NULL,[],i||o.selector,l),f=u.location.nativeElement,y=u.injector.get(sz,null);return y?.registerApplication(f),u.onDestroy(()=>{this.detachView(u.hostView),zD(this.components,u),y?.unregisterApplication(f)}),this._loadComponent(u),u}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new xi(101,!1);const t=Je(null);try{this._runningTick=!0,this.synchronize()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1,Je(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(hD,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let i=0;for(;0!==this.dirtyFlags&&i++<10;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,7&this.dirtyFlags){const i=!!(1&this.dirtyFlags);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(i);for(let{_lView:r,notifyErrorHandler:s}of this._views)rre(r,s,i,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),7&this.dirtyFlags)return}else t?.begin?.(),t?.end?.();8&this.dirtyFlags&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){this.allViews.some(({_lView:t})=>sA(t))?this.dirtyFlags|=2:this.dirtyFlags&=-8}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;zD(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(UD,[]);[...this._bootstrapListeners,...i].forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>zD(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new xi(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function zD(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function rre(n,e,t,i){(t||sA(n))&&Rf(n,e,t&&!i?0:1)}class sre{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let uz=(()=>{class n{compileModuleSync(t){return new qR(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Pf(ql(t).declarations).reduce((o,l)=>{const h=Ro(l);return h&&o.push(new BE(h)),o},[]);return new sre(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),lre=(()=>{class n{constructor(){this.zone=oi(ns),this.changeDetectionScheduler=oi(n2),this.applicationRef=oi(yA)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Pk({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new ns({...Rk(),scheduleInRootZone:t}),[{provide:ns,useFactory:n},{provide:_l,multi:!0,useFactory:()=>{const i=oi(lre,{optional:!0});return()=>i.initialize()}},{provide:_l,multi:!0,useFactory:()=>{const i=oi(hre);return()=>{i.initialize()}}},!0===e?{provide:G8,useValue:!0}:[],{provide:IR,useValue:t??tu}]}function Rk(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}let hre=(()=>{class n{constructor(){this.subscription=new pt,this.initialized=!1,this.zone=oi(ns),this.pendingTasks=oi(ed)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ns.assertNotInAngularZone(),queueMicrotask(()=>{null!==t&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ns.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ZE=(()=>{class n{constructor(){this.appRef=oi(yA),this.taskService=oi(ed),this.ngZone=oi(ns),this.zonelessEnabled=oi(TE),this.disableScheduling=oi(G8,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new pt,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(_a):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(oi(IR,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof kM||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&5===t)return;switch(t){case 0:this.appRef.dirtyFlags|=2;break;case 3:case 2:case 4:case 5:case 1:this.appRef.dirtyFlags|=4;break;case 7:this.appRef.deferredDirtyFlags|=8;break;default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;const i=this.useMicrotaskScheduler?A0:m0;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>i(()=>this.tick())):this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(_a+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&7&this.appRef.dirtyFlags&&(this.appRef.dirtyFlags|=1);const t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){throw this.taskService.remove(t),i}finally{this.cleanup()}this.useMicrotaskScheduler=!0,A0(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const H_=new Ai("",{providedIn:"root",factory:()=>oi(H_,Xo.Optional|Xo.SkipSelf)||function ure(){return typeof $localize<"u"&&$localize.locale||DD}()}),Fk=new Ai("");function VD(n){return!!n.platformInjector}let gz=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=i?.scheduleInRootZone,o=i?.ignoreChangesOutsideZone,l=[Pk({ngZoneFactory:()=>function FM(n="zone.js",e){return"noop"===n?new kM:"zone.js"===n?new ns(e):n}(i?.ngZone,{...Rk({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}),scheduleInRootZone:r}),ignoreChangesOutsideZone:o}),{provide:n2,useExisting:ZE}],h=function iee(n,e,t){return new GR(n,e,t,!1)}(t.moduleType,this.injector,l);return function Az(n){const e=VD(n)?n.r3Injector:n.moduleRef.injector,t=e.get(ns);return t.run(()=>{VD(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();const i=e.get(qd,null);let r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:s=>{i.handleError(s)}})}),VD(n)){const s=()=>e.destroy(),o=n.platformInjector.get(Fk);o.add(s),e.onDestroy(()=>{r.unsubscribe(),o.delete(s)})}else n.moduleRef.onDestroy(()=>{zD(n.allPlatformModules,n.moduleRef),r.unsubscribe()});return function ire(n,e,t){try{const i=t();return KE(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(i,t,()=>{const s=e.get(az);return s.runInitializers(),s.donePromise.then(()=>{if(function zte(n){"string"==typeof n&&(P7=n.toLowerCase().replace(/_/g,"-"))}(e.get(H_,DD)||DD),VD(n)){const l=e.get(yA);return void 0!==n.rootComponent&&l.bootstrap(n.rootComponent),l}return function gre(n,e){const t=n.injector.get(yA);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>t.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new xi(-403,!1);n.instance.ngDoBootstrap(t)}e.push(n)}(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}({moduleRef:h,allPlatformModules:this._modules})}bootstrapModule(t,i=[]){const r=cz({},i);return function are(n,e,t){const i=new qR(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new xi(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(Fk,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(Dr))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),F1=null;const _z=new Ai("");function yz(n,e,t=[]){const i=`Platform: ${e}`,r=new Ai(i);return(s=[])=>{let o=Ok();if(!o||o.injector.get(_z,!1)){const l=[...t,...s,{provide:r,useValue:!0}];n?n(l):function _re(n){if(F1&&!F1.get(_z,!1))throw new xi(400,!1);(function lz(){!function m(n){ie=n}(()=>{throw new xi(600,!1)})})(),F1=n;const e=n.get(gz);(function bz(n){n.get(_w,null)?.forEach(t=>t())})(n)}(function vz(n=[],e){return Dr.create({name:e,providers:[{provide:HA,useValue:"platform"},{provide:Fk,useValue:new Set([()=>F1=null])},...n]})}(l,i))}return function yre(){const e=Ok();if(!e)throw new xi(401,!1);return e}()}}function Ok(){return F1?.get(gz)??null}let Ac=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=bre}return n})();function bre(n){return function xre(n,e,t){if(nm(n)&&!t){const i=Js(n.index,e);return new hn(i,i)}return 175&n.type?new hn(e[Pl],e):null}(qa(),gi(),!(16&~n))}class Ez{constructor(){}supports(e){return gD(e)}create(e){return new Sre(e)}}const Ere=(n,e)=>e;class Sre{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Ere}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<Tz(i,r,s)?t:i,l=Tz(o,r,s),h=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const u=l-r,f=h-r;if(u!=f){for(let T=0;T<u;T++){const B=T<s.length?s[T]:s[T]=0,j=B+T;f<=j&&j<u&&(s[T]=B+1)}s[o.previousIndex]=f-u}}l!==h&&e(o,l,h)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!gD(e))throw new xi(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let l=0;l<this.length;l++)s=e[l],o=this._trackByFn(l,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,l)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,l),i=!0),t=t._next}else r=0,function oee(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,l=>{o=this._trackByFn(r,l),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,l,o,r)),Object.is(t.item,l)||this._addIdentityChange(t,l)):(t=this._mismatch(t,l,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new Tre(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new Sz),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Sz),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Tre{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Dre{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class Sz{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new Dre,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Tz(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class Dz{constructor(){}supports(e){return e instanceof Map||QR(e)}create(){return new Ire}}class Ire{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||QR(e)))throw new xi(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new Bre(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class Bre{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Iz(){return new T2([new Ez])}let T2=(()=>{class n{static#e=this.\u0275prov=$i({token:n,providedIn:"root",factory:Iz});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||Iz()),deps:[[n,new Hm,new xu]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new xi(901,!1)}}return n})();function Bz(){return new QD([new Dz])}let QD=(()=>{class n{static#e=this.\u0275prov=$i({token:n,providedIn:"root",factory:Bz});constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||Bz()),deps:[[n,new Hm,new xu]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new xi(901,!1)}}return n})();const kre=yz(null,"core",[]);let Fre=(()=>{class n{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(yA))};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({})}return n})();const Wz=new Ai("");function js(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function vh(n,e=NaN){return isNaN(parseFloat(n))||isNaN(Number(n))?e:Number(n)}function nS(n,e){Of("NgSignals");const t=function g(n){const e=Object.create(H);e.computation=n;const t=()=>{if(L(e),Qe(e),e.value===O)throw e.error;return e.value};return t[xe]=e,t}(n);return e?.equal&&(t[xe].equal=e.equal),t}function wg(n){const e=Je(null);try{return n()}finally{Je(e)}}const fse=new Ai("",{providedIn:"root",factory:()=>oi(pse)});let pse=(()=>{class n{static#e=this.\u0275prov=$i({token:n,providedIn:"root",factory:()=>new mse})}return n})();class mse{constructor(){this.queuedEffectCount=0,this.queues=new Map,this.pendingTasks=oi(ed),this.taskId=null}scheduleEffect(e){if(this.enqueue(e),null===this.taskId){const t=this.taskId=this.pendingTasks.add();queueMicrotask(()=>{this.flush(),this.pendingTasks.remove(t),this.taskId=null})}}enqueue(e){const t=e.creationZone;this.queues.has(t)||this.queues.set(t,new Set);const i=this.queues.get(t);i.has(e)||(this.queuedEffectCount++,i.add(e))}flush(){for(;this.queuedEffectCount>0;)for(const[e,t]of this.queues)null===e?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(const t of e)e.delete(t),this.queuedEffectCount--,t.run()}}class Ase{constructor(e,t,i,r,s,o){this.scheduler=e,this.effectFn=t,this.creationZone=i,this.injector=s,this.watcher=function Xe(n,e,t){const i=Object.create($);t&&(i.consumerAllowSignalWrites=!0),i.fn=n,i.schedule=e;const r=h=>{i.cleanupFn=h};return i.ref={notify:()=>fe(i),run:()=>{if(null===i.fn)return;if(function Ke(){return V}())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(i.dirty=!1,i.hasRun&&!ce(i))return;i.hasRun=!0;const h=de(i);try{i.cleanupFn(),i.cleanupFn=ct,i.fn(r)}finally{pe(i,h)}},cleanup:()=>i.cleanupFn(),destroy:()=>function o(h){(function s(h){return null===h.fn&&null===h.schedule})(h)||(K(h),h.cleanupFn(),h.fn=null,h.schedule=null,h.cleanupFn=ct)}(i),[xe]:i},i.ref}(l=>this.runEffect(l),()=>this.schedule(),o),this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}runEffect(e){try{this.effectFn(e)}catch(t){this.injector.get(qd,null,{optional:!0})?.handleError(t)}}run(){this.watcher.run()}schedule(){this.scheduler.scheduleEffect(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}}let rH=null;function O1(){return rH}class vse{}const ca=new Ai("");let qk=(()=>{class n{historyGo(t){throw new Error("")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:()=>oi(xse),providedIn:"platform"})}return n})();const bse=new Ai("");let xse=(()=>{class n extends qk{constructor(){super(),this._doc=oi(ca),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return O1().getBaseHref(this._doc)}onPopState(t){const i=O1().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=O1().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function Qk(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function sH(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function V_(n){return n&&"?"!==n[0]?"?"+n:n}let Eb=(()=>{class n{historyGo(t){throw new Error("")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:()=>oi(aH),providedIn:"root"})}return n})();const oH=new Ai("");let aH=(()=>{class n extends Eb{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??oi(ca).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Qk(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+V_(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+V_(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+V_(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(qk),Wn(oH,8))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),wse=(()=>{class n extends Eb{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){const i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=Qk(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+V_(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+V_(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(qk),Wn(oH,8))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})(),Sb=(()=>{class n{constructor(t){this._subject=new os,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function Ese(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(sH(lH(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+V_(i))}normalize(t){return n.stripTrailingSlash(function Mse(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,lH(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+V_(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+V_(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=V_;static#t=this.joinWithSlash=Qk;static#n=this.stripTrailingSlash=sH;static#i=this.\u0275fac=function(i){return new(i||n)(Wn(Eb))};static#r=this.\u0275prov=$i({token:n,factory:()=>function Cse(){return new Sb(Wn(Eb))}(),providedIn:"root"})}return n})();function lH(n){return n.replace(/\/index.html$/,"")}var ZD=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(ZD||{});const au={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function vA(n,e){const t=Lf(n),i=t[Dc.NumberSymbols][e];if(typeof i>"u"){if(e===au.CurrencyDecimal)return t[Dc.NumberSymbols][au.Decimal];if(e===au.CurrencyGroup)return t[Dc.NumberSymbols][au.Group]}return i}const Jse=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function Jk(n){const e=parseInt(n);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+n);return e}function gH(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}const tF=/\s+/,_H=[];let Mg=(()=>{class n{constructor(t,i){this._ngEl=t,this._renderer=i,this.initialClasses=_H,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(tF):_H}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(tF):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(tF).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(L_))};static#t=this.\u0275dir=mr({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}return n})();class uoe{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let pm=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new uoe(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const l=i.get(s);i.move(l,o),vH(l,r)}});for(let r=0,s=i.length;r<s;r++){const l=i.get(r).context;l.index=r,l.count=s,l.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{vH(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(Q(Fh),Q(ni),Q(T2))};static#t=this.\u0275dir=mr({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return n})();function vH(n,e){n.context.$implicit=e.item}let Wd=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new doe,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){bH("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){bH("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(Q(Fh),Q(ni))};static#t=this.\u0275dir=mr({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class doe{constructor(){this.$implicit=null,this.ngIf=null}}function bH(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${zl(e)}'.`)}class nF{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let cI=(()=>{class n{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews.push(t)}_matchCase(t){const i=t===this._ngSwitch;return this._lastCasesMatched||=i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(t){if(this._defaultViews.length>0&&t!==this._defaultUsed){this._defaultUsed=t;for(const i of this._defaultViews)i.enforceState(t)}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=mr({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0})}return n})(),xH=(()=>{class n{constructor(t,i,r){this.ngSwitch=r,r._addCase(),this._view=new nF(t,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}static#e=this.\u0275fac=function(i){return new(i||n)(Q(Fh),Q(ni),Q(cI,9))};static#t=this.\u0275dir=mr({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0})}return n})(),CH=(()=>{class n{constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,s]=t.split("."),o=-1===r.indexOf("-")?void 0:um.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${i}${s}`:i,o):this._renderer.removeStyle(this._ngEl.nativeElement,r,o)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(QD),Q(L_))};static#t=this.\u0275dir=mr({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return n})(),MH=(()=>{class n{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(this._shouldRecreateView(t)){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const r=this._createContextForwardProxy();this._viewRef=i.createEmbeddedView(this.ngTemplateOutlet,r,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(t){return!!t.ngTemplateOutlet||!!t.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(t,i,r)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,i,r),get:(t,i,r)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,i,r)}})}static#e=this.\u0275fac=function(i){return new(i||n)(Q(Fh))};static#t=this.\u0275dir=mr({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[dc]})}return n})();let SH=(()=>{class n{constructor(t){this._locale=t}transform(t,i,r){if(!function iF(n){return!(null==n||""===n||n!=n)}(t))return null;r||=this._locale;try{return function soe(n,e,t){return function Kk(n,e,t,i,r,s,o=!1){let l="",h=!1;if(isFinite(n)){let u=function aoe(n){let i,r,s,o,l,e=Math.abs(n)+"",t=0;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(s=e.search(/e/i))>0?(r<0&&(r=s),r+=+e.slice(s+1),e=e.substring(0,s)):r<0&&(r=e.length),s=0;"0"===e.charAt(s);s++);if(s===(l=e.length))i=[0],r=1;else{for(l--;"0"===e.charAt(l);)l--;for(r-=s,i=[],o=0;s<=l;s++,o++)i[o]=Number(e.charAt(s))}return r>22&&(i=i.splice(0,21),t=r-1,r=1),{digits:i,exponent:t,integerLen:r}}(n);o&&(u=function ooe(n){if(0===n.digits[0])return n;const e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===e?n.digits.push(0,0):1===e&&n.digits.push(0),n.integerLen+=2),n}(u));let f=e.minInt,y=e.minFrac,T=e.maxFrac;if(s){const Ee=s.match(Jse);if(null===Ee)throw new Error(`${s} is not a valid digit info`);const Pe=Ee[1],Ve=Ee[3],Ft=Ee[5];null!=Pe&&(f=Jk(Pe)),null!=Ve&&(y=Jk(Ve)),null!=Ft?T=Jk(Ft):null!=Ve&&y>T&&(T=y)}!function loe(n,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let i=n.digits,r=i.length-n.integerLen;const s=Math.min(Math.max(e,r),t);let o=s+n.integerLen,l=i[o];if(o>0){i.splice(Math.max(n.integerLen,o));for(let y=o;y<i.length;y++)i[y]=0}else{r=Math.max(0,r),n.integerLen=1,i.length=Math.max(1,o=s+1),i[0]=0;for(let y=1;y<o;y++)i[y]=0}if(l>=5)if(o-1<0){for(let y=0;y>o;y--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[o-1]++;for(;r<Math.max(0,s);r++)i.push(0);let h=0!==s;const u=e+n.integerLen,f=i.reduceRight(function(y,T,B,j){return j[B]=(T+=y)<10?T:T-10,h&&(0===j[B]&&B>=u?j.pop():h=!1),T>=10?1:0},0);f&&(i.unshift(f),n.integerLen++)}(u,y,T);let B=u.digits,j=u.integerLen;const ne=u.exponent;let se=[];for(h=B.every(Ee=>!Ee);j<f;j++)B.unshift(0);for(;j<0;j++)B.unshift(0);j>0?se=B.splice(j,B.length):(se=B,B=[0]);const le=[];for(B.length>=e.lgSize&&le.unshift(B.splice(-e.lgSize,B.length).join(""));B.length>e.gSize;)le.unshift(B.splice(-e.gSize,B.length).join(""));B.length&&le.unshift(B.join("")),l=le.join(vA(t,i)),se.length&&(l+=vA(t,r)+se.join("")),ne&&(l+=vA(t,au.Exponential)+"+"+ne)}else l=vA(t,au.Infinity);return l=n<0&&!h?e.negPre+l+e.negSuf:e.posPre+l+e.posSuf,l}(n,function Zk(n,e="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(";"),r=i[0],s=i[1],o=-1!==r.indexOf(".")?r.split("."):[r.substring(0,r.lastIndexOf("0")+1),r.substring(r.lastIndexOf("0")+1)],l=o[0],h=o[1]||"";t.posPre=l.substring(0,l.indexOf("#"));for(let f=0;f<h.length;f++){const y=h.charAt(f);"0"===y?t.minFrac=t.maxFrac=f+1:"#"===y?t.maxFrac=f+1:t.posSuf+=y}const u=l.split(",");if(t.gSize=u[1]?u[1].length:0,t.lgSize=u[2]||u[1]?(u[2]||u[1]).length:0,s){const f=r.length-t.posPre.length-t.posSuf.length,y=s.indexOf("#");t.negPre=s.substring(0,y).replace(/'/g,""),t.negSuf=s.slice(y+f).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}(function jk(n,e){return Lf(n)[Dc.NumberFormats][e]}(e,ZD.Decimal),vA(e,au.MinusSign)),e,au.Group,au.Decimal,t)}(function rF(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(t),r,i)}catch(s){throw function Eg(n,e){return new xi(2100,!1)}()}}static#e=this.\u0275fac=function(i){return new(i||n)(Q(H_,16))};static#t=this.\u0275pipe=yl({name:"number",type:n,pure:!0,standalone:!0})}return n})();let rS=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({})}return n})();const TH="browser";function DH(n){return n===TH}function IH(n){return"server"===n}let Loe=(()=>{class n{static#e=this.\u0275prov=$i({token:n,providedIn:"root",factory:()=>DH(oi(td))?new Noe(oi(ca),window):new zoe})}return n})();class Noe{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){const t=function Uoe(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}}class zoe{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}}class BH{}class pae extends vse{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class lF extends pae{static makeCurrent(){!function yse(n){rH??=n}(new lF)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function mae(){return aS=aS||document.querySelector("base"),aS?aS.getAttribute("href"):null}();return null==t?null:function Aae(n){return new URL(n,document.baseURI).pathname}(t)}resetBaseElement(){aS=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return gH(document.cookie,e)}}let aS=null,_ae=(()=>{class n{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();const fI=new Ai("");let HH=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new xi(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(fI),Wn(ns))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();class cF{constructor(e){this._doc=e}}const hF="ng-app-id";let VH=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=IH(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${hF}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(hF),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(hF,this.appId),t.appendChild(o),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i),s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ca),Wn(uA),Wn(u1,8),Wn(td))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();const uF={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},dF=/%COMP%/g,xae=new Ai("",{providedIn:"root",factory:()=>!0});function qH(n,e){return e.map(t=>t.replace(dF,n))}let fF=(()=>{class n{constructor(t,i,r,s,o,l,h,u=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=l,this.ngZone=h,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=IH(l),this.defaultRenderer=new pF(t,o,h,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Zl.ShadowDom&&(i={...i,encapsulation:Zl.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof jH?r.applyToHost(t):r instanceof mF&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,l=this.ngZone,h=this.eventManager,u=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,y=this.platformIsServer;switch(i.encapsulation){case Zl.Emulated:s=new jH(h,u,i,this.appId,f,o,l,y);break;case Zl.ShadowDom:return new Eae(h,u,t,i,o,l,this.nonce,y);default:s=new mF(h,u,i,f,o,l,y)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(HH),Wn(VH),Wn(uA),Wn(xae),Wn(ca),Wn(td),Wn(ns),Wn(u1))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();class pF{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(uF[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(QH(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(QH(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new xi(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=uF[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=uF[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(um.DashCase|um.Important)?e.style.setProperty(t,i,r&um.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&um.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){null!=e&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=O1().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function QH(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Eae extends pF{constructor(e,t,i,r,s,o,l,h){super(e,s,o,h),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=qH(r.id,r.styles);for(const f of u){const y=document.createElement("style");l&&y.setAttribute("nonce",l),y.textContent=f,this.shadowRoot.appendChild(y)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class mF extends pF{constructor(e,t,i,r,s,o,l,h){super(e,s,o,l),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=h?qH(h,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class jH extends mF{constructor(e,t,i,r,s,o,l,h){const u=r+"-"+i.id;super(e,t,i,s,o,l,h,u),this.contentAttr=function wae(n){return"_ngcontent-%COMP%".replace(dF,n)}(u),this.hostAttr=function Cae(n){return"_nghost-%COMP%".replace(dF,n)}(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let Sae=(()=>{class n extends cF{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ca))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})(),Tae=(()=>{class n extends cF{constructor(t){super(t),this.delegate=oi(Wz,{optional:!0})}supports(t){return!!this.delegate&&this.delegate.supports(t)}addEventListener(t,i,r){return this.delegate.addEventListener(t,i,r)}removeEventListener(t,i,r){return this.delegate.removeEventListener(t,i,r)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ca))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();const WH=["alt","control","meta","shift"],Dae={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Iae={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Bae=(()=>{class n extends cF{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>O1().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),o="code."),WH.forEach(u=>{const f=i.indexOf(u);f>-1&&(i.splice(f,1),o+=u+".")}),o+=s,0!=i.length||0===s.length)return null;const h={};return h.domEventName=r,h.fullKey=o,h}static matchEventFullKeyCode(t,i){let r=Dae[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),WH.forEach(o=>{o!==r&&(0,Iae[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ca))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();const Fae=yz(kre,"browser",[{provide:td,useValue:TH},{provide:_w,useValue:function Pae(){lF.makeCurrent()},multi:!0},{provide:ca,useFactory:function kae(){return function Aw(n){h1=n}(document),document},deps:[]}]),Oae=new Ai(""),YH=[{provide:ND,useClass:class gae{addToWindow(e){Cs.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new xi(5103,!1);return s},Cs.getAllAngularTestabilities=()=>e.getAllTestabilities(),Cs.getAllAngularRootElements=()=>e.getAllRootElements(),Cs.frameworkStabilizers||(Cs.frameworkStabilizers=[]),Cs.frameworkStabilizers.push(i=>{const r=Cs.getAllAngularTestabilities();let s=r.length;const o=function(){s--,0==s&&i()};r.forEach(l=>{l.whenStable(o)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?O1().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:sz,useClass:Tk,deps:[ns,Dk,ND]},{provide:Tk,useClass:Tk,deps:[ns,Dk,ND]}],KH=[{provide:HA,useValue:"root"},{provide:qd,useFactory:function Rae(){return new qd},deps:[]},{provide:fI,useClass:Sae,multi:!0,deps:[ca,ns,td]},{provide:fI,useClass:Bae,multi:!0,deps:[ca]},{provide:fI,useClass:Tae,multi:!0},fF,VH,HH,{provide:hD,useExisting:fF},{provide:BH,useClass:_ae,deps:[]},[]];let ZH=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:uA,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(Oae,12))};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({providers:[...KH,...YH],imports:[rS,Fre]})}return n})(),Lae=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ca))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var al=Te(5774);function tV(n){return n&&We(n.schedule)}function gF(n){return n[n.length-1]}function nV(n){return We(gF(n))?n.pop():void 0}function lS(n){return tV(gF(n))?n.pop():void 0}function L1(n){return this instanceof L1?(this.v=n,this):new L1(n)}function oV(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function bF(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(l,h){!function r(s,o,l,h){Promise.resolve(h).then(function(u){s({value:u,done:l})},o)}(l,h,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const xF=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function aV(n){return We(n?.then)}function lV(n){return We(n[wt])}function cV(n){return Symbol.asyncIterator&&We(n?.[Symbol.asyncIterator])}function hV(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const uV=function hle(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function dV(n){return We(n?.[uV])}function fV(n){return function sV(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",function o(B){return function(j){return Promise.resolve(j).then(B,y)}}),r[Symbol.asyncIterator]=function(){return this},r;function l(B,j){i[B]&&(r[B]=function(ne){return new Promise(function(se,le){s.push([B,ne,se,le])>1||h(B,ne)})},j&&(r[B]=j(r[B])))}function h(B,j){try{!function u(B){B.value instanceof L1?Promise.resolve(B.value.v).then(f,y):T(s[0][2],B)}(i[B](j))}catch(ne){T(s[0][3],ne)}}function f(B){h("next",B)}function y(B){h("throw",B)}function T(B,j){B(j),s.shift(),s.length&&h(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield L1(t.read());if(r)return yield L1(void 0);yield yield L1(i)}}finally{t.releaseLock()}})}function pV(n){return We(n?.getReader)}function $d(n){if(n instanceof Be)return n;if(null!=n){if(lV(n))return function ule(n){return new Be(e=>{const t=n[wt]();if(We(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(xF(n))return function dle(n){return new Be(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(aV(n))return function fle(n){return new Be(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Tt)})}(n);if(cV(n))return mV(n);if(dV(n))return function ple(n){return new Be(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(pV(n))return function mle(n){return mV(fV(n))}(n)}throw hV(n)}function mV(n){return new Be(e=>{(function Ale(n,e){var t,i,r,s;return function iV(n,e,t,i){return new(t||(t=Promise))(function(s,o){function l(f){try{u(i.next(f))}catch(y){o(y)}}function h(f){try{u(i.throw(f))}catch(y){o(y)}}function u(f){f.done?s(f.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(l,h)}u((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=oV(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Q_(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function AV(n,e=0){return Fn((t,i)=>{t.subscribe(ai(i,r=>Q_(i,n,()=>i.next(r),e),()=>Q_(i,n,()=>i.complete(),e),r=>Q_(i,n,()=>i.error(r),e)))})}function gV(n,e=0){return Fn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function _V(n,e){if(!n)throw new Error("Iterable cannot be null");return new Be(t=>{Q_(t,e,()=>{const i=n[Symbol.asyncIterator]();Q_(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function cu(n,e){return e?function xle(n,e){if(null!=n){if(lV(n))return function gle(n,e){return $d(n).pipe(gV(e),AV(e))}(n,e);if(xF(n))return function yle(n,e){return new Be(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(aV(n))return function _le(n,e){return $d(n).pipe(gV(e),AV(e))}(n,e);if(cV(n))return _V(n,e);if(dV(n))return function vle(n,e){return new Be(t=>{let i;return Q_(t,e,()=>{i=n[uV](),Q_(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>We(i?.return)&&i.return()})}(n,e);if(pV(n))return function ble(n,e){return _V(fV(n),e)}(n,e)}throw hV(n)}(n,e):$d(n)}function ds(...n){return cu(n,lS(n))}function nd(n,e,t=1/0){return We(e)?nd((i,r)=>kn((s,o)=>e(i,s,r,o))($d(n(i,r))),t):("number"==typeof e&&(t=e),Fn((i,r)=>function wle(n,e,t,i,r,s,o,l){const h=[];let u=0,f=0,y=!1;const T=()=>{y&&!h.length&&!u&&e.complete()},B=ne=>u<i?j(ne):h.push(ne),j=ne=>{s&&e.next(ne),u++;let se=!1;$d(t(ne,f++)).subscribe(ai(e,le=>{r?.(le),s?B(le):e.next(le)},()=>{se=!0},void 0,()=>{if(se)try{for(u--;h.length&&u<i;){const le=h.shift();o?Q_(e,o,()=>j(le)):j(le)}T()}catch(le){e.error(le)}}))};return n.subscribe(ai(e,B,()=>{y=!0,T()})),()=>{l?.()}}(i,r,n,t)))}function N1(n,e){return We(e)?nd(n,e,1):nd(n,1)}function Nc(n,e){return Fn((t,i)=>{let r=0;t.subscribe(ai(i,s=>n.call(e,s,r++)&&i.next(s)))})}function B2(n){return Fn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Ru(n,e){return Fn((t,i)=>{let r=null,s=0,o=!1;const l=()=>o&&!r&&i.complete();t.subscribe(ai(i,h=>{r?.unsubscribe();let u=0;const f=s++;$d(n(h,f)).subscribe(r=ai(i,y=>i.next(e?e(h,y,f,u++):y),()=>{r=null,l()}))},()=>{o=!0,l()}))})}class mI{}class AI{}class mm{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof mm?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new mm;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof mm?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(l=>-1===s.indexOf(l)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Cle{encodeKey(e){return yV(e)}encodeValue(e){return yV(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Ele=/%(\d[a-f0-9])/gi,Sle={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function yV(n){return encodeURIComponent(n).replace(Ele,(e,t)=>Sle[t]??e)}function gI(n){return`${n}`}class U1{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Cle,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Mle(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,l]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],h=t.get(o)||[];h.push(l),t.set(o,h)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(gI):[gI(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new U1({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(gI(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(gI(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Tle{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function vV(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function bV(n){return typeof Blob<"u"&&n instanceof Blob}function xV(n){return typeof FormData<"u"&&n instanceof FormData}class cS{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Dle(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new mm,this.context??=new Tle,this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const l=t.indexOf("?");this.urlWithParams=t+(-1===l?"?":l<t.length-1?"&":"")+o}}else this.params=new U1,this.urlWithParams=t}serializeBody(){return null===this.body?null:"string"==typeof this.body||vV(this.body)||bV(this.body)||xV(this.body)||function Ile(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)?this.body:this.body instanceof U1?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||xV(this.body)?null:bV(this.body)?this.body.type||null:vV(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof U1?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=void 0!==e.body?e.body:this.body,l=e.withCredentials??this.withCredentials,h=e.reportProgress??this.reportProgress;let u=e.headers||this.headers,f=e.params||this.params;const y=e.context??this.context;return void 0!==e.setHeaders&&(u=Object.keys(e.setHeaders).reduce((T,B)=>T.set(B,e.setHeaders[B]),u)),e.setParams&&(f=Object.keys(e.setParams).reduce((T,B)=>T.set(B,e.setParams[B]),f)),new cS(t,i,o,{params:f,headers:u,context:y,reportProgress:h,responseType:r,withCredentials:l,transferCache:s})}}var z1=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(z1||{});class wF{constructor(e,t=200,i="OK"){this.headers=e.headers||new mm,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class _I extends wF{constructor(e={}){super(e),this.type=z1.ResponseHeader}clone(e={}){return new _I({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Db extends wF{constructor(e={}){super(e),this.type=z1.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Db({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class P2 extends wF{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function CF(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}let hS=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof cS)s=t;else{let h,u;h=r.headers instanceof mm?r.headers:new mm(r.headers),r.params&&(u=r.params instanceof U1?r.params:new U1({fromObject:r.params})),s=new cS(t,i,void 0!==r.body?r.body:null,{headers:h,context:r.context,params:u,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}const o=ds(s).pipe(N1(h=>this.handler.handle(h)));if(t instanceof cS||"events"===r.observe)return o;const l=o.pipe(Nc(h=>h instanceof Db));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return l.pipe(kn(h=>{if(null!==h.body&&!(h.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return h.body}));case"blob":return l.pipe(kn(h=>{if(null!==h.body&&!(h.body instanceof Blob))throw new Error("Response is not a Blob.");return h.body}));case"text":return l.pipe(kn(h=>{if(null!==h.body&&"string"!=typeof h.body)throw new Error("Response is not a string.");return h.body}));default:return l.pipe(kn(h=>h.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new U1).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,CF(r,i))}post(t,i,r={}){return this.request("POST",t,CF(r,i))}put(t,i,r={}){return this.request("PUT",t,CF(r,i))}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(mI))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();const Rle=/^\)\]\}',?\n/;function CV(n){if(n.url)return n.url;const e="X-Request-URL".toLocaleLowerCase();return n.headers.get(e)}let MF=(()=>{class n{constructor(){this.fetchImpl=oi(Fle,{optional:!0})?.fetch??fetch.bind(globalThis),this.ngZone=oi(ns)}handle(t){return new Be(i=>{const r=new AbortController;return this.doRequest(t,r.signal,i).then(EF,s=>i.error(new P2({error:s}))),()=>r.abort()})}doRequest(t,i,r){var s=this;return(0,al.A)(function*(){const o=s.createRequestInit(t);let l;try{const j=s.ngZone.runOutsideAngular(()=>s.fetchImpl(t.urlWithParams,{signal:i,...o}));(function Ole(n){n.then(EF,EF)})(j),r.next({type:z1.Sent}),l=yield j}catch(j){return void r.error(new P2({error:j,status:j.status??0,statusText:j.statusText,url:t.urlWithParams,headers:j.headers}))}const h=new mm(l.headers),u=l.statusText,f=CV(l)??t.urlWithParams;let y=l.status,T=null;if(t.reportProgress&&r.next(new _I({headers:h,status:y,statusText:u,url:f})),l.body){const j=l.headers.get("content-length"),ne=[],se=l.body.getReader();let Ee,Pe,le=0;const Ve=typeof Zone<"u"&&Zone.current;yield s.ngZone.runOutsideAngular((0,al.A)(function*(){for(;;){const{done:Ct,value:Lt}=yield se.read();if(Ct)break;if(ne.push(Lt),le+=Lt.length,t.reportProgress){Pe="text"===t.responseType?(Pe??"")+(Ee??=new TextDecoder).decode(Lt,{stream:!0}):void 0;const Kt=()=>r.next({type:z1.DownloadProgress,total:j?+j:void 0,loaded:le,partialText:Pe});Ve?Ve.run(Kt):Kt()}}}));const Ft=s.concatChunks(ne,le);try{const Ct=l.headers.get("Content-Type")??"";T=s.parseBody(t,Ft,Ct)}catch(Ct){return void r.error(new P2({error:Ct,headers:new mm(l.headers),status:l.status,statusText:l.statusText,url:CV(l)??t.urlWithParams}))}}0===y&&(y=T?200:0),y>=200&&y<300?(r.next(new Db({body:T,headers:h,status:y,statusText:u,url:f})),r.complete()):r.error(new P2({error:T,headers:h,status:y,statusText:u,url:f}))})()}parseBody(t,i,r){switch(t.responseType){case"json":const s=(new TextDecoder).decode(i).replace(Rle,"");return""===s?null:JSON.parse(s);case"text":return(new TextDecoder).decode(i);case"blob":return new Blob([i],{type:r});case"arraybuffer":return i.buffer}}createRequestInit(t){const i={},r=t.withCredentials?"include":void 0;if(t.headers.forEach((s,o)=>i[s]=o.join(",")),t.headers.has("Accept")||(i.Accept="application/json, text/plain, */*"),!t.headers.has("Content-Type")){const s=t.detectContentTypeHeader();null!==s&&(i["Content-Type"]=s)}return{body:t.serializeBody(),method:t.method,headers:i,credentials:r}}concatChunks(t,i){const r=new Uint8Array(i);let s=0;for(const o of t)r.set(o,s),s+=o.length;return r}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();class Fle{}function EF(){}function MV(n,e){return e(n)}function Lle(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}const Ule=new Ai(""),uS=new Ai(""),EV=new Ai(""),SV=new Ai("",{providedIn:"root",factory:()=>!0});function zle(){let n=null;return(e,t)=>{null===n&&(n=(oi(Ule,{optional:!0})??[]).reduceRight(Lle,MV));const i=oi(ed);if(oi(SV)){const s=i.add();return n(e,t).pipe(B2(()=>i.remove(s)))}return n(e,t)}}let TV=(()=>{class n extends mI{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=oi(ed),this.contributeToStability=oi(SV)}handle(t){if(null===this.chain){const i=Array.from(new Set([...this.injector.get(uS),...this.injector.get(EV,[])]));this.chain=i.reduceRight((r,s)=>function Nle(n,e,t){return(i,r)=>Fd(t,()=>e(i,s=>n(s,r)))}(r,s,this.injector),MV)}if(this.contributeToStability){const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(B2(()=>this.pendingTasks.remove(i)))}return this.chain(t,i=>this.backend.handle(i))}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(AI),Wn(th))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();const Qle=/^\)\]\}',?\n/;let IV=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new xi(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?cu(i.\u0275loadImpl()):ds(null)).pipe(Ru(()=>new Be(s=>{const o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((ne,se)=>o.setRequestHeader(ne,se.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const ne=t.detectContentTypeHeader();null!==ne&&o.setRequestHeader("Content-Type",ne)}if(t.responseType){const ne=t.responseType.toLowerCase();o.responseType="json"!==ne?ne:"text"}const l=t.serializeBody();let h=null;const u=()=>{if(null!==h)return h;const ne=o.statusText||"OK",se=new mm(o.getAllResponseHeaders()),le=function jle(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||t.url;return h=new _I({headers:se,status:o.status,statusText:ne,url:le}),h},f=()=>{let{headers:ne,status:se,statusText:le,url:Ee}=u(),Pe=null;204!==se&&(Pe=typeof o.response>"u"?o.responseText:o.response),0===se&&(se=Pe?200:0);let Ve=se>=200&&se<300;if("json"===t.responseType&&"string"==typeof Pe){const Ft=Pe;Pe=Pe.replace(Qle,"");try{Pe=""!==Pe?JSON.parse(Pe):null}catch(Ct){Pe=Ft,Ve&&(Ve=!1,Pe={error:Ct,text:Pe})}}Ve?(s.next(new Db({body:Pe,headers:ne,status:se,statusText:le,url:Ee||void 0})),s.complete()):s.error(new P2({error:Pe,headers:ne,status:se,statusText:le,url:Ee||void 0}))},y=ne=>{const{url:se}=u(),le=new P2({error:ne,status:o.status||0,statusText:o.statusText||"Unknown Error",url:se||void 0});s.error(le)};let T=!1;const B=ne=>{T||(s.next(u()),T=!0);let se={type:z1.DownloadProgress,loaded:ne.loaded};ne.lengthComputable&&(se.total=ne.total),"text"===t.responseType&&o.responseText&&(se.partialText=o.responseText),s.next(se)},j=ne=>{let se={type:z1.UploadProgress,loaded:ne.loaded};ne.lengthComputable&&(se.total=ne.total),s.next(se)};return o.addEventListener("load",f),o.addEventListener("error",y),o.addEventListener("timeout",y),o.addEventListener("abort",y),t.reportProgress&&(o.addEventListener("progress",B),null!==l&&o.upload&&o.upload.addEventListener("progress",j)),o.send(l),s.next({type:z1.Sent}),()=>{o.removeEventListener("error",y),o.removeEventListener("abort",y),o.removeEventListener("load",f),o.removeEventListener("timeout",y),t.reportProgress&&(o.removeEventListener("progress",B),null!==l&&o.upload&&o.upload.removeEventListener("progress",j)),o.readyState!==o.DONE&&o.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(BH))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();const SF=new Ai(""),BV=new Ai("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),PV=new Ai("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class RV{}let Xle=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=gH(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ca),Wn(td),Wn(BV))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();function Yle(n,e){const t=n.url.toLowerCase();if(!oi(SF)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=oi(RV).getToken(),r=oi(PV);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var H1=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(H1||{});function Kle(...n){const e=[hS,IV,TV,{provide:mI,useExisting:TV},{provide:AI,useFactory:()=>oi(MF,{optional:!0})??oi(IV)},{provide:uS,useValue:Yle,multi:!0},{provide:SF,useValue:!0},{provide:RV,useClass:Xle}];for(const t of n)e.push(...t.\u0275providers);return function Jl(n){return{\u0275providers:n}}(e)}const kV=new Ai("");function Zle(){return function Ib(n,e){return{\u0275kind:n,\u0275providers:e}}(H1.LegacyInterceptors,[{provide:kV,useFactory:zle},{provide:uS,useExisting:kV,multi:!0}])}let Jle=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({providers:[Kle(Zle())]})}return n})();const{isArray:lce}=Array,{getPrototypeOf:cce,prototype:hce,keys:uce}=Object;function VV(n){if(1===n.length){const e=n[0];if(lce(e))return{args:e,keys:null};if(function dce(n){return n&&"object"==typeof n&&cce(n)===hce}(e)){const t=uce(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:fce}=Array;function TF(n){return kn(e=>function pce(n,e){return fce(e)?n(...e):n(e)}(n,e))}function GV(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Bb(...n){const e=lS(n),t=nV(n),{args:i,keys:r}=VV(n);if(0===i.length)return cu([],e);const s=new Be(function mce(n,e,t=W){return i=>{qV(e,()=>{const{length:r}=n,s=new Array(r);let o=r,l=r;for(let h=0;h<r;h++)qV(e,()=>{const u=cu(n[h],e);let f=!1;u.subscribe(ai(i,y=>{s[h]=y,f||(f=!0,l--),l||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>GV(r,o):W));return t?s.pipe(TF(t)):s}function qV(n,e,t){n?Q_(t,n,e):e()}const vI=Ne(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function k2(n=1/0){return nd(W,n)}function Pb(...n){return function Ace(){return k2(1)}()(cu(n,lS(n)))}function bI(n){return new Be(e=>{$d(n()).subscribe(e)})}function dS(n,e){const t=We(n)?n:()=>n,i=r=>r.error(t());return new Be(e?r=>e.schedule(i,0,r):i)}const Am=new Be(n=>n.complete());function DF(){return Fn((n,e)=>{let t=null;n._refCount++;const i=ai(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class IF extends Be{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,vn(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new pt;const t=this.getSubject();e.add(this.source.subscribe(ai(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=pt.EMPTY)}return e}refCount(){return DF()(this)}}function lh(n){return n<=0?()=>Am:Fn((e,t)=>{let i=0;e.subscribe(ai(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function Mp(...n){const e=lS(n);return Fn((t,i)=>{(e?Pb(n,t,e):Pb(n,t)).subscribe(i)})}function xI(n){return Fn((e,t)=>{let i=!1;e.subscribe(ai(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function QV(n=_ce){return Fn((e,t)=>{let i=!1;e.subscribe(ai(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function _ce(){return new vI}function Rb(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Nc((r,s)=>n(r,s,i)):W,lh(1),t?xI(e):QV(()=>new vI))}function Xc(n,e,t){const i=We(n)||e||t?{next:n,error:e,complete:t}:n;return i?Fn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let l=!0;r.subscribe(ai(s,h=>{var u;null===(u=i.next)||void 0===u||u.call(i,h),s.next(h)},()=>{var h;l=!1,null===(h=i.complete)||void 0===h||h.call(i),s.complete()},h=>{var u;l=!1,null===(u=i.error)||void 0===u||u.call(i,h),s.error(h)},()=>{var h,u;l&&(null===(h=i.unsubscribe)||void 0===h||h.call(i)),null===(u=i.finalize)||void 0===u||u.call(i)}))}):W}function kb(n){return Fn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(ai(t,void 0,void 0,o=>{s=$d(n(o,kb(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function BF(n){return n<=0?()=>Am:Fn((e,t)=>{let i=[];e.subscribe(ai(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function WV(n){return kn(()=>n)}function fl(n){return Fn((e,t)=>{$d(n).subscribe(ai(t,()=>t.complete(),fn)),!t.closed&&e.subscribe(t)})}const Ta="primary",fS=Symbol("RouteTitle");class bce{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function F2(n){return new bce(n)}function xce(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],l=n[s];if(":"===o[0])r[o.substring(1)]=l;else if(o!==l.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function M0(n,e){const t=n?PF(n):void 0,i=e?PF(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!$V(n[r],e[r]))return!1;return!0}function PF(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function $V(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function XV(n){return n.length>0?n[n.length-1]:null}function V1(n){return function R2(n){return!!n&&(n instanceof Be||We(n.lift)&&We(n.subscribe))}(n)?n:KE(n)?cu(Promise.resolve(n)):ds(n)}const Cce={exact:function ZV(n,e,t){if(!Ob(n.segments,e.segments)||!wI(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!ZV(n.children[i],e.children[i],t))return!1;return!0},subset:JV},YV={exact:function Mce(n,e){return M0(n,e)},subset:function Ece(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>$V(n[t],e[t]))},ignored:()=>!0};function KV(n,e,t){return Cce[t.paths](n.root,e.root,t.matrixParams)&&YV[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function JV(n,e,t){return eG(n,e,e.segments,t)}function eG(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!Ob(r,t)||e.hasChildren()||!wI(r,t,i))}if(n.segments.length===t.length){if(!Ob(n.segments,t)||!wI(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!JV(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(Ob(n.segments,r)&&wI(n.segments,r,i)&&n.children[Ta])&&eG(n.children[Ta],e,s,i)}}function wI(n,e,t){return e.every((i,r)=>YV[t](n[r].parameters,i.parameters))}class Fb{constructor(e=new oc([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=F2(this.queryParams),this._queryParamMap}toString(){return Dce.serialize(this)}}class oc{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return MI(this)}}class pS{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=F2(this.parameters),this._parameterMap}toString(){return iG(this)}}function Ob(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let O2=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:()=>new CI,providedIn:"root"})}return n})();class CI{parse(e){const t=new zce(e);return new Fb(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${mS(e.root,!0)}`,i=function Pce(n){const e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${EI(t)}=${EI(r)}`).join("&"):`${EI(t)}=${EI(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function Ice(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Dce=new CI;function MI(n){return n.segments.map(e=>iG(e)).join("/")}function mS(n,e){if(!n.hasChildren())return MI(n);if(e){const t=n.children[Ta]?mS(n.children[Ta],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==Ta&&i.push(`${r}:${mS(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function Tce(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===Ta&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Ta&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===Ta?[mS(n.children[Ta],!1)]:[`${r}:${mS(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Ta]?`${MI(n)}/${t[0]}`:`${MI(n)}/(${t.join("//")})`}}function tG(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function EI(n){return tG(n).replace(/%3B/gi,";")}function RF(n){return tG(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function SI(n){return decodeURIComponent(n)}function nG(n){return SI(n.replace(/\+/g,"%20"))}function iG(n){return`${RF(n.path)}${function Bce(n){return Object.entries(n).map(([e,t])=>`;${RF(e)}=${RF(t)}`).join("")}(n.parameters)}`}const Rce=/^[^\/()?;#]+/;function kF(n){const e=n.match(Rce);return e?e[0]:""}const kce=/^[^\/()?;=#]+/,Oce=/^[^=?&#]+/,Nce=/^[^&#]+/;class zce{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new oc([],{}):new oc([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Ta]=new oc(e,t)),i}parseSegment(){const e=kF(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new xi(4009,!1);return this.capture(e),new pS(SI(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function Fce(n){const e=n.match(kce);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=kF(this.remaining);r&&(i=r,this.capture(i))}e[SI(t)]=SI(i)}parseQueryParam(e){const t=function Lce(n){const e=n.match(Oce);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function Uce(n){const e=n.match(Nce);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=nG(t),s=nG(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=kF(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new xi(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Ta);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[Ta]:new oc([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new xi(4011,!1)}}function rG(n){return n.segments.length>0?new oc([],{[Ta]:n}):n}function sG(n){const e={};for(const[i,r]of Object.entries(n.children)){const s=sG(r);if(i===Ta&&0===s.segments.length&&s.hasChildren())for(const[o,l]of Object.entries(s.children))e[o]=l;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function Hce(n){if(1===n.numberOfChildren&&n.children[Ta]){const e=n.children[Ta];return new oc(n.segments.concat(e.segments),e.children)}return n}(new oc(n.segments,e))}function Lb(n){return n instanceof Fb}function oG(n){let e;const r=rG(function t(s){const o={};for(const h of s.children){const u=t(h);o[h.outlet]=u}const l=new oc(s.url,o);return s===n&&(e=l),l}(n.root));return e??r}function aG(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return FF(r,r,r,t,i);const s=function Gce(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new cG(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const l={};return Object.entries(s.outlets).forEach(([h,u])=>{l[h]="string"==typeof u?u.split("/"):u}),[...r,{outlets:l}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((l,h)=>{0==h&&"."===l||(0==h&&""===l?t=!0:".."===l?e++:""!=l&&r.push(l))}),r):[...r,s]},[]);return new cG(t,e,i)}(e);if(s.toRoot())return FF(r,r,new oc([],{}),t,i);const o=function qce(n,e,t){if(n.isAbsolute)return new DI(e,!0,0);if(!t)return new DI(e,!1,NaN);if(null===t.parent)return new DI(t,!0,0);const i=TI(n.commands[0])?0:1;return function Qce(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new xi(4005,!1);r=i.segments.length}return new DI(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),l=o.processChildren?gS(o.segmentGroup,o.index,s.commands):hG(o.segmentGroup,o.index,s.commands);return FF(r,o.segmentGroup,l,t,i)}function TI(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function AS(n){return"object"==typeof n&&null!=n&&n.outlets}function FF(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([h,u])=>{s[h]=Array.isArray(u)?u.map(f=>`${f}`):`${u}`}),o=n===e?t:lG(n,e,t);const l=rG(sG(o));return new Fb(l,s,r)}function lG(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:lG(s,e,t)}),new oc(n.segments,i)}class cG{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&TI(i[0]))throw new xi(4003,!1);const r=i.find(AS);if(r&&r!==XV(i))throw new xi(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class DI{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function hG(n,e,t){if(n??=new oc([],{}),0===n.segments.length&&n.hasChildren())return gS(n,e,t);const i=function Wce(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],l=t[i];if(AS(l))break;const h=`${l}`,u=i<t.length-1?t[i+1]:null;if(r>0&&void 0===h)break;if(h&&u&&"object"==typeof u&&void 0===u.outlets){if(!dG(h,u,o))return s;i+=2}else{if(!dG(h,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new oc(n.segments.slice(0,i.pathIndex),{});return s.children[Ta]=new oc(n.segments.slice(i.pathIndex),n.children),gS(s,0,r)}return i.match&&0===r.length?new oc(n.segments,{}):i.match&&!n.hasChildren()?OF(n,e,t):i.match?gS(n,0,r):OF(n,e,t)}function gS(n,e,t){if(0===t.length)return new oc(n.segments,{});{const i=function jce(n){return AS(n[0])?n[0].outlets:{[Ta]:n}}(t),r={};if(Object.keys(i).some(s=>s!==Ta)&&n.children[Ta]&&1===n.numberOfChildren&&0===n.children[Ta].segments.length){const s=gS(n.children[Ta],e,t);return new oc(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=hG(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new oc(n.segments,r)}}function OF(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(AS(s)){const h=$ce(s.outlets);return new oc(i,h)}if(0===r&&TI(t[0])){i.push(new pS(n.segments[e].path,uG(t[0]))),r++;continue}const o=AS(s)?s.outlets[Ta]:`${s}`,l=r<t.length-1?t[r+1]:null;o&&l&&TI(l)?(i.push(new pS(o,uG(l))),r+=2):(i.push(new pS(o,{})),r++)}return new oc(i,{})}function $ce(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=OF(new oc([],{}),0,i))}),e}function uG(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function dG(n,e,t){return n==t.path&&M0(e,t.parameters)}const _S="imperative";var il=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(il||{});class E0{constructor(e,t){this.id=e,this.url=t}}class II extends E0{constructor(e,t,i="imperative",r=null){super(e,t),this.type=il.NavigationStart,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class j_ extends E0{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=il.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var gm=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(gm||{}),BI=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(BI||{});class Nb extends E0{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=il.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class L2 extends E0{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=il.NavigationSkipped}}class LF extends E0{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=il.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class fG extends E0{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=il.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xce extends E0{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=il.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Yce extends E0{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=il.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Kce extends E0{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=il.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zce extends E0{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=il.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Jce{constructor(e){this.route=e,this.type=il.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class ehe{constructor(e){this.route=e,this.type=il.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class the{constructor(e){this.snapshot=e,this.type=il.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class nhe{constructor(e){this.snapshot=e,this.type=il.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ihe{constructor(e){this.snapshot=e,this.type=il.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class rhe{constructor(e){this.snapshot=e,this.type=il.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class pG{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=il.Scroll}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class NF{}class PI{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}}function Sg(n){return n.outlet||Ta}function yS(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class hhe{get injector(){return yS(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new vS(this.rootInjector),this.attachRef=null}}let vS=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new hhe(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(th))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class mG{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=UF(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=UF(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=zF(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return zF(e,this._root).map(t=>t.value)}}function UF(n,e){if(n===e.value)return e;for(const t of e.children){const i=UF(n,t);if(i)return i}return null}function zF(n,e){if(n===e.value)return[e];for(const t of e.children){const i=zF(n,t);if(i.length)return i.unshift(e),i}return[]}class Tg{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function N2(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class AG extends mG{constructor(e,t){super(e),this.snapshot=t,HF(this,e)}toString(){return this.snapshot.toString()}}function gG(n){const e=function uhe(n){const s=new kI([],{},{},"",{},Ta,n,null,{});return new _G("",new Tg(s,[]))}(n),t=new dn([new pS("",{})]),i=new dn({}),r=new dn({}),s=new dn({}),o=new dn(""),l=new U2(t,i,s,o,r,Ta,n,e.root);return l.snapshot=e.root,new AG(new Tg(l,[]),e)}class U2{constructor(e,t,i,r,s,o,l,h){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=l,this._futureSnapshot=h,this.title=this.dataSubject?.pipe(kn(u=>u[fS]))??ds(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(kn(e=>F2(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(kn(e=>F2(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function RI(n,e,t="emptyOnly"){let i;const{routeConfig:r}=n;return i=null===e||"always"!==t&&""!==r?.path&&(e.component||e.routeConfig?.loadComponent)?{params:{...n.params},data:{...n.data},resolve:{...n.data,...n._resolvedData??{}}}:{params:{...e.params,...n.params},data:{...e.data,...n.data},resolve:{...n.data,...e.data,...r?.data,...n._resolvedData}},r&&vG(r)&&(i.resolve[fS]=r.title),i}class kI{get title(){return this.data?.[fS]}constructor(e,t,i,r,s,o,l,h,u){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=l,this.routeConfig=h,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=F2(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=F2(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class _G extends mG{constructor(e,t){super(t),this.url=e,HF(this,t)}toString(){return yG(this._root)}}function HF(n,e){e.value._routerState=n,e.children.forEach(t=>HF(n,t))}function yG(n){const e=n.children.length>0?` { ${n.children.map(yG).join(", ")} } `:"";return`${n.value}${e}`}function VF(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,M0(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),M0(e.params,t.params)||n.paramsSubject.next(t.params),function wce(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!M0(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),M0(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function GF(n,e){const t=M0(n.params,e.params)&&function Sce(n,e){return Ob(n,e)&&n.every((t,i)=>M0(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||GF(n.parent,e.parent))}function vG(n){return"string"==typeof n.title||null===n.title}let qF=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ta,this.activateEvents=new os,this.deactivateEvents=new os,this.attachEvents=new os,this.detachEvents=new os,this.parentContexts=oi(vS),this.location=oi(Fh),this.changeDetector=oi(Ac),this.inputBinder=oi(FI,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new xi(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new xi(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new xi(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new xi(4013,!1);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,h=new QF(t,l,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:h,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=mr({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[dc]})}return n})();class QF{__ngOutletInjector(e){return new QF(this.route,this.childContexts,e)}constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===U2?this.route:e===vS?this.childContexts:this.parent.get(e,t)}}const FI=new Ai("");let bG=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=Bb([i.queryParams,i.params,i.data]).pipe(Ru(([s,o,l],h)=>(l={...s,...o,...l},0===h?ds(l):Promise.resolve(l)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const o=function _se(n){const e=Ro(n);if(!e)return null;const t=new BE(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(o)for(const{templateName:l}of o.inputs)t.activatedComponentRef.setInput(l,s[l]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();function bS(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function fhe(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return bS(n,i,r);return bS(n,i)})}(n,e,t);return new Tg(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(l=>bS(n,l)),o}}const i=function phe(n){return new U2(new dn(n.url),new dn(n.params),new dn(n.queryParams),new dn(n.fragment),new dn(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>bS(n,s));return new Tg(i,r)}}class jF{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}}const xG="ngNavigationCancelingError";function OI(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=Lb(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=wG(!1,gm.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function wG(n,e){const t=new Error(`NavigationCancelingError: ${n||""}`);return t[xG]=!0,t.cancellationCode=e,t}function CG(n){return!!n&&n[xG]}class ghe{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),VF(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=N2(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=N2(e);for(const o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(i&&i.outlet){const o=i.outlet.detach(),l=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:l})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=N2(e);for(const o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=N2(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new rhe(s.value.snapshot))}),e.children.length&&this.forwardEvent(new nhe(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(VF(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const l=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(l.contexts),o.attachRef=l.componentRef,o.route=l.route.value,o.outlet&&o.outlet.attach(l.componentRef,l.route.value),VF(l.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=r,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,i)}}class MG{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class LI{constructor(e,t){this.component=e,this.route=t}}function _he(n,e,t){const i=n._root;return xS(i,e?e._root:null,t,[i.value])}function z2(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function Pc(n){return null!==zp(n)}(n)?e.get(n):n:i}function xS(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=N2(e);return n.children.forEach(o=>{(function vhe(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,l=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const h=function bhe(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Ob(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Ob(n.url,e.url)||!M0(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!GF(n,e)||!M0(n.queryParams,e.queryParams);default:return!GF(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);h?r.canActivateChecks.push(new MG(i)):(s.data=o.data,s._resolvedData=o._resolvedData),xS(n,e,s.component?l?l.children:null:t,i,r),h&&l&&l.outlet&&l.outlet.isActivated&&r.canDeactivateChecks.push(new LI(l.outlet.component,o))}else o&&wS(e,l,r),r.canActivateChecks.push(new MG(i)),xS(n,null,s.component?l?l.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,l])=>wS(l,t.getContext(o),r)),r}function wS(n,e,t){const i=N2(n),r=n.value;Object.entries(i).forEach(([s,o])=>{wS(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new LI(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function CS(n){return"function"==typeof n}function EG(n){return n instanceof vI||"EmptyError"===n?.name}const NI=Symbol("INITIAL_VALUE");function H2(){return Ru(n=>Bb(n.map(e=>e.pipe(lh(1),Mp(NI)))).pipe(kn(e=>{for(const t of e)if(!0!==t){if(t===NI)return NI;if(!1===t||The(t))return t}return!0}),Nc(e=>e!==NI),lh(1)))}function The(n){return Lb(n)||n instanceof jF}function SG(n){return function me(...n){return _e(n)}(Xc(e=>{if("boolean"!=typeof e)throw OI(0,e)}),kn(e=>!0===e))}class WF{constructor(e){this.segmentGroup=e||null}}class UI extends Error{constructor(e){super(),this.urlTree=e}}function V2(n){return dS(new WF(n))}class Hhe{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return ds(i);if(r.numberOfChildren>1||!r.children[Ta])return dS(new xi(4e3,!1));r=r.children[Ta]}}applyRedirectCommands(e,t,i,r,s){if("string"!=typeof t){const l=t,{queryParams:h,fragment:u,routeConfig:f,url:y,outlet:T,params:B,data:j,title:ne}=r,se=Fd(s,()=>l({params:B,data:j,queryParams:h,fragment:u,routeConfig:f,url:y,outlet:T,title:ne}));if(se instanceof Fb)throw new UI(se);t=se}const o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if("/"===t[0])throw new UI(o);return o}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Fb(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&":"===s[0]){const l=s.substring(1);i[r]=t[l]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([l,h])=>{o[l]=this.createSegmentGroup(e,h,i,r)}),new oc(s,o)}createSegments(e,t,i,r){return t.map(s=>":"===s.path[0]?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new xi(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const $F={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Vhe(n,e,t,i,r){const s=TG(n,e,t);return s.matched?(i=function she(n,e){return n.providers&&!n._injector&&(n._injector=AD(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function Nhe(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?ds(r.map(o=>{const l=z2(o,n);return V1(function She(n){return n&&CS(n.canMatch)}(l)?l.canMatch(e,t):Fd(n,()=>l(e,t)))})).pipe(H2(),SG()):ds(!0)}(i,e,t).pipe(kn(o=>!0===o?s:{...$F}))):ds(s)}function TG(n,e,t){if("**"===e.path)return function Ghe(n){return{matched:!0,parameters:n.length>0?XV(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}(t);if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...$F}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||xce)(t,n,e);if(!r)return{...$F};const s={};Object.entries(r.posParams??{}).forEach(([l,h])=>{s[l]=h.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function DG(n,e,t,i){return t.length>0&&function jhe(n,e,t){return t.some(i=>zI(n,e,i)&&Sg(i)!==Ta)}(n,t,i)?{segmentGroup:new oc(e,Qhe(i,new oc(t,n.children))),slicedSegments:[]}:0===t.length&&function Whe(n,e,t){return t.some(i=>zI(n,e,i))}(n,t,i)?{segmentGroup:new oc(n.segments,qhe(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new oc(n.segments,n.children),slicedSegments:t}}function qhe(n,e,t,i){const r={};for(const s of t)if(zI(n,e,s)&&!i[Sg(s)]){const o=new oc([],{});r[Sg(s)]=o}return{...i,...r}}function Qhe(n,e){const t={};t[Ta]=e;for(const i of n)if(""===i.path&&Sg(i)!==Ta){const r=new oc([],{});t[Sg(i)]=r}return t}function zI(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class Xhe{}class Zhe{constructor(e,t,i,r,s,o,l){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=l,this.applyRedirects=new Hhe(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new xi(4002,`'${e.segmentGroup}'`)}recognize(){const e=DG(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(kn(({children:t,rootSnapshot:i})=>{const r=new Tg(i,t),s=new _G("",r),o=function Vce(n,e,t=null,i=null){return aG(oG(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){const t=new kI([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Object.freeze({}),Ta,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Ta,t).pipe(kn(i=>({children:i,rootSnapshot:t})),kb(i=>{if(i instanceof UI)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof WF?this.noMatchError(i):i}))}processSegmentGroup(e,t,i,r,s){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i,s):this.processSegment(e,t,i,i.segments,r,!0,s).pipe(kn(o=>o instanceof Tg?[o]:[]))}processChildren(e,t,i,r){const s=[];for(const o of Object.keys(i.children))"primary"===o?s.unshift(o):s.push(o);return cu(s).pipe(N1(o=>{const l=i.children[o],h=function che(n,e){const t=n.filter(i=>Sg(i)===e);return t.push(...n.filter(i=>Sg(i)!==e)),t}(t,o);return this.processSegmentGroup(e,h,l,o,r)}),function yce(n,e){return Fn(function jV(n,e,t,i,r){return(s,o)=>{let l=t,h=e,u=0;s.subscribe(ai(o,f=>{const y=u++;h=l?n(h,f,y):(l=!0,f),i&&o.next(h)},r&&(()=>{l&&o.next(h),o.complete()})))}}(n,e,arguments.length>=2,!0))}((o,l)=>(o.push(...l),o)),xI(null),function vce(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Nc((r,s)=>n(r,s,i)):W,BF(1),t?xI(e):QV(()=>new vI))}(),nd(o=>{if(null===o)return V2(i);const l=IG(o);return function Jhe(n){n.sort((e,t)=>e.value.outlet===Ta?-1:t.value.outlet===Ta?1:e.value.outlet.localeCompare(t.value.outlet))}(l),ds(l)}))}processSegment(e,t,i,r,s,o,l){return cu(t).pipe(N1(h=>this.processSegmentAgainstRoute(h._injector??e,t,h,i,r,s,o,l).pipe(kb(u=>{if(u instanceof WF)return ds(null);throw u}))),Rb(h=>!!h),kb(h=>{if(EG(h))return function $he(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?ds(new Xhe):V2(i);throw h}))}processSegmentAgainstRoute(e,t,i,r,s,o,l,h){return Sg(i)===o||o!==Ta&&zI(r,s,i)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o,h):this.allowRedirects&&l?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o,h):V2(r):V2(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o,l){const{matched:h,parameters:u,consumedSegments:f,positionalParamSegments:y,remainingSegments:T}=TG(t,r,s);if(!h)return V2(t);"string"==typeof r.redirectTo&&"/"===r.redirectTo[0]&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const B=new kI(s,u,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,BG(r),Sg(r),r.component??r._loadedComponent??null,r,PG(r)),j=RI(B,l,this.paramsInheritanceStrategy);B.params=Object.freeze(j.params),B.data=Object.freeze(j.data);const ne=this.applyRedirects.applyRedirectCommands(f,r.redirectTo,y,B,e);return this.applyRedirects.lineralizeSegments(r,ne).pipe(nd(se=>this.processSegment(e,i,t,se.concat(T),o,!1,l)))}matchSegmentAgainstRoute(e,t,i,r,s,o){const l=Vhe(t,i,r,e);return"**"===i.path&&(t.children={}),l.pipe(Ru(h=>h.matched?this.getChildConfig(e=i._injector??e,i,r).pipe(Ru(({routes:u})=>{const f=i._loadedInjector??e,{parameters:y,consumedSegments:T,remainingSegments:B}=h,j=new kI(T,y,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,BG(i),Sg(i),i.component??i._loadedComponent??null,i,PG(i)),ne=RI(j,o,this.paramsInheritanceStrategy);j.params=Object.freeze(ne.params),j.data=Object.freeze(ne.data);const{segmentGroup:se,slicedSegments:le}=DG(t,T,B,u);if(0===le.length&&se.hasChildren())return this.processChildren(f,u,se,j).pipe(kn(Pe=>new Tg(j,Pe)));if(0===u.length&&0===le.length)return ds(new Tg(j,[]));const Ee=Sg(i)===s;return this.processSegment(f,u,se,le,Ee?Ta:s,!0,j).pipe(kn(Pe=>new Tg(j,Pe instanceof Tg?[Pe]:[])))})):V2(t)))}getChildConfig(e,t,i){return t.children?ds({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?ds({routes:t._loadedRoutes,injector:t._loadedInjector}):function Lhe(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?ds(!0):ds(r.map(o=>{const l=z2(o,n);return V1(function whe(n){return n&&CS(n.canLoad)}(l)?l.canLoad(e,t):Fd(n,()=>l(e,t)))})).pipe(H2(),SG())}(e,t,i).pipe(nd(r=>r?this.configLoader.loadChildren(e,t).pipe(Xc(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function zhe(){return dS(wG(!1,gm.GuardRejected))}())):ds({routes:[],injector:e})}}function eue(n){const e=n.value.routeConfig;return e&&""===e.path}function IG(n){const e=[],t=new Set;for(const i of n){if(!eue(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=IG(i.children);e.push(new Tg(i.value,r))}return e.filter(i=>!t.has(i))}function BG(n){return n.data||{}}function PG(n){return n.resolve||{}}function RG(n){const e=n.children.map(t=>RG(t)).flat();return[n,...e]}function XF(n){return Ru(e=>{const t=n(e);return t?cu(t).pipe(kn(()=>e)):ds(e)})}let kG=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Ta);return i}getResolvedTitleForRoute(t){return t.data[fS]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:()=>oi(oue),providedIn:"root"})}return n})(),oue=(()=>{class n extends kG{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(Lae))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const G2=new Ai("",{providedIn:"root",factory:()=>({})});let FG=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=wr({type:n,selectors:[["ng-component"]],standalone:!0,features:[ah],decls:1,vars:0,template:function(i,r){1&i&&Er(0,"router-outlet")},dependencies:[qF],encapsulation:2})}return n})();function YF(n){const e=n.children&&n.children.map(YF),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ta&&(t.component=FG),t}const q2=new Ai("");let KF=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=oi(uz)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return ds(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=V1(t.loadComponent()).pipe(kn(OG),Xc(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),B2(()=>{this.componentLoaders.delete(t)})),r=new IF(i,()=>new Qt).pipe(DF());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return ds({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=function aue(n,e,t,i){return V1(n.loadChildren()).pipe(kn(OG),nd(r=>r instanceof SU||Array.isArray(r)?ds(r):cu(e.compileModuleAsync(r))),kn(r=>{i&&i(n);let s,o,l=!1;return Array.isArray(r)?(o=r,!0):(s=r.create(t).injector,o=s.get(q2,[],{optional:!0,self:!0}).flat()),{routes:o.map(YF),injector:s}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(B2(()=>{this.childrenLoaders.delete(i)})),o=new IF(s,()=>new Qt).pipe(DF());return this.childrenLoaders.set(i,o),o}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function OG(n){return function lue(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let ZF=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:()=>oi(cue),providedIn:"root"})}return n})(),cue=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const LG=new Ai(""),NG=new Ai("");function hue(n,e,t){const i=n.get(NG),r=n.get(ca);return n.get(ns).runOutsideAngular(()=>{if(!r.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,new Promise(u=>setTimeout(u));let s;const o=new Promise(u=>{s=u}),l=r.startViewTransition(()=>(s(),function uue(n){return new Promise(e=>{AA({read:()=>setTimeout(e)},{injector:n})})}(n))),{onViewTransitionCreated:h}=i;return h&&Fd(n,()=>h({transition:l,from:e,to:t})),o})}const UG=new Ai("");let HI=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Qt,this.transitionAbortSubject=new Qt,this.configLoader=oi(KF),this.environmentInjector=oi(th),this.urlSerializer=oi(O2),this.rootContexts=oi(vS),this.location=oi(Sb),this.inputBindingEnabled=null!==oi(FI,{optional:!0}),this.titleStrategy=oi(kG),this.options=oi(G2,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=oi(ZF),this.createViewTransition=oi(LG,{optional:!0}),this.navigationErrorHandler=oi(UG,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>ds(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new ehe(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Jce(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new dn({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:_S,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Nc(s=>0!==s.id),kn(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Ru(s=>{let o=!1,l=!1;return ds(s).pipe(Ru(h=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",gm.SupersededByNewNavigation),Am;this.currentTransition=s,this.currentNavigation={id:h.id,initialUrl:h.rawUrl,extractedUrl:h.extractedUrl,targetBrowserUrl:"string"==typeof h.extras.browserUrl?this.urlSerializer.parse(h.extras.browserUrl):h.extras.browserUrl,trigger:h.source,extras:h.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null};const u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!u&&"reload"!==(h.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const y="";return this.events.next(new L2(h.id,this.urlSerializer.serialize(h.rawUrl),y,BI.IgnoredSameUrlNavigation)),h.resolve(!1),Am}if(this.urlHandlingStrategy.shouldProcessUrl(h.rawUrl))return ds(h).pipe(Ru(y=>{const T=this.transitions?.getValue();return this.events.next(new II(y.id,this.urlSerializer.serialize(y.extractedUrl),y.source,y.restoredState)),T!==this.transitions?.getValue()?Am:Promise.resolve(y)}),function tue(n,e,t,i,r,s){return nd(o=>function Yhe(n,e,t,i,r,s,o="emptyOnly"){return new Zhe(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(kn(({state:l,tree:h})=>({...o,targetSnapshot:l,urlAfterRedirects:h}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Xc(y=>{s.targetSnapshot=y.targetSnapshot,s.urlAfterRedirects=y.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:y.urlAfterRedirects};const T=new fG(y.id,this.urlSerializer.serialize(y.extractedUrl),this.urlSerializer.serialize(y.urlAfterRedirects),y.targetSnapshot);this.events.next(T)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(h.currentRawUrl)){const{id:y,extractedUrl:T,source:B,restoredState:j,extras:ne}=h,se=new II(y,this.urlSerializer.serialize(T),B,j);this.events.next(se);const le=gG(this.rootComponentType).snapshot;return this.currentTransition=s={...h,targetSnapshot:le,urlAfterRedirects:T,extras:{...ne,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=T,ds(s)}{const y="";return this.events.next(new L2(h.id,this.urlSerializer.serialize(h.extractedUrl),y,BI.IgnoredByUrlHandlingStrategy)),h.resolve(!1),Am}}),Xc(h=>{const u=new Xce(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(u)}),kn(h=>(this.currentTransition=s={...h,guards:_he(h.targetSnapshot,h.currentSnapshot,this.rootContexts)},s)),function Dhe(n,e){return nd(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?ds({...t,guardsResult:!0}):function Ihe(n,e,t,i){return cu(n).pipe(nd(r=>function Ohe(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?ds(s.map(l=>{const h=yS(e)??r,u=z2(l,h);return V1(function Ehe(n){return n&&CS(n.canDeactivate)}(u)?u.canDeactivate(n,e,t,i):Fd(h,()=>u(n,e,t,i))).pipe(Rb())})).pipe(H2()):ds(!0)}(r.component,r.route,t,e,i)),Rb(r=>!0!==r,!0))}(o,i,r,n).pipe(nd(l=>l&&function xhe(n){return"boolean"==typeof n}(l)?function Bhe(n,e,t,i){return cu(e).pipe(N1(r=>Pb(function Rhe(n,e){return null!==n&&e&&e(new the(n)),ds(!0)}(r.route.parent,i),function Phe(n,e){return null!==n&&e&&e(new ihe(n)),ds(!0)}(r.route,i),function Fhe(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function yhe(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>bI(()=>ds(o.guards.map(h=>{const u=yS(o.node)??t,f=z2(h,u);return V1(function Mhe(n){return n&&CS(n.canActivateChild)}(f)?f.canActivateChild(i,n):Fd(u,()=>f(i,n))).pipe(Rb())})).pipe(H2())));return ds(s).pipe(H2())}(n,r.path,t),function khe(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return ds(!0);const r=i.map(s=>bI(()=>{const o=yS(e)??t,l=z2(s,o);return V1(function Che(n){return n&&CS(n.canActivate)}(l)?l.canActivate(e,n):Fd(o,()=>l(e,n))).pipe(Rb())}));return ds(r).pipe(H2())}(n,r.route,t))),Rb(r=>!0!==r,!0))}(i,s,n,e):ds(l)),kn(l=>({...t,guardsResult:l})))})}(this.environmentInjector,h=>this.events.next(h)),Xc(h=>{if(s.guardsResult=h.guardsResult,h.guardsResult&&"boolean"!=typeof h.guardsResult)throw OI(0,h.guardsResult);const u=new Yce(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot,!!h.guardsResult);this.events.next(u)}),Nc(h=>!!h.guardsResult||(this.cancelNavigationTransition(h,"",gm.GuardRejected),!1)),XF(h=>{if(h.guards.canActivateChecks.length)return ds(h).pipe(Xc(u=>{const f=new Kce(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}),Ru(u=>{let f=!1;return ds(u).pipe(function nue(n,e){return nd(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return ds(t);const s=new Set(r.map(h=>h.route)),o=new Set;for(const h of s)if(!o.has(h))for(const u of RG(h))o.add(u);let l=0;return cu(o).pipe(N1(h=>s.has(h)?function iue(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!vG(r)&&(s[fS]=r.title),function rue(n,e,t,i){const r=PF(n);if(0===r.length)return ds({});const s={};return cu(r).pipe(nd(o=>function sue(n,e,t,i){const r=yS(e)??i,s=z2(n,r);return V1(s.resolve?s.resolve(e,t):Fd(r,()=>s(e,t)))}(n[o],e,t,i).pipe(Rb(),Xc(l=>{if(l instanceof jF)throw OI(new CI,l);s[o]=l}))),BF(1),WV(s),kb(o=>EG(o)?Am:dS(o)))}(s,n,e,i).pipe(kn(o=>(n._resolvedData=o,n.data=RI(n,n.parent,t).resolve,null)))}(h,i,n,e):(h.data=RI(h,h.parent,n).resolve,ds(void 0))),Xc(()=>l++),BF(1),nd(h=>l===o.size?ds(t):Am))})}(this.paramsInheritanceStrategy,this.environmentInjector),Xc({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(u,"",gm.NoDataFromResolver)}}))}),Xc(u=>{const f=new Zce(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}))}),XF(h=>{const u=f=>{const y=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&y.push(this.configLoader.loadComponent(f.routeConfig).pipe(Xc(T=>{f.component=T}),kn(()=>{})));for(const T of f.children)y.push(...u(T));return y};return Bb(u(h.targetSnapshot.root)).pipe(xI(null),lh(1))}),XF(()=>this.afterPreactivation()),Ru(()=>{const{currentSnapshot:h,targetSnapshot:u}=s,f=this.createViewTransition?.(this.environmentInjector,h.root,u.root);return f?cu(f).pipe(kn(()=>s)):ds(s)}),kn(h=>{const u=function dhe(n,e,t){const i=bS(n,e._root,t?t._root:void 0);return new AG(i,e)}(t.routeReuseStrategy,h.targetSnapshot,h.currentRouterState);return this.currentTransition=s={...h,targetRouterState:u},this.currentNavigation.targetRouterState=u,s}),Xc(()=>{this.events.next(new NF)}),((n,e,t,i)=>kn(r=>(new ghe(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,h=>this.events.next(h),this.inputBindingEnabled),lh(1),Xc({next:h=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new j_(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects))),this.titleStrategy?.updateTitle(h.targetRouterState.snapshot),h.resolve(!0)},complete:()=>{o=!0}}),fl(this.transitionAbortSubject.pipe(Xc(h=>{throw h}))),B2(()=>{!o&&!l&&this.cancelNavigationTransition(s,"",gm.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),kb(h=>{if(l=!0,CG(h))this.events.next(new Nb(s.id,this.urlSerializer.serialize(s.extractedUrl),h.message,h.cancellationCode)),function mhe(n){return CG(n)&&Lb(n.url)}(h)?this.events.next(new PI(h.url,h.navigationBehaviorOptions)):s.resolve(!1);else{const u=new LF(s.id,this.urlSerializer.serialize(s.extractedUrl),h,s.targetSnapshot??void 0);try{const f=Fd(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(f instanceof jF){const{message:y,cancellationCode:T}=OI(0,f);this.events.next(new Nb(s.id,this.urlSerializer.serialize(s.extractedUrl),y,T)),this.events.next(new PI(f.redirectTo,f.navigationBehaviorOptions))}else{this.events.next(u);const y=t.errorHandler(h);s.resolve(!!y)}}catch(f){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(f)}}return Am}))}))}cancelNavigationTransition(t,i,r){const s=new Nb(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){const t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function due(n){return n!==_S}let fue=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:()=>oi(mue),providedIn:"root"})}return n})();class pue{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let mue=(()=>{class n extends pue{static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=yt(n)))(r||n)}})();static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),zG=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:()=>oi(Aue),providedIn:"root"})}return n})(),Aue=(()=>{class n extends zG{constructor(){super(...arguments),this.location=oi(Sb),this.urlSerializer=oi(O2),this.options=oi(G2,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=oi(ZF),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Fb,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=gG(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{"popstate"===i.type&&t(i.url,i.state)})}handleRouterEvent(t,i){if(t instanceof II)this.stateMemento=this.createStateMemento();else if(t instanceof L2)this.rawUrlTree=i.initialUrl;else if(t instanceof fG){if("eager"===this.urlUpdateStrategy&&!i.extras.skipLocationChange){const r=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(i.targetBrowserUrl??r,i)}}else t instanceof NF?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,"deferred"===this.urlUpdateStrategy&&!i.extras.skipLocationChange&&this.setBrowserUrl(i.targetBrowserUrl??this.rawUrlTree,i)):t instanceof Nb&&(t.code===gm.GuardRejected||t.code===gm.NoDataFromResolver)?this.restoreHistory(i):t instanceof LF?this.restoreHistory(i,!0):t instanceof j_&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,i){const r=t instanceof Fb?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&0===s&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=yt(n)))(r||n)}})();static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var MS=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(MS||{});function HG(n,e){n.events.pipe(Nc(t=>t instanceof j_||t instanceof Nb||t instanceof LF||t instanceof L2),kn(t=>t instanceof j_||t instanceof L2?MS.COMPLETE:t instanceof Nb&&(t.code===gm.Redirect||t.code===gm.SupersededByNewNavigation)?MS.REDIRECTING:MS.FAILED),Nc(t=>t!==MS.REDIRECTING),lh(1)).subscribe(()=>{e()})}function gue(n){throw n}const _ue={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},yue={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let S0=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=oi(ez),this.stateManager=oi(zG),this.options=oi(G2,{optional:!0})||{},this.pendingTasks=oi(ed),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=oi(HI),this.urlSerializer=oi(O2),this.location=oi(Sb),this.urlHandlingStrategy=oi(ZF),this._events=new Qt,this.errorHandler=this.options.errorHandler||gue,this.navigated=!1,this.routeReuseStrategy=oi(fue),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=oi(q2,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!oi(FI,{optional:!0}),this.eventsSubscription=new pt,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(null!==r&&null!==s)if(this.stateManager.handleRouterEvent(i,s),i instanceof Nb&&i.code!==gm.Redirect&&i.code!==gm.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof j_)this.navigated=!0;else if(i instanceof PI){const o=i.navigationBehaviorOptions,l=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),h={browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||"eager"===this.urlUpdateStrategy||due(r.source),...o};this.scheduleNavigation(l,_S,null,h,{resolve:r.resolve,reject:r.reject,promise:r.promise})}(function bue(n){return!(n instanceof NF||n instanceof PI)})(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),_S,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",i)},0)})}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const h={...r};delete h.navigationId,delete h.\u0275routerPageId,0!==Object.keys(h).length&&(s.state=h)}const l=this.parseUrl(t);this.scheduleNavigation(l,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(YF),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:l,preserveFragment:h}=i,u=h?this.currentUrlTree.fragment:o;let y,f=null;switch(l??this.options.defaultQueryParamsHandling){case"merge":f={...this.currentUrlTree.queryParams,...s};break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=s||null}null!==f&&(f=this.removeEmptyProps(f));try{y=oG(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||"/"!==t[0][0])&&(t=[]),y=this.currentUrlTree.root}return aG(y,t,f,u??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Lb(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,_S,null,i)}navigate(t,i={skipLocationChange:!1}){return function vue(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new xi(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let r;if(r=!0===i?{..._ue}:!1===i?{...yue}:i,Lb(t))return KV(this.currentUrlTree,t,r);const s=this.parseUrl(t);return KV(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,s])=>(null!=s&&(i[r]=s),i),{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let l,h,u;o?(l=o.resolve,h=o.reject,u=o.promise):u=new Promise((y,T)=>{l=y,h=T});const f=this.pendingTasks.add();return HG(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:l,reject:h,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(y=>Promise.reject(y))}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ES=(()=>{class n{constructor(t,i,r,s,o,l){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=s,this.el=o,this.locationStrategy=l,this.href=null,this.onChanges=new Qt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;const h=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===h||"area"===h,this.isAnchorElement?this.subscription=t.events.subscribe(u=>{u instanceof j_&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null==t?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(this.routerLinkInput=Lb(t)||Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,s,o){const l=this.urlTree;return!!(null===l||this.isAnchorElement&&(0!==t||i||r||s||o||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(l,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const t=this.urlTree;this.href=null!==t&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;const i=null===this.href?null:function V3(n,e,t){return function H3(n,e){return"src"===e&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===e&&("base"===n||"link"===n)?ZM:T_}(e,t)(n)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(t,i){const r=this.renderer,s=this.el.nativeElement;null!==i?r.setAttribute(s,t,i):r.removeAttribute(s,t)}get urlTree(){return null===this.routerLinkInput?null:Lb(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(i){return new(i||n)(Q(S0),Q(U2),an("tabindex"),Q(L_),Q(ro),Q(Eb))};static#t=this.\u0275dir=mr({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,r){1&i&&mi("click",function(o){return r.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&i&&ja("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",js],skipLocationChange:[2,"skipLocationChange","skipLocationChange",js],replaceUrl:[2,"replaceUrl","replaceUrl",js],routerLink:"routerLink"},standalone:!0,features:[kl,dc]})}return n})();class VG{}let Cue=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Nc(t=>t instanceof j_),N1(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=AD(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,l=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(l,s.children??s._loadedRoutes))}return cu(r).pipe(k2())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):ds(null);const s=r.pipe(nd(o=>null===o?ds(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?cu([s,this.loader.loadComponent(i)]).pipe(k2()):s})}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(S0),Wn(uz),Wn(th),Wn(VG),Wn(KF))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const JF=new Ai("");let GG=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof II?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof j_?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof L2&&t.code===BI.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof pG&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new pG(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){Me()};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();function T0(n,e){return{\u0275kind:n,\u0275providers:e}}function QG(){const n=oi(Dr);return e=>{const t=n.get(yA);if(e!==t.components[0])return;const i=n.get(S0),r=n.get(jG);1===n.get(eO)&&i.initialNavigation(),n.get(WG,null,Xo.Optional)?.setUpPreloading(),n.get(JF,null,Xo.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const jG=new Ai("",{factory:()=>new Qt}),eO=new Ai("",{providedIn:"root",factory:()=>1}),WG=new Ai("");function Tue(n){return T0(0,[{provide:WG,useExisting:Cue},{provide:VG,useExisting:n}])}function Iue(n){return T0(9,[{provide:LG,useValue:hue},{provide:NG,useValue:{skipNextTransition:!!n?.skipInitialTransition,...n}}])}const $G=new Ai("ROUTER_FORROOT_GUARD"),Bue=[Sb,{provide:O2,useClass:CI},S0,vS,{provide:U2,useFactory:function qG(n){return n.routerState.root},deps:[S0]},KF,[]];let XG=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[Bue,[],{provide:q2,multi:!0,useValue:t},{provide:$G,useFactory:Fue,deps:[[S0,new xu,new Hm]]},{provide:G2,useValue:i||{}},i?.useHash?{provide:Eb,useClass:wse}:{provide:Eb,useClass:aH},{provide:JF,useFactory:()=>{const n=oi(Loe),e=oi(ns),t=oi(G2),i=oi(HI),r=oi(O2);return t.scrollOffset&&n.setOffset(t.scrollOffset),new GG(r,i,n,e,t)}},i?.preloadingStrategy?Tue(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?Oue(i):[],i?.bindToComponentInputs?T0(8,[bG,{provide:FI,useExisting:bG}]).\u0275providers:[],i?.enableViewTransitions?Iue().\u0275providers:[],[{provide:YG,useFactory:QG},{provide:UD,multi:!0,useExisting:YG}]]}}static forChild(t){return{ngModule:n,providers:[{provide:q2,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||n)(Wn($G,8))};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({})}return n})();function Fue(n){return"guarded"}function Oue(n){return["disabled"===n.initialNavigation?T0(3,[{provide:Bk,multi:!0,useFactory:()=>{const e=oi(S0);return()=>{e.setUpLocationChangeListener()}}},{provide:eO,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?T0(2,[{provide:eO,useValue:0},{provide:Bk,multi:!0,deps:[Dr],useFactory:e=>{const t=e.get(bse,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(S0),s=e.get(jG);HG(r,()=>{i(!0)}),e.get(HI).afterPreactivation=()=>(i(!0),s.closed?ds(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const YG=new Ai("");let Nue=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=wr({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(i,r){1&i&&Er(0,"router-outlet")},dependencies:[qF]})}return n})();var KG=Te(4186),ZG=(Te(3324),Te(165),Te(2481),Te(3752),Te(4862),Te(5074),Te(5320),Te(3402)),JG=(Te(9606),Te(8521),Te(9907));Te(5619),Te(4493),Te(6119);var Dg=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return n},Out:function(n){return n},InOut:function(n){return n}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return.5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return 0===n?0:Math.pow(1024,n-1)},Out:function(n){return 1===n?1:1-Math.pow(2,-10*n)},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(2-Math.pow(2,-10*(n-1)))}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return 0===n?0:1===n?1:-Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)},Out:function(n){return 0===n?0:1===n?1:Math.pow(2,-10*n)*Math.sin(5*(n-.1)*Math.PI)+1},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?-.5*Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(n){var e=1.70158;return 1===n?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return 0===n?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?n*n*((e+1)*n-e)*.5:.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-Dg.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?.5*Dg.Bounce.In(2*n):.5*Dg.Bounce.Out(2*n-1)+.5}}),generatePow:function(n){return void 0===n&&(n=4),n=(n=n<Number.EPSILON?Number.EPSILON:n)>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(2*e,n)/2:(1-Math.pow(2-2*e,n))/2+.5}}}}),Q2=function(){return performance.now()},eq=function(){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},n.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},n.prototype.update=function(e,t){void 0===e&&(e=Q2()),void 0===t&&(t=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var s=this._tweens[i[r]];s&&!1===s.update(e,!t)&&!t&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},n}(),Ub={Linear:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=Ub.Utils.Linear;return e<0?s(n[0],n[1],i):e>1?s(n[t],n[t-1],t-i):s(n[r],n[r+1>t?t:r+1],i-r)},Bezier:function(n,e){for(var t=0,i=n.length-1,r=Math.pow,s=Ub.Utils.Bernstein,o=0;o<=i;o++)t+=r(1-e,i-o)*r(e,o)*n[o]*s(i,o);return t},CatmullRom:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=Ub.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(r=Math.floor(i=t*(1+e))),s(n[(r-1+t)%t],n[r],n[(r+1)%t],n[(r+2)%t],i-r)):e<0?n[0]-(s(n[0],n[0],n[1],n[1],-i)-n[0]):e>1?n[t]-(s(n[t],n[t],n[t-1],n[t-1],i-t)-n[t]):s(n[r?r-1:0],n[r],n[t<r+1?t:r+1],n[t<r+2?t:r+2],i-r)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=Ub.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:function(){var n=[1];return function(e){var t=1;if(n[e])return n[e];for(var i=e;i>1;i--)t*=i;return n[e]=t,t}}(),CatmullRom:function(n,e,t,i,r){var s=.5*(t-n),o=.5*(i-e),l=r*r;return(2*e-2*t+s+o)*(r*l)+(-3*e+3*t-2*s-o)*l+s*r+e}}},nO=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),iO=new eq,zf=function(){function n(e,t){void 0===t&&(t=iO),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Dg.Linear.None,this._interpolationFunction=Ub.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=nO.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.getDuration=function(){return this._duration},n.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},n.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e<0?0:e,this},n.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(void 0===e&&(e=Q2()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var i in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,i,r,s){for(var o in i){var l=e[o],h=Array.isArray(l),u=h?"array":typeof l,f=!h&&Array.isArray(i[o]);if("undefined"!==u&&"function"!==u){if(f){if(0===(y=i[o]).length)continue;for(var T=[l],B=0,j=y.length;B<j;B+=1){var ne=this._handleRelativeValue(l,y[B]);if(isNaN(ne)){f=!1,console.warn("Found invalid interpolation list. Skipping.");break}T.push(ne)}f&&(i[o]=T)}if("object"!==u&&!h||!l||f)(typeof t[o]>"u"||s)&&(t[o]=l),h||(t[o]*=1),r[o]=f?i[o].slice().reverse():t[o]||0;else{t[o]=h?[]:{};var se=l;for(var le in se)t[o][le]=se[le];r[o]=h?[]:{};var y=i[o];if(!this._isDynamic){var Ee={};for(var le in y)Ee[le]=y[le];i[o]=y=Ee}this._setupProperties(se,t[o],y,r[o],s)}}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},n.prototype.pause=function(e){return void 0===e&&(e=Q2()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},n.prototype.resume=function(e){return void 0===e&&(e=Q2()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return void 0===e&&(e=iO),this._group=e,this},n.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return void 0===e&&(e=Dg.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return void 0===e&&(e=Ub.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){var r,s,i=this;if(void 0===e&&(e=Q2()),void 0===t&&(t=!0),this._isPaused)return!0;if(!this._goToEnd&&!this._isPlaying){if(e>this._startTime+this._duration)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var l=e-this._startTime,h=this._duration+(null!==(r=this._repeatDelayTime)&&void 0!==r?r:this._delayTime),u=this._duration+this._repeat*h,y=function(){if(0===i._duration||l>u)return 1;var se=Math.trunc(l/h),Ee=Math.min((l-se*h)/i._duration,1);return 0===Ee&&l===i._duration?1:Ee}(),T=this._easingFunction(y);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,T),this._onUpdateCallback&&this._onUpdateCallback(this._object,y),0===this._duration||l>=this._duration){if(this._repeat>0){var B=Math.min(Math.trunc((l-this._duration)/h)+1,this._repeat);for(s in isFinite(this._repeat)&&(this._repeat-=B),this._valuesStartRepeat)!this._yoyo&&"string"==typeof this._valuesEnd[s]&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=h*B,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var j=0,ne=this._chainedTweens.length;j<ne;j++)this._chainedTweens[j].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,i,r){for(var s in i)if(void 0!==t[s]){var o=t[s]||0,l=i[s],h=Array.isArray(e[s]),u=Array.isArray(l);!h&&u?e[s]=this._interpolationFunction(l,r):"object"==typeof l&&l?this._updateProperties(e[s],o,l,r):"number"==typeof(l=this._handleRelativeValue(o,l))&&(e[s]=o+(l-o)*r)}},n.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof i?this._valuesStartRepeat[e]+parseFloat(i):this._valuesEnd[e],this._valuesEnd[e]=t},n}(),D0=iO,tq=(D0.getAll.bind(D0),D0.removeAll.bind(D0),D0.add.bind(D0),D0.remove.bind(D0),D0.update.bind(D0));const zb="168",iq=1,$ue=2,W_=3,I0=0,Ep=1,ku=2,Vb=100,Yue=101,Kue=102,ede=200,tde=201,nde=202,ide=203,sO=204,oO=205,rde=206,sde=207,ode=208,ade=209,lde=210,cde=211,hde=212,ude=213,dde=214,GI=0,vde=1,bde=2,G1=0,xde=1,wde=2,Cde=3,Mde=4,Ede=5,Sde=6,Tde=7,oq="attached",q1=301,Gb=302,SS=306,Q1=1e3,_m=1001,$2=1002,Fu=1003,jI=1004,qb=1005,bh=1006,X2=1007,xA=1008,$_=1009,aq=1010,lq=1011,TS=1012,lO=1013,j1=1014,ym=1015,wA=1016,cO=1017,hO=1018,Y2=1020,cq=35902,hq=1021,uq=1022,Hf=1023,dq=1024,fq=1025,K2=1026,Z2=1027,uO=1028,WI=1029,pq=1030,dO=1031,fO=1033,$I=33776,XI=33777,YI=33778,KI=33779,pO=35840,mO=35841,AO=35842,gO=35843,_O=36196,yO=37492,vO=37496,bO=37808,xO=37809,wO=37810,CO=37811,MO=37812,EO=37813,SO=37814,TO=37815,DO=37816,IO=37817,BO=37818,PO=37819,RO=37820,kO=37821,ZI=36492,FO=36494,OO=36495,mq=36283,LO=36284,NO=36285,UO=36286,J2=2300,eC=2301,hu="srgb",id="srgb-linear",GO="display-p3",e4="display-p3-linear",t4="linear",Uc="srgb",n4="rec709",r4="p3",iC=7680,Ode=512,Lde=513,Nde=514,vq=515,Ude=516,zde=517,Hde=518,Vde=519,bq="300 es",Y_=2e3;class K_{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Xd=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let xq=1234567;const jb=Math.PI/180,rC=180/Math.PI;function vm(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Xd[255&n]+Xd[n>>8&255]+Xd[n>>16&255]+Xd[n>>24&255]+"-"+Xd[255&e]+Xd[e>>8&255]+"-"+Xd[e>>16&15|64]+Xd[e>>24&255]+"-"+Xd[63&t|128]+Xd[t>>8&255]+"-"+Xd[t>>16&255]+Xd[t>>24&255]+Xd[255&i]+Xd[i>>8&255]+Xd[i>>16&255]+Xd[i>>24&255]).toLowerCase()}function xh(n,e,t){return Math.max(e,Math.min(t,n))}function qO(n,e){return(n%e+e)%e}function DS(n,e,t){return(1-t)*n+t*e}function Vf(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function ba(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const IS={DEG2RAD:jb,RAD2DEG:rC,generateUUID:vm,clamp:xh,euclideanModulo:qO,mapLinear:function Gde(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)},inverseLerp:function qde(n,e,t){return n!==e?(t-n)/(e-n):0},lerp:DS,damp:function Qde(n,e,t,i){return DS(n,e,1-Math.exp(-t*i))},pingpong:function jde(n,e=1){return e-Math.abs(qO(n,2*e)-e)},smoothstep:function Wde(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*(3-2*n)},smootherstep:function $de(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*n*(n*(6*n-15)+10)},randInt:function Xde(n,e){return n+Math.floor(Math.random()*(e-n+1))},randFloat:function Yde(n,e){return n+Math.random()*(e-n)},randFloatSpread:function Kde(n){return n*(.5-Math.random())},seededRandom:function Zde(n){void 0!==n&&(xq=n);let e=xq+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function Jde(n){return n*jb},radToDeg:function efe(n){return n*rC},isPowerOfTwo:function tfe(n){return!(n&n-1)&&0!==n},ceilPowerOfTwo:function nfe(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},floorPowerOfTwo:function ife(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},setQuaternionFromProperEuler:function rfe(n,e,t,i,r){const s=Math.cos,o=Math.sin,l=s(t/2),h=o(t/2),u=s((e+i)/2),f=o((e+i)/2),y=s((e-i)/2),T=o((e-i)/2),B=s((i-e)/2),j=o((i-e)/2);switch(r){case"XYX":n.set(l*f,h*y,h*T,l*u);break;case"YZY":n.set(h*T,l*f,h*y,l*u);break;case"ZXZ":n.set(h*y,h*T,l*f,l*u);break;case"XZX":n.set(l*f,h*j,h*B,l*u);break;case"YXY":n.set(h*B,l*f,h*j,l*u);break;case"ZYZ":n.set(h*j,h*B,l*f,l*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:ba,denormalize:Vf};class Fi{constructor(e=0,t=0){Fi.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(xh(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class xa{constructor(e,t,i,r,s,o,l,h,u){xa.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,l,h,u)}set(e,t,i,r,s,o,l,h,u){const f=this.elements;return f[0]=e,f[1]=r,f[2]=l,f[3]=t,f[4]=s,f[5]=h,f[6]=i,f[7]=o,f[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],l=i[3],h=i[6],u=i[1],f=i[4],y=i[7],T=i[2],B=i[5],j=i[8],ne=r[0],se=r[3],le=r[6],Ee=r[1],Pe=r[4],Ve=r[7],Ft=r[2],Ct=r[5],Lt=r[8];return s[0]=o*ne+l*Ee+h*Ft,s[3]=o*se+l*Pe+h*Ct,s[6]=o*le+l*Ve+h*Lt,s[1]=u*ne+f*Ee+y*Ft,s[4]=u*se+f*Pe+y*Ct,s[7]=u*le+f*Ve+y*Lt,s[2]=T*ne+B*Ee+j*Ft,s[5]=T*se+B*Pe+j*Ct,s[8]=T*le+B*Ve+j*Lt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],l=e[5],h=e[6],u=e[7],f=e[8];return t*o*f-t*l*u-i*s*f+i*l*h+r*s*u-r*o*h}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],l=e[5],h=e[6],u=e[7],f=e[8],y=f*o-l*u,T=l*h-f*s,B=u*s-o*h,j=t*y+i*T+r*B;if(0===j)return this.set(0,0,0,0,0,0,0,0,0);const ne=1/j;return e[0]=y*ne,e[1]=(r*u-f*i)*ne,e[2]=(l*i-r*o)*ne,e[3]=T*ne,e[4]=(f*t-r*h)*ne,e[5]=(r*s-l*t)*ne,e[6]=B*ne,e[7]=(i*h-u*t)*ne,e[8]=(o*t-i*s)*ne,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,l){const h=Math.cos(s),u=Math.sin(s);return this.set(i*h,i*u,-i*(h*o+u*l)+o+e,-r*u,r*h,-r*(-u*o+h*l)+l+t,0,0,1),this}scale(e,t){return this.premultiply(QO.makeScale(e,t)),this}rotate(e){return this.premultiply(QO.makeRotation(-e)),this}translate(e,t){return this.premultiply(QO.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const QO=new xa;function wq(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const sfe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function sC(n,e){return new sfe[n](e)}function BS(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function ofe(){const n=BS("canvas");return n.style.display="block",n}const Cq={};function oC(n){n in Cq||(Cq[n]=!0,console.warn(n))}const Mq=(new xa).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Eq=(new xa).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),PS={[id]:{transfer:t4,primaries:n4,luminanceCoefficients:[.2126,.7152,.0722],toReference:n=>n,fromReference:n=>n},[hu]:{transfer:Uc,primaries:n4,luminanceCoefficients:[.2126,.7152,.0722],toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[e4]:{transfer:t4,primaries:r4,luminanceCoefficients:[.2289,.6917,.0793],toReference:n=>n.applyMatrix3(Eq),fromReference:n=>n.applyMatrix3(Mq)},[GO]:{transfer:Uc,primaries:r4,luminanceCoefficients:[.2289,.6917,.0793],toReference:n=>n.convertSRGBToLinear().applyMatrix3(Eq),fromReference:n=>n.applyMatrix3(Mq).convertLinearToSRGB()}},lfe=new Set([id,e4]),pl={enabled:!0,_workingColorSpace:id,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!lfe.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){return!1!==this.enabled&&e!==t&&e&&t?(0,PS[t].fromReference)((0,PS[e].toReference)(n)):n},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return PS[n].primaries},getTransfer:function(n){return""===n?t4:PS[n].transfer},getLuminanceCoefficients:function(n,e=this._workingColorSpace){return n.fromArray(PS[e].luminanceCoefficients)}};function aC(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function jO(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let lC;class cfe{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===lC&&(lC=BS("canvas")),lC.width=e.width,lC.height=e.height;const i=lC.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=lC}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=BS("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*aC(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*aC(t[i]/255)):aC(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let hfe=0;class Wb{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:hfe++}),this.uuid=vm(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,l=r.length;o<l;o++)s.push(WO(r[o].isDataTexture?r[o].image:r[o]))}else s=WO(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function WO(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?cfe.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let ufe=0,Yd=(()=>{class n extends K_{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=_m,s=_m,o=bh,l=xA,h=Hf,u=$_,f=n.DEFAULT_ANISOTROPY,y=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:ufe++}),this.uuid=vm(),this.name="",this.source=new Wb(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=l,this.anisotropy=f,this.format=h,this.internalFormat=null,this.type=u,this.offset=new Fi(0,0),this.repeat=new Fi(1,1),this.center=new Fi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new xa,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=y,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Q1:t.x=t.x-Math.floor(t.x);break;case _m:t.x=t.x<0?0:1;break;case $2:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Q1:t.y=t.y-Math.floor(t.y);break;case _m:t.y=t.y<0?0:1;break;case $2:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){!0===t&&this.pmremVersion++}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class $l{constructor(e=0,t=0,i=0,r=1){$l.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const h=e.elements,u=h[0],f=h[4],y=h[8],T=h[1],B=h[5],j=h[9],ne=h[2],se=h[6],le=h[10];if(Math.abs(f-T)<.01&&Math.abs(y-ne)<.01&&Math.abs(j-se)<.01){if(Math.abs(f+T)<.1&&Math.abs(y+ne)<.1&&Math.abs(j+se)<.1&&Math.abs(u+B+le-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const Pe=(u+1)/2,Ve=(B+1)/2,Ft=(le+1)/2,Ct=(f+T)/4,Lt=(y+ne)/4,Kt=(j+se)/4;return Pe>Ve&&Pe>Ft?Pe<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(Pe),r=Ct/i,s=Lt/i):Ve>Ft?Ve<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(Ve),i=Ct/r,s=Kt/r):Ft<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(Ft),i=Lt/s,r=Kt/s),this.set(i,r,s,t),this}let Ee=Math.sqrt((se-j)*(se-j)+(y-ne)*(y-ne)+(T-f)*(T-f));return Math.abs(Ee)<.001&&(Ee=1),this.x=(se-j)/Ee,this.y=(y-ne)/Ee,this.z=(T-f)/Ee,this.w=Math.acos((u+B+le-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class dfe extends K_{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new $l(0,0,e,t),this.scissorTest=!1,this.viewport=new $l(0,0,e,t);const r={width:e,height:t,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:bh,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);const s=new Yd(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const o=i.count;for(let l=0;l<o;l++)this.textures[l]=s.clone(),this.textures[l].isRenderTargetTexture=!0;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,r=e.textures.length;i<r;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Wb(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class rd extends dfe{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class $O extends Yd{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Fu,this.minFilter=Fu,this.wrapR=_m,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Sq extends Yd{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Fu,this.minFilter=Fu,this.wrapR=_m,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class zc{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,l){let h=i[r+0],u=i[r+1],f=i[r+2],y=i[r+3];const T=s[o+0],B=s[o+1],j=s[o+2],ne=s[o+3];if(0===l)return e[t+0]=h,e[t+1]=u,e[t+2]=f,void(e[t+3]=y);if(1===l)return e[t+0]=T,e[t+1]=B,e[t+2]=j,void(e[t+3]=ne);if(y!==ne||h!==T||u!==B||f!==j){let se=1-l;const le=h*T+u*B+f*j+y*ne,Ee=le>=0?1:-1,Pe=1-le*le;if(Pe>Number.EPSILON){const Ft=Math.sqrt(Pe),Ct=Math.atan2(Ft,le*Ee);se=Math.sin(se*Ct)/Ft,l=Math.sin(l*Ct)/Ft}const Ve=l*Ee;if(h=h*se+T*Ve,u=u*se+B*Ve,f=f*se+j*Ve,y=y*se+ne*Ve,se===1-l){const Ft=1/Math.sqrt(h*h+u*u+f*f+y*y);h*=Ft,u*=Ft,f*=Ft,y*=Ft}}e[t]=h,e[t+1]=u,e[t+2]=f,e[t+3]=y}static multiplyQuaternionsFlat(e,t,i,r,s,o){const l=i[r],h=i[r+1],u=i[r+2],f=i[r+3],y=s[o],T=s[o+1],B=s[o+2],j=s[o+3];return e[t]=l*j+f*y+h*B-u*T,e[t+1]=h*j+f*T+u*y-l*B,e[t+2]=u*j+f*B+l*T-h*y,e[t+3]=f*j-l*y-h*T-u*B,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,o=e._order,l=Math.cos,h=Math.sin,u=l(i/2),f=l(r/2),y=l(s/2),T=h(i/2),B=h(r/2),j=h(s/2);switch(o){case"XYZ":this._x=T*f*y+u*B*j,this._y=u*B*y-T*f*j,this._z=u*f*j+T*B*y,this._w=u*f*y-T*B*j;break;case"YXZ":this._x=T*f*y+u*B*j,this._y=u*B*y-T*f*j,this._z=u*f*j-T*B*y,this._w=u*f*y+T*B*j;break;case"ZXY":this._x=T*f*y-u*B*j,this._y=u*B*y+T*f*j,this._z=u*f*j+T*B*y,this._w=u*f*y-T*B*j;break;case"ZYX":this._x=T*f*y-u*B*j,this._y=u*B*y+T*f*j,this._z=u*f*j-T*B*y,this._w=u*f*y+T*B*j;break;case"YZX":this._x=T*f*y+u*B*j,this._y=u*B*y+T*f*j,this._z=u*f*j-T*B*y,this._w=u*f*y-T*B*j;break;case"XZY":this._x=T*f*y-u*B*j,this._y=u*B*y-T*f*j,this._z=u*f*j+T*B*y,this._w=u*f*y+T*B*j;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],l=t[5],h=t[9],u=t[2],f=t[6],y=t[10],T=i+l+y;if(T>0){const B=.5/Math.sqrt(T+1);this._w=.25/B,this._x=(f-h)*B,this._y=(s-u)*B,this._z=(o-r)*B}else if(i>l&&i>y){const B=2*Math.sqrt(1+i-l-y);this._w=(f-h)/B,this._x=.25*B,this._y=(r+o)/B,this._z=(s+u)/B}else if(l>y){const B=2*Math.sqrt(1+l-i-y);this._w=(s-u)/B,this._x=(r+o)/B,this._y=.25*B,this._z=(h+f)/B}else{const B=2*Math.sqrt(1+y-i-l);this._w=(o-r)/B,this._x=(s+u)/B,this._y=(h+f)/B,this._z=.25*B}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(xh(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,l=t._x,h=t._y,u=t._z,f=t._w;return this._x=i*f+o*l+r*u-s*h,this._y=r*f+o*h+s*l-i*u,this._z=s*f+o*u+i*h-r*l,this._w=o*f-i*l-r*h-s*u,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let l=o*e._w+i*e._x+r*e._y+s*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const h=1-l*l;if(h<=Number.EPSILON){const B=1-t;return this._w=B*o+t*this._w,this._x=B*i+t*this._x,this._y=B*r+t*this._y,this._z=B*s+t*this._z,this.normalize(),this}const u=Math.sqrt(h),f=Math.atan2(u,l),y=Math.sin((1-t)*f)/u,T=Math.sin(t*f)/u;return this._w=o*y+this._w*T,this._x=i*y+this._x*T,this._y=r*y+this._y*T,this._z=s*y+this._z*T,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Dt{constructor(e=0,t=0,i=0){Dt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Tq.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Tq.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,l=e.z,h=e.w,u=2*(o*r-l*i),f=2*(l*t-s*r),y=2*(s*i-o*t);return this.x=t+h*u+o*y-l*f,this.y=i+h*f+l*u-s*y,this.z=r+h*y+s*f-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,l=t.y,h=t.z;return this.x=r*h-s*l,this.y=s*o-i*h,this.z=i*l-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return XO.copy(this).projectOnVector(e),this.sub(XO)}reflect(e){return this.sub(XO.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(xh(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const XO=new Dt,Tq=new zc;class Gf{constructor(e=new Dt(1/0,1/0,1/0),t=new Dt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Bg.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Bg.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Bg.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i){const s=i.getAttribute("position");if(!0===t&&void 0!==s&&!0!==e.isInstancedMesh)for(let o=0,l=s.count;o<l;o++)!0===e.isMesh?e.getVertexPosition(o,Bg):Bg.fromBufferAttribute(s,o),Bg.applyMatrix4(e.matrixWorld),this.expandByPoint(Bg);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),a4.copy(e.boundingBox)):(null===i.boundingBox&&i.computeBoundingBox(),a4.copy(i.boundingBox)),a4.applyMatrix4(e.matrixWorld),this.union(a4)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Bg),Bg.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(RS),l4.subVectors(this.max,RS),cC.subVectors(e.a,RS),hC.subVectors(e.b,RS),uC.subVectors(e.c,RS),W1.subVectors(hC,cC),$1.subVectors(uC,hC),$b.subVectors(cC,uC);let t=[0,-W1.z,W1.y,0,-$1.z,$1.y,0,-$b.z,$b.y,W1.z,0,-W1.x,$1.z,0,-$1.x,$b.z,0,-$b.x,-W1.y,W1.x,0,-$1.y,$1.x,0,-$b.y,$b.x,0];return!(!YO(t,cC,hC,uC,l4)||(t=[1,0,0,0,1,0,0,0,1],!YO(t,cC,hC,uC,l4)))&&(c4.crossVectors(W1,$1),t=[c4.x,c4.y,c4.z],YO(t,cC,hC,uC,l4))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Bg).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Bg).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Z_[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Z_[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Z_[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Z_[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Z_[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Z_[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Z_[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Z_[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Z_)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Z_=[new Dt,new Dt,new Dt,new Dt,new Dt,new Dt,new Dt,new Dt],Bg=new Dt,a4=new Gf,cC=new Dt,hC=new Dt,uC=new Dt,W1=new Dt,$1=new Dt,$b=new Dt,RS=new Dt,l4=new Dt,c4=new Dt,Xb=new Dt;function YO(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Xb.fromArray(n,s);const l=r.x*Math.abs(Xb.x)+r.y*Math.abs(Xb.y)+r.z*Math.abs(Xb.z),h=e.dot(Xb),u=t.dot(Xb),f=i.dot(Xb);if(Math.max(-Math.max(h,u,f),Math.min(h,u,f))>l)return!1}return!0}const ffe=new Gf,kS=new Dt,KO=new Dt;class sd{constructor(e=new Dt,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):ffe.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;kS.subVectors(e,this.center);const t=kS.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(kS,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(KO.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(kS.copy(e.center).add(KO)),this.expandByPoint(kS.copy(e.center).sub(KO))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const J_=new Dt,ZO=new Dt,h4=new Dt,X1=new Dt,JO=new Dt,u4=new Dt,e5=new Dt;class dC{constructor(e=new Dt,t=new Dt(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,J_)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=J_.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(J_.copy(this.origin).addScaledVector(this.direction,t),J_.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){ZO.copy(e).add(t).multiplyScalar(.5),h4.copy(t).sub(e).normalize(),X1.copy(this.origin).sub(ZO);const s=.5*e.distanceTo(t),o=-this.direction.dot(h4),l=X1.dot(this.direction),h=-X1.dot(h4),u=X1.lengthSq(),f=Math.abs(1-o*o);let y,T,B,j;if(f>0)if(y=o*h-l,T=o*l-h,j=s*f,y>=0)if(T>=-j)if(T<=j){const ne=1/f;y*=ne,T*=ne,B=y*(y+o*T+2*l)+T*(o*y+T+2*h)+u}else T=s,y=Math.max(0,-(o*T+l)),B=-y*y+T*(T+2*h)+u;else T=-s,y=Math.max(0,-(o*T+l)),B=-y*y+T*(T+2*h)+u;else T<=-j?(y=Math.max(0,-(-o*s+l)),T=y>0?-s:Math.min(Math.max(-s,-h),s),B=-y*y+T*(T+2*h)+u):T<=j?(y=0,T=Math.min(Math.max(-s,-h),s),B=T*(T+2*h)+u):(y=Math.max(0,-(o*s+l)),T=y>0?s:Math.min(Math.max(-s,-h),s),B=-y*y+T*(T+2*h)+u);else T=o>0?-s:s,y=Math.max(0,-(o*T+l)),B=-y*y+T*(T+2*h)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,y),r&&r.copy(ZO).addScaledVector(h4,T),B}intersectSphere(e,t){J_.subVectors(e.center,this.origin);const i=J_.dot(this.direction),r=J_.dot(J_)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),l=i-o,h=i+o;return h<0?null:this.at(l<0?h:l,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,l,h;const u=1/this.direction.x,f=1/this.direction.y,y=1/this.direction.z,T=this.origin;return u>=0?(i=(e.min.x-T.x)*u,r=(e.max.x-T.x)*u):(i=(e.max.x-T.x)*u,r=(e.min.x-T.x)*u),f>=0?(s=(e.min.y-T.y)*f,o=(e.max.y-T.y)*f):(s=(e.max.y-T.y)*f,o=(e.min.y-T.y)*f),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),y>=0?(l=(e.min.z-T.z)*y,h=(e.max.z-T.z)*y):(l=(e.max.z-T.z)*y,h=(e.min.z-T.z)*y),i>h||l>r)||((l>i||i!=i)&&(i=l),(h<r||r!=r)&&(r=h),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,J_)}intersectTriangle(e,t,i,r,s){JO.subVectors(t,e),u4.subVectors(i,e),e5.crossVectors(JO,u4);let l,o=this.direction.dot(e5);if(o>0){if(r)return null;l=1}else{if(!(o<0))return null;l=-1,o=-o}X1.subVectors(this.origin,e);const h=l*this.direction.dot(u4.crossVectors(X1,u4));if(h<0)return null;const u=l*this.direction.dot(JO.cross(X1));if(u<0||h+u>o)return null;const f=-l*X1.dot(e5);return f<0?null:this.at(f/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class go{constructor(e,t,i,r,s,o,l,h,u,f,y,T,B,j,ne,se){go.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,l,h,u,f,y,T,B,j,ne,se)}set(e,t,i,r,s,o,l,h,u,f,y,T,B,j,ne,se){const le=this.elements;return le[0]=e,le[4]=t,le[8]=i,le[12]=r,le[1]=s,le[5]=o,le[9]=l,le[13]=h,le[2]=u,le[6]=f,le[10]=y,le[14]=T,le[3]=B,le[7]=j,le[11]=ne,le[15]=se,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new go).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/fC.setFromMatrixColumn(e,0).length(),s=1/fC.setFromMatrixColumn(e,1).length(),o=1/fC.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),l=Math.sin(i),h=Math.cos(r),u=Math.sin(r),f=Math.cos(s),y=Math.sin(s);if("XYZ"===e.order){const T=o*f,B=o*y,j=l*f,ne=l*y;t[0]=h*f,t[4]=-h*y,t[8]=u,t[1]=B+j*u,t[5]=T-ne*u,t[9]=-l*h,t[2]=ne-T*u,t[6]=j+B*u,t[10]=o*h}else if("YXZ"===e.order){const T=h*f,B=h*y,j=u*f,ne=u*y;t[0]=T+ne*l,t[4]=j*l-B,t[8]=o*u,t[1]=o*y,t[5]=o*f,t[9]=-l,t[2]=B*l-j,t[6]=ne+T*l,t[10]=o*h}else if("ZXY"===e.order){const T=h*f,B=h*y,j=u*f,ne=u*y;t[0]=T-ne*l,t[4]=-o*y,t[8]=j+B*l,t[1]=B+j*l,t[5]=o*f,t[9]=ne-T*l,t[2]=-o*u,t[6]=l,t[10]=o*h}else if("ZYX"===e.order){const T=o*f,B=o*y,j=l*f,ne=l*y;t[0]=h*f,t[4]=j*u-B,t[8]=T*u+ne,t[1]=h*y,t[5]=ne*u+T,t[9]=B*u-j,t[2]=-u,t[6]=l*h,t[10]=o*h}else if("YZX"===e.order){const T=o*h,B=o*u,j=l*h,ne=l*u;t[0]=h*f,t[4]=ne-T*y,t[8]=j*y+B,t[1]=y,t[5]=o*f,t[9]=-l*f,t[2]=-u*f,t[6]=B*y+j,t[10]=T-ne*y}else if("XZY"===e.order){const T=o*h,B=o*u,j=l*h,ne=l*u;t[0]=h*f,t[4]=-y,t[8]=u*f,t[1]=T*y+ne,t[5]=o*f,t[9]=B*y-j,t[2]=j*y-B,t[6]=l*f,t[10]=ne*y+T}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(pfe,e,mfe)}lookAt(e,t,i){const r=this.elements;return bm.subVectors(e,t),0===bm.lengthSq()&&(bm.z=1),bm.normalize(),Y1.crossVectors(i,bm),0===Y1.lengthSq()&&(1===Math.abs(i.z)?bm.x+=1e-4:bm.z+=1e-4,bm.normalize(),Y1.crossVectors(i,bm)),Y1.normalize(),d4.crossVectors(bm,Y1),r[0]=Y1.x,r[4]=d4.x,r[8]=bm.x,r[1]=Y1.y,r[5]=d4.y,r[9]=bm.y,r[2]=Y1.z,r[6]=d4.z,r[10]=bm.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],l=i[4],h=i[8],u=i[12],f=i[1],y=i[5],T=i[9],B=i[13],j=i[2],ne=i[6],se=i[10],le=i[14],Ee=i[3],Pe=i[7],Ve=i[11],Ft=i[15],Ct=r[0],Lt=r[4],Kt=r[8],Bt=r[12],St=r[1],Dn=r[5],ti=r[9],ci=r[13],vi=r[2],bi=r[6],Un=r[10],_i=r[14],si=r[3],ir=r[7],Nr=r[11],Wr=r[15];return s[0]=o*Ct+l*St+h*vi+u*si,s[4]=o*Lt+l*Dn+h*bi+u*ir,s[8]=o*Kt+l*ti+h*Un+u*Nr,s[12]=o*Bt+l*ci+h*_i+u*Wr,s[1]=f*Ct+y*St+T*vi+B*si,s[5]=f*Lt+y*Dn+T*bi+B*ir,s[9]=f*Kt+y*ti+T*Un+B*Nr,s[13]=f*Bt+y*ci+T*_i+B*Wr,s[2]=j*Ct+ne*St+se*vi+le*si,s[6]=j*Lt+ne*Dn+se*bi+le*ir,s[10]=j*Kt+ne*ti+se*Un+le*Nr,s[14]=j*Bt+ne*ci+se*_i+le*Wr,s[3]=Ee*Ct+Pe*St+Ve*vi+Ft*si,s[7]=Ee*Lt+Pe*Dn+Ve*bi+Ft*ir,s[11]=Ee*Kt+Pe*ti+Ve*Un+Ft*Nr,s[15]=Ee*Bt+Pe*ci+Ve*_i+Ft*Wr,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],l=e[5],h=e[9],u=e[13],f=e[2],y=e[6],T=e[10],B=e[14];return e[3]*(+s*h*y-r*u*y-s*l*T+i*u*T+r*l*B-i*h*B)+e[7]*(+t*h*B-t*u*T+s*o*T-r*o*B+r*u*f-s*h*f)+e[11]*(+t*u*y-t*l*B-s*o*y+i*o*B+s*l*f-i*u*f)+e[15]*(-r*l*f-t*h*y+t*l*T+r*o*y-i*o*T+i*h*f)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],l=e[5],h=e[6],u=e[7],f=e[8],y=e[9],T=e[10],B=e[11],j=e[12],ne=e[13],se=e[14],le=e[15],Ee=y*se*u-ne*T*u+ne*h*B-l*se*B-y*h*le+l*T*le,Pe=j*T*u-f*se*u-j*h*B+o*se*B+f*h*le-o*T*le,Ve=f*ne*u-j*y*u+j*l*B-o*ne*B-f*l*le+o*y*le,Ft=j*y*h-f*ne*h-j*l*T+o*ne*T+f*l*se-o*y*se,Ct=t*Ee+i*Pe+r*Ve+s*Ft;if(0===Ct)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Lt=1/Ct;return e[0]=Ee*Lt,e[1]=(ne*T*s-y*se*s-ne*r*B+i*se*B+y*r*le-i*T*le)*Lt,e[2]=(l*se*s-ne*h*s+ne*r*u-i*se*u-l*r*le+i*h*le)*Lt,e[3]=(y*h*s-l*T*s-y*r*u+i*T*u+l*r*B-i*h*B)*Lt,e[4]=Pe*Lt,e[5]=(f*se*s-j*T*s+j*r*B-t*se*B-f*r*le+t*T*le)*Lt,e[6]=(j*h*s-o*se*s-j*r*u+t*se*u+o*r*le-t*h*le)*Lt,e[7]=(o*T*s-f*h*s+f*r*u-t*T*u-o*r*B+t*h*B)*Lt,e[8]=Ve*Lt,e[9]=(j*y*s-f*ne*s-j*i*B+t*ne*B+f*i*le-t*y*le)*Lt,e[10]=(o*ne*s-j*l*s+j*i*u-t*ne*u-o*i*le+t*l*le)*Lt,e[11]=(f*l*s-o*y*s-f*i*u+t*y*u+o*i*B-t*l*B)*Lt,e[12]=Ft*Lt,e[13]=(f*ne*r-j*y*r+j*i*T-t*ne*T-f*i*se+t*y*se)*Lt,e[14]=(j*l*r-o*ne*r-j*i*h+t*ne*h+o*i*se-t*l*se)*Lt,e[15]=(o*y*r-f*l*r+f*i*h-t*y*h-o*i*T+t*l*T)*Lt,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,l=e.y,h=e.z,u=s*o,f=s*l;return this.set(u*o+i,u*l-r*h,u*h+r*l,0,u*l+r*h,f*l+i,f*h-r*o,0,u*h-r*l,f*h+r*o,s*h*h+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,l=t._z,h=t._w,u=s+s,f=o+o,y=l+l,T=s*u,B=s*f,j=s*y,ne=o*f,se=o*y,le=l*y,Ee=h*u,Pe=h*f,Ve=h*y,Ft=i.x,Ct=i.y,Lt=i.z;return r[0]=(1-(ne+le))*Ft,r[1]=(B+Ve)*Ft,r[2]=(j-Pe)*Ft,r[3]=0,r[4]=(B-Ve)*Ct,r[5]=(1-(T+le))*Ct,r[6]=(se+Ee)*Ct,r[7]=0,r[8]=(j+Pe)*Lt,r[9]=(se-Ee)*Lt,r[10]=(1-(T+ne))*Lt,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=fC.set(r[0],r[1],r[2]).length();const o=fC.set(r[4],r[5],r[6]).length(),l=fC.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Pg.copy(this);const u=1/s,f=1/o,y=1/l;return Pg.elements[0]*=u,Pg.elements[1]*=u,Pg.elements[2]*=u,Pg.elements[4]*=f,Pg.elements[5]*=f,Pg.elements[6]*=f,Pg.elements[8]*=y,Pg.elements[9]*=y,Pg.elements[10]*=y,t.setFromRotationMatrix(Pg),i.x=s,i.y=o,i.z=l,this}makePerspective(e,t,i,r,s,o,l=Y_){const h=this.elements,u=2*s/(t-e),f=2*s/(i-r),y=(t+e)/(t-e),T=(i+r)/(i-r);let B,j;if(l===Y_)B=-(o+s)/(o-s),j=-2*o*s/(o-s);else{if(2001!==l)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);B=-o/(o-s),j=-o*s/(o-s)}return h[0]=u,h[4]=0,h[8]=y,h[12]=0,h[1]=0,h[5]=f,h[9]=T,h[13]=0,h[2]=0,h[6]=0,h[10]=B,h[14]=j,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,i,r,s,o,l=Y_){const h=this.elements,u=1/(t-e),f=1/(i-r),y=1/(o-s),T=(t+e)*u,B=(i+r)*f;let j,ne;if(l===Y_)j=(o+s)*y,ne=-2*y;else{if(2001!==l)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);j=s*y,ne=-1*y}return h[0]=2*u,h[4]=0,h[8]=0,h[12]=-T,h[1]=0,h[5]=2*f,h[9]=0,h[13]=-B,h[2]=0,h[6]=0,h[10]=ne,h[14]=-j,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const fC=new Dt,Pg=new go,pfe=new Dt(0,0,0),mfe=new Dt(1,1,1),Y1=new Dt,d4=new Dt,bm=new Dt,Dq=new go,Iq=new zc;let B0=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],l=s[4],h=s[8],u=s[1],f=s[5],y=s[9],T=s[2],B=s[6],j=s[10];switch(i){case"XYZ":this._y=Math.asin(xh(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-y,j),this._z=Math.atan2(-l,o)):(this._x=Math.atan2(B,f),this._z=0);break;case"YXZ":this._x=Math.asin(-xh(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(h,j),this._z=Math.atan2(u,f)):(this._y=Math.atan2(-T,o),this._z=0);break;case"ZXY":this._x=Math.asin(xh(B,-1,1)),Math.abs(B)<.9999999?(this._y=Math.atan2(-T,j),this._z=Math.atan2(-l,f)):(this._y=0,this._z=Math.atan2(u,o));break;case"ZYX":this._y=Math.asin(-xh(T,-1,1)),Math.abs(T)<.9999999?(this._x=Math.atan2(B,j),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-l,f));break;case"YZX":this._z=Math.asin(xh(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-y,f),this._y=Math.atan2(-T,o)):(this._x=0,this._y=Math.atan2(h,j));break;case"XZY":this._z=Math.asin(-xh(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(B,f),this._y=Math.atan2(h,o)):(this._x=Math.atan2(-y,j),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return Dq.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Dq,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return Iq.setFromEuler(this),this.setFromQuaternion(Iq,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class t5{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return!!(this.mask&e.mask)}isEnabled(e){return!!(this.mask&1<<e)}}let Afe=0;const Bq=new Dt,pC=new zc,ey=new go,f4=new Dt,FS=new Dt,gfe=new Dt,_fe=new zc,Pq=new Dt(1,0,0),Rq=new Dt(0,1,0),kq=new Dt(0,0,1),Fq={type:"added"},yfe={type:"removed"},mC={type:"childadded",child:null},n5={type:"childremoved",child:null};let Wa=(()=>{class n extends K_{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Afe++}),this.uuid=vm(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new Dt,i=new B0,r=new zc,s=new Dt(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function l(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new go},normalMatrix:{value:new xa}}),this.matrix=new go,this.matrixWorld=new go,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new t5,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return pC.setFromAxisAngle(t,i),this.quaternion.multiply(pC),this}rotateOnWorldAxis(t,i){return pC.setFromAxisAngle(t,i),this.quaternion.premultiply(pC),this}rotateX(t){return this.rotateOnAxis(Pq,t)}rotateY(t){return this.rotateOnAxis(Rq,t)}rotateZ(t){return this.rotateOnAxis(kq,t)}translateOnAxis(t,i){return Bq.copy(t).applyQuaternion(this.quaternion),this.position.add(Bq.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(Pq,t)}translateY(t){return this.translateOnAxis(Rq,t)}translateZ(t){return this.translateOnAxis(kq,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(ey.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?f4.copy(t):f4.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),FS.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ey.lookAt(FS,f4,this.up):ey.lookAt(f4,FS,this.up),this.quaternion.setFromRotationMatrix(ey),s&&(ey.extractRotation(s.matrixWorld),pC.setFromRotationMatrix(ey),this.quaternion.premultiply(pC.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(Fq),mC.child=t,this.dispatchEvent(mC),mC.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(yfe),n5.child=t,this.dispatchEvent(n5),n5.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),ey.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),ey.multiply(t.parent.matrixWorld)),t.applyMatrix4(ey),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(Fq),mC.child=t,this.dispatchEvent(mC),mC.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const l=this.children[r].getObjectByProperty(t,i);if(void 0!==l)return l}}getObjectsByProperty(t,i,r=[]){this[t]===i&&r.push(this);const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].getObjectsByProperty(t,i,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(FS,t,gfe),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(FS,_fe,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].updateMatrixWorld(t)}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===i){const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function o(h,u){return void 0===h[u.uuid]&&(h[u.uuid]=u.toJSON(t)),u.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(h=>({boxInitialized:h.boxInitialized,boxMin:h.box.min.toArray(),boxMax:h.box.max.toArray(),sphereInitialized:h.sphereInitialized,sphereRadius:h.sphere.radius,sphereCenter:h.sphere.center.toArray()})),s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(t),null!==this._colorsTexture&&(s.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),null!==this.boundingBox&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const h=this.geometry.parameters;if(void 0!==h&&void 0!==h.shapes){const u=h.shapes;if(Array.isArray(u))for(let f=0,y=u.length;f<y;f++)o(t.shapes,u[f]);else o(t.shapes,u)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const h=[];for(let u=0,f=this.material.length;u<f;u++)h.push(o(t.materials,this.material[u]));s.material=h}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let h=0;h<this.children.length;h++)s.children.push(this.children[h].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let h=0;h<this.animations.length;h++)s.animations.push(o(t.animations,this.animations[h]))}if(i){const h=l(t.geometries),u=l(t.materials),f=l(t.textures),y=l(t.images),T=l(t.shapes),B=l(t.skeletons),j=l(t.animations),ne=l(t.nodes);h.length>0&&(r.geometries=h),u.length>0&&(r.materials=u),f.length>0&&(r.textures=f),y.length>0&&(r.images=y),T.length>0&&(r.shapes=T),B.length>0&&(r.skeletons=B),j.length>0&&(r.animations=j),ne.length>0&&(r.nodes=ne)}return r.object=s,r;function l(h){const u=[];for(const f in h){const y=h[f];delete y.metadata,u.push(y)}return u}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new Dt(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const Rg=new Dt,ty=new Dt,r5=new Dt,ny=new Dt,AC=new Dt,gC=new Dt,Oq=new Dt,s5=new Dt,o5=new Dt,a5=new Dt;class xm{constructor(e=new Dt,t=new Dt,i=new Dt){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Rg.subVectors(e,t),r.cross(Rg);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Rg.subVectors(r,t),ty.subVectors(i,t),r5.subVectors(e,t);const o=Rg.dot(Rg),l=Rg.dot(ty),h=Rg.dot(r5),u=ty.dot(ty),f=ty.dot(r5),y=o*u-l*l;if(0===y)return s.set(0,0,0),null;const T=1/y,B=(u*h-l*f)*T,j=(o*f-l*h)*T;return s.set(1-B-j,j,B)}static containsPoint(e,t,i,r){return null!==this.getBarycoord(e,t,i,r,ny)&&ny.x>=0&&ny.y>=0&&ny.x+ny.y<=1}static getInterpolation(e,t,i,r,s,o,l,h){return null===this.getBarycoord(e,t,i,r,ny)?(h.x=0,h.y=0,"z"in h&&(h.z=0),"w"in h&&(h.w=0),null):(h.setScalar(0),h.addScaledVector(s,ny.x),h.addScaledVector(o,ny.y),h.addScaledVector(l,ny.z),h)}static isFrontFacing(e,t,i,r){return Rg.subVectors(i,t),ty.subVectors(e,t),Rg.cross(ty).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Rg.subVectors(this.c,this.b),ty.subVectors(this.a,this.b),.5*Rg.cross(ty).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return xm.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return xm.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,s){return xm.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return xm.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return xm.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,l;AC.subVectors(r,i),gC.subVectors(s,i),s5.subVectors(e,i);const h=AC.dot(s5),u=gC.dot(s5);if(h<=0&&u<=0)return t.copy(i);o5.subVectors(e,r);const f=AC.dot(o5),y=gC.dot(o5);if(f>=0&&y<=f)return t.copy(r);const T=h*y-f*u;if(T<=0&&h>=0&&f<=0)return o=h/(h-f),t.copy(i).addScaledVector(AC,o);a5.subVectors(e,s);const B=AC.dot(a5),j=gC.dot(a5);if(j>=0&&B<=j)return t.copy(s);const ne=B*u-h*j;if(ne<=0&&u>=0&&j<=0)return l=u/(u-j),t.copy(i).addScaledVector(gC,l);const se=f*j-B*y;if(se<=0&&y-f>=0&&B-j>=0)return Oq.subVectors(s,r),l=(y-f)/(y-f+(B-j)),t.copy(r).addScaledVector(Oq,l);const le=1/(se+ne+T);return o=ne*le,l=T*le,t.copy(i).addScaledVector(AC,o).addScaledVector(gC,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Lq={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},K1={h:0,s:0,l:0},p4={h:0,s:0,l:0};function l5(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class nr{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=hu){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,pl.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=pl.workingColorSpace){return this.r=e,this.g=t,this.b=i,pl.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=pl.workingColorSpace){if(e=qO(e,1),t=xh(t,0,1),i=xh(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=l5(o,s,e+1/3),this.g=l5(o,s,e),this.b=l5(o,s,e-1/3)}return pl.toWorkingColorSpace(this,r),this}setStyle(e,t=hu){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const l=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=hu){const i=Lq[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=aC(e.r),this.g=aC(e.g),this.b=aC(e.b),this}copyLinearToSRGB(e){return this.r=jO(e.r),this.g=jO(e.g),this.b=jO(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=hu){return pl.fromWorkingColorSpace(Kd.copy(this),e),65536*Math.round(xh(255*Kd.r,0,255))+256*Math.round(xh(255*Kd.g,0,255))+Math.round(xh(255*Kd.b,0,255))}getHexString(e=hu){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=pl.workingColorSpace){pl.fromWorkingColorSpace(Kd.copy(this),t);const i=Kd.r,r=Kd.g,s=Kd.b,o=Math.max(i,r,s),l=Math.min(i,r,s);let h,u;const f=(l+o)/2;if(l===o)h=0,u=0;else{const y=o-l;switch(u=f<=.5?y/(o+l):y/(2-o-l),o){case i:h=(r-s)/y+(r<s?6:0);break;case r:h=(s-i)/y+2;break;case s:h=(i-r)/y+4}h/=6}return e.h=h,e.s=u,e.l=f,e}getRGB(e,t=pl.workingColorSpace){return pl.fromWorkingColorSpace(Kd.copy(this),t),e.r=Kd.r,e.g=Kd.g,e.b=Kd.b,e}getStyle(e=hu){pl.fromWorkingColorSpace(Kd.copy(this),e);const t=Kd.r,i=Kd.g,r=Kd.b;return e!==hu?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(K1),this.setHSL(K1.h+e,K1.s+t,K1.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(K1),e.getHSL(p4);const i=DS(K1.h,p4.h,t),r=DS(K1.s,p4.s,t),s=DS(K1.l,p4.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Kd=new nr;nr.NAMES=Lq;let vfe=0;class ch extends K_{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:vfe++}),this.uuid=vm(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new nr(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=iC,this.stencilZFail=iC,this.stencilZPass=iC,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const l in s){const h=s[l];delete h.metadata,o.push(h)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(i.dispersion=this.dispersion),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapRotation&&(i.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),204!==this.blendSrc&&(i.blendSrc=this.blendSrc),205!==this.blendDst&&(i.blendDst=this.blendDst),100!==this.blendEquation&&(i.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(i.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(i.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(i.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(i.depthFunc=this.depthFunc),!1===this.depthTest&&(i.depthTest=this.depthTest),!1===this.depthWrite&&(i.depthWrite=this.depthWrite),!1===this.colorWrite&&(i.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(i.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(i.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(i.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==iC&&(i.stencilFail=this.stencilFail),this.stencilZFail!==iC&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==iC&&(i.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(i.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class wh extends ch{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new nr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new B0,this.combine=GI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const uu=new Dt,m4=new Fi;class To{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=ym,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return oC("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)m4.fromBufferAttribute(this,t),m4.applyMatrix3(e),this.setXY(t,m4.x,m4.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)uu.fromBufferAttribute(this,t),uu.applyMatrix3(e),this.setXYZ(t,uu.x,uu.y,uu.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)uu.fromBufferAttribute(this,t),uu.applyMatrix4(e),this.setXYZ(t,uu.x,uu.y,uu.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)uu.fromBufferAttribute(this,t),uu.applyNormalMatrix(e),this.setXYZ(t,uu.x,uu.y,uu.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)uu.fromBufferAttribute(this,t),uu.transformDirection(e),this.setXYZ(t,uu.x,uu.y,uu.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Vf(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=ba(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Vf(t,this.array)),t}setX(e,t){return this.normalized&&(t=ba(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Vf(t,this.array)),t}setY(e,t){return this.normalized&&(t=ba(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Vf(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ba(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Vf(t,this.array)),t}setW(e,t){return this.normalized&&(t=ba(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=ba(t,this.array),i=ba(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=ba(t,this.array),i=ba(i,this.array),r=ba(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=ba(t,this.array),i=ba(i,this.array),r=ba(r,this.array),s=ba(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}}class Nq extends To{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class Uq extends To{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Bs extends To{constructor(e,t,i){super(new Float32Array(e),t,i)}}let xfe=0;const CA=new go,c5=new Wa,_C=new Dt,wm=new Gf,LS=new Gf,od=new Dt;class Hs extends K_{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:xfe++}),this.uuid=vm(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(wq(e)?Uq:Nq)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new xa).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return CA.makeRotationFromQuaternion(e),this.applyMatrix4(CA),this}rotateX(e){return CA.makeRotationX(e),this.applyMatrix4(CA),this}rotateY(e){return CA.makeRotationY(e),this.applyMatrix4(CA),this}rotateZ(e){return CA.makeRotationZ(e),this.applyMatrix4(CA),this}translate(e,t,i){return CA.makeTranslation(e,t,i),this.applyMatrix4(CA),this}scale(e,t,i){return CA.makeScale(e,t,i),this.applyMatrix4(CA),this}lookAt(e){return c5.lookAt(e),c5.updateMatrix(),this.applyMatrix4(c5.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_C).negate(),this.translate(_C.x,_C.y,_C.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Bs(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Gf);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new Dt(-1/0,-1/0,-1/0),new Dt(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)wm.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(od.addVectors(this.boundingBox.min,wm.min),this.boundingBox.expandByPoint(od),od.addVectors(this.boundingBox.max,wm.max),this.boundingBox.expandByPoint(od)):(this.boundingBox.expandByPoint(wm.min),this.boundingBox.expandByPoint(wm.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new sd);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new Dt,1/0);if(e){const i=this.boundingSphere.center;if(wm.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)LS.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(od.addVectors(wm.min,LS.min),wm.expandByPoint(od),od.addVectors(wm.max,LS.max),wm.expandByPoint(od)):(wm.expandByPoint(LS.min),wm.expandByPoint(LS.max));wm.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)od.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(od));if(t)for(let s=0,o=t.length;s<o;s++){const l=t[s],h=this.morphTargetsRelative;for(let u=0,f=l.count;u<f;u++)od.fromBufferAttribute(l,u),h&&(_C.fromBufferAttribute(e,u),od.add(_C)),r=Math.max(r,i.distanceToSquared(od))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=t.position,r=t.normal,s=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new To(new Float32Array(4*i.count),4));const o=this.getAttribute("tangent"),l=[],h=[];for(let Kt=0;Kt<i.count;Kt++)l[Kt]=new Dt,h[Kt]=new Dt;const u=new Dt,f=new Dt,y=new Dt,T=new Fi,B=new Fi,j=new Fi,ne=new Dt,se=new Dt;function le(Kt,Bt,St){u.fromBufferAttribute(i,Kt),f.fromBufferAttribute(i,Bt),y.fromBufferAttribute(i,St),T.fromBufferAttribute(s,Kt),B.fromBufferAttribute(s,Bt),j.fromBufferAttribute(s,St),f.sub(u),y.sub(u),B.sub(T),j.sub(T);const Dn=1/(B.x*j.y-j.x*B.y);isFinite(Dn)&&(ne.copy(f).multiplyScalar(j.y).addScaledVector(y,-B.y).multiplyScalar(Dn),se.copy(y).multiplyScalar(B.x).addScaledVector(f,-j.x).multiplyScalar(Dn),l[Kt].add(ne),l[Bt].add(ne),l[St].add(ne),h[Kt].add(se),h[Bt].add(se),h[St].add(se))}let Ee=this.groups;0===Ee.length&&(Ee=[{start:0,count:e.count}]);for(let Kt=0,Bt=Ee.length;Kt<Bt;++Kt){const St=Ee[Kt],Dn=St.start;for(let ci=Dn,vi=Dn+St.count;ci<vi;ci+=3)le(e.getX(ci+0),e.getX(ci+1),e.getX(ci+2))}const Pe=new Dt,Ve=new Dt,Ft=new Dt,Ct=new Dt;function Lt(Kt){Ft.fromBufferAttribute(r,Kt),Ct.copy(Ft);const Bt=l[Kt];Pe.copy(Bt),Pe.sub(Ft.multiplyScalar(Ft.dot(Bt))).normalize(),Ve.crossVectors(Ct,Bt);const Dn=Ve.dot(h[Kt])<0?-1:1;o.setXYZW(Kt,Pe.x,Pe.y,Pe.z,Dn)}for(let Kt=0,Bt=Ee.length;Kt<Bt;++Kt){const St=Ee[Kt],Dn=St.start;for(let ci=Dn,vi=Dn+St.count;ci<vi;ci+=3)Lt(e.getX(ci+0)),Lt(e.getX(ci+1)),Lt(e.getX(ci+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new To(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let T=0,B=i.count;T<B;T++)i.setXYZ(T,0,0,0);const r=new Dt,s=new Dt,o=new Dt,l=new Dt,h=new Dt,u=new Dt,f=new Dt,y=new Dt;if(e)for(let T=0,B=e.count;T<B;T+=3){const j=e.getX(T+0),ne=e.getX(T+1),se=e.getX(T+2);r.fromBufferAttribute(t,j),s.fromBufferAttribute(t,ne),o.fromBufferAttribute(t,se),f.subVectors(o,s),y.subVectors(r,s),f.cross(y),l.fromBufferAttribute(i,j),h.fromBufferAttribute(i,ne),u.fromBufferAttribute(i,se),l.add(f),h.add(f),u.add(f),i.setXYZ(j,l.x,l.y,l.z),i.setXYZ(ne,h.x,h.y,h.z),i.setXYZ(se,u.x,u.y,u.z)}else for(let T=0,B=t.count;T<B;T+=3)r.fromBufferAttribute(t,T+0),s.fromBufferAttribute(t,T+1),o.fromBufferAttribute(t,T+2),f.subVectors(o,s),y.subVectors(r,s),f.cross(y),i.setXYZ(T+0,f.x,f.y,f.z),i.setXYZ(T+1,f.x,f.y,f.z),i.setXYZ(T+2,f.x,f.y,f.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)od.fromBufferAttribute(e,t),od.normalize(),e.setXYZ(t,od.x,od.y,od.z)}toNonIndexed(){function e(l,h){const u=l.array,f=l.itemSize,y=l.normalized,T=new u.constructor(h.length*f);let B=0,j=0;for(let ne=0,se=h.length;ne<se;ne++){B=l.isInterleavedBufferAttribute?h[ne]*l.data.stride+l.offset:h[ne]*f;for(let le=0;le<f;le++)T[j++]=u[B++]}return new To(T,f,y)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Hs,i=this.index.array,r=this.attributes;for(const l in r){const u=e(r[l],i);t.setAttribute(l,u)}const s=this.morphAttributes;for(const l in s){const h=[],u=s[l];for(let f=0,y=u.length;f<y;f++){const B=e(u[f],i);h.push(B)}t.morphAttributes[l]=h}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let l=0,h=o.length;l<h;l++){const u=o[l];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const h=this.parameters;for(const u in h)void 0!==h[u]&&(e[u]=h[u]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const h in i)e.data.attributes[h]=i[h].toJSON(e.data);const r={};let s=!1;for(const h in this.morphAttributes){const u=this.morphAttributes[h],f=[];for(let y=0,T=u.length;y<T;y++)f.push(u[y].toJSON(e.data));f.length>0&&(r[h]=f,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const l=this.boundingSphere;return null!==l&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const u in r)this.setAttribute(u,r[u].clone(t));const s=e.morphAttributes;for(const u in s){const f=[],y=s[u];for(let T=0,B=y.length;T<B;T++)f.push(y[T].clone(t));this.morphAttributes[u]=f}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,f=o.length;u<f;u++){const y=o[u];this.addGroup(y.start,y.count,y.materialIndex)}const l=e.boundingBox;null!==l&&(this.boundingBox=l.clone());const h=e.boundingSphere;return null!==h&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const zq=new go,Yb=new dC,A4=new sd,Hq=new Dt,yC=new Dt,vC=new Dt,bC=new Dt,h5=new Dt,g4=new Dt,_4=new Fi,y4=new Fi,v4=new Fi,Vq=new Dt,Gq=new Dt,qq=new Dt,b4=new Dt,x4=new Dt;class jo extends Wa{constructor(e=new Hs,t=new wh){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const l=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const l=this.morphTargetInfluences;if(s&&l){g4.set(0,0,0);for(let h=0,u=s.length;h<u;h++){const f=l[h];0!==f&&(h5.fromBufferAttribute(s[h],e),g4.addScaledVector(o?h5:h5.sub(t),f))}t.add(g4)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),A4.copy(i.boundingSphere),A4.applyMatrix4(s),Yb.copy(e.ray).recast(e.near),(!1!==A4.containsPoint(Yb.origin)||!(null===Yb.intersectSphere(A4,Hq)||Yb.origin.distanceToSquared(Hq)>(e.far-e.near)**2))&&(zq.copy(s).invert(),Yb.copy(e.ray).applyMatrix4(zq),(null===i.boundingBox||!1!==Yb.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,Yb)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,l=s.index,h=s.attributes.position,u=s.attributes.uv,f=s.attributes.uv1,y=s.attributes.normal,T=s.groups,B=s.drawRange;if(null!==l)if(Array.isArray(o))for(let j=0,ne=T.length;j<ne;j++){const se=T[j],le=o[se.materialIndex];for(let Ve=Math.max(se.start,B.start),Ft=Math.min(l.count,Math.min(se.start+se.count,B.start+B.count));Ve<Ft;Ve+=3)r=w4(this,le,e,i,u,f,y,l.getX(Ve),l.getX(Ve+1),l.getX(Ve+2)),r&&(r.faceIndex=Math.floor(Ve/3),r.face.materialIndex=se.materialIndex,t.push(r))}else for(let se=Math.max(0,B.start),le=Math.min(l.count,B.start+B.count);se<le;se+=3)r=w4(this,o,e,i,u,f,y,l.getX(se),l.getX(se+1),l.getX(se+2)),r&&(r.faceIndex=Math.floor(se/3),t.push(r));else if(void 0!==h)if(Array.isArray(o))for(let j=0,ne=T.length;j<ne;j++){const se=T[j],le=o[se.materialIndex];for(let Ve=Math.max(se.start,B.start),Ft=Math.min(h.count,Math.min(se.start+se.count,B.start+B.count));Ve<Ft;Ve+=3)r=w4(this,le,e,i,u,f,y,Ve,Ve+1,Ve+2),r&&(r.faceIndex=Math.floor(Ve/3),r.face.materialIndex=se.materialIndex,t.push(r))}else for(let se=Math.max(0,B.start),le=Math.min(h.count,B.start+B.count);se<le;se+=3)r=w4(this,o,e,i,u,f,y,se,se+1,se+2),r&&(r.faceIndex=Math.floor(se/3),t.push(r))}}function w4(n,e,t,i,r,s,o,l,h,u){n.getVertexPosition(l,yC),n.getVertexPosition(h,vC),n.getVertexPosition(u,bC);const f=function wfe(n,e,t,i,r,s,o,l){let h;if(h=1===e.side?i.intersectTriangle(o,s,r,!0,l):i.intersectTriangle(r,s,o,0===e.side,l),null===h)return null;x4.copy(l),x4.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(x4);return u<t.near||u>t.far?null:{distance:u,point:x4.clone(),object:n}}(n,e,t,i,yC,vC,bC,b4);if(f){r&&(_4.fromBufferAttribute(r,l),y4.fromBufferAttribute(r,h),v4.fromBufferAttribute(r,u),f.uv=xm.getInterpolation(b4,yC,vC,bC,_4,y4,v4,new Fi)),s&&(_4.fromBufferAttribute(s,l),y4.fromBufferAttribute(s,h),v4.fromBufferAttribute(s,u),f.uv1=xm.getInterpolation(b4,yC,vC,bC,_4,y4,v4,new Fi)),o&&(Vq.fromBufferAttribute(o,l),Gq.fromBufferAttribute(o,h),qq.fromBufferAttribute(o,u),f.normal=xm.getInterpolation(b4,yC,vC,bC,Vq,Gq,qq,new Dt),f.normal.dot(i.direction)>0&&f.normal.multiplyScalar(-1));const y={a:l,b:h,c:u,normal:new Dt,materialIndex:0};xm.getNormal(yC,vC,bC,y.normal),f.face=y}return f}class Tp extends Hs{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const l=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const h=[],u=[],f=[],y=[];let T=0,B=0;function j(ne,se,le,Ee,Pe,Ve,Ft,Ct,Lt,Kt,Bt){const St=Ve/Lt,Dn=Ft/Kt,ti=Ve/2,ci=Ft/2,vi=Ct/2,bi=Lt+1,Un=Kt+1;let _i=0,si=0;const ir=new Dt;for(let Nr=0;Nr<Un;Nr++){const Wr=Nr*Dn-ci;for(let so=0;so<bi;so++)ir[ne]=(so*St-ti)*Ee,ir[se]=Wr*Pe,ir[le]=vi,u.push(ir.x,ir.y,ir.z),ir[ne]=0,ir[se]=0,ir[le]=Ct>0?1:-1,f.push(ir.x,ir.y,ir.z),y.push(so/Lt),y.push(1-Nr/Kt),_i+=1}for(let Nr=0;Nr<Kt;Nr++)for(let Wr=0;Wr<Lt;Wr++){const Po=T+Wr+bi*(Nr+1),Ci=T+(Wr+1)+bi*(Nr+1),yr=T+(Wr+1)+bi*Nr;h.push(T+Wr+bi*Nr,Po,yr),h.push(Po,Ci,yr),si+=6}l.addGroup(B,si,Bt),B+=si,T+=_i}j("z","y","x",-1,-1,i,t,e,o,s,0),j("z","y","x",1,-1,i,t,-e,o,s,1),j("x","z","y",1,1,e,i,t,r,o,2),j("x","z","y",1,-1,e,i,-t,r,o,3),j("x","y","z",1,-1,e,t,i,r,s,4),j("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(h),this.setAttribute("position",new Bs(u,3)),this.setAttribute("normal",new Bs(f,3)),this.setAttribute("uv",new Bs(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Tp(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function xC(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function qf(n){const e={};for(let t=0;t<n.length;t++){const i=xC(n[t]);for(const r in i)e[r]=i[r]}return e}function Qq(n){const e=n.getRenderTarget();return null===e?n.outputColorSpace:!0===e.isXRRenderTarget?e.texture.colorSpace:pl.workingColorSpace}const u5={clone:xC,merge:qf};class Ou extends ch{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=xC(e.uniforms),this.uniformsGroups=function Cfe(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class d5 extends Wa{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new go,this.projectionMatrix=new go,this.projectionMatrixInverse=new go,this.coordinateSystem=Y_}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Z1=new Dt,jq=new Fi,Wq=new Fi;class Lu extends d5{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*rC*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*jb*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*rC*Math.atan(Math.tan(.5*jb*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){Z1.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Z1.x,Z1.y).multiplyScalar(-e/Z1.z),Z1.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Z1.x,Z1.y).multiplyScalar(-e/Z1.z)}getViewSize(e,t){return this.getViewBounds(e,jq,Wq),t.subVectors(Wq,jq)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*jb*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const h=o.fullWidth,u=o.fullHeight;s+=o.offsetX*r/h,t-=o.offsetY*i/u,r*=o.width/h,i*=o.height/u}const l=this.filmOffset;0!==l&&(s+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class Sfe extends Wa{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Lu(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new Lu(-90,1,e,t);s.layers=this.layers,this.add(s);const o=new Lu(-90,1,e,t);o.layers=this.layers,this.add(o);const l=new Lu(-90,1,e,t);l.layers=this.layers,this.add(l);const h=new Lu(-90,1,e,t);h.layers=this.layers,this.add(h);const u=new Lu(-90,1,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,l,h]=t;for(const u of t)this.remove(u);if(e===Y_)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),h.up.set(0,1,0),h.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),h.up.set(0,-1,0),h.lookAt(0,0,-1)}for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,l,h,u,f]=this.children,y=e.getRenderTarget(),T=e.getActiveCubeFace(),B=e.getActiveMipmapLevel(),j=e.xr.enabled;e.xr.enabled=!1;const ne=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,l),e.setRenderTarget(i,3,r),e.render(t,h),e.setRenderTarget(i,4,r),e.render(t,u),i.texture.generateMipmaps=ne,e.setRenderTarget(i,5,r),e.render(t,f),e.setRenderTarget(y,T,B),e.xr.enabled=j,i.texture.needsPMREMUpdate=!0}}class C4 extends Yd{constructor(e,t,i,r,s,o,l,h,u,f){super(e=void 0!==e?e:[],t=void 0!==t?t:q1,i,r,s,o,l,h,u,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Tfe extends rd{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new C4([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:bh}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Tp(5,5,5),s=new Ou({name:"CubemapFromEquirect",uniforms:xC(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new jo(r,s),l=t.minFilter;return t.minFilter===xA&&(t.minFilter=bh),new Sfe(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const f5=new Dt,Dfe=new Dt,Ife=new xa;class MA{constructor(e=new Dt(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=f5.subVectors(i,t).cross(Dfe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(f5),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||Ife.getNormalMatrix(e),r=this.coplanarPoint(f5).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Kb=new sd,M4=new Dt;class E4{constructor(e=new MA,t=new MA,i=new MA,r=new MA,s=new MA,o=new MA){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(i),l[3].copy(r),l[4].copy(s),l[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Y_){const i=this.planes,r=e.elements,s=r[0],o=r[1],l=r[2],h=r[3],u=r[4],f=r[5],y=r[6],T=r[7],B=r[8],j=r[9],ne=r[10],se=r[11],le=r[12],Ee=r[13],Pe=r[14],Ve=r[15];if(i[0].setComponents(h-s,T-u,se-B,Ve-le).normalize(),i[1].setComponents(h+s,T+u,se+B,Ve+le).normalize(),i[2].setComponents(h+o,T+f,se+j,Ve+Ee).normalize(),i[3].setComponents(h-o,T-f,se-j,Ve-Ee).normalize(),i[4].setComponents(h-l,T-y,se-ne,Ve-Pe).normalize(),t===Y_)i[5].setComponents(h+l,T+y,se+ne,Ve+Pe).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(l,y,ne,Pe).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Kb.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Kb.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Kb)}intersectsSprite(e){return Kb.center.set(0,0,0),Kb.radius=.7071067811865476,Kb.applyMatrix4(e.matrixWorld),this.intersectsSphere(Kb)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(M4.x=r.normal.x>0?e.max.x:e.min.x,M4.y=r.normal.y>0?e.max.y:e.min.y,M4.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(M4)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function $q(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function Bfe(n){const e=new WeakMap;return{get:function r(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)},remove:function s(l){l.isInterleavedBufferAttribute&&(l=l.data);const h=e.get(l);h&&(n.deleteBuffer(h.buffer),e.delete(l))},update:function o(l,h){if(l.isInterleavedBufferAttribute&&(l=l.data),l.isGLBufferAttribute){const f=e.get(l);return void((!f||f.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version}))}const u=e.get(l);if(void 0===u)e.set(l,function t(l,h){const u=l.array,f=l.usage,y=u.byteLength,T=n.createBuffer();let B;if(n.bindBuffer(h,T),n.bufferData(h,u,f),l.onUploadCallback(),u instanceof Float32Array)B=n.FLOAT;else if(u instanceof Uint16Array)B=l.isFloat16BufferAttribute?n.HALF_FLOAT:n.UNSIGNED_SHORT;else if(u instanceof Int16Array)B=n.SHORT;else if(u instanceof Uint32Array)B=n.UNSIGNED_INT;else if(u instanceof Int32Array)B=n.INT;else if(u instanceof Int8Array)B=n.BYTE;else if(u instanceof Uint8Array)B=n.UNSIGNED_BYTE;else{if(!(u instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);B=n.UNSIGNED_BYTE}return{buffer:T,type:B,bytesPerElement:u.BYTES_PER_ELEMENT,version:l.version,size:y}}(l,h));else if(u.version<l.version){if(u.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");(function i(l,h,u){const f=h.array,y=h._updateRange,T=h.updateRanges;if(n.bindBuffer(u,l),-1===y.count&&0===T.length&&n.bufferSubData(u,0,f),0!==T.length){for(let B=0,j=T.length;B<j;B++){const ne=T[B];n.bufferSubData(u,ne.start*f.BYTES_PER_ELEMENT,f,ne.start,ne.count)}h.clearUpdateRanges()}-1!==y.count&&(n.bufferSubData(u,y.offset*f.BYTES_PER_ELEMENT,f,y.offset,y.count),y.count=-1),h.onUploadCallback()})(u.buffer,l,h),u.version=l.version}}}}class MC extends Hs{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,l=Math.floor(i),h=Math.floor(r),u=l+1,f=h+1,y=e/l,T=t/h,B=[],j=[],ne=[],se=[];for(let le=0;le<f;le++){const Ee=le*T-o;for(let Pe=0;Pe<u;Pe++)j.push(Pe*y-s,-Ee,0),ne.push(0,0,1),se.push(Pe/l),se.push(1-le/h)}for(let le=0;le<h;le++)for(let Ee=0;Ee<l;Ee++){const Ve=Ee+u*(le+1),Ft=Ee+1+u*(le+1),Ct=Ee+1+u*le;B.push(Ee+u*le,Ve,Ct),B.push(Ve,Ft,Ct)}this.setIndex(B),this.setAttribute("position",new Bs(j,3)),this.setAttribute("normal",new Bs(ne,3)),this.setAttribute("uv",new Bs(se,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new MC(e.width,e.height,e.widthSegments,e.heightSegments)}}const Oa={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t\n\t\t#else\n\t\t\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},ys={common:{diffuse:{value:new nr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new xa},alphaMap:{value:null},alphaMapTransform:{value:new xa},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new xa}},envmap:{envMap:{value:null},envMapRotation:{value:new xa},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new xa}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new xa}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new xa},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new xa},normalScale:{value:new Fi(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new xa},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new xa}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new xa}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new xa}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new nr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new nr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new xa},alphaTest:{value:0},uvTransform:{value:new xa}},sprite:{diffuse:{value:new nr(16777215)},opacity:{value:1},center:{value:new Fi(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new xa},alphaMap:{value:null},alphaMapTransform:{value:new xa},alphaTest:{value:0}}},P0={basic:{uniforms:qf([ys.common,ys.specularmap,ys.envmap,ys.aomap,ys.lightmap,ys.fog]),vertexShader:Oa.meshbasic_vert,fragmentShader:Oa.meshbasic_frag},lambert:{uniforms:qf([ys.common,ys.specularmap,ys.envmap,ys.aomap,ys.lightmap,ys.emissivemap,ys.bumpmap,ys.normalmap,ys.displacementmap,ys.fog,ys.lights,{emissive:{value:new nr(0)}}]),vertexShader:Oa.meshlambert_vert,fragmentShader:Oa.meshlambert_frag},phong:{uniforms:qf([ys.common,ys.specularmap,ys.envmap,ys.aomap,ys.lightmap,ys.emissivemap,ys.bumpmap,ys.normalmap,ys.displacementmap,ys.fog,ys.lights,{emissive:{value:new nr(0)},specular:{value:new nr(1118481)},shininess:{value:30}}]),vertexShader:Oa.meshphong_vert,fragmentShader:Oa.meshphong_frag},standard:{uniforms:qf([ys.common,ys.envmap,ys.aomap,ys.lightmap,ys.emissivemap,ys.bumpmap,ys.normalmap,ys.displacementmap,ys.roughnessmap,ys.metalnessmap,ys.fog,ys.lights,{emissive:{value:new nr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Oa.meshphysical_vert,fragmentShader:Oa.meshphysical_frag},toon:{uniforms:qf([ys.common,ys.aomap,ys.lightmap,ys.emissivemap,ys.bumpmap,ys.normalmap,ys.displacementmap,ys.gradientmap,ys.fog,ys.lights,{emissive:{value:new nr(0)}}]),vertexShader:Oa.meshtoon_vert,fragmentShader:Oa.meshtoon_frag},matcap:{uniforms:qf([ys.common,ys.bumpmap,ys.normalmap,ys.displacementmap,ys.fog,{matcap:{value:null}}]),vertexShader:Oa.meshmatcap_vert,fragmentShader:Oa.meshmatcap_frag},points:{uniforms:qf([ys.points,ys.fog]),vertexShader:Oa.points_vert,fragmentShader:Oa.points_frag},dashed:{uniforms:qf([ys.common,ys.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Oa.linedashed_vert,fragmentShader:Oa.linedashed_frag},depth:{uniforms:qf([ys.common,ys.displacementmap]),vertexShader:Oa.depth_vert,fragmentShader:Oa.depth_frag},normal:{uniforms:qf([ys.common,ys.bumpmap,ys.normalmap,ys.displacementmap,{opacity:{value:1}}]),vertexShader:Oa.meshnormal_vert,fragmentShader:Oa.meshnormal_frag},sprite:{uniforms:qf([ys.sprite,ys.fog]),vertexShader:Oa.sprite_vert,fragmentShader:Oa.sprite_frag},background:{uniforms:{uvTransform:{value:new xa},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Oa.background_vert,fragmentShader:Oa.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new xa}},vertexShader:Oa.backgroundCube_vert,fragmentShader:Oa.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Oa.cube_vert,fragmentShader:Oa.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Oa.equirect_vert,fragmentShader:Oa.equirect_frag},distanceRGBA:{uniforms:qf([ys.common,ys.displacementmap,{referencePosition:{value:new Dt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Oa.distanceRGBA_vert,fragmentShader:Oa.distanceRGBA_frag},shadow:{uniforms:qf([ys.lights,ys.fog,{color:{value:new nr(0)},opacity:{value:1}}]),vertexShader:Oa.shadow_vert,fragmentShader:Oa.shadow_frag}};P0.physical={uniforms:qf([P0.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new xa},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new xa},clearcoatNormalScale:{value:new Fi(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new xa},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new xa},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new xa},sheen:{value:0},sheenColor:{value:new nr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new xa},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new xa},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new xa},transmissionSamplerSize:{value:new Fi},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new xa},attenuationDistance:{value:0},attenuationColor:{value:new nr(0)},specularColor:{value:new nr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new xa},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new xa},anisotropyVector:{value:new Fi},anisotropyMap:{value:null},anisotropyMapTransform:{value:new xa}}]),vertexShader:Oa.meshphysical_vert,fragmentShader:Oa.meshphysical_frag};const S4={r:0,b:0,g:0},Zb=new B0,Bme=new go;function Pme(n,e,t,i,r,s,o){const l=new nr(0);let u,f,h=!0===s?0:1,y=null,T=0,B=null;function j(Ee){let Pe=!0===Ee.isScene?Ee.background:null;return Pe&&Pe.isTexture&&(Pe=(Ee.backgroundBlurriness>0?t:e).get(Pe)),Pe}function le(Ee,Pe){Ee.getRGB(S4,Qq(n)),i.buffers.color.setClear(S4.r,S4.g,S4.b,Pe,o)}return{getClearColor:function(){return l},setClearColor:function(Ee,Pe=1){l.set(Ee),h=Pe,le(l,h)},getClearAlpha:function(){return h},setClearAlpha:function(Ee){h=Ee,le(l,h)},render:function ne(Ee){let Pe=!1;const Ve=j(Ee);null===Ve?le(l,h):Ve&&Ve.isColor&&(le(Ve,1),Pe=!0);const Ft=n.xr.getEnvironmentBlendMode();"additive"===Ft?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===Ft&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||Pe)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))},addToRenderList:function se(Ee,Pe){const Ve=j(Pe);Ve&&(Ve.isCubeTexture||Ve.mapping===SS)?(void 0===f&&(f=new jo(new Tp(1,1,1),new Ou({name:"BackgroundCubeMaterial",uniforms:xC(P0.backgroundCube.uniforms),vertexShader:P0.backgroundCube.vertexShader,fragmentShader:P0.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(Ft,Ct,Lt){this.matrixWorld.copyPosition(Lt.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(f)),Zb.copy(Pe.backgroundRotation),Zb.x*=-1,Zb.y*=-1,Zb.z*=-1,Ve.isCubeTexture&&!1===Ve.isRenderTargetTexture&&(Zb.y*=-1,Zb.z*=-1),f.material.uniforms.envMap.value=Ve,f.material.uniforms.flipEnvMap.value=Ve.isCubeTexture&&!1===Ve.isRenderTargetTexture?-1:1,f.material.uniforms.backgroundBlurriness.value=Pe.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=Pe.backgroundIntensity,f.material.uniforms.backgroundRotation.value.setFromMatrix4(Bme.makeRotationFromEuler(Zb)),f.material.toneMapped=pl.getTransfer(Ve.colorSpace)!==Uc,(y!==Ve||T!==Ve.version||B!==n.toneMapping)&&(f.material.needsUpdate=!0,y=Ve,T=Ve.version,B=n.toneMapping),f.layers.enableAll(),Ee.unshift(f,f.geometry,f.material,0,0,null)):Ve&&Ve.isTexture&&(void 0===u&&(u=new jo(new MC(2,2),new Ou({name:"BackgroundMaterial",uniforms:xC(P0.background.uniforms),vertexShader:P0.background.vertexShader,fragmentShader:P0.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=Ve,u.material.uniforms.backgroundIntensity.value=Pe.backgroundIntensity,u.material.toneMapped=pl.getTransfer(Ve.colorSpace)!==Uc,!0===Ve.matrixAutoUpdate&&Ve.updateMatrix(),u.material.uniforms.uvTransform.value.copy(Ve.matrix),(y!==Ve||T!==Ve.version||B!==n.toneMapping)&&(u.material.needsUpdate=!0,y=Ve,T=Ve.version,B=n.toneMapping),u.layers.enableAll(),Ee.unshift(u,u.geometry,u.material,0,0,null))}}}function Rme(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},r=T(null);let s=r,o=!1;function u(St){return n.bindVertexArray(St)}function f(St){return n.deleteVertexArray(St)}function T(St){const Dn=[],ti=[],ci=[];for(let vi=0;vi<t;vi++)Dn[vi]=0,ti[vi]=0,ci[vi]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Dn,enabledAttributes:ti,attributeDivisors:ci,object:St,attributes:{},index:null}}function ne(){const St=s.newAttributes;for(let Dn=0,ti=St.length;Dn<ti;Dn++)St[Dn]=0}function se(St){le(St,0)}function le(St,Dn){const ci=s.enabledAttributes,vi=s.attributeDivisors;s.newAttributes[St]=1,0===ci[St]&&(n.enableVertexAttribArray(St),ci[St]=1),vi[St]!==Dn&&(n.vertexAttribDivisor(St,Dn),vi[St]=Dn)}function Ee(){const St=s.newAttributes,Dn=s.enabledAttributes;for(let ti=0,ci=Dn.length;ti<ci;ti++)Dn[ti]!==St[ti]&&(n.disableVertexAttribArray(ti),Dn[ti]=0)}function Pe(St,Dn,ti,ci,vi,bi,Un){!0===Un?n.vertexAttribIPointer(St,Dn,ti,vi,bi):n.vertexAttribPointer(St,Dn,ti,ci,vi,bi)}function Kt(){Bt(),o=!0,s!==r&&(s=r,u(s.object))}function Bt(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:function l(St,Dn,ti,ci,vi){let bi=!1;const Un=function y(St,Dn,ti){const ci=!0===ti.wireframe;let vi=i[St.id];void 0===vi&&(vi={},i[St.id]=vi);let bi=vi[Dn.id];void 0===bi&&(bi={},vi[Dn.id]=bi);let Un=bi[ci];return void 0===Un&&(Un=T(function h(){return n.createVertexArray()}()),bi[ci]=Un),Un}(ci,ti,Dn);s!==Un&&(s=Un,u(s.object)),bi=function B(St,Dn,ti,ci){const vi=s.attributes,bi=Dn.attributes;let Un=0;const _i=ti.getAttributes();for(const si in _i)if(_i[si].location>=0){const Nr=vi[si];let Wr=bi[si];if(void 0===Wr&&("instanceMatrix"===si&&St.instanceMatrix&&(Wr=St.instanceMatrix),"instanceColor"===si&&St.instanceColor&&(Wr=St.instanceColor)),void 0===Nr||Nr.attribute!==Wr||Wr&&Nr.data!==Wr.data)return!0;Un++}return s.attributesNum!==Un||s.index!==ci}(St,ci,ti,vi),bi&&function j(St,Dn,ti,ci){const vi={},bi=Dn.attributes;let Un=0;const _i=ti.getAttributes();for(const si in _i)if(_i[si].location>=0){let Nr=bi[si];void 0===Nr&&("instanceMatrix"===si&&St.instanceMatrix&&(Nr=St.instanceMatrix),"instanceColor"===si&&St.instanceColor&&(Nr=St.instanceColor));const Wr={};Wr.attribute=Nr,Nr&&Nr.data&&(Wr.data=Nr.data),vi[si]=Wr,Un++}s.attributes=vi,s.attributesNum=Un,s.index=ci}(St,ci,ti,vi),null!==vi&&e.update(vi,n.ELEMENT_ARRAY_BUFFER),(bi||o)&&(o=!1,function Ve(St,Dn,ti,ci){ne();const vi=ci.attributes,bi=ti.getAttributes(),Un=Dn.defaultAttributeValues;for(const _i in bi){const si=bi[_i];if(si.location>=0){let ir=vi[_i];if(void 0===ir&&("instanceMatrix"===_i&&St.instanceMatrix&&(ir=St.instanceMatrix),"instanceColor"===_i&&St.instanceColor&&(ir=St.instanceColor)),void 0!==ir){const Nr=ir.normalized,Wr=ir.itemSize,so=e.get(ir);if(void 0===so)continue;const Po=so.buffer,Ci=so.type,yr=so.bytesPerElement,ps=Ci===n.INT||Ci===n.UNSIGNED_INT||ir.gpuType===lO;if(ir.isInterleavedBufferAttribute){const Rr=ir.data,Gs=Rr.stride,to=ir.offset;if(Rr.isInstancedInterleavedBuffer){for(let lo=0;lo<si.locationSize;lo++)le(si.location+lo,Rr.meshPerAttribute);!0!==St.isInstancedMesh&&void 0===ci._maxInstanceCount&&(ci._maxInstanceCount=Rr.meshPerAttribute*Rr.count)}else for(let lo=0;lo<si.locationSize;lo++)se(si.location+lo);n.bindBuffer(n.ARRAY_BUFFER,Po);for(let lo=0;lo<si.locationSize;lo++)Pe(si.location+lo,Wr/si.locationSize,Ci,Nr,Gs*yr,(to+Wr/si.locationSize*lo)*yr,ps)}else{if(ir.isInstancedBufferAttribute){for(let Rr=0;Rr<si.locationSize;Rr++)le(si.location+Rr,ir.meshPerAttribute);!0!==St.isInstancedMesh&&void 0===ci._maxInstanceCount&&(ci._maxInstanceCount=ir.meshPerAttribute*ir.count)}else for(let Rr=0;Rr<si.locationSize;Rr++)se(si.location+Rr);n.bindBuffer(n.ARRAY_BUFFER,Po);for(let Rr=0;Rr<si.locationSize;Rr++)Pe(si.location+Rr,Wr/si.locationSize,Ci,Nr,Wr*yr,Wr/si.locationSize*Rr*yr,ps)}}else if(void 0!==Un){const Nr=Un[_i];if(void 0!==Nr)switch(Nr.length){case 2:n.vertexAttrib2fv(si.location,Nr);break;case 3:n.vertexAttrib3fv(si.location,Nr);break;case 4:n.vertexAttrib4fv(si.location,Nr);break;default:n.vertexAttrib1fv(si.location,Nr)}}}}Ee()}(St,Dn,ti,ci),null!==vi&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(vi).buffer))},reset:Kt,resetDefaultState:Bt,dispose:function Ft(){Kt();for(const St in i){const Dn=i[St];for(const ti in Dn){const ci=Dn[ti];for(const vi in ci)f(ci[vi].object),delete ci[vi];delete Dn[ti]}delete i[St]}},releaseStatesOfGeometry:function Ct(St){if(void 0===i[St.id])return;const Dn=i[St.id];for(const ti in Dn){const ci=Dn[ti];for(const vi in ci)f(ci[vi].object),delete ci[vi];delete Dn[ti]}delete i[St.id]},releaseStatesOfProgram:function Lt(St){for(const Dn in i){const ti=i[Dn];if(void 0===ti[St.id])continue;const ci=ti[St.id];for(const vi in ci)f(ci[vi].object),delete ci[vi];delete ti[St.id]}},initAttributes:ne,enableAttribute:se,disableUnusedAttributes:Ee}}function kme(n,e,t){let i;function o(u,f,y){0!==y&&(n.drawArraysInstanced(i,u,f,y),t.update(f,i,y))}this.setMode=function r(u){i=u},this.render=function s(u,f){n.drawArrays(i,u,f),t.update(f,i,1)},this.renderInstances=o,this.renderMultiDraw=function l(u,f,y){if(0===y)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,u,0,f,0,y);let B=0;for(let j=0;j<y;j++)B+=f[j];t.update(B,i,1)},this.renderMultiDrawInstances=function h(u,f,y,T){if(0===y)return;const B=e.get("WEBGL_multi_draw");if(null===B)for(let j=0;j<u.length;j++)o(u[j],f[j],T[j]);else{B.multiDrawArraysInstancedWEBGL(i,u,0,f,0,T,0,y);let j=0;for(let ne=0;ne<y;ne++)j+=f[ne];for(let ne=0;ne<T.length;ne++)t.update(j,i,T[ne])}}}function Fme(n,e,t,i){let r;function h(Ct){if("highp"===Ct){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";Ct="mediump"}return"mediump"===Ct&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=void 0!==t.precision?t.precision:"highp";const f=h(u);f!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",f,"instead."),u=f);const y=!0===t.logarithmicDepthBuffer,T=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),B=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function s(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const Ct=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(Ct.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:h,textureFormatReadable:function o(Ct){return!(Ct!==Hf&&i.convert(Ct)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))},textureTypeReadable:function l(Ct){const Lt=Ct===wA&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(Ct!==$_&&i.convert(Ct)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&Ct!==ym&&!Lt)},precision:u,logarithmicDepthBuffer:y,maxTextures:T,maxVertexTextures:B,maxTextureSize:n.getParameter(n.MAX_TEXTURE_SIZE),maxCubemapSize:n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:n.getParameter(n.MAX_VERTEX_ATTRIBS),maxVertexUniforms:n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:n.getParameter(n.MAX_VARYING_VECTORS),maxFragmentUniforms:n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:B>0,maxSamples:n.getParameter(n.MAX_SAMPLES)}}function Ome(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new MA,l=new xa,h={value:null,needsUpdate:!1};function f(y,T,B,j){const ne=null!==y?y.length:0;let se=null;if(0!==ne){if(se=h.value,!0!==j||null===se){const le=B+4*ne,Ee=T.matrixWorldInverse;l.getNormalMatrix(Ee),(null===se||se.length<le)&&(se=new Float32Array(le));for(let Pe=0,Ve=B;Pe!==ne;++Pe,Ve+=4)o.copy(y[Pe]).applyMatrix4(Ee,l),o.normal.toArray(se,Ve),se[Ve+3]=o.constant}h.value=se,h.needsUpdate=!0}return e.numPlanes=ne,e.numIntersection=0,se}this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(y,T){const B=0!==y.length||T||0!==i||r;return r=T,i=y.length,B},this.beginShadows=function(){s=!0,f(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(y,T){t=f(y,T,0)},this.setState=function(y,T,B){const j=y.clippingPlanes,ne=y.clipIntersection,se=y.clipShadows,le=n.get(y);if(!r||null===j||0===j.length||s&&!se)s?f(null):function u(){h.value!==t&&(h.value=t,h.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const Ee=s?0:i,Pe=4*Ee;let Ve=le.clippingState||null;h.value=Ve,Ve=f(j,T,Pe,B);for(let Ft=0;Ft!==Pe;++Ft)Ve[Ft]=t[Ft];le.clippingState=Ve,this.numIntersection=ne?this.numPlanes:0,this.numPlanes+=Ee}}}function Lme(n){let e=new WeakMap;function t(o,l){return 303===l?o.mapping=q1:304===l&&(o.mapping=Gb),o}function r(o){const l=o.target;l.removeEventListener("dispose",r);const h=e.get(l);void 0!==h&&(e.delete(l),h.dispose())}return{get:function i(o){if(o&&o.isTexture){const l=o.mapping;if(303===l||304===l){if(e.has(o))return t(e.get(o).texture,o.mapping);{const h=o.image;if(h&&h.height>0){const u=new Tfe(h.height);return u.fromEquirectangularTexture(n,o),e.set(o,u),o.addEventListener("dispose",r),t(u.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class Jb extends d5{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,l=r+t,h=r-t;if(null!==this.view&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,l-=f*this.view.offsetY,h=l-f*this.view.height}this.projectionMatrix.makeOrthographic(s,o,l,h,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Xq=[.125,.215,.35,.446,.526,.582],p5=new Jb,Yq=new nr;let m5=null,A5=0,g5=0,_5=!1;const tx=(1+Math.sqrt(5))/2,SC=1/tx,Kq=[new Dt(-tx,SC,0),new Dt(tx,SC,0),new Dt(-SC,0,tx),new Dt(SC,0,tx),new Dt(0,tx,-SC),new Dt(0,tx,SC),new Dt(-1,1,-1),new Dt(1,1,-1),new Dt(-1,1,1),new Dt(1,1,1)];class Zq{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){m5=this._renderer.getRenderTarget(),A5=this._renderer.getActiveCubeFace(),g5=this._renderer.getActiveMipmapLevel(),_5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=tQ(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=eQ(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(m5,A5,g5),this._renderer.xr.enabled=_5,e.scissorTest=!1,T4(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===q1||e.mapping===Gb?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),m5=this._renderer.getRenderTarget(),A5=this._renderer.getActiveCubeFace(),g5=this._renderer.getActiveMipmapLevel(),_5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:bh,minFilter:bh,generateMipmaps:!1,type:wA,format:Hf,colorSpace:id,depthBuffer:!1},r=Jq(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Jq(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Nme(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+Xq.length;for(let o=0;o<s;o++){const l=Math.pow(2,r);t.push(l);let h=1/l;o>n-4?h=Xq[o-n+4-1]:0===o&&(h=0),i.push(h);const u=1/(l-2),f=-u,y=1+u,T=[f,f,y,f,y,y,f,f,y,y,f,y],B=6,j=6,ne=3,se=2,le=1,Ee=new Float32Array(ne*j*B),Pe=new Float32Array(se*j*B),Ve=new Float32Array(le*j*B);for(let Ct=0;Ct<B;Ct++){const Lt=Ct%3*2/3-1,Kt=Ct>2?0:-1;Ee.set([Lt,Kt,0,Lt+2/3,Kt,0,Lt+2/3,Kt+1,0,Lt,Kt,0,Lt+2/3,Kt+1,0,Lt,Kt+1,0],ne*j*Ct),Pe.set(T,se*j*Ct),Ve.set([Ct,Ct,Ct,Ct,Ct,Ct],le*j*Ct)}const Ft=new Hs;Ft.setAttribute("position",new To(Ee,ne)),Ft.setAttribute("uv",new To(Pe,se)),Ft.setAttribute("faceIndex",new To(Ve,le)),e.push(Ft),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function Ume(n,e,t){const i=new Float32Array(20),r=new Dt(0,1,0);return new Ou({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new jo(this._lodPlanes[0],e);this._renderer.compile(t,p5)}_sceneToCubeUV(e,t,i,r){const l=new Lu(90,1,t,i),h=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],f=this._renderer,y=f.autoClear,T=f.toneMapping;f.getClearColor(Yq),f.toneMapping=G1,f.autoClear=!1;const B=new wh({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),j=new jo(new Tp,B);let ne=!1;const se=e.background;se?se.isColor&&(B.color.copy(se),e.background=null,ne=!0):(B.color.copy(Yq),ne=!0);for(let le=0;le<6;le++){const Ee=le%3;0===Ee?(l.up.set(0,h[le],0),l.lookAt(u[le],0,0)):1===Ee?(l.up.set(0,0,h[le]),l.lookAt(0,u[le],0)):(l.up.set(0,h[le],0),l.lookAt(0,0,u[le]));const Pe=this._cubeSize;T4(r,Ee*Pe,le>2?Pe:0,Pe,Pe),f.setRenderTarget(r),ne&&f.render(j,l),f.render(e,l)}j.geometry.dispose(),j.material.dispose(),f.toneMapping=T,f.autoClear=y,e.background=se}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===q1||e.mapping===Gb;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=tQ()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=eQ());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new jo(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const h=this._cubeSize;T4(t,0,0,3*h,2*h),i.setRenderTarget(t),i.render(o,p5)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]);this._blur(e,s-1,s,o,Kq[(r-s-1)%Kq.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,l){const h=this._renderer,u=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const y=new jo(this._lodPlanes[r],u),T=u.uniforms,B=this._sizeLods[i]-1,j=isFinite(s)?Math.PI/(2*B):2*Math.PI/39,ne=s/j,se=isFinite(s)?1+Math.floor(3*ne):20;se>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${se} samples when the maximum is set to 20`);const le=[];let Ee=0;for(let Lt=0;Lt<20;++Lt){const Kt=Lt/ne,Bt=Math.exp(-Kt*Kt/2);le.push(Bt),0===Lt?Ee+=Bt:Lt<se&&(Ee+=2*Bt)}for(let Lt=0;Lt<le.length;Lt++)le[Lt]=le[Lt]/Ee;T.envMap.value=e.texture,T.samples.value=se,T.weights.value=le,T.latitudinal.value="latitudinal"===o,l&&(T.poleAxis.value=l);const{_lodMax:Pe}=this;T.dTheta.value=j,T.mipInt.value=Pe-i;const Ve=this._sizeLods[r];T4(t,3*Ve*(r>Pe-4?r-Pe+4:0),4*(this._cubeSize-Ve),3*Ve,2*Ve),h.setRenderTarget(t),h.render(y,p5)}}function Jq(n,e,t){const i=new rd(n,e,t);return i.texture.mapping=SS,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function T4(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function eQ(){return new Ou({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function tQ(){return new Ou({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function zme(n){let e=new WeakMap,t=null;function s(l){const h=l.target;h.removeEventListener("dispose",s);const u=e.get(h);void 0!==u&&(e.delete(h),u.dispose())}return{get:function i(l){if(l&&l.isTexture){const h=l.mapping,u=303===h||304===h,f=h===q1||h===Gb;if(u||f){let y=e.get(l);if(l.isRenderTargetTexture&&l.pmremVersion!==(void 0!==y?y.texture.pmremVersion:0))return null===t&&(t=new Zq(n)),y=u?t.fromEquirectangular(l,y):t.fromCubemap(l,y),y.texture.pmremVersion=l.pmremVersion,e.set(l,y),y.texture;if(void 0!==y)return y.texture;{const B=l.image;return u&&B&&B.height>0||f&&B&&function r(l){let h=0;for(let f=0;f<6;f++)void 0!==l[f]&&h++;return 6===h}(B)?(null===t&&(t=new Zq(n)),y=u?t.fromEquirectangular(l):t.fromCubemap(l),y.texture.pmremVersion=l.pmremVersion,e.set(l,y),l.addEventListener("dispose",s),y.texture):null}}}return l},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Hme(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const r=t(i);return null===r&&oC("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Vme(n,e,t,i){const r={},s=new WeakMap;function o(y){const T=y.target;null!==T.index&&e.remove(T.index);for(const j in T.attributes)e.remove(T.attributes[j]);for(const j in T.morphAttributes){const ne=T.morphAttributes[j];for(let se=0,le=ne.length;se<le;se++)e.remove(ne[se])}T.removeEventListener("dispose",o),delete r[T.id];const B=s.get(T);B&&(e.remove(B),s.delete(T)),i.releaseStatesOfGeometry(T),!0===T.isInstancedBufferGeometry&&delete T._maxInstanceCount,t.memory.geometries--}function u(y){const T=[],B=y.index,j=y.attributes.position;let ne=0;if(null!==B){const Ee=B.array;ne=B.version;for(let Pe=0,Ve=Ee.length;Pe<Ve;Pe+=3){const Ft=Ee[Pe+0],Ct=Ee[Pe+1],Lt=Ee[Pe+2];T.push(Ft,Ct,Ct,Lt,Lt,Ft)}}else{if(void 0===j)return;ne=j.version;for(let Pe=0,Ve=j.array.length/3-1;Pe<Ve;Pe+=3){const Ft=Pe+0,Ct=Pe+1,Lt=Pe+2;T.push(Ft,Ct,Ct,Lt,Lt,Ft)}}const se=new(wq(T)?Uq:Nq)(T,1);se.version=ne;const le=s.get(y);le&&e.remove(le),s.set(y,se)}return{get:function l(y,T){return!0===r[T.id]||(T.addEventListener("dispose",o),r[T.id]=!0,t.memory.geometries++),T},update:function h(y){const T=y.attributes;for(const j in T)e.update(T[j],n.ARRAY_BUFFER);const B=y.morphAttributes;for(const j in B){const ne=B[j];for(let se=0,le=ne.length;se<le;se++)e.update(ne[se],n.ARRAY_BUFFER)}},getWireframeAttribute:function f(y){const T=s.get(y);if(T){const B=y.index;null!==B&&T.version<B.version&&u(y)}else u(y);return s.get(y)}}}function Gme(n,e,t){let i,s,o;function u(T,B,j){0!==j&&(n.drawElementsInstanced(i,B,s,T*o,j),t.update(B,i,j))}this.setMode=function r(T){i=T},this.setIndex=function l(T){s=T.type,o=T.bytesPerElement},this.render=function h(T,B){n.drawElements(i,B,s,T*o),t.update(B,i,1)},this.renderInstances=u,this.renderMultiDraw=function f(T,B,j){if(0===j)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,B,0,s,T,0,j);let se=0;for(let le=0;le<j;le++)se+=B[le];t.update(se,i,1)},this.renderMultiDrawInstances=function y(T,B,j,ne){if(0===j)return;const se=e.get("WEBGL_multi_draw");if(null===se)for(let le=0;le<T.length;le++)u(T[le]/o,B[le],ne[le]);else{se.multiDrawElementsInstancedWEBGL(i,B,0,s,T,0,ne,0,j);let le=0;for(let Ee=0;Ee<j;Ee++)le+=B[Ee];for(let Ee=0;Ee<ne.length;Ee++)t.update(le,i,ne[Ee])}}}function qme(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,l){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=l*(s/3);break;case n.LINES:t.lines+=l*(s/2);break;case n.LINE_STRIP:t.lines+=l*(s-1);break;case n.LINE_LOOP:t.lines+=l*s;break;case n.POINTS:t.points+=l*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function Qme(n,e,t){const i=new WeakMap,r=new $l;return{update:function s(o,l,h){const u=o.morphTargetInfluences,f=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,y=void 0!==f?f.length:0;let T=i.get(l);if(void 0===T||T.count!==y){let Bt=function(){Lt.dispose(),i.delete(l),l.removeEventListener("dispose",Bt)};void 0!==T&&T.texture.dispose();const B=void 0!==l.morphAttributes.position,j=void 0!==l.morphAttributes.normal,ne=void 0!==l.morphAttributes.color,se=l.morphAttributes.position||[],le=l.morphAttributes.normal||[],Ee=l.morphAttributes.color||[];let Pe=0;!0===B&&(Pe=1),!0===j&&(Pe=2),!0===ne&&(Pe=3);let Ve=l.attributes.position.count*Pe,Ft=1;Ve>e.maxTextureSize&&(Ft=Math.ceil(Ve/e.maxTextureSize),Ve=e.maxTextureSize);const Ct=new Float32Array(Ve*Ft*4*y),Lt=new $O(Ct,Ve,Ft,y);Lt.type=ym,Lt.needsUpdate=!0;const Kt=4*Pe;for(let St=0;St<y;St++){const Dn=se[St],ti=le[St],ci=Ee[St],vi=Ve*Ft*4*St;for(let bi=0;bi<Dn.count;bi++){const Un=bi*Kt;!0===B&&(r.fromBufferAttribute(Dn,bi),Ct[vi+Un+0]=r.x,Ct[vi+Un+1]=r.y,Ct[vi+Un+2]=r.z,Ct[vi+Un+3]=0),!0===j&&(r.fromBufferAttribute(ti,bi),Ct[vi+Un+4]=r.x,Ct[vi+Un+5]=r.y,Ct[vi+Un+6]=r.z,Ct[vi+Un+7]=0),!0===ne&&(r.fromBufferAttribute(ci,bi),Ct[vi+Un+8]=r.x,Ct[vi+Un+9]=r.y,Ct[vi+Un+10]=r.z,Ct[vi+Un+11]=4===ci.itemSize?r.w:1)}}T={count:y,texture:Lt,size:new Fi(Ve,Ft)},i.set(l,T),l.addEventListener("dispose",Bt)}if(!0===o.isInstancedMesh&&null!==o.morphTexture)h.getUniforms().setValue(n,"morphTexture",o.morphTexture,t);else{let B=0;for(let ne=0;ne<u.length;ne++)B+=u[ne];const j=l.morphTargetsRelative?1:1-B;h.getUniforms().setValue(n,"morphTargetBaseInfluence",j),h.getUniforms().setValue(n,"morphTargetInfluences",u)}h.getUniforms().setValue(n,"morphTargetsTexture",T.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",T.size)}}}function jme(n,e,t,i){let r=new WeakMap;function l(h){const u=h.target;u.removeEventListener("dispose",l),t.remove(u.instanceMatrix),null!==u.instanceColor&&t.remove(u.instanceColor)}return{update:function s(h){const u=i.render.frame,y=e.get(h,h.geometry);if(r.get(y)!==u&&(e.update(y),r.set(y,u)),h.isInstancedMesh&&(!1===h.hasEventListener("dispose",l)&&h.addEventListener("dispose",l),r.get(h)!==u&&(t.update(h.instanceMatrix,n.ARRAY_BUFFER),null!==h.instanceColor&&t.update(h.instanceColor,n.ARRAY_BUFFER),r.set(h,u))),h.isSkinnedMesh){const T=h.skeleton;r.get(T)!==u&&(T.update(),r.set(T,u))}return y},dispose:function o(){r=new WeakMap}}}class nQ extends Yd{constructor(e,t,i,r,s,o,l,h,u,f=K2){if(f!==K2&&f!==Z2)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&f===K2&&(i=j1),void 0===i&&f===Z2&&(i=Y2),super(null,r,s,o,l,h,f,i,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==l?l:Fu,this.minFilter=void 0!==h?h:Fu,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}const iQ=new Yd,rQ=new nQ(1,1),sQ=new $O,oQ=new Sq,aQ=new C4,lQ=[],cQ=[],hQ=new Float32Array(16),uQ=new Float32Array(9),dQ=new Float32Array(4);function TC(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=lQ[r];if(void 0===s&&(s=new Float32Array(r),lQ[r]=s),0!==e){i.toArray(s,0);for(let o=1,l=0;o!==e;++o)l+=t,n[o].toArray(s,l)}return s}function Nu(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Uu(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function D4(n,e){let t=cQ[e];void 0===t&&(t=new Int32Array(e),cQ[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Wme(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function $me(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Nu(t,e))return;n.uniform2fv(this.addr,e),Uu(t,e)}}function Xme(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Nu(t,e))return;n.uniform3fv(this.addr,e),Uu(t,e)}}function Yme(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Nu(t,e))return;n.uniform4fv(this.addr,e),Uu(t,e)}}function Kme(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Nu(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Uu(t,e)}else{if(Nu(t,i))return;dQ.set(i),n.uniformMatrix2fv(this.addr,!1,dQ),Uu(t,i)}}function Zme(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Nu(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Uu(t,e)}else{if(Nu(t,i))return;uQ.set(i),n.uniformMatrix3fv(this.addr,!1,uQ),Uu(t,i)}}function Jme(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Nu(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Uu(t,e)}else{if(Nu(t,i))return;hQ.set(i),n.uniformMatrix4fv(this.addr,!1,hQ),Uu(t,i)}}function eAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function tAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Nu(t,e))return;n.uniform2iv(this.addr,e),Uu(t,e)}}function nAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Nu(t,e))return;n.uniform3iv(this.addr,e),Uu(t,e)}}function iAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Nu(t,e))return;n.uniform4iv(this.addr,e),Uu(t,e)}}function rAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function sAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Nu(t,e))return;n.uniform2uiv(this.addr,e),Uu(t,e)}}function oAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Nu(t,e))return;n.uniform3uiv(this.addr,e),Uu(t,e)}}function aAe(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Nu(t,e))return;n.uniform4uiv(this.addr,e),Uu(t,e)}}function lAe(n,e,t){const i=this.cache,r=t.allocateTextureUnit();let s;i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),this.type===n.SAMPLER_2D_SHADOW?(rQ.compareFunction=515,s=rQ):s=iQ,t.setTexture2D(e||s,r)}function cAe(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||oQ,r)}function hAe(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||aQ,r)}function uAe(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||sQ,r)}function fAe(n,e){n.uniform1fv(this.addr,e)}function pAe(n,e){const t=TC(e,this.size,2);n.uniform2fv(this.addr,t)}function mAe(n,e){const t=TC(e,this.size,3);n.uniform3fv(this.addr,t)}function AAe(n,e){const t=TC(e,this.size,4);n.uniform4fv(this.addr,t)}function gAe(n,e){const t=TC(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function _Ae(n,e){const t=TC(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function yAe(n,e){const t=TC(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function vAe(n,e){n.uniform1iv(this.addr,e)}function bAe(n,e){n.uniform2iv(this.addr,e)}function xAe(n,e){n.uniform3iv(this.addr,e)}function wAe(n,e){n.uniform4iv(this.addr,e)}function CAe(n,e){n.uniform1uiv(this.addr,e)}function MAe(n,e){n.uniform2uiv(this.addr,e)}function EAe(n,e){n.uniform3uiv(this.addr,e)}function SAe(n,e){n.uniform4uiv(this.addr,e)}function TAe(n,e,t){const i=this.cache,r=e.length,s=D4(t,r);Nu(i,s)||(n.uniform1iv(this.addr,s),Uu(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||iQ,s[o])}function DAe(n,e,t){const i=this.cache,r=e.length,s=D4(t,r);Nu(i,s)||(n.uniform1iv(this.addr,s),Uu(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||oQ,s[o])}function IAe(n,e,t){const i=this.cache,r=e.length,s=D4(t,r);Nu(i,s)||(n.uniform1iv(this.addr,s),Uu(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||aQ,s[o])}function BAe(n,e,t){const i=this.cache,r=e.length,s=D4(t,r);Nu(i,s)||(n.uniform1iv(this.addr,s),Uu(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||sQ,s[o])}class RAe{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=function dAe(n){switch(n){case 5126:return Wme;case 35664:return $me;case 35665:return Xme;case 35666:return Yme;case 35674:return Kme;case 35675:return Zme;case 35676:return Jme;case 5124:case 35670:return eAe;case 35667:case 35671:return tAe;case 35668:case 35672:return nAe;case 35669:case 35673:return iAe;case 5125:return rAe;case 36294:return sAe;case 36295:return oAe;case 36296:return aAe;case 35678:case 36198:case 36298:case 36306:case 35682:return lAe;case 35679:case 36299:case 36307:return cAe;case 35680:case 36300:case 36308:case 36293:return hAe;case 36289:case 36303:case 36311:case 36292:return uAe}}(t.type)}}class kAe{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function PAe(n){switch(n){case 5126:return fAe;case 35664:return pAe;case 35665:return mAe;case 35666:return AAe;case 35674:return gAe;case 35675:return _Ae;case 35676:return yAe;case 5124:case 35670:return vAe;case 35667:case 35671:return bAe;case 35668:case 35672:return xAe;case 35669:case 35673:return wAe;case 5125:return CAe;case 36294:return MAe;case 36295:return EAe;case 36296:return SAe;case 35678:case 36198:case 36298:case 36306:case 35682:return TAe;case 35679:case 36299:case 36307:return DAe;case 35680:case 36300:case 36308:case 36293:return IAe;case 36289:case 36303:case 36311:case 36292:return BAe}}(t.type)}}class FAe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const l=r[s];l.setValue(e,t[l.id],i)}}}const v5=/(\w+)(\])?(\[|\.)?/g;function fQ(n,e){n.seq.push(e),n.map[e.id]=e}function OAe(n,e,t){const i=n.name,r=i.length;for(v5.lastIndex=0;;){const s=v5.exec(i);let l=s[1];const u=s[3];if("]"===s[2]&&(l|=0),void 0===u||"["===u&&v5.lastIndex+2===r){fQ(t,void 0===u?new RAe(l,n,e):new kAe(l,n,e));break}{let y=t.map[l];void 0===y&&(y=new FAe(l),fQ(t,y)),t=y}}}class I4{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);OAe(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const l=t[s],h=i[l.id];!1!==h.needsUpdate&&l.setValue(e,h.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function pQ(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const LAe=37297;let NAe=0;function mQ(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function UAe(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const l=o+1;i.push(`${l===e?">":" "} ${l}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function HAe(n,e){const t=function zAe(n){const e=pl.getPrimaries(pl.workingColorSpace),t=pl.getPrimaries(n);let i;switch(e===t?i="":e===r4&&t===n4?i="LinearDisplayP3ToLinearSRGB":e===n4&&t===r4&&(i="LinearSRGBToLinearDisplayP3"),n){case id:case e4:return[i,"LinearTransferOETF"];case hu:case GO:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function VAe(n,e){let t;switch(e){case xde:t="Linear";break;case wde:t="Reinhard";break;case Cde:t="Cineon";break;case Mde:t="ACESFilmic";break;case Sde:t="AgX";break;case Tde:t="Neutral";break;case Ede:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const B4=new Dt;function NS(n){return""!==n}function AQ(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function gQ(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const WAe=/^[ \t]*#include +<([\w\d./]+)>/gm;function b5(n){return n.replace(WAe,XAe)}const $Ae=new Map;function XAe(n,e){let t=Oa[e];if(void 0===t){const i=$Ae.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=Oa[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return b5(t)}const YAe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function _Q(n){return n.replace(YAe,KAe)}function KAe(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function yQ(n){let e=`precision ${n.precision} float;\n\tprecision ${n.precision} int;\n\tprecision ${n.precision} sampler2D;\n\tprecision ${n.precision} samplerCube;\n\tprecision ${n.precision} sampler3D;\n\tprecision ${n.precision} sampler2DArray;\n\tprecision ${n.precision} sampler2DShadow;\n\tprecision ${n.precision} samplerCubeShadow;\n\tprecision ${n.precision} sampler2DArrayShadow;\n\tprecision ${n.precision} isampler2D;\n\tprecision ${n.precision} isampler3D;\n\tprecision ${n.precision} isamplerCube;\n\tprecision ${n.precision} isampler2DArray;\n\tprecision ${n.precision} usampler2D;\n\tprecision ${n.precision} usampler3D;\n\tprecision ${n.precision} usamplerCube;\n\tprecision ${n.precision} usampler2DArray;\n\t`;return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function ige(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,l=t.fragmentShader;const h=function ZAe(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===iq?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===$ue?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===W_&&(e="SHADOWMAP_TYPE_VSM"),e}(t),u=function JAe(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case q1:case Gb:e="ENVMAP_TYPE_CUBE";break;case SS:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),f=function ege(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===Gb&&(e="ENVMAP_MODE_REFRACTION"),e}(t),y=function tge(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case GI:e="ENVMAP_BLENDING_MULTIPLY";break;case vde:e="ENVMAP_BLENDING_MIX";break;case bde:e="ENVMAP_BLENDING_ADD"}return e}(t),T=function nge(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),B=function qAe(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(NS).join("\n")}(t),j=function QAe(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),ne=r.createProgram();let se,le,Ee=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(se=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,j].filter(NS).join("\n"),se.length>0&&(se+="\n"),le=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,j].filter(NS).join("\n"),le.length>0&&(le+="\n")):(se=[yQ(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,j,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(NS).join("\n"),le=[yQ(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,j,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+f:"",t.envMap?"#define "+y:"",T?"#define CUBEUV_TEXEL_WIDTH "+T.texelWidth:"",T?"#define CUBEUV_TEXEL_HEIGHT "+T.texelHeight:"",T?"#define CUBEUV_MAX_MIP "+T.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==G1?"#define TONE_MAPPING":"",t.toneMapping!==G1?Oa.tonemapping_pars_fragment:"",t.toneMapping!==G1?VAe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Oa.colorspace_pars_fragment,HAe("linearToOutputTexel",t.outputColorSpace),(pl.getLuminanceCoefficients(B4),["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${B4.x.toFixed(4)}, ${B4.y.toFixed(4)}, ${B4.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(NS).join("\n")),o=b5(o),o=AQ(o,t),o=gQ(o,t),l=b5(l),l=AQ(l,t),l=gQ(l,t),o=_Q(o),l=_Q(l),!0!==t.isRawShaderMaterial&&(Ee="#version 300 es\n",se=[B,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+se,le=["#define varying in",t.glslVersion===bq?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===bq?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+le);const Ve=Ee+le+l,Ft=pQ(r,r.VERTEX_SHADER,Ee+se+o),Ct=pQ(r,r.FRAGMENT_SHADER,Ve);function Lt(Dn){if(n.debug.checkShaderErrors){const ti=r.getProgramInfoLog(ne).trim(),ci=r.getShaderInfoLog(Ft).trim(),vi=r.getShaderInfoLog(Ct).trim();let bi=!0,Un=!0;if(!1===r.getProgramParameter(ne,r.LINK_STATUS))if(bi=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,ne,Ft,Ct);else{const _i=mQ(r,Ft,"vertex"),si=mQ(r,Ct,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(ne,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+Dn.name+"\nMaterial Type: "+Dn.type+"\n\nProgram Info Log: "+ti+"\n"+_i+"\n"+si)}else""!==ti?console.warn("THREE.WebGLProgram: Program Info Log:",ti):(""===ci||""===vi)&&(Un=!1);Un&&(Dn.diagnostics={runnable:bi,programLog:ti,vertexShader:{log:ci,prefix:se},fragmentShader:{log:vi,prefix:le}})}r.deleteShader(Ft),r.deleteShader(Ct),Kt=new I4(r,ne),Bt=function jAe(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let l=1;s.type===n.FLOAT_MAT2&&(l=2),s.type===n.FLOAT_MAT3&&(l=3),s.type===n.FLOAT_MAT4&&(l=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:l}}return t}(r,ne)}let Kt,Bt;r.attachShader(ne,Ft),r.attachShader(ne,Ct),void 0!==t.index0AttributeName?r.bindAttribLocation(ne,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(ne,0,"position"),r.linkProgram(ne),this.getUniforms=function(){return void 0===Kt&&Lt(this),Kt},this.getAttributes=function(){return void 0===Bt&&Lt(this),Bt};let St=!1===t.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===St&&(St=r.getProgramParameter(ne,LAe)),St},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(ne),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=NAe++,this.cacheKey=e,this.usedTimes=1,this.program=ne,this.vertexShader=Ft,this.fragmentShader=Ct,this}let rge=0;class sge{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new oge(e),t.set(e,i)),i}}class oge{constructor(e){this.id=rge++,this.code=e,this.usedTimes=0}}function age(n,e,t,i,r,s,o){const l=new t5,h=new sge,u=new Set,f=[],y=r.logarithmicDepthBuffer,T=r.vertexTextures;let B=r.precision;const j={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function ne(Bt){return u.add(Bt),0===Bt?"uv":`uv${Bt}`}return{getParameters:function se(Bt,St,Dn,ti,ci){const vi=ti.fog,bi=ci.geometry,_i=(Bt.isMeshStandardMaterial?t:e).get(Bt.envMap||(Bt.isMeshStandardMaterial?ti.environment:null)),si=_i&&_i.mapping===SS?_i.image.height:null,ir=j[Bt.type];null!==Bt.precision&&(B=r.getMaxPrecision(Bt.precision),B!==Bt.precision&&console.warn("THREE.WebGLProgram.getParameters:",Bt.precision,"not supported, using",B,"instead."));const Nr=bi.morphAttributes.position||bi.morphAttributes.normal||bi.morphAttributes.color,Wr=void 0!==Nr?Nr.length:0;let Po,Ci,yr,ps,so=0;if(void 0!==bi.morphAttributes.position&&(so=1),void 0!==bi.morphAttributes.normal&&(so=2),void 0!==bi.morphAttributes.color&&(so=3),ir){const Ol=P0[ir];Po=Ol.vertexShader,Ci=Ol.fragmentShader}else Po=Bt.vertexShader,Ci=Bt.fragmentShader,h.update(Bt),yr=h.getVertexShaderID(Bt),ps=h.getFragmentShaderID(Bt);const Rr=n.getRenderTarget(),Gs=!0===ci.isInstancedMesh,to=!0===ci.isBatchedMesh,lo=!!Bt.map,bn=!!_i,Kr=!!Bt.aoMap,Ur=!!Bt.lightMap,Ss=!!Bt.bumpMap,sr=!!Bt.normalMap,Oo=!!Bt.displacementMap,xs=!!Bt.emissiveMap,qs=!!Bt.metalnessMap,Bn=!!Bt.roughnessMap,zt=Bt.anisotropy>0,Ii=Bt.clearcoat>0,hr=Bt.iridescence>0,_r=Bt.sheen>0,Do=Bt.transmission>0,vs=zt&&!!Bt.anisotropyMap,Vs=Ii&&!!Bt.clearcoatMap,wa=Ii&&!!Bt.clearcoatNormalMap,qr=Ii&&!!Bt.clearcoatRoughnessMap,Os=hr&&!!Bt.iridescenceMap,cl=hr&&!!Bt.iridescenceThicknessMap,ha=_r&&!!Bt.sheenColorMap,Xs=_r&&!!Bt.sheenRoughnessMap,ma=!!Bt.specularMap,$a=!!Bt.specularColorMap,dh=!!Bt.specularIntensityMap,ri=Do&&!!Bt.transmissionMap,Jr=Do&&!!Bt.thicknessMap,Ar=!!Bt.alphaMap,ml=!!Bt.extensions;let mu=G1;Bt.toneMapped&&(null===Rr||!0===Rr.isXRRenderTarget)&&(mu=n.toneMapping);const wd={shaderID:ir,shaderType:Bt.type,shaderName:Bt.name,vertexShader:Po,fragmentShader:Ci,defines:Bt.defines,customVertexShaderID:yr,customFragmentShaderID:ps,isRawShaderMaterial:!0===Bt.isRawShaderMaterial,glslVersion:Bt.glslVersion,precision:B,batching:to,batchingColor:to&&null!==ci._colorsTexture,instancing:Gs,instancingColor:Gs&&null!==ci.instanceColor,instancingMorph:Gs&&null!==ci.morphTexture,supportsVertexTextures:T,outputColorSpace:null===Rr?n.outputColorSpace:!0===Rr.isXRRenderTarget?Rr.texture.colorSpace:id,alphaToCoverage:!!Bt.alphaToCoverage,map:lo,matcap:!!Bt.matcap,envMap:bn,envMapMode:bn&&_i.mapping,envMapCubeUVHeight:si,aoMap:Kr,lightMap:Ur,bumpMap:Ss,normalMap:sr,displacementMap:T&&Oo,emissiveMap:xs,normalMapObjectSpace:sr&&1===Bt.normalMapType,normalMapTangentSpace:sr&&0===Bt.normalMapType,metalnessMap:qs,roughnessMap:Bn,anisotropy:zt,anisotropyMap:vs,clearcoat:Ii,clearcoatMap:Vs,clearcoatNormalMap:wa,clearcoatRoughnessMap:qr,dispersion:Bt.dispersion>0,iridescence:hr,iridescenceMap:Os,iridescenceThicknessMap:cl,sheen:_r,sheenColorMap:ha,sheenRoughnessMap:Xs,specularMap:ma,specularColorMap:$a,specularIntensityMap:dh,transmission:Do,transmissionMap:ri,thicknessMap:Jr,gradientMap:!!Bt.gradientMap,opaque:!1===Bt.transparent&&1===Bt.blending&&!1===Bt.alphaToCoverage,alphaMap:Ar,alphaTest:Bt.alphaTest>0,alphaHash:!!Bt.alphaHash,combine:Bt.combine,mapUv:lo&&ne(Bt.map.channel),aoMapUv:Kr&&ne(Bt.aoMap.channel),lightMapUv:Ur&&ne(Bt.lightMap.channel),bumpMapUv:Ss&&ne(Bt.bumpMap.channel),normalMapUv:sr&&ne(Bt.normalMap.channel),displacementMapUv:Oo&&ne(Bt.displacementMap.channel),emissiveMapUv:xs&&ne(Bt.emissiveMap.channel),metalnessMapUv:qs&&ne(Bt.metalnessMap.channel),roughnessMapUv:Bn&&ne(Bt.roughnessMap.channel),anisotropyMapUv:vs&&ne(Bt.anisotropyMap.channel),clearcoatMapUv:Vs&&ne(Bt.clearcoatMap.channel),clearcoatNormalMapUv:wa&&ne(Bt.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:qr&&ne(Bt.clearcoatRoughnessMap.channel),iridescenceMapUv:Os&&ne(Bt.iridescenceMap.channel),iridescenceThicknessMapUv:cl&&ne(Bt.iridescenceThicknessMap.channel),sheenColorMapUv:ha&&ne(Bt.sheenColorMap.channel),sheenRoughnessMapUv:Xs&&ne(Bt.sheenRoughnessMap.channel),specularMapUv:ma&&ne(Bt.specularMap.channel),specularColorMapUv:$a&&ne(Bt.specularColorMap.channel),specularIntensityMapUv:dh&&ne(Bt.specularIntensityMap.channel),transmissionMapUv:ri&&ne(Bt.transmissionMap.channel),thicknessMapUv:Jr&&ne(Bt.thicknessMap.channel),alphaMapUv:Ar&&ne(Bt.alphaMap.channel),vertexTangents:!!bi.attributes.tangent&&(sr||zt),vertexColors:Bt.vertexColors,vertexAlphas:!0===Bt.vertexColors&&!!bi.attributes.color&&4===bi.attributes.color.itemSize,pointsUvs:!0===ci.isPoints&&!!bi.attributes.uv&&(lo||Ar),fog:!!vi,useFog:!0===Bt.fog,fogExp2:!!vi&&vi.isFogExp2,flatShading:!0===Bt.flatShading,sizeAttenuation:!0===Bt.sizeAttenuation,logarithmicDepthBuffer:y,skinning:!0===ci.isSkinnedMesh,morphTargets:void 0!==bi.morphAttributes.position,morphNormals:void 0!==bi.morphAttributes.normal,morphColors:void 0!==bi.morphAttributes.color,morphTargetsCount:Wr,morphTextureStride:so,numDirLights:St.directional.length,numPointLights:St.point.length,numSpotLights:St.spot.length,numSpotLightMaps:St.spotLightMap.length,numRectAreaLights:St.rectArea.length,numHemiLights:St.hemi.length,numDirLightShadows:St.directionalShadowMap.length,numPointLightShadows:St.pointShadowMap.length,numSpotLightShadows:St.spotShadowMap.length,numSpotLightShadowsWithMaps:St.numSpotLightShadowsWithMaps,numLightProbes:St.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:Bt.dithering,shadowMapEnabled:n.shadowMap.enabled&&Dn.length>0,shadowMapType:n.shadowMap.type,toneMapping:mu,decodeVideoTexture:lo&&!0===Bt.map.isVideoTexture&&pl.getTransfer(Bt.map.colorSpace)===Uc,premultipliedAlpha:Bt.premultipliedAlpha,doubleSided:2===Bt.side,flipSided:1===Bt.side,useDepthPacking:Bt.depthPacking>=0,depthPacking:Bt.depthPacking||0,index0AttributeName:Bt.index0AttributeName,extensionClipCullDistance:ml&&!0===Bt.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ml&&!0===Bt.extensions.multiDraw||to)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:Bt.customProgramCacheKey()};return wd.vertexUv1s=u.has(1),wd.vertexUv2s=u.has(2),wd.vertexUv3s=u.has(3),u.clear(),wd},getProgramCacheKey:function le(Bt){const St=[];if(Bt.shaderID?St.push(Bt.shaderID):(St.push(Bt.customVertexShaderID),St.push(Bt.customFragmentShaderID)),void 0!==Bt.defines)for(const Dn in Bt.defines)St.push(Dn),St.push(Bt.defines[Dn]);return!1===Bt.isRawShaderMaterial&&(function Ee(Bt,St){Bt.push(St.precision),Bt.push(St.outputColorSpace),Bt.push(St.envMapMode),Bt.push(St.envMapCubeUVHeight),Bt.push(St.mapUv),Bt.push(St.alphaMapUv),Bt.push(St.lightMapUv),Bt.push(St.aoMapUv),Bt.push(St.bumpMapUv),Bt.push(St.normalMapUv),Bt.push(St.displacementMapUv),Bt.push(St.emissiveMapUv),Bt.push(St.metalnessMapUv),Bt.push(St.roughnessMapUv),Bt.push(St.anisotropyMapUv),Bt.push(St.clearcoatMapUv),Bt.push(St.clearcoatNormalMapUv),Bt.push(St.clearcoatRoughnessMapUv),Bt.push(St.iridescenceMapUv),Bt.push(St.iridescenceThicknessMapUv),Bt.push(St.sheenColorMapUv),Bt.push(St.sheenRoughnessMapUv),Bt.push(St.specularMapUv),Bt.push(St.specularColorMapUv),Bt.push(St.specularIntensityMapUv),Bt.push(St.transmissionMapUv),Bt.push(St.thicknessMapUv),Bt.push(St.combine),Bt.push(St.fogExp2),Bt.push(St.sizeAttenuation),Bt.push(St.morphTargetsCount),Bt.push(St.morphAttributeCount),Bt.push(St.numDirLights),Bt.push(St.numPointLights),Bt.push(St.numSpotLights),Bt.push(St.numSpotLightMaps),Bt.push(St.numHemiLights),Bt.push(St.numRectAreaLights),Bt.push(St.numDirLightShadows),Bt.push(St.numPointLightShadows),Bt.push(St.numSpotLightShadows),Bt.push(St.numSpotLightShadowsWithMaps),Bt.push(St.numLightProbes),Bt.push(St.shadowMapType),Bt.push(St.toneMapping),Bt.push(St.numClippingPlanes),Bt.push(St.numClipIntersection),Bt.push(St.depthPacking)}(St,Bt),function Pe(Bt,St){l.disableAll(),St.supportsVertexTextures&&l.enable(0),St.instancing&&l.enable(1),St.instancingColor&&l.enable(2),St.instancingMorph&&l.enable(3),St.matcap&&l.enable(4),St.envMap&&l.enable(5),St.normalMapObjectSpace&&l.enable(6),St.normalMapTangentSpace&&l.enable(7),St.clearcoat&&l.enable(8),St.iridescence&&l.enable(9),St.alphaTest&&l.enable(10),St.vertexColors&&l.enable(11),St.vertexAlphas&&l.enable(12),St.vertexUv1s&&l.enable(13),St.vertexUv2s&&l.enable(14),St.vertexUv3s&&l.enable(15),St.vertexTangents&&l.enable(16),St.anisotropy&&l.enable(17),St.alphaHash&&l.enable(18),St.batching&&l.enable(19),St.dispersion&&l.enable(20),St.batchingColor&&l.enable(21),Bt.push(l.mask),l.disableAll(),St.fog&&l.enable(0),St.useFog&&l.enable(1),St.flatShading&&l.enable(2),St.logarithmicDepthBuffer&&l.enable(3),St.skinning&&l.enable(4),St.morphTargets&&l.enable(5),St.morphNormals&&l.enable(6),St.morphColors&&l.enable(7),St.premultipliedAlpha&&l.enable(8),St.shadowMapEnabled&&l.enable(9),St.doubleSided&&l.enable(10),St.flipSided&&l.enable(11),St.useDepthPacking&&l.enable(12),St.dithering&&l.enable(13),St.transmission&&l.enable(14),St.sheen&&l.enable(15),St.opaque&&l.enable(16),St.pointsUvs&&l.enable(17),St.decodeVideoTexture&&l.enable(18),St.alphaToCoverage&&l.enable(19),Bt.push(l.mask)}(St,Bt),St.push(n.outputColorSpace)),St.push(Bt.customProgramCacheKey),St.join()},getUniforms:function Ve(Bt){const St=j[Bt.type];let Dn;return Dn=St?u5.clone(P0[St].uniforms):Bt.uniforms,Dn},acquireProgram:function Ft(Bt,St){let Dn;for(let ti=0,ci=f.length;ti<ci;ti++){const vi=f[ti];if(vi.cacheKey===St){Dn=vi,++Dn.usedTimes;break}}return void 0===Dn&&(Dn=new ige(n,St,Bt,s),f.push(Dn)),Dn},releaseProgram:function Ct(Bt){if(0==--Bt.usedTimes){const St=f.indexOf(Bt);f[St]=f[f.length-1],f.pop(),Bt.destroy()}},releaseShaderCache:function Lt(Bt){h.remove(Bt)},programs:f,dispose:function Kt(){h.dispose()}}}function lge(){let n=new WeakMap;return{has:function e(o){return n.has(o)},get:function t(o){let l=n.get(o);return void 0===l&&(l={},n.set(o,l)),l},remove:function i(o){n.delete(o)},update:function r(o,l,h){n.get(o)[l]=h},dispose:function s(){n=new WeakMap}}}function cge(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function vQ(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function bQ(){const n=[];let e=0;const t=[],i=[],r=[];function o(y,T,B,j,ne,se){let le=n[e];return void 0===le?(le={id:y.id,object:y,geometry:T,material:B,groupOrder:j,renderOrder:y.renderOrder,z:ne,group:se},n[e]=le):(le.id=y.id,le.object=y,le.geometry=T,le.material=B,le.groupOrder=j,le.renderOrder=y.renderOrder,le.z=ne,le.group=se),e++,le}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function l(y,T,B,j,ne,se){const le=o(y,T,B,j,ne,se);B.transmission>0?i.push(le):!0===B.transparent?r.push(le):t.push(le)},unshift:function h(y,T,B,j,ne,se){const le=o(y,T,B,j,ne,se);B.transmission>0?i.unshift(le):!0===B.transparent?r.unshift(le):t.unshift(le)},finish:function f(){for(let y=e,T=n.length;y<T;y++){const B=n[y];if(null===B.id)break;B.id=null,B.object=null,B.geometry=null,B.material=null,B.group=null}},sort:function u(y,T){t.length>1&&t.sort(y||cge),i.length>1&&i.sort(T||vQ),r.length>1&&r.sort(T||vQ)}}}function hge(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new bQ,n.set(i,[o])):r>=s.length?(o=new bQ,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function uge(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Dt,color:new nr};break;case"SpotLight":t={position:new Dt,direction:new Dt,color:new nr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Dt,color:new nr,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Dt,skyColor:new nr,groundColor:new nr};break;case"RectAreaLight":t={color:new nr,position:new Dt,halfWidth:new Dt,halfHeight:new Dt}}return n[e.id]=t,t}}}let fge=0;function pge(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function mge(n){const e=new uge,t=function dge(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Fi};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Fi,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new Dt);const r=new Dt,s=new go,o=new go;return{setup:function l(u){let f=0,y=0,T=0;for(let Bt=0;Bt<9;Bt++)i.probe[Bt].set(0,0,0);let B=0,j=0,ne=0,se=0,le=0,Ee=0,Pe=0,Ve=0,Ft=0,Ct=0,Lt=0;u.sort(pge);for(let Bt=0,St=u.length;Bt<St;Bt++){const Dn=u[Bt],ti=Dn.color,ci=Dn.intensity,vi=Dn.distance,bi=Dn.shadow&&Dn.shadow.map?Dn.shadow.map.texture:null;if(Dn.isAmbientLight)f+=ti.r*ci,y+=ti.g*ci,T+=ti.b*ci;else if(Dn.isLightProbe){for(let Un=0;Un<9;Un++)i.probe[Un].addScaledVector(Dn.sh.coefficients[Un],ci);Lt++}else if(Dn.isDirectionalLight){const Un=e.get(Dn);if(Un.color.copy(Dn.color).multiplyScalar(Dn.intensity),Dn.castShadow){const _i=Dn.shadow,si=t.get(Dn);si.shadowIntensity=_i.intensity,si.shadowBias=_i.bias,si.shadowNormalBias=_i.normalBias,si.shadowRadius=_i.radius,si.shadowMapSize=_i.mapSize,i.directionalShadow[B]=si,i.directionalShadowMap[B]=bi,i.directionalShadowMatrix[B]=Dn.shadow.matrix,Ee++}i.directional[B]=Un,B++}else if(Dn.isSpotLight){const Un=e.get(Dn);Un.position.setFromMatrixPosition(Dn.matrixWorld),Un.color.copy(ti).multiplyScalar(ci),Un.distance=vi,Un.coneCos=Math.cos(Dn.angle),Un.penumbraCos=Math.cos(Dn.angle*(1-Dn.penumbra)),Un.decay=Dn.decay,i.spot[ne]=Un;const _i=Dn.shadow;if(Dn.map&&(i.spotLightMap[Ft]=Dn.map,Ft++,_i.updateMatrices(Dn),Dn.castShadow&&Ct++),i.spotLightMatrix[ne]=_i.matrix,Dn.castShadow){const si=t.get(Dn);si.shadowIntensity=_i.intensity,si.shadowBias=_i.bias,si.shadowNormalBias=_i.normalBias,si.shadowRadius=_i.radius,si.shadowMapSize=_i.mapSize,i.spotShadow[ne]=si,i.spotShadowMap[ne]=bi,Ve++}ne++}else if(Dn.isRectAreaLight){const Un=e.get(Dn);Un.color.copy(ti).multiplyScalar(ci),Un.halfWidth.set(.5*Dn.width,0,0),Un.halfHeight.set(0,.5*Dn.height,0),i.rectArea[se]=Un,se++}else if(Dn.isPointLight){const Un=e.get(Dn);if(Un.color.copy(Dn.color).multiplyScalar(Dn.intensity),Un.distance=Dn.distance,Un.decay=Dn.decay,Dn.castShadow){const _i=Dn.shadow,si=t.get(Dn);si.shadowIntensity=_i.intensity,si.shadowBias=_i.bias,si.shadowNormalBias=_i.normalBias,si.shadowRadius=_i.radius,si.shadowMapSize=_i.mapSize,si.shadowCameraNear=_i.camera.near,si.shadowCameraFar=_i.camera.far,i.pointShadow[j]=si,i.pointShadowMap[j]=bi,i.pointShadowMatrix[j]=Dn.shadow.matrix,Pe++}i.point[j]=Un,j++}else if(Dn.isHemisphereLight){const Un=e.get(Dn);Un.skyColor.copy(Dn.color).multiplyScalar(ci),Un.groundColor.copy(Dn.groundColor).multiplyScalar(ci),i.hemi[le]=Un,le++}}se>0&&(!0===n.has("OES_texture_float_linear")?(i.rectAreaLTC1=ys.LTC_FLOAT_1,i.rectAreaLTC2=ys.LTC_FLOAT_2):(i.rectAreaLTC1=ys.LTC_HALF_1,i.rectAreaLTC2=ys.LTC_HALF_2)),i.ambient[0]=f,i.ambient[1]=y,i.ambient[2]=T;const Kt=i.hash;(Kt.directionalLength!==B||Kt.pointLength!==j||Kt.spotLength!==ne||Kt.rectAreaLength!==se||Kt.hemiLength!==le||Kt.numDirectionalShadows!==Ee||Kt.numPointShadows!==Pe||Kt.numSpotShadows!==Ve||Kt.numSpotMaps!==Ft||Kt.numLightProbes!==Lt)&&(i.directional.length=B,i.spot.length=ne,i.rectArea.length=se,i.point.length=j,i.hemi.length=le,i.directionalShadow.length=Ee,i.directionalShadowMap.length=Ee,i.pointShadow.length=Pe,i.pointShadowMap.length=Pe,i.spotShadow.length=Ve,i.spotShadowMap.length=Ve,i.directionalShadowMatrix.length=Ee,i.pointShadowMatrix.length=Pe,i.spotLightMatrix.length=Ve+Ft-Ct,i.spotLightMap.length=Ft,i.numSpotLightShadowsWithMaps=Ct,i.numLightProbes=Lt,Kt.directionalLength=B,Kt.pointLength=j,Kt.spotLength=ne,Kt.rectAreaLength=se,Kt.hemiLength=le,Kt.numDirectionalShadows=Ee,Kt.numPointShadows=Pe,Kt.numSpotShadows=Ve,Kt.numSpotMaps=Ft,Kt.numLightProbes=Lt,i.version=fge++)},setupView:function h(u,f){let y=0,T=0,B=0,j=0,ne=0;const se=f.matrixWorldInverse;for(let le=0,Ee=u.length;le<Ee;le++){const Pe=u[le];if(Pe.isDirectionalLight){const Ve=i.directional[y];Ve.direction.setFromMatrixPosition(Pe.matrixWorld),r.setFromMatrixPosition(Pe.target.matrixWorld),Ve.direction.sub(r),Ve.direction.transformDirection(se),y++}else if(Pe.isSpotLight){const Ve=i.spot[B];Ve.position.setFromMatrixPosition(Pe.matrixWorld),Ve.position.applyMatrix4(se),Ve.direction.setFromMatrixPosition(Pe.matrixWorld),r.setFromMatrixPosition(Pe.target.matrixWorld),Ve.direction.sub(r),Ve.direction.transformDirection(se),B++}else if(Pe.isRectAreaLight){const Ve=i.rectArea[j];Ve.position.setFromMatrixPosition(Pe.matrixWorld),Ve.position.applyMatrix4(se),o.identity(),s.copy(Pe.matrixWorld),s.premultiply(se),o.extractRotation(s),Ve.halfWidth.set(.5*Pe.width,0,0),Ve.halfHeight.set(0,.5*Pe.height,0),Ve.halfWidth.applyMatrix4(o),Ve.halfHeight.applyMatrix4(o),j++}else if(Pe.isPointLight){const Ve=i.point[T];Ve.position.setFromMatrixPosition(Pe.matrixWorld),Ve.position.applyMatrix4(se),T++}else if(Pe.isHemisphereLight){const Ve=i.hemi[ne];Ve.direction.setFromMatrixPosition(Pe.matrixWorld),Ve.direction.transformDirection(se),ne++}}},state:i}}function xQ(n){const e=new mge(n),t=[],i=[],u={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:function r(f){u.camera=f,t.length=0,i.length=0},state:u,setupLights:function l(){e.setup(t)},setupLightsView:function h(f){e.setupView(t,f)},pushLight:function s(f){t.push(f)},pushShadow:function o(f){i.push(f)}}}function Age(n){let e=new WeakMap;return{get:function t(r,s=0){const o=e.get(r);let l;return void 0===o?(l=new xQ(n),e.set(r,[l])):s>=o.length?(l=new xQ(n),o.push(l)):l=o[s],l},dispose:function i(){e=new WeakMap}}}class x5 extends ch{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class wQ extends ch{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function yge(n,e,t){let i=new E4;const r=new Fi,s=new Fi,o=new $l,l=new x5({depthPacking:3201}),h=new wQ,u={},f=t.maxTextureSize,y={[I0]:1,[Ep]:0,[ku]:2},T=new Ou({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Fi},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),B=T.clone();B.defines.HORIZONTAL_PASS=1;const j=new Hs;j.setAttribute("position",new To(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const ne=new jo(j,T),se=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=iq;let le=this.type;function Ee(Ct,Lt){const Kt=e.update(ne);T.defines.VSM_SAMPLES!==Ct.blurSamples&&(T.defines.VSM_SAMPLES=Ct.blurSamples,B.defines.VSM_SAMPLES=Ct.blurSamples,T.needsUpdate=!0,B.needsUpdate=!0),null===Ct.mapPass&&(Ct.mapPass=new rd(r.x,r.y)),T.uniforms.shadow_pass.value=Ct.map.texture,T.uniforms.resolution.value=Ct.mapSize,T.uniforms.radius.value=Ct.radius,n.setRenderTarget(Ct.mapPass),n.clear(),n.renderBufferDirect(Lt,null,Kt,T,ne,null),B.uniforms.shadow_pass.value=Ct.mapPass.texture,B.uniforms.resolution.value=Ct.mapSize,B.uniforms.radius.value=Ct.radius,n.setRenderTarget(Ct.map),n.clear(),n.renderBufferDirect(Lt,null,Kt,B,ne,null)}function Pe(Ct,Lt,Kt,Bt){let St=null;const Dn=!0===Kt.isPointLight?Ct.customDistanceMaterial:Ct.customDepthMaterial;if(void 0!==Dn)St=Dn;else if(St=!0===Kt.isPointLight?h:l,n.localClippingEnabled&&!0===Lt.clipShadows&&Array.isArray(Lt.clippingPlanes)&&0!==Lt.clippingPlanes.length||Lt.displacementMap&&0!==Lt.displacementScale||Lt.alphaMap&&Lt.alphaTest>0||Lt.map&&Lt.alphaTest>0){const ti=St.uuid,ci=Lt.uuid;let vi=u[ti];void 0===vi&&(vi={},u[ti]=vi);let bi=vi[ci];void 0===bi&&(bi=St.clone(),vi[ci]=bi,Lt.addEventListener("dispose",Ft)),St=bi}return St.visible=Lt.visible,St.wireframe=Lt.wireframe,St.side=Bt===W_?null!==Lt.shadowSide?Lt.shadowSide:Lt.side:null!==Lt.shadowSide?Lt.shadowSide:y[Lt.side],St.alphaMap=Lt.alphaMap,St.alphaTest=Lt.alphaTest,St.map=Lt.map,St.clipShadows=Lt.clipShadows,St.clippingPlanes=Lt.clippingPlanes,St.clipIntersection=Lt.clipIntersection,St.displacementMap=Lt.displacementMap,St.displacementScale=Lt.displacementScale,St.displacementBias=Lt.displacementBias,St.wireframeLinewidth=Lt.wireframeLinewidth,St.linewidth=Lt.linewidth,!0===Kt.isPointLight&&!0===St.isMeshDistanceMaterial&&(n.properties.get(St).light=Kt),St}function Ve(Ct,Lt,Kt,Bt,St){if(!1===Ct.visible)return;if(Ct.layers.test(Lt.layers)&&(Ct.isMesh||Ct.isLine||Ct.isPoints)&&(Ct.castShadow||Ct.receiveShadow&&St===W_)&&(!Ct.frustumCulled||i.intersectsObject(Ct))){Ct.modelViewMatrix.multiplyMatrices(Kt.matrixWorldInverse,Ct.matrixWorld);const ci=e.update(Ct),vi=Ct.material;if(Array.isArray(vi)){const bi=ci.groups;for(let Un=0,_i=bi.length;Un<_i;Un++){const si=bi[Un],ir=vi[si.materialIndex];if(ir&&ir.visible){const Nr=Pe(Ct,ir,Bt,St);Ct.onBeforeShadow(n,Ct,Lt,Kt,ci,Nr,si),n.renderBufferDirect(Kt,null,ci,Nr,Ct,si),Ct.onAfterShadow(n,Ct,Lt,Kt,ci,Nr,si)}}}else if(vi.visible){const bi=Pe(Ct,vi,Bt,St);Ct.onBeforeShadow(n,Ct,Lt,Kt,ci,bi,null),n.renderBufferDirect(Kt,null,ci,bi,Ct,null),Ct.onAfterShadow(n,Ct,Lt,Kt,ci,bi,null)}}const ti=Ct.children;for(let ci=0,vi=ti.length;ci<vi;ci++)Ve(ti[ci],Lt,Kt,Bt,St)}function Ft(Ct){Ct.target.removeEventListener("dispose",Ft);for(const Kt in u){const Bt=u[Kt],St=Ct.target.uuid;St in Bt&&(Bt[St].dispose(),delete Bt[St])}}this.render=function(Ct,Lt,Kt){if(!1===se.enabled||!1===se.autoUpdate&&!1===se.needsUpdate||0===Ct.length)return;const Bt=n.getRenderTarget(),St=n.getActiveCubeFace(),Dn=n.getActiveMipmapLevel(),ti=n.state;ti.setBlending(0),ti.buffers.color.setClear(1,1,1,1),ti.buffers.depth.setTest(!0),ti.setScissorTest(!1);const ci=le!==W_&&this.type===W_,vi=le===W_&&this.type!==W_;for(let bi=0,Un=Ct.length;bi<Un;bi++){const _i=Ct[bi],si=_i.shadow;if(void 0===si){console.warn("THREE.WebGLShadowMap:",_i,"has no shadow.");continue}if(!1===si.autoUpdate&&!1===si.needsUpdate)continue;r.copy(si.mapSize);const ir=si.getFrameExtents();if(r.multiply(ir),s.copy(si.mapSize),(r.x>f||r.y>f)&&(r.x>f&&(s.x=Math.floor(f/ir.x),r.x=s.x*ir.x,si.mapSize.x=s.x),r.y>f&&(s.y=Math.floor(f/ir.y),r.y=s.y*ir.y,si.mapSize.y=s.y)),null===si.map||!0===ci||!0===vi){const Wr=this.type!==W_?{minFilter:Fu,magFilter:Fu}:{};null!==si.map&&si.map.dispose(),si.map=new rd(r.x,r.y,Wr),si.map.texture.name=_i.name+".shadowMap",si.camera.updateProjectionMatrix()}n.setRenderTarget(si.map),n.clear();const Nr=si.getViewportCount();for(let Wr=0;Wr<Nr;Wr++){const so=si.getViewport(Wr);o.set(s.x*so.x,s.y*so.y,s.x*so.z,s.y*so.w),ti.viewport(o),si.updateMatrices(_i,Wr),i=si.getFrustum(),Ve(Lt,Kt,si.camera,_i,this.type)}!0!==si.isPointLightShadow&&this.type===W_&&Ee(si,Kt),si.needsUpdate=!1}le=this.type,se.needsUpdate=!1,n.setRenderTarget(Bt,St,Dn)}}function vge(n){const r=new function e(){let ri=!1;const Jr=new $l;let or=null;const Ar=new $l(0,0,0,0);return{setMask:function(hs){or!==hs&&!ri&&(n.colorMask(hs,hs,hs,hs),or=hs)},setLocked:function(hs){ri=hs},setClear:function(hs,Ko,ml,mu,wd){!0===wd&&(hs*=mu,Ko*=mu,ml*=mu),Jr.set(hs,Ko,ml,mu),!1===Ar.equals(Jr)&&(n.clearColor(hs,Ko,ml,mu),Ar.copy(Jr))},reset:function(){ri=!1,or=null,Ar.set(-1,0,0,0)}}},s=new function t(){let ri=!1,Jr=null,or=null,Ar=null;return{setTest:function(hs){hs?ps(n.DEPTH_TEST):Rr(n.DEPTH_TEST)},setMask:function(hs){Jr!==hs&&!ri&&(n.depthMask(hs),Jr=hs)},setFunc:function(hs){if(or!==hs){switch(hs){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}or=hs}},setLocked:function(hs){ri=hs},setClear:function(hs){Ar!==hs&&(n.clearDepth(hs),Ar=hs)},reset:function(){ri=!1,Jr=null,or=null,Ar=null}}},o=new function i(){let ri=!1,Jr=null,or=null,Ar=null,hs=null,Ko=null,ml=null,mu=null,wd=null;return{setTest:function(Ol){ri||(Ol?ps(n.STENCIL_TEST):Rr(n.STENCIL_TEST))},setMask:function(Ol){Jr!==Ol&&!ri&&(n.stencilMask(Ol),Jr=Ol)},setFunc:function(Ol,gy,V0){(or!==Ol||Ar!==gy||hs!==V0)&&(n.stencilFunc(Ol,gy,V0),or=Ol,Ar=gy,hs=V0)},setOp:function(Ol,gy,V0){(Ko!==Ol||ml!==gy||mu!==V0)&&(n.stencilOp(Ol,gy,V0),Ko=Ol,ml=gy,mu=V0)},setLocked:function(Ol){ri=Ol},setClear:function(Ol){wd!==Ol&&(n.clearStencil(Ol),wd=Ol)},reset:function(){ri=!1,Jr=null,or=null,Ar=null,hs=null,Ko=null,ml=null,mu=null,wd=null}}},l=new WeakMap,h=new WeakMap;let u={},f={},y=new WeakMap,T=[],B=null,j=!1,ne=null,se=null,le=null,Ee=null,Pe=null,Ve=null,Ft=null,Ct=new nr(0,0,0),Lt=0,Kt=!1,Bt=null,St=null,Dn=null,ti=null,ci=null;const vi=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let bi=!1,Un=0;const _i=n.getParameter(n.VERSION);-1!==_i.indexOf("WebGL")?(Un=parseFloat(/^WebGL (\d)/.exec(_i)[1]),bi=Un>=1):-1!==_i.indexOf("OpenGL ES")&&(Un=parseFloat(/^OpenGL ES (\d)/.exec(_i)[1]),bi=Un>=2);let si=null,ir={};const Nr=n.getParameter(n.SCISSOR_BOX),Wr=n.getParameter(n.VIEWPORT),so=(new $l).fromArray(Nr),Po=(new $l).fromArray(Wr);function Ci(ri,Jr,or,Ar){const hs=new Uint8Array(4),Ko=n.createTexture();n.bindTexture(ri,Ko),n.texParameteri(ri,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(ri,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let ml=0;ml<or;ml++)ri===n.TEXTURE_3D||ri===n.TEXTURE_2D_ARRAY?n.texImage3D(Jr,0,n.RGBA,1,1,Ar,0,n.RGBA,n.UNSIGNED_BYTE,hs):n.texImage2D(Jr+ml,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,hs);return Ko}const yr={};function ps(ri){!0!==u[ri]&&(n.enable(ri),u[ri]=!0)}function Rr(ri){!1!==u[ri]&&(n.disable(ri),u[ri]=!1)}yr[n.TEXTURE_2D]=Ci(n.TEXTURE_2D,n.TEXTURE_2D,1),yr[n.TEXTURE_CUBE_MAP]=Ci(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),yr[n.TEXTURE_2D_ARRAY]=Ci(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),yr[n.TEXTURE_3D]=Ci(n.TEXTURE_3D,n.TEXTURE_3D,1,1),r.setClear(0,0,0,1),s.setClear(1),o.setClear(0),ps(n.DEPTH_TEST),s.setFunc(3),Ss(!1),sr(1),ps(n.CULL_FACE),Kr(0);const La={[Vb]:n.FUNC_ADD,[Yue]:n.FUNC_SUBTRACT,[Kue]:n.FUNC_REVERSE_SUBTRACT};La[103]=n.MIN,La[104]=n.MAX;const bn={[ede]:n.ZERO,[tde]:n.ONE,[nde]:n.SRC_COLOR,[sO]:n.SRC_ALPHA,[lde]:n.SRC_ALPHA_SATURATE,[ode]:n.DST_COLOR,[rde]:n.DST_ALPHA,[ide]:n.ONE_MINUS_SRC_COLOR,[oO]:n.ONE_MINUS_SRC_ALPHA,[ade]:n.ONE_MINUS_DST_COLOR,[sde]:n.ONE_MINUS_DST_ALPHA,[cde]:n.CONSTANT_COLOR,[hde]:n.ONE_MINUS_CONSTANT_COLOR,[ude]:n.CONSTANT_ALPHA,[dde]:n.ONE_MINUS_CONSTANT_ALPHA};function Kr(ri,Jr,or,Ar,hs,Ko,ml,mu,wd,Ol){if(0!==ri){if(!1===j&&(ps(n.BLEND),j=!0),5===ri)hs=hs||Jr,Ko=Ko||or,ml=ml||Ar,(Jr!==se||hs!==Pe)&&(n.blendEquationSeparate(La[Jr],La[hs]),se=Jr,Pe=hs),(or!==le||Ar!==Ee||Ko!==Ve||ml!==Ft)&&(n.blendFuncSeparate(bn[or],bn[Ar],bn[Ko],bn[ml]),le=or,Ee=Ar,Ve=Ko,Ft=ml),(!1===mu.equals(Ct)||wd!==Lt)&&(n.blendColor(mu.r,mu.g,mu.b,wd),Ct.copy(mu),Lt=wd),ne=ri,Kt=!1;else if(ri!==ne||Ol!==Kt){if((100!==se||100!==Pe)&&(n.blendEquation(n.FUNC_ADD),se=100,Pe=100),Ol)switch(ri){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ri)}else switch(ri){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ri)}le=null,Ee=null,Ve=null,Ft=null,Ct.set(0,0,0),Lt=0,ne=ri,Kt=Ol}}else!0===j&&(Rr(n.BLEND),j=!1)}function Ss(ri){Bt!==ri&&(n.frontFace(ri?n.CW:n.CCW),Bt=ri)}function sr(ri){0!==ri?(ps(n.CULL_FACE),ri!==St&&n.cullFace(1===ri?n.BACK:2===ri?n.FRONT:n.FRONT_AND_BACK)):Rr(n.CULL_FACE),St=ri}function xs(ri,Jr,or){ri?(ps(n.POLYGON_OFFSET_FILL),(ti!==Jr||ci!==or)&&(n.polygonOffset(Jr,or),ti=Jr,ci=or)):Rr(n.POLYGON_OFFSET_FILL)}return{buffers:{color:r,depth:s,stencil:o},enable:ps,disable:Rr,bindFramebuffer:function Gs(ri,Jr){return f[ri]!==Jr&&(n.bindFramebuffer(ri,Jr),f[ri]=Jr,ri===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=Jr),ri===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=Jr),!0)},drawBuffers:function to(ri,Jr){let or=T,Ar=!1;if(ri){or=y.get(Jr),void 0===or&&(or=[],y.set(Jr,or));const hs=ri.textures;if(or.length!==hs.length||or[0]!==n.COLOR_ATTACHMENT0){for(let Ko=0,ml=hs.length;Ko<ml;Ko++)or[Ko]=n.COLOR_ATTACHMENT0+Ko;or.length=hs.length,Ar=!0}}else or[0]!==n.BACK&&(or[0]=n.BACK,Ar=!0);Ar&&n.drawBuffers(or)},useProgram:function lo(ri){return B!==ri&&(n.useProgram(ri),B=ri,!0)},setBlending:Kr,setMaterial:function Ur(ri,Jr){2===ri.side?Rr(n.CULL_FACE):ps(n.CULL_FACE);let or=1===ri.side;Jr&&(or=!or),Ss(or),1===ri.blending&&!1===ri.transparent?Kr(0):Kr(ri.blending,ri.blendEquation,ri.blendSrc,ri.blendDst,ri.blendEquationAlpha,ri.blendSrcAlpha,ri.blendDstAlpha,ri.blendColor,ri.blendAlpha,ri.premultipliedAlpha),s.setFunc(ri.depthFunc),s.setTest(ri.depthTest),s.setMask(ri.depthWrite),r.setMask(ri.colorWrite);const Ar=ri.stencilWrite;o.setTest(Ar),Ar&&(o.setMask(ri.stencilWriteMask),o.setFunc(ri.stencilFunc,ri.stencilRef,ri.stencilFuncMask),o.setOp(ri.stencilFail,ri.stencilZFail,ri.stencilZPass)),xs(ri.polygonOffset,ri.polygonOffsetFactor,ri.polygonOffsetUnits),!0===ri.alphaToCoverage?ps(n.SAMPLE_ALPHA_TO_COVERAGE):Rr(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Ss,setCullFace:sr,setLineWidth:function Oo(ri){ri!==Dn&&(bi&&n.lineWidth(ri),Dn=ri)},setPolygonOffset:xs,setScissorTest:function qs(ri){ri?ps(n.SCISSOR_TEST):Rr(n.SCISSOR_TEST)},activeTexture:function Bn(ri){void 0===ri&&(ri=n.TEXTURE0+vi-1),si!==ri&&(n.activeTexture(ri),si=ri)},bindTexture:function zt(ri,Jr,or){void 0===or&&(or=null===si?n.TEXTURE0+vi-1:si);let Ar=ir[or];void 0===Ar&&(Ar={type:void 0,texture:void 0},ir[or]=Ar),(Ar.type!==ri||Ar.texture!==Jr)&&(si!==or&&(n.activeTexture(or),si=or),n.bindTexture(ri,Jr||yr[ri]),Ar.type=ri,Ar.texture=Jr)},unbindTexture:function Ii(){const ri=ir[si];void 0!==ri&&void 0!==ri.type&&(n.bindTexture(ri.type,null),ri.type=void 0,ri.texture=void 0)},compressedTexImage2D:function ur(){try{n.compressedTexImage2D.apply(n,arguments)}catch(ri){console.error("THREE.WebGLState:",ri)}},compressedTexImage3D:function hr(){try{n.compressedTexImage3D.apply(n,arguments)}catch(ri){console.error("THREE.WebGLState:",ri)}},texImage2D:function Os(){try{n.texImage2D.apply(n,arguments)}catch(ri){console.error("THREE.WebGLState:",ri)}},texImage3D:function cl(){try{n.texImage3D.apply(n,arguments)}catch(ri){console.error("THREE.WebGLState:",ri)}},updateUBOMapping:function ma(ri,Jr){let or=h.get(Jr);void 0===or&&(or=new WeakMap,h.set(Jr,or));let Ar=or.get(ri);void 0===Ar&&(Ar=n.getUniformBlockIndex(Jr,ri.name),or.set(ri,Ar))},uniformBlockBinding:function $a(ri,Jr){const Ar=h.get(Jr).get(ri);l.get(Jr)!==Ar&&(n.uniformBlockBinding(Jr,Ar,ri.__bindingPointIndex),l.set(Jr,Ar))},texStorage2D:function wa(){try{n.texStorage2D.apply(n,arguments)}catch(ri){console.error("THREE.WebGLState:",ri)}},texStorage3D:function qr(){try{n.texStorage3D.apply(n,arguments)}catch(ri){console.error("THREE.WebGLState:",ri)}},texSubImage2D:function _r(){try{n.texSubImage2D.apply(n,arguments)}catch(ri){console.error("THREE.WebGLState:",ri)}},texSubImage3D:function Do(){try{n.texSubImage3D.apply(n,arguments)}catch(ri){console.error("THREE.WebGLState:",ri)}},compressedTexSubImage2D:function vs(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(ri){console.error("THREE.WebGLState:",ri)}},compressedTexSubImage3D:function Vs(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(ri){console.error("THREE.WebGLState:",ri)}},scissor:function ha(ri){!1===so.equals(ri)&&(n.scissor(ri.x,ri.y,ri.z,ri.w),so.copy(ri))},viewport:function Xs(ri){!1===Po.equals(ri)&&(n.viewport(ri.x,ri.y,ri.z,ri.w),Po.copy(ri))},reset:function dh(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),u={},si=null,ir={},f={},y=new WeakMap,T=[],B=null,j=!1,ne=null,se=null,le=null,Ee=null,Pe=null,Ve=null,Ft=null,Ct=new nr(0,0,0),Lt=0,Kt=!1,Bt=null,St=null,Dn=null,ti=null,ci=null,so.set(0,0,n.canvas.width,n.canvas.height),Po.set(0,0,n.canvas.width,n.canvas.height),r.reset(),s.reset(),o.reset()}}}function w5(n,e,t,i){const r=function Cge(n){switch(n){case $_:case aq:return{byteLength:1,components:1};case TS:case lq:case wA:return{byteLength:2,components:1};case cO:case hO:return{byteLength:2,components:4};case j1:case lO:case ym:return{byteLength:4,components:1};case cq:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}(i);switch(t){case hq:case dq:return n*e;case fq:return n*e*2;case uO:case WI:return n*e/r.components*r.byteLength;case pq:case dO:return n*e*2/r.components*r.byteLength;case uq:return n*e*3/r.components*r.byteLength;case Hf:case fO:return n*e*4/r.components*r.byteLength;case $I:case XI:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case YI:case KI:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case mO:case gO:return Math.max(n,16)*Math.max(e,8)/4;case pO:case AO:return Math.max(n,8)*Math.max(e,8)/2;case _O:case yO:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case vO:case bO:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case xO:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case wO:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case CO:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case MO:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case EO:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case SO:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case TO:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case DO:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case IO:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case BO:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case PO:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case RO:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case kO:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case ZI:case FO:case OO:return Math.ceil(n/4)*Math.ceil(e/4)*16;case mq:case LO:return Math.ceil(n/4)*Math.ceil(e/4)*8;case NO:case UO:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Mge(n,e,t,i,r,s,o){const l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),u=new Fi,f=new WeakMap;let y;const T=new WeakMap;let B=!1;try{B=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function j(Bn,zt){return B?new OffscreenCanvas(Bn,zt):BS("canvas")}function ne(Bn,zt,Ii){let ur=1;const hr=qs(Bn);if((hr.width>Ii||hr.height>Ii)&&(ur=Ii/Math.max(hr.width,hr.height)),ur<1){if(typeof HTMLImageElement<"u"&&Bn instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Bn instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Bn instanceof ImageBitmap||typeof VideoFrame<"u"&&Bn instanceof VideoFrame){const _r=Math.floor(ur*hr.width),Do=Math.floor(ur*hr.height);void 0===y&&(y=j(_r,Do));const vs=zt?j(_r,Do):y;return vs.width=_r,vs.height=Do,vs.getContext("2d").drawImage(Bn,0,0,_r,Do),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+hr.width+"x"+hr.height+") to ("+_r+"x"+Do+")."),vs}return"data"in Bn&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+hr.width+"x"+hr.height+")."),Bn}return Bn}function se(Bn){return Bn.generateMipmaps&&Bn.minFilter!==Fu&&Bn.minFilter!==bh}function le(Bn){n.generateMipmap(Bn)}function Ee(Bn,zt,Ii,ur,hr=!1){if(null!==Bn){if(void 0!==n[Bn])return n[Bn];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Bn+"'")}let _r=zt;if(zt===n.RED&&(Ii===n.FLOAT&&(_r=n.R32F),Ii===n.HALF_FLOAT&&(_r=n.R16F),Ii===n.UNSIGNED_BYTE&&(_r=n.R8)),zt===n.RED_INTEGER&&(Ii===n.UNSIGNED_BYTE&&(_r=n.R8UI),Ii===n.UNSIGNED_SHORT&&(_r=n.R16UI),Ii===n.UNSIGNED_INT&&(_r=n.R32UI),Ii===n.BYTE&&(_r=n.R8I),Ii===n.SHORT&&(_r=n.R16I),Ii===n.INT&&(_r=n.R32I)),zt===n.RG&&(Ii===n.FLOAT&&(_r=n.RG32F),Ii===n.HALF_FLOAT&&(_r=n.RG16F),Ii===n.UNSIGNED_BYTE&&(_r=n.RG8)),zt===n.RG_INTEGER&&(Ii===n.UNSIGNED_BYTE&&(_r=n.RG8UI),Ii===n.UNSIGNED_SHORT&&(_r=n.RG16UI),Ii===n.UNSIGNED_INT&&(_r=n.RG32UI),Ii===n.BYTE&&(_r=n.RG8I),Ii===n.SHORT&&(_r=n.RG16I),Ii===n.INT&&(_r=n.RG32I)),zt===n.RGB&&Ii===n.UNSIGNED_INT_5_9_9_9_REV&&(_r=n.RGB9_E5),zt===n.RGBA){const Do=hr?t4:pl.getTransfer(ur);Ii===n.FLOAT&&(_r=n.RGBA32F),Ii===n.HALF_FLOAT&&(_r=n.RGBA16F),Ii===n.UNSIGNED_BYTE&&(_r=Do===Uc?n.SRGB8_ALPHA8:n.RGBA8),Ii===n.UNSIGNED_SHORT_4_4_4_4&&(_r=n.RGBA4),Ii===n.UNSIGNED_SHORT_5_5_5_1&&(_r=n.RGB5_A1)}return(_r===n.R16F||_r===n.R32F||_r===n.RG16F||_r===n.RG32F||_r===n.RGBA16F||_r===n.RGBA32F)&&e.get("EXT_color_buffer_float"),_r}function Pe(Bn,zt){let Ii;return Bn?null===zt||zt===j1||zt===Y2?Ii=n.DEPTH24_STENCIL8:zt===ym?Ii=n.DEPTH32F_STENCIL8:zt===TS&&(Ii=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===zt||zt===j1||zt===Y2?Ii=n.DEPTH_COMPONENT24:zt===ym?Ii=n.DEPTH_COMPONENT32F:zt===TS&&(Ii=n.DEPTH_COMPONENT16),Ii}function Ve(Bn,zt){return!0===se(Bn)||Bn.isFramebufferTexture&&Bn.minFilter!==Fu&&Bn.minFilter!==bh?Math.log2(Math.max(zt.width,zt.height))+1:void 0!==Bn.mipmaps&&Bn.mipmaps.length>0?Bn.mipmaps.length:Bn.isCompressedTexture&&Array.isArray(Bn.image)?zt.mipmaps.length:1}function Ft(Bn){const zt=Bn.target;zt.removeEventListener("dispose",Ft),function Lt(Bn){const zt=i.get(Bn);if(void 0===zt.__webglInit)return;const Ii=Bn.source,ur=T.get(Ii);if(ur){const hr=ur[zt.__cacheKey];hr.usedTimes--,0===hr.usedTimes&&Kt(Bn),0===Object.keys(ur).length&&T.delete(Ii)}i.remove(Bn)}(zt),zt.isVideoTexture&&f.delete(zt)}function Ct(Bn){const zt=Bn.target;zt.removeEventListener("dispose",Ct),function Bt(Bn){const zt=i.get(Bn);if(Bn.depthTexture&&Bn.depthTexture.dispose(),Bn.isWebGLCubeRenderTarget)for(let ur=0;ur<6;ur++){if(Array.isArray(zt.__webglFramebuffer[ur]))for(let hr=0;hr<zt.__webglFramebuffer[ur].length;hr++)n.deleteFramebuffer(zt.__webglFramebuffer[ur][hr]);else n.deleteFramebuffer(zt.__webglFramebuffer[ur]);zt.__webglDepthbuffer&&n.deleteRenderbuffer(zt.__webglDepthbuffer[ur])}else{if(Array.isArray(zt.__webglFramebuffer))for(let ur=0;ur<zt.__webglFramebuffer.length;ur++)n.deleteFramebuffer(zt.__webglFramebuffer[ur]);else n.deleteFramebuffer(zt.__webglFramebuffer);if(zt.__webglDepthbuffer&&n.deleteRenderbuffer(zt.__webglDepthbuffer),zt.__webglMultisampledFramebuffer&&n.deleteFramebuffer(zt.__webglMultisampledFramebuffer),zt.__webglColorRenderbuffer)for(let ur=0;ur<zt.__webglColorRenderbuffer.length;ur++)zt.__webglColorRenderbuffer[ur]&&n.deleteRenderbuffer(zt.__webglColorRenderbuffer[ur]);zt.__webglDepthRenderbuffer&&n.deleteRenderbuffer(zt.__webglDepthRenderbuffer)}const Ii=Bn.textures;for(let ur=0,hr=Ii.length;ur<hr;ur++){const _r=i.get(Ii[ur]);_r.__webglTexture&&(n.deleteTexture(_r.__webglTexture),o.memory.textures--),i.remove(Ii[ur])}i.remove(Bn)}(zt)}function Kt(Bn){const zt=i.get(Bn);n.deleteTexture(zt.__webglTexture),delete T.get(Bn.source)[zt.__cacheKey],o.memory.textures--}let St=0;function vi(Bn,zt){const Ii=i.get(Bn);if(Bn.isVideoTexture&&function Oo(Bn){const zt=o.render.frame;f.get(Bn)!==zt&&(f.set(Bn,zt),Bn.update())}(Bn),!1===Bn.isRenderTargetTexture&&Bn.version>0&&Ii.__version!==Bn.version){const ur=Bn.image;if(null===ur)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==ur.complete)return void Po(Ii,Bn,zt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,Ii.__webglTexture,n.TEXTURE0+zt)}const si={[Q1]:n.REPEAT,[_m]:n.CLAMP_TO_EDGE,[$2]:n.MIRRORED_REPEAT},ir={[Fu]:n.NEAREST,[jI]:n.NEAREST_MIPMAP_NEAREST,[qb]:n.NEAREST_MIPMAP_LINEAR,[bh]:n.LINEAR,[X2]:n.LINEAR_MIPMAP_NEAREST,[xA]:n.LINEAR_MIPMAP_LINEAR},Nr={[Ode]:n.NEVER,[Vde]:n.ALWAYS,[Lde]:n.LESS,[vq]:n.LEQUAL,[Nde]:n.EQUAL,[Hde]:n.GEQUAL,[Ude]:n.GREATER,[zde]:n.NOTEQUAL};function Wr(Bn,zt){if(zt.type===ym&&!1===e.has("OES_texture_float_linear")&&(zt.magFilter===bh||zt.magFilter===X2||zt.magFilter===qb||zt.magFilter===xA||zt.minFilter===bh||zt.minFilter===X2||zt.minFilter===qb||zt.minFilter===xA)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(Bn,n.TEXTURE_WRAP_S,si[zt.wrapS]),n.texParameteri(Bn,n.TEXTURE_WRAP_T,si[zt.wrapT]),(Bn===n.TEXTURE_3D||Bn===n.TEXTURE_2D_ARRAY)&&n.texParameteri(Bn,n.TEXTURE_WRAP_R,si[zt.wrapR]),n.texParameteri(Bn,n.TEXTURE_MAG_FILTER,ir[zt.magFilter]),n.texParameteri(Bn,n.TEXTURE_MIN_FILTER,ir[zt.minFilter]),zt.compareFunction&&(n.texParameteri(Bn,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(Bn,n.TEXTURE_COMPARE_FUNC,Nr[zt.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){if(zt.magFilter===Fu||zt.minFilter!==qb&&zt.minFilter!==xA||zt.type===ym&&!1===e.has("OES_texture_float_linear"))return;if(zt.anisotropy>1||i.get(zt).__currentAnisotropy){const Ii=e.get("EXT_texture_filter_anisotropic");n.texParameterf(Bn,Ii.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(zt.anisotropy,r.getMaxAnisotropy())),i.get(zt).__currentAnisotropy=zt.anisotropy}}}function so(Bn,zt){let Ii=!1;void 0===Bn.__webglInit&&(Bn.__webglInit=!0,zt.addEventListener("dispose",Ft));const ur=zt.source;let hr=T.get(ur);void 0===hr&&(hr={},T.set(ur,hr));const _r=function ci(Bn){const zt=[];return zt.push(Bn.wrapS),zt.push(Bn.wrapT),zt.push(Bn.wrapR||0),zt.push(Bn.magFilter),zt.push(Bn.minFilter),zt.push(Bn.anisotropy),zt.push(Bn.internalFormat),zt.push(Bn.format),zt.push(Bn.type),zt.push(Bn.generateMipmaps),zt.push(Bn.premultiplyAlpha),zt.push(Bn.flipY),zt.push(Bn.unpackAlignment),zt.push(Bn.colorSpace),zt.join()}(zt);if(_r!==Bn.__cacheKey){void 0===hr[_r]&&(hr[_r]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,Ii=!0),hr[_r].usedTimes++;const Do=hr[Bn.__cacheKey];void 0!==Do&&(hr[Bn.__cacheKey].usedTimes--,0===Do.usedTimes&&Kt(zt)),Bn.__cacheKey=_r,Bn.__webglTexture=hr[_r].texture}return Ii}function Po(Bn,zt,Ii){let ur=n.TEXTURE_2D;(zt.isDataArrayTexture||zt.isCompressedArrayTexture)&&(ur=n.TEXTURE_2D_ARRAY),zt.isData3DTexture&&(ur=n.TEXTURE_3D);const hr=so(Bn,zt),_r=zt.source;t.bindTexture(ur,Bn.__webglTexture,n.TEXTURE0+Ii);const Do=i.get(_r);if(_r.version!==Do.__version||!0===hr){t.activeTexture(n.TEXTURE0+Ii);const vs=pl.getPrimaries(pl.workingColorSpace),Vs=""===zt.colorSpace?null:pl.getPrimaries(zt.colorSpace),wa=""===zt.colorSpace||vs===Vs?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,zt.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,zt.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,zt.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,wa);let qr=ne(zt.image,!1,r.maxTextureSize);qr=xs(zt,qr);const Os=s.convert(zt.format,zt.colorSpace),cl=s.convert(zt.type);let Xs,ha=Ee(zt.internalFormat,Os,cl,zt.colorSpace,zt.isVideoTexture);Wr(ur,zt);const ma=zt.mipmaps,$a=!0!==zt.isVideoTexture,dh=void 0===Do.__version||!0===hr,ri=_r.dataReady,Jr=Ve(zt,qr);if(zt.isDepthTexture)ha=Pe(zt.format===Z2,zt.type),dh&&($a?t.texStorage2D(n.TEXTURE_2D,1,ha,qr.width,qr.height):t.texImage2D(n.TEXTURE_2D,0,ha,qr.width,qr.height,0,Os,cl,null));else if(zt.isDataTexture)if(ma.length>0){$a&&dh&&t.texStorage2D(n.TEXTURE_2D,Jr,ha,ma[0].width,ma[0].height);for(let or=0,Ar=ma.length;or<Ar;or++)Xs=ma[or],$a?ri&&t.texSubImage2D(n.TEXTURE_2D,or,0,0,Xs.width,Xs.height,Os,cl,Xs.data):t.texImage2D(n.TEXTURE_2D,or,ha,Xs.width,Xs.height,0,Os,cl,Xs.data);zt.generateMipmaps=!1}else $a?(dh&&t.texStorage2D(n.TEXTURE_2D,Jr,ha,qr.width,qr.height),ri&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,qr.width,qr.height,Os,cl,qr.data)):t.texImage2D(n.TEXTURE_2D,0,ha,qr.width,qr.height,0,Os,cl,qr.data);else if(zt.isCompressedTexture)if(zt.isCompressedArrayTexture){$a&&dh&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Jr,ha,ma[0].width,ma[0].height,qr.depth);for(let or=0,Ar=ma.length;or<Ar;or++)if(Xs=ma[or],zt.format!==Hf)if(null!==Os)if($a){if(ri)if(zt.layerUpdates.size>0){const hs=w5(Xs.width,Xs.height,zt.format,zt.type);for(const Ko of zt.layerUpdates){const ml=Xs.data.subarray(Ko*hs/Xs.data.BYTES_PER_ELEMENT,(Ko+1)*hs/Xs.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,or,0,0,Ko,Xs.width,Xs.height,1,Os,ml,0,0)}zt.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,or,0,0,0,Xs.width,Xs.height,qr.depth,Os,Xs.data,0,0)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,or,ha,Xs.width,Xs.height,qr.depth,0,Xs.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else $a?ri&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,or,0,0,0,Xs.width,Xs.height,qr.depth,Os,cl,Xs.data):t.texImage3D(n.TEXTURE_2D_ARRAY,or,ha,Xs.width,Xs.height,qr.depth,0,Os,cl,Xs.data)}else{$a&&dh&&t.texStorage2D(n.TEXTURE_2D,Jr,ha,ma[0].width,ma[0].height);for(let or=0,Ar=ma.length;or<Ar;or++)Xs=ma[or],zt.format!==Hf?null!==Os?$a?ri&&t.compressedTexSubImage2D(n.TEXTURE_2D,or,0,0,Xs.width,Xs.height,Os,Xs.data):t.compressedTexImage2D(n.TEXTURE_2D,or,ha,Xs.width,Xs.height,0,Xs.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):$a?ri&&t.texSubImage2D(n.TEXTURE_2D,or,0,0,Xs.width,Xs.height,Os,cl,Xs.data):t.texImage2D(n.TEXTURE_2D,or,ha,Xs.width,Xs.height,0,Os,cl,Xs.data)}else if(zt.isDataArrayTexture)if($a){if(dh&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Jr,ha,qr.width,qr.height,qr.depth),ri)if(zt.layerUpdates.size>0){const or=w5(qr.width,qr.height,zt.format,zt.type);for(const Ar of zt.layerUpdates){const hs=qr.data.subarray(Ar*or/qr.data.BYTES_PER_ELEMENT,(Ar+1)*or/qr.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,Ar,qr.width,qr.height,1,Os,cl,hs)}zt.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,qr.width,qr.height,qr.depth,Os,cl,qr.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,ha,qr.width,qr.height,qr.depth,0,Os,cl,qr.data);else if(zt.isData3DTexture)$a?(dh&&t.texStorage3D(n.TEXTURE_3D,Jr,ha,qr.width,qr.height,qr.depth),ri&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,qr.width,qr.height,qr.depth,Os,cl,qr.data)):t.texImage3D(n.TEXTURE_3D,0,ha,qr.width,qr.height,qr.depth,0,Os,cl,qr.data);else if(zt.isFramebufferTexture){if(dh)if($a)t.texStorage2D(n.TEXTURE_2D,Jr,ha,qr.width,qr.height);else{let or=qr.width,Ar=qr.height;for(let hs=0;hs<Jr;hs++)t.texImage2D(n.TEXTURE_2D,hs,ha,or,Ar,0,Os,cl,null),or>>=1,Ar>>=1}}else if(ma.length>0){if($a&&dh){const or=qs(ma[0]);t.texStorage2D(n.TEXTURE_2D,Jr,ha,or.width,or.height)}for(let or=0,Ar=ma.length;or<Ar;or++)Xs=ma[or],$a?ri&&t.texSubImage2D(n.TEXTURE_2D,or,0,0,Os,cl,Xs):t.texImage2D(n.TEXTURE_2D,or,ha,Os,cl,Xs);zt.generateMipmaps=!1}else if($a){if(dh){const or=qs(qr);t.texStorage2D(n.TEXTURE_2D,Jr,ha,or.width,or.height)}ri&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Os,cl,qr)}else t.texImage2D(n.TEXTURE_2D,0,ha,Os,cl,qr);se(zt)&&le(ur),Do.__version=_r.version,zt.onUpdate&&zt.onUpdate(zt)}Bn.__version=zt.version}function yr(Bn,zt,Ii,ur,hr,_r){const Do=s.convert(Ii.format,Ii.colorSpace),vs=s.convert(Ii.type),Vs=Ee(Ii.internalFormat,Do,vs,Ii.colorSpace);if(!i.get(zt).__hasExternalTextures){const qr=Math.max(1,zt.width>>_r),Os=Math.max(1,zt.height>>_r);hr===n.TEXTURE_3D||hr===n.TEXTURE_2D_ARRAY?t.texImage3D(hr,_r,Vs,qr,Os,zt.depth,0,Do,vs,null):t.texImage2D(hr,_r,Vs,qr,Os,0,Do,vs,null)}t.bindFramebuffer(n.FRAMEBUFFER,Bn),sr(zt)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ur,hr,i.get(Ii).__webglTexture,0,Ss(zt)):(hr===n.TEXTURE_2D||hr>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&hr<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,ur,hr,i.get(Ii).__webglTexture,_r),t.bindFramebuffer(n.FRAMEBUFFER,null)}function ps(Bn,zt,Ii){if(n.bindRenderbuffer(n.RENDERBUFFER,Bn),zt.depthBuffer){const ur=zt.depthTexture,_r=Pe(zt.stencilBuffer,ur&&ur.isDepthTexture?ur.type:null),Do=zt.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,vs=Ss(zt);sr(zt)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,vs,_r,zt.width,zt.height):Ii?n.renderbufferStorageMultisample(n.RENDERBUFFER,vs,_r,zt.width,zt.height):n.renderbufferStorage(n.RENDERBUFFER,_r,zt.width,zt.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,Do,n.RENDERBUFFER,Bn)}else{const ur=zt.textures;for(let hr=0;hr<ur.length;hr++){const _r=ur[hr],Do=s.convert(_r.format,_r.colorSpace),vs=s.convert(_r.type),Vs=Ee(_r.internalFormat,Do,vs,_r.colorSpace),wa=Ss(zt);Ii&&!1===sr(zt)?n.renderbufferStorageMultisample(n.RENDERBUFFER,wa,Vs,zt.width,zt.height):sr(zt)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,wa,Vs,zt.width,zt.height):n.renderbufferStorage(n.RENDERBUFFER,Vs,zt.width,zt.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Gs(Bn){const zt=i.get(Bn),Ii=!0===Bn.isWebGLCubeRenderTarget;if(zt.__boundDepthTexture!==Bn.depthTexture){const ur=Bn.depthTexture;if(zt.__depthDisposeCallback&&zt.__depthDisposeCallback(),ur){const hr=()=>{delete zt.__boundDepthTexture,delete zt.__depthDisposeCallback,ur.removeEventListener("dispose",hr)};ur.addEventListener("dispose",hr),zt.__depthDisposeCallback=hr}zt.__boundDepthTexture=ur}if(Bn.depthTexture&&!zt.__autoAllocateDepthBuffer){if(Ii)throw new Error("target.depthTexture not supported in Cube render targets");!function Rr(Bn,zt){if(zt&&zt.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,Bn),!zt.depthTexture||!zt.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(zt.depthTexture).__webglTexture||zt.depthTexture.image.width!==zt.width||zt.depthTexture.image.height!==zt.height)&&(zt.depthTexture.image.width=zt.width,zt.depthTexture.image.height=zt.height,zt.depthTexture.needsUpdate=!0),vi(zt.depthTexture,0);const ur=i.get(zt.depthTexture).__webglTexture,hr=Ss(zt);if(zt.depthTexture.format===K2)sr(zt)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ur,0,hr):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ur,0);else{if(zt.depthTexture.format!==Z2)throw new Error("Unknown depthTexture format");sr(zt)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ur,0,hr):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ur,0)}}(zt.__webglFramebuffer,Bn)}else if(Ii){zt.__webglDepthbuffer=[];for(let ur=0;ur<6;ur++)if(t.bindFramebuffer(n.FRAMEBUFFER,zt.__webglFramebuffer[ur]),void 0===zt.__webglDepthbuffer[ur])zt.__webglDepthbuffer[ur]=n.createRenderbuffer(),ps(zt.__webglDepthbuffer[ur],Bn,!1);else{const hr=Bn.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,_r=zt.__webglDepthbuffer[ur];n.bindRenderbuffer(n.RENDERBUFFER,_r),n.framebufferRenderbuffer(n.FRAMEBUFFER,hr,n.RENDERBUFFER,_r)}}else if(t.bindFramebuffer(n.FRAMEBUFFER,zt.__webglFramebuffer),void 0===zt.__webglDepthbuffer)zt.__webglDepthbuffer=n.createRenderbuffer(),ps(zt.__webglDepthbuffer,Bn,!1);else{const ur=Bn.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,hr=zt.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,hr),n.framebufferRenderbuffer(n.FRAMEBUFFER,ur,n.RENDERBUFFER,hr)}t.bindFramebuffer(n.FRAMEBUFFER,null)}const bn=[],Kr=[];function Ss(Bn){return Math.min(r.maxSamples,Bn.samples)}function sr(Bn){const zt=i.get(Bn);return Bn.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==zt.__useRenderToTexture}function xs(Bn,zt){const Ii=Bn.colorSpace,ur=Bn.format,hr=Bn.type;return!0===Bn.isCompressedTexture||!0===Bn.isVideoTexture||Ii!==id&&""!==Ii&&(pl.getTransfer(Ii)===Uc?(ur!==Hf||hr!==$_)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ii)),zt}function qs(Bn){return typeof HTMLImageElement<"u"&&Bn instanceof HTMLImageElement?(u.width=Bn.naturalWidth||Bn.width,u.height=Bn.naturalHeight||Bn.height):typeof VideoFrame<"u"&&Bn instanceof VideoFrame?(u.width=Bn.displayWidth,u.height=Bn.displayHeight):(u.width=Bn.width,u.height=Bn.height),u}this.allocateTextureUnit=function ti(){const Bn=St;return Bn>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Bn+" texture units while this GPU supports only "+r.maxTextures),St+=1,Bn},this.resetTextureUnits=function Dn(){St=0},this.setTexture2D=vi,this.setTexture2DArray=function bi(Bn,zt){const Ii=i.get(Bn);Bn.version>0&&Ii.__version!==Bn.version?Po(Ii,Bn,zt):t.bindTexture(n.TEXTURE_2D_ARRAY,Ii.__webglTexture,n.TEXTURE0+zt)},this.setTexture3D=function Un(Bn,zt){const Ii=i.get(Bn);Bn.version>0&&Ii.__version!==Bn.version?Po(Ii,Bn,zt):t.bindTexture(n.TEXTURE_3D,Ii.__webglTexture,n.TEXTURE0+zt)},this.setTextureCube=function _i(Bn,zt){const Ii=i.get(Bn);Bn.version>0&&Ii.__version!==Bn.version?function Ci(Bn,zt,Ii){if(6!==zt.image.length)return;const ur=so(Bn,zt),hr=zt.source;t.bindTexture(n.TEXTURE_CUBE_MAP,Bn.__webglTexture,n.TEXTURE0+Ii);const _r=i.get(hr);if(hr.version!==_r.__version||!0===ur){t.activeTexture(n.TEXTURE0+Ii);const Do=pl.getPrimaries(pl.workingColorSpace),vs=""===zt.colorSpace?null:pl.getPrimaries(zt.colorSpace),Vs=""===zt.colorSpace||Do===vs?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,zt.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,zt.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,zt.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Vs);const wa=zt.isCompressedTexture||zt.image[0].isCompressedTexture,qr=zt.image[0]&&zt.image[0].isDataTexture,Os=[];for(let Ar=0;Ar<6;Ar++)Os[Ar]=wa||qr?qr?zt.image[Ar].image:zt.image[Ar]:ne(zt.image[Ar],!0,r.maxCubemapSize),Os[Ar]=xs(zt,Os[Ar]);const cl=Os[0],ha=s.convert(zt.format,zt.colorSpace),Xs=s.convert(zt.type),ma=Ee(zt.internalFormat,ha,Xs,zt.colorSpace),$a=!0!==zt.isVideoTexture,dh=void 0===_r.__version||!0===ur,ri=hr.dataReady;let or,Jr=Ve(zt,cl);if(Wr(n.TEXTURE_CUBE_MAP,zt),wa){$a&&dh&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Jr,ma,cl.width,cl.height);for(let Ar=0;Ar<6;Ar++){or=Os[Ar].mipmaps;for(let hs=0;hs<or.length;hs++){const Ko=or[hs];zt.format!==Hf?null!==ha?$a?ri&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,hs,0,0,Ko.width,Ko.height,ha,Ko.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,hs,ma,Ko.width,Ko.height,0,Ko.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):$a?ri&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,hs,0,0,Ko.width,Ko.height,ha,Xs,Ko.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,hs,ma,Ko.width,Ko.height,0,ha,Xs,Ko.data)}}}else{if(or=zt.mipmaps,$a&&dh){or.length>0&&Jr++;const Ar=qs(Os[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Jr,ma,Ar.width,Ar.height)}for(let Ar=0;Ar<6;Ar++)if(qr){$a?ri&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,0,0,0,Os[Ar].width,Os[Ar].height,ha,Xs,Os[Ar].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,0,ma,Os[Ar].width,Os[Ar].height,0,ha,Xs,Os[Ar].data);for(let hs=0;hs<or.length;hs++){const ml=or[hs].image[Ar].image;$a?ri&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,hs+1,0,0,ml.width,ml.height,ha,Xs,ml.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,hs+1,ma,ml.width,ml.height,0,ha,Xs,ml.data)}}else{$a?ri&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,0,0,0,ha,Xs,Os[Ar]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,0,ma,ha,Xs,Os[Ar]);for(let hs=0;hs<or.length;hs++){const Ko=or[hs];$a?ri&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,hs+1,0,0,ha,Xs,Ko.image[Ar]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,hs+1,ma,ha,Xs,Ko.image[Ar])}}}se(zt)&&le(n.TEXTURE_CUBE_MAP),_r.__version=hr.version,zt.onUpdate&&zt.onUpdate(zt)}Bn.__version=zt.version}(Ii,Bn,zt):t.bindTexture(n.TEXTURE_CUBE_MAP,Ii.__webglTexture,n.TEXTURE0+zt)},this.rebindTextures=function to(Bn,zt,Ii){const ur=i.get(Bn);void 0!==zt&&yr(ur.__webglFramebuffer,Bn,Bn.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==Ii&&Gs(Bn)},this.setupRenderTarget=function lo(Bn){const zt=Bn.texture,Ii=i.get(Bn),ur=i.get(zt);Bn.addEventListener("dispose",Ct);const hr=Bn.textures,_r=!0===Bn.isWebGLCubeRenderTarget,Do=hr.length>1;if(Do||(void 0===ur.__webglTexture&&(ur.__webglTexture=n.createTexture()),ur.__version=zt.version,o.memory.textures++),_r){Ii.__webglFramebuffer=[];for(let vs=0;vs<6;vs++)if(zt.mipmaps&&zt.mipmaps.length>0){Ii.__webglFramebuffer[vs]=[];for(let Vs=0;Vs<zt.mipmaps.length;Vs++)Ii.__webglFramebuffer[vs][Vs]=n.createFramebuffer()}else Ii.__webglFramebuffer[vs]=n.createFramebuffer()}else{if(zt.mipmaps&&zt.mipmaps.length>0){Ii.__webglFramebuffer=[];for(let vs=0;vs<zt.mipmaps.length;vs++)Ii.__webglFramebuffer[vs]=n.createFramebuffer()}else Ii.__webglFramebuffer=n.createFramebuffer();if(Do)for(let vs=0,Vs=hr.length;vs<Vs;vs++){const wa=i.get(hr[vs]);void 0===wa.__webglTexture&&(wa.__webglTexture=n.createTexture(),o.memory.textures++)}if(Bn.samples>0&&!1===sr(Bn)){Ii.__webglMultisampledFramebuffer=n.createFramebuffer(),Ii.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,Ii.__webglMultisampledFramebuffer);for(let vs=0;vs<hr.length;vs++){const Vs=hr[vs];Ii.__webglColorRenderbuffer[vs]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,Ii.__webglColorRenderbuffer[vs]);const wa=s.convert(Vs.format,Vs.colorSpace),qr=s.convert(Vs.type),Os=Ee(Vs.internalFormat,wa,qr,Vs.colorSpace,!0===Bn.isXRRenderTarget),cl=Ss(Bn);n.renderbufferStorageMultisample(n.RENDERBUFFER,cl,Os,Bn.width,Bn.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+vs,n.RENDERBUFFER,Ii.__webglColorRenderbuffer[vs])}n.bindRenderbuffer(n.RENDERBUFFER,null),Bn.depthBuffer&&(Ii.__webglDepthRenderbuffer=n.createRenderbuffer(),ps(Ii.__webglDepthRenderbuffer,Bn,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(_r){t.bindTexture(n.TEXTURE_CUBE_MAP,ur.__webglTexture),Wr(n.TEXTURE_CUBE_MAP,zt);for(let vs=0;vs<6;vs++)if(zt.mipmaps&&zt.mipmaps.length>0)for(let Vs=0;Vs<zt.mipmaps.length;Vs++)yr(Ii.__webglFramebuffer[vs][Vs],Bn,zt,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+vs,Vs);else yr(Ii.__webglFramebuffer[vs],Bn,zt,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+vs,0);se(zt)&&le(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Do){for(let vs=0,Vs=hr.length;vs<Vs;vs++){const wa=hr[vs],qr=i.get(wa);t.bindTexture(n.TEXTURE_2D,qr.__webglTexture),Wr(n.TEXTURE_2D,wa),yr(Ii.__webglFramebuffer,Bn,wa,n.COLOR_ATTACHMENT0+vs,n.TEXTURE_2D,0),se(wa)&&le(n.TEXTURE_2D)}t.unbindTexture()}else{let vs=n.TEXTURE_2D;if((Bn.isWebGL3DRenderTarget||Bn.isWebGLArrayRenderTarget)&&(vs=Bn.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(vs,ur.__webglTexture),Wr(vs,zt),zt.mipmaps&&zt.mipmaps.length>0)for(let Vs=0;Vs<zt.mipmaps.length;Vs++)yr(Ii.__webglFramebuffer[Vs],Bn,zt,n.COLOR_ATTACHMENT0,vs,Vs);else yr(Ii.__webglFramebuffer,Bn,zt,n.COLOR_ATTACHMENT0,vs,0);se(zt)&&le(vs),t.unbindTexture()}Bn.depthBuffer&&Gs(Bn)},this.updateRenderTargetMipmap=function La(Bn){const zt=Bn.textures;for(let Ii=0,ur=zt.length;Ii<ur;Ii++){const hr=zt[Ii];if(se(hr)){const _r=Bn.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Do=i.get(hr).__webglTexture;t.bindTexture(_r,Do),le(_r),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ur(Bn){if(Bn.samples>0)if(!1===sr(Bn)){const zt=Bn.textures,Ii=Bn.width,ur=Bn.height;let hr=n.COLOR_BUFFER_BIT;const _r=Bn.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Do=i.get(Bn),vs=zt.length>1;if(vs)for(let Vs=0;Vs<zt.length;Vs++)t.bindFramebuffer(n.FRAMEBUFFER,Do.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Vs,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Do.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Vs,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Do.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Do.__webglFramebuffer);for(let Vs=0;Vs<zt.length;Vs++){if(Bn.resolveDepthBuffer&&(Bn.depthBuffer&&(hr|=n.DEPTH_BUFFER_BIT),Bn.stencilBuffer&&Bn.resolveStencilBuffer&&(hr|=n.STENCIL_BUFFER_BIT)),vs){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Do.__webglColorRenderbuffer[Vs]);const wa=i.get(zt[Vs]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,wa,0)}n.blitFramebuffer(0,0,Ii,ur,0,0,Ii,ur,hr,n.NEAREST),!0===h&&(bn.length=0,Kr.length=0,bn.push(n.COLOR_ATTACHMENT0+Vs),Bn.depthBuffer&&!1===Bn.resolveDepthBuffer&&(bn.push(_r),Kr.push(_r),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,Kr)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,bn))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),vs)for(let Vs=0;Vs<zt.length;Vs++){t.bindFramebuffer(n.FRAMEBUFFER,Do.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Vs,n.RENDERBUFFER,Do.__webglColorRenderbuffer[Vs]);const wa=i.get(zt[Vs]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Do.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Vs,n.TEXTURE_2D,wa,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Do.__webglMultisampledFramebuffer)}else Bn.depthBuffer&&!1===Bn.resolveDepthBuffer&&h&&n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Bn.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT])},this.setupDepthRenderbuffer=Gs,this.setupFrameBufferTexture=yr,this.useMultisampledRTT=sr}function Ege(n,e){return{convert:function t(i,r=""){let s;const o=pl.getTransfer(r);if(i===$_)return n.UNSIGNED_BYTE;if(i===cO)return n.UNSIGNED_SHORT_4_4_4_4;if(i===hO)return n.UNSIGNED_SHORT_5_5_5_1;if(i===cq)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===aq)return n.BYTE;if(i===lq)return n.SHORT;if(i===TS)return n.UNSIGNED_SHORT;if(i===lO)return n.INT;if(i===j1)return n.UNSIGNED_INT;if(i===ym)return n.FLOAT;if(i===wA)return n.HALF_FLOAT;if(i===hq)return n.ALPHA;if(i===uq)return n.RGB;if(i===Hf)return n.RGBA;if(i===dq)return n.LUMINANCE;if(i===fq)return n.LUMINANCE_ALPHA;if(i===K2)return n.DEPTH_COMPONENT;if(i===Z2)return n.DEPTH_STENCIL;if(i===uO)return n.RED;if(i===WI)return n.RED_INTEGER;if(i===pq)return n.RG;if(i===dO)return n.RG_INTEGER;if(i===fO)return n.RGBA_INTEGER;if(i===$I||i===XI||i===YI||i===KI)if(o===Uc){if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===s)return null;if(i===$I)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===XI)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===YI)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===KI)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(s=e.get("WEBGL_compressed_texture_s3tc"),null===s)return null;if(i===$I)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===XI)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===YI)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===KI)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(i===pO||i===mO||i===AO||i===gO){if(s=e.get("WEBGL_compressed_texture_pvrtc"),null===s)return null;if(i===pO)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===mO)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===AO)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===gO)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(i===_O||i===yO||i===vO){if(s=e.get("WEBGL_compressed_texture_etc"),null===s)return null;if(i===_O||i===yO)return o===Uc?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===vO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}if(i===bO||i===xO||i===wO||i===CO||i===MO||i===EO||i===SO||i===TO||i===DO||i===IO||i===BO||i===PO||i===RO||i===kO){if(s=e.get("WEBGL_compressed_texture_astc"),null===s)return null;if(i===bO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===xO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===wO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===CO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===MO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===EO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===SO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===TO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===DO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===IO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===BO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===PO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===RO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===kO)return o===Uc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}if(i===ZI||i===FO||i===OO){if(s=e.get("EXT_texture_compression_bptc"),null===s)return null;if(i===ZI)return o===Uc?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===FO)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===OO)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(i===mq||i===LO||i===NO||i===UO){if(s=e.get("EXT_texture_compression_rgtc"),null===s)return null;if(i===ZI)return s.COMPRESSED_RED_RGTC1_EXT;if(i===LO)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===NO)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===UO)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return i===Y2?n.UNSIGNED_INT_24_8:void 0!==n[i]?n[i]:null}}}class CQ extends Lu{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Xl extends Wa{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Sge={type:"move"};class C5{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Xl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Xl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Dt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Dt),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Xl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Dt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Dt),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const l=this._targetRay,h=this._grip,u=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(u&&e.hand){o=!0;for(const ne of e.hand.values()){const se=t.getJointPose(ne,i),le=this._getHandJoint(u,ne);null!==se&&(le.matrix.fromArray(se.transform.matrix),le.matrix.decompose(le.position,le.rotation,le.scale),le.matrixWorldNeedsUpdate=!0,le.jointRadius=se.radius),le.visible=null!==se}const T=u.joints["index-finger-tip"].position.distanceTo(u.joints["thumb-tip"].position),B=.02,j=.005;u.inputState.pinching&&T>B+j?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&T<=B-j&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==h&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(h.matrix.fromArray(s.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,s.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(s.linearVelocity)):h.hasLinearVelocity=!1,s.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(s.angularVelocity)):h.hasAngularVelocity=!1));null!==l&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,r.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(r.linearVelocity)):l.hasLinearVelocity=!1,r.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(r.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(Sge)))}return null!==l&&(l.visible=null!==r),null!==h&&(h.visible=null!==s),null!==u&&(u.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new Xl;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class Ige{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(null===this.texture){const r=new Yd;e.properties.get(r).__webglTexture=t.texture,(t.depthNear!=i.depthNear||t.depthFar!=i.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,i=new Ou({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new jo(new MC(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Bge extends K_{constructor(e,t){super();const i=this;let r=null,s=1,o=null,l="local-floor",h=1,u=null,f=null,y=null,T=null,B=null,j=null;const ne=new Ige,se=t.getContextAttributes();let le=null,Ee=null;const Pe=[],Ve=[],Ft=new Fi;let Ct=null;const Lt=new Lu;Lt.layers.enable(1),Lt.viewport=new $l;const Kt=new Lu;Kt.layers.enable(2),Kt.viewport=new $l;const Bt=[Lt,Kt],St=new CQ;St.layers.enable(1),St.layers.enable(2);let Dn=null,ti=null;function ci(Ci){const yr=Ve.indexOf(Ci.inputSource);if(-1===yr)return;const ps=Pe[yr];void 0!==ps&&(ps.update(Ci.inputSource,Ci.frame,u||o),ps.dispatchEvent({type:Ci.type,data:Ci.inputSource}))}function vi(){r.removeEventListener("select",ci),r.removeEventListener("selectstart",ci),r.removeEventListener("selectend",ci),r.removeEventListener("squeeze",ci),r.removeEventListener("squeezestart",ci),r.removeEventListener("squeezeend",ci),r.removeEventListener("end",vi),r.removeEventListener("inputsourceschange",bi);for(let Ci=0;Ci<Pe.length;Ci++){const yr=Ve[Ci];null!==yr&&(Ve[Ci]=null,Pe[Ci].disconnect(yr))}Dn=null,ti=null,ne.reset(),e.setRenderTarget(le),B=null,T=null,y=null,r=null,Ee=null,Po.stop(),i.isPresenting=!1,e.setPixelRatio(Ct),e.setSize(Ft.width,Ft.height,!1),i.dispatchEvent({type:"sessionend"})}function bi(Ci){for(let yr=0;yr<Ci.removed.length;yr++){const ps=Ci.removed[yr],Rr=Ve.indexOf(ps);Rr>=0&&(Ve[Rr]=null,Pe[Rr].disconnect(ps))}for(let yr=0;yr<Ci.added.length;yr++){const ps=Ci.added[yr];let Rr=Ve.indexOf(ps);if(-1===Rr){for(let to=0;to<Pe.length;to++){if(to>=Ve.length){Ve.push(ps),Rr=to;break}if(null===Ve[to]){Ve[to]=ps,Rr=to;break}}if(-1===Rr)break}const Gs=Pe[Rr];Gs&&Gs.connect(ps)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ci){let yr=Pe[Ci];return void 0===yr&&(yr=new C5,Pe[Ci]=yr),yr.getTargetRaySpace()},this.getControllerGrip=function(Ci){let yr=Pe[Ci];return void 0===yr&&(yr=new C5,Pe[Ci]=yr),yr.getGripSpace()},this.getHand=function(Ci){let yr=Pe[Ci];return void 0===yr&&(yr=new C5,Pe[Ci]=yr),yr.getHandSpace()},this.setFramebufferScaleFactor=function(Ci){s=Ci,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ci){l=Ci,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(Ci){u=Ci},this.getBaseLayer=function(){return null!==T?T:B},this.getBinding=function(){return y},this.getFrame=function(){return j},this.getSession=function(){return r},this.setSession=function(){var Ci=(0,al.A)(function*(yr){if(r=yr,null!==r){if(le=e.getRenderTarget(),r.addEventListener("select",ci),r.addEventListener("selectstart",ci),r.addEventListener("selectend",ci),r.addEventListener("squeeze",ci),r.addEventListener("squeezestart",ci),r.addEventListener("squeezeend",ci),r.addEventListener("end",vi),r.addEventListener("inputsourceschange",bi),!0!==se.xrCompatible&&(yield t.makeXRCompatible()),Ct=e.getPixelRatio(),e.getSize(Ft),void 0===r.renderState.layers)B=new XRWebGLLayer(r,t,{antialias:se.antialias,alpha:!0,depth:se.depth,stencil:se.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:B}),e.setPixelRatio(1),e.setSize(B.framebufferWidth,B.framebufferHeight,!1),Ee=new rd(B.framebufferWidth,B.framebufferHeight,{format:Hf,type:$_,colorSpace:e.outputColorSpace,stencilBuffer:se.stencil});else{let ps=null,Rr=null,Gs=null;se.depth&&(Gs=se.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ps=se.stencil?Z2:K2,Rr=se.stencil?Y2:j1);const to={colorFormat:t.RGBA8,depthFormat:Gs,scaleFactor:s};y=new XRWebGLBinding(r,t),T=y.createProjectionLayer(to),r.updateRenderState({layers:[T]}),e.setPixelRatio(1),e.setSize(T.textureWidth,T.textureHeight,!1),Ee=new rd(T.textureWidth,T.textureHeight,{format:Hf,type:$_,depthTexture:new nQ(T.textureWidth,T.textureHeight,Rr,void 0,void 0,void 0,void 0,void 0,void 0,ps),stencilBuffer:se.stencil,colorSpace:e.outputColorSpace,samples:se.antialias?4:0,resolveDepthBuffer:!1===T.ignoreDepthValues})}Ee.isXRRenderTarget=!0,this.setFoveation(h),u=null,o=yield r.requestReferenceSpace(l),Po.setContext(r),Po.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(yr){return Ci.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode},this.getDepthTexture=function(){return ne.getDepthTexture()};const Un=new Dt,_i=new Dt;function ir(Ci,yr){null===yr?Ci.matrixWorld.copy(Ci.matrix):Ci.matrixWorld.multiplyMatrices(yr.matrixWorld,Ci.matrix),Ci.matrixWorldInverse.copy(Ci.matrixWorld).invert()}this.updateCamera=function(Ci){if(null===r)return;let yr=Ci.near,ps=Ci.far;null!==ne.texture&&(ne.depthNear>0&&(yr=ne.depthNear),ne.depthFar>0&&(ps=ne.depthFar)),St.near=Kt.near=Lt.near=yr,St.far=Kt.far=Lt.far=ps,(Dn!==St.near||ti!==St.far)&&(r.updateRenderState({depthNear:St.near,depthFar:St.far}),Dn=St.near,ti=St.far);const Rr=Ci.parent,Gs=St.cameras;ir(St,Rr);for(let to=0;to<Gs.length;to++)ir(Gs[to],Rr);2===Gs.length?function si(Ci,yr,ps){Un.setFromMatrixPosition(yr.matrixWorld),_i.setFromMatrixPosition(ps.matrixWorld);const Rr=Un.distanceTo(_i),Gs=yr.projectionMatrix.elements,to=ps.projectionMatrix.elements,lo=Gs[14]/(Gs[10]-1),La=Gs[14]/(Gs[10]+1),bn=(Gs[9]+1)/Gs[5],Kr=(Gs[9]-1)/Gs[5],Ur=(Gs[8]-1)/Gs[0],Ss=(to[8]+1)/to[0],sr=lo*Ur,Oo=lo*Ss,xs=Rr/(-Ur+Ss),qs=xs*-Ur;if(yr.matrixWorld.decompose(Ci.position,Ci.quaternion,Ci.scale),Ci.translateX(qs),Ci.translateZ(xs),Ci.matrixWorld.compose(Ci.position,Ci.quaternion,Ci.scale),Ci.matrixWorldInverse.copy(Ci.matrixWorld).invert(),-1===Gs[10])Ci.projectionMatrix.copy(yr.projectionMatrix),Ci.projectionMatrixInverse.copy(yr.projectionMatrixInverse);else{const Bn=lo+xs,zt=La+xs;Ci.projectionMatrix.makePerspective(sr-qs,Oo+(Rr-qs),bn*La/zt*Bn,Kr*La/zt*Bn,Bn,zt),Ci.projectionMatrixInverse.copy(Ci.projectionMatrix).invert()}}(St,Lt,Kt):St.projectionMatrix.copy(Lt.projectionMatrix),function Nr(Ci,yr,ps){null===ps?Ci.matrix.copy(yr.matrixWorld):(Ci.matrix.copy(ps.matrixWorld),Ci.matrix.invert(),Ci.matrix.multiply(yr.matrixWorld)),Ci.matrix.decompose(Ci.position,Ci.quaternion,Ci.scale),Ci.updateMatrixWorld(!0),Ci.projectionMatrix.copy(yr.projectionMatrix),Ci.projectionMatrixInverse.copy(yr.projectionMatrixInverse),Ci.isPerspectiveCamera&&(Ci.fov=2*rC*Math.atan(1/Ci.projectionMatrix.elements[5]),Ci.zoom=1)}(Ci,St,Rr)},this.getCamera=function(){return St},this.getFoveation=function(){if(null!==T||null!==B)return h},this.setFoveation=function(Ci){h=Ci,null!==T&&(T.fixedFoveation=Ci),null!==B&&void 0!==B.fixedFoveation&&(B.fixedFoveation=Ci)},this.hasDepthSensing=function(){return null!==ne.texture},this.getDepthSensingMesh=function(){return ne.getMesh(St)};let Wr=null;const Po=new $q;Po.setAnimationLoop(function so(Ci,yr){if(f=yr.getViewerPose(u||o),j=yr,null!==f){const ps=f.views;null!==B&&(e.setRenderTargetFramebuffer(Ee,B.framebuffer),e.setRenderTarget(Ee));let Rr=!1;ps.length!==St.cameras.length&&(St.cameras.length=0,Rr=!0);for(let to=0;to<ps.length;to++){const lo=ps[to];let La=null;if(null!==B)La=B.getViewport(lo);else{const Kr=y.getViewSubImage(T,lo);La=Kr.viewport,0===to&&(e.setRenderTargetTextures(Ee,Kr.colorTexture,T.ignoreDepthValues?void 0:Kr.depthStencilTexture),e.setRenderTarget(Ee))}let bn=Bt[to];void 0===bn&&(bn=new Lu,bn.layers.enable(to),bn.viewport=new $l,Bt[to]=bn),bn.matrix.fromArray(lo.transform.matrix),bn.matrix.decompose(bn.position,bn.quaternion,bn.scale),bn.projectionMatrix.fromArray(lo.projectionMatrix),bn.projectionMatrixInverse.copy(bn.projectionMatrix).invert(),bn.viewport.set(La.x,La.y,La.width,La.height),0===to&&(St.matrix.copy(bn.matrix),St.matrix.decompose(St.position,St.quaternion,St.scale)),!0===Rr&&St.cameras.push(bn)}const Gs=r.enabledFeatures;if(Gs&&Gs.includes("depth-sensing")){const to=y.getDepthInformation(ps[0]);to&&to.isValid&&to.texture&&ne.init(e,to,r.renderState)}}for(let ps=0;ps<Pe.length;ps++){const Rr=Ve[ps],Gs=Pe[ps];null!==Rr&&void 0!==Gs&&Gs.update(Rr,yr,u||o)}Wr&&Wr(Ci,yr),yr.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:yr}),j=null}),this.setAnimationLoop=function(Ci){Wr=Ci},this.dispose=function(){}}}const nx=new B0,Pge=new go;function Rge(n,e){function t(se,le){!0===se.matrixAutoUpdate&&se.updateMatrix(),le.value.copy(se.matrix)}function s(se,le){se.opacity.value=le.opacity,le.color&&se.diffuse.value.copy(le.color),le.emissive&&se.emissive.value.copy(le.emissive).multiplyScalar(le.emissiveIntensity),le.map&&(se.map.value=le.map,t(le.map,se.mapTransform)),le.alphaMap&&(se.alphaMap.value=le.alphaMap,t(le.alphaMap,se.alphaMapTransform)),le.bumpMap&&(se.bumpMap.value=le.bumpMap,t(le.bumpMap,se.bumpMapTransform),se.bumpScale.value=le.bumpScale,1===le.side&&(se.bumpScale.value*=-1)),le.normalMap&&(se.normalMap.value=le.normalMap,t(le.normalMap,se.normalMapTransform),se.normalScale.value.copy(le.normalScale),1===le.side&&se.normalScale.value.negate()),le.displacementMap&&(se.displacementMap.value=le.displacementMap,t(le.displacementMap,se.displacementMapTransform),se.displacementScale.value=le.displacementScale,se.displacementBias.value=le.displacementBias),le.emissiveMap&&(se.emissiveMap.value=le.emissiveMap,t(le.emissiveMap,se.emissiveMapTransform)),le.specularMap&&(se.specularMap.value=le.specularMap,t(le.specularMap,se.specularMapTransform)),le.alphaTest>0&&(se.alphaTest.value=le.alphaTest);const Ee=e.get(le),Pe=Ee.envMap,Ve=Ee.envMapRotation;Pe&&(se.envMap.value=Pe,nx.copy(Ve),nx.x*=-1,nx.y*=-1,nx.z*=-1,Pe.isCubeTexture&&!1===Pe.isRenderTargetTexture&&(nx.y*=-1,nx.z*=-1),se.envMapRotation.value.setFromMatrix4(Pge.makeRotationFromEuler(nx)),se.flipEnvMap.value=Pe.isCubeTexture&&!1===Pe.isRenderTargetTexture?-1:1,se.reflectivity.value=le.reflectivity,se.ior.value=le.ior,se.refractionRatio.value=le.refractionRatio),le.lightMap&&(se.lightMap.value=le.lightMap,se.lightMapIntensity.value=le.lightMapIntensity,t(le.lightMap,se.lightMapTransform)),le.aoMap&&(se.aoMap.value=le.aoMap,se.aoMapIntensity.value=le.aoMapIntensity,t(le.aoMap,se.aoMapTransform))}return{refreshFogUniforms:function i(se,le){le.color.getRGB(se.fogColor.value,Qq(n)),le.isFog?(se.fogNear.value=le.near,se.fogFar.value=le.far):le.isFogExp2&&(se.fogDensity.value=le.density)},refreshMaterialUniforms:function r(se,le,Ee,Pe,Ve){le.isMeshBasicMaterial||le.isMeshLambertMaterial?s(se,le):le.isMeshToonMaterial?(s(se,le),function y(se,le){le.gradientMap&&(se.gradientMap.value=le.gradientMap)}(se,le)):le.isMeshPhongMaterial?(s(se,le),function f(se,le){se.specular.value.copy(le.specular),se.shininess.value=Math.max(le.shininess,1e-4)}(se,le)):le.isMeshStandardMaterial?(s(se,le),function T(se,le){se.metalness.value=le.metalness,le.metalnessMap&&(se.metalnessMap.value=le.metalnessMap,t(le.metalnessMap,se.metalnessMapTransform)),se.roughness.value=le.roughness,le.roughnessMap&&(se.roughnessMap.value=le.roughnessMap,t(le.roughnessMap,se.roughnessMapTransform)),le.envMap&&(se.envMapIntensity.value=le.envMapIntensity)}(se,le),le.isMeshPhysicalMaterial&&function B(se,le,Ee){se.ior.value=le.ior,le.sheen>0&&(se.sheenColor.value.copy(le.sheenColor).multiplyScalar(le.sheen),se.sheenRoughness.value=le.sheenRoughness,le.sheenColorMap&&(se.sheenColorMap.value=le.sheenColorMap,t(le.sheenColorMap,se.sheenColorMapTransform)),le.sheenRoughnessMap&&(se.sheenRoughnessMap.value=le.sheenRoughnessMap,t(le.sheenRoughnessMap,se.sheenRoughnessMapTransform))),le.clearcoat>0&&(se.clearcoat.value=le.clearcoat,se.clearcoatRoughness.value=le.clearcoatRoughness,le.clearcoatMap&&(se.clearcoatMap.value=le.clearcoatMap,t(le.clearcoatMap,se.clearcoatMapTransform)),le.clearcoatRoughnessMap&&(se.clearcoatRoughnessMap.value=le.clearcoatRoughnessMap,t(le.clearcoatRoughnessMap,se.clearcoatRoughnessMapTransform)),le.clearcoatNormalMap&&(se.clearcoatNormalMap.value=le.clearcoatNormalMap,t(le.clearcoatNormalMap,se.clearcoatNormalMapTransform),se.clearcoatNormalScale.value.copy(le.clearcoatNormalScale),1===le.side&&se.clearcoatNormalScale.value.negate())),le.dispersion>0&&(se.dispersion.value=le.dispersion),le.iridescence>0&&(se.iridescence.value=le.iridescence,se.iridescenceIOR.value=le.iridescenceIOR,se.iridescenceThicknessMinimum.value=le.iridescenceThicknessRange[0],se.iridescenceThicknessMaximum.value=le.iridescenceThicknessRange[1],le.iridescenceMap&&(se.iridescenceMap.value=le.iridescenceMap,t(le.iridescenceMap,se.iridescenceMapTransform)),le.iridescenceThicknessMap&&(se.iridescenceThicknessMap.value=le.iridescenceThicknessMap,t(le.iridescenceThicknessMap,se.iridescenceThicknessMapTransform))),le.transmission>0&&(se.transmission.value=le.transmission,se.transmissionSamplerMap.value=Ee.texture,se.transmissionSamplerSize.value.set(Ee.width,Ee.height),le.transmissionMap&&(se.transmissionMap.value=le.transmissionMap,t(le.transmissionMap,se.transmissionMapTransform)),se.thickness.value=le.thickness,le.thicknessMap&&(se.thicknessMap.value=le.thicknessMap,t(le.thicknessMap,se.thicknessMapTransform)),se.attenuationDistance.value=le.attenuationDistance,se.attenuationColor.value.copy(le.attenuationColor)),le.anisotropy>0&&(se.anisotropyVector.value.set(le.anisotropy*Math.cos(le.anisotropyRotation),le.anisotropy*Math.sin(le.anisotropyRotation)),le.anisotropyMap&&(se.anisotropyMap.value=le.anisotropyMap,t(le.anisotropyMap,se.anisotropyMapTransform))),se.specularIntensity.value=le.specularIntensity,se.specularColor.value.copy(le.specularColor),le.specularColorMap&&(se.specularColorMap.value=le.specularColorMap,t(le.specularColorMap,se.specularColorMapTransform)),le.specularIntensityMap&&(se.specularIntensityMap.value=le.specularIntensityMap,t(le.specularIntensityMap,se.specularIntensityMapTransform))}(se,le,Ve)):le.isMeshMatcapMaterial?(s(se,le),function j(se,le){le.matcap&&(se.matcap.value=le.matcap)}(se,le)):le.isMeshDepthMaterial?s(se,le):le.isMeshDistanceMaterial?(s(se,le),function ne(se,le){const Ee=e.get(le).light;se.referencePosition.value.setFromMatrixPosition(Ee.matrixWorld),se.nearDistance.value=Ee.shadow.camera.near,se.farDistance.value=Ee.shadow.camera.far}(se,le)):le.isMeshNormalMaterial?s(se,le):le.isLineBasicMaterial?(function o(se,le){se.diffuse.value.copy(le.color),se.opacity.value=le.opacity,le.map&&(se.map.value=le.map,t(le.map,se.mapTransform))}(se,le),le.isLineDashedMaterial&&function l(se,le){se.dashSize.value=le.dashSize,se.totalSize.value=le.dashSize+le.gapSize,se.scale.value=le.scale}(se,le)):le.isPointsMaterial?function h(se,le,Ee,Pe){se.diffuse.value.copy(le.color),se.opacity.value=le.opacity,se.size.value=le.size*Ee,se.scale.value=.5*Pe,le.map&&(se.map.value=le.map,t(le.map,se.uvTransform)),le.alphaMap&&(se.alphaMap.value=le.alphaMap,t(le.alphaMap,se.alphaMapTransform)),le.alphaTest>0&&(se.alphaTest.value=le.alphaTest)}(se,le,Ee,Pe):le.isSpriteMaterial?function u(se,le){se.diffuse.value.copy(le.color),se.opacity.value=le.opacity,se.rotation.value=le.rotation,le.map&&(se.map.value=le.map,t(le.map,se.mapTransform)),le.alphaMap&&(se.alphaMap.value=le.alphaMap,t(le.alphaMap,se.alphaMapTransform)),le.alphaTest>0&&(se.alphaTest.value=le.alphaTest)}(se,le):le.isShadowMaterial?(se.color.value.copy(le.color),se.opacity.value=le.opacity):le.isShaderMaterial&&(le.uniformsNeedUpdate=!1)}}}function kge(n,e,t,i){let r={},s={},o=[];const l=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function B(Ee,Pe,Ve,Ft){const Ct=Ee.value,Lt=Pe+"_"+Ve;if(void 0===Ft[Lt])return Ft[Lt]="number"==typeof Ct||"boolean"==typeof Ct?Ct:Ct.clone(),!0;{const Kt=Ft[Lt];if("number"==typeof Ct||"boolean"==typeof Ct){if(Kt!==Ct)return Ft[Lt]=Ct,!0}else if(!1===Kt.equals(Ct))return Kt.copy(Ct),!0}return!1}function ne(Ee){const Pe={boundary:0,storage:0};return"number"==typeof Ee||"boolean"==typeof Ee?(Pe.boundary=4,Pe.storage=4):Ee.isVector2?(Pe.boundary=8,Pe.storage=8):Ee.isVector3||Ee.isColor?(Pe.boundary=16,Pe.storage=12):Ee.isVector4?(Pe.boundary=16,Pe.storage=16):Ee.isMatrix3?(Pe.boundary=48,Pe.storage=48):Ee.isMatrix4?(Pe.boundary=64,Pe.storage=64):Ee.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",Ee),Pe}function se(Ee){const Pe=Ee.target;Pe.removeEventListener("dispose",se);const Ve=o.indexOf(Pe.__bindingPointIndex);o.splice(Ve,1),n.deleteBuffer(r[Pe.id]),delete r[Pe.id],delete s[Pe.id]}return{bind:function h(Ee,Pe){i.uniformBlockBinding(Ee,Pe.program)},update:function u(Ee,Pe){let Ve=r[Ee.id];void 0===Ve&&(function j(Ee){const Pe=Ee.uniforms;let Ve=0;for(let Lt=0,Kt=Pe.length;Lt<Kt;Lt++){const Bt=Array.isArray(Pe[Lt])?Pe[Lt]:[Pe[Lt]];for(let St=0,Dn=Bt.length;St<Dn;St++){const ti=Bt[St],ci=Array.isArray(ti.value)?ti.value:[ti.value];for(let vi=0,bi=ci.length;vi<bi;vi++){const _i=ne(ci[vi]),si=Ve%16,ir=si%_i.boundary,Nr=si+ir;Ve+=ir,0!==Nr&&16-Nr<_i.storage&&(Ve+=16-Nr),ti.__data=new Float32Array(_i.storage/Float32Array.BYTES_PER_ELEMENT),ti.__offset=Ve,Ve+=_i.storage}}}const Ct=Ve%16;Ct>0&&(Ve+=16-Ct),Ee.__size=Ve,Ee.__cache={}}(Ee),Ve=function f(Ee){const Pe=function y(){for(let Ee=0;Ee<l;Ee++)if(-1===o.indexOf(Ee))return o.push(Ee),Ee;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();Ee.__bindingPointIndex=Pe;const Ve=n.createBuffer(),Ft=Ee.__size,Ct=Ee.usage;return n.bindBuffer(n.UNIFORM_BUFFER,Ve),n.bufferData(n.UNIFORM_BUFFER,Ft,Ct),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,Pe,Ve),Ve}(Ee),r[Ee.id]=Ve,Ee.addEventListener("dispose",se)),i.updateUBOMapping(Ee,Pe.program);const Ct=e.render.frame;s[Ee.id]!==Ct&&(function T(Ee){const Ve=Ee.uniforms,Ft=Ee.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[Ee.id]);for(let Ct=0,Lt=Ve.length;Ct<Lt;Ct++){const Kt=Array.isArray(Ve[Ct])?Ve[Ct]:[Ve[Ct]];for(let Bt=0,St=Kt.length;Bt<St;Bt++){const Dn=Kt[Bt];if(!0===B(Dn,Ct,Bt,Ft)){const ti=Dn.__offset,ci=Array.isArray(Dn.value)?Dn.value:[Dn.value];let vi=0;for(let bi=0;bi<ci.length;bi++){const Un=ci[bi],_i=ne(Un);"number"==typeof Un||"boolean"==typeof Un?(Dn.__data[0]=Un,n.bufferSubData(n.UNIFORM_BUFFER,ti+vi,Dn.__data)):Un.isMatrix3?(Dn.__data[0]=Un.elements[0],Dn.__data[1]=Un.elements[1],Dn.__data[2]=Un.elements[2],Dn.__data[3]=0,Dn.__data[4]=Un.elements[3],Dn.__data[5]=Un.elements[4],Dn.__data[6]=Un.elements[5],Dn.__data[7]=0,Dn.__data[8]=Un.elements[6],Dn.__data[9]=Un.elements[7],Dn.__data[10]=Un.elements[8],Dn.__data[11]=0):(Un.toArray(Dn.__data,vi),vi+=_i.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,ti,Dn.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(Ee),s[Ee.id]=Ct)},dispose:function le(){for(const Ee in r)n.deleteBuffer(r[Ee]);o=[],r={},s={}}}}class M5{constructor(e={}){const{canvas:t=ofe(),context:i=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:l=!1,premultipliedAlpha:h=!0,preserveDrawingBuffer:u=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:y=!1}=e;let T;if(this.isWebGLRenderer=!0,null!==i){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");T=i.getContextAttributes().alpha}else T=o;const B=new Uint32Array(4),j=new Int32Array(4);let ne=null,se=null;const le=[],Ee=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=hu,this.toneMapping=G1,this.toneMappingExposure=1;const Pe=this;let Ve=!1,Ft=0,Ct=0,Lt=null,Kt=-1,Bt=null;const St=new $l,Dn=new $l;let ti=null;const ci=new nr(0);let vi=0,bi=t.width,Un=t.height,_i=1,si=null,ir=null;const Nr=new $l(0,0,bi,Un),Wr=new $l(0,0,bi,Un);let so=!1;const Po=new E4;let Ci=!1,yr=!1;const ps=new go,Rr=new Dt,Gs=new $l,to={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let lo=!1;function La(){return null===Lt?_i:1}let Ur,Ss,sr,Oo,xs,qs,Bn,zt,Ii,ur,hr,_r,Do,vs,Vs,wa,qr,Os,cl,ha,Xs,ma,$a,dh,bn=i;function Kr(nn,ii){return t.getContext(nn,ii)}try{const nn={alpha:!0,depth:r,stencil:s,antialias:l,premultipliedAlpha:h,preserveDrawingBuffer:u,powerPreference:f,failIfMajorPerformanceCaveat:y};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${zb}`),t.addEventListener("webglcontextlost",or,!1),t.addEventListener("webglcontextrestored",Ar,!1),t.addEventListener("webglcontextcreationerror",hs,!1),null===bn){const ii="webgl2";if(bn=Kr(ii,nn),null===bn)throw Kr(ii)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(nn){throw console.error("THREE.WebGLRenderer: "+nn.message),nn}function ri(){Ur=new Hme(bn),Ur.init(),ma=new Ege(bn,Ur),Ss=new Fme(bn,Ur,e,ma),sr=new vge(bn),Oo=new qme(bn),xs=new lge,qs=new Mge(bn,Ur,sr,xs,Ss,ma,Oo),Bn=new Lme(Pe),zt=new zme(Pe),Ii=new Bfe(bn),$a=new Rme(bn,Ii),ur=new Vme(bn,Ii,Oo,$a),hr=new jme(bn,ur,Ii,Oo),cl=new Qme(bn,Ss,qs),wa=new Ome(xs),_r=new age(Pe,Bn,zt,Ur,Ss,$a,wa),Do=new Rge(Pe,xs),vs=new hge,Vs=new Age(Ur),Os=new Pme(Pe,Bn,zt,sr,hr,T,h),qr=new yge(Pe,hr,Ss),dh=new kge(bn,Oo,Ss,sr),ha=new kme(bn,Ur,Oo),Xs=new Gme(bn,Ur,Oo),Oo.programs=_r.programs,Pe.capabilities=Ss,Pe.extensions=Ur,Pe.properties=xs,Pe.renderLists=vs,Pe.shadowMap=qr,Pe.state=sr,Pe.info=Oo}ri();const Jr=new Bge(Pe,bn);function or(nn){nn.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Ve=!0}function Ar(){console.log("THREE.WebGLRenderer: Context Restored."),Ve=!1;const nn=Oo.autoReset,ii=qr.enabled,Si=qr.autoUpdate,Di=qr.needsUpdate,di=qr.type;ri(),Oo.autoReset=nn,qr.enabled=ii,qr.autoUpdate=Si,qr.needsUpdate=Di,qr.type=di}function hs(nn){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",nn.statusMessage)}function Ko(nn){const ii=nn.target;ii.removeEventListener("dispose",Ko),function ml(nn){(function mu(nn){const ii=xs.get(nn).programs;void 0!==ii&&(ii.forEach(function(Si){_r.releaseProgram(Si)}),nn.isShaderMaterial&&_r.releaseShaderCache(nn))})(nn),xs.remove(nn)}(ii)}function wd(nn,ii,Si){!0===nn.transparent&&2===nn.side&&!1===nn.forceSinglePass?(nn.side=1,nn.needsUpdate=!0,VP(nn,ii,Si),nn.side=0,nn.needsUpdate=!0,VP(nn,ii,Si),nn.side=2):VP(nn,ii,Si)}this.xr=Jr,this.getContext=function(){return bn},this.getContextAttributes=function(){return bn.getContextAttributes()},this.forceContextLoss=function(){const nn=Ur.get("WEBGL_lose_context");nn&&nn.loseContext()},this.forceContextRestore=function(){const nn=Ur.get("WEBGL_lose_context");nn&&nn.restoreContext()},this.getPixelRatio=function(){return _i},this.setPixelRatio=function(nn){void 0!==nn&&(_i=nn,this.setSize(bi,Un,!1))},this.getSize=function(nn){return nn.set(bi,Un)},this.setSize=function(nn,ii,Si=!0){Jr.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(bi=nn,Un=ii,t.width=Math.floor(nn*_i),t.height=Math.floor(ii*_i),!0===Si&&(t.style.width=nn+"px",t.style.height=ii+"px"),this.setViewport(0,0,nn,ii))},this.getDrawingBufferSize=function(nn){return nn.set(bi*_i,Un*_i).floor()},this.setDrawingBufferSize=function(nn,ii,Si){bi=nn,Un=ii,_i=Si,t.width=Math.floor(nn*Si),t.height=Math.floor(ii*Si),this.setViewport(0,0,nn,ii)},this.getCurrentViewport=function(nn){return nn.copy(St)},this.getViewport=function(nn){return nn.copy(Nr)},this.setViewport=function(nn,ii,Si,Di){nn.isVector4?Nr.set(nn.x,nn.y,nn.z,nn.w):Nr.set(nn,ii,Si,Di),sr.viewport(St.copy(Nr).multiplyScalar(_i).round())},this.getScissor=function(nn){return nn.copy(Wr)},this.setScissor=function(nn,ii,Si,Di){nn.isVector4?Wr.set(nn.x,nn.y,nn.z,nn.w):Wr.set(nn,ii,Si,Di),sr.scissor(Dn.copy(Wr).multiplyScalar(_i).round())},this.getScissorTest=function(){return so},this.setScissorTest=function(nn){sr.setScissorTest(so=nn)},this.setOpaqueSort=function(nn){si=nn},this.setTransparentSort=function(nn){ir=nn},this.getClearColor=function(nn){return nn.copy(Os.getClearColor())},this.setClearColor=function(){Os.setClearColor.apply(Os,arguments)},this.getClearAlpha=function(){return Os.getClearAlpha()},this.setClearAlpha=function(){Os.setClearAlpha.apply(Os,arguments)},this.clear=function(nn=!0,ii=!0,Si=!0){let Di=0;if(nn){let di=!1;if(null!==Lt){const es=Lt.texture.format;di=es===fO||es===dO||es===WI}if(di){const es=Lt.texture.type,Is=es===$_||es===j1||es===TS||es===Y2||es===cO||es===hO,oo=Os.getClearColor(),no=Os.getClearAlpha(),Vo=oo.r,sa=oo.g,xo=oo.b;Is?(B[0]=Vo,B[1]=sa,B[2]=xo,B[3]=no,bn.clearBufferuiv(bn.COLOR,0,B)):(j[0]=Vo,j[1]=sa,j[2]=xo,j[3]=no,bn.clearBufferiv(bn.COLOR,0,j))}else Di|=bn.COLOR_BUFFER_BIT}ii&&(Di|=bn.DEPTH_BUFFER_BIT),Si&&(Di|=bn.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),bn.clear(Di)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",or,!1),t.removeEventListener("webglcontextrestored",Ar,!1),t.removeEventListener("webglcontextcreationerror",hs,!1),vs.dispose(),Vs.dispose(),xs.dispose(),Bn.dispose(),zt.dispose(),hr.dispose(),$a.dispose(),dh.dispose(),_r.dispose(),Jr.dispose(),Jr.removeEventListener("sessionstart",V0),Jr.removeEventListener("sessionend",vZ),Nx.stop()},this.renderBufferDirect=function(nn,ii,Si,Di,di,es){null===ii&&(ii=to);const Is=di.isMesh&&di.matrixWorld.determinant()<0,oo=function I3e(nn,ii,Si,Di,di){!0!==ii.isScene&&(ii=to),qs.resetTextureUnits();const es=ii.fog,oo=null===Lt?Pe.outputColorSpace:!0===Lt.isXRRenderTarget?Lt.texture.colorSpace:id,no=(Di.isMeshStandardMaterial?zt:Bn).get(Di.envMap||(Di.isMeshStandardMaterial?ii.environment:null)),Vo=!0===Di.vertexColors&&!!Si.attributes.color&&4===Si.attributes.color.itemSize,sa=!!Si.attributes.tangent&&(!!Di.normalMap||Di.anisotropy>0),xo=!!Si.morphAttributes.position,Dl=!!Si.morphAttributes.normal,Vc=!!Si.morphAttributes.color;let Sh=G1;Di.toneMapped&&(null===Lt||!0===Lt.isXRRenderTarget)&&(Sh=Pe.toneMapping);const Bm=Si.morphAttributes.position||Si.morphAttributes.normal||Si.morphAttributes.color,Ll=void 0!==Bm?Bm.length:0,wo=xs.get(Di),Cd=se.state.lights;!0!==Ci||!0!==yr&&nn===Bt||wa.setState(Di,nn,nn===Bt&&Di.id===Kt);let Nl=!1;Di.version===wo.__version?(wo.needsLights&&wo.lightsStateVersion!==Cd.state.version||wo.outputColorSpace!==oo||di.isBatchedMesh&&!1===wo.batching||!di.isBatchedMesh&&!0===wo.batching||di.isBatchedMesh&&!0===wo.batchingColor&&null===di.colorTexture||di.isBatchedMesh&&!1===wo.batchingColor&&null!==di.colorTexture||di.isInstancedMesh&&!1===wo.instancing||!di.isInstancedMesh&&!0===wo.instancing||di.isSkinnedMesh&&!1===wo.skinning||!di.isSkinnedMesh&&!0===wo.skinning||di.isInstancedMesh&&!0===wo.instancingColor&&null===di.instanceColor||di.isInstancedMesh&&!1===wo.instancingColor&&null!==di.instanceColor||di.isInstancedMesh&&!0===wo.instancingMorph&&null===di.morphTexture||di.isInstancedMesh&&!1===wo.instancingMorph&&null!==di.morphTexture||wo.envMap!==no||!0===Di.fog&&wo.fog!==es||void 0!==wo.numClippingPlanes&&(wo.numClippingPlanes!==wa.numPlanes||wo.numIntersection!==wa.numIntersection)||wo.vertexAlphas!==Vo||wo.vertexTangents!==sa||wo.morphTargets!==xo||wo.morphNormals!==Dl||wo.morphColors!==Vc||wo.toneMapping!==Sh||wo.morphTargetsCount!==Ll)&&(Nl=!0):(Nl=!0,wo.__version=Di.version);let Gg=wo.currentProgram;!0===Nl&&(Gg=VP(Di,ii,di));let mM=!1,Pm=!1,l8=!1;const Au=Gg.getUniforms(),_v=wo.uniforms;if(sr.useProgram(Gg.program)&&(mM=!0,Pm=!0,l8=!0),Di.id!==Kt&&(Kt=Di.id,Pm=!0),mM||Bt!==nn){Au.setValue(bn,"projectionMatrix",nn.projectionMatrix),Au.setValue(bn,"viewMatrix",nn.matrixWorldInverse);const BA=Au.map.cameraPosition;void 0!==BA&&BA.setValue(bn,Rr.setFromMatrixPosition(nn.matrixWorld)),Ss.logarithmicDepthBuffer&&Au.setValue(bn,"logDepthBufFC",2/(Math.log(nn.far+1)/Math.LN2)),(Di.isMeshPhongMaterial||Di.isMeshToonMaterial||Di.isMeshLambertMaterial||Di.isMeshBasicMaterial||Di.isMeshStandardMaterial||Di.isShaderMaterial)&&Au.setValue(bn,"isOrthographic",!0===nn.isOrthographicCamera),Bt!==nn&&(Bt=nn,Pm=!0,l8=!0)}if(di.isSkinnedMesh){Au.setOptional(bn,di,"bindMatrix"),Au.setOptional(bn,di,"bindMatrixInverse");const BA=di.skeleton;BA&&(null===BA.boneTexture&&BA.computeBoneTexture(),Au.setValue(bn,"boneTexture",BA.boneTexture,qs))}di.isBatchedMesh&&(Au.setOptional(bn,di,"batchingTexture"),Au.setValue(bn,"batchingTexture",di._matricesTexture,qs),Au.setOptional(bn,di,"batchingIdTexture"),Au.setValue(bn,"batchingIdTexture",di._indirectTexture,qs),Au.setOptional(bn,di,"batchingColorTexture"),null!==di._colorsTexture&&Au.setValue(bn,"batchingColorTexture",di._colorsTexture,qs));const c8=Si.morphAttributes;if((void 0!==c8.position||void 0!==c8.normal||void 0!==c8.color)&&cl.update(di,Si,Gg),(Pm||wo.receiveShadow!==di.receiveShadow)&&(wo.receiveShadow=di.receiveShadow,Au.setValue(bn,"receiveShadow",di.receiveShadow)),Di.isMeshGouraudMaterial&&null!==Di.envMap&&(_v.envMap.value=no,_v.flipEnvMap.value=no.isCubeTexture&&!1===no.isRenderTargetTexture?-1:1),Di.isMeshStandardMaterial&&null===Di.envMap&&null!==ii.environment&&(_v.envMapIntensity.value=ii.environmentIntensity),Pm&&(Au.setValue(bn,"toneMappingExposure",Pe.toneMappingExposure),wo.needsLights&&function B3e(nn,ii){nn.ambientLightColor.needsUpdate=ii,nn.lightProbe.needsUpdate=ii,nn.directionalLights.needsUpdate=ii,nn.directionalLightShadows.needsUpdate=ii,nn.pointLights.needsUpdate=ii,nn.pointLightShadows.needsUpdate=ii,nn.spotLights.needsUpdate=ii,nn.spotLightShadows.needsUpdate=ii,nn.rectAreaLights.needsUpdate=ii,nn.hemisphereLights.needsUpdate=ii}(_v,l8),es&&!0===Di.fog&&Do.refreshFogUniforms(_v,es),Do.refreshMaterialUniforms(_v,Di,_i,Un,se.state.transmissionRenderTarget[nn.id]),I4.upload(bn,CZ(wo),_v,qs)),Di.isShaderMaterial&&!0===Di.uniformsNeedUpdate&&(I4.upload(bn,CZ(wo),_v,qs),Di.uniformsNeedUpdate=!1),Di.isSpriteMaterial&&Au.setValue(bn,"center",di.center),Au.setValue(bn,"modelViewMatrix",di.modelViewMatrix),Au.setValue(bn,"normalMatrix",di.normalMatrix),Au.setValue(bn,"modelMatrix",di.matrixWorld),Di.isShaderMaterial||Di.isRawShaderMaterial){const BA=Di.uniformsGroups;for(let h8=0,R3e=BA.length;h8<R3e;h8++){const EZ=BA[h8];dh.update(EZ,Gg),dh.bind(EZ,Gg)}}return Gg}(nn,ii,Si,Di,di);sr.setMaterial(Di,Is);let no=Si.index,Vo=1;if(!0===Di.wireframe){if(no=ur.getWireframeAttribute(Si),void 0===no)return;Vo=2}const sa=Si.drawRange,xo=Si.attributes.position;let Dl=sa.start*Vo,Vc=(sa.start+sa.count)*Vo;null!==es&&(Dl=Math.max(Dl,es.start*Vo),Vc=Math.min(Vc,(es.start+es.count)*Vo)),null!==no?(Dl=Math.max(Dl,0),Vc=Math.min(Vc,no.count)):null!=xo&&(Dl=Math.max(Dl,0),Vc=Math.min(Vc,xo.count));const Sh=Vc-Dl;if(Sh<0||Sh===1/0)return;$a.setup(di,Di,oo,Si,no);let Bm,Ll=ha;if(null!==no&&(Bm=Ii.get(no),Ll=Xs,Ll.setIndex(Bm)),di.isMesh)!0===Di.wireframe?(sr.setLineWidth(Di.wireframeLinewidth*La()),Ll.setMode(bn.LINES)):Ll.setMode(bn.TRIANGLES);else if(di.isLine){let wo=Di.linewidth;void 0===wo&&(wo=1),sr.setLineWidth(wo*La()),Ll.setMode(di.isLineSegments?bn.LINES:di.isLineLoop?bn.LINE_LOOP:bn.LINE_STRIP)}else di.isPoints?Ll.setMode(bn.POINTS):di.isSprite&&Ll.setMode(bn.TRIANGLES);if(di.isBatchedMesh)if(null!==di._multiDrawInstances)Ll.renderMultiDrawInstances(di._multiDrawStarts,di._multiDrawCounts,di._multiDrawCount,di._multiDrawInstances);else if(Ur.get("WEBGL_multi_draw"))Ll.renderMultiDraw(di._multiDrawStarts,di._multiDrawCounts,di._multiDrawCount);else{const wo=di._multiDrawStarts,Cd=di._multiDrawCounts,Nl=di._multiDrawCount,Gg=no?Ii.get(no).bytesPerElement:1,mM=xs.get(Di).currentProgram.getUniforms();for(let Pm=0;Pm<Nl;Pm++)mM.setValue(bn,"_gl_DrawID",Pm),Ll.render(wo[Pm]/Gg,Cd[Pm])}else if(di.isInstancedMesh)Ll.renderInstances(Dl,Sh,di.count);else if(Si.isInstancedBufferGeometry){const Cd=Math.min(Si.instanceCount,void 0!==Si._maxInstanceCount?Si._maxInstanceCount:1/0);Ll.renderInstances(Dl,Sh,Cd)}else Ll.render(Dl,Sh)},this.compile=function(nn,ii,Si=null){null===Si&&(Si=nn),se=Vs.get(Si),se.init(ii),Ee.push(se),Si.traverseVisible(function(di){di.isLight&&di.layers.test(ii.layers)&&(se.pushLight(di),di.castShadow&&se.pushShadow(di))}),nn!==Si&&nn.traverseVisible(function(di){di.isLight&&di.layers.test(ii.layers)&&(se.pushLight(di),di.castShadow&&se.pushShadow(di))}),se.setupLights();const Di=new Set;return nn.traverse(function(di){const es=di.material;if(es)if(Array.isArray(es))for(let Is=0;Is<es.length;Is++){const oo=es[Is];wd(oo,Si,di),Di.add(oo)}else wd(es,Si,di),Di.add(es)}),Ee.pop(),se=null,Di},this.compileAsync=function(nn,ii,Si=null){const Di=this.compile(nn,ii,Si);return new Promise(di=>{function es(){Di.forEach(function(Is){xs.get(Is).currentProgram.isReady()&&Di.delete(Is)}),0!==Di.size?setTimeout(es,10):di(nn)}null!==Ur.get("KHR_parallel_shader_compile")?es():setTimeout(es,10)})};let Ol=null;function V0(){Nx.stop()}function vZ(){Nx.start()}const Nx=new $q;function a8(nn,ii,Si,Di){if(!1===nn.visible)return;if(nn.layers.test(ii.layers))if(nn.isGroup)Si=nn.renderOrder;else if(nn.isLOD)!0===nn.autoUpdate&&nn.update(ii);else if(nn.isLight)se.pushLight(nn),nn.castShadow&&se.pushShadow(nn);else if(nn.isSprite){if(!nn.frustumCulled||Po.intersectsSprite(nn)){Di&&Gs.setFromMatrixPosition(nn.matrixWorld).applyMatrix4(ps);const Is=hr.update(nn),oo=nn.material;oo.visible&&ne.push(nn,Is,oo,Si,Gs.z,null)}}else if((nn.isMesh||nn.isLine||nn.isPoints)&&(!nn.frustumCulled||Po.intersectsObject(nn))){const Is=hr.update(nn),oo=nn.material;if(Di&&(void 0!==nn.boundingSphere?(null===nn.boundingSphere&&nn.computeBoundingSphere(),Gs.copy(nn.boundingSphere.center)):(null===Is.boundingSphere&&Is.computeBoundingSphere(),Gs.copy(Is.boundingSphere.center)),Gs.applyMatrix4(nn.matrixWorld).applyMatrix4(ps)),Array.isArray(oo)){const no=Is.groups;for(let Vo=0,sa=no.length;Vo<sa;Vo++){const xo=no[Vo],Dl=oo[xo.materialIndex];Dl&&Dl.visible&&ne.push(nn,Is,Dl,Si,Gs.z,xo)}}else oo.visible&&ne.push(nn,Is,oo,Si,Gs.z,null)}const es=nn.children;for(let Is=0,oo=es.length;Is<oo;Is++)a8(es[Is],ii,Si,Di)}function bZ(nn,ii,Si,Di){const di=nn.opaque,es=nn.transmissive,Is=nn.transparent;se.setupLightsView(Si),!0===Ci&&wa.setGlobalState(Pe.clippingPlanes,Si),Di&&sr.viewport(St.copy(Di)),di.length>0&&HP(di,ii,Si),es.length>0&&HP(es,ii,Si),Is.length>0&&HP(Is,ii,Si),sr.buffers.depth.setTest(!0),sr.buffers.depth.setMask(!0),sr.buffers.color.setMask(!0),sr.setPolygonOffset(!1)}function xZ(nn,ii,Si,Di){if(null!==(!0===Si.isScene?Si.overrideMaterial:null))return;void 0===se.state.transmissionRenderTarget[Di.id]&&(se.state.transmissionRenderTarget[Di.id]=new rd(1,1,{generateMipmaps:!0,type:Ur.has("EXT_color_buffer_half_float")||Ur.has("EXT_color_buffer_float")?wA:$_,minFilter:xA,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:pl.workingColorSpace}));const es=se.state.transmissionRenderTarget[Di.id],Is=Di.viewport||St;es.setSize(Is.z,Is.w);const oo=Pe.getRenderTarget();Pe.setRenderTarget(es),Pe.getClearColor(ci),vi=Pe.getClearAlpha(),vi<1&&Pe.setClearColor(16777215,.5),Pe.clear(),lo&&Os.render(Si);const no=Pe.toneMapping;Pe.toneMapping=G1;const Vo=Di.viewport;if(void 0!==Di.viewport&&(Di.viewport=void 0),se.setupLightsView(Di),!0===Ci&&wa.setGlobalState(Pe.clippingPlanes,Di),HP(nn,Si,Di),qs.updateMultisampleRenderTarget(es),qs.updateRenderTargetMipmap(es),!1===Ur.has("WEBGL_multisampled_render_to_texture")){let sa=!1;for(let xo=0,Dl=ii.length;xo<Dl;xo++){const Vc=ii[xo],Sh=Vc.object,Bm=Vc.geometry,Ll=Vc.material,wo=Vc.group;if(2===Ll.side&&Sh.layers.test(Di.layers)){const Cd=Ll.side;Ll.side=1,Ll.needsUpdate=!0,wZ(Sh,Si,Di,Bm,Ll,wo),Ll.side=Cd,Ll.needsUpdate=!0,sa=!0}}!0===sa&&(qs.updateMultisampleRenderTarget(es),qs.updateRenderTargetMipmap(es))}Pe.setRenderTarget(oo),Pe.setClearColor(ci,vi),void 0!==Vo&&(Di.viewport=Vo),Pe.toneMapping=no}function HP(nn,ii,Si){const Di=!0===ii.isScene?ii.overrideMaterial:null;for(let di=0,es=nn.length;di<es;di++){const Is=nn[di],oo=Is.object,no=Is.geometry,Vo=null===Di?Is.material:Di,sa=Is.group;oo.layers.test(Si.layers)&&wZ(oo,ii,Si,no,Vo,sa)}}function wZ(nn,ii,Si,Di,di,es){nn.onBeforeRender(Pe,ii,Si,Di,di,es),nn.modelViewMatrix.multiplyMatrices(Si.matrixWorldInverse,nn.matrixWorld),nn.normalMatrix.getNormalMatrix(nn.modelViewMatrix),di.onBeforeRender(Pe,ii,Si,Di,nn,es),!0===di.transparent&&2===di.side&&!1===di.forceSinglePass?(di.side=1,di.needsUpdate=!0,Pe.renderBufferDirect(Si,ii,Di,di,nn,es),di.side=0,di.needsUpdate=!0,Pe.renderBufferDirect(Si,ii,Di,di,nn,es),di.side=2):Pe.renderBufferDirect(Si,ii,Di,di,nn,es),nn.onAfterRender(Pe,ii,Si,Di,di,es)}function VP(nn,ii,Si){!0!==ii.isScene&&(ii=to);const Di=xs.get(nn),di=se.state.lights,Is=di.state.version,oo=_r.getParameters(nn,di.state,se.state.shadowsArray,ii,Si),no=_r.getProgramCacheKey(oo);let Vo=Di.programs;Di.environment=nn.isMeshStandardMaterial?ii.environment:null,Di.fog=ii.fog,Di.envMap=(nn.isMeshStandardMaterial?zt:Bn).get(nn.envMap||Di.environment),Di.envMapRotation=null!==Di.environment&&null===nn.envMap?ii.environmentRotation:nn.envMapRotation,void 0===Vo&&(nn.addEventListener("dispose",Ko),Vo=new Map,Di.programs=Vo);let sa=Vo.get(no);if(void 0!==sa){if(Di.currentProgram===sa&&Di.lightsStateVersion===Is)return MZ(nn,oo),sa}else oo.uniforms=_r.getUniforms(nn),nn.onBeforeCompile(oo,Pe),sa=_r.acquireProgram(oo,no),Vo.set(no,sa),Di.uniforms=oo.uniforms;const xo=Di.uniforms;return(!nn.isShaderMaterial&&!nn.isRawShaderMaterial||!0===nn.clipping)&&(xo.clippingPlanes=wa.uniform),MZ(nn,oo),Di.needsLights=function P3e(nn){return nn.isMeshLambertMaterial||nn.isMeshToonMaterial||nn.isMeshPhongMaterial||nn.isMeshStandardMaterial||nn.isShadowMaterial||nn.isShaderMaterial&&!0===nn.lights}(nn),Di.lightsStateVersion=Is,Di.needsLights&&(xo.ambientLightColor.value=di.state.ambient,xo.lightProbe.value=di.state.probe,xo.directionalLights.value=di.state.directional,xo.directionalLightShadows.value=di.state.directionalShadow,xo.spotLights.value=di.state.spot,xo.spotLightShadows.value=di.state.spotShadow,xo.rectAreaLights.value=di.state.rectArea,xo.ltc_1.value=di.state.rectAreaLTC1,xo.ltc_2.value=di.state.rectAreaLTC2,xo.pointLights.value=di.state.point,xo.pointLightShadows.value=di.state.pointShadow,xo.hemisphereLights.value=di.state.hemi,xo.directionalShadowMap.value=di.state.directionalShadowMap,xo.directionalShadowMatrix.value=di.state.directionalShadowMatrix,xo.spotShadowMap.value=di.state.spotShadowMap,xo.spotLightMatrix.value=di.state.spotLightMatrix,xo.spotLightMap.value=di.state.spotLightMap,xo.pointShadowMap.value=di.state.pointShadowMap,xo.pointShadowMatrix.value=di.state.pointShadowMatrix),Di.currentProgram=sa,Di.uniformsList=null,sa}function CZ(nn){if(null===nn.uniformsList){const ii=nn.currentProgram.getUniforms();nn.uniformsList=I4.seqWithValue(ii.seq,nn.uniforms)}return nn.uniformsList}function MZ(nn,ii){const Si=xs.get(nn);Si.outputColorSpace=ii.outputColorSpace,Si.batching=ii.batching,Si.batchingColor=ii.batchingColor,Si.instancing=ii.instancing,Si.instancingColor=ii.instancingColor,Si.instancingMorph=ii.instancingMorph,Si.skinning=ii.skinning,Si.morphTargets=ii.morphTargets,Si.morphNormals=ii.morphNormals,Si.morphColors=ii.morphColors,Si.morphTargetsCount=ii.morphTargetsCount,Si.numClippingPlanes=ii.numClippingPlanes,Si.numIntersection=ii.numClipIntersection,Si.vertexAlphas=ii.vertexAlphas,Si.vertexTangents=ii.vertexTangents,Si.toneMapping=ii.toneMapping}Nx.setAnimationLoop(function gy(nn){Ol&&Ol(nn)}),typeof self<"u"&&Nx.setContext(self),this.setAnimationLoop=function(nn){Ol=nn,Jr.setAnimationLoop(nn),null===nn?Nx.stop():Nx.start()},Jr.addEventListener("sessionstart",V0),Jr.addEventListener("sessionend",vZ),this.render=function(nn,ii){if(void 0!==ii&&!0!==ii.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===Ve)return;if(!0===nn.matrixWorldAutoUpdate&&nn.updateMatrixWorld(),null===ii.parent&&!0===ii.matrixWorldAutoUpdate&&ii.updateMatrixWorld(),!0===Jr.enabled&&!0===Jr.isPresenting&&(!0===Jr.cameraAutoUpdate&&Jr.updateCamera(ii),ii=Jr.getCamera()),!0===nn.isScene&&nn.onBeforeRender(Pe,nn,ii,Lt),se=Vs.get(nn,Ee.length),se.init(ii),Ee.push(se),ps.multiplyMatrices(ii.projectionMatrix,ii.matrixWorldInverse),Po.setFromProjectionMatrix(ps),yr=this.localClippingEnabled,Ci=wa.init(this.clippingPlanes,yr),ne=vs.get(nn,le.length),ne.init(),le.push(ne),!0===Jr.enabled&&!0===Jr.isPresenting){const es=Pe.xr.getDepthSensingMesh();null!==es&&a8(es,ii,-1/0,Pe.sortObjects)}a8(nn,ii,0,Pe.sortObjects),ne.finish(),!0===Pe.sortObjects&&ne.sort(si,ir),lo=!1===Jr.enabled||!1===Jr.isPresenting||!1===Jr.hasDepthSensing(),lo&&Os.addToRenderList(ne,nn),this.info.render.frame++,!0===Ci&&wa.beginShadows(),qr.render(se.state.shadowsArray,nn,ii),!0===Ci&&wa.endShadows(),!0===this.info.autoReset&&this.info.reset();const Di=ne.opaque,di=ne.transmissive;if(se.setupLights(),ii.isArrayCamera){const es=ii.cameras;if(di.length>0)for(let Is=0,oo=es.length;Is<oo;Is++)xZ(Di,di,nn,es[Is]);lo&&Os.render(nn);for(let Is=0,oo=es.length;Is<oo;Is++){const no=es[Is];bZ(ne,nn,no,no.viewport)}}else di.length>0&&xZ(Di,di,nn,ii),lo&&Os.render(nn),bZ(ne,nn,ii);null!==Lt&&(qs.updateMultisampleRenderTarget(Lt),qs.updateRenderTargetMipmap(Lt)),!0===nn.isScene&&nn.onAfterRender(Pe,nn,ii),$a.resetDefaultState(),Kt=-1,Bt=null,Ee.pop(),Ee.length>0?(se=Ee[Ee.length-1],!0===Ci&&wa.setGlobalState(Pe.clippingPlanes,se.state.camera)):se=null,le.pop(),ne=le.length>0?le[le.length-1]:null},this.getActiveCubeFace=function(){return Ft},this.getActiveMipmapLevel=function(){return Ct},this.getRenderTarget=function(){return Lt},this.setRenderTargetTextures=function(nn,ii,Si){xs.get(nn.texture).__webglTexture=ii,xs.get(nn.depthTexture).__webglTexture=Si;const Di=xs.get(nn);Di.__hasExternalTextures=!0,Di.__autoAllocateDepthBuffer=void 0===Si,Di.__autoAllocateDepthBuffer||!0===Ur.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Di.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(nn,ii){const Si=xs.get(nn);Si.__webglFramebuffer=ii,Si.__useDefaultFramebuffer=void 0===ii},this.setRenderTarget=function(nn,ii=0,Si=0){Lt=nn,Ft=ii,Ct=Si;let Di=!0,di=null,es=!1,Is=!1;if(nn){const no=xs.get(nn);if(void 0!==no.__useDefaultFramebuffer)sr.bindFramebuffer(bn.FRAMEBUFFER,null),Di=!1;else if(void 0===no.__webglFramebuffer)qs.setupRenderTarget(nn);else if(no.__hasExternalTextures)qs.rebindTextures(nn,xs.get(nn.texture).__webglTexture,xs.get(nn.depthTexture).__webglTexture);else if(nn.depthBuffer){const xo=nn.depthTexture;if(no.__boundDepthTexture!==xo){if(null!==xo&&xs.has(xo)&&(nn.width!==xo.image.width||nn.height!==xo.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");qs.setupDepthRenderbuffer(nn)}}const Vo=nn.texture;(Vo.isData3DTexture||Vo.isDataArrayTexture||Vo.isCompressedArrayTexture)&&(Is=!0);const sa=xs.get(nn).__webglFramebuffer;nn.isWebGLCubeRenderTarget?(di=Array.isArray(sa[ii])?sa[ii][Si]:sa[ii],es=!0):di=nn.samples>0&&!1===qs.useMultisampledRTT(nn)?xs.get(nn).__webglMultisampledFramebuffer:Array.isArray(sa)?sa[Si]:sa,St.copy(nn.viewport),Dn.copy(nn.scissor),ti=nn.scissorTest}else St.copy(Nr).multiplyScalar(_i).floor(),Dn.copy(Wr).multiplyScalar(_i).floor(),ti=so;if(sr.bindFramebuffer(bn.FRAMEBUFFER,di)&&Di&&sr.drawBuffers(nn,di),sr.viewport(St),sr.scissor(Dn),sr.setScissorTest(ti),es){const no=xs.get(nn.texture);bn.framebufferTexture2D(bn.FRAMEBUFFER,bn.COLOR_ATTACHMENT0,bn.TEXTURE_CUBE_MAP_POSITIVE_X+ii,no.__webglTexture,Si)}else if(Is){const no=xs.get(nn.texture);bn.framebufferTextureLayer(bn.FRAMEBUFFER,bn.COLOR_ATTACHMENT0,no.__webglTexture,Si||0,ii||0)}Kt=-1},this.readRenderTargetPixels=function(nn,ii,Si,Di,di,es,Is){if(!nn||!nn.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let oo=xs.get(nn).__webglFramebuffer;if(nn.isWebGLCubeRenderTarget&&void 0!==Is&&(oo=oo[Is]),oo){sr.bindFramebuffer(bn.FRAMEBUFFER,oo);try{const no=nn.texture,Vo=no.format,sa=no.type;if(!Ss.textureFormatReadable(Vo))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!Ss.textureTypeReadable(sa))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ii>=0&&ii<=nn.width-Di&&Si>=0&&Si<=nn.height-di&&bn.readPixels(ii,Si,Di,di,ma.convert(Vo),ma.convert(sa),es)}finally{const no=null!==Lt?xs.get(Lt).__webglFramebuffer:null;sr.bindFramebuffer(bn.FRAMEBUFFER,no)}}},this.readRenderTargetPixelsAsync=function(){var nn=(0,al.A)(function*(ii,Si,Di,di,es,Is,oo){if(!ii||!ii.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let no=xs.get(ii).__webglFramebuffer;if(ii.isWebGLCubeRenderTarget&&void 0!==oo&&(no=no[oo]),no){sr.bindFramebuffer(bn.FRAMEBUFFER,no);try{const Vo=ii.texture,sa=Vo.format,xo=Vo.type;if(!Ss.textureFormatReadable(sa))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ss.textureTypeReadable(xo))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(Si>=0&&Si<=ii.width-di&&Di>=0&&Di<=ii.height-es){const Dl=bn.createBuffer();bn.bindBuffer(bn.PIXEL_PACK_BUFFER,Dl),bn.bufferData(bn.PIXEL_PACK_BUFFER,Is.byteLength,bn.STREAM_READ),bn.readPixels(Si,Di,di,es,ma.convert(sa),ma.convert(xo),0),bn.flush();const Vc=bn.fenceSync(bn.SYNC_GPU_COMMANDS_COMPLETE,0);yield function afe(n,e,t){return new Promise(function(i,r){setTimeout(function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:r();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:i()}},t)})}(bn,Vc,4);try{bn.bindBuffer(bn.PIXEL_PACK_BUFFER,Dl),bn.getBufferSubData(bn.PIXEL_PACK_BUFFER,0,Is)}finally{bn.deleteBuffer(Dl),bn.deleteSync(Vc)}return Is}}finally{const Vo=null!==Lt?xs.get(Lt).__webglFramebuffer:null;sr.bindFramebuffer(bn.FRAMEBUFFER,Vo)}}});return function(ii,Si,Di,di,es,Is,oo){return nn.apply(this,arguments)}}(),this.copyFramebufferToTexture=function(nn,ii=null,Si=0){!0!==nn.isTexture&&(oC("WebGLRenderer: copyFramebufferToTexture function signature has changed."),ii=arguments[0]||null,nn=arguments[1]);const Di=Math.pow(2,-Si),di=Math.floor(nn.image.width*Di),es=Math.floor(nn.image.height*Di),Is=null!==ii?ii.x:0,oo=null!==ii?ii.y:0;qs.setTexture2D(nn,0),bn.copyTexSubImage2D(bn.TEXTURE_2D,Si,0,0,Is,oo,di,es),sr.unbindTexture()},this.copyTextureToTexture=function(nn,ii,Si=null,Di=null,di=0){let es,Is,oo,no,Vo,sa;!0!==nn.isTexture&&(oC("WebGLRenderer: copyTextureToTexture function signature has changed."),Di=arguments[0]||null,nn=arguments[1],ii=arguments[2],di=arguments[3]||0,Si=null),null!==Si?(es=Si.max.x-Si.min.x,Is=Si.max.y-Si.min.y,oo=Si.min.x,no=Si.min.y):(es=nn.image.width,Is=nn.image.height,oo=0,no=0),null!==Di?(Vo=Di.x,sa=Di.y):(Vo=0,sa=0);const xo=ma.convert(ii.format),Dl=ma.convert(ii.type);qs.setTexture2D(ii,0),bn.pixelStorei(bn.UNPACK_FLIP_Y_WEBGL,ii.flipY),bn.pixelStorei(bn.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ii.premultiplyAlpha),bn.pixelStorei(bn.UNPACK_ALIGNMENT,ii.unpackAlignment);const Vc=bn.getParameter(bn.UNPACK_ROW_LENGTH),Sh=bn.getParameter(bn.UNPACK_IMAGE_HEIGHT),Bm=bn.getParameter(bn.UNPACK_SKIP_PIXELS),Ll=bn.getParameter(bn.UNPACK_SKIP_ROWS),wo=bn.getParameter(bn.UNPACK_SKIP_IMAGES),Cd=nn.isCompressedTexture?nn.mipmaps[di]:nn.image;bn.pixelStorei(bn.UNPACK_ROW_LENGTH,Cd.width),bn.pixelStorei(bn.UNPACK_IMAGE_HEIGHT,Cd.height),bn.pixelStorei(bn.UNPACK_SKIP_PIXELS,oo),bn.pixelStorei(bn.UNPACK_SKIP_ROWS,no),nn.isDataTexture?bn.texSubImage2D(bn.TEXTURE_2D,di,Vo,sa,es,Is,xo,Dl,Cd.data):nn.isCompressedTexture?bn.compressedTexSubImage2D(bn.TEXTURE_2D,di,Vo,sa,Cd.width,Cd.height,xo,Cd.data):bn.texSubImage2D(bn.TEXTURE_2D,di,Vo,sa,es,Is,xo,Dl,Cd),bn.pixelStorei(bn.UNPACK_ROW_LENGTH,Vc),bn.pixelStorei(bn.UNPACK_IMAGE_HEIGHT,Sh),bn.pixelStorei(bn.UNPACK_SKIP_PIXELS,Bm),bn.pixelStorei(bn.UNPACK_SKIP_ROWS,Ll),bn.pixelStorei(bn.UNPACK_SKIP_IMAGES,wo),0===di&&ii.generateMipmaps&&bn.generateMipmap(bn.TEXTURE_2D),sr.unbindTexture()},this.copyTextureToTexture3D=function(nn,ii,Si=null,Di=null,di=0){let es,Is,oo,no,Vo,sa,xo,Dl,Vc;!0!==nn.isTexture&&(oC("WebGLRenderer: copyTextureToTexture3D function signature has changed."),Si=arguments[0]||null,Di=arguments[1]||null,nn=arguments[2],ii=arguments[3],di=arguments[4]||0);const Sh=nn.isCompressedTexture?nn.mipmaps[di]:nn.image;null!==Si?(es=Si.max.x-Si.min.x,Is=Si.max.y-Si.min.y,oo=Si.max.z-Si.min.z,no=Si.min.x,Vo=Si.min.y,sa=Si.min.z):(es=Sh.width,Is=Sh.height,oo=Sh.depth,no=0,Vo=0,sa=0),null!==Di?(xo=Di.x,Dl=Di.y,Vc=Di.z):(xo=0,Dl=0,Vc=0);const Bm=ma.convert(ii.format),Ll=ma.convert(ii.type);let wo;if(ii.isData3DTexture)qs.setTexture3D(ii,0),wo=bn.TEXTURE_3D;else{if(!ii.isDataArrayTexture&&!ii.isCompressedArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");qs.setTexture2DArray(ii,0),wo=bn.TEXTURE_2D_ARRAY}bn.pixelStorei(bn.UNPACK_FLIP_Y_WEBGL,ii.flipY),bn.pixelStorei(bn.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ii.premultiplyAlpha),bn.pixelStorei(bn.UNPACK_ALIGNMENT,ii.unpackAlignment);const Cd=bn.getParameter(bn.UNPACK_ROW_LENGTH),Nl=bn.getParameter(bn.UNPACK_IMAGE_HEIGHT),Gg=bn.getParameter(bn.UNPACK_SKIP_PIXELS),mM=bn.getParameter(bn.UNPACK_SKIP_ROWS),Pm=bn.getParameter(bn.UNPACK_SKIP_IMAGES);bn.pixelStorei(bn.UNPACK_ROW_LENGTH,Sh.width),bn.pixelStorei(bn.UNPACK_IMAGE_HEIGHT,Sh.height),bn.pixelStorei(bn.UNPACK_SKIP_PIXELS,no),bn.pixelStorei(bn.UNPACK_SKIP_ROWS,Vo),bn.pixelStorei(bn.UNPACK_SKIP_IMAGES,sa),nn.isDataTexture||nn.isData3DTexture?bn.texSubImage3D(wo,di,xo,Dl,Vc,es,Is,oo,Bm,Ll,Sh.data):ii.isCompressedArrayTexture?bn.compressedTexSubImage3D(wo,di,xo,Dl,Vc,es,Is,oo,Bm,Sh.data):bn.texSubImage3D(wo,di,xo,Dl,Vc,es,Is,oo,Bm,Ll,Sh),bn.pixelStorei(bn.UNPACK_ROW_LENGTH,Cd),bn.pixelStorei(bn.UNPACK_IMAGE_HEIGHT,Nl),bn.pixelStorei(bn.UNPACK_SKIP_PIXELS,Gg),bn.pixelStorei(bn.UNPACK_SKIP_ROWS,mM),bn.pixelStorei(bn.UNPACK_SKIP_IMAGES,Pm),0===di&&ii.generateMipmaps&&bn.generateMipmap(wo),sr.unbindTexture()},this.initRenderTarget=function(nn){void 0===xs.get(nn).__webglFramebuffer&&qs.setupRenderTarget(nn)},this.initTexture=function(nn){nn.isCubeTexture?qs.setTextureCube(nn,0):nn.isData3DTexture?qs.setTexture3D(nn,0):nn.isDataArrayTexture||nn.isCompressedArrayTexture?qs.setTexture2DArray(nn,0):qs.setTexture2D(nn,0),sr.unbindTexture()},this.resetState=function(){Ft=0,Ct=0,Lt=null,sr.reset(),$a.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Y_}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===GO?"display-p3":"srgb",t.unpackColorSpace=pl.workingColorSpace===e4?"display-p3":"srgb"}}class E5{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new nr(e),this.density=t}clone(){return new E5(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class S5{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new nr(e),this.near=t,this.far=i}clone(){return new S5(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class US extends Wa{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new B0,this.environmentIntensity=1,this.environmentRotation=new B0,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class P4{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=vm()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return oC("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=vm()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=vm()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Qf=new Dt;class ix{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Qf.fromBufferAttribute(this,t),Qf.applyMatrix4(e),this.setXYZ(t,Qf.x,Qf.y,Qf.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Qf.fromBufferAttribute(this,t),Qf.applyNormalMatrix(e),this.setXYZ(t,Qf.x,Qf.y,Qf.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Qf.fromBufferAttribute(this,t),Qf.transformDirection(e),this.setXYZ(t,Qf.x,Qf.y,Qf.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=Vf(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=ba(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=ba(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ba(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ba(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ba(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Vf(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Vf(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Vf(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Vf(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=ba(t,this.array),i=ba(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=ba(t,this.array),i=ba(i,this.array),r=ba(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=ba(t,this.array),i=ba(i,this.array),r=ba(r,this.array),s=ba(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new To(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ix(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class MQ extends ch{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new nr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let DC;const zS=new Dt,IC=new Dt,BC=new Dt,PC=new Fi,HS=new Fi,EQ=new go,R4=new Dt,VS=new Dt,k4=new Dt,SQ=new Fi,T5=new Fi,TQ=new Fi;class Fge extends Wa{constructor(e=new MQ){if(super(),this.isSprite=!0,this.type="Sprite",void 0===DC){DC=new Hs;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new P4(t,5);DC.setIndex([0,1,2,0,2,3]),DC.setAttribute("position",new ix(i,3,0,!1)),DC.setAttribute("uv",new ix(i,2,3,!1))}this.geometry=DC,this.material=e,this.center=new Fi(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),IC.setFromMatrixScale(this.matrixWorld),EQ.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),BC.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&IC.multiplyScalar(-BC.z);const i=this.material.rotation;let r,s;0!==i&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;F4(R4.set(-.5,-.5,0),BC,o,IC,r,s),F4(VS.set(.5,-.5,0),BC,o,IC,r,s),F4(k4.set(.5,.5,0),BC,o,IC,r,s),SQ.set(0,0),T5.set(1,0),TQ.set(1,1);let l=e.ray.intersectTriangle(R4,VS,k4,!1,zS);if(null===l&&(F4(VS.set(-.5,.5,0),BC,o,IC,r,s),T5.set(0,1),l=e.ray.intersectTriangle(R4,k4,VS,!1,zS),null===l))return;const h=e.ray.origin.distanceTo(zS);h<e.near||h>e.far||t.push({distance:h,point:zS.clone(),uv:xm.getInterpolation(zS,R4,VS,k4,SQ,T5,TQ,new Fi),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function F4(n,e,t,i,r,s){PC.subVectors(n,t).addScalar(.5).multiply(i),void 0!==r?(HS.x=s*PC.x-r*PC.y,HS.y=r*PC.x+s*PC.y):HS.copy(PC),n.copy(e),n.x+=HS.x,n.y+=HS.y,n.applyMatrix4(EQ)}const O4=new Dt,DQ=new Dt;class Oge extends Wa{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const s=t[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r;i++){let s=t[i].distance;if(t[i].object.visible&&(s-=s*t[i].hysteresis),e<s)break}return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){O4.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(O4);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){O4.setFromMatrixPosition(e.matrixWorld),DQ.setFromMatrixPosition(this.matrixWorld);const i=O4.distanceTo(DQ)/e.zoom;let r,s;for(t[0].object.visible=!0,r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),!(i>=o))break;t[r-1].object.visible=!1,t[r].object.visible=!0}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const IQ=new Dt,BQ=new $l,PQ=new $l,Lge=new Dt,RQ=new go,L4=new Dt,D5=new sd,kQ=new go,I5=new dC;class FQ extends jo{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=oq,this.bindMatrix=new go,this.bindMatrixInverse=new go,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Gf),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,L4),this.boundingBox.expandByPoint(L4)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new sd),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,L4),this.boundingSphere.expandByPoint(L4)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),D5.copy(this.boundingSphere),D5.applyMatrix4(r),!1!==e.ray.intersectsSphere(D5)&&(kQ.copy(r).invert(),I5.copy(e.ray).applyMatrix4(kQ),(null===this.boundingBox||!1!==I5.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,I5)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new $l,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===oq?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;BQ.fromBufferAttribute(r.attributes.skinIndex,e),PQ.fromBufferAttribute(r.attributes.skinWeight,e),IQ.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=PQ.getComponent(s);if(0!==o){const l=BQ.getComponent(s);RQ.multiplyMatrices(i.bones[l].matrixWorld,i.boneInverses[l]),t.addScaledVector(Lge.copy(IQ).applyMatrix4(RQ),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class B5 extends Wa{constructor(){super(),this.isBone=!0,this.type="Bone"}}class ry extends Yd{constructor(e=null,t=1,i=1,r,s,o,l,h,u=Fu,f=Fu,y,T){super(null,o,l,h,u,f,r,s,y,T),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const OQ=new go,Nge=new go;class N4{constructor(e=[],t=[]){this.uuid=vm(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new go)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new go;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)OQ.multiplyMatrices(e[s]?e[s].matrixWorld:Nge,t[s]),OQ.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new N4(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new ry(t,e,e,Hf,ym);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new B5),this.bones.push(o),this.boneInverses.push((new go).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class RC extends To{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const kC=new go,LQ=new go,U4=[],NQ=new Gf,Uge=new go,GS=new jo,qS=new sd;class UQ extends jo{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new RC(new Float32Array(16*i),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,Uge)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Gf),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,kC),NQ.copy(e.boundingBox).applyMatrix4(kC),this.boundingBox.union(NQ)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new sd),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,kC),qS.copy(e.boundingSphere).applyMatrix4(kC),this.boundingSphere.union(qS)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const i=t.morphTargetInfluences,r=this.morphTexture.source.data.data,o=e*(i.length+1)+1;for(let l=0;l<i.length;l++)i[l]=r[o+l]}raycast(e,t){const i=this.matrixWorld,r=this.count;if(GS.geometry=this.geometry,GS.material=this.material,void 0!==GS.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),qS.copy(this.boundingSphere),qS.applyMatrix4(i),!1!==e.ray.intersectsSphere(qS)))for(let s=0;s<r;s++){this.getMatrixAt(s,kC),LQ.multiplyMatrices(i,kC),GS.matrixWorld=LQ,GS.raycast(e,U4);for(let o=0,l=U4.length;o<l;o++){const h=U4[o];h.instanceId=s,h.object=this,t.push(h)}U4.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new RC(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const i=t.morphTargetInfluences,r=i.length+1;null===this.morphTexture&&(this.morphTexture=new ry(new Float32Array(r*this.count),r,this.count,uO,ym));const s=this.morphTexture.source.data.data;let o=0;for(let u=0;u<i.length;u++)o+=i[u];const h=r*e;s[h]=this.geometry.morphTargetsRelative?1:1-o,s.set(i,h+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function zge(n,e){return n.z-e.z}function Hge(n,e){return e.z-n.z}class Vge{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,i){const r=this.pool,s=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const o=r[this.index];s.push(o),this.index++,o.start=e.start,o.count=e.count,o.z=t,o.index=i}reset(){this.list.length=0,this.index=0}}const J1=new go,P5=new go,Gge=new go,qge=new nr(1,1,1),zQ=new go,R5=new E4,z4=new Gf,rx=new sd,QS=new Dt,HQ=new Dt,Qge=new Dt,k5=new Vge,Zd=new jo,H4=[];function jge(n,e,t=0){const i=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const r=n.count;for(let s=0;s<r;s++)for(let o=0;o<i;o++)e.setComponent(s+t,o,n.getComponent(s,o))}else e.array.set(n.array,t*i);e.needsUpdate=!0}class Wge extends jo{get maxInstanceCount(){return this._maxInstanceCount}constructor(e,t,i=2*t,r){super(new Hs,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawInfo=[],this._drawRanges=[],this._reservedRanges=[],this._bounds=[],this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=i,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(4*this._maxInstanceCount);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4),i=new ry(t,e,e,Hf,ym);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),i=new ry(t,e,e,WI,j1);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),i=new ry(t,e,e,Hf,ym);i.colorSpace=pl.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){const t=this.geometry,i=this._maxVertexCount,r=this._maxIndexCount;if(!1===this._geometryInitialized){for(const s in e.attributes){const o=e.getAttribute(s),{array:l,itemSize:h,normalized:u}=o,f=new l.constructor(i*h),y=new To(f,h,u);t.setAttribute(s,y)}if(null!==e.getIndex()){const s=i>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new To(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const i in t.attributes){if(!e.hasAttribute(i))throw new Error(`BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const r=e.getAttribute(i),s=t.getAttribute(i);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Gf);const e=this.boundingBox,t=this._drawInfo;e.makeEmpty();for(let i=0,r=t.length;i<r;i++){if(!1===t[i].active)continue;const s=t[i].geometryIndex;this.getMatrixAt(i,J1),this.getBoundingBoxAt(s,z4).applyMatrix4(J1),e.union(z4)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new sd);const e=this.boundingSphere,t=this._drawInfo;e.makeEmpty();for(let i=0,r=t.length;i<r;i++){if(!1===t[i].active)continue;const s=t[i].geometryIndex;this.getMatrixAt(i,J1),this.getBoundingSphereAt(s,rx).applyMatrix4(J1),e.union(rx)}}addInstance(e){if(this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");this._drawInfo.push({visible:!0,active:!0,geometryIndex:e});const t=this._drawInfo.length-1,i=this._matricesTexture;Gge.toArray(i.image.data,16*t),i.needsUpdate=!0;const s=this._colorsTexture;return s&&(qge.toArray(s.image.data,4*t),s.needsUpdate=!0),t}addGeometry(e,t=-1,i=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");const r={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,l=this._drawRanges,h=this._bounds;0!==this._geometryCount&&(s=o[o.length-1]),r.vertexCount=-1===t?e.getAttribute("position").count:t,r.vertexStart=null===s?0:s.vertexStart+s.vertexCount;const u=e.getIndex(),f=null!==u;if(f&&(r.indexCount=-1===i?u.count:i,r.indexStart=null===s?0:s.indexStart+s.indexCount),-1!==r.indexStart&&r.indexStart+r.indexCount>this._maxIndexCount||r.vertexStart+r.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const y=this._geometryCount;return this._geometryCount++,o.push(r),l.push({start:f?r.indexStart:r.vertexStart,count:-1}),h.push({boxInitialized:!1,box:new Gf,sphereInitialized:!1,sphere:new sd}),this.setGeometryAt(y,e),y}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const i=this.geometry,r=null!==i.getIndex(),s=i.getIndex(),o=t.getIndex(),l=this._reservedRanges[e];if(r&&o.count>l.indexCount||t.attributes.position.count>l.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const h=l.vertexStart,u=l.vertexCount;for(const B in i.attributes){const j=t.getAttribute(B),ne=i.getAttribute(B);jge(j,ne,h);const se=j.itemSize;for(let le=j.count,Ee=u;le<Ee;le++){const Pe=h+le;for(let Ve=0;Ve<se;Ve++)ne.setComponent(Pe,Ve,0)}ne.needsUpdate=!0,ne.addUpdateRange(h*se,u*se)}if(r){const B=l.indexStart;for(let j=0;j<o.count;j++)s.setX(B+j,h+o.getX(j));for(let j=o.count,ne=l.indexCount;j<ne;j++)s.setX(B+j,h);s.needsUpdate=!0,s.addUpdateRange(B,l.indexCount)}const f=this._bounds[e];null!==t.boundingBox?(f.box.copy(t.boundingBox),f.boxInitialized=!0):f.boxInitialized=!1,null!==t.boundingSphere?(f.sphere.copy(t.boundingSphere),f.sphereInitialized=!0):f.sphereInitialized=!1;const y=this._drawRanges[e],T=t.getAttribute("position");return y.count=r?o.count:T.count,this._visibilityChanged=!0,e}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const i=this._bounds[e],r=i.box,s=this.geometry;if(!1===i.boxInitialized){r.makeEmpty();const o=s.index,l=s.attributes.position,h=this._drawRanges[e];for(let u=h.start,f=h.start+h.count;u<f;u++){let y=u;o&&(y=o.getX(y)),r.expandByPoint(QS.fromBufferAttribute(l,y))}i.boxInitialized=!0}return t.copy(r),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const i=this._bounds[e],r=i.sphere,s=this.geometry;if(!1===i.sphereInitialized){r.makeEmpty(),this.getBoundingBoxAt(e,z4),z4.getCenter(r.center);const o=s.index,l=s.attributes.position,h=this._drawRanges[e];let u=0;for(let f=h.start,y=h.start+h.count;f<y;f++){let T=f;o&&(T=o.getX(T)),QS.fromBufferAttribute(l,T),u=Math.max(u,r.center.distanceToSquared(QS))}r.radius=Math.sqrt(u),i.sphereInitialized=!0}return t.copy(r),t}setMatrixAt(e,t){const i=this._drawInfo,r=this._matricesTexture;return e>=i.length||!1===i[e].active||(t.toArray(this._matricesTexture.image.data,16*e),r.needsUpdate=!0),this}getMatrixAt(e,t){const i=this._drawInfo;return e>=i.length||!1===i[e].active?null:t.fromArray(this._matricesTexture.image.data,16*e)}setColorAt(e,t){null===this._colorsTexture&&this._initColorsTexture();const i=this._colorsTexture,s=this._drawInfo;return e>=s.length||!1===s[e].active||(t.toArray(this._colorsTexture.image.data,4*e),i.needsUpdate=!0),this}getColorAt(e,t){const r=this._drawInfo;return e>=r.length||!1===r[e].active?null:t.fromArray(this._colorsTexture.image.data,4*e)}setVisibleAt(e,t){const i=this._drawInfo;return e>=i.length||!1===i[e].active||i[e].visible===t||(i[e].visible=t,this._visibilityChanged=!0),this}getVisibleAt(e){const t=this._drawInfo;return!(e>=t.length||!1===t[e].active)&&t[e].visible}raycast(e,t){const i=this._drawInfo,r=this._drawRanges,s=this.matrixWorld,o=this.geometry;Zd.material=this.material,Zd.geometry.index=o.index,Zd.geometry.attributes=o.attributes,null===Zd.geometry.boundingBox&&(Zd.geometry.boundingBox=new Gf),null===Zd.geometry.boundingSphere&&(Zd.geometry.boundingSphere=new sd);for(let l=0,h=i.length;l<h;l++){if(!i[l].visible||!i[l].active)continue;const u=i[l].geometryIndex,f=r[u];Zd.geometry.setDrawRange(f.start,f.count),this.getMatrixAt(l,Zd.matrixWorld).premultiply(s),this.getBoundingBoxAt(u,Zd.geometry.boundingBox),this.getBoundingSphereAt(u,Zd.geometry.boundingSphere),Zd.raycast(e,H4);for(let y=0,T=H4.length;y<T;y++){const B=H4[y];B.object=this,B.batchId=l,t.push(B)}H4.length=0}Zd.material=null,Zd.geometry.index=null,Zd.geometry.attributes={},Zd.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._drawInfo=e._drawInfo.map(t=>({...t})),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),null!==this._colorsTexture&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,t,i,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=r.getIndex(),l=null===o?1:o.array.BYTES_PER_ELEMENT,h=this._drawInfo,u=this._multiDrawStarts,f=this._multiDrawCounts,y=this._drawRanges,T=this.perObjectFrustumCulled,B=this._indirectTexture,j=B.image.data;T&&(zQ.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),R5.setFromProjectionMatrix(zQ,e.coordinateSystem));let ne=0;if(this.sortObjects){P5.copy(this.matrixWorld).invert(),QS.setFromMatrixPosition(i.matrixWorld).applyMatrix4(P5),HQ.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(P5);for(let Ee=0,Pe=h.length;Ee<Pe;Ee++)if(h[Ee].visible&&h[Ee].active){const Ve=h[Ee].geometryIndex;this.getMatrixAt(Ee,J1),this.getBoundingSphereAt(Ve,rx).applyMatrix4(J1);let Ft=!1;if(T&&(Ft=!R5.intersectsSphere(rx)),!Ft){const Ct=Qge.subVectors(rx.center,QS).dot(HQ);k5.push(y[Ve],Ct,Ee)}}const se=k5.list,le=this.customSort;null===le?se.sort(s.transparent?Hge:zge):le.call(this,se,i);for(let Ee=0,Pe=se.length;Ee<Pe;Ee++){const Ve=se[Ee];u[ne]=Ve.start*l,f[ne]=Ve.count,j[ne]=Ve.index,ne++}k5.reset()}else for(let se=0,le=h.length;se<le;se++)if(h[se].visible&&h[se].active){const Ee=h[se].geometryIndex;let Pe=!1;if(T&&(this.getMatrixAt(se,J1),this.getBoundingSphereAt(Ee,rx).applyMatrix4(J1),Pe=!R5.intersectsSphere(rx)),!Pe){const Ve=y[Ee];u[ne]=Ve.start*l,f[ne]=Ve.count,j[ne]=se,ne++}}B.needsUpdate=!0,this._multiDrawCount=ne,this._visibilityChanged=!1}onBeforeShadow(e,t,i,r,s,o){this.onBeforeRender(e,null,r,s,o)}}class Bc extends ch{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new nr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const V4=new Dt,G4=new Dt,VQ=new go,jS=new dC,q4=new sd,F5=new Dt,GQ=new Dt;class kg extends Wa{constructor(e=new Hs,t=new Bc){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)V4.fromBufferAttribute(t,r-1),G4.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=V4.distanceTo(G4);e.setAttribute("lineDistance",new Bs(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),q4.copy(i.boundingSphere),q4.applyMatrix4(r),q4.radius+=s,!1===e.ray.intersectsSphere(q4))return;VQ.copy(r).invert(),jS.copy(e.ray).applyMatrix4(VQ);const l=s/((this.scale.x+this.scale.y+this.scale.z)/3),h=l*l,u=this.isLineSegments?2:1,f=i.index,T=i.attributes.position;if(null!==f){const B=Math.max(0,o.start),j=Math.min(f.count,o.start+o.count);for(let ne=B,se=j-1;ne<se;ne+=u){const le=f.getX(ne),Ee=f.getX(ne+1),Pe=Q4(this,e,jS,h,le,Ee);Pe&&t.push(Pe)}if(this.isLineLoop){const ne=f.getX(j-1),se=f.getX(B),le=Q4(this,e,jS,h,ne,se);le&&t.push(le)}}else{const B=Math.max(0,o.start),j=Math.min(T.count,o.start+o.count);for(let ne=B,se=j-1;ne<se;ne+=u){const le=Q4(this,e,jS,h,ne,ne+1);le&&t.push(le)}if(this.isLineLoop){const ne=Q4(this,e,jS,h,j-1,B);ne&&t.push(ne)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const l=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}}function Q4(n,e,t,i,r,s){const o=n.geometry.attributes.position;if(V4.fromBufferAttribute(o,r),G4.fromBufferAttribute(o,s),t.distanceSqToSegment(V4,G4,F5,GQ)>i)return;F5.applyMatrix4(n.matrixWorld);const h=e.ray.origin.distanceTo(F5);return h<e.near||h>e.far?void 0:{distance:h,point:GQ.clone().applyMatrix4(n.matrixWorld),index:r,face:null,faceIndex:null,object:n}}const qQ=new Dt,QQ=new Dt;class yc extends kg{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)qQ.fromBufferAttribute(t,r),QQ.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+qQ.distanceTo(QQ);e.setAttribute("lineDistance",new Bs(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class jQ extends kg{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class sy extends ch{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new nr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const WQ=new go,O5=new dC,j4=new sd,W4=new Dt;class sx extends Wa{constructor(e=new Hs,t=new sy){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),j4.copy(i.boundingSphere),j4.applyMatrix4(r),j4.radius+=s,!1===e.ray.intersectsSphere(j4))return;WQ.copy(r).invert(),O5.copy(e.ray).applyMatrix4(WQ);const l=s/((this.scale.x+this.scale.y+this.scale.z)/3),h=l*l,u=i.index,y=i.attributes.position;if(null!==u)for(let j=Math.max(0,o.start),ne=Math.min(u.count,o.start+o.count);j<ne;j++){const se=u.getX(j);W4.fromBufferAttribute(y,se),$Q(W4,se,h,r,e,t,this)}else for(let j=Math.max(0,o.start),ne=Math.min(y.count,o.start+o.count);j<ne;j++)W4.fromBufferAttribute(y,j),$Q(W4,j,h,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const l=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}}function $Q(n,e,t,i,r,s,o){const l=O5.distanceSqToPoint(n);if(l<t){const h=new Dt;O5.closestPointToPoint(n,h),h.applyMatrix4(i);const u=r.ray.origin.distanceTo(h);if(u<r.near||u>r.far)return;s.push({distance:u,distanceToRay:Math.sqrt(l),point:h,index:e,face:null,object:o})}}class FC extends Yd{constructor(e,t,i,r,s,o,l,h,u,f,y,T){super(null,o,l,h,u,f,r,s,y,T),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class XQ extends Yd{constructor(e,t,i,r,s,o,l,h,u){super(e,t,i,r,s,o,l,h,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class R0{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;o=t||e*i[s-1];let u,l=0,h=s-1;for(;l<=h;)if(r=Math.floor(l+(h-l)/2),u=i[r]-o,u<0)l=r+1;else{if(!(u>0)){h=r;break}h=r-1}if(r=h,i[r]===o)return r/(s-1);const f=i[r];return(r+(o-f)/(i[r+1]-f))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),l=this.getPoint(s),h=t||(o.isVector2?new Fi:new Dt);return h.copy(l).sub(o).normalize(),h}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new Dt,r=[],s=[],o=[],l=new Dt,h=new go;for(let B=0;B<=e;B++)r[B]=this.getTangentAt(B/e,new Dt);s[0]=new Dt,o[0]=new Dt;let u=Number.MAX_VALUE;const f=Math.abs(r[0].x),y=Math.abs(r[0].y),T=Math.abs(r[0].z);f<=u&&(u=f,i.set(1,0,0)),y<=u&&(u=y,i.set(0,1,0)),T<=u&&i.set(0,0,1),l.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],l),o[0].crossVectors(r[0],s[0]);for(let B=1;B<=e;B++){if(s[B]=s[B-1].clone(),o[B]=o[B-1].clone(),l.crossVectors(r[B-1],r[B]),l.length()>Number.EPSILON){l.normalize();const j=Math.acos(xh(r[B-1].dot(r[B]),-1,1));s[B].applyMatrix4(h.makeRotationAxis(l,j))}o[B].crossVectors(r[B],s[B])}if(!0===t){let B=Math.acos(xh(s[0].dot(s[e]),-1,1));B/=e,r[0].dot(l.crossVectors(s[0],s[e]))>0&&(B=-B);for(let j=1;j<=e;j++)s[j].applyMatrix4(h.makeRotationAxis(r[j],B*j)),o[j].crossVectors(r[j],s[j])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class L5 extends R0{constructor(e=0,t=0,i=1,r=1,s=0,o=2*Math.PI,l=!1,h=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=l,this.aRotation=h}getPoint(e,t=new Fi){const i=t,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const l=this.aStartAngle+e*s;let h=this.aX+this.xRadius*Math.cos(l),u=this.aY+this.yRadius*Math.sin(l);if(0!==this.aRotation){const f=Math.cos(this.aRotation),y=Math.sin(this.aRotation),T=h-this.aX,B=u-this.aY;h=T*f-B*y+this.aX,u=T*y+B*f+this.aY}return i.set(h,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}function N5(){let n=0,e=0,t=0,i=0;function r(s,o,l,h){n=s,e=l,t=-3*s+3*o-2*l-h,i=2*s-2*o+l+h}return{initCatmullRom:function(s,o,l,h,u){r(o,l,u*(l-s),u*(h-o))},initNonuniformCatmullRom:function(s,o,l,h,u,f,y){let T=(o-s)/u-(l-s)/(u+f)+(l-o)/f,B=(l-o)/f-(h-o)/(f+y)+(h-l)/y;T*=f,B*=f,r(o,l,T,B)},calc:function(s){const o=s*s;return n+e*s+t*o+i*(o*s)}}}const $4=new Dt,U5=new N5,z5=new N5,H5=new N5;class V5 extends R0{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new Dt){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let u,f,l=Math.floor(o),h=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s)+1)*s:0===h&&l===s-1&&(l=s-2,h=1),this.closed||l>0?u=r[(l-1)%s]:($4.subVectors(r[0],r[1]).add(r[0]),u=$4);const y=r[l%s],T=r[(l+1)%s];if(this.closed||l+2<s?f=r[(l+2)%s]:($4.subVectors(r[s-1],r[s-2]).add(r[s-1]),f=$4),"centripetal"===this.curveType||"chordal"===this.curveType){const B="chordal"===this.curveType?.5:.25;let j=Math.pow(u.distanceToSquared(y),B),ne=Math.pow(y.distanceToSquared(T),B),se=Math.pow(T.distanceToSquared(f),B);ne<1e-4&&(ne=1),j<1e-4&&(j=ne),se<1e-4&&(se=ne),U5.initNonuniformCatmullRom(u.x,y.x,T.x,f.x,j,ne,se),z5.initNonuniformCatmullRom(u.y,y.y,T.y,f.y,j,ne,se),H5.initNonuniformCatmullRom(u.z,y.z,T.z,f.z,j,ne,se)}else"catmullrom"===this.curveType&&(U5.initCatmullRom(u.x,y.x,T.x,f.x,this.tension),z5.initCatmullRom(u.y,y.y,T.y,f.y,this.tension),H5.initCatmullRom(u.z,y.z,T.z,f.z,this.tension));return i.set(U5.calc(h),z5.calc(h),H5.calc(h)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new Dt).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function YQ(n,e,t,i,r){const s=.5*(i-e),o=.5*(r-t),l=n*n;return(2*t-2*i+s+o)*(n*l)+(-3*t+3*i-2*s-o)*l+s*n+t}function WS(n,e,t,i){return function Xge(n,e){const t=1-n;return t*t*e}(n,e)+function Yge(n,e){return 2*(1-n)*n*e}(n,t)+function Kge(n,e){return n*n*e}(n,i)}function $S(n,e,t,i,r){return function Zge(n,e){const t=1-n;return t*t*t*e}(n,e)+function Jge(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function e0e(n,e){return 3*(1-n)*n*n*e}(n,i)+function t0e(n,e){return n*n*n*e}(n,r)}class KQ extends R0{constructor(e=new Fi,t=new Fi,i=new Fi,r=new Fi){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Fi){const i=t,r=this.v0,s=this.v1,o=this.v2,l=this.v3;return i.set($S(e,r.x,s.x,o.x,l.x),$S(e,r.y,s.y,o.y,l.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class ZQ extends R0{constructor(e=new Fi,t=new Fi){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Fi){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Fi){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class JQ extends R0{constructor(e=new Fi,t=new Fi,i=new Fi){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Fi){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(WS(e,r.x,s.x,o.x),WS(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class G5 extends R0{constructor(e=new Dt,t=new Dt,i=new Dt){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Dt){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(WS(e,r.x,s.x,o.x),WS(e,r.y,s.y,o.y),WS(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ej extends R0{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Fi){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),l=s-o,h=r[0===o?o:o-1],u=r[o],f=r[o>r.length-2?r.length-1:o+1],y=r[o>r.length-3?r.length-1:o+2];return i.set(YQ(l,h.x,u.x,f.x,y.x),YQ(l,h.y,u.y,f.y,y.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new Fi).fromArray(r))}return this}}var X4=Object.freeze({__proto__:null,ArcCurve:class $ge extends L5{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:V5,CubicBezierCurve:KQ,CubicBezierCurve3:class n0e extends R0{constructor(e=new Dt,t=new Dt,i=new Dt,r=new Dt){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Dt){const i=t,r=this.v0,s=this.v1,o=this.v2,l=this.v3;return i.set($S(e,r.x,s.x,o.x,l.x),$S(e,r.y,s.y,o.y,l.y),$S(e,r.z,s.z,o.z,l.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},EllipseCurve:L5,LineCurve:ZQ,LineCurve3:class i0e extends R0{constructor(e=new Dt,t=new Dt){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Dt){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Dt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:JQ,QuadraticBezierCurve3:G5,SplineCurve:ej});class r0e extends R0{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);return e.equals(t)||this.curves.push(new X4[!0===e.isVector2?"LineCurve":"LineCurve3"](t,e)),this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,l=this.curves[s],h=l.getLength();return l.getPointAt(0===h?0:1-o/h,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],h=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let u=0;u<h.length;u++){const f=h[u];i&&i.equals(f)||(t.push(f),i=f)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new X4[r.type]).fromJSON(r))}return this}}class Y4 extends r0e{constructor(e){super(),this.type="Path",this.currentPoint=new Fi,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new ZQ(this.currentPoint.clone(),new Fi(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new JQ(this.currentPoint.clone(),new Fi(e,t),new Fi(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const l=new KQ(this.currentPoint.clone(),new Fi(e,t),new Fi(i,r),new Fi(s,o));return this.curves.push(l),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new ej(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,l,h){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o,l,h),this}absellipse(e,t,i,r,s,o,l,h){const u=new L5(e,t,i,r,s,o,l,h);if(this.curves.length>0){const y=u.getPoint(0);y.equals(this.currentPoint)||this.lineTo(y.x,y.y)}this.curves.push(u);const f=u.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class K4 extends Hs{constructor(e=[new Fi(0,-.5),new Fi(.5,0),new Fi(0,.5)],t=12,i=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=xh(r,0,2*Math.PI);const s=[],o=[],l=[],h=[],u=[],f=1/t,y=new Dt,T=new Fi,B=new Dt,j=new Dt,ne=new Dt;let se=0,le=0;for(let Ee=0;Ee<=e.length-1;Ee++)switch(Ee){case 0:se=e[Ee+1].x-e[Ee].x,le=e[Ee+1].y-e[Ee].y,B.x=1*le,B.y=-se,B.z=0*le,ne.copy(B),B.normalize(),h.push(B.x,B.y,B.z);break;case e.length-1:h.push(ne.x,ne.y,ne.z);break;default:se=e[Ee+1].x-e[Ee].x,le=e[Ee+1].y-e[Ee].y,B.x=1*le,B.y=-se,B.z=0*le,j.copy(B),B.x+=ne.x,B.y+=ne.y,B.z+=ne.z,B.normalize(),h.push(B.x,B.y,B.z),ne.copy(j)}for(let Ee=0;Ee<=t;Ee++){const Pe=i+Ee*f*r,Ve=Math.sin(Pe),Ft=Math.cos(Pe);for(let Ct=0;Ct<=e.length-1;Ct++)y.x=e[Ct].x*Ve,y.y=e[Ct].y,y.z=e[Ct].x*Ft,o.push(y.x,y.y,y.z),T.x=Ee/t,T.y=Ct/(e.length-1),l.push(T.x,T.y),u.push(h[3*Ct+0]*Ve,h[3*Ct+1],h[3*Ct+0]*Ft)}for(let Ee=0;Ee<t;Ee++)for(let Pe=0;Pe<e.length-1;Pe++){const Ve=Pe+Ee*e.length,Ct=Ve+e.length,Lt=Ve+e.length+1,Kt=Ve+1;s.push(Ve,Ct,Kt),s.push(Lt,Kt,Ct)}this.setIndex(s),this.setAttribute("position",new Bs(o,3)),this.setAttribute("uv",new Bs(l,2)),this.setAttribute("normal",new Bs(u,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new K4(e.points,e.segments,e.phiStart,e.phiLength)}}class q5 extends K4{constructor(e=1,t=1,i=4,r=8){const s=new Y4;s.absarc(0,-t/2,e,1.5*Math.PI,0),s.absarc(0,t/2,e,0,.5*Math.PI),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:i,radialSegments:r}}static fromJSON(e){return new q5(e.radius,e.length,e.capSegments,e.radialSegments)}}class Q5 extends Hs{constructor(e=1,t=32,i=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],l=[],h=[],u=new Dt,f=new Fi;o.push(0,0,0),l.push(0,0,1),h.push(.5,.5);for(let y=0,T=3;y<=t;y++,T+=3){const B=i+y/t*r;u.x=e*Math.cos(B),u.y=e*Math.sin(B),o.push(u.x,u.y,u.z),l.push(0,0,1),f.x=(o[T]/e+1)/2,f.y=(o[T+1]/e+1)/2,h.push(f.x,f.y)}for(let y=1;y<=t;y++)s.push(y,y+1,0);this.setIndex(s),this.setAttribute("position",new Bs(o,3)),this.setAttribute("normal",new Bs(l,3)),this.setAttribute("uv",new Bs(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Q5(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class OC extends Hs{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,l=0,h=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:l,thetaLength:h};const u=this;r=Math.floor(r),s=Math.floor(s);const f=[],y=[],T=[],B=[];let j=0;const ne=[],se=i/2;let le=0;function Pe(Ve){const Ft=j,Ct=new Fi,Lt=new Dt;let Kt=0;const Bt=!0===Ve?e:t,St=!0===Ve?1:-1;for(let ti=1;ti<=r;ti++)y.push(0,se*St,0),T.push(0,St,0),B.push(.5,.5),j++;const Dn=j;for(let ti=0;ti<=r;ti++){const vi=ti/r*h+l,bi=Math.cos(vi),Un=Math.sin(vi);Lt.x=Bt*Un,Lt.y=se*St,Lt.z=Bt*bi,y.push(Lt.x,Lt.y,Lt.z),T.push(0,St,0),Ct.x=.5*bi+.5,Ct.y=.5*Un*St+.5,B.push(Ct.x,Ct.y),j++}for(let ti=0;ti<r;ti++){const ci=Ft+ti,vi=Dn+ti;!0===Ve?f.push(vi,vi+1,ci):f.push(vi+1,vi,ci),Kt+=3}u.addGroup(le,Kt,!0===Ve?1:2),le+=Kt}(function Ee(){const Ve=new Dt,Ft=new Dt;let Ct=0;const Lt=(t-e)/i;for(let Kt=0;Kt<=s;Kt++){const Bt=[],St=Kt/s,Dn=St*(t-e)+e;for(let ti=0;ti<=r;ti++){const ci=ti/r,vi=ci*h+l,bi=Math.sin(vi),Un=Math.cos(vi);Ft.x=Dn*bi,Ft.y=-St*i+se,Ft.z=Dn*Un,y.push(Ft.x,Ft.y,Ft.z),Ve.set(bi,Lt,Un).normalize(),T.push(Ve.x,Ve.y,Ve.z),B.push(ci,1-St),Bt.push(j++)}ne.push(Bt)}for(let Kt=0;Kt<r;Kt++)for(let Bt=0;Bt<s;Bt++){const Dn=ne[Bt+1][Kt],ti=ne[Bt+1][Kt+1],ci=ne[Bt][Kt+1];f.push(ne[Bt][Kt],Dn,ci),f.push(Dn,ti,ci),Ct+=6}u.addGroup(le,Ct,0),le+=Ct})(),!1===o&&(e>0&&Pe(!0),t>0&&Pe(!1)),this.setIndex(f),this.setAttribute("position",new Bs(y,3)),this.setAttribute("normal",new Bs(T,3)),this.setAttribute("uv",new Bs(B,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new OC(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class j5 extends OC{constructor(e=1,t=1,i=32,r=1,s=!1,o=0,l=2*Math.PI){super(0,e,t,i,r,s,o,l),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:l}}static fromJSON(e){return new j5(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ox extends Hs{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];function h(Ee,Pe,Ve,Ft){const Ct=Ft+1,Lt=[];for(let Kt=0;Kt<=Ct;Kt++){Lt[Kt]=[];const Bt=Ee.clone().lerp(Ve,Kt/Ct),St=Pe.clone().lerp(Ve,Kt/Ct),Dn=Ct-Kt;for(let ti=0;ti<=Dn;ti++)Lt[Kt][ti]=0===ti&&Kt===Ct?Bt:Bt.clone().lerp(St,ti/Dn)}for(let Kt=0;Kt<Ct;Kt++)for(let Bt=0;Bt<2*(Ct-Kt)-1;Bt++){const St=Math.floor(Bt/2);Bt%2==0?(T(Lt[Kt][St+1]),T(Lt[Kt+1][St]),T(Lt[Kt][St])):(T(Lt[Kt][St+1]),T(Lt[Kt+1][St+1]),T(Lt[Kt+1][St]))}}function T(Ee){s.push(Ee.x,Ee.y,Ee.z)}function B(Ee,Pe){const Ve=3*Ee;Pe.x=e[Ve+0],Pe.y=e[Ve+1],Pe.z=e[Ve+2]}function ne(Ee,Pe,Ve,Ft){Ft<0&&1===Ee.x&&(o[Pe]=Ee.x-1),0===Ve.x&&0===Ve.z&&(o[Pe]=Ft/2/Math.PI+.5)}function se(Ee){return Math.atan2(Ee.z,-Ee.x)}function le(Ee){return Math.atan2(-Ee.y,Math.sqrt(Ee.x*Ee.x+Ee.z*Ee.z))}(function l(Ee){const Pe=new Dt,Ve=new Dt,Ft=new Dt;for(let Ct=0;Ct<t.length;Ct+=3)B(t[Ct+0],Pe),B(t[Ct+1],Ve),B(t[Ct+2],Ft),h(Pe,Ve,Ft,Ee)})(r),function u(Ee){const Pe=new Dt;for(let Ve=0;Ve<s.length;Ve+=3)Pe.x=s[Ve+0],Pe.y=s[Ve+1],Pe.z=s[Ve+2],Pe.normalize().multiplyScalar(Ee),s[Ve+0]=Pe.x,s[Ve+1]=Pe.y,s[Ve+2]=Pe.z}(i),function f(){const Ee=new Dt;for(let Pe=0;Pe<s.length;Pe+=3){Ee.x=s[Pe+0],Ee.y=s[Pe+1],Ee.z=s[Pe+2];const Ve=se(Ee)/2/Math.PI+.5,Ft=le(Ee)/Math.PI+.5;o.push(Ve,1-Ft)}(function j(){const Ee=new Dt,Pe=new Dt,Ve=new Dt,Ft=new Dt,Ct=new Fi,Lt=new Fi,Kt=new Fi;for(let Bt=0,St=0;Bt<s.length;Bt+=9,St+=6){Ee.set(s[Bt+0],s[Bt+1],s[Bt+2]),Pe.set(s[Bt+3],s[Bt+4],s[Bt+5]),Ve.set(s[Bt+6],s[Bt+7],s[Bt+8]),Ct.set(o[St+0],o[St+1]),Lt.set(o[St+2],o[St+3]),Kt.set(o[St+4],o[St+5]),Ft.copy(Ee).add(Pe).add(Ve).divideScalar(3);const Dn=se(Ft);ne(Ct,St+0,Ee,Dn),ne(Lt,St+2,Pe,Dn),ne(Kt,St+4,Ve,Dn)}})(),function y(){for(let Ee=0;Ee<o.length;Ee+=6){const Pe=o[Ee+0],Ve=o[Ee+2],Ft=o[Ee+4],Ct=Math.max(Pe,Ve,Ft),Lt=Math.min(Pe,Ve,Ft);Ct>.9&&Lt<.1&&(Pe<.2&&(o[Ee+0]+=1),Ve<.2&&(o[Ee+2]+=1),Ft<.2&&(o[Ee+4]+=1))}}()}(),this.setAttribute("position",new Bs(s,3)),this.setAttribute("normal",new Bs(s.slice(),3)),this.setAttribute("uv",new Bs(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ox(e.vertices,e.indices,e.radius,e.details)}}class W5 extends ox{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=1/i;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new W5(e.radius,e.detail)}}const Z4=new Dt,J4=new Dt,$5=new Dt,eB=new xm;class tj extends Hs{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=Math.pow(10,4),s=Math.cos(jb*t),o=e.getIndex(),l=e.getAttribute("position"),h=o?o.count:l.count,u=[0,0,0],f=["a","b","c"],y=new Array(3),T={},B=[];for(let j=0;j<h;j+=3){o?(u[0]=o.getX(j),u[1]=o.getX(j+1),u[2]=o.getX(j+2)):(u[0]=j,u[1]=j+1,u[2]=j+2);const{a:ne,b:se,c:le}=eB;if(ne.fromBufferAttribute(l,u[0]),se.fromBufferAttribute(l,u[1]),le.fromBufferAttribute(l,u[2]),eB.getNormal($5),y[0]=`${Math.round(ne.x*r)},${Math.round(ne.y*r)},${Math.round(ne.z*r)}`,y[1]=`${Math.round(se.x*r)},${Math.round(se.y*r)},${Math.round(se.z*r)}`,y[2]=`${Math.round(le.x*r)},${Math.round(le.y*r)},${Math.round(le.z*r)}`,y[0]!==y[1]&&y[1]!==y[2]&&y[2]!==y[0])for(let Ee=0;Ee<3;Ee++){const Pe=(Ee+1)%3,Ve=y[Ee],Ft=y[Pe],Ct=eB[f[Ee]],Lt=eB[f[Pe]],Kt=`${Ve}_${Ft}`,Bt=`${Ft}_${Ve}`;Bt in T&&T[Bt]?($5.dot(T[Bt].normal)<=s&&(B.push(Ct.x,Ct.y,Ct.z),B.push(Lt.x,Lt.y,Lt.z)),T[Bt]=null):Kt in T||(T[Kt]={index0:u[Ee],index1:u[Pe],normal:$5.clone()})}}for(const j in T)if(T[j]){const{index0:ne,index1:se}=T[j];Z4.fromBufferAttribute(l,ne),J4.fromBufferAttribute(l,se),B.push(Z4.x,Z4.y,Z4.z),B.push(J4.x,J4.y,J4.z)}this.setAttribute("position",new Bs(B,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class LC extends Y4{constructor(e){super(e),this.uuid=vm(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new Y4).fromJSON(r))}return this}}function nj(n,e,t,i,r){let s,o;if(r===function b0e(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}(n,e,t,i)>0)for(s=e;s<t;s+=i)o=sj(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=sj(s,n[s],n[s+1],o);return o&&tB(o,o.next)&&(KS(o),o=o.next),o}function ax(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!tB(t,t.next)&&0!==hh(t.prev,t,t.next))t=t.next;else{if(KS(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function XS(n,e,t,i,r,s,o){if(!n)return;!o&&s&&function m0e(n,e,t,i){let r=n;do{0===r.z&&(r.z=X5(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function A0e(n){let e,t,i,r,s,o,l,h,u=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,l=0,e=0;e<u&&(l++,i=i.nextZ,i);e++);for(h=u;l>0||h>0&&i;)0!==l&&(0===h||!i||t.z<=i.z)?(r=t,t=t.nextZ,l--):(r=i,i=i.nextZ,h--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,u*=2}while(o>1)}(r)}(n,i,r,s);let h,u,l=n;for(;n.prev!==n.next;)if(h=n.prev,u=n.next,s?a0e(n,i,r,s):o0e(n))e.push(h.i/t|0),e.push(n.i/t|0),e.push(u.i/t|0),KS(n),n=u.next,l=u.next;else if((n=u)===l){o?1===o?XS(n=l0e(ax(n),e,t),e,t,i,r,s,2):2===o&&c0e(n,e,t,i,r,s):XS(ax(n),e,t,i,r,s,1);break}}function o0e(n){const e=n.prev,t=n,i=n.next;if(hh(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,l=e.y,h=t.y,u=i.y,f=r<s?r<o?r:o:s<o?s:o,y=l<h?l<u?l:u:h<u?h:u,T=r>s?r>o?r:o:s>o?s:o,B=l>h?l>u?l:u:h>u?h:u;let j=i.next;for(;j!==e;){if(j.x>=f&&j.x<=T&&j.y>=y&&j.y<=B&&NC(r,l,s,h,o,u,j.x,j.y)&&hh(j.prev,j,j.next)>=0)return!1;j=j.next}return!0}function a0e(n,e,t,i){const r=n.prev,s=n,o=n.next;if(hh(r,s,o)>=0)return!1;const l=r.x,h=s.x,u=o.x,f=r.y,y=s.y,T=o.y,B=l<h?l<u?l:u:h<u?h:u,j=f<y?f<T?f:T:y<T?y:T,ne=l>h?l>u?l:u:h>u?h:u,se=f>y?f>T?f:T:y>T?y:T,le=X5(B,j,e,t,i),Ee=X5(ne,se,e,t,i);let Pe=n.prevZ,Ve=n.nextZ;for(;Pe&&Pe.z>=le&&Ve&&Ve.z<=Ee;){if(Pe.x>=B&&Pe.x<=ne&&Pe.y>=j&&Pe.y<=se&&Pe!==r&&Pe!==o&&NC(l,f,h,y,u,T,Pe.x,Pe.y)&&hh(Pe.prev,Pe,Pe.next)>=0||(Pe=Pe.prevZ,Ve.x>=B&&Ve.x<=ne&&Ve.y>=j&&Ve.y<=se&&Ve!==r&&Ve!==o&&NC(l,f,h,y,u,T,Ve.x,Ve.y)&&hh(Ve.prev,Ve,Ve.next)>=0))return!1;Ve=Ve.nextZ}for(;Pe&&Pe.z>=le;){if(Pe.x>=B&&Pe.x<=ne&&Pe.y>=j&&Pe.y<=se&&Pe!==r&&Pe!==o&&NC(l,f,h,y,u,T,Pe.x,Pe.y)&&hh(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.prevZ}for(;Ve&&Ve.z<=Ee;){if(Ve.x>=B&&Ve.x<=ne&&Ve.y>=j&&Ve.y<=se&&Ve!==r&&Ve!==o&&NC(l,f,h,y,u,T,Ve.x,Ve.y)&&hh(Ve.prev,Ve,Ve.next)>=0)return!1;Ve=Ve.nextZ}return!0}function l0e(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!tB(r,s)&&ij(r,i,i.next,s)&&YS(r,s)&&YS(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),KS(i),KS(i.next),i=n=s),i=i.next}while(i!==n);return ax(i)}function c0e(n,e,t,i,r,s){let o=n;do{let l=o.next.next;for(;l!==o.prev;){if(o.i!==l.i&&_0e(o,l)){let h=rj(o,l);return o=ax(o,o.next),h=ax(h,h.next),XS(o,e,t,i,r,s,0),void XS(h,e,t,i,r,s,0)}l=l.next}o=o.next}while(o!==n)}function u0e(n,e){return n.x-e.x}function d0e(n,e){const t=function f0e(n,e){let r,t=e,i=-1/0;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const T=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(T<=s&&T>i&&(i=T,r=t.x<t.next.x?t:t.next,T===s))return r}t=t.next}while(t!==e);if(!r)return null;const l=r,h=r.x,u=r.y;let y,f=1/0;t=r;do{s>=t.x&&t.x>=h&&s!==t.x&&NC(o<u?s:i,o,h,u,o<u?i:s,o,t.x,t.y)&&(y=Math.abs(o-t.y)/(s-t.x),YS(t,n)&&(y<f||y===f&&(t.x>r.x||t.x===r.x&&p0e(r,t)))&&(r=t,f=y)),t=t.next}while(t!==l);return r}(n,e);if(!t)return e;const i=rj(t,n);return ax(i,i.next),ax(t,t.next)}function p0e(n,e){return hh(n.prev,n,e.prev)<0&&hh(e.next,n,n.next)<0}function X5(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-t)*r|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g0e(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function NC(n,e,t,i,r,s,o,l){return(r-o)*(e-l)>=(n-o)*(s-l)&&(n-o)*(i-l)>=(t-o)*(e-l)&&(t-o)*(s-l)>=(r-o)*(i-l)}function _0e(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function y0e(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&ij(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(YS(n,e)&&YS(e,n)&&function v0e(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(hh(n.prev,n,e.prev)||hh(n,e.prev,e))||tB(n,e)&&hh(n.prev,n,n.next)>0&&hh(e.prev,e,e.next)>0)}function hh(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function tB(n,e){return n.x===e.x&&n.y===e.y}function ij(n,e,t,i){const r=iB(hh(n,e,t)),s=iB(hh(n,e,i)),o=iB(hh(t,i,n)),l=iB(hh(t,i,e));return!!(r!==s&&o!==l||0===r&&nB(n,t,e)||0===s&&nB(n,i,e)||0===o&&nB(t,n,i)||0===l&&nB(t,e,i))}function nB(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function iB(n){return n>0?1:n<0?-1:0}function YS(n,e){return hh(n.prev,n,n.next)<0?hh(n,e,n.next)>=0&&hh(n,n.prev,e)>=0:hh(n,e,n.prev)<0||hh(n,n.next,e)<0}function rj(n,e){const t=new Y5(n.i,n.x,n.y),i=new Y5(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function sj(n,e,t,i){const r=new Y5(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function KS(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Y5(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class oy{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*i}static isClockWise(e){return oy.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];oj(e),aj(i,e);let o=e.length;t.forEach(oj);for(let h=0;h<t.length;h++)r.push(o),o+=t[h].length,aj(i,t[h]);const l=function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=nj(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let l,h,u,f,y,T,B;if(i&&(s=function h0e(n,e,t,i){const r=[];let s,o,l,h,u;for(s=0,o=e.length;s<o;s++)l=e[s]*i,h=s<o-1?e[s+1]*i:n.length,u=nj(n,l,h,i,!1),u===u.next&&(u.steiner=!0),r.push(g0e(u));for(r.sort(u0e),s=0;s<r.length;s++)t=d0e(r[s],t);return t}(n,e,s,t)),n.length>80*t){l=u=n[0],h=f=n[1];for(let j=t;j<r;j+=t)y=n[j],T=n[j+1],y<l&&(l=y),T<h&&(h=T),y>u&&(u=y),T>f&&(f=T);B=Math.max(u-l,f-h),B=0!==B?32767/B:0}return XS(s,o,t,l,h,B,0),o}(i,r);for(let h=0;h<l.length;h+=3)s.push(l.slice(h,h+3));return s}}function oj(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function aj(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class rB extends Hs{constructor(e=new LC([new Fi(.5,.5),new Fi(-.5,.5),new Fi(-.5,-.5),new Fi(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let l=0,h=e.length;l<h;l++)o(e[l]);function o(l){const h=[],u=void 0!==t.curveSegments?t.curveSegments:12,f=void 0!==t.steps?t.steps:1,y=void 0!==t.depth?t.depth:1;let T=void 0===t.bevelEnabled||t.bevelEnabled,B=void 0!==t.bevelThickness?t.bevelThickness:.2,j=void 0!==t.bevelSize?t.bevelSize:B-.1,ne=void 0!==t.bevelOffset?t.bevelOffset:0,se=void 0!==t.bevelSegments?t.bevelSegments:3;const le=t.extrudePath,Ee=void 0!==t.UVGenerator?t.UVGenerator:x0e;let Pe,Ft,Ct,Lt,Kt,Ve=!1;le&&(Pe=le.getSpacedPoints(f),Ve=!0,T=!1,Ft=le.computeFrenetFrames(f,!1),Ct=new Dt,Lt=new Dt,Kt=new Dt),T||(se=0,B=0,j=0,ne=0);const Bt=l.extractPoints(u);let St=Bt.shape;const Dn=Bt.holes;if(!oy.isClockWise(St)){St=St.reverse();for(let bn=0,Kr=Dn.length;bn<Kr;bn++){const Ur=Dn[bn];oy.isClockWise(Ur)&&(Dn[bn]=Ur.reverse())}}const ci=oy.triangulateShape(St,Dn),vi=St;for(let bn=0,Kr=Dn.length;bn<Kr;bn++)St=St.concat(Dn[bn]);function bi(bn,Kr,Ur){return Kr||console.error("THREE.ExtrudeGeometry: vec does not exist"),bn.clone().addScaledVector(Kr,Ur)}const Un=St.length,_i=ci.length;function si(bn,Kr,Ur){let Ss,sr,Oo;const xs=bn.x-Kr.x,qs=bn.y-Kr.y,Bn=Ur.x-bn.x,zt=Ur.y-bn.y,Ii=xs*xs+qs*qs;if(Math.abs(xs*zt-qs*Bn)>Number.EPSILON){const hr=Math.sqrt(Ii),_r=Math.sqrt(Bn*Bn+zt*zt),Do=Kr.x-qs/hr,vs=Kr.y+xs/hr,qr=((Ur.x-zt/_r-Do)*zt-(Ur.y+Bn/_r-vs)*Bn)/(xs*zt-qs*Bn);Ss=Do+xs*qr-bn.x,sr=vs+qs*qr-bn.y;const Os=Ss*Ss+sr*sr;if(Os<=2)return new Fi(Ss,sr);Oo=Math.sqrt(Os/2)}else{let hr=!1;xs>Number.EPSILON?Bn>Number.EPSILON&&(hr=!0):xs<-Number.EPSILON?Bn<-Number.EPSILON&&(hr=!0):Math.sign(qs)===Math.sign(zt)&&(hr=!0),hr?(Ss=-qs,sr=xs,Oo=Math.sqrt(Ii)):(Ss=xs,sr=qs,Oo=Math.sqrt(Ii/2))}return new Fi(Ss/Oo,sr/Oo)}const ir=[];for(let bn=0,Kr=vi.length,Ur=Kr-1,Ss=bn+1;bn<Kr;bn++,Ur++,Ss++)Ur===Kr&&(Ur=0),Ss===Kr&&(Ss=0),ir[bn]=si(vi[bn],vi[Ur],vi[Ss]);const Nr=[];let Wr,so=ir.concat();for(let bn=0,Kr=Dn.length;bn<Kr;bn++){const Ur=Dn[bn];Wr=[];for(let Ss=0,sr=Ur.length,Oo=sr-1,xs=Ss+1;Ss<sr;Ss++,Oo++,xs++)Oo===sr&&(Oo=0),xs===sr&&(xs=0),Wr[Ss]=si(Ur[Ss],Ur[Oo],Ur[xs]);Nr.push(Wr),so=so.concat(Wr)}for(let bn=0;bn<se;bn++){const Kr=bn/se,Ur=B*Math.cos(Kr*Math.PI/2),Ss=j*Math.sin(Kr*Math.PI/2)+ne;for(let sr=0,Oo=vi.length;sr<Oo;sr++){const xs=bi(vi[sr],ir[sr],Ss);Rr(xs.x,xs.y,-Ur)}for(let sr=0,Oo=Dn.length;sr<Oo;sr++){const xs=Dn[sr];Wr=Nr[sr];for(let qs=0,Bn=xs.length;qs<Bn;qs++){const zt=bi(xs[qs],Wr[qs],Ss);Rr(zt.x,zt.y,-Ur)}}}const Po=j+ne;for(let bn=0;bn<Un;bn++){const Kr=T?bi(St[bn],so[bn],Po):St[bn];Ve?(Lt.copy(Ft.normals[0]).multiplyScalar(Kr.x),Ct.copy(Ft.binormals[0]).multiplyScalar(Kr.y),Kt.copy(Pe[0]).add(Lt).add(Ct),Rr(Kt.x,Kt.y,Kt.z)):Rr(Kr.x,Kr.y,0)}for(let bn=1;bn<=f;bn++)for(let Kr=0;Kr<Un;Kr++){const Ur=T?bi(St[Kr],so[Kr],Po):St[Kr];Ve?(Lt.copy(Ft.normals[bn]).multiplyScalar(Ur.x),Ct.copy(Ft.binormals[bn]).multiplyScalar(Ur.y),Kt.copy(Pe[bn]).add(Lt).add(Ct),Rr(Kt.x,Kt.y,Kt.z)):Rr(Ur.x,Ur.y,y/f*bn)}for(let bn=se-1;bn>=0;bn--){const Kr=bn/se,Ur=B*Math.cos(Kr*Math.PI/2),Ss=j*Math.sin(Kr*Math.PI/2)+ne;for(let sr=0,Oo=vi.length;sr<Oo;sr++){const xs=bi(vi[sr],ir[sr],Ss);Rr(xs.x,xs.y,y+Ur)}for(let sr=0,Oo=Dn.length;sr<Oo;sr++){const xs=Dn[sr];Wr=Nr[sr];for(let qs=0,Bn=xs.length;qs<Bn;qs++){const zt=bi(xs[qs],Wr[qs],Ss);Ve?Rr(zt.x,zt.y+Pe[f-1].y,Pe[f-1].x+Ur):Rr(zt.x,zt.y,y+Ur)}}}function ps(bn,Kr){let Ur=bn.length;for(;--Ur>=0;){const Ss=Ur;let sr=Ur-1;sr<0&&(sr=bn.length-1);for(let Oo=0,xs=f+2*se;Oo<xs;Oo++){const qs=Un*Oo,Bn=Un*(Oo+1);to(Kr+Ss+qs,Kr+sr+qs,Kr+sr+Bn,Kr+Ss+Bn)}}}function Rr(bn,Kr,Ur){h.push(bn),h.push(Kr),h.push(Ur)}function Gs(bn,Kr,Ur){lo(bn),lo(Kr),lo(Ur);const Ss=r.length/3,sr=Ee.generateTopUV(i,r,Ss-3,Ss-2,Ss-1);La(sr[0]),La(sr[1]),La(sr[2])}function to(bn,Kr,Ur,Ss){lo(bn),lo(Kr),lo(Ss),lo(Kr),lo(Ur),lo(Ss);const sr=r.length/3,Oo=Ee.generateSideWallUV(i,r,sr-6,sr-3,sr-2,sr-1);La(Oo[0]),La(Oo[1]),La(Oo[3]),La(Oo[1]),La(Oo[2]),La(Oo[3])}function lo(bn){r.push(h[3*bn+0]),r.push(h[3*bn+1]),r.push(h[3*bn+2])}function La(bn){s.push(bn.x),s.push(bn.y)}(function Ci(){const bn=r.length/3;if(T){let Kr=0,Ur=Un*Kr;for(let Ss=0;Ss<_i;Ss++){const sr=ci[Ss];Gs(sr[2]+Ur,sr[1]+Ur,sr[0]+Ur)}Kr=f+2*se,Ur=Un*Kr;for(let Ss=0;Ss<_i;Ss++){const sr=ci[Ss];Gs(sr[0]+Ur,sr[1]+Ur,sr[2]+Ur)}}else{for(let Kr=0;Kr<_i;Kr++){const Ur=ci[Kr];Gs(Ur[2],Ur[1],Ur[0])}for(let Kr=0;Kr<_i;Kr++){const Ur=ci[Kr];Gs(Ur[0]+Un*f,Ur[1]+Un*f,Ur[2]+Un*f)}}i.addGroup(bn,r.length/3-bn,0)})(),function yr(){const bn=r.length/3;let Kr=0;ps(vi,Kr),Kr+=vi.length;for(let Ur=0,Ss=Dn.length;Ur<Ss;Ur++){const sr=Dn[Ur];ps(sr,Kr),Kr+=sr.length}i.addGroup(bn,r.length/3-bn,1)}()}this.setAttribute("position",new Bs(r,3)),this.setAttribute("uv",new Bs(s,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function w0e(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++)t.shapes.push(n[i].uuid);else t.shapes.push(n.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++)i.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new X4[r.type]).fromJSON(r)),new rB(i,e.options)}}const x0e={generateTopUV:function(n,e,t,i,r){const l=e[3*i],h=e[3*i+1],u=e[3*r],f=e[3*r+1];return[new Fi(e[3*t],e[3*t+1]),new Fi(l,h),new Fi(u,f)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[3*t],l=e[3*t+1],h=e[3*t+2],u=e[3*i],f=e[3*i+1],y=e[3*i+2],T=e[3*r],B=e[3*r+1],j=e[3*r+2],ne=e[3*s],se=e[3*s+1],le=e[3*s+2];return Math.abs(l-f)<Math.abs(o-u)?[new Fi(o,1-h),new Fi(u,1-y),new Fi(T,1-j),new Fi(ne,1-le)]:[new Fi(l,1-h),new Fi(f,1-y),new Fi(B,1-j),new Fi(se,1-le)]}};class K5 extends ox{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2;super([-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new K5(e.radius,e.detail)}}class sB extends ox{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new sB(e.radius,e.detail)}}class Z5 extends Hs{constructor(e=.5,t=1,i=32,r=1,s=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i);const l=[],h=[],u=[],f=[];let y=e;const T=(t-e)/(r=Math.max(1,r)),B=new Dt,j=new Fi;for(let ne=0;ne<=r;ne++){for(let se=0;se<=i;se++){const le=s+se/i*o;B.x=y*Math.cos(le),B.y=y*Math.sin(le),h.push(B.x,B.y,B.z),u.push(0,0,1),j.x=(B.x/t+1)/2,j.y=(B.y/t+1)/2,f.push(j.x,j.y)}y+=T}for(let ne=0;ne<r;ne++){const se=ne*(i+1);for(let le=0;le<i;le++){const Ee=le+se,Ve=Ee+i+1,Ft=Ee+i+2,Ct=Ee+1;l.push(Ee,Ve,Ct),l.push(Ve,Ft,Ct)}}this.setIndex(l),this.setAttribute("position",new Bs(h,3)),this.setAttribute("normal",new Bs(u,3)),this.setAttribute("uv",new Bs(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Z5(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class J5 extends Hs{constructor(e=new LC([new Fi(0,.5),new Fi(-.5,-.5),new Fi(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],o=[];let l=0,h=0;if(!1===Array.isArray(e))u(e);else for(let f=0;f<e.length;f++)u(e[f]),this.addGroup(l,h,f),l+=h,h=0;function u(f){const y=r.length/3,T=f.extractPoints(t);let B=T.shape;const j=T.holes;!1===oy.isClockWise(B)&&(B=B.reverse());for(let se=0,le=j.length;se<le;se++){const Ee=j[se];!0===oy.isClockWise(Ee)&&(j[se]=Ee.reverse())}const ne=oy.triangulateShape(B,j);for(let se=0,le=j.length;se<le;se++)B=B.concat(j[se]);for(let se=0,le=B.length;se<le;se++){const Ee=B[se];r.push(Ee.x,Ee.y,0),s.push(0,0,1),o.push(Ee.x,Ee.y)}for(let se=0,le=ne.length;se<le;se++){const Ee=ne[se];i.push(Ee[0]+y,Ee[1]+y,Ee[2]+y),h+=3}}this.setIndex(i),this.setAttribute("position",new Bs(r,3)),this.setAttribute("normal",new Bs(s,3)),this.setAttribute("uv",new Bs(o,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function C0e(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++)e.shapes.push(n[t].uuid);else e.shapes.push(n.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++)i.push(t[e.shapes[r]]);return new J5(i,e.curveSegments)}}class ev extends Hs{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:l},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const h=Math.min(o+l,Math.PI);let u=0;const f=[],y=new Dt,T=new Dt,B=[],j=[],ne=[],se=[];for(let le=0;le<=i;le++){const Ee=[],Pe=le/i;let Ve=0;0===le&&0===o?Ve=.5/t:le===i&&h===Math.PI&&(Ve=-.5/t);for(let Ft=0;Ft<=t;Ft++){const Ct=Ft/t;y.x=-e*Math.cos(r+Ct*s)*Math.sin(o+Pe*l),y.y=e*Math.cos(o+Pe*l),y.z=e*Math.sin(r+Ct*s)*Math.sin(o+Pe*l),j.push(y.x,y.y,y.z),T.copy(y).normalize(),ne.push(T.x,T.y,T.z),se.push(Ct+Ve,1-Pe),Ee.push(u++)}f.push(Ee)}for(let le=0;le<i;le++)for(let Ee=0;Ee<t;Ee++){const Ve=f[le][Ee],Ft=f[le+1][Ee],Ct=f[le+1][Ee+1];(0!==le||o>0)&&B.push(f[le][Ee+1],Ve,Ct),(le!==i-1||h<Math.PI)&&B.push(Ve,Ft,Ct)}this.setIndex(B),this.setAttribute("position",new Bs(j,3)),this.setAttribute("normal",new Bs(ne,3)),this.setAttribute("uv",new Bs(se,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ev(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class eL extends ox{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new eL(e.radius,e.detail)}}class tL extends Hs{constructor(e=1,t=.4,i=12,r=48,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],l=[],h=[],u=[],f=new Dt,y=new Dt,T=new Dt;for(let B=0;B<=i;B++)for(let j=0;j<=r;j++){const ne=j/r*s,se=B/i*Math.PI*2;y.x=(e+t*Math.cos(se))*Math.cos(ne),y.y=(e+t*Math.cos(se))*Math.sin(ne),y.z=t*Math.sin(se),l.push(y.x,y.y,y.z),f.x=e*Math.cos(ne),f.y=e*Math.sin(ne),T.subVectors(y,f).normalize(),h.push(T.x,T.y,T.z),u.push(j/r),u.push(B/i)}for(let B=1;B<=i;B++)for(let j=1;j<=r;j++){const se=(r+1)*(B-1)+j-1,le=(r+1)*(B-1)+j,Ee=(r+1)*B+j;o.push((r+1)*B+j-1,se,Ee),o.push(se,le,Ee)}this.setIndex(o),this.setAttribute("position",new Bs(l,3)),this.setAttribute("normal",new Bs(h,3)),this.setAttribute("uv",new Bs(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new tL(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class nL extends Hs{constructor(e=1,t=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const l=[],h=[],u=[],f=[],y=new Dt,T=new Dt,B=new Dt,j=new Dt,ne=new Dt,se=new Dt,le=new Dt;for(let Pe=0;Pe<=i;++Pe){const Ve=Pe/i*s*Math.PI*2;Ee(Ve,s,o,e,B),Ee(Ve+.01,s,o,e,j),se.subVectors(j,B),le.addVectors(j,B),ne.crossVectors(se,le),le.crossVectors(ne,se),ne.normalize(),le.normalize();for(let Ft=0;Ft<=r;++Ft){const Ct=Ft/r*Math.PI*2,Lt=-t*Math.cos(Ct),Kt=t*Math.sin(Ct);y.x=B.x+(Lt*le.x+Kt*ne.x),y.y=B.y+(Lt*le.y+Kt*ne.y),y.z=B.z+(Lt*le.z+Kt*ne.z),h.push(y.x,y.y,y.z),T.subVectors(y,B).normalize(),u.push(T.x,T.y,T.z),f.push(Pe/i),f.push(Ft/r)}}for(let Pe=1;Pe<=i;Pe++)for(let Ve=1;Ve<=r;Ve++){const Ct=(r+1)*Pe+(Ve-1),Lt=(r+1)*Pe+Ve,Kt=(r+1)*(Pe-1)+Ve;l.push((r+1)*(Pe-1)+(Ve-1),Ct,Kt),l.push(Ct,Lt,Kt)}function Ee(Pe,Ve,Ft,Ct,Lt){const Kt=Math.cos(Pe),Bt=Math.sin(Pe),St=Ft/Ve*Pe,Dn=Math.cos(St);Lt.x=Ct*(2+Dn)*.5*Kt,Lt.y=Ct*(2+Dn)*Bt*.5,Lt.z=Ct*Math.sin(St)*.5}this.setIndex(l),this.setAttribute("position",new Bs(h,3)),this.setAttribute("normal",new Bs(u,3)),this.setAttribute("uv",new Bs(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nL(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class lx extends Hs{constructor(e=new G5(new Dt(-1,-1,0),new Dt(-1,1,0),new Dt(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const l=new Dt,h=new Dt,u=new Fi;let f=new Dt;const y=[],T=[],B=[],j=[];function se(Pe){f=e.getPointAt(Pe/t,f);const Ve=o.normals[Pe],Ft=o.binormals[Pe];for(let Ct=0;Ct<=r;Ct++){const Lt=Ct/r*Math.PI*2,Kt=Math.sin(Lt),Bt=-Math.cos(Lt);h.x=Bt*Ve.x+Kt*Ft.x,h.y=Bt*Ve.y+Kt*Ft.y,h.z=Bt*Ve.z+Kt*Ft.z,h.normalize(),T.push(h.x,h.y,h.z),l.x=f.x+i*h.x,l.y=f.y+i*h.y,l.z=f.z+i*h.z,y.push(l.x,l.y,l.z)}}(function ne(){for(let Pe=0;Pe<t;Pe++)se(Pe);se(!1===s?t:0),function Ee(){for(let Pe=0;Pe<=t;Pe++)for(let Ve=0;Ve<=r;Ve++)u.x=Pe/t,u.y=Ve/r,B.push(u.x,u.y)}(),function le(){for(let Pe=1;Pe<=t;Pe++)for(let Ve=1;Ve<=r;Ve++){const Ct=(r+1)*Pe+(Ve-1),Lt=(r+1)*Pe+Ve,Kt=(r+1)*(Pe-1)+Ve;j.push((r+1)*(Pe-1)+(Ve-1),Ct,Kt),j.push(Ct,Lt,Kt)}}()})(),this.setIndex(j),this.setAttribute("position",new Bs(y,3)),this.setAttribute("normal",new Bs(T,3)),this.setAttribute("uv",new Bs(B,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new lx((new X4[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}function lj(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return!0!==t.has(i)&&!0!==t.has(r)&&(t.add(i),t.add(r),!0)}var cj=Object.freeze({__proto__:null,BoxGeometry:Tp,CapsuleGeometry:q5,CircleGeometry:Q5,ConeGeometry:j5,CylinderGeometry:OC,DodecahedronGeometry:W5,EdgesGeometry:tj,ExtrudeGeometry:rB,IcosahedronGeometry:K5,LatheGeometry:K4,OctahedronGeometry:sB,PlaneGeometry:MC,PolyhedronGeometry:ox,RingGeometry:Z5,ShapeGeometry:J5,SphereGeometry:ev,TetrahedronGeometry:eL,TorusGeometry:tL,TorusKnotGeometry:nL,TubeGeometry:lx,WireframeGeometry:class M0e extends Hs{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],i=new Set,r=new Dt,s=new Dt;if(null!==e.index){const o=e.attributes.position,l=e.index;let h=e.groups;0===h.length&&(h=[{start:0,count:l.count,materialIndex:0}]);for(let u=0,f=h.length;u<f;++u){const y=h[u],T=y.start;for(let j=T,ne=T+y.count;j<ne;j+=3)for(let se=0;se<3;se++){const le=l.getX(j+se),Ee=l.getX(j+(se+1)%3);r.fromBufferAttribute(o,le),s.fromBufferAttribute(o,Ee),!0===lj(r,s,i)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let l=0,h=o.count/3;l<h;l++)for(let u=0;u<3;u++){const y=3*l+(u+1)%3;r.fromBufferAttribute(o,3*l+u),s.fromBufferAttribute(o,y),!0===lj(r,s,i)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Bs(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}});class E0e extends ch{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new nr(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class S0e extends Ou{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class oB extends ch{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new nr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Fi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new B0,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Fg extends oB{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Fi(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return xh(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new nr(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new nr(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new nr(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Og extends ch{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new nr(16777215),this.specular=new nr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Fi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new B0,this.combine=GI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class hj extends ch{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new nr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Fi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class T0e extends ch{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Fi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class D0e extends ch{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new nr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Fi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new B0,this.combine=GI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class I0e extends ch{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new nr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Fi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class cx extends Bc{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function hx(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function dj(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function iL(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const l=t[s]*e;for(let h=0;h!==e;++h)r[o++]=n[l+h]}return r}function rL(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)}class ZS{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let l=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===l)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const l=t[1];e<l&&(i=2,s=l);for(let h=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===h)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const l=i+o>>>1;e<t[l]?o=l:i=l+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class R0e extends ZS{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,l=r[s],h=r[o];if(void 0===l)switch(this.getSettings_().endingStart){case 2401:s=e,l=2*t-i;break;case 2402:s=r.length-2,l=t+r[s]-r[s+1];break;default:s=e,l=i}if(void 0===h)switch(this.getSettings_().endingEnd){case 2401:o=e,h=2*i-t;break;case 2402:o=1,h=i+r[1]-r[0];break;default:o=e-1,h=t}const u=.5*(i-t),f=this.valueSize;this._weightPrev=u/(t-l),this._weightNext=u/(h-i),this._offsetPrev=s*f,this._offsetNext=o*f}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,l=this.valueSize,h=e*l,u=h-l,f=this._offsetPrev,y=this._offsetNext,T=this._weightPrev,B=this._weightNext,j=(i-t)/(r-t),ne=j*j,se=ne*j,le=-T*se+2*T*ne-T*j,Ee=(1+T)*se+(-1.5-2*T)*ne+(-.5+T)*j+1,Pe=(-1-B)*se+(1.5+B)*ne+.5*j,Ve=B*se-B*ne;for(let Ft=0;Ft!==l;++Ft)s[Ft]=le*o[f+Ft]+Ee*o[u+Ft]+Pe*o[h+Ft]+Ve*o[y+Ft];return s}}class fj extends ZS{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,l=this.valueSize,h=e*l,u=h-l,f=(i-t)/(r-t),y=1-f;for(let T=0;T!==l;++T)s[T]=o[u+T]*y+o[h+T]*f;return s}}class k0e extends ZS{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class k0{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=hx(t,this.TimeBufferType),this.values=hx(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:hx(e.times,Array),values:hx(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new k0e(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new fj(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new R0e(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case J2:t=this.InterpolantFactoryMethodDiscrete;break;case eC:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return J2;case this.InterpolantFactoryMethodLinear:return eC;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const l=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*l,o*l)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let l=0;l!==s;l++){const h=i[l];if("number"==typeof h&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,h),e=!1;break}if(null!==o&&o>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,h,o),e=!1;break}o=h}if(void 0!==r&&function uj(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r))for(let l=0,h=r.length;l!==h;++l){const u=r[l];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let l=1;l<s;++l){let h=!1;const u=e[l];if(u!==e[l+1]&&(1!==l||u!==e[0]))if(r)h=!0;else{const y=l*i,T=y-i,B=y+i;for(let j=0;j!==i;++j){const ne=t[y+j];if(ne!==t[T+j]||ne!==t[B+j]){h=!0;break}}}if(h){if(l!==o){e[o]=e[l];const y=l*i,T=o*i;for(let B=0;B!==i;++B)t[T+B]=t[y+B]}++o}}if(s>0){e[o]=e[s];for(let l=s*i,h=o*i,u=0;u!==i;++u)t[h+u]=t[l+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}k0.prototype.TimeBufferType=Float32Array,k0.prototype.ValueBufferType=Float32Array,k0.prototype.DefaultInterpolation=eC;class UC extends k0{constructor(e,t,i){super(e,t,i)}}UC.prototype.ValueTypeName="bool",UC.prototype.ValueBufferType=Array,UC.prototype.DefaultInterpolation=J2,UC.prototype.InterpolantFactoryMethodLinear=void 0,UC.prototype.InterpolantFactoryMethodSmooth=void 0;class pj extends k0{}pj.prototype.ValueTypeName="color";class zC extends k0{}zC.prototype.ValueTypeName="number";class F0e extends ZS{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,l=this.valueSize,h=(i-t)/(r-t);let u=e*l;for(let f=u+l;u!==f;u+=4)zc.slerpFlat(s,0,o,u-l,o,u,h);return s}}class HC extends k0{InterpolantFactoryMethodLinear(e){return new F0e(this.times,this.values,this.getValueSize(),e)}}HC.prototype.ValueTypeName="quaternion",HC.prototype.InterpolantFactoryMethodSmooth=void 0;class VC extends k0{constructor(e,t,i){super(e,t,i)}}VC.prototype.ValueTypeName="string",VC.prototype.ValueBufferType=Array,VC.prototype.DefaultInterpolation=J2,VC.prototype.InterpolantFactoryMethodLinear=void 0,VC.prototype.InterpolantFactoryMethodSmooth=void 0;class GC extends k0{}GC.prototype.ValueTypeName="vector";class JS{constructor(e="",t=-1,i=[],r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=vm(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,l=i.length;o!==l;++o)t.push(L0e(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(k0.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let l=0;l<s;l++){let h=[],u=[];h.push((l+s-1)%s,l,(l+1)%s),u.push(0,1,0);const f=dj(h);h=iL(h,1,f),u=iL(u,1,f),!r&&0===h[0]&&(h.push(s),u.push(u[0])),o.push(new zC(".morphTargetInfluences["+t[l].name+"]",h,u).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let l=0,h=e.length;l<h;l++){const u=e[l],f=u.name.match(s);if(f&&f.length>1){const y=f[1];let T=r[y];T||(r[y]=T=[]),T.push(u)}}const o=[];for(const l in r)o.push(this.CreateFromMorphTargetSequence(l,r[l],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(y,T,B,j,ne){if(0!==B.length){const se=[],le=[];rL(B,se,le,j),0!==se.length&&ne.push(new y(T,se,le))}},r=[],s=e.name||"default",o=e.fps||30,l=e.blendMode;let h=e.length||-1;const u=e.hierarchy||[];for(let y=0;y<u.length;y++){const T=u[y].keys;if(T&&0!==T.length)if(T[0].morphTargets){const B={};let j;for(j=0;j<T.length;j++)if(T[j].morphTargets)for(let ne=0;ne<T[j].morphTargets.length;ne++)B[T[j].morphTargets[ne]]=-1;for(const ne in B){const se=[],le=[];for(let Ee=0;Ee!==T[j].morphTargets.length;++Ee){const Pe=T[j];se.push(Pe.time),le.push(Pe.morphTarget===ne?1:0)}r.push(new zC(".morphTargetInfluence["+ne+"]",se,le))}h=B.length*o}else{const B=".bones["+t[y].name+"]";i(GC,B+".position",T,"pos",r),i(HC,B+".quaternion",T,"rot",r),i(GC,B+".scale",T,"scl",r)}}return 0===r.length?null:new this(s,h,r,l)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function L0e(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function O0e(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return zC;case"vector":case"vector2":case"vector3":case"vector4":return GC;case"color":return pj;case"quaternion":return HC;case"bool":case"boolean":return UC;case"string":return VC}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];rL(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const tv={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class mj{constructor(e,t,i){const r=this;let h,s=!1,o=0,l=0;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(f){l++,!1===s&&void 0!==r.onStart&&r.onStart(f,o,l),s=!0},this.itemEnd=function(f){o++,void 0!==r.onProgress&&r.onProgress(f,o,l),o===l&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(f){void 0!==r.onError&&r.onError(f)},this.resolveURL=function(f){return h?h(f):f},this.setURLModifier=function(f){return h=f,this},this.addHandler=function(f,y){return u.push(f,y),this},this.removeHandler=function(f){const y=u.indexOf(f);return-1!==y&&u.splice(y,2),this},this.getHandler=function(f){for(let y=0,T=u.length;y<T;y+=2){const B=u[y],j=u[y+1];if(B.global&&(B.lastIndex=0),B.test(f))return j}return null}}}const N0e=new mj;let Jd=(()=>{class n{constructor(t){this.manager=void 0!==t?t:N0e,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(s,o){r.load(t,s,i,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const ay={};class U0e extends Error{constructor(e,t){super(e),this.response=t}}class Dp extends Jd{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=tv.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==ay[e])return void ay[e].push({onLoad:t,onProgress:i,onError:r});ay[e]=[],ay[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,h=this.responseType;fetch(o).then(u=>{if(200===u.status||0===u.status){if(0===u.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===u.body||void 0===u.body.getReader)return u;const f=ay[e],y=u.body.getReader(),T=u.headers.get("X-File-Size")||u.headers.get("Content-Length"),B=T?parseInt(T):0,j=0!==B;let ne=0;const se=new ReadableStream({start(le){!function Ee(){y.read().then(({done:Pe,value:Ve})=>{if(Pe)le.close();else{ne+=Ve.byteLength;const Ft=new ProgressEvent("progress",{lengthComputable:j,loaded:ne,total:B});for(let Ct=0,Lt=f.length;Ct<Lt;Ct++){const Kt=f[Ct];Kt.onProgress&&Kt.onProgress(Ft)}le.enqueue(Ve),Ee()}},Pe=>{le.error(Pe)})}()}});return new Response(se)}throw new U0e(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(h){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(f=>(new DOMParser).parseFromString(f,l));case"json":return u.json();default:if(void 0===l)return u.text();{const y=/charset="?([^;"\s]*)"?/i.exec(l),T=y&&y[1]?y[1].toLowerCase():void 0,B=new TextDecoder(T);return u.arrayBuffer().then(j=>B.decode(j))}}}).then(u=>{tv.add(e,u);const f=ay[e];delete ay[e];for(let y=0,T=f.length;y<T;y++){const B=f[y];B.onLoad&&B.onLoad(u)}}).catch(u=>{const f=ay[e];if(void 0===f)throw this.manager.itemError(e),u;delete ay[e];for(let y=0,T=f.length;y<T;y++){const B=f[y];B.onError&&B.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class aB extends Jd{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=tv.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const l=BS("img");function h(){f(),tv.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(y){f(),r&&r(y),s.manager.itemError(e),s.manager.itemEnd(e)}function f(){l.removeEventListener("load",h,!1),l.removeEventListener("error",u,!1)}return l.addEventListener("load",h,!1),l.addEventListener("error",u,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(l.crossOrigin=this.crossOrigin),s.manager.itemStart(e),l.src=e,l}}class z0e extends Jd{constructor(e){super(e)}load(e,t,i,r){const s=new Yd,o=new aB(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(l){s.image=l,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class ux extends Wa{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new nr(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}class H0e extends ux{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Wa.DEFAULT_UP),this.updateMatrix(),this.groundColor=new nr(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const sL=new go,Aj=new Dt,gj=new Dt;class oL{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Fi(512,512),this.map=null,this.mapPass=null,this.matrix=new go,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new E4,this._frameExtents=new Fi(1,1),this._viewportCount=1,this._viewports=[new $l(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;Aj.setFromMatrixPosition(e.matrixWorld),t.position.copy(Aj),gj.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(gj),t.updateMatrixWorld(),sL.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(sL),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(sL)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class V0e extends oL{constructor(){super(new Lu(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*rC*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class _j extends ux{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Wa.DEFAULT_UP),this.updateMatrix(),this.target=new Wa,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new V0e}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const yj=new go,eT=new Dt,aL=new Dt;class G0e extends oL{constructor(){super(new Lu(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Fi(4,2),this._viewportCount=6,this._viewports=[new $l(2,1,1,1),new $l(0,1,1,1),new $l(3,1,1,1),new $l(1,1,1,1),new $l(3,0,1,1),new $l(1,0,1,1)],this._cubeDirections=[new Dt(1,0,0),new Dt(-1,0,0),new Dt(0,0,1),new Dt(0,0,-1),new Dt(0,1,0),new Dt(0,-1,0)],this._cubeUps=[new Dt(0,1,0),new Dt(0,1,0),new Dt(0,1,0),new Dt(0,1,0),new Dt(0,0,1),new Dt(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),eT.setFromMatrixPosition(e.matrixWorld),i.position.copy(eT),aL.copy(i.position),aL.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(aL),i.updateMatrixWorld(),r.makeTranslation(-eT.x,-eT.y,-eT.z),yj.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(yj)}}class vj extends ux{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new G0e}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class q0e extends oL{constructor(){super(new Jb(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class qC extends ux{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Wa.DEFAULT_UP),this.updateMatrix(),this.target=new Wa,this.shadow=new q0e}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class lB extends ux{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Q0e extends ux{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class j0e{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Dt)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],i*r*1.092548),t.addScaledVector(o[5],r*s*1.092548),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],i*s*1.092548),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*s),t.addScaledVector(o[3],1.023328*i),t.addScaledVector(o[4],.858086*i*r),t.addScaledVector(o[5],.858086*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],.858086*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class W0e extends ux{constructor(e=new j0e,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class lL extends Jd{constructor(e){super(e),this.textures={}}load(e,t,i,r){const s=this,o=new Dp(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(h){r?r(h):console.error(h),s.manager.itemError(e)}},i,r)}parse(e){const t=this.textures;function i(s){return void 0===t[s]&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=lL.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new nr).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.dispersion&&(r.dispersion=e.dispersion),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(r.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(r.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(r.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(r.depthFunc=e.depthFunc),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(r.blendSrc=e.blendSrc),void 0!==e.blendDst&&(r.blendDst=e.blendDst),void 0!==e.blendEquation&&(r.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(r.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(r.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(r.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==r.blendColor&&r.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(r.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),void 0!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(r.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&(r.vertexColors="number"==typeof e.vertexColors?e.vertexColors>0:e.vertexColors),void 0!==e.uniforms)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=(new nr).setHex(o.value);break;case"v2":r.uniforms[s].value=(new Fi).fromArray(o.value);break;case"v3":r.uniforms[s].value=(new Dt).fromArray(o.value);break;case"v4":r.uniforms[s].value=(new $l).fromArray(o.value);break;case"m3":r.uniforms[s].value=(new xa).fromArray(o.value);break;case"m4":r.uniforms[s].value=(new go).fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(r.glslVersion=e.glslVersion),void 0!==e.extensions)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(void 0!==e.lights&&(r.lights=e.lights),void 0!==e.clipping&&(r.clipping=e.clipping),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=i(e.map)),void 0!==e.matcap&&(r.matcap=i(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=i(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=i(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=i(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new Fi).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=i(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=i(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=i(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=i(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=i(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=i(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=i(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=i(e.envMap)),void 0!==e.envMapRotation&&r.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=i(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=i(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=i(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=i(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Fi).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=i(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=i(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=i(e.thicknessMap)),void 0!==e.anisotropyMap&&(r.anisotropyMap=i(e.anisotropyMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=i(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:E0e,SpriteMaterial:MQ,RawShaderMaterial:S0e,ShaderMaterial:Ou,PointsMaterial:sy,MeshPhysicalMaterial:Fg,MeshStandardMaterial:oB,MeshPhongMaterial:Og,MeshToonMaterial:hj,MeshNormalMaterial:T0e,MeshLambertMaterial:D0e,MeshDepthMaterial:x5,MeshDistanceMaterial:wQ,MeshBasicMaterial:wh,MeshMatcapMaterial:I0e,LineDashedMaterial:cx,LineBasicMaterial:Bc,Material:ch}[e]}}class dx{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class $0e extends Hs{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class X0e extends Jd{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Dp(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(h){r?r(h):console.error(h),s.manager.itemError(e)}},i,r)}parse(e){const t={},i={};function r(B,j){if(void 0!==t[j])return t[j];const se=B.interleavedBuffers[j],le=function s(B,j){if(void 0!==i[j])return i[j];const le=new Uint32Array(B.arrayBuffers[j]).buffer;return i[j]=le,le}(B,se.buffer),Ee=sC(se.type,le),Pe=new P4(Ee,se.stride);return Pe.uuid=se.uuid,t[j]=Pe,Pe}const o=e.isInstancedBufferGeometry?new $0e:new Hs,l=e.data.index;if(void 0!==l){const B=sC(l.type,l.array);o.setIndex(new To(B,1))}const h=e.data.attributes;for(const B in h){const j=h[B];let ne;if(j.isInterleavedBufferAttribute){const se=r(e.data,j.data);ne=new ix(se,j.itemSize,j.offset,j.normalized)}else{const se=sC(j.type,j.array);ne=new(j.isInstancedBufferAttribute?RC:To)(se,j.itemSize,j.normalized)}void 0!==j.name&&(ne.name=j.name),void 0!==j.usage&&ne.setUsage(j.usage),o.setAttribute(B,ne)}const u=e.data.morphAttributes;if(u)for(const B in u){const j=u[B],ne=[];for(let se=0,le=j.length;se<le;se++){const Ee=j[se];let Pe;if(Ee.isInterleavedBufferAttribute){const Ve=r(e.data,Ee.data);Pe=new ix(Ve,Ee.itemSize,Ee.offset,Ee.normalized)}else{const Ve=sC(Ee.type,Ee.array);Pe=new To(Ve,Ee.itemSize,Ee.normalized)}void 0!==Ee.name&&(Pe.name=Ee.name),ne.push(Pe)}o.morphAttributes[B]=ne}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const y=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==y)for(let B=0,j=y.length;B!==j;++B){const ne=y[B];o.addGroup(ne.start,ne.count,ne.materialIndex)}const T=e.data.boundingSphere;if(void 0!==T){const B=new Dt;void 0!==T.center&&B.fromArray(T.center),o.boundingSphere=new sd(B,T.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Y0e extends Jd{constructor(e){super(e)}load(e,t,i,r){const s=this,o=""===this.path?dx.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const l=new Dp(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(h){let u=null;try{u=JSON.parse(h)}catch(y){return void 0!==r&&r(y),void console.error("THREE:ObjectLoader: Can't parse "+e+".",y.message)}const f=u.metadata;if(void 0===f||void 0===f.type||"geometry"===f.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);s.parse(u,t)},i,r)}loadAsync(e,t){var i=this;return(0,al.A)(function*(){const r=i,s=""===i.path?dx.extractUrlBase(e):i.path;i.resourcePath=i.resourcePath||s;const o=new Dp(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials);const l=yield o.loadAsync(e,t),h=JSON.parse(l),u=h.metadata;if(void 0===u||void 0===u.type||"geometry"===u.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return yield r.parseAsync(h)})()}parse(e,t){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){void 0!==t&&t(u)}),l=this.parseTextures(e.textures,o),h=this.parseMaterials(e.materials,l),u=this.parseObject(e.object,s,h,l,i),f=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,f),this.bindLightTargets(u),void 0!==t){let y=!1;for(const T in o)if(o[T].data instanceof HTMLImageElement){y=!0;break}!1===y&&t(u)}return u}parseAsync(e){var t=this;return(0,al.A)(function*(){const i=t.parseAnimations(e.animations),r=t.parseShapes(e.shapes),s=t.parseGeometries(e.geometries,r),o=yield t.parseImagesAsync(e.images),l=t.parseTextures(e.textures,o),h=t.parseMaterials(e.materials,l),u=t.parseObject(e.object,s,h,l,i),f=t.parseSkeletons(e.skeletons,u);return t.bindSkeletons(u,f),t.bindLightTargets(u),u})()}parseShapes(e){const t={};if(void 0!==e)for(let i=0,r=e.length;i<r;i++){const s=(new LC).fromJSON(e[i]);t[s.uuid]=s}return t}parseSkeletons(e,t){const i={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),void 0!==e)for(let s=0,o=e.length;s<o;s++){const l=(new N4).fromJSON(e[s],r);i[l.uuid]=l}return i}parseGeometries(e,t){const i={};if(void 0!==e){const r=new X0e;for(let s=0,o=e.length;s<o;s++){let l;const h=e[s];switch(h.type){case"BufferGeometry":case"InstancedBufferGeometry":l=r.parse(h);break;default:h.type in cj?l=cj[h.type].fromJSON(h,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${h.type}"`)}l.uuid=h.uuid,void 0!==h.name&&(l.name=h.name),void 0!==h.userData&&(l.userData=h.userData),i[h.uuid]=l}}return i}parseMaterials(e,t){const i={},r={};if(void 0!==e){const s=new lL;s.setTextures(t);for(let o=0,l=e.length;o<l;o++){const h=e[o];void 0===i[h.uuid]&&(i[h.uuid]=s.parse(h)),r[h.uuid]=i[h.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let i=0;i<e.length;i++){const s=JS.parse(e[i]);t[s.uuid]=s}return t}parseImages(e,t){const i=this,r={};let s;function l(h){if("string"==typeof h){const u=h;return function o(h){return i.manager.itemStart(h),s.load(h,function(){i.manager.itemEnd(h)},void 0,function(){i.manager.itemError(h),i.manager.itemEnd(h)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:i.resourcePath+u)}return h.data?{data:sC(h.type,h.data),width:h.width,height:h.height}:null}if(void 0!==e&&e.length>0){const h=new mj(t);s=new aB(h),s.setCrossOrigin(this.crossOrigin);for(let u=0,f=e.length;u<f;u++){const y=e[u],T=y.url;if(Array.isArray(T)){const B=[];for(let j=0,ne=T.length;j<ne;j++){const le=l(T[j]);null!==le&&(le instanceof HTMLImageElement?B.push(le):B.push(new ry(le.data,le.width,le.height)))}r[y.uuid]=new Wb(B)}else{const B=l(y.url);r[y.uuid]=new Wb(B)}}}return r}parseImagesAsync(e){var t=this;return(0,al.A)(function*(){const i=t,r={};let s;function o(h){return l.apply(this,arguments)}function l(){return(l=(0,al.A)(function*(h){if("string"==typeof h){const u=h,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:i.resourcePath+u;return yield s.loadAsync(f)}return h.data?{data:sC(h.type,h.data),width:h.width,height:h.height}:null})).apply(this,arguments)}if(void 0!==e&&e.length>0){s=new aB(t.manager),s.setCrossOrigin(t.crossOrigin);for(let h=0,u=e.length;h<u;h++){const f=e[h],y=f.url;if(Array.isArray(y)){const T=[];for(let B=0,j=y.length;B<j;B++){const ne=y[B],se=yield o(ne);null!==se&&(se instanceof HTMLImageElement?T.push(se):T.push(new ry(se.data,se.width,se.height)))}r[f.uuid]=new Wb(T)}else{const T=yield o(f.url);r[f.uuid]=new Wb(T)}}}return r})()}parseTextures(e,t){function i(s,o){return"number"==typeof s?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(void 0!==e)for(let s=0,o=e.length;s<o;s++){const l=e[s];void 0===l.image&&console.warn('THREE.ObjectLoader: No "image" specified for',l.uuid),void 0===t[l.image]&&console.warn("THREE.ObjectLoader: Undefined image",l.image);const h=t[l.image],u=h.data;let f;Array.isArray(u)?(f=new C4,6===u.length&&(f.needsUpdate=!0)):(f=u&&u.data?new ry:new Yd,u&&(f.needsUpdate=!0)),f.source=h,f.uuid=l.uuid,void 0!==l.name&&(f.name=l.name),void 0!==l.mapping&&(f.mapping=i(l.mapping,K0e)),void 0!==l.channel&&(f.channel=l.channel),void 0!==l.offset&&f.offset.fromArray(l.offset),void 0!==l.repeat&&f.repeat.fromArray(l.repeat),void 0!==l.center&&f.center.fromArray(l.center),void 0!==l.rotation&&(f.rotation=l.rotation),void 0!==l.wrap&&(f.wrapS=i(l.wrap[0],bj),f.wrapT=i(l.wrap[1],bj)),void 0!==l.format&&(f.format=l.format),void 0!==l.internalFormat&&(f.internalFormat=l.internalFormat),void 0!==l.type&&(f.type=l.type),void 0!==l.colorSpace&&(f.colorSpace=l.colorSpace),void 0!==l.minFilter&&(f.minFilter=i(l.minFilter,xj)),void 0!==l.magFilter&&(f.magFilter=i(l.magFilter,xj)),void 0!==l.anisotropy&&(f.anisotropy=l.anisotropy),void 0!==l.flipY&&(f.flipY=l.flipY),void 0!==l.generateMipmaps&&(f.generateMipmaps=l.generateMipmaps),void 0!==l.premultiplyAlpha&&(f.premultiplyAlpha=l.premultiplyAlpha),void 0!==l.unpackAlignment&&(f.unpackAlignment=l.unpackAlignment),void 0!==l.compareFunction&&(f.compareFunction=l.compareFunction),void 0!==l.userData&&(f.userData=l.userData),r[l.uuid]=f}return r}parseObject(e,t,i,r,s){let o,f,y;function l(T){return void 0===t[T]&&console.warn("THREE.ObjectLoader: Undefined geometry",T),t[T]}function h(T){if(void 0!==T){if(Array.isArray(T)){const B=[];for(let j=0,ne=T.length;j<ne;j++){const se=T[j];void 0===i[se]&&console.warn("THREE.ObjectLoader: Undefined material",se),B.push(i[se])}return B}return void 0===i[T]&&console.warn("THREE.ObjectLoader: Undefined material",T),i[T]}}function u(T){return void 0===r[T]&&console.warn("THREE.ObjectLoader: Undefined texture",T),r[T]}switch(e.type){case"Scene":o=new US,void 0!==e.background&&(o.background=Number.isInteger(e.background)?new nr(e.background):u(e.background)),void 0!==e.environment&&(o.environment=u(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new S5(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new E5(e.fog.color,e.fog.density)),""!==e.fog.name&&(o.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(o.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(o.backgroundIntensity=e.backgroundIntensity),void 0!==e.backgroundRotation&&o.backgroundRotation.fromArray(e.backgroundRotation),void 0!==e.environmentIntensity&&(o.environmentIntensity=e.environmentIntensity),void 0!==e.environmentRotation&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Lu(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Jb(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new lB(e.color,e.intensity);break;case"DirectionalLight":o=new qC(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new vj(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Q0e(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new _j(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new H0e(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=(new W0e).fromJSON(e);break;case"SkinnedMesh":f=l(e.geometry),y=h(e.material),o=new FQ(f,y),void 0!==e.bindMode&&(o.bindMode=e.bindMode),void 0!==e.bindMatrix&&o.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(o.skeleton=e.skeleton);break;case"Mesh":f=l(e.geometry),y=h(e.material),o=new jo(f,y);break;case"InstancedMesh":f=l(e.geometry),y=h(e.material);const B=e.instanceMatrix,j=e.instanceColor;o=new UQ(f,y,e.count),o.instanceMatrix=new RC(new Float32Array(B.array),16),void 0!==j&&(o.instanceColor=new RC(new Float32Array(j.array),j.itemSize));break;case"BatchedMesh":f=l(e.geometry),y=h(e.material),o=new Wge(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,y),o.geometry=f,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(ne=>{const se=new Gf;se.min.fromArray(ne.boxMin),se.max.fromArray(ne.boxMax);const le=new sd;return le.radius=ne.sphereRadius,le.center.fromArray(ne.sphereCenter),{boxInitialized:ne.boxInitialized,box:se,sphereInitialized:ne.sphereInitialized,sphere:le}}),o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=u(e.matricesTexture.uuid),void 0!==e.colorsTexture&&(o._colorsTexture=u(e.colorsTexture.uuid));break;case"LOD":o=new Oge;break;case"Line":o=new kg(l(e.geometry),h(e.material));break;case"LineLoop":o=new jQ(l(e.geometry),h(e.material));break;case"LineSegments":o=new yc(l(e.geometry),h(e.material));break;case"PointCloud":case"Points":o=new sx(l(e.geometry),h(e.material));break;case"Sprite":o=new Fge(h(e.material));break;case"Group":o=new Xl;break;case"Bone":o=new B5;break;default:o=new Wa}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.up&&o.up.fromArray(e.up),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.intensity&&(o.shadow.intensity=e.shadow.intensity),void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children){const T=e.children;for(let B=0;B<T.length;B++)o.add(this.parseObject(T[B],t,i,r,s))}if(void 0!==e.animations){const T=e.animations;for(let B=0;B<T.length;B++)o.animations.push(s[T[B]])}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);const T=e.levels;for(let B=0;B<T.length;B++){const j=T[B],ne=o.getObjectByProperty("uuid",j.object);void 0!==ne&&o.addLevel(ne,j.distance,j.hysteresis)}}return o}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(i){if(!0===i.isSkinnedMesh&&void 0!==i.skeleton){const r=t[i.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const r=e.getObjectByProperty("uuid",t.target);t.target=void 0!==r?r:new Wa}})}}const K0e={UVMapping:300,CubeReflectionMapping:q1,CubeRefractionMapping:Gb,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,CubeUVReflectionMapping:SS},bj={RepeatWrapping:Q1,ClampToEdgeWrapping:_m,MirroredRepeatWrapping:$2},xj={NearestFilter:Fu,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:qb,LinearFilter:bh,LinearMipmapNearestFilter:X2,LinearMipmapLinearFilter:xA};class Z0e extends Jd{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=tv.get(e);if(void 0!==o)return s.manager.itemStart(e),o.then?void o.then(u=>{t&&t(u),s.manager.itemEnd(e)}).catch(u=>{r&&r(u)}):(setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o);const l={};l.credentials="anonymous"===this.crossOrigin?"same-origin":"include",l.headers=this.requestHeader;const h=fetch(e,l).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(u){return tv.add(e,u),t&&t(u),s.manager.itemEnd(e),u}).catch(function(u){r&&r(u),tv.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});tv.add(e,h),s.manager.itemStart(e)}}class Ej{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Sj(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Sj();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Sj(){return(typeof performance>"u"?Date:performance).now()}const cL="\\[\\]\\.:\\/",i_e=new RegExp("["+cL+"]","g"),hL="[^"+cL+"]",r_e="[^"+cL.replace("\\.","")+"]",c_e=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",hL)+/(WCOD+)?/.source.replace("WCOD",r_e)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",hL)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",hL)+"$"),h_e=["material","materials","bones","map"];class u_e{constructor(e,t,i){const r=i||Fl.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Fl=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(i_e,"")}static parseTrackName(t){const i=c_e.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==h_e.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let l=0;l<o.length;l++){const h=o[l];if(h.name===i||h.uuid===i)return h;const u=r(h.children);if(u)return u}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let f=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let y=0;y<t.length;y++)if(t[y].name===f){f=y;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==f){if(void 0===t[f])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[f]}}const l=t[s];if(void 0===l)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let h=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?h=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(h=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}u=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=o}else void 0!==l.fromArray&&void 0!==l.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(u=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=s;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][h]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=u_e,n})();Fl.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Fl.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Fl.prototype.GetterByBindingType=[Fl.prototype._getValue_direct,Fl.prototype._getValue_array,Fl.prototype._getValue_arrayElement,Fl.prototype._getValue_toArray],Fl.prototype.SetterByBindingTypeAndVersioning=[[Fl.prototype._setValue_direct,Fl.prototype._setValue_direct_setNeedsUpdate,Fl.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Fl.prototype._setValue_array,Fl.prototype._setValue_array_setNeedsUpdate,Fl.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Fl.prototype._setValue_arrayElement,Fl.prototype._setValue_arrayElement_setNeedsUpdate,Fl.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Fl.prototype._setValue_fromArray,Fl.prototype._setValue_fromArray_setNeedsUpdate,Fl.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class uL{constructor(e){this.value=e}clone(){return new uL(void 0===this.value.clone?this.value:this.value.clone())}}const Ij=new go;class Bj{constructor(e,t,i=0,r=1/0){this.ray=new dC(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new t5,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return Ij.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Ij),this}intersectObject(e,t=!0,i=[]){return dL(e,this,i,t),i.sort(Pj),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)dL(e[r],this,i,t);return i.sort(Pj),i}}function Pj(n,e){return n.distance-e.distance}function dL(n,e,t,i){let r=!0;if(n.layers.test(e.layers)&&!1===n.raycast(e,t)&&(r=!1),!0===r&&!0===i){const s=n.children;for(let o=0,l=s.length;o<l;o++)dL(s[o],e,t,!0)}}class Rj{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(xh(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const Oj=new Dt,hB=new Dt;class qj extends yc{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new Hs;r.setAttribute("position",new Bs(t,3)),r.setAttribute("color",new Bs([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new Bc({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,i){const r=new nr,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class g_e{constructor(){this.type="ShapePath",this.color=new nr,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Y4,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function i(le,Ee){const Pe=Ee.length;let Ve=!1;for(let Ft=Pe-1,Ct=0;Ct<Pe;Ft=Ct++){let Lt=Ee[Ft],Kt=Ee[Ct],Bt=Kt.x-Lt.x,St=Kt.y-Lt.y;if(Math.abs(St)>Number.EPSILON){if(St<0&&(Lt=Ee[Ct],Bt=-Bt,Kt=Ee[Ft],St=-St),le.y<Lt.y||le.y>Kt.y)continue;if(le.y===Lt.y){if(le.x===Lt.x)return!0}else{const Dn=St*(le.x-Lt.x)-Bt*(le.y-Lt.y);if(0===Dn)return!0;if(Dn<0)continue;Ve=!Ve}}else{if(le.y!==Lt.y)continue;if(Kt.x<=le.x&&le.x<=Lt.x||Lt.x<=le.x&&le.x<=Kt.x)return!0}}return Ve}const r=oy.isClockWise,s=this.subPaths;if(0===s.length)return[];let o,l,h;const u=[];if(1===s.length)return l=s[0],h=new LC,h.curves=l.curves,u.push(h),u;let f=!r(s[0].getPoints());f=e?!f:f;const y=[],T=[];let ne,se,B=[],j=0;T[j]=void 0,B[j]=[];for(let le=0,Ee=s.length;le<Ee;le++)l=s[le],ne=l.getPoints(),o=r(ne),o=e?!o:o,o?(!f&&T[j]&&j++,T[j]={s:new LC,p:ne},T[j].s.curves=l.curves,f&&j++,B[j]=[]):B[j].push({h:l,p:ne[0]});if(!T[0])return function t(le){const Ee=[];for(let Pe=0,Ve=le.length;Pe<Ve;Pe++){const Ft=le[Pe],Ct=new LC;Ct.curves=Ft.curves,Ee.push(Ct)}return Ee}(s);if(T.length>1){let le=!1,Ee=0;for(let Pe=0,Ve=T.length;Pe<Ve;Pe++)y[Pe]=[];for(let Pe=0,Ve=T.length;Pe<Ve;Pe++){const Ft=B[Pe];for(let Ct=0;Ct<Ft.length;Ct++){const Lt=Ft[Ct];let Kt=!0;for(let Bt=0;Bt<T.length;Bt++)i(Lt.p,T[Bt].p)&&(Pe!==Bt&&Ee++,Kt?(Kt=!1,y[Bt].push(Lt)):le=!0);Kt&&y[Pe].push(Lt)}}Ee>0&&!1===le&&(B=y)}for(let le=0,Ee=T.length;le<Ee;le++){h=T[le].s,u.push(h),se=B[le];for(let Pe=0,Ve=se.length;Pe<Ve;Pe++)h.holes.push(se[Pe].h)}return u}}class __e extends K_{constructor(e,t){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:zb}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=zb);var y_e=Te(339),v_e=Te.n(y_e);const Qj={type:"change"},mL={type:"start"},jj={type:"end"},AB=new dC,Wj=new MA,b_e=Math.cos(70*IS.DEG2RAD),zu=new Dt,Ip=2*Math.PI,AL=1e-6;class x_e extends __e{constructor(e,t=null){super(e,t),this.state=-1,this.enabled=!0,this.target=new Dt,this.cursor=new Dt,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new Dt,this._lastQuaternion=new zc,this._lastTargetPosition=new Dt,this._quat=(new zc).setFromUnitVectors(e.up,new Dt(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Rj,this._sphericalDelta=new Rj,this._scale=1,this._panOffset=new Dt,this._rotateStart=new Fi,this._rotateEnd=new Fi,this._rotateDelta=new Fi,this._panStart=new Fi,this._panEnd=new Fi,this._panDelta=new Fi,this._dollyStart=new Fi,this._dollyEnd=new Fi,this._dollyDelta=new Fi,this._dollyDirection=new Dt,this._mouse=new Fi,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=C_e.bind(this),this._onPointerDown=w_e.bind(this),this._onPointerUp=M_e.bind(this),this._onContextMenu=P_e.bind(this),this._onMouseWheel=T_e.bind(this),this._onKeyDown=D_e.bind(this),this._onTouchStart=I_e.bind(this),this._onTouchMove=B_e.bind(this),this._onMouseDown=E_e.bind(this),this._onMouseMove=S_e.bind(this),this._interceptControlDown=R_e.bind(this),this._interceptControlUp=k_e.bind(this),null!==this.domElement&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){null!==this._domElementKeyEvents&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Qj),this.update(),this.state=-1}update(e=null){const t=this.object.position;zu.copy(t).sub(this.target),zu.applyQuaternion(this._quat),this._spherical.setFromVector3(zu),this.autoRotate&&-1===this.state&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let i=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(i)&&isFinite(r)&&(i<-Math.PI?i+=Ip:i>Math.PI&&(i-=Ip),r<-Math.PI?r+=Ip:r>Math.PI&&(r-=Ip),this._spherical.theta=i<=r?Math.max(i,Math.min(r,this._spherical.theta)):this._spherical.theta>(i+r)/2?Math.max(i,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),!0===this.enableDamping?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let s=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const o=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),s=o!=this._spherical.radius}if(zu.setFromSpherical(this._spherical),zu.applyQuaternion(this._quatInverse),t.copy(this.target).add(zu),this.object.lookAt(this.target),!0===this.enableDamping?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let o=null;if(this.object.isPerspectiveCamera){const l=zu.length();o=this._clampDistance(l*this._scale);const h=l-o;this.object.position.addScaledVector(this._dollyDirection,h),this.object.updateMatrixWorld(),s=!!h}else if(this.object.isOrthographicCamera){const l=new Dt(this._mouse.x,this._mouse.y,0);l.unproject(this.object);const h=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),s=h!==this.object.zoom;const u=new Dt(this._mouse.x,this._mouse.y,0);u.unproject(this.object),this.object.position.sub(u).add(l),this.object.updateMatrixWorld(),o=zu.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;null!==o&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(AB.origin.copy(this.object.position),AB.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(AB.direction))<b_e?this.object.lookAt(this.target):(Wj.setFromNormalAndCoplanarPoint(this.object.up,this.target),AB.intersectPlane(Wj,this.target))))}else if(this.object.isOrthographicCamera){const o=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),o!==this.object.zoom&&(this.object.updateProjectionMatrix(),s=!0)}return this._scale=1,this._performCursorZoom=!1,!!(s||this._lastPosition.distanceToSquared(this.object.position)>AL||8*(1-this._lastQuaternion.dot(this.object.quaternion))>AL||this._lastTargetPosition.distanceToSquared(this.target)>AL)&&(this.dispatchEvent(Qj),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0)}_getAutoRotationAngle(e){return null!==e?Ip/60*this.autoRotateSpeed*e:Ip/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(.01*e);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){zu.setFromMatrixColumn(t,0),zu.multiplyScalar(-e),this._panOffset.add(zu)}_panUp(e,t){!0===this.screenSpacePanning?zu.setFromMatrixColumn(t,1):(zu.setFromMatrixColumn(t,0),zu.crossVectors(this.object.up,zu)),zu.multiplyScalar(e),this._panOffset.add(zu)}_pan(e,t){const i=this.domElement;if(this.object.isPerspectiveCamera){zu.copy(this.object.position).sub(this.target);let s=zu.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/i.clientHeight,this.object.matrix),this._panUp(2*t*s/i.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const i=this.domElement.getBoundingClientRect(),s=t-i.top,l=i.height;this._mouse.x=(e-i.left)/i.width*2-1,this._mouse.y=-s/l*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Ip*this._rotateDelta.x/t.clientHeight),this._rotateUp(Ip*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(Ip*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(-Ip*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(Ip*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(-Ip*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(1===this._pointers.length)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e);this._rotateStart.set(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}}_handleTouchStartPan(e){if(1===this._pointers.length)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e);this._panStart.set(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);this._dollyStart.set(0,s)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(1==this._pointers.length)this._rotateEnd.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e);this._rotateEnd.set(.5*(e.pageX+i.x),.5*(e.pageY+i.y))}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Ip*this._rotateDelta.x/t.clientHeight),this._rotateUp(Ip*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(1===this._pointers.length)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e);this._panEnd.set(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);this._dollyEnd.set(0,s),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd),this._updateZoomParameters(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return void this._pointers.splice(t,1)}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];void 0===t&&(t=new Fi,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){return this._pointerPositions[e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0]]}_customWheelEvent(e){const i={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(e.deltaMode){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100}return e.ctrlKey&&!this._controlActive&&(i.deltaY*=10),i}}function w_e(n){!1!==this.enabled&&(0===this._pointers.length&&(this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(n)&&(this._addPointer(n),"touch"===n.pointerType?this._onTouchStart(n):this._onMouseDown(n)))}function C_e(n){!1!==this.enabled&&("touch"===n.pointerType?this._onTouchMove(n):this._onMouseMove(n))}function M_e(n){switch(this._removePointer(n),this._pointers.length){case 0:this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(jj),this.state=-1;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y})}}function E_e(n){let e;switch(n.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case 1:if(!1===this.enableZoom)return;this._handleMouseDownDolly(n),this.state=1;break;case 0:if(n.ctrlKey||n.metaKey||n.shiftKey){if(!1===this.enablePan)return;this._handleMouseDownPan(n),this.state=2}else{if(!1===this.enableRotate)return;this._handleMouseDownRotate(n),this.state=0}break;case 2:if(n.ctrlKey||n.metaKey||n.shiftKey){if(!1===this.enableRotate)return;this._handleMouseDownRotate(n),this.state=0}else{if(!1===this.enablePan)return;this._handleMouseDownPan(n),this.state=2}break;default:this.state=-1}-1!==this.state&&this.dispatchEvent(mL)}function S_e(n){switch(this.state){case 0:if(!1===this.enableRotate)return;this._handleMouseMoveRotate(n);break;case 1:if(!1===this.enableZoom)return;this._handleMouseMoveDolly(n);break;case 2:if(!1===this.enablePan)return;this._handleMouseMovePan(n)}}function T_e(n){!1===this.enabled||!1===this.enableZoom||-1!==this.state||(n.preventDefault(),this.dispatchEvent(mL),this._handleMouseWheel(this._customWheelEvent(n)),this.dispatchEvent(jj))}function D_e(n){!1===this.enabled||!1===this.enablePan||this._handleKeyDown(n)}function I_e(n){switch(this._trackPointer(n),this._pointers.length){case 1:switch(this.touches.ONE){case 0:if(!1===this.enableRotate)return;this._handleTouchStartRotate(n),this.state=3;break;case 1:if(!1===this.enablePan)return;this._handleTouchStartPan(n),this.state=4;break;default:this.state=-1}break;case 2:switch(this.touches.TWO){case 2:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchStartDollyPan(n),this.state=5;break;case 3:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchStartDollyRotate(n),this.state=6;break;default:this.state=-1}break;default:this.state=-1}-1!==this.state&&this.dispatchEvent(mL)}function B_e(n){switch(this._trackPointer(n),this.state){case 3:if(!1===this.enableRotate)return;this._handleTouchMoveRotate(n),this.update();break;case 4:if(!1===this.enablePan)return;this._handleTouchMovePan(n),this.update();break;case 5:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchMoveDollyPan(n),this.update();break;case 6:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchMoveDollyRotate(n),this.update();break;default:this.state=-1}}function P_e(n){!1!==this.enabled&&n.preventDefault()}function R_e(n){"Control"===n.key&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function k_e(n){"Control"===n.key&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}class F_e{constructor(e,t=[0,0,200]){this.controls=[];const i=e.getMainRenderer()?.domElement,r=new Lu(75,i.offsetWidth/i.offsetHeight,10,1e5),s=new Jb(i.offsetWidth/-2,i.offsetWidth/2,i.offsetHeight/2,i.offsetHeight/-2,10,1e5);this.perspectiveControls=this.setOrbitControls(r,i),this.orthographicControls=this.setOrbitControls(s,i),r.position.z=s.position.z=t[2],r.position.y=s.position.y=t[1],r.position.x=s.position.x=t[0],t.length>=6&&(this.perspectiveControls.target=this.orthographicControls.target=new Dt(t[3],t[4],t[5])),this.addControls(this.perspectiveControls),this.addControls(this.orthographicControls),this.setActiveControls(this.perspectiveControls),this.setMainControls(this.perspectiveControls),this.setOverlayControls(this.orthographicControls),this.getActiveControls().addEventListener("change",()=>{this.transformSync(),this.updateSync()}),this.setupResize(i)}setOrbitControls(e,t){const i=new x_e(e,t);return i.enableDamping=!0,i.dampingFactor=.25,i.enableZoom=!0,i.autoRotate=!1,i}setActiveControls(e){this.activeControls=e}setMainControls(e){this.mainControls=e}setOverlayControls(e){this.overlayControls=e}getActiveControls(){return this.activeControls}getMainControls(){return this.mainControls}getOverlayControls(){return this.overlayControls}getActiveCamera(){return this.activeControls.object}getMainCamera(){return this.mainControls.object}getOverlayCamera(){return this.overlayControls.object}getAllCameras(){return[this.getMainCamera(),this.getOverlayCamera()]}addControls(e){this.containsObject(e,this.controls)||this.controls.push(e)}removeControls(e){const t=this.controls.indexOf(e);t>-1&&this.controls.splice(t,1)}swapControls(){const e=this.mainControls;this.mainControls=this.overlayControls,this.overlayControls=e}updateSync(){for(const e of this.controls)e!==this.activeControls&&this.update(e)}update(e){e.update()}transformSync(){for(const e of this.controls)e!==this.activeControls&&(this.positionSync(e),this.rotationSync(e))}zoomTo(e,t){for(const i of this.getAllCameras())i instanceof Jb?(new zf(i).to({zoom:i.zoom*(1/e)},t).start(),i.updateProjectionMatrix()):new zf(i.position).to({x:i.position.x*e,y:i.position.y*e,z:i.position.z*e},t).start()}lookAtObject(e,t,i=0){new Dt(0,0,0);const s=this.getObjectPosition(e,t);if(s)for(const o of this.getAllCameras())new zf(o.position).to({x:1.1*s.x+i,y:1.1*s.y+i,z:1.1*s.z+i},200).start()}getObjectPosition(e,t){const i=t.getObjectByProperty("uuid",e);if(i){const r=new Dt(0,0,0);let s=new Dt;return i instanceof Xl?i.traverse(o=>{if(0===o.children.length)if(o.position.equals(r)){if(o.geometry?.boundingSphere)try{s.add(o.geometry.boundingSphere.getBoundingBox().max)}catch{s.add(o.geometry.boundingSphere?.center)}}else s.add(o.position)}):s=i.position.equals(r)?i.geometry?.boundingSphere?.center:i.position,s}return new Dt}hideTubeTracksOnZoom(e,t){let i=!1;const r=new Dt;this.activeControls.addEventListener("change",s=>{const o=(s?.target?.object?.position).distanceTo(r)<t;o&&!i?(e.getObjectByName("Tracks")?.traverse(l=>{"Track"===l.name&&l.geometry instanceof lx&&(l.visible=!1)}),i=!0):!o&&i&&(e.getObjectByName("Tracks")?.traverse(l=>{"Track"===l.name&&l.geometry instanceof lx&&(l.visible=!0)}),i=!1)})}positionSync(e){e.object.position.set(this.activeControls.object.position.x,this.activeControls.object.position.y,this.activeControls.object.position.z)}rotationSync(e){e.target=this.activeControls.target}containsObject(e,t){for(const i of t)if(i===e)return!0;return!1}setupResize(e){window.addEventListener("resize",()=>{let t=this.getMainCamera();t.isOrthographicCamera?(t.left=e.offsetWidth/-2,t.right=e.offsetWidth/2,t.top=e.offsetHeight/2,t.bottom=e.offsetHeight/-2,t.updateProjectionMatrix()):(t.aspect=e.offsetWidth/e.offsetHeight,t.updateProjectionMatrix())})}objectIndex(e,t){for(let i=0;i<t.length;i++)if(t[i]===e)return i;return-1}}class O_e{constructor(){this.renderers=[];const e=new M5({antialias:!0,alpha:!0,powerPreference:"high-performance"});this.addRenderer(e),this.setMainRenderer(e)}init(e="eventDisplay"){this.getMainRenderer().setAnimationLoop(null),this.initRenderer(e)}render(e,t){if(this.getOverlayRenderer()&&!this.getOverlayRenderer().domElement.hidden){const i=e.background;e.background=null,this.isFixedOverlay()||this.getOverlayRenderer().render(e,t),e.background=i}}initRenderer(e){let t=document.getElementById(e);t||(t=document.body);const i=()=>t.offsetWidth>0?t.offsetWidth:window.innerWidth,r=()=>t.offsetHeight>0?t.offsetHeight:window.innerHeight,s=this.getMainRenderer();s.setSize(i(),r(),!1),s.setPixelRatio(window.devicePixelRatio),s.domElement.id="three-canvas",t.appendChild(this.getMainRenderer().domElement),window.addEventListener("resize",()=>{s.setSize(i(),r())})}setMainRenderer(e){this.mainRenderer=e}setOverlayRenderer(e){const t=new M5({canvas:e,antialias:!1,alpha:!0});this.addRenderer(t),this.overlayRenderer=t}setRenderers(e){this.renderers=e}getMainRenderer(){return this.mainRenderer}getOverlayRenderer(){return this.overlayRenderer}getRenderers(){return this.renderers}addRenderer(e){this.containsObject(e,this.renderers)||this.renderers.push(e)}removeControls(e){const t=this.renderers.indexOf(e);t>-1&&this.renderers.splice(t,1)}swapRenderers(e,t){const i=e;e=t,t=i}containsObject(e,t){for(const i of t)if(i===e)return!0;return!1}setLocalClippingEnabled(e){for(const t of this.renderers)t.localClippingEnabled=e}getLocalClipping(){if(this.renderers.length>0)return this.renderers[0].localClippingEnabled}isFixedOverlay(){return this.fixedOverlay}setFixOverlay(e){this.fixedOverlay=e}}class L_e{parse(e){let t="",i=0,r=0,s=0;const o=new Dt,l=new nr,h=new Dt,u=new Fi,f=[];return e.traverse(function(j){!0===j.isMesh&&function y(j){let ne=0,se=0,le=0;const Ee=j.geometry,Pe=new xa,Ve=Ee.getAttribute("position"),Ft=Ee.getAttribute("normal"),Ct=Ee.getAttribute("uv"),Lt=Ee.getIndex();if(t+="o "+j.name+"\n",j.material&&j.material.name&&(t+="usemtl "+j.material.name+"\n"),void 0!==Ve)for(let Kt=0,Bt=Ve.count;Kt<Bt;Kt++,ne++)o.fromBufferAttribute(Ve,Kt),o.applyMatrix4(j.matrixWorld),t+="v "+o.x+" "+o.y+" "+o.z+"\n";if(void 0!==Ct)for(let Kt=0,Bt=Ct.count;Kt<Bt;Kt++,le++)u.fromBufferAttribute(Ct,Kt),t+="vt "+u.x+" "+u.y+"\n";if(void 0!==Ft){Pe.getNormalMatrix(j.matrixWorld);for(let Kt=0,Bt=Ft.count;Kt<Bt;Kt++,se++)h.fromBufferAttribute(Ft,Kt),h.applyMatrix3(Pe).normalize(),t+="vn "+h.x+" "+h.y+" "+h.z+"\n"}if(null!==Lt)for(let Kt=0,Bt=Lt.count;Kt<Bt;Kt+=3){for(let St=0;St<3;St++){const Dn=Lt.getX(Kt+St)+1;f[St]=i+Dn+(Ft||Ct?"/"+(Ct?r+Dn:"")+(Ft?"/"+(s+Dn):""):"")}t+="f "+f.join(" ")+"\n"}else for(let Kt=0,Bt=Ve.count;Kt<Bt;Kt+=3){for(let St=0;St<3;St++){const Dn=Kt+St+1;f[St]=i+Dn+(Ft||Ct?"/"+(Ct?r+Dn:"")+(Ft?"/"+(s+Dn):""):"")}t+="f "+f.join(" ")+"\n"}i+=ne,r+=le,s+=se}(j),!0===j.isLine&&function T(j){let ne=0;const le=j.type,Ee=j.geometry.getAttribute("position");if(t+="o "+j.name+"\n",void 0!==Ee)for(let Pe=0,Ve=Ee.count;Pe<Ve;Pe++,ne++)o.fromBufferAttribute(Ee,Pe),o.applyMatrix4(j.matrixWorld),t+="v "+o.x+" "+o.y+" "+o.z+"\n";if("Line"===le){t+="l ";for(let Pe=1,Ve=Ee.count;Pe<=Ve;Pe++)t+=i+Pe+" ";t+="\n"}if("LineSegments"===le)for(let Pe=1,Ve=Pe+1,Ft=Ee.count;Pe<Ft;Pe+=2,Ve=Pe+1)t+="l "+(i+Pe)+" "+(i+Ve)+"\n";i+=ne}(j),!0===j.isPoints&&function B(j){let ne=0;const se=j.geometry,le=se.getAttribute("position"),Ee=se.getAttribute("color");if(t+="o "+j.name+"\n",void 0!==le){for(let Pe=0,Ve=le.count;Pe<Ve;Pe++,ne++)o.fromBufferAttribute(le,Pe),o.applyMatrix4(j.matrixWorld),t+="v "+o.x+" "+o.y+" "+o.z,void 0!==Ee&&(l.fromBufferAttribute(Ee,Pe).convertLinearToSRGB(),t+=" "+l.r+" "+l.g+" "+l.b),t+="\n";t+="p ";for(let Pe=1,Ve=le.count;Pe<=Ve;Pe++)t+=i+Pe+" ";t+="\n"}i+=ne}(j)}),t}}let tT,gL,QC,gB;function _L(n,e=1/0,t=null){gL||(gL=new MC(2,2,1,1)),QC||(QC=new Ou({uniforms:{blitTexture:new uL(n)},vertexShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main(){\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = vec4(position.xy * 1.0,0.,.999999);\n\t\t\t}",fragmentShader:"\n\t\t\tuniform sampler2D blitTexture; \n\t\t\tvarying vec2 vUv;\n\n\t\t\tvoid main(){ \n\t\t\t\tgl_FragColor = vec4(vUv.xy, 0, 1);\n\t\t\t\t\n\t\t\t\t#ifdef IS_SRGB\n\t\t\t\tgl_FragColor = sRGBTransferOETF( texture2D( blitTexture, vUv) );\n\t\t\t\t#else\n\t\t\t\tgl_FragColor = texture2D( blitTexture, vUv);\n\t\t\t\t#endif\n\t\t\t}"})),QC.uniforms.blitTexture.value=n,QC.defines.IS_SRGB=n.colorSpace==hu,QC.needsUpdate=!0,gB||(gB=new jo(gL,QC),gB.frustumCulled=!1);const i=new Lu,r=new US;r.add(gB),null===t&&(t=tT=new M5({antialias:!1}));const s=Math.min(n.image.width,e),o=Math.min(n.image.height,e);t.setSize(s,o),t.clear(),t.render(r,i);const l=document.createElement("canvas"),h=l.getContext("2d");l.width=s,l.height=o,h.drawImage(t.domElement,0,0,s,o);const u=new XQ(l);return u.minFilter=n.minFilter,u.magFilter=n.magFilter,u.wrapS=n.wrapS,u.wrapT=n.wrapT,u.name=n.name,tT&&(tT.forceContextLoss(),tT.dispose(),tT=null),u}const $j={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class yL{constructor(){this.pluginCallbacks=[],this.register(function(e){return new W_e(e)}),this.register(function(e){return new $_e(e)}),this.register(function(e){return new Z_e(e)}),this.register(function(e){return new J_e(e)}),this.register(function(e){return new eye(e)}),this.register(function(e){return new tye(e)}),this.register(function(e){return new X_e(e)}),this.register(function(e){return new Y_e(e)}),this.register(function(e){return new K_e(e)}),this.register(function(e){return new nye(e)}),this.register(function(e){return new iye(e)}),this.register(function(e){return new rye(e)}),this.register(function(e){return new sye(e)}),this.register(function(e){return new oye(e)})}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){const s=new j_e,o=[];for(let l=0,h=this.pluginCallbacks.length;l<h;l++)o.push(this.pluginCallbacks[l](s));s.setPlugins(o),s.write(e,t,r).catch(i)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,r,s,t)})}}const vL="KHR_mesh_quantization",Cm={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987,1001:33071,1e3:10497,1002:33648},Xj={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},N_e=new nr;function nT(n,e){return n.length===e.length&&n.every(function(t,i){return t===e[i]})}function Zj(n){return 4*Math.ceil(n/4)}function bL(n,e=0){const t=Zj(n.byteLength);if(t!==n.byteLength){const i=new Uint8Array(t);if(i.set(new Uint8Array(n)),0!==e)for(let r=n.byteLength;r<t;r++)i[r]=e;return i.buffer}return n}function Jj(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function eW(n,e){if(void 0!==n.toBlob)return new Promise(i=>n.toBlob(i,e));let t;return"image/jpeg"===e?t=.92:"image/webp"===e&&(t=.8),n.convertToBlob({type:e,quality:t})}class j_e{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter r168"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}write(e,t,i={}){var r=this;return(0,al.A)(function*(){r.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},i),r.options.animations.length>0&&(r.options.trs=!0),r.processInput(e),yield Promise.all(r.pending);const l=r.json;i=r.options;const h=r.extensionsUsed,u=r.extensionsRequired,f=new Blob(r.buffers,{type:"application/octet-stream"}),y=Object.keys(h),T=Object.keys(u);if(y.length>0&&(l.extensionsUsed=y),T.length>0&&(l.extensionsRequired=T),l.buffers&&l.buffers.length>0&&(l.buffers[0].byteLength=f.size),!0===i.binary){const B=new FileReader;B.readAsArrayBuffer(f),B.onloadend=function(){const j=bL(B.result),ne=new DataView(new ArrayBuffer(8));ne.setUint32(0,j.byteLength,!0),ne.setUint32(4,5130562,!0);const se=bL(function G_e(n){return(new TextEncoder).encode(n).buffer}(JSON.stringify(l)),32),le=new DataView(new ArrayBuffer(8));le.setUint32(0,se.byteLength,!0),le.setUint32(4,1313821514,!0);const Ee=new ArrayBuffer(12),Pe=new DataView(Ee);Pe.setUint32(0,1179937895,!0),Pe.setUint32(4,2,!0),Pe.setUint32(8,12+le.byteLength+se.byteLength+ne.byteLength+j.byteLength,!0);const Ft=new Blob([Ee,le,se,ne,j],{type:"application/octet-stream"}),Ct=new FileReader;Ct.readAsArrayBuffer(Ft),Ct.onloadend=function(){t(Ct.result)}}}else if(l.buffers&&l.buffers.length>0){const B=new FileReader;B.readAsDataURL(f),B.onloadend=function(){l.buffers[0].uri=B.result,t(l)}}else t(l)})()}serializeUserData(e,t){if(0===Object.keys(e.userData).length)return;const i=this.options,r=this.extensionsUsed;try{const s=JSON.parse(JSON.stringify(e.userData));if(i.includeCustomExtensions&&s.gltfExtensions){void 0===t.extensions&&(t.extensions={});for(const o in s.gltfExtensions)t.extensions[o]=s.gltfExtensions[o],r[o]=!0;delete s.gltfExtensions}Object.keys(s).length>0&&(t.extras=s)}catch(s){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+s.message)}}getUID(e,t=!1){if(!1===this.uids.has(e)){const r=new Map;r.set(!0,this.uid++),r.set(!1,this.uid++),this.uids.set(e,r)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const i=new Dt;for(let r=0,s=e.count;r<s;r++)if(Math.abs(i.fromBufferAttribute(e,r).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const i=e.clone(),r=new Dt;for(let s=0,o=i.count;s<o;s++)r.fromBufferAttribute(i,s),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),i.setXYZ(s,r.x,r.y,r.z);return t.attributesNormalized.set(e,i),i}applyTextureTransform(e,t){let i=!1;const r={};(0!==t.offset.x||0!==t.offset.y)&&(r.offset=t.offset.toArray(),i=!0),0!==t.rotation&&(r.rotation=t.rotation,i=!0),(1!==t.repeat.x||1!==t.repeat.y)&&(r.scale=t.repeat.toArray(),i=!0),i&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=r,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,t){if(e===t)return e;function i(B){return B.colorSpace===hu?function(ne){return ne<.04045?.0773993808*ne:Math.pow(.9478672986*ne+.0521327014,2.4)}:function(ne){return ne}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof FC&&(e=_L(e)),t instanceof FC&&(t=_L(t));const r=e?e.image:null,s=t?t.image:null,o=Math.max(r?r.width:0,s?s.width:0),l=Math.max(r?r.height:0,s?s.height:0),h=Jj();h.width=o,h.height=l;const u=h.getContext("2d",{willReadFrequently:!0});u.fillStyle="#00ffff",u.fillRect(0,0,o,l);const f=u.getImageData(0,0,o,l);if(r){u.drawImage(r,0,0,o,l);const B=i(e),j=u.getImageData(0,0,o,l).data;for(let ne=2;ne<j.length;ne+=4)f.data[ne]=256*B(j[ne]/256)}if(s){u.drawImage(s,0,0,o,l);const B=i(t),j=u.getImageData(0,0,o,l).data;for(let ne=1;ne<j.length;ne+=4)f.data[ne]=256*B(j[ne]/256)}u.putImageData(f,0,0);const T=(e||t).clone();return T.source=new Wb(h),T.colorSpace="",T.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),T}processBuffer(e){const t=this.json,i=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),i.push(e),0}processBufferView(e,t,i,r,s){const o=this.json;let l;switch(o.bufferViews||(o.bufferViews=[]),t){case 5120:case 5121:l=1;break;case 5122:case 5123:l=2;break;default:l=4}let h=e.itemSize*l;34962===s&&(h=4*Math.ceil(h/4));const u=Zj(r*h),f=new DataView(new ArrayBuffer(u));let y=0;for(let j=i;j<i+r;j++){for(let ne=0;ne<e.itemSize;ne++){let se;e.itemSize>4?se=e.array[j*e.itemSize+ne]:(0===ne?se=e.getX(j):1===ne?se=e.getY(j):2===ne?se=e.getZ(j):3===ne&&(se=e.getW(j)),!0===e.normalized&&(se=IS.normalize(se,e.array))),5126===t?f.setFloat32(y,se,!0):5124===t?f.setInt32(y,se,!0):5125===t?f.setUint32(y,se,!0):5122===t?f.setInt16(y,se,!0):5123===t?f.setUint16(y,se,!0):5120===t?f.setInt8(y,se):5121===t&&f.setUint8(y,se),y+=l}y%h!=0&&(y+=h-y%h)}const T={buffer:this.processBuffer(f.buffer),byteOffset:this.byteOffset,byteLength:u};return void 0!==s&&(T.target=s),34962===s&&(T.byteStride=h),this.byteOffset+=u,o.bufferViews.push(T),{id:o.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,i=t.json;return i.bufferViews||(i.bufferViews=[]),new Promise(function(r){const s=new FileReader;s.readAsArrayBuffer(e),s.onloadend=function(){const o=bL(s.result),l={buffer:t.processBuffer(o),byteOffset:t.byteOffset,byteLength:o.byteLength};t.byteOffset+=o.byteLength,r(i.bufferViews.push(l)-1)}})}processAccessor(e,t,i,r){const s=this.json;let l;if(e.array.constructor===Float32Array)l=5126;else if(e.array.constructor===Int32Array)l=5124;else if(e.array.constructor===Uint32Array)l=5125;else if(e.array.constructor===Int16Array)l=5122;else if(e.array.constructor===Uint16Array)l=5123;else if(e.array.constructor===Int8Array)l=5120;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);l=5121}if(void 0===i&&(i=0),(void 0===r||r===1/0)&&(r=e.count),0===r)return null;const h=function Q_e(n,e,t){const i={min:new Array(n.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(n.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let r=e;r<e+t;r++)for(let s=0;s<n.itemSize;s++){let o;n.itemSize>4?o=n.array[r*n.itemSize+s]:(0===s?o=n.getX(r):1===s?o=n.getY(r):2===s?o=n.getZ(r):3===s&&(o=n.getW(r)),!0===n.normalized&&(o=IS.normalize(o,n.array))),i.min[s]=Math.min(i.min[s],o),i.max[s]=Math.max(i.max[s],o)}return i}(e,i,r);let u;void 0!==t&&(u=e===t.index?34963:34962);const f=this.processBufferView(e,l,i,r,u),y={bufferView:f.id,byteOffset:f.byteOffset,componentType:l,count:r,max:h.max,min:h.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(y.normalized=!0),s.accessors||(s.accessors=[]),s.accessors.push(y)-1}processImage(e,t,i,r="image/png"){if(null!==e){const s=this,o=s.cache,l=s.json,h=s.options,u=s.pending;o.images.has(e)||o.images.set(e,{});const f=o.images.get(e),y=r+":flipY/"+i.toString();if(void 0!==f[y])return f[y];l.images||(l.images=[]);const T={mimeType:r},B=Jj();B.width=Math.min(e.width,h.maxTextureSize),B.height=Math.min(e.height,h.maxTextureSize);const j=B.getContext("2d",{willReadFrequently:!0});if(!0===i&&(j.translate(0,B.height),j.scale(1,-1)),void 0!==e.data){t!==Hf&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>h.maxTextureSize||e.height>h.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const se=new Uint8ClampedArray(e.height*e.width*4);for(let le=0;le<se.length;le+=4)se[le+0]=e.data[le+0],se[le+1]=e.data[le+1],se[le+2]=e.data[le+2],se[le+3]=e.data[le+3];j.putImageData(new ImageData(se,e.width,e.height),0,0)}else{if(!(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas))throw new Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement, ImageBitmap or OffscreenCanvas.");j.drawImage(e,0,0,B.width,B.height)}!0===h.binary?u.push(eW(B,r).then(se=>s.processBufferViewImage(se)).then(se=>{T.bufferView=se})):void 0!==B.toDataURL?T.uri=B.toDataURL(r):u.push(eW(B,r).then(se=>(new FileReader).readAsDataURL(se)).then(se=>{T.uri=se}));const ne=l.images.push(T)-1;return f[y]=ne,ne}throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;return t.samplers||(t.samplers=[]),t.samplers.push({magFilter:Cm[e.magFilter],minFilter:Cm[e.minFilter],wrapS:Cm[e.wrapS],wrapT:Cm[e.wrapT]})-1}processTexture(e){const i=this.options,r=this.cache,s=this.json;if(r.textures.has(e))return r.textures.get(e);s.textures||(s.textures=[]),e instanceof FC&&(e=_L(e,i.maxTextureSize));let o=e.userData.mimeType;"image/webp"===o&&(o="image/png");const l={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,o)};e.name&&(l.name=e.name),this._invokeAll(function(u){u.writeTexture&&u.writeTexture(e,l)});const h=s.textures.push(l)-1;return r.textures.set(e,h),h}processMaterial(e){const t=this.cache,i=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;i.materials||(i.materials=[]);const r={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const s=e.color.toArray().concat([e.opacity]);if(nT(s,[1,1,1,1])||(r.pbrMetallicRoughness.baseColorFactor=s),e.isMeshStandardMaterial?(r.pbrMetallicRoughness.metallicFactor=e.metalness,r.pbrMetallicRoughness.roughnessFactor=e.roughness):(r.pbrMetallicRoughness.metallicFactor=.5,r.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const l=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),h={index:this.processTexture(l),channel:l.channel};this.applyTextureTransform(h,l),r.pbrMetallicRoughness.metallicRoughnessTexture=h}if(e.map){const l={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(l,e.map),r.pbrMetallicRoughness.baseColorTexture=l}if(e.emissive){const l=e.emissive;if(Math.max(l.r,l.g,l.b)>0&&(r.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const u={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(u,e.emissiveMap),r.emissiveTexture=u}}if(e.normalMap){const l={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&1!==e.normalScale.x&&(l.scale=e.normalScale.x),this.applyTextureTransform(l,e.normalMap),r.normalTexture=l}if(e.aoMap){const l={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};1!==e.aoMapIntensity&&(l.strength=e.aoMapIntensity),this.applyTextureTransform(l,e.aoMap),r.occlusionTexture=l}e.transparent?r.alphaMode="BLEND":e.alphaTest>0&&(r.alphaMode="MASK",r.alphaCutoff=e.alphaTest),2===e.side&&(r.doubleSided=!0),""!==e.name&&(r.name=e.name),this.serializeUserData(e,r),this._invokeAll(function(l){l.writeMaterial&&l.writeMaterial(e,r)});const o=i.materials.push(r)-1;return t.materials.set(e,o),o}processMesh(e){const t=this.cache,i=this.json,r=[e.geometry.uuid];if(Array.isArray(e.material))for(let Ve=0,Ft=e.material.length;Ve<Ft;Ve++)r.push(e.material[Ve].uuid);else r.push(e.material.uuid);const s=r.join(":");if(t.meshes.has(s))return t.meshes.get(s);const o=e.geometry;let l;l=e.isLineSegments?1:e.isLineLoop?2:e.isLine?3:e.isPoints?0:e.material.wireframe?1:4;const h={},u={},f=[],y=[],T={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},B=o.getAttribute("normal");void 0!==B&&!this.isNormalizedNormalAttribute(B)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),o.setAttribute("normal",this.createNormalizedNormalAttribute(B)));let j=null;for(let Ve in o.attributes){if("morph"===Ve.slice(0,5))continue;const Ft=o.attributes[Ve];if(Ve=T[Ve]||Ve.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(Ve)||(Ve="_"+Ve),t.attributes.has(this.getUID(Ft))){u[Ve]=t.attributes.get(this.getUID(Ft));continue}j=null;const Lt=Ft.array;"JOINTS_0"===Ve&&!(Lt instanceof Uint16Array)&&!(Lt instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),j=new To(new Uint16Array(Lt),Ft.itemSize,Ft.normalized));const Kt=this.processAccessor(j||Ft,o);null!==Kt&&(Ve.startsWith("_")||this.detectMeshQuantization(Ve,Ft),u[Ve]=Kt,t.attributes.set(this.getUID(Ft),Kt))}if(void 0!==B&&o.setAttribute("normal",B),0===Object.keys(u).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){const Ve=[],Ft=[],Ct={};if(void 0!==e.morphTargetDictionary)for(const Lt in e.morphTargetDictionary)Ct[e.morphTargetDictionary[Lt]]=Lt;for(let Lt=0;Lt<e.morphTargetInfluences.length;++Lt){const Kt={};let Bt=!1;for(const St in o.morphAttributes){if("position"!==St&&"normal"!==St){Bt||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),Bt=!0);continue}const Dn=o.morphAttributes[St][Lt],ti=St.toUpperCase(),ci=o.attributes[St];if(t.attributes.has(this.getUID(Dn,!0))){Kt[ti]=t.attributes.get(this.getUID(Dn,!0));continue}const vi=Dn.clone();if(!o.morphTargetsRelative)for(let bi=0,Un=Dn.count;bi<Un;bi++)for(let _i=0;_i<Dn.itemSize;_i++)0===_i&&vi.setX(bi,Dn.getX(bi)-ci.getX(bi)),1===_i&&vi.setY(bi,Dn.getY(bi)-ci.getY(bi)),2===_i&&vi.setZ(bi,Dn.getZ(bi)-ci.getZ(bi)),3===_i&&vi.setW(bi,Dn.getW(bi)-ci.getW(bi));Kt[ti]=this.processAccessor(vi,o),t.attributes.set(this.getUID(ci,!0),Kt[ti])}y.push(Kt),Ve.push(e.morphTargetInfluences[Lt]),void 0!==e.morphTargetDictionary&&Ft.push(Ct[Lt])}h.weights=Ve,Ft.length>0&&(h.extras={},h.extras.targetNames=Ft)}const ne=Array.isArray(e.material);if(ne&&0===o.groups.length)return null;let se=!1;if(ne&&null===o.index){const Ve=[];for(let Ft=0,Ct=o.attributes.position.count;Ft<Ct;Ft++)Ve[Ft]=Ft;o.setIndex(Ve),se=!0}const le=ne?e.material:[e.material],Ee=ne?o.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let Ve=0,Ft=Ee.length;Ve<Ft;Ve++){const Ct={mode:l,attributes:u};if(this.serializeUserData(o,Ct),y.length>0&&(Ct.targets=y),null!==o.index){let Kt=this.getUID(o.index);(void 0!==Ee[Ve].start||void 0!==Ee[Ve].count)&&(Kt+=":"+Ee[Ve].start+":"+Ee[Ve].count),t.attributes.has(Kt)?Ct.indices=t.attributes.get(Kt):(Ct.indices=this.processAccessor(o.index,o,Ee[Ve].start,Ee[Ve].count),t.attributes.set(Kt,Ct.indices)),null===Ct.indices&&delete Ct.indices}const Lt=this.processMaterial(le[Ee[Ve].materialIndex]);null!==Lt&&(Ct.material=Lt),f.push(Ct)}!0===se&&o.setIndex(null),h.primitives=f,i.meshes||(i.meshes=[]),this._invokeAll(function(Ve){Ve.writeMesh&&Ve.writeMesh(e,h)});const Pe=i.meshes.push(h)-1;return t.meshes.set(s,Pe),Pe}detectMeshQuantization(e,t){if(this.extensionsUsed[vL])return;let i;switch(t.array.constructor){case Int8Array:i="byte";break;case Uint8Array:i="unsigned byte";break;case Int16Array:i="short";break;case Uint16Array:i="unsigned short";break;default:return}t.normalized&&(i+=" normalized");const r=e.split("_",1)[0];$j[r]&&$j[r].includes(i)&&(this.extensionsUsed[vL]=!0,this.extensionsRequired[vL]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const i=e.isOrthographicCamera,r={type:i?"orthographic":"perspective"};return i?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:IS.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),t.cameras.push(r)-1}processAnimation(e,t){const i=this.json,r=this.nodeMap;i.animations||(i.animations=[]);const s=(e=yL.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,o=[],l=[];for(let h=0;h<s.length;++h){const u=s[h],f=Fl.parseTrackName(u.name);let y=Fl.findNode(t,f.nodeName);const T=Xj[f.propertyName];if("bones"===f.objectName&&(y=!0===y.isSkinnedMesh?y.skeleton.getBoneByName(f.objectIndex):void 0),!y||!T){console.warn('THREE.GLTFExporter: Could not export animation track "%s".',u.name);continue}const B=1;let ne,j=u.values.length/u.times.length;T===Xj.morphTargetInfluences&&(j/=y.morphTargetInfluences.length),!0===u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(ne="CUBICSPLINE",j/=3):ne=u.getInterpolation()===J2?"STEP":"LINEAR",l.push({input:this.processAccessor(new To(u.times,B)),output:this.processAccessor(new To(u.values,j)),interpolation:ne}),o.push({sampler:l.length-1,target:{node:r.get(y),path:T}})}return i.animations.push({name:e.name||"clip_"+i.animations.length,samplers:l,channels:o}),i.animations.length-1}processSkin(e){const t=this.json,i=this.nodeMap,r=t.nodes[i.get(e)],s=e.skeleton;if(void 0===s)return null;const o=e.skeleton.bones[0];if(void 0===o)return null;const l=[],h=new Float32Array(16*s.bones.length),u=new go;for(let y=0;y<s.bones.length;++y)l.push(i.get(s.bones[y])),u.copy(s.boneInverses[y]),u.multiply(e.bindMatrix).toArray(h,16*y);return void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new To(h,16)),joints:l,skeleton:i.get(o)}),r.skin=t.skins.length-1}processNode(e){const t=this.json,i=this.options,r=this.nodeMap;t.nodes||(t.nodes=[]);const s={};if(i.trs){const l=e.quaternion.toArray(),h=e.position.toArray(),u=e.scale.toArray();nT(l,[0,0,0,1])||(s.rotation=l),nT(h,[0,0,0])||(s.translation=h),nT(u,[1,1,1])||(s.scale=u)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===function q_e(n){return nT(n.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}(e.matrix)&&(s.matrix=e.matrix.elements);if(""!==e.name&&(s.name=String(e.name)),this.serializeUserData(e,s),e.isMesh||e.isLine||e.isPoints){const l=this.processMesh(e);null!==l&&(s.mesh=l)}else e.isCamera&&(s.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const l=[];for(let h=0,u=e.children.length;h<u;h++){const f=e.children[h];if(f.visible||!1===i.onlyVisible){const y=this.processNode(f);null!==y&&l.push(y)}}l.length>0&&(s.children=l)}this._invokeAll(function(l){l.writeNode&&l.writeNode(e,s)});const o=t.nodes.push(s)-1;return r.set(e,o),o}processScene(e){const t=this.json,i=this.options;t.scenes||(t.scenes=[],t.scene=0);const r={};""!==e.name&&(r.name=e.name),t.scenes.push(r);const s=[];for(let o=0,l=e.children.length;o<l;o++){const h=e.children[o];if(h.visible||!1===i.onlyVisible){const u=this.processNode(h);null!==u&&s.push(u)}}s.length>0&&(r.nodes=s),this.serializeUserData(e,r)}processObjects(e){const t=new US;t.name="AuxScene";for(let i=0;i<e.length;i++)t.children.push(e[i]);this.processScene(t)}processInput(e){const t=this.options;e=e instanceof Array?e:[e],this._invokeAll(function(r){r.beforeParse&&r.beforeParse(e)});const i=[];for(let r=0;r<e.length;r++)e[r]instanceof US?this.processScene(e[r]):i.push(e[r]);i.length>0&&this.processObjects(i);for(let r=0;r<this.skins.length;++r)this.processSkin(this.skins[r]);for(let r=0;r<t.animations.length;++r)this.processAnimation(t.animations[r],e[0]);this._invokeAll(function(r){r.afterParse&&r.afterParse(e)})}_invokeAll(e){for(let t=0,i=this.plugins.length;t<i;t++)e(this.plugins[t])}}class W_e{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight)return void console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);const i=this.writer,r=i.json,s=i.extensionsUsed,o={};e.name&&(o.name=e.name),o.color=e.color.toArray(),o.intensity=e.intensity,e.isDirectionalLight?o.type="directional":e.isPointLight?(o.type="point",e.distance>0&&(o.range=e.distance)):e.isSpotLight&&(o.type="spot",e.distance>0&&(o.range=e.distance),o.spot={},o.spot.innerConeAngle=(1-e.penumbra)*e.angle,o.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||0!==e.target.position.x||0!==e.target.position.y||-1!==e.target.position.z)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),s[this.name]||(r.extensions=r.extensions||{},r.extensions[this.name]={lights:[]},s[this.name]=!0);const l=r.extensions[this.name].lights;l.push(o),t.extensions=t.extensions||{},t.extensions[this.name]={light:l.length-1}}}class $_e{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}writeMaterial(e,t){if(!e.isMeshBasicMaterial)return;const r=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},r[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}class X_e{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.clearcoat)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.clearcoatFactor=e.clearcoat,e.clearcoatMap){const o={index:i.processTexture(e.clearcoatMap),texCoord:e.clearcoatMap.channel};i.applyTextureTransform(o,e.clearcoatMap),s.clearcoatTexture=o}if(s.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const o={index:i.processTexture(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};i.applyTextureTransform(o,e.clearcoatRoughnessMap),s.clearcoatRoughnessTexture=o}if(e.clearcoatNormalMap){const o={index:i.processTexture(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};1!==e.clearcoatNormalScale.x&&(o.scale=e.clearcoatNormalScale.x),i.applyTextureTransform(o,e.clearcoatNormalMap),s.clearcoatNormalTexture=o}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Y_e{constructor(e){this.writer=e,this.name="KHR_materials_dispersion"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.dispersion)return;const r=this.writer.extensionsUsed,s={};s.dispersion=e.dispersion,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class K_e{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.iridescence)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.iridescenceFactor=e.iridescence,e.iridescenceMap){const o={index:i.processTexture(e.iridescenceMap),texCoord:e.iridescenceMap.channel};i.applyTextureTransform(o,e.iridescenceMap),s.iridescenceTexture=o}if(s.iridescenceIor=e.iridescenceIOR,s.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],s.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const o={index:i.processTexture(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};i.applyTextureTransform(o,e.iridescenceThicknessMap),s.iridescenceThicknessTexture=o}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Z_e{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.transmissionFactor=e.transmission,e.transmissionMap){const o={index:i.processTexture(e.transmissionMap),texCoord:e.transmissionMap.channel};i.applyTextureTransform(o,e.transmissionMap),s.transmissionTexture=o}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class J_e{constructor(e){this.writer=e,this.name="KHR_materials_volume"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.thicknessFactor=e.thickness,e.thicknessMap){const o={index:i.processTexture(e.thicknessMap),texCoord:e.thicknessMap.channel};i.applyTextureTransform(o,e.thicknessMap),s.thicknessTexture=o}e.attenuationDistance!==1/0&&(s.attenuationDistance=e.attenuationDistance),s.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class eye{constructor(e){this.writer=e,this.name="KHR_materials_ior"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1.5===e.ior)return;const r=this.writer.extensionsUsed,s={};s.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class tye{constructor(e){this.writer=e,this.name="KHR_materials_specular"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1===e.specularIntensity&&e.specularColor.equals(N_e)&&!e.specularIntensityMap&&!e.specularColorMap)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.specularIntensityMap){const o={index:i.processTexture(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};i.applyTextureTransform(o,e.specularIntensityMap),s.specularTexture=o}if(e.specularColorMap){const o={index:i.processTexture(e.specularColorMap),texCoord:e.specularColorMap.channel};i.applyTextureTransform(o,e.specularColorMap),s.specularColorTexture=o}s.specularFactor=e.specularIntensity,s.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class nye{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.sheen)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.sheenRoughnessMap){const o={index:i.processTexture(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};i.applyTextureTransform(o,e.sheenRoughnessMap),s.sheenRoughnessTexture=o}if(e.sheenColorMap){const o={index:i.processTexture(e.sheenColorMap),texCoord:e.sheenColorMap.channel};i.applyTextureTransform(o,e.sheenColorMap),s.sheenColorTexture=o}s.sheenRoughnessFactor=e.sheenRoughness,s.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class iye{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.anisotropy)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.anisotropyMap){const o={index:i.processTexture(e.anisotropyMap)};i.applyTextureTransform(o,e.anisotropyMap),s.anisotropyTexture=o}s.anisotropyStrength=e.anisotropy,s.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class rye{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.emissiveIntensity)return;const r=this.writer.extensionsUsed,s={};s.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class sye{constructor(e){this.writer=e,this.name="EXT_materials_bump"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.bumpScale&&!e.bumpMap)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.bumpMap){const o={index:i.processTexture(e.bumpMap),texCoord:e.bumpMap.channel};i.applyTextureTransform(o,e.bumpMap),s.bumpTexture=o}s.bumpFactor=e.bumpScale,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class oye{constructor(e){this.writer=e,this.name="EXT_mesh_gpu_instancing"}writeNode(e,t){if(!e.isInstancedMesh)return;const i=this.writer,r=e,s=new Float32Array(3*r.count),o=new Float32Array(4*r.count),l=new Float32Array(3*r.count),h=new go,u=new Dt,f=new zc,y=new Dt;for(let B=0;B<r.count;B++)r.getMatrixAt(B,h),h.decompose(u,f,y),u.toArray(s,3*B),f.toArray(o,4*B),y.toArray(l,3*B);const T={TRANSLATION:i.processAccessor(new To(s,3)),ROTATION:i.processAccessor(new To(o,4)),SCALE:i.processAccessor(new To(l,3))};r.instanceColor&&(T._COLOR_0=i.processAccessor(r.instanceColor)),t.extensions=t.extensions||{},t.extensions[this.name]={attributes:T},i.extensionsUsed[this.name]=!0,i.extensionsRequired[this.name]=!0}}yL.Utils={insertKeyframe:function(n,e){const i=n.getValueSize(),r=new n.TimeBufferType(n.times.length+1),s=new n.ValueBufferType(n.values.length+i),o=n.createInterpolant(new n.ValueBufferType(i));let l;if(0===n.times.length){r[0]=e;for(let h=0;h<i;h++)s[h]=0;l=0}else if(e<n.times[0]){if(Math.abs(n.times[0]-e)<.001)return 0;r[0]=e,r.set(n.times,1),s.set(o.evaluate(e),0),s.set(n.values,i),l=0}else if(e>n.times[n.times.length-1]){if(Math.abs(n.times[n.times.length-1]-e)<.001)return n.times.length-1;r[r.length-1]=e,r.set(n.times,0),s.set(n.values,0),s.set(o.evaluate(e),n.values.length),l=r.length-1}else for(let h=0;h<n.times.length;h++){if(Math.abs(n.times[h]-e)<.001)return h;if(n.times[h]<e&&n.times[h+1]>e){r.set(n.times.slice(0,h+1),0),r[h+1]=e,r.set(n.times.slice(h+1),h+2),s.set(n.values.slice(0,(h+1)*i),0),s.set(o.evaluate(e),(h+1)*i),s.set(n.values.slice((h+1)*i),(h+2)*i),l=h+1;break}}return n.times=r,n.values=s,l},mergeMorphTargetTracks:function(n,e){const t=[],i={},r=n.tracks;for(let s=0;s<r.length;++s){let o=r[s];const l=Fl.parseTrackName(o.name),h=Fl.findNode(e,l.nodeName);if("morphTargetInfluences"!==l.propertyName||void 0===l.propertyIndex){t.push(o);continue}if(o.createInterpolant!==o.InterpolantFactoryMethodDiscrete&&o.createInterpolant!==o.InterpolantFactoryMethodLinear){if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),o=o.clone(),o.setInterpolation(eC)}const u=h.morphTargetInfluences.length,f=h.morphTargetDictionary[l.propertyIndex];if(void 0===f)throw new Error("THREE.GLTFExporter: Morph target name not found: "+l.propertyIndex);let y;if(void 0===i[h.uuid]){y=o.clone();const B=new y.ValueBufferType(u*y.times.length);for(let j=0;j<y.times.length;j++)B[j*u+f]=y.values[j];y.name=(l.nodeName||"")+".morphTargetInfluences",y.values=B,i[h.uuid]=y,t.push(y);continue}const T=o.createInterpolant(new o.ValueBufferType(1));y=i[h.uuid];for(let B=0;B<y.times.length;B++)y.values[B*u+f]=T.evaluate(y.times[B]);for(let B=0;B<o.times.length;B++){const j=this.insertKeyframe(y,o.times[B]);y.values[j*u+f]=o.values[B]}}return n.tracks=t,n}};const _B=(n,e,t="application/json")=>{const i=new Blob([n],{type:t}),r=document.createElement("a");r.style.display="none",r.href=URL.createObjectURL(i),r.download=e,r.click(),r.remove()},tW=(n,e="application/json")=>{const t=document.createElement("input");document.body.appendChild(t),t.type="file",t.accept=e,t.onclick=r=>{r.target.value=""},t.addEventListener("invalid",r=>{console.log(JSON.stringify(r))}),t.oninput=r=>{const s=r.target?.files[0],o=new FileReader;o.onload=l=>{l.target&&l.target.result&&n?.(l.target.result.toString()),t.remove()},o.readAsText(s)},t.click()};class aye{exportSceneToOBJ(e){const i=(new L_e).parse(e);_B(i,"phoenix-obj.obj","text/plain")}exportPhoenixScene(e,t,i){const r=new yL,s=this.saveSceneConfig(t,i);r.parse(e,o=>{const h=JSON.stringify({sceneConfiguration:s,scene:o},null,2);_B(h,"phoenix-scene.phnx","text/plain")},o=>{console.error("Error exporting scene:",o)})}saveSceneConfig(e,t){return{eventData:this.saveEventDataConfiguration(e),geometries:this.saveGeometriesConfiguration(t)}}saveEventDataConfiguration(e){const t={};for(const i of e.children)if(i.name){t[i.name]=[];for(const r of i.children)r.name&&t[i.name].push(r.name)}return t}saveGeometriesConfiguration(e){const t=[];return e.children.forEach(i=>{"EventData"!==i.name&&t.push(i.name)}),t}}const lye=/^[og]\s*(.+)?/,cye=/^mtllib /,hye=/^usemtl /,uye=/^usemap /,nW=/\s+/,iW=new Dt,xL=new Dt,rW=new Dt,sW=new Dt,EA=new Dt,yB=new nr;function dye(){const n={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,s){const o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);const l={index:this.materials.length,name:r||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:void 0!==o?o.smooth:this.smooth,groupStart:void 0!==o?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(h){const u={index:"number"==typeof h?h:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return u.clone=this.clone.bind(u),u}};return this.materials.push(l),l},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){const s=this.currentMaterial();if(s&&-1===s.groupEnd&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),r&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return r&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),s}},i&&i.name&&"function"==typeof i.clone){const r=i.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseNormalIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseUVIndex:function(e,t){const i=parseInt(e,10);return 2*(i>=0?i-1:i+t/2)},addVertex:function(e,t,i){const r=this.vertices,s=this.object.geometry.vertices;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[i+0],r[i+1],r[i+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,i){const r=this.normals,s=this.object.geometry.normals;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[i+0],r[i+1],r[i+2])},addFaceNormal:function(e,t,i){const r=this.vertices,s=this.object.geometry.normals;iW.fromArray(r,e),xL.fromArray(r,t),rW.fromArray(r,i),EA.subVectors(rW,xL),sW.subVectors(iW,xL),EA.cross(sW),EA.normalize(),s.push(EA.x,EA.y,EA.z),s.push(EA.x,EA.y,EA.z),s.push(EA.x,EA.y,EA.z)},addColor:function(e,t,i){const r=this.colors,s=this.object.geometry.colors;void 0!==r[e]&&s.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&s.push(r[t+0],r[t+1],r[t+2]),void 0!==r[i]&&s.push(r[i+0],r[i+1],r[i+2])},addUV:function(e,t,i){const r=this.uvs,s=this.object.geometry.uvs;s.push(r[e+0],r[e+1]),s.push(r[t+0],r[t+1]),s.push(r[i+0],r[i+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,i,r,s,o,l,h,u){const f=this.vertices.length;let y=this.parseVertexIndex(e,f),T=this.parseVertexIndex(t,f),B=this.parseVertexIndex(i,f);if(this.addVertex(y,T,B),this.addColor(y,T,B),void 0!==l&&""!==l){const j=this.normals.length;y=this.parseNormalIndex(l,j),T=this.parseNormalIndex(h,j),B=this.parseNormalIndex(u,j),this.addNormal(y,T,B)}else this.addFaceNormal(y,T,B);if(void 0!==r&&""!==r){const j=this.uvs.length;y=this.parseUVIndex(r,j),T=this.parseUVIndex(s,j),B=this.parseUVIndex(o,j),this.addUV(y,T,B),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let i=0,r=e.length;i<r;i++){const s=this.parseVertexIndex(e[i],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const i=this.vertices.length,r=this.uvs.length;for(let s=0,o=e.length;s<o;s++)this.addVertexLine(this.parseVertexIndex(e[s],i));for(let s=0,o=t.length;s<o;s++)this.addUVLine(this.parseUVIndex(t[s],r))}};return n.startObject("",!1),n}class oW extends Jd{constructor(e){super(e),this.materials=null}load(e,t,i,r){const s=this,o=new Dp(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{t(s.parse(l))}catch(h){r?r(h):console.error(h),s.manager.itemError(e)}},i,r)}setMaterials(e){return this.materials=e,this}parse(e){const t=new dye;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const i=e.split("\n");let r=[];for(let l=0,h=i.length;l<h;l++){const u=i[l].trimStart();if(0===u.length)continue;const f=u.charAt(0);if("#"!==f)if("v"===f){const y=u.split(nW);switch(y[0]){case"v":t.vertices.push(parseFloat(y[1]),parseFloat(y[2]),parseFloat(y[3])),y.length>=7?(yB.setRGB(parseFloat(y[4]),parseFloat(y[5]),parseFloat(y[6])).convertSRGBToLinear(),t.colors.push(yB.r,yB.g,yB.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(y[1]),parseFloat(y[2]),parseFloat(y[3]));break;case"vt":t.uvs.push(parseFloat(y[1]),parseFloat(y[2]))}}else if("f"===f){const T=u.slice(1).trim().split(nW),B=[];for(let ne=0,se=T.length;ne<se;ne++){const le=T[ne];if(le.length>0){const Ee=le.split("/");B.push(Ee)}}const j=B[0];for(let ne=1,se=B.length-1;ne<se;ne++){const le=B[ne],Ee=B[ne+1];t.addFace(j[0],le[0],Ee[0],j[1],le[1],Ee[1],j[2],le[2],Ee[2])}}else if("l"===f){const y=u.substring(1).trim().split(" ");let T=[];const B=[];if(-1===u.indexOf("/"))T=y;else for(let j=0,ne=y.length;j<ne;j++){const se=y[j].split("/");""!==se[0]&&T.push(se[0]),""!==se[1]&&B.push(se[1])}t.addLineGeometry(T,B)}else if("p"===f){const T=u.slice(1).trim().split(" ");t.addPointGeometry(T)}else if(null!==(r=lye.exec(u))){const y=(" "+r[0].slice(1).trim()).slice(1);t.startObject(y)}else if(hye.test(u))t.object.startMaterial(u.substring(7).trim(),t.materialLibraries);else if(cye.test(u))t.materialLibraries.push(u.substring(7).trim());else if(uye.test(u))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===f){if(r=u.split(" "),r.length>1){const T=r[1].trim().toLowerCase();t.object.smooth="0"!==T&&"off"!==T}else t.object.smooth=!0;const y=t.object.currentMaterial();y&&(y.smooth=t.object.smooth)}else{if("\0"===u)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+u+'"')}}t.finalize();const s=new Xl;if(s.materialLibraries=[].concat(t.materialLibraries),1==!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let l=0,h=t.objects.length;l<h;l++){const u=t.objects[l],f=u.geometry,y=u.materials,T="Line"===f.type,B="Points"===f.type;let j=!1;if(0===f.vertices.length)continue;const ne=new Hs;ne.setAttribute("position",new Bs(f.vertices,3)),f.normals.length>0&&ne.setAttribute("normal",new Bs(f.normals,3)),f.colors.length>0&&(j=!0,ne.setAttribute("color",new Bs(f.colors,3))),!0===f.hasUVIndices&&ne.setAttribute("uv",new Bs(f.uvs,2));const se=[];for(let Ee=0,Pe=y.length;Ee<Pe;Ee++){const Ve=y[Ee],Ft=Ve.name+"_"+Ve.smooth+"_"+j;let Ct=t.materials[Ft];if(null!==this.materials)if(Ct=this.materials.create(Ve.name),!T||!Ct||Ct instanceof Bc){if(B&&Ct&&!(Ct instanceof sy)){const Lt=new sy({size:10,sizeAttenuation:!1});ch.prototype.copy.call(Lt,Ct),Lt.color.copy(Ct.color),Lt.map=Ct.map,Ct=Lt}}else{const Lt=new Bc;ch.prototype.copy.call(Lt,Ct),Lt.color.copy(Ct.color),Ct=Lt}void 0===Ct&&(Ct=T?new Bc:B?new sy({size:1,sizeAttenuation:!1}):new Og,Ct.name=Ve.name,Ct.flatShading=!Ve.smooth,Ct.vertexColors=j,t.materials[Ft]=Ct),se.push(Ct)}let le;if(se.length>1){for(let Ee=0,Pe=y.length;Ee<Pe;Ee++){const Ve=y[Ee];ne.addGroup(Ve.groupStart,Ve.groupCount,Ee)}le=T?new yc(ne,se):B?new sx(ne,se):new jo(ne,se)}else le=T?new yc(ne,se[0]):B?new sx(ne,se[0]):new jo(ne,se[0]);le.name=u.name,s.add(le)}else if(t.vertices.length>0){const l=new sy({size:1,sizeAttenuation:!1}),h=new Hs;h.setAttribute("position",new Bs(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(h.setAttribute("color",new Bs(t.colors,3)),l.vertexColors=!0);const u=new sx(h,l);s.add(u)}return s}}function wL(n,e=!1){const t=null!==n[0].index,i=new Set(Object.keys(n[0].attributes)),r=new Set(Object.keys(n[0].morphAttributes)),s={},o={},l=n[0].morphTargetsRelative,h=new Hs;let u=0;for(let f=0;f<n.length;++f){const y=n[f];let T=0;if(t!==(null!==y.index))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const B in y.attributes){if(!i.has(B))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+'. All geometries must have compatible attributes; make sure "'+B+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[B]&&(s[B]=[]),s[B].push(y.attributes[B]),T++}if(T!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". Make sure all geometries have the same number of attributes."),null;if(l!==y.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const B in y.morphAttributes){if(!r.has(B))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[B]&&(o[B]=[]),o[B].push(y.morphAttributes[B])}if(e){let B;if(t)B=y.index.count;else{if(void 0===y.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". The geometry must have either an index or a position attribute"),null;B=y.attributes.position.count}h.addGroup(u,B,f),u+=B}}if(t){let f=0;const y=[];for(let T=0;T<n.length;++T){const B=n[T].index;for(let j=0;j<B.count;++j)y.push(B.getX(j)+f);f+=n[T].attributes.position.count}h.setIndex(y)}for(const f in s){const y=aW(s[f]);if(!y)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+f+" attribute."),null;h.setAttribute(f,y)}for(const f in o){const y=o[f][0].length;if(0===y)break;h.morphAttributes=h.morphAttributes||{},h.morphAttributes[f]=[];for(let T=0;T<y;++T){const B=[];for(let ne=0;ne<o[f].length;++ne)B.push(o[f][ne][T]);const j=aW(B);if(!j)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+f+" morphAttribute."),null;h.morphAttributes[f].push(j)}}return h}function aW(n){let e,t,i,r=-1,s=0;for(let u=0;u<n.length;++u){const f=n[u];if(void 0===e&&(e=f.array.constructor),e!==f.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===t&&(t=f.itemSize),t!==f.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===i&&(i=f.normalized),i!==f.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(-1===r&&(r=f.gpuType),r!==f.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=f.count*t}const o=new e(s),l=new To(o,t,i);let h=0;for(let u=0;u<n.length;++u){const f=n[u];if(f.isInterleavedBufferAttribute){const y=h/t;for(let T=0,B=f.count;T<B;T++)for(let j=0;j<t;j++){const ne=f.getComponent(T,j);l.setComponent(T+y,j,ne)}}else o.set(f.array,h);h+=f.count*t}return void 0!==r&&(l.gpuType=r),l}function lW(n,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(2===e||1===e){let t=n.getIndex();if(null===t){const o=[],l=n.getAttribute("position");if(void 0===l)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let h=0;h<l.count;h++)o.push(h);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class vB extends Jd{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new gye(t)}),this.register(function(t){return new _ye(t)}),this.register(function(t){return new Sye(t)}),this.register(function(t){return new Tye(t)}),this.register(function(t){return new Dye(t)}),this.register(function(t){return new vye(t)}),this.register(function(t){return new bye(t)}),this.register(function(t){return new xye(t)}),this.register(function(t){return new wye(t)}),this.register(function(t){return new Aye(t)}),this.register(function(t){return new Cye(t)}),this.register(function(t){return new yye(t)}),this.register(function(t){return new Eye(t)}),this.register(function(t){return new Mye(t)}),this.register(function(t){return new pye(t)}),this.register(function(t){return new Iye(t)}),this.register(function(t){return new Bye(t)})}load(e,t,i,r){const s=this;let o;if(""!==this.resourcePath)o=this.resourcePath;else if(""!==this.path){const u=dx.extractUrlBase(e);o=dx.resolveURL(u,this.path)}else o=dx.extractUrlBase(e);this.manager.itemStart(e);const l=function(u){r?r(u):console.error(u),s.manager.itemError(e),s.manager.itemEnd(e)},h=new Dp(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(this.withCredentials),h.load(e,function(u){try{s.parse(u,o,function(f){t(f),s.manager.itemEnd(e)},l)}catch(f){l(f)}},i,l)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},l={},h=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(h.decode(new Uint8Array(e,0,4))===cW){try{o[Ja.KHR_BINARY_GLTF]=new Pye(e)}catch(y){return void(r&&r(y))}s=JSON.parse(o[Ja.KHR_BINARY_GLTF].content)}else s=JSON.parse(h.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const u=new Qye(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let f=0;f<this.pluginCallbacks.length;f++){const y=this.pluginCallbacks[f](u);y.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),l[y.name]=y,o[y.name]=!0}if(s.extensionsUsed)for(let f=0;f<s.extensionsUsed.length;++f){const y=s.extensionsUsed[f],T=s.extensionsRequired||[];switch(y){case Ja.KHR_MATERIALS_UNLIT:o[y]=new mye;break;case Ja.KHR_DRACO_MESH_COMPRESSION:o[y]=new Rye(s,this.dracoLoader);break;case Ja.KHR_TEXTURE_TRANSFORM:o[y]=new kye;break;case Ja.KHR_MESH_QUANTIZATION:o[y]=new Fye;break;default:T.indexOf(y)>=0&&void 0===l[y]&&console.warn('THREE.GLTFLoader: Unknown extension "'+y+'".')}}u.setExtensions(o),u.setPlugins(l),u.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function fye(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const Ja={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class pye{constructor(e){this.parser=e,this.name=Ja.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,h=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let u;const f=new nr(16777215);void 0!==h.color&&f.setRGB(h.color[0],h.color[1],h.color[2],id);const y=void 0!==h.range?h.range:0;switch(h.type){case"directional":u=new qC(f),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new vj(f),u.distance=y;break;case"spot":u=new _j(f),u.distance=y,h.spot=h.spot||{},h.spot.innerConeAngle=void 0!==h.spot.innerConeAngle?h.spot.innerConeAngle:0,h.spot.outerConeAngle=void 0!==h.spot.outerConeAngle?h.spot.outerConeAngle:Math.PI/4,u.angle=h.spot.outerConeAngle,u.penumbra=1-h.spot.innerConeAngle/h.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+h.type)}return u.position.set(0,0,0),u.decay=2,ly(u,h),void 0!==h.intensity&&(u.intensity=h.intensity),u.name=t.createUniqueName(h.name||"light_"+e),r=Promise.resolve(u),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],l=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===l?null:this._loadLight(l).then(function(h){return i._getNodeRef(t.cache,l,h)})}}class mye{constructor(){this.name=Ja.KHR_MATERIALS_UNLIT}getMaterialType(){return wh}extendParams(e,t,i){const r=[];e.color=new nr(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],id),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,hu))}return Promise.all(r)}}class Aye{constructor(e){this.parser=e,this.name=Ja.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class gye{constructor(e){this.parser=e,this.name=Ja.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Fg:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const l=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Fi(l,l)}return Promise.all(s)}}class _ye{constructor(e){this.parser=e,this.name=Ja.KHR_MATERIALS_DISPERSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Fg:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.dispersion=void 0!==s.dispersion?s.dispersion:0,Promise.resolve()}}class yye{constructor(e){this.parser=e,this.name=Ja.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Fg:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class vye{constructor(e){this.parser=e,this.name=Ja.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Fg:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new nr(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(void 0!==o.sheenColorFactor){const l=o.sheenColorFactor;t.sheenColor.setRGB(l[0],l[1],l[2],id)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,hu)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class bye{constructor(e){this.parser=e,this.name=Ja.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Fg:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class xye{constructor(e){this.parser=e,this.name=Ja.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Fg:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const l=o.attenuationColor||[1,1,1];return t.attenuationColor=(new nr).setRGB(l[0],l[1],l[2],id),Promise.all(s)}}class wye{constructor(e){this.parser=e,this.name=Ja.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Fg:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class Cye{constructor(e){this.parser=e,this.name=Ja.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Fg:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const l=o.specularColorFactor||[1,1,1];return t.specularColor=(new nr).setRGB(l[0],l[1],l[2],id),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,hu)),Promise.all(s)}}class Mye{constructor(e){this.parser=e,this.name=Ja.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Fg:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return t.bumpScale=void 0!==o.bumpFactor?o.bumpFactor:1,void 0!==o.bumpTexture&&s.push(i.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}}class Eye{constructor(e){this.parser=e,this.name=Ja.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Fg:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.anisotropyStrength&&(t.anisotropy=o.anisotropyStrength),void 0!==o.anisotropyRotation&&(t.anisotropyRotation=o.anisotropyRotation),void 0!==o.anisotropyTexture&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class Sye{constructor(e){this.parser=e,this.name=Ja.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class Tye{constructor(e){this.parser=e,this.name=Ja.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],l=r.images[o.source];let h=i.textureLoader;if(l.uri){const u=i.options.manager.getHandler(l.uri);null!==u&&(h=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,o.source,h);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class Dye{constructor(e){this.parser=e,this.name=Ja.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],l=r.images[o.source];let h=i.textureLoader;if(l.uri){const u=i.options.manager.getHandler(l.uri);null!==u&&(h=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,o.source,h);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class Iye{constructor(e){this.name=Ja.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(l){const f=r.count,y=r.byteStride,T=new Uint8Array(l,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(f,y,T,r.mode,r.filter).then(function(B){return B.buffer}):o.ready.then(function(){const B=new ArrayBuffer(f*y);return o.decodeGltfBuffer(new Uint8Array(B),f,y,T,r.mode,r.filter),B})})}return null}}class Bye{constructor(e){this.name=Ja.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const u of r.primitives)if(u.mode!==SA.TRIANGLES&&u.mode!==SA.TRIANGLE_STRIP&&u.mode!==SA.TRIANGLE_FAN&&void 0!==u.mode)return null;const o=i.extensions[this.name].attributes,l=[],h={};for(const u in o)l.push(this.parser.getDependency("accessor",o[u]).then(f=>(h[u]=f,h[u])));return l.length<1?null:(l.push(this.parser.createNodeMesh(e)),Promise.all(l).then(u=>{const f=u.pop(),y=f.isGroup?f.children:[f],T=u[0].count,B=[];for(const j of y){const ne=new go,se=new Dt,le=new zc,Ee=new Dt(1,1,1),Pe=new UQ(j.geometry,j.material,T);for(let Ve=0;Ve<T;Ve++)h.TRANSLATION&&se.fromBufferAttribute(h.TRANSLATION,Ve),h.ROTATION&&le.fromBufferAttribute(h.ROTATION,Ve),h.SCALE&&Ee.fromBufferAttribute(h.SCALE,Ve),Pe.setMatrixAt(Ve,ne.compose(se,le,Ee));for(const Ve in h)if("_COLOR_0"===Ve){const Ft=h[Ve];Pe.instanceColor=new RC(Ft.array,Ft.itemSize,Ft.normalized)}else"TRANSLATION"!==Ve&&"ROTATION"!==Ve&&"SCALE"!==Ve&&j.geometry.setAttribute(Ve,h[Ve]);Wa.prototype.copy.call(Pe,j),this.parser.assignFinalMaterial(Pe),B.push(Pe)}return f.isGroup?(f.clear(),f.add(...B),f):B[0]}))}}const cW="glTF";class Pye{constructor(e){this.name=Ja.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==cW)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const l=s.getUint32(o,!0);o+=4;const h=s.getUint32(o,!0);if(o+=4,1313821514===h){const u=new Uint8Array(e,12+o,l);this.content=i.decode(u)}else if(5130562===h){const u=12+o;this.body=e.slice(u,u+l)}o+=l}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Rye{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ja.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,l={},h={},u={};for(const f in o){const y=EL[f]||f.toLowerCase();l[y]=o[f]}for(const f in e.attributes){const y=EL[f]||f.toLowerCase();if(void 0!==o[f]){const T=i.accessors[e.attributes[f]];u[y]=jC[T.componentType].name,h[y]=!0===T.normalized}}return t.getDependency("bufferView",s).then(function(f){return new Promise(function(y,T){r.decodeDracoFile(f,function(B){for(const j in B.attributes){const se=h[j];void 0!==se&&(B.attributes[j].normalized=se)}y(B)},l,u,id,T)})})}}class kye{constructor(){this.name=Ja.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Fye{constructor(){this.name=Ja.KHR_MESH_QUANTIZATION}}class uW extends ZS{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,l=this.valueSize,h=2*l,u=3*l,f=r-t,y=(i-t)/f,T=y*y,B=T*y,j=e*u,ne=j-u,se=-2*B+3*T,le=B-T,Ee=1-se,Pe=le-T+y;for(let Ve=0;Ve!==l;Ve++)s[Ve]=Ee*o[ne+Ve+l]+Pe*(o[ne+Ve+h]*f)+se*o[j+Ve+l]+le*(o[j+Ve]*f);return s}}const Oye=new zc;class Lye extends uW{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return Oye.fromArray(s).normalize().toArray(s),s}}const SA={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},jC={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},dW={9728:Fu,9729:bh,9984:1004,9985:X2,9986:qb,9987:xA},fW={33071:_m,33648:$2,10497:Q1},ML={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},EL={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},iv={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Nye={CUBICSPLINE:void 0,LINEAR:eC,STEP:J2};function _x(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function ly(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Hye(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Vye(n){let e;const t=n.extensions&&n.extensions[Ja.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+TL(t.attributes):n.indices+":"+TL(n.attributes)+":"+n.mode,void 0!==n.targets)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+TL(n.targets[i]);return e}function TL(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function DL(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const qye=new go;class Qye{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new fye,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=-1,s=!1,o=-1;if(typeof navigator<"u"){const l=navigator.userAgent;i=!0===/^((?!chrome|android).)*safari/i.test(l);const h=l.match(/Version\/(\d+)/);r=i&&h?parseInt(h[1],10):-1,s=l.indexOf("Firefox")>-1,o=s?l.match(/Firefox\/([0-9]+)\./)[1]:-1}this.textureLoader=typeof createImageBitmap>"u"||i&&r<17||s&&o<98?new z0e(this.options.manager):new Z0e(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Dp(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const l={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};return _x(s,l,r),ly(l,r),Promise.all(i._invokeAll(function(h){return h.afterRoot&&h.afterRoot(l)})).then(function(){for(const h of l.scenes)h.updateMatrixWorld();e(l)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let l=0,h=o.length;l<h;l++)e[o[l]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,l)=>{const h=this.associations.get(o);null!=h&&this.associations.set(l,h);for(const[u,f]of o.children.entries())s(f,l.children[u])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Ja.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(dx.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=ML[r.type],h=!0===r.normalized,u=new(0,jC[r.componentType])(r.count*o);return Promise.resolve(new To(u,o,h))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const l=o[0],h=ML[r.type],u=jC[r.componentType],f=u.BYTES_PER_ELEMENT,T=r.byteOffset||0,B=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,j=!0===r.normalized;let ne,se;if(B&&B!==f*h){const le=Math.floor(T/B),Ee="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+le+":"+r.count;let Pe=t.cache.get(Ee);Pe||(ne=new u(l,le*B,r.count*B/f),Pe=new P4(ne,B/f),t.cache.add(Ee,Pe)),se=new ix(Pe,h,T%B/f,j)}else ne=null===l?new u(r.count*h):new u(l,T,r.count*h),se=new To(ne,h,j);if(void 0!==r.sparse){const Ve=r.sparse.values.byteOffset||0,Ft=new(0,jC[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*ML.SCALAR),Ct=new u(o[2],Ve,r.sparse.count*h);null!==l&&(se=new To(se.array.slice(),se.itemSize,se.normalized));for(let Lt=0,Kt=Ft.length;Lt<Kt;Lt++){const Bt=Ft[Lt];if(se.setX(Bt,Ct[Lt*h]),h>=2&&se.setY(Bt,Ct[Lt*h+1]),h>=3&&se.setZ(Bt,Ct[Lt*h+2]),h>=4&&se.setW(Bt,Ct[Lt*h+3]),h>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return se})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let l=this.textureLoader;if(o.uri){const h=this.options.manager.getHandler(o.uri);null!==h&&(l=h)}return this.loadTextureImage(e,s,l)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],l=s.images[t],h=(l.uri||l.bufferView)+":"+o.sampler;if(this.textureCache[h])return this.textureCache[h];const u=this.loadImageSource(t,i).then(function(f){f.flipY=!1,f.name=o.name||l.name||"",""===f.name&&"string"==typeof l.uri&&!1===l.uri.startsWith("data:image/")&&(f.name=l.uri);const T=(s.samplers||{})[o.sampler]||{};return f.magFilter=dW[T.magFilter]||bh,f.minFilter=dW[T.minFilter]||xA,f.wrapS=fW[T.wrapS]||Q1,f.wrapT=fW[T.wrapT]||Q1,r.associations.set(f,{textures:e}),f}).catch(function(){return null});return this.textureCache[h]=u,u}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(y=>y.clone());const o=r.images[e],l=self.URL||self.webkitURL;let h=o.uri||"",u=!1;if(void 0!==o.bufferView)h=this.getDependency("bufferView",o.bufferView).then(function(y){u=!0;const T=new Blob([y],{type:o.mimeType});return h=l.createObjectURL(T),h});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(h).then(function(y){return new Promise(function(T,B){let j=T;!0===t.isImageBitmapLoader&&(j=function(ne){const se=new Yd(ne);se.needsUpdate=!0,T(se)}),t.load(dx.resolveURL(y,s.path),j,void 0,B)})}).then(function(y){return!0===u&&l.revokeObjectURL(h),ly(y,o),y.userData.mimeType=o.mimeType||function Gye(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),y}).catch(function(y){throw console.error("THREE.GLTFLoader: Couldn't load texture",h),y});return this.sourceCache[e]=f,f}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((o=o.clone()).channel=i.texCoord),s.extensions[Ja.KHR_TEXTURE_TRANSFORM]){const l=void 0!==i.extensions?i.extensions[Ja.KHR_TEXTURE_TRANSFORM]:void 0;if(l){const h=s.associations.get(o);o=s.extensions[Ja.KHR_TEXTURE_TRANSFORM].extendTexture(o,l),s.associations.set(o,h)}}return void 0!==r&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const l="PointsMaterial:"+i.uuid;let h=this.cache.get(l);h||(h=new sy,ch.prototype.copy.call(h,i),h.color.copy(i.color),h.map=i.map,h.sizeAttenuation=!1,this.cache.add(l,h)),i=h}else if(e.isLine){const l="LineBasicMaterial:"+i.uuid;let h=this.cache.get(l);h||(h=new Bc,ch.prototype.copy.call(h,i),h.color.copy(i.color),h.map=i.map,this.cache.add(l,h)),i=h}if(r||s||o){let l="ClonedMaterial:"+i.uuid+":";r&&(l+="derivative-tangents:"),s&&(l+="vertex-colors:"),o&&(l+="flat-shading:");let h=this.cache.get(l);h||(h=i.clone(),s&&(h.vertexColors=!0),o&&(h.flatShading=!0),r&&(h.normalScale&&(h.normalScale.y*=-1),h.clearcoatNormalScale&&(h.clearcoatNormalScale.y*=-1)),this.cache.add(l,h),this.associations.set(h,this.associations.get(i))),i=h}e.material=i}getMaterialType(){return oB}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const l={},u=[];if((s.extensions||{})[Ja.KHR_MATERIALS_UNLIT]){const y=r[Ja.KHR_MATERIALS_UNLIT];o=y.getMaterialType(),u.push(y.extendParams(l,s,t))}else{const y=s.pbrMetallicRoughness||{};if(l.color=new nr(1,1,1),l.opacity=1,Array.isArray(y.baseColorFactor)){const T=y.baseColorFactor;l.color.setRGB(T[0],T[1],T[2],id),l.opacity=T[3]}void 0!==y.baseColorTexture&&u.push(t.assignTexture(l,"map",y.baseColorTexture,hu)),l.metalness=void 0!==y.metallicFactor?y.metallicFactor:1,l.roughness=void 0!==y.roughnessFactor?y.roughnessFactor:1,void 0!==y.metallicRoughnessTexture&&(u.push(t.assignTexture(l,"metalnessMap",y.metallicRoughnessTexture)),u.push(t.assignTexture(l,"roughnessMap",y.metallicRoughnessTexture))),o=this._invokeOne(function(T){return T.getMaterialType&&T.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(T){return T.extendMaterialParams&&T.extendMaterialParams(e,l)})))}!0===s.doubleSided&&(l.side=2);const f=s.alphaMode||"OPAQUE";if("BLEND"===f?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,"MASK"===f&&(l.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==wh&&(u.push(t.assignTexture(l,"normalMap",s.normalTexture)),l.normalScale=new Fi(1,1),void 0!==s.normalTexture.scale)){const y=s.normalTexture.scale;l.normalScale.set(y,y)}if(void 0!==s.occlusionTexture&&o!==wh&&(u.push(t.assignTexture(l,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(l.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==wh){const y=s.emissiveFactor;l.emissive=(new nr).setRGB(y[0],y[1],y[2],id)}return void 0!==s.emissiveTexture&&o!==wh&&u.push(t.assignTexture(l,"emissiveMap",s.emissiveTexture,hu)),Promise.all(u).then(function(){const y=new o(l);return s.name&&(y.name=s.name),ly(y,s),t.associations.set(y,{materials:e}),s.extensions&&_x(r,y,s),y})}createUniqueName(e){const t=Fl.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(l){return i[Ja.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(l,t).then(function(h){return pW(h,l,t)})}const o=[];for(let l=0,h=e.length;l<h;l++){const u=e[l],f=Vye(u),y=r[f];if(y)o.push(y.promise);else{let T;T=u.extensions&&u.extensions[Ja.KHR_DRACO_MESH_COMPRESSION]?s(u):pW(new Hs,u,t),r[f]={primitive:u,promise:T},o.push(T)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,l=[];for(let h=0,u=o.length;h<u;h++){const f=void 0===o[h].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new oB({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial):this.getDependency("material",o[h].material);l.push(f)}var n;return l.push(t.loadGeometries(o)),Promise.all(l).then(function(h){const u=h.slice(0,h.length-1),f=h[h.length-1],y=[];for(let B=0,j=f.length;B<j;B++){const ne=f[B],se=o[B];let le;const Ee=u[B];if(se.mode===SA.TRIANGLES||se.mode===SA.TRIANGLE_STRIP||se.mode===SA.TRIANGLE_FAN||void 0===se.mode)le=!0===s.isSkinnedMesh?new FQ(ne,Ee):new jo(ne,Ee),!0===le.isSkinnedMesh&&le.normalizeSkinWeights(),se.mode===SA.TRIANGLE_STRIP?le.geometry=lW(le.geometry,1):se.mode===SA.TRIANGLE_FAN&&(le.geometry=lW(le.geometry,2));else if(se.mode===SA.LINES)le=new yc(ne,Ee);else if(se.mode===SA.LINE_STRIP)le=new kg(ne,Ee);else if(se.mode===SA.LINE_LOOP)le=new jQ(ne,Ee);else{if(se.mode!==SA.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+se.mode);le=new sx(ne,Ee)}Object.keys(le.geometry.morphAttributes).length>0&&Hye(le,s),le.name=t.createUniqueName(s.name||"mesh_"+e),ly(le,s),se.extensions&&_x(r,le,se),t.assignFinalMaterial(le),y.push(le)}for(let B=0,j=y.length;B<j;B++)t.associations.set(y[B],{meshes:e,primitives:B});if(1===y.length)return s.extensions&&_x(r,y[0],s),y[0];const T=new Xl;s.extensions&&_x(r,T,s),t.associations.set(T,{meshes:e});for(let B=0,j=y.length;B<j;B++)T.add(y[B]);return T})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new Lu(IS.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new Jb(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),ly(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),o=r,l=[],h=[];for(let u=0,f=o.length;u<f;u++){const y=o[u];if(y){l.push(y);const T=new go;null!==s&&T.fromArray(s.array,16*u),h.push(T)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[u])}return new N4(l,h)})}loadAnimation(e){const i=this,r=this.json.animations[e],s=r.name?r.name:"animation_"+e,o=[],l=[],h=[],u=[],f=[];for(let y=0,T=r.channels.length;y<T;y++){const B=r.channels[y],j=r.samplers[B.sampler],ne=B.target,le=void 0!==r.parameters?r.parameters[j.input]:j.input,Ee=void 0!==r.parameters?r.parameters[j.output]:j.output;void 0!==ne.node&&(o.push(this.getDependency("node",ne.node)),l.push(this.getDependency("accessor",le)),h.push(this.getDependency("accessor",Ee)),u.push(j),f.push(ne))}return Promise.all([Promise.all(o),Promise.all(l),Promise.all(h),Promise.all(u),Promise.all(f)]).then(function(y){const T=y[0],B=y[1],j=y[2],ne=y[3],se=y[4],le=[];for(let Ee=0,Pe=T.length;Ee<Pe;Ee++){const Ve=T[Ee],Ft=B[Ee],Ct=j[Ee],Lt=ne[Ee],Kt=se[Ee];if(void 0===Ve)continue;Ve.updateMatrix&&Ve.updateMatrix();const Bt=i._createAnimationTracks(Ve,Ft,Ct,Lt,Kt);if(Bt)for(let St=0;St<Bt.length;St++)le.push(Bt[St])}return new JS(s,void 0,le)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(l){if(l.isMesh)for(let h=0,u=r.weights.length;h<u;h++)l.morphTargetInfluences[h]=r.weights[h]}),o})}loadNode(e){const i=this,r=this.json.nodes[e],s=i._loadNodeShallow(e),o=[],l=r.children||[];for(let u=0,f=l.length;u<f;u++)o.push(i.getDependency("node",l[u]));const h=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),h]).then(function(u){const f=u[0],y=u[1],T=u[2];null!==T&&f.traverse(function(B){B.isSkinnedMesh&&B.bind(T,qye)});for(let B=0,j=y.length;B<j;B++)f.add(y[B]);return f})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"",l=[],h=r._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return h&&l.push(h),void 0!==s.camera&&l.push(r.getDependency("camera",s.camera).then(function(u){return r._getNodeRef(r.cameraCache,s.camera,u)})),r._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){l.push(u)}),this.nodeCache[e]=Promise.all(l).then(function(u){let f;if(f=!0===s.isBone?new B5:u.length>1?new Xl:1===u.length?u[0]:new Wa,f!==u[0])for(let y=0,T=u.length;y<T;y++)f.add(u[y]);if(s.name&&(f.userData.name=s.name,f.name=o),ly(f,s),s.extensions&&_x(i,f,s),void 0!==s.matrix){const y=new go;y.fromArray(s.matrix),f.applyMatrix4(y)}else void 0!==s.translation&&f.position.fromArray(s.translation),void 0!==s.rotation&&f.quaternion.fromArray(s.rotation),void 0!==s.scale&&f.scale.fromArray(s.scale);return r.associations.has(f)||r.associations.set(f,{}),r.associations.get(f).nodes=e,f}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new Xl;i.name&&(s.name=r.createUniqueName(i.name)),ly(s,i),i.extensions&&_x(t,s,i);const o=i.nodes||[],l=[];for(let h=0,u=o.length;h<u;h++)l.push(r.getDependency("node",o[h]));return Promise.all(l).then(function(h){for(let f=0,y=h.length;f<y;f++)s.add(h[f]);return r.associations=(f=>{const y=new Map;for(const[T,B]of r.associations)(T instanceof ch||T instanceof Yd)&&y.set(T,B);return f.traverse(T=>{const B=r.associations.get(T);null!=B&&y.set(T,B)}),y})(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],l=e.name?e.name:e.uuid,h=[];let u;switch(iv[s.path]===iv.weights?e.traverse(function(T){T.morphTargetInfluences&&h.push(T.name?T.name:T.uuid)}):h.push(l),iv[s.path]){case iv.weights:u=zC;break;case iv.rotation:u=HC;break;case iv.position:case iv.scale:u=GC;break;default:u=1===i.itemSize?zC:GC}const f=void 0!==r.interpolation?Nye[r.interpolation]:eC,y=this._getArrayFromAccessor(i);for(let T=0,B=h.length;T<B;T++){const j=new u(h[T]+"."+iv[s.path],t.array,y,f);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(j),o.push(j)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=DL(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof HC?Lye:uW)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function pW(n,e,t){const i=e.attributes,r=[];function s(o,l){return t.getDependency("accessor",o).then(function(h){n.setAttribute(l,h)})}for(const o in i){const l=EL[o]||o.toLowerCase();l in n.attributes||r.push(s(i[o],l))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(l){n.setIndex(l)});r.push(o)}return pl.workingColorSpace!==id&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${pl.workingColorSpace}" not supported.`),ly(n,e),function jye(n,e,t){const i=e.attributes,r=new Gf;if(void 0===i.POSITION)return;{const l=t.json.accessors[i.POSITION],h=l.min,u=l.max;if(void 0===h||void 0===u)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new Dt(h[0],h[1],h[2]),new Dt(u[0],u[1],u[2])),l.normalized){const f=DL(jC[l.componentType]);r.min.multiplyScalar(f),r.max.multiplyScalar(f)}}const s=e.targets;if(void 0!==s){const l=new Dt,h=new Dt;for(let u=0,f=s.length;u<f;u++){const y=s[u];if(void 0!==y.POSITION){const T=t.json.accessors[y.POSITION],B=T.min,j=T.max;if(void 0!==B&&void 0!==j){if(h.setX(Math.max(Math.abs(B[0]),Math.abs(j[0]))),h.setY(Math.max(Math.abs(B[1]),Math.abs(j[1]))),h.setZ(Math.max(Math.abs(B[2]),Math.abs(j[2]))),T.normalized){const ne=DL(jC[T.componentType]);h.multiplyScalar(ne)}l.max(h)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(l)}n.boundingBox=r;const o=new sd;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function zye(n,e,t){let i=!1,r=!1,s=!1;for(let u=0,f=e.length;u<f;u++){const y=e[u];if(void 0!==y.POSITION&&(i=!0),void 0!==y.NORMAL&&(r=!0),void 0!==y.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],l=[],h=[];for(let u=0,f=e.length;u<f;u++){const y=e[u];if(i){const T=void 0!==y.POSITION?t.getDependency("accessor",y.POSITION):n.attributes.position;o.push(T)}if(r){const T=void 0!==y.NORMAL?t.getDependency("accessor",y.NORMAL):n.attributes.normal;l.push(T)}if(s){const T=void 0!==y.COLOR_0?t.getDependency("accessor",y.COLOR_0):n.attributes.color;h.push(T)}}return Promise.all([Promise.all(o),Promise.all(l),Promise.all(h)]).then(function(u){const y=u[1],T=u[2];return i&&(n.morphAttributes.position=u[0]),r&&(n.morphAttributes.normal=y),s&&(n.morphAttributes.color=T),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}const IL=new WeakMap;class BL extends Jd{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,r){const s=new Dp(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{this.parse(o,t,r)},i,r)}parse(e,t,i=()=>{}){this.decodeDracoFile(e,t,null,null,hu,i).catch(i)}decodeDracoFile(e,t,i,r,s=id,o=()=>{}){return this.decodeGeometry(e,{attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:s}).then(t).catch(o)}decodeGeometry(e,t){const i=JSON.stringify(t);if(IL.has(e)){const h=IL.get(e);if(h.key===i)return h.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,l=this._getWorker(s,e.byteLength).then(h=>(r=h,new Promise((u,f)=>{r._callbacks[s]={resolve:u,reject:f},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(h=>this._createGeometry(h.geometry));return l.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),IL.set(e,{key:i,promise:l}),l}_createGeometry(e){const t=new Hs;e.index&&t.setIndex(new To(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i],s=r.name,o=r.array,h=new To(o,r.itemSize);"color"===s&&(this._assignVertexColorSpace(h,r.vertexColorSpace),h.normalized=!(o instanceof Float32Array)),t.setAttribute(s,h)}return t}_assignVertexColorSpace(e,t){if(t!==hu)return;const i=new nr;for(let r=0,s=e.count;r<s;r++)i.fromBufferAttribute(e,r).convertSRGBToLinear(),e.setXYZ(r,i.r,i.g,i.b)}_loadLibrary(e,t){const i=new Dp(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=Wye.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function Wye(){let n,e;function r(o,l,h,u,f,y){const T=y.num_components(),j=h.num_points()*T,ne=j*f.BYTES_PER_ELEMENT,se=function s(o,l){switch(l){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}(o,f),le=o._malloc(ne);l.GetAttributeDataArrayForAllPoints(h,y,se,ne,le);const Ee=new f(o.HEAPF32.buffer,le,j).slice();return o._free(le),{name:u,array:Ee,itemSize:T}}onmessage=function(o){const l=o.data;switch(l.type){case"init":n=l.decoderConfig,e=new Promise(function(f){n.onModuleLoaded=function(y){f({draco:y})},DracoDecoderModule(n)});break;case"decode":const h=l.buffer,u=l.taskConfig;e.then(f=>{const y=f.draco,T=new y.Decoder;try{const B=function t(o,l,h,u){const f=u.attributeIDs,y=u.attributeTypes;let T,B;const j=l.GetEncodedGeometryType(h);if(j===o.TRIANGULAR_MESH)T=new o.Mesh,B=l.DecodeArrayToMesh(h,h.byteLength,T);else{if(j!==o.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");T=new o.PointCloud,B=l.DecodeArrayToPointCloud(h,h.byteLength,T)}if(!B.ok()||0===T.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+B.error_msg());const ne={index:null,attributes:[]};for(const se in f){const le=self[y[se]];let Ee,Pe;if(u.useUniqueIDs)Pe=f[se],Ee=l.GetAttributeByUniqueId(T,Pe);else{if(Pe=l.GetAttributeId(T,o[f[se]]),-1===Pe)continue;Ee=l.GetAttribute(T,Pe)}const Ve=r(o,l,T,se,le,Ee);"color"===se&&(Ve.vertexColorSpace=u.vertexColorSpace),ne.attributes.push(Ve)}return j===o.TRIANGULAR_MESH&&(ne.index=function i(o,l,h){const f=3*h.num_faces(),y=4*f,T=o._malloc(y);l.GetTrianglesUInt32Array(h,y,T);const B=new Uint32Array(o.HEAPF32.buffer,T,f).slice();return o._free(T),{array:B,itemSize:1}}(o,l,T)),o.destroy(T),ne}(y,T,new Int8Array(h),u),j=B.attributes.map(ne=>ne.array.buffer);B.index&&j.push(B.index.array.buffer),self.postMessage({type:"decode",id:l.id,geometry:B},j)}catch(B){console.error(B),self.postMessage({type:"error",id:l.id,error:B.message})}finally{y.destroy(T)}})}}}var $ye=Te(3347),bB=Te.n($ye);class Xye{constructor(e,t,i){this.clipPlanes=e,this.EVENT_DATA_ID=t,this.GEOMETRIES_ID=i}loadOBJGeometry(e,t,i,r,s){i=i??4302580;const o=new oW;return new Promise((l,h)=>{o.load(e,u=>{const f=this.processOBJ(u,t,i,r,s);l({object:f})},()=>{},u=>{h(u)})})}parseOBJGeometry(e,t){const r=(new oW).parse(e);return this.processOBJ(r,t,4302580,!1,!1)}processOBJ(e,t,i,r,s){return e.name=t,e.userData={name:t},this.setObjFlat(e,i,r,s)}setObjFlat(e,t,i,r){const s=new Og({color:t,shininess:0,wireframe:!1,clippingPlanes:this.clipPlanes,clipIntersection:!0,clipShadows:!1,side:i?2:0,flatShading:r});return e.traverse(o=>{o instanceof jo?(o.name=e.name,o.userData=e.userData,o.userData.size=this.getObjectSize(o),o.material instanceof ch&&(o.material.dispose(),o.material=s),o.castShadow=!1,o.receiveShadow=!1):o instanceof yc&&o.material instanceof Bc&&o.material.color.set(t)}),e}parsePhnxScene(e,t){const i=new vB,r=new BL;r.setDecoderPath(`https://cdn.jsdelivr.net/npm/three@0.${zb}.0/examples/jsm/libs/draco/`),i.setDRACOLoader(r);const s=JSON.stringify(e,null,2);return new Promise((o,l)=>{i.parse(s,"",h=>{const u=h.scene.getObjectByName(this.EVENT_DATA_ID),f=h.scene.getObjectByName(this.GEOMETRIES_ID);t(u,f),o()},h=>{l(h)})})}zipHandlingInternal(e,t,i,r,s,o){"zip"==t.split(".").pop()?bB().loadAsync(i).then(l=>{const h=[];for(const f in l.files)h.push(l.file(f).async("arraybuffer").then(y=>r(y,e,f.split(".")[0])));let u=[];Promise.all(h).then(f=>{f.forEach(y=>{u=u.concat(y)}),s(u)})}):r(i,e,t.split(".")[0]).then(l=>{s(l)},l=>{o(l)})}zipHandlingFileWrapper(e,t){return new Promise((i,r)=>{const s=new FileReader;s.onload=()=>{this.zipHandlingInternal("",e.name,s.result,t,i,r)},s.readAsArrayBuffer(e)})}zipHandlingURLWrapper(e,t){return new Promise((i,r)=>{fetch(e).then(s=>s.arrayBuffer().then(o=>{this.zipHandlingInternal(e.substr(0,e.lastIndexOf("/")),e,o,t,i,r)}))})}loadGLTFGeometry(e,t,i,r,s){return this.zipHandlingURLWrapper(e,(o,l,h)=>this.loadGLTFGeometryInternal(o,l,t,i,r,s))}loadGLTFGeometryInternal(e,t,i,r,s,o){const l=new vB,h=new BL;return h.setDecoderPath(`https://cdn.jsdelivr.net/npm/three@0.${zb}.0/examples/jsm/libs/draco/`),l.setDRACOLoader(h),new Promise((u,f)=>{l.parse(e,t,y=>{const T=[];for(const B of y.scenes){B.visible=B.userData.visible??o;const j=this.processGLTFSceneName(B.name,r),ne={},se=(le,Ee,Pe)=>{const Ve=Ee.clone().multiply(le.matrix);if(le instanceof jo){const Ft=le.material.id;ne[Ft]||(ne[Ft]={material:le.material,geoms:[],renderOrder:-Pe}),ne[Ft].geoms.push(le.geometry.clone().applyMatrix4(Ve))}for(const Ft of le.children)se(Ft,Ve,Pe+1)};se(B,new go,0),B.remove(...B.children);for(const le of Object.values(ne)){const Ee=new jo(wL(le.geoms),le.material);Ee.renderOrder=le.renderOrder,B.add(Ee)}this.processGeometry(B,i??j?.name,s,!0),T.push({object:B,menuNodeName:r??j?.menuNodeName})}u(T)},y=>{f(y)})})}parseGLTFGeometry(e){return this.zipHandlingFileWrapper(e,(t,i,r)=>this.parseGLTFGeometryFromArrayBuffer(t,i,r))}parseGLTFGeometryFromArrayBuffer(e,t,i){const r=new vB,s=new BL;return s.setDecoderPath(`https://cdn.jsdelivr.net/npm/three@0.${zb}.0/examples/jsm/libs/draco/`),r.setDRACOLoader(s),new Promise((o,l)=>{r.parse(e,t,h=>{const u=[];for(const f of h.scenes){f.visible=f.userData.visible,console.log("Dealing with scene ",f.name);const y=this.processGLTFSceneName(f.name);this.processGeometry(f,y?.name??i),u.push({object:f,menuNodeName:y?.menuNodeName})}o(u)},h=>{l(h)})})}processGLTFSceneName(e,t){if(e){const i=e.split("_>_");t&&i.unshift(t);const r=i.join(" > ");return i.pop(),{name:r,menuNodeName:i.join(" > ")}}}loadJSONGeometry(e,t,i,r){const s=new Y0e;switch(typeof e){case"string":return new Promise((o,l)=>{s.load(e,h=>{this.processGeometry(h,t,i,r),o({object:h})},void 0,h=>{l(h)})});case"object":return new Promise(o=>{const l=s.parse(e);this.processGeometry(l,t,i,r),o({object:l})})}}processGeometry(e,t,i,r){e.name=t,i&&e.scale.setScalar(i),e.traverse(s=>{if(s instanceof jo&&(s.name=s.userData.name=t,s.userData.size=this.getObjectSize(s),s.material instanceof ch)){const o=s.material,l="color"in o?o.color.getHex():3135121,h=r?2:s.material.side;s.material.dispose();let u=!1;e.userData.opacity&&(u=!0),s.material=new Og({color:l,shininess:0,side:h,transparent:u,opacity:e.userData.opacity??1}),s.material.clippingPlanes=this.clipPlanes,s.material.clipIntersection=!0,s.material.clipShadows=!1}})}getObjectSize(e){const t=new Dt;return e.geometry.computeBoundingBox(),e.geometry?.boundingBox?.getSize(t),JSON.stringify(t,null,2)}}let rv=(()=>{class n{static getPrettySymbol(t){return Object.keys(n.symbols).find(r=>n.symbols[r].includes(t))||t}static getPrettyParams(t){const i=Object.assign({},t);for(const r of Object.keys(i)){const s=n.getPrettySymbol(r);s!==r&&(i[s]=i[r],delete i[r])}if(delete i.pos,i?.dparams){const r={};return r.\u03b8=i.dparams[3],r.\u03d5=i.dparams[2],r["|p|"]=Math.abs(1/i.dparams[4]),r.q=Math.sign(1/i.dparams[4]),r.d0=i.dparams[0],r.z0=i.dparams[1],delete i.dparams,{...i,...r}}return i}}return n.symbols={\u03b8:["theta"],\u03d5:["phi"],pT:["pt"],\u{1d6d8}2:["chi2"],\u03b7:["eta"],q:["charge"],NDOF:["ndof"],DOF:["dof"],Energy:["energy"],ET:["et"],"|p|":["momentum","mom"]},n})();class WC{constructor(e){this.value=e,this.callbacks=[]}update(e){this.value=e,this.callbacks.forEach(t=>t(e))}onUpdate(e){this.callbacks.push(e)}}class Yye{constructor(){this.activeObject=new WC(""),this.onTouchMove=e=>{const t=this.intersectObject(e);if(t){if(this.ignoreList.includes(t.type))return;this.outlinePass.selectedObjects=[t]}},this.onDocumentMouseDown=()=>{const e=this.outlinePass.selectedObjects[0];if(e){this.selectedObject.name=e.name,this.selectedObject.attributes.splice(0,this.selectedObject.attributes.length),this.activeObject.update(e.uuid);const t=rv.getPrettyParams(e.userData);for(const s of Object.keys(t))this.selectedObject.attributes.push({attributeName:s,attributeValue:t[s]});const i=Object.keys(e.userData).map(s=>{if(["string","number"].includes(typeof e.userData[s]))return s+"="+e.userData[s]}).filter(s=>s),r=e.name+(i.length>0?" with "+i.join(", "):"");r&&this.infoLogger.add(r,"Clicked")}},this.onTouchDown=e=>{e.preventDefault(),this.onTouchMove(e.targetTouches[0]),this.onDocumentMouseDown()},this.isInit=!1,this.ignoreList=[(new lB).type,(new qC).type,(new qj).type]}init(e,t,i,r){this.camera=e,this.scene=t,this.isInit=!0,this.infoLogger=r,this.effectsManager=i,this.outlinePass=this.effectsManager.addOutlinePassForSelection()}setSelectedObject(e){this.selectedObject=e}getActiveObjectId(){return this.activeObject}setSelecting(e){this.isInit&&(e?this.enableSelecting():this.disableSelecting())}enableSelecting(){const e=document.getElementById("three-canvas");e&&(e.addEventListener("mousemove",this.onTouchMove,!0),e.addEventListener("click",this.onDocumentMouseDown,!0),e.addEventListener("touchstart",this.onTouchDown),this.preSelectionAntialias=this.effectsManager.antialiasing,this.effectsManager.setAntialiasing(!1))}disableSelecting(){const e=document.getElementById("three-canvas");e&&(e.removeEventListener("mousemove",this.onTouchMove,!0),e.removeEventListener("click",this.onDocumentMouseDown,!0),e.removeEventListener("touchstart",this.onTouchDown),this.outlinePass.selectedObjects=[],this.effectsManager.setAntialiasing(this.preSelectionAntialias))}intersectObject(e){e.preventDefault?.();const t=new Fi,i=this.effectsManager.composer.renderer.domElement;t.x=e.clientX/i.clientWidth*2-1,t.y=-e.clientY/i.clientHeight*2+1;const r=new Bj;r.setFromCamera(t,this.camera),r.params.Line.threshold=3;const s=r.intersectObjects(this.scene.children,!0);return s.length>0?s[0].object:new Wa}enableHighlighting(){this.preSelectionAntialias=this.effectsManager.antialiasing,this.effectsManager.setAntialiasing(!1)}highlightObject(e,t){const i=t.getObjectByProperty("uuid",e);i&&(this.outlinePass.selectedObjects=[i],this.activeObject.update(i.uuid))}disableHighlighting(){this.outlinePass.selectedObjects=[],this.effectsManager.setAntialiasing(this.preSelectionAntialias)}}class Kye extends rB{constructor(e,t={}){const i=t.font;if(void 0===i)super();else{const r=i.generateShapes(e,t.size);void 0===t.depth&&void 0!==t.height&&console.warn("THREE.TextGeometry: .height is now depreciated. Please use .depth instead"),t.depth=void 0!==t.depth?t.depth:void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}class mW{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const i=[],r=function Zye(n,e,t){const i=Array.from(n),r=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,o=[];let l=0,h=0;for(let u=0;u<i.length;u++){const f=i[u];if("\n"===f)l=0,h-=s;else{const y=Jye(f,r,l,h,t);l+=y.offsetX,o.push(y.path)}}return o}(e,t,this.data);for(let s=0,o=r.length;s<o;s++)i.push(...r[s].toShapes());return i}}function Jye(n,e,t,i,r){const s=r.glyphs[n]||r.glyphs["?"];if(!s)return void console.error('THREE.Font: character "'+n+'" does not exists in font family '+r.familyName+".");const o=new g_e;let l,h,u,f,y,T,B,j;if(s.o){const ne=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let se=0,le=ne.length;se<le;)switch(ne[se++]){case"m":l=ne[se++]*e+t,h=ne[se++]*e+i,o.moveTo(l,h);break;case"l":l=ne[se++]*e+t,h=ne[se++]*e+i,o.lineTo(l,h);break;case"q":u=ne[se++]*e+t,f=ne[se++]*e+i,y=ne[se++]*e+t,T=ne[se++]*e+i,o.quadraticCurveTo(y,T,u,f);break;case"b":u=ne[se++]*e+t,f=ne[se++]*e+i,y=ne[se++]*e+t,T=ne[se++]*e+i,B=ne[se++]*e+t,j=ne[se++]*e+i,o.bezierCurveTo(y,T,B,j,u,f)}}return{offsetX:s.ha*e,path:o}}class jf{static anglesAreSane(e,t){const i=-Math.PI<t&&Math.PI>t,r=0<e&&Math.PI>e;return i&&r}static etaToTheta(e){return 2*Math.atan(Math.pow(Math.E,-e))}static thetaToEta(e){return-Math.log(Math.tan(e/2))}static sphericalToCartesian(e,t,i){const r=new Dt;return r.setFromSphericalCoords(e,t,i),r.applyQuaternion(jf.atlasQuaternion()),r}static etaPhiToCartesian(e,t,i){const r=new Dt;return r.setFromSphericalCoords(e,this.etaToTheta(t),i),r.applyQuaternion(jf.atlasQuaternion()),r}static atlasQuaternion(){const e=new Dt(0,1,0),t=new Dt(0,0,1),i=new zc;i.setFromUnitVectors(e,t);const r=new zc;return r.setFromAxisAngle(new Dt(0,1,0),Math.PI/2),i.multiply(r),i}}const e1e=JSON.parse('{"glyphs":{"0":{"x_min":73,"x_max":715,"ha":792,"o":"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},"1":{"x_min":215.671875,"x_max":574,"ha":792,"o":"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},"2":{"x_min":59,"x_max":731,"ha":792,"o":"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},"3":{"x_min":54,"x_max":737,"ha":792,"o":"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},"4":{"x_min":48,"x_max":742.453125,"ha":792,"o":"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},"5":{"x_min":54.171875,"x_max":738,"ha":792,"o":"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},"6":{"x_min":53,"x_max":739,"ha":792,"o":"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},"7":{"x_min":58.71875,"x_max":730.953125,"ha":792,"o":"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},"8":{"x_min":55,"x_max":736,"ha":792,"o":"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},"9":{"x_min":53,"x_max":739,"ha":792,"o":"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},"\u03bf":{"x_min":0,"x_max":712,"ha":815,"o":"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},"S":{"x_min":0,"x_max":788,"ha":890,"o":"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"\xa6":{"x_min":343,"x_max":449,"ha":792,"o":"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{"x_min":183.25,"x_max":608.328125,"ha":792,"o":"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},"\u03a4":{"x_min":-0.4375,"x_max":777.453125,"ha":839,"o":"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},"y":{"x_min":0,"x_max":684.78125,"ha":771,"o":"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},"\u03a0":{"x_min":0,"x_max":803,"ha":917,"o":"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},"\u0390":{"x_min":-111,"x_max":339,"ha":361,"o":"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},"g":{"x_min":0,"x_max":686,"ha":838,"o":"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"\xb2":{"x_min":0,"x_max":442,"ha":539,"o":"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"\u2013":{"x_min":0,"x_max":705.5625,"ha":803,"o":"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},"\u039a":{"x_min":0,"x_max":819.5625,"ha":893,"o":"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},"\u0192":{"x_min":-46.265625,"x_max":392,"ha":513,"o":"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},"e":{"x_min":0,"x_max":714,"ha":813,"o":"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},"\u03cc":{"x_min":0,"x_max":712,"ha":815,"o":"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},"J":{"x_min":0,"x_max":588,"ha":699,"o":"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"\xbb":{"x_min":-1,"x_max":503,"ha":601,"o":"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"\xa9":{"x_min":-3,"x_max":1008,"ha":1106,"o":"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},"\u03ce":{"x_min":0,"x_max":922,"ha":1030,"o":"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{"x_min":193.0625,"x_max":598.609375,"ha":792,"o":"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"\xab":{"x_min":0,"x_max":507.203125,"ha":604,"o":"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},"D":{"x_min":0,"x_max":828,"ha":935,"o":"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"\u2219":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},"\xff":{"x_min":0,"x_max":47,"ha":125,"o":"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},"w":{"x_min":0,"x_max":1009.71875,"ha":1100,"o":"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},"$":{"x_min":0,"x_max":700,"ha":793,"o":"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\\\":{"x_min":-0.015625,"x_max":425.0625,"ha":522,"o":"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},"\xb5":{"x_min":0,"x_max":697.21875,"ha":747,"o":"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},"\u0399":{"x_min":42,"x_max":181,"ha":297,"o":"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},"\u038e":{"x_min":0,"x_max":1144.5,"ha":1214,"o":"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2019":{"x_min":0,"x_max":139,"ha":236,"o":"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},"\u039d":{"x_min":0,"x_max":801,"ha":915,"o":"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{"x_min":8.71875,"x_max":350.390625,"ha":478,"o":"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},"Q":{"x_min":0,"x_max":968,"ha":1072,"o":"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},"\u03c2":{"x_min":1,"x_max":676.28125,"ha":740,"o":"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},"M":{"x_min":0,"x_max":954,"ha":1067,"o":"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},"\u03a8":{"x_min":0,"x_max":1006,"ha":1094,"o":"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},"C":{"x_min":0,"x_max":886,"ha":944,"o":"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{"x_min":0,"x_max":138,"ha":236,"o":"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{"x_min":0,"x_max":480.5625,"ha":578,"o":"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},"X":{"x_min":-0.015625,"x_max":854.15625,"ha":940,"o":"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{"x_min":0,"x_max":963.890625,"ha":1061,"o":"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},"\u03b9":{"x_min":42,"x_max":284,"ha":361,"o":"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},"\u0386":{"x_min":0,"x_max":906.953125,"ha":982,"o":"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{"x_min":0,"x_max":318,"ha":415,"o":"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},"\u03b5":{"x_min":0,"x_max":634.71875,"ha":714,"o":"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},"\u0394":{"x_min":0,"x_max":952.78125,"ha":1028,"o":"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{"x_min":0,"x_max":481,"ha":578,"o":"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"\u2030":{"x_min":-3,"x_max":1672,"ha":1821,"o":"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},"a":{"x_min":0,"x_max":698.609375,"ha":794,"o":"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"\u2014":{"x_min":0,"x_max":941.671875,"ha":1039,"o":"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{"x_min":8.71875,"x_max":780.953125,"ha":792,"o":"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},"N":{"x_min":0,"x_max":801,"ha":914,"o":"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},"\u03c1":{"x_min":0,"x_max":712,"ha":797,"o":"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"\xaf":{"x_min":0,"x_max":941.671875,"ha":938,"o":"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},"Z":{"x_min":0,"x_max":779,"ha":849,"o":"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},"u":{"x_min":0,"x_max":617,"ha":729,"o":"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},"k":{"x_min":0,"x_max":612.484375,"ha":697,"o":"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},"\u0397":{"x_min":0,"x_max":803,"ha":917,"o":"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},"\u0391":{"x_min":0,"x_max":906.953125,"ha":985,"o":"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},"s":{"x_min":0,"x_max":604,"ha":697,"o":"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},"B":{"x_min":0,"x_max":778,"ha":876,"o":"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"\u2026":{"x_min":0,"x_max":614,"ha":708,"o":"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{"x_min":0,"x_max":607,"ha":704,"o":"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},"H":{"x_min":0,"x_max":803,"ha":915,"o":"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},"\u03bd":{"x_min":0,"x_max":675,"ha":761,"o":"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},"c":{"x_min":1,"x_max":701.390625,"ha":775,"o":"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"\xb6":{"x_min":0,"x_max":566.671875,"ha":678,"o":"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},"\u03b2":{"x_min":0,"x_max":660,"ha":745,"o":"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},"\u039c":{"x_min":0,"x_max":954,"ha":1068,"o":"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},"\u038c":{"x_min":0.109375,"x_max":1120,"ha":1217,"o":"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u0389":{"x_min":0,"x_max":1158,"ha":1275,"o":"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2022":{"x_min":0,"x_max":663.890625,"ha":775,"o":"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"\xa5":{"x_min":0.1875,"x_max":819.546875,"ha":886,"o":"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{"x_min":0,"x_max":318.0625,"ha":415,"o":"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},"U":{"x_min":0,"x_max":796,"ha":904,"o":"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},"\u03b3":{"x_min":0.5,"x_max":744.953125,"ha":822,"o":"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},"\u03b1":{"x_min":0,"x_max":765.5625,"ha":809,"o":"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},"F":{"x_min":0,"x_max":683.328125,"ha":717,"o":"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"\xad":{"x_min":0,"x_max":705.5625,"ha":803,"o":"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},"\u03a7":{"x_min":0,"x_max":854.171875,"ha":935,"o":"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{"x_min":116,"x_max":674,"ha":792,"o":"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"\u2020":{"x_min":0,"x_max":777,"ha":835,"o":"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"\xb0":{"x_min":0,"x_max":347,"ha":444,"o":"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},"V":{"x_min":0,"x_max":862.71875,"ha":940,"o":"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},"\u039e":{"x_min":0,"x_max":734.71875,"ha":763,"o":"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"\xa0":{"x_min":0,"x_max":0,"ha":853},"\u03ab":{"x_min":0.328125,"x_max":819.515625,"ha":889,"o":"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"\u201d":{"x_min":0,"x_max":347,"ha":454,"o":"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{"x_min":0,"x_max":1260,"ha":1357,"o":"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},"\u038a":{"x_min":0,"x_max":499,"ha":613,"o":"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},"i":{"x_min":14,"x_max":136,"ha":275,"o":"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},"\u0392":{"x_min":0,"x_max":778,"ha":877,"o":"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},"\u03c5":{"x_min":0,"x_max":617,"ha":725,"o":"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{"x_min":0,"x_max":275,"ha":372,"o":"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},"m":{"x_min":0,"x_max":1019,"ha":1128,"o":"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},"\u03c7":{"x_min":8.328125,"x_max":780.5625,"ha":815,"o":"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},"\u03af":{"x_min":42,"x_max":326.71875,"ha":361,"o":"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},"\u0396":{"x_min":0,"x_max":779.171875,"ha":850,"o":"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},"R":{"x_min":0,"x_max":781.953125,"ha":907,"o":"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},"o":{"x_min":0,"x_max":713,"ha":821,"o":"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},"K":{"x_min":0,"x_max":819.46875,"ha":906,"o":"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},"d":{"x_min":0,"x_max":683,"ha":796,"o":"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"\xa8":{"x_min":-109,"x_max":247,"ha":232,"o":"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},"E":{"x_min":0,"x_max":736.109375,"ha":789,"o":"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"Y":{"x_min":0,"x_max":820,"ha":886,"o":"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},"\\"":{"x_min":0,"x_max":299,"ha":396,"o":"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\u2039":{"x_min":17.984375,"x_max":773.609375,"ha":792,"o":"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\u201e":{"x_min":0,"x_max":364,"ha":467,"o":"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},"\u03b4":{"x_min":1,"x_max":710,"ha":810,"o":"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},"\u03ad":{"x_min":0,"x_max":634.71875,"ha":714,"o":"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},"\u03c9":{"x_min":0,"x_max":922,"ha":1031,"o":"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"\xb4":{"x_min":0,"x_max":96,"ha":251,"o":"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\xb1":{"x_min":11,"x_max":781,"ha":792,"o":"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{"x_min":343,"x_max":449,"ha":792,"o":"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"\u03cb":{"x_min":0,"x_max":617,"ha":725,"o":"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"\xa7":{"x_min":0,"x_max":593,"ha":690,"o":"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},"b":{"x_min":0,"x_max":685,"ha":783,"o":"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},"q":{"x_min":0,"x_max":683,"ha":876,"o":"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},"\u03a9":{"x_min":-0.171875,"x_max":969.5625,"ha":1068,"o":"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},"\u03cd":{"x_min":0,"x_max":617,"ha":725,"o":"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},"z":{"x_min":-0.015625,"x_max":613.890625,"ha":697,"o":"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"\u2122":{"x_min":0,"x_max":894,"ha":1000,"o":"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},"\u03ae":{"x_min":0.78125,"x_max":697,"ha":810,"o":"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},"\u0398":{"x_min":0,"x_max":960,"ha":1056,"o":"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"\xae":{"x_min":-3,"x_max":1008,"ha":1106,"o":"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{"x_min":0,"x_max":833,"ha":931,"o":"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},"\u0395":{"x_min":0,"x_max":736.21875,"ha":778,"o":"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"\xb3":{"x_min":0,"x_max":450,"ha":547,"o":"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{"x_min":0,"x_max":273.609375,"ha":371,"o":"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},"L":{"x_min":0,"x_max":645.828125,"ha":696,"o":"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},"\u03c3":{"x_min":0,"x_max":803.390625,"ha":894,"o":"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},"\u03b6":{"x_min":0,"x_max":573,"ha":642,"o":"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},"\u03b8":{"x_min":0,"x_max":674,"ha":778,"o":"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},"\u039f":{"x_min":0,"x_max":958,"ha":1054,"o":"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},"\u0393":{"x_min":0,"x_max":705.28125,"ha":749,"o":"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{"x_min":0,"x_max":0,"ha":375},"%":{"x_min":-3,"x_max":1089,"ha":1186,"o":"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},"P":{"x_min":0,"x_max":726,"ha":806,"o":"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},"\u0388":{"x_min":0,"x_max":1078.21875,"ha":1118,"o":"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u038f":{"x_min":0.125,"x_max":1136.546875,"ha":1235,"o":"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},"_":{"x_min":0,"x_max":705.5625,"ha":803,"o":"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},"\u03aa":{"x_min":-110,"x_max":246,"ha":275,"o":"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{"x_min":23,"x_max":768,"ha":792,"o":"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"\xbd":{"x_min":0,"x_max":1050,"ha":1149,"o":"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},"\u03a1":{"x_min":0,"x_max":720,"ha":783,"o":"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"\'":{"x_min":0,"x_max":139,"ha":236,"o":"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},"\xaa":{"x_min":0,"x_max":350,"ha":397,"o":"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"\u0385":{"x_min":0,"x_max":450,"ha":553,"o":"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},"T":{"x_min":0,"x_max":777,"ha":835,"o":"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},"\u03a6":{"x_min":0,"x_max":915,"ha":997,"o":"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"\u204b":{"x_min":0,"x_max":0,"ha":694},"j":{"x_min":-77.78125,"x_max":167,"ha":349,"o":"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},"\u03a3":{"x_min":0,"x_max":756.953125,"ha":819,"o":"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"\u203a":{"x_min":18.0625,"x_max":774,"ha":792,"o":"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{"x_min":17.984375,"x_max":773.609375,"ha":792,"o":"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\xa3":{"x_min":0,"x_max":704.484375,"ha":801,"o":"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},"t":{"x_min":0,"x_max":367,"ha":458,"o":"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"\xac":{"x_min":0,"x_max":706,"ha":803,"o":"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},"\u03bb":{"x_min":0,"x_max":750,"ha":803,"o":"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},"W":{"x_min":0,"x_max":1263.890625,"ha":1351,"o":"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{"x_min":18.0625,"x_max":774,"ha":792,"o":"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"v":{"x_min":0,"x_max":675.15625,"ha":761,"o":"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},"\u03c4":{"x_min":0.28125,"x_max":644.5,"ha":703,"o":"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},"\u03be":{"x_min":0,"x_max":624.9375,"ha":699,"o":"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{"x_min":-3,"x_max":894.25,"ha":992,"o":"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},"\u039b":{"x_min":0,"x_max":862.5,"ha":942,"o":"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},"I":{"x_min":41,"x_max":180,"ha":293,"o":"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},"G":{"x_min":0,"x_max":921,"ha":1011,"o":"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},"\u03b0":{"x_min":0,"x_max":617,"ha":725,"o":"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{"x_min":0,"x_max":138.890625,"ha":236,"o":"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"\xb7":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},"\u03a5":{"x_min":0.328125,"x_max":819.515625,"ha":889,"o":"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},"r":{"x_min":0,"x_max":355.5625,"ha":432,"o":"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},"x":{"x_min":0,"x_max":675,"ha":764,"o":"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},"\u03bc":{"x_min":0,"x_max":696.609375,"ha":747,"o":"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},"h":{"x_min":0,"x_max":615,"ha":724,"o":"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},"\u03c6":{"x_min":-2,"x_max":878,"ha":974,"o":"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},"f":{"x_min":0,"x_max":378,"ha":472,"o":"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"\u201c":{"x_min":1,"x_max":348.21875,"ha":454,"o":"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},"A":{"x_min":0.03125,"x_max":906.953125,"ha":1008,"o":"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"\u2018":{"x_min":1,"x_max":139.890625,"ha":236,"o":"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},"\u03ca":{"x_min":-70,"x_max":283,"ha":361,"o":"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},"\u03c0":{"x_min":-0.21875,"x_max":773.21875,"ha":857,"o":"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},"\u03ac":{"x_min":0,"x_max":765.5625,"ha":809,"o":"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},"O":{"x_min":0,"x_max":958,"ha":1057,"o":"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},"n":{"x_min":0,"x_max":615,"ha":724,"o":"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},"l":{"x_min":41,"x_max":166,"ha":279,"o":"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"\xa4":{"x_min":40.09375,"x_max":728.796875,"ha":825,"o":"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},"\u03ba":{"x_min":0,"x_max":632.328125,"ha":679,"o":"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},"p":{"x_min":0,"x_max":685,"ha":786,"o":"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"\u2021":{"x_min":0,"x_max":777,"ha":835,"o":"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},"\u03c8":{"x_min":0,"x_max":808,"ha":907,"o":"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},"\u03b7":{"x_min":0.78125,"x_max":697,"ha":810,"o":"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},"cssFontWeight":"normal","ascender":1189,"underlinePosition":-100,"cssFontStyle":"normal","boundingBox":{"yMin":-334,"xMin":-111,"yMax":1189,"xMax":1672},"resolution":1000,"original_font_information":{"postscript_name":"Helvetiker-Regular","version_string":"Version 1.00 2004 initial release","vendor_url":"http://www.magenta.gr/","full_font_name":"Helvetiker","font_family_name":"Helvetiker","copyright":"Copyright (c) \u039cagenta ltd, 2004","description":"","trademark":"","designer":"","designer_url":"","unique_font_identifier":"\u039cagenta ltd:Helvetiker:22-10-104","license_url":"http://www.ellak.gr/fonts/MgOpen/license.html","license_description":"Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\\r\\n\\r\\nPermission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license (\\"Fonts\\") and associated documentation files (the \\"Font Software\\"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \\r\\n\\r\\nThe above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\\r\\n\\r\\nThe Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word \\"MgOpen\\", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\\r\\n\\r\\nThis License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the \\"MgOpen\\" name.\\r\\n\\r\\nThe Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \\r\\n\\r\\nTHE FONT SOFTWARE IS PROVIDED \\"AS IS\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.","manufacturer_name":"\u039cagenta ltd","font_sub_family_name":"Regular"},"descender":-334,"familyName":"Helvetiker","lineHeight":1522,"underlineThickness":50}');let el=(()=>{class n{constructor(t,i=!0){this.cartesianGridConfig={showXY:!0,showYZ:!0,showZX:!0,xDistance:0,yDistance:0,zDistance:0,sparsity:2},this.useCameraLight=!0,this.textFont=new mW(e1e),this.labelTextLookCallbacks={},this.axesNumbers=[],this.getScene(),this.ignoreList=t,this.axis=new Wa,this.setLights(i)}setLights(t=!0){this.useCameraLight=t;const i=new lB(16777215,1.2);this.scene.add(i),this.useCameraLight?(this.cameraLight=new qC(16777215,.9),this.cameraLight.position.set(0,0,10),this.scene.add(this.cameraLight)):[[-100,-50,100],[100,50,-100],[-100,50,-100],[100,-50,100]].forEach(r=>{const s=new qC(16777215,.2);s.position.set(r[0],r[1],r[2]),this.scene.add(s)})}updateLights(t){this.useCameraLight&&this.cameraLight.position.copy(t.position)}getScene(){return this.scene||(this.scene=new US),this.scene}getCleanScene(){const t=this.scene.clone(),i=[];return t.traverse(r=>{this.ignoreList.includes(r.type)&&i.push(r)}),t.remove(...i),t}setGeometryOpacity(t,i){i&&t&&t.traverse(r=>{const s=r;s?.material&&(Array.isArray(s.material)?s.material.forEach(o=>{o.transparent=!0,o.opacity=i}):(s.material.transparent=!0,s.material.opacity=i))})}changeObjectColor(t,i){t&&t.traverse(r=>{(r instanceof jo||r instanceof yc)&&(r.material instanceof Og||r.material instanceof wh||r.material instanceof Bc)&&r.material.color.set(i)})}objectVisibility(t,i){t&&(t.visible=i,t.traverse(r=>{i?(r.layers.enable(0),r.layers.disable(1)):(r.layers.disable(0),r.layers.enable(1))}))}getObjectPosition(t){const i=this.scene.getObjectByName(t);if(i)return i.position}removeGeometry(t){this.getGeometries().remove(t)}removeLabel(t){const i=this.scene.getObjectByName(t),r=this.getObjectsGroup(n.LABELS_ID);r&&i&&r.remove(i)}scaleObject(t,i){t.scale.setScalar(i)}addEventDataTypeGroup(t){const i=this.getEventData();let r=this.scene.getObjectByName(t);return r||(r=new Xl),r.name=t,i.add(r),r}collectionFilter(t,i){const r=this.getScene().getObjectByName(n.EVENT_DATA_ID);if(!r)return;const s=r.getObjectByName(t);if(s)for(const o of Object.values(s.children))if(o.userData)for(const l of i){const h=o.userData[l.field];if(h){if(!l.cutPassed(h)){o.visible=!1;break}o.visible=!0}}}groupVisibility(t,i,r){const s=r?this.scene.getObjectByName(r):this.scene;if(!s)return;const o=s.getObjectByName(t);if(o)for(const l of Object.values(o.children))l.visible=i}getObjectsGroup(t){let i=this.scene.getObjectByName(t);return null==i&&(i=new Xl,i.name=t,this.scene.add(i)),i}getEventData(){return this.getObjectsGroup(n.EVENT_DATA_ID)}getGeometries(){return this.getObjectsGroup(n.GEOMETRIES_ID)}clearEventData(){const t=this.getEventData();null!=t&&this.scene.remove(t),this.getEventData()}getText(t,i){const r=new Kye(t,{font:this.textFont,size:60,curveSegments:1,depth:1});return new jo(r,new wh({color:new nr(i)}))}setAxis(t,i=2e3,r=!0){if(null==this.axis){this.axis=new Xl;const s=new nr(14037811),o=new nr(3397171),l=new nr(3355606),h=new Bc({color:s}),u=new Bc({color:o}),f=new Bc({color:l});let y=[new Dt(-i,0,0),new Dt(i,0,0)],T=(new Hs).setFromPoints(y);const B=new yc(T,h);this.axis.add(B),y=[new Dt(0,-i,0),new Dt(0,i,0)],T=(new Hs).setFromPoints(y);const j=new yc(T,u);this.axis.add(j),y=[new Dt(0,0,-i),new Dt(0,0,i)],T=(new Hs).setFromPoints(y);const ne=new yc(T,f);this.axis.add(ne),this.axis.name="gridline",this.axis.traverse(se=>se.name="gridline"),this.scene.add(this.axis)}if(this.axis.visible=t,r&&null==this.axisLabels){this.axisLabels=new Xl;const s=["X [cm]","Y [cm]","Z [cm]"],o=[16711680,65280,255];let l=0;for(const h of s){const u=this.getText(h,new nr(o[l++]));this.axisLabels.add(u)}this.axisLabels.children[0].position.set(i+200,0,0),this.axisLabels.children[1].position.set(0,i+200,0),this.axisLabels.children[2].position.set(0,0,i+200),this.axisLabels.name="XYZ Labels",this.axisLabels.traverse(h=>h.name="XYZ Labels"),this.scene.add(this.axisLabels)}this.axisLabels.visible=t}createCartesianGrid(t=3e3){if(null==this.cartesianGrid){this.cartesianGrid=new Xl;const i=new nr(14037811),r=new nr(3397171),s=new nr(3355606),o=new cx({color:i,dashSize:.5,gapSize:.1,scale:.01}),l=new cx({color:r,dashSize:.5,gapSize:.1,scale:.01}),h=new cx({color:s,dashSize:.5,gapSize:.1,scale:.01});let u=new Xl;for(let T=-t;T<=t;T+=.1*t){u=new Xl;let B=[];for(let le=-t;le<=t;le+=.1*t)B.push(new Dt(-t,le,T)),B.push(new Dt(t,le,T));let j=(new Hs).setFromPoints(B);const ne=h;let se=new yc(j,ne);se.computeLineDistances(),u.add(se),B=[];for(let le=-t;le<=t;le+=.1*t)B.push(new Dt(le,-t,T)),B.push(new Dt(le,t,T));j=(new Hs).setFromPoints(B),se=new yc(j,ne),se.computeLineDistances(),u.add(se),this.cartesianGrid.add(u)}let f=new Xl;for(let T=-t;T<=t;T+=.1*t){f=new Xl;let B=[];for(let le=-t;le<=t;le+=.1*t)B.push(new Dt(T,le,-t)),B.push(new Dt(T,le,t));let j=(new Hs).setFromPoints(B);const ne=o;let se=new yc(j,ne);se.computeLineDistances(),f.add(se),B=[];for(let le=-t;le<=t;le+=.1*t)B.push(new Dt(T,-t,le)),B.push(new Dt(T,t,le));j=(new Hs).setFromPoints(B),se=new yc(j,ne),se.computeLineDistances(),f.add(se),this.cartesianGrid.add(f)}let y=new Xl;for(let T=-t;T<=t;T+=.1*t){y=new Xl;let B=[];for(let le=-t;le<=t;le+=.1*t)B.push(new Dt(le,T,-t)),B.push(new Dt(le,T,t));let j=(new Hs).setFromPoints(B);const ne=l;let se=new yc(j,ne);se.computeLineDistances(),y.add(se),B=[];for(let le=-t;le<=t;le+=.1*t)B.push(new Dt(-t,T,le)),B.push(new Dt(t,T,le));j=(new Hs).setFromPoints(B),se=new yc(j,ne),se.computeLineDistances(),y.add(se),this.cartesianGrid.add(y)}this.cartesianGrid.name="gridline",this.cartesianGrid.traverse(T=>T.name="gridline"),this.cartesianGrid.children.forEach(T=>T.visible=!1),this.scene.add(this.cartesianGrid)}}setCartesianGrid(t,i,r){this.createCartesianGrid(i);for(let h=0;h<=62;h+=1)this.cartesianGrid.children[h].visible=!1;typeof r>"u"?r=this.cartesianGridConfig:this.cartesianGridConfig=r;const s=[10,31,52],o=[r.zDistance,r.xDistance,r.yDistance],l=[r.showXY,r.showYZ,r.showZX];if(t)for(let h=0;h<3;h+=1)if(l[h]){for(let u=s[h];u>=s[h]-10*o[h]/i;u-=r.sparsity)this.cartesianGrid.children[u].visible=t;for(let u=s[h];u<=s[h]+10*o[h]/i;u+=r.sparsity)this.cartesianGrid.children[u].visible=t}}getCartesianGridConfig(){return this.cartesianGridConfig}eventDataDepthTest(t){const i=this.getEventData();null!==i&&i.traverse(r=>{r.material&&(r.renderOrder=t?0:999,r.material.depthTest=t)})}wireframeGeometries(t){this.getGeometries().traverse(r=>{r.material&&(r.material.wireframe=t,t?(r.material.transparent=!0,r.material.opacity=.1):(r.material.transparent=!1,r.material.opacity=1))})}wireframeObjects(t,i){t.traverse(r=>{r.material&&(r.material.wireframe=i)})}scaleJets(t){if(t<=0)return;const i=this.scene.getObjectByName("Jets");i&&i.traverse(r=>{if("Jet"===r.name){const s=r.scale.x;r.scale.setScalar(t),r.position.divideScalar(s).multiplyScalar(t)}})}scaleChildObjects(t,i,r){const s=this.scene.getObjectByName(t);s&&s.traverse(o=>{if(0===o.children.length)switch(r){case"x":o.scale.x=i;break;case"y":o.scale.y=i;break;case"z":o.scale.z=i;break;default:o.scale.setScalar(i)}})}addLabelToObject(t,i,r,s,o){const l=this.scene.getObjectByProperty("uuid",i);if(!l)return;l.userData.label=t;const h=this.getObjectsGroup(n.LABELS_ID),u=this.scene.getObjectByName(r);u&&h.remove(u);const f=this.getText(t,new nr("#a8a8a8"));f.position.fromArray(s.toArray()),f.name=r,h.add(f),o.removeEventListener("change",this.labelTextLookCallbacks[i]),this.labelTextLookCallbacks[i]=()=>{f.lookAt(o.object.position)},this.labelTextLookCallbacks[i](),o.addEventListener("change",this.labelTextLookCallbacks[i])}translateCartesianGrid(t){this.createCartesianGrid();const i=t.length(),r=t.normalize();this.cartesianGrid.translateOnAxis(r,i)}translateCartesianLabels(t){this.createCartesianLabels();const i=t.length(),r=t.normalize();this.cartesianLabels.translateOnAxis(r,i),this.axis.translateOnAxis(r,i),this.axisLabels.translateOnAxis(r,i)}createCartesianLabels(t=3e3){if(null==this.cartesianLabels){this.cartesianLabels=new Xl,this.cartesianLabels.name="XYZ Labels";const i=new nr(14037811),r=new nr(3397171),s=new nr(3355606),o=new wh({color:i,side:2}),l=new wh({color:r,side:2}),h=new wh({color:s,side:2});for(let u=-t;u<=t;u+=.1*t){const f=this.getText((u/10).toString(),i);f.position.set(u,40,0),this.axesNumbers.push(f),this.cartesianLabels.add(f);const y=new Tp(10,30,10);y.translate(u,0,0);const T=new jo(y,o);this.cartesianLabels.add(T)}for(let u=-t;u<=t;u+=.1*t){const f=this.getText((u/10).toString(),r);f.position.set(-40,u,0),this.axesNumbers.push(f),this.cartesianLabels.add(f);const y=new Tp(30,10,10);y.translate(0,u,0);const T=new jo(y,l);this.cartesianLabels.add(T)}for(let u=-t;u<=t;u+=.1*t){const f=this.getText((u/10).toString(),s);f.position.set(-40,0,u),this.axesNumbers.push(f),this.cartesianLabels.add(f);const y=new Tp(30,10,10);y.translate(0,0,u);const T=new jo(y,h);this.cartesianLabels.add(T)}this.cartesianLabels.traverse(u=>u.name="XYZ Labels"),this.scene.add(this.cartesianLabels),this.cartesianLabels.children.forEach(u=>u.visible=!1),this.setAxis(!1,3e3)}}alignText(t){null!=this.cartesianLabels&&this.axesNumbers.forEach(i=>{i.lookAt(t.position)}),null!=this.axisLabels&&this.axisLabels.children.forEach(i=>i.lookAt(t.position))}showLabels(t){this.createCartesianLabels(),this.setAxis(t,3e3),this.cartesianLabels.children.forEach(i=>i.visible=t)}setEtaPhiGrid(t,i=3e3){if(null==this.etaPhiGrid){this.etaPhiGrid=new Xl;let r=[];const s=i,o=new nr(255);for(let Ee=-3;Ee<=3;Ee+=1){r.push(new Dt(0,0,0));const Pe=jf.etaPhiToCartesian(s,Ee,Math.PI/2),Ve=this.getText("\u03b7="+Ee.toPrecision(2),o);Ve.position.set(Pe.x,Pe.y,Pe.z),Ve.rotateOnWorldAxis(new Dt(0,1,0),Math.PI/2),this.etaPhiGrid.add(Ve),r.push(Pe)}const l=(new Hs).setFromPoints(r),h=new cx({color:o,dashSize:2,gapSize:1,scale:.01}),u=new yc(l,h);u.computeLineDistances();const f=2*Math.PI/8,y=["-\u03c0","-3\u03c0/4","-\u03c0/2,","-\u03c0/4","0","\u03c0/4","\u03c0/2,","3\u03c0/4"];let T=0;const B=new nr(16711680);r=[];const j=.9*s;for(let Ee=-Math.PI;Ee<Math.PI;Ee+=f){r.push(new Dt(0,0,0));const Pe=jf.etaPhiToCartesian(j,0,Ee),Ve=this.getText("\u03c6="+y[T++],B);Ve.position.set(Pe.x,Pe.y,Pe.z),this.etaPhiGrid.add(Ve),r.push(Pe)}const ne=(new Hs).setFromPoints(r),se=new cx({color:B,dashSize:1,gapSize:1,scale:.01}),le=new yc(ne,se);le.computeLineDistances(),this.etaPhiGrid.add(u),this.etaPhiGrid.add(le),this.etaPhiGrid.name="gridline",this.etaPhiGrid.traverse(Ee=>Ee.name="gridline"),this.scene.add(this.etaPhiGrid)}this.etaPhiGrid.visible=t}getObjectByName(t){return this.scene.getObjectByName(t)||new Wa}}return n.EVENT_DATA_ID="EventData",n.GEOMETRIES_ID="Geometries",n.LABELS_ID="Labels",n})();class AW extends Hs{constructor(){super(),this.type="TracksMesh",this.positions=[],this.previous=[],this.next=[],this.side=[],this.counter=[],this.track_id=[],this.colors=[],this.indices_array=[],this.next_track_id=0}addTrack(e,t){const i=this.next_track_id++,r=new nr(t);this.previous.push(e[0].x,e[0].y,e[0].z),this.previous.push(e[0].x,e[0].y,e[0].z);for(let o=0;o<e.length;o++){const l=e[o],h=this.positions.length/3;this.positions.push(l.x,l.y,l.z),this.positions.push(l.x,l.y,l.z),this.side.push(1,-1),this.track_id.push(i,i),this.colors.push(r.r,r.g,r.b),this.colors.push(r.r,r.g,r.b),this.counter.push(o/e.length,o/e.length),o<e.length-1?(this.previous.push(l.x,l.y,l.z),this.previous.push(l.x,l.y,l.z),this.indices_array.push(h,h+1,h+2),this.indices_array.push(h+2,h+1,h+3)):o>0&&(this.next.push(l.x,l.y,l.z),this.next.push(l.x,l.y,l.z))}const s=e.length-1;return this.next.push(e[s].x,e[s].y,e[s].z),this.next.push(e[s].x,e[s].y,e[s].z),i}process(){this._attributes&&this._attributes.position.count===this.positions.length?(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.track_id.copyArray(new Int32Array(this.track_id)),this._attributes.track_id.needsUpdate=!0,this._attributes.color.copyArray(new Float32Array(this.colors)),this._attributes.color.needsUpdate=!0,this._attributes.counter.copyArray(new Float32Array(this.counter)),this._attributes.counter.needsUpdate=!0,this._attributes.index.copyArray(new Uint32Array(this.indices_array)),this._attributes.index.needsUpdate=!0):this._attributes={position:new To(new Float32Array(this.positions),3),previous:new To(new Float32Array(this.previous),3),next:new To(new Float32Array(this.next),3),side:new To(new Float32Array(this.side),1),track_id:new To(new Int32Array(this.track_id),1),color:new To(new Float32Array(this.colors),3),counter:new To(new Float32Array(this.counter),1),index:new To(new Uint32Array(this.indices_array),1)},this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("track_id",this._attributes.track_id),this.setAttribute("color",this._attributes.color),this.setAttribute("counter",this._attributes.counter),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()}}const gW=["attribute vec3 previous;","attribute vec3 next;","attribute int track_id;","attribute float side;","attribute vec3 color;","attribute float counter;","varying vec3 v_color;","varying float v_counter;","flat varying int v_track_id;","uniform vec2 resolution;","uniform float lineWidth;","void main() {","  vec2 aspect = vec2(resolution.x / resolution.y, 1.0);","","  v_color = color;","  v_counter = counter;","  v_track_id = track_id;","","  mat4 m = projectionMatrix * modelViewMatrix;","  vec4 finalPosition = m * vec4(position, 1.0);","  vec4 prevPos = m * vec4(previous, 1.0);","  vec4 nextPos = m * vec4(next, 1.0);","","  vec2 curP = finalPosition.xy / finalPosition.w * aspect;","  vec2 prevP = prevPos.xy / prevPos.w * aspect;","  vec2 nextP = nextPos.xy / nextPos.w * aspect;","","  vec2 dir;","  if (curP == prevP) dir = normalize(nextP - curP);","  else if (curP == nextP) dir = normalize(curP - prevP);","  else dir = normalize(curP - prevP);","","  vec2 normal = vec2(-dir.y, dir.x);","  normal.xy *= .5 * lineWidth;","  normal.x /= aspect.x;","  normal.xy *= finalPosition.w * 0.001;","  finalPosition.xy += normal.xy * side;","  gl_Position = finalPosition;","}"].join("\n");["uniform float progress;","varying vec3 v_color;","varying float v_counter;","flat varying int v_track_id;","void main() {","  if (v_counter > progress) discard;","  gl_FragColor = vec4(v_color, 1.0);","}"].join("\n");class t1e extends Ou{constructor(e){super({uniforms:Object.assign({},{lineWidth:{value:1},resolution:{value:new Fi(1,1)},progress:{value:1}}),vertexShader:gW,fragmentShader:gW}),this.isTracksMaterial=!0,this.type="TracksMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(t){this.uniforms.lineWidth.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},progress:{enumerable:!0,get:function(){return this.uniforms.progress.value},set:function(t){this.uniforms.progress.value=t}}}),this.setValues(e)}}class n1e{constructor(e,t,i){this.scene=e,this.activeCamera=t,this.rendererManager=i,this.animateEvent=this.animateEvent.bind(this),this.animateEventWithClipping=this.animateEventWithClipping.bind(this)}getCameraTween(e,t=1e3,i){const r=new zf(this.activeCamera.position).to({x:e[0],y:e[1],z:e[2]},t);return i&&r.easing(i),r}animateThroughEvent(e,t,i){const r=this.getCameraTween(e,1e3,Dg.Cubic.Out),o=this.getCameraTween([0,0,e[2]],t),f=3*Math.PI/24,y=[];for(let Pe=1;Pe<=24;Pe++)y.push([500*Math.sin(f*Pe),0,500*Math.cos(f*Pe)]);const T=this.getCameraTween([0,0,500],t,Dg.Cubic.Out);let B=T;const ne=4*t/24;for(const Pe of y){const Ve=this.getCameraTween(Pe,ne);B.chain(Ve),B=Ve}const le=this.getCameraTween([0,0,-e[2]],t,Dg.Cubic.In),Ee=this.getCameraTween(e,t,Dg.Cubic.Out);Ee.onComplete(()=>i?.()),Ee.delay(500),r.chain(o),o.chain(T),B.chain(le),le.chain(Ee),r.start()}animateEvent(e,t,i){const r=.25*e;e*=.75;const s=this.scene.getObjectByName(el.EVENT_DATA_ID);if(!s)return;const o=new sd(new Dt,0),l=[],h=[];s.traverse(T=>{if(T.geometry)if("Track"===T.name||"LineHit"===T.name){let B=T.geometry?.attributes?.position?.count;if(B)if(T.geometry instanceof lx&&(B*=6),T.geometry instanceof AW){T.material.progress=0;const j=new zf(T.material).to({progress:1},e);j.onComplete(()=>{T.material.progress=1}),h.push(j)}else if(T.geometry instanceof Hs){const j=T.geometry.drawRange.count;T.geometry.setDrawRange(0,0);const ne=new zf(T.geometry.drawRange).to({count:B},e);ne.onComplete(()=>{T.geometry.drawRange.count=j}),h.push(ne)}}else if("Jet"===T.name){const B=new zf({x:.01,y:.01,z:.01}).to({x:T.scale.x,y:T.scale.y,z:T.scale.z},e);B.onUpdate(j=>{const ne=T.scale.x;T.scale.setScalar(j.x),T.position.divideScalar(ne).multiplyScalar(j.x)}),h.push(B)}else{let j=T.position.equals(new Dt(0,0,0))?T.geometry.boundingSphere.center:T.position;"Hit"===T.name?(j=Array.from(T.geometry.attributes.position.array),T.geometry.deleteAttribute("position"),T.geometry.computeBoundingSphere()):T.visible=!1,l.push({eventObject:T,position:j})}});const u=new zf(o).to({radius:3e3},e),f=T=>{l.forEach(B=>{if("Hit"===B.eventObject.name){const j=B.eventObject.geometry,se=this.getHitsPositions(B.position).filter(le=>T.containsPoint((new Dt).fromArray(le)));se.length>0&&(j.setAttribute("position",new To(new Float32Array([...se].flat()),3)),j.computeBoundingSphere())}else T.containsPoint(B.position)&&(B.eventObject.visible=!0)})};u.onUpdate(f);const y=new zf(o).to({radius:1e4},r);y.onUpdate(f),u.chain(y),h.push(u),h[0].onStart(()=>i?.());for(const T of h)T.easing(Dg.Quartic.Out).start();y.onComplete(()=>{f(new sd(new Dt,1/0)),t?.()})}animateEventWithClipping(e,t,i,r=11e3){const s=this.scene.getObjectByName(el.EVENT_DATA_ID);if(!s)return;const o=new ev(1,8,8),l=[],h=o.attributes.position,u=new Dt;for(let T=0;T<h.count;T++)u.fromBufferAttribute(h,T),l.push(new MA(u.clone(),0));const f=this.rendererManager.getMainRenderer().localClippingEnabled;f||this.rendererManager.setLocalClippingEnabled(!0),s.traverse(T=>{T.geometry&&T.material&&(T.material.clippingPlanes=l)});const y=[];for(const T of l){T.constant=0;const B=new zf(T).to({constant:r},e);y.push(B)}y[0].onStart(()=>i?.());for(const T of y)T.start();y[y.length-1].onComplete(()=>{f||(this.rendererManager.getMainRenderer().localClippingEnabled=f),s.traverse(T=>{T.geometry&&T.material&&(T.material.clippingPlanes=null)}),t?.()})}collideParticles(e,t=10,i=5e3,r=new nr(16777215),s){const o=new ev(t,32,32),l=new wh({color:r,transparent:!0,opacity:0}),h=new jo(o,l),u=h.clone();h.position.setZ(i),u.position.setZ(-i);const f=[h,u];this.scene.add(...f);const y=[];for(const T of f){new zf(T.material).to({opacity:1},300).start();const B=new zf(T.position).to({z:0},e).start();y.push(B)}y[0].onComplete(()=>{this.scene.remove(...f),s?.()})}animateWithCollision(e,t,i){const r=this.scene.getObjectByName(el.EVENT_DATA_ID);if(!r)return;const s=r.getObjectByName("Track");let o;o=s instanceof Xl?s.children[0]?.material?.color:s?.material.color,r&&(r.visible=!1),this.collideParticles(1500,30,5e3,o,()=>{e(t,i,()=>{r&&(r.visible=!0)})})}animateEventWithCollision(e,t){this.animateWithCollision(this.animateEvent,e,t)}animateClippingWithCollision(e,t){this.animateWithCollision(this.animateEventWithClipping,e,t)}getHitsPositions(e){const t=[];for(let i=0;i<e.length;i+=3)t.push(e.slice(i,i+3));return t}animatePreset(e,t){const{positions:i,animateEventAfterInterval:r,collisionDuration:s}=e;if(r&&s){const h=this.scene.getObjectByName(el.EVENT_DATA_ID);h&&(h.visible=!1),setTimeout(()=>{this.animateEventWithCollision(s)},r)}const o=this.getCameraTween(i[0].position,i[0].duration??2e3,i[0].easing);let l=o;i.slice(1).forEach(({position:h,duration:u,easing:f})=>{const y=this.getCameraTween(h,u??2e3,f);l.chain(y),l=y}),l.onComplete(t),o.start()}}const _W={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}"};class rT{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const i1e=new Jb(-1,1,1,-1,0,1),s1e=new class r1e extends Hs{constructor(){super(),this.setAttribute("position",new Bs([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Bs([0,2,0,0,2,0],2))}};class yW{constructor(e){this._mesh=new jo(s1e,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,i1e)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class o1e extends rT{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Ou?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=u5.clone(e.uniforms),this.material=new Ou({name:void 0!==e.name?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new yW(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class vW extends rT{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const r=e.getContext(),s=e.state;let o,l;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(o=0,l=1):(o=1,l=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(l),s.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class a1e extends rT{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class l1e{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),void 0===t){const i=e.getSize(new Fi);this._width=i.width,this._height=i.height,(t=new rd(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:wA})).texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new o1e(_W),this.copyPass.material.blending=0,this.clock=new Ej}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let r=0,s=this.passes.length;r<s;r++){const o=this.passes[r];if(!1!==o.enabled){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),o.needsSwap){if(i){const l=this.renderer.getContext(),h=this.renderer.state.buffers.stencil;h.setFunc(l.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),h.setFunc(l.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==vW&&(o instanceof vW?i=!0:o instanceof a1e&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new Fi);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(i,r),this.renderTarget2.setSize(i,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(i,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class c1e extends rT{constructor(e,t,i=null,r=null,s=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=r,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new nr}render(e,t,i){const r=e.autoClear;let s,o;e.autoClear=!1,null!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),null!==this.clearColor&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),null!==this.clearAlpha&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),1==this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),!0===this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),null!==this.clearColor&&e.setClearColor(this._oldClearColor),null!==this.clearAlpha&&e.setClearAlpha(s),null!==this.overrideMaterial&&(this.scene.overrideMaterial=o),e.autoClear=r}}class sv extends rT{constructor(e,t,i,r){super(),this.renderScene=t,this.renderCamera=i,this.selectedObjects=void 0!==r?r:[],this.visibleEdgeColor=new nr(1,1,1),this.hiddenEdgeColor=new nr(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this._selectionCache=new Set,this.resolution=void 0!==e?new Fi(e.x,e.y):new Fi(256,256);const s=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new rd(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new x5,this.depthMaterial.side=2,this.depthMaterial.depthPacking=3201,this.depthMaterial.blending=0,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=2,this.prepareMaskMaterial.fragmentShader=function f(y,T){return y.replace(/DEPTH_TO_VIEW_Z/g,(T.isPerspectiveCamera?"perspective":"orthographic")+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new rd(this.resolution.x,this.resolution.y,{type:wA}),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new rd(s,o,{type:wA}),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new rd(s,o,{type:wA}),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new rd(Math.round(s/2),Math.round(o/2),{type:wA}),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new rd(s,o,{type:wA}),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new rd(Math.round(s/2),Math.round(o/2),{type:wA}),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1,this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value.set(s,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(s/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial();const u=_W;this.copyUniforms=u5.clone(u.uniforms),this.materialCopy=new Ou({uniforms:this.copyUniforms,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:0,depthTest:!1,depthWrite:!1}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new nr,this.oldClearAlpha=1,this.fsQuad=new yW(null),this.tempPulseColor1=new nr,this.tempPulseColor2=new nr,this.textureMatrix=new go}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose(),this.depthMaterial.dispose(),this.prepareMaskMaterial.dispose(),this.edgeDetectionMaterial.dispose(),this.separableBlurMaterial1.dispose(),this.separableBlurMaterial2.dispose(),this.overlayMaterial.dispose(),this.materialCopy.dispose(),this.fsQuad.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let i=Math.round(e/this.downSampleRatio),r=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(i,r),this.renderTargetBlurBuffer1.setSize(i,r),this.renderTargetEdgeBuffer1.setSize(i,r),this.separableBlurMaterial1.uniforms.texSize.value.set(i,r),i=Math.round(i/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(i,r),this.renderTargetEdgeBuffer2.setSize(i,r),this.separableBlurMaterial2.uniforms.texSize.value.set(i,r)}updateSelectionCache(){const e=this._selectionCache;function t(i){i.isMesh&&e.add(i)}e.clear();for(let i=0;i<this.selectedObjects.length;i++)this.selectedObjects[i].traverse(t)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;for(const i of this._selectionCache)!0===e?i.visible=t.get(i):(t.set(i,i.visible),i.visible=e)}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,i=this._selectionCache;this.renderScene.traverse(function r(s){if(s.isMesh||s.isSprite){if(!i.has(s)){const o=s.visible;(!1===e||!0===t.get(s))&&(s.visible=e),t.set(s,o)}}else(s.isPoints||s.isLine)&&(!0===e?s.visible=t.get(s):(t.set(s,s.visible),s.visible=e))})}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,i,r,s){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,s&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.updateSelectionCache(),this.changeVisibilityOfSelectedObjects(!1);const l=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this._selectionCache.clear(),this.renderScene.background=l,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const h=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(h),this.tempPulseColor2.multiplyScalar(h)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=sv.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=sv.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=sv.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=sv.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(i),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=i.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new Ou({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new Fi(.5,.5)},textureMatrix:{value:null}},vertexShader:"#include <morphtarget_pars_vertex>\n\t\t\t\t#include <skinning_pars_vertex>\n\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tuniform mat4 textureMatrix;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <morphtarget_vertex>\n\t\t\t\t\t#include <skinning_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t\tvPosition = mvPosition;\n\n\t\t\t\t\tvec4 worldPosition = vec4( transformed, 1.0 );\n\n\t\t\t\t\t#ifdef USE_INSTANCING\n\n\t\t\t\t\t\tworldPosition = instanceMatrix * worldPosition;\n\n\t\t\t\t\t#endif\n\n\t\t\t\t\tworldPosition = modelMatrix * worldPosition;\n\n\t\t\t\t\tprojTexCoord = textureMatrix * worldPosition;\n\n\t\t\t\t}",fragmentShader:"#include <packing>\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tuniform sampler2D depthTexture;\n\t\t\t\tuniform vec2 cameraNearFar;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));\n\t\t\t\t\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );\n\t\t\t\t\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;\n\t\t\t\t\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);\n\n\t\t\t\t}"})}getEdgeDetectionMaterial(){return new Ou({uniforms:{maskTexture:{value:null},texSize:{value:new Fi(.5,.5)},visibleEdgeColor:{value:new Dt(1,1,1)},hiddenEdgeColor:{value:new Dt(1,1,1)}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec3 visibleEdgeColor;\n\t\t\t\tuniform vec3 hiddenEdgeColor;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\n\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\n\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\n\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\n\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\n\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\n\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\n\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\n\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\n\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\n\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\n\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\n\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\n\t\t\t\t}"})}getSeperableBlurMaterial(e){return new Ou({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new Fi(.5,.5)},direction:{value:new Fi(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float kernelRadius;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat sigma = kernelRadius/2.0;\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, sigma);\n\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\n\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\n\t\t\t\t\tvec2 uvOffset = delta;\n\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = kernelRadius * float(i) / float(MAX_RADIUS);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, sigma);\n\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\n\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\n\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\n\t\t\t\t\t\tweightSum += (2.0 * w);\n\t\t\t\t\t\tuvOffset += delta;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\n\t\t\t\t}"})}getOverlayMaterial(){return new Ou({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform sampler2D edgeTexture1;\n\t\t\t\tuniform sampler2D edgeTexture2;\n\t\t\t\tuniform sampler2D patternTexture;\n\t\t\t\tuniform float edgeStrength;\n\t\t\t\tuniform float edgeGlow;\n\t\t\t\tuniform bool usePatternTexture;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\n\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\n\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\n\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\n\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\n\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\n\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\n\t\t\t\t\tif(usePatternTexture)\n\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\n\t\t\t\t\tgl_FragColor = finalColor;\n\t\t\t\t}",blending:2,depthTest:!1,depthWrite:!1,transparent:!0})}}sv.BlurDirectionX=new Fi(1,0),sv.BlurDirectionY=new Fi(0,1);class h1e{constructor(e,t,i){this.antialiasing=!0,this.composer=new l1e(i),this.camera=e,this.scene=t,this.defaultRenderPass=new c1e(this.scene,this.camera),this.composer.addPass(this.defaultRenderPass),this.render=this.antialiasing?this.antialiasRender:this.effectsRender}effectsRender(e,t){this.composer&&(this.defaultRenderPass.camera=t,this.defaultRenderPass.scene=e,this.composer.render())}antialiasRender(e,t){this.composer.renderer.render(e,t)}addOutlinePassForSelection(){const e=new sv(new Fi(window.innerWidth,window.innerHeight),this.scene,this.camera);return e.overlayMaterial.blending=1,e.visibleEdgeColor.set(16777062),e.visibleEdgeColor.set(14635824),this.composer.addPass(e),e}removePass(e){const t=this.composer.passes.indexOf(e);this.composer.passes.splice(t,1)}setAntialiasing(e){this.antialiasing=e,this.render=this.antialiasing?this.antialiasRender:this.effectsRender}}class TA{constructor(){return this.clippingEnabled=new WC(!1),this.startClippingAngle=new WC(0),this.openingClippingAngle=new WC(0),this.eventMetadata={runNumber:"000",eventNumber:"000"},void 0===TA.instance&&(TA.instance=this),TA.instance}static getInstance(){return TA.instance}setPhoenixMenuRoot(e){this.phoenixMenuRoot=e,this.phoenixMenuRoot&&this.phoenixMenuRoot.addConfig("button",{label:"Save state",onClick:()=>{this.saveStateAsJSON()}}).addConfig("button",{label:"Load state",onClick:()=>{tW(t=>{this.loadStateFromJSON(JSON.parse(t))})}})}saveStateAsJSON(){const e={phoenixMenu:this.phoenixMenuRoot.getNodeState(),eventDisplay:{cameraPosition:this.activeCamera.position.toArray(),startClippingAngle:this.clippingEnabled.value?this.startClippingAngle.value:null,openingClippingAngle:this.clippingEnabled.value?this.openingClippingAngle.value:null}};_B(JSON.stringify(e),`run${this.eventMetadata.runNumber}_evt${this.eventMetadata.eventNumber}.json`)}loadStateFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t.phoenixMenu&&this.phoenixMenuRoot&&(console.log("StateManager: Processing phoenixMenu configuration"),this.phoenixMenuRoot.loadStateFromJSON(t.phoenixMenu),this.phoenixMenuRoot.configActive=!1),t.eventDisplay){console.log("StateManager: Processing eventDisplay configuration"),this.activeCamera.position.fromArray(t.eventDisplay?.cameraPosition);const i=t.eventDisplay?.startClippingAngle,r=t.eventDisplay?.openingClippingAngle;(i||r)&&(this.setClippingEnabled(!0),this.eventDisplay.getUIManager().setClipping(!0),i&&this.eventDisplay.getUIManager().rotateStartAngleClipping(t.eventDisplay.startClippingAngle),r&&this.eventDisplay.getUIManager().rotateOpeningAngleClipping(t.eventDisplay.openingClippingAngle))}}setClippingEnabled(e){this.clippingEnabled.update(e)}setStartClippingAngle(e){this.startClippingAngle.update(e)}getStartClippingAngle(){return this.startClippingAngle.value??0}setOpeningClippingAngle(e){this.openingClippingAngle.update(e)}getOpeningClippingAngle(){return this.openingClippingAngle.value??0}setCamera(e){this.activeCamera=e}setEventDisplay(e){this.eventDisplay=e}}class yx{constructor(){return this.toLoad=[],this.loaded=[],this.onLoadCallbacks=[],this.onProgressCallbacks=[],this.progressItems={},void 0===yx.instance&&(yx.instance=this),yx.instance}addLoadableItem(e=""){this.toLoad.push(e),this.progressItems[e]=0}itemLoaded(e=""){this.loaded.push(e),this.onProgress(e,100),this.toLoad.length===this.loaded.length&&this.toLoad.sort().join(",")===this.loaded.sort().join(",")&&(this.onLoadCallbacks.forEach(t=>t()),this.reset())}onProgress(e,t){this.progressItems[e]=t;const s=Object.values(this.progressItems).reduce((o,l)=>o+l,0)/Object.keys(this.progressItems).length;for(const o of this.onProgressCallbacks)o(s)}addLoadListener(e){this.onLoadCallbacks.push(e)}addLoadListenerWithCheck(e){this.toLoad.length>0&&this.toLoad.length!==this.loaded.length?this.onLoadCallbacks.push(e):e()}addProgressListener(e){this.onProgressCallbacks.push(e)}reset(){this.toLoad=[],this.loaded=[],this.onLoadCallbacks=[],this.onProgressCallbacks=[],this.progressItems={}}}class u1e{constructor(e){this.sceneManager=e}colorObjectsByProperty(e,t,i){const r=this.sceneManager.getScene().getObjectByName(t);r&&r.traverse(s=>{s.material?.color&&i(s.userData)&&s.material.color.set(e)})}collectionColor(e,t){const r=this.sceneManager.getScene().getObjectByName(el.EVENT_DATA_ID)?.getObjectByName(e);if(r)for(const s of Object.values(r.children))s.traverse(o=>{PL(o,t)})}collectionColorRandom(e){if(!this.sceneManager||!this.sceneManager.getScene())return;const t=this.sceneManager.getScene();if(t){const r=t.getObjectByName(el.EVENT_DATA_ID)?.getObjectByName(e);if(r)for(const s of Object.values(r.children))s.traverse(o=>{PL(o,16777215*Math.random())})}}colorTracksByVertex(e){const t=this.sceneManager.getScene(),i=t.getObjectByName("Vertices");i&&i.traverse(r=>{const{linkedTrackCollection:s,linkedTracks:o}=r.userData;if("Vertex"===r.name&&s===e&&o){const l=r.material;if("color"in l){const h=l.color,u=t.getObjectByName(s);u&&o.forEach(f=>{u.children[f].traverse(y=>{PL(y,h)})})}}})}}function PL(n,e){if(n instanceof jo){const i=n.material;Array.isArray(i)?i.forEach(r=>{r?.color?.set(e)}):"color"in i&&i.color.set(e)}}var Mm=function(n){return n.VR="VR",n.AR="AR",n}(Mm||{});class bW{constructor(e){this.sessionType=e,this.xrActive=!1,this.currentXRSession=null}setXRSession(e,t,i){this.renderer=e,i&&(this.onSessionEnded=i);const r=navigator?.xr,s=this.sessionType===Mm.VR?"vr":"ar";r?.requestSession(`immersive-${s}`,this.sessionInit?.()).then(o=>{this.onXRSessionStarted.bind(this)(o),t?.()}).catch(o=>{console.error(`${s.toUpperCase()} Error:`,o)})}onXRSessionStarted(e){var t=this;return(0,al.A)(function*(){t.xrActive=!0,e.addEventListener("end",t.onXRSessionEnded.bind(t)),yield t.renderer.xr.setSession(e),t.currentXRSession=e})()}onXRSessionEnded(){this.xrActive=!1,this.currentXRSession.removeEventListener("end",this.onXRSessionEnded),this.currentXRSession=null,this.cameraGroup=void 0,this.onSessionEnded?.()}endXRSession(){this.currentXRSession?.end()}getCameraGroup(e){if(this.cameraGroup||(this.cameraGroup=new Xl),e&&this.xrActive){this.xrCamera=this.renderer.xr.getCamera().copy(new CQ([e.clone()])),this.xrCamera.name="XR_CAMERA";const t=this.sessionType===Mm.VR?this.xrCamera.position:new Dt(0,0,.1);this.cameraGroup.position.copy(t),this.cameraGroup.add(this.xrCamera)}return this.cameraGroup}getXRCamera(){return this.xrCamera}}const Mh={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};function xW(n){return RL.apply(this,arguments)}function RL(){return(RL=(0,al.A)(function*(n){const e=yield fetch(n);if(e.ok)return e.json();throw new Error(e.statusText)})).apply(this,arguments)}function kL(){return(kL=(0,al.A)(function*(n){if(!n)throw new Error("No basePath supplied");return yield xW(`${n}/profilesList.json`)})).apply(this,arguments)}function FL(){return FL=(0,al.A)(function*(n,e,t=null,i=!0){if(!n)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No basePath supplied");const r=yield function d1e(n){return kL.apply(this,arguments)}(e);let s;if(n.profiles.some(h=>{const u=r[h];return u&&(s={profileId:h,profilePath:`${e}/${u.path}`,deprecated:!!u.deprecated}),!!s}),!s){if(!t)throw new Error("No matching profile name found");const h=r[t];if(!h)throw new Error(`No matching profile name found and default profile "${t}" missing.`);s={profileId:t,profilePath:`${e}/${h.path}`,deprecated:!!h.deprecated}}const o=yield xW(s.profilePath);let l;if(i){let h;if(h="any"===n.handedness?o.layouts[Object.keys(o.layouts)[0]]:o.layouts[n.handedness],!h)throw new Error(`No matching handedness, ${n.handedness}, in profile ${s.profileId}`);h.assetPath&&(l=s.profilePath.replace("profile.json",h.assetPath))}return{profile:o,assetPath:l}}),FL.apply(this,arguments)}const p1e={xAxis:0,yAxis:0,button:0,state:Mh.ComponentState.DEFAULT};class A1e{constructor(e){this.componentProperty=e.componentProperty,this.states=e.states,this.valueNodeName=e.valueNodeName,this.valueNodeProperty=e.valueNodeProperty,this.valueNodeProperty===Mh.VisualResponseProperty.TRANSFORM&&(this.minNodeName=e.minNodeName,this.maxNodeName=e.maxNodeName),this.value=0,this.updateFromComponent(p1e)}updateFromComponent({xAxis:e,yAxis:t,button:i,state:r}){const{normalizedXAxis:s,normalizedYAxis:o}=function m1e(n=0,e=0){let t=n,i=e;if(Math.sqrt(n*n+e*e)>1){const o=Math.atan2(e,n);t=Math.cos(o),i=Math.sin(o)}return{normalizedXAxis:.5*t+.5,normalizedYAxis:.5*i+.5}}(e,t);switch(this.componentProperty){case Mh.ComponentProperty.X_AXIS:this.value=this.states.includes(r)?s:.5;break;case Mh.ComponentProperty.Y_AXIS:this.value=this.states.includes(r)?o:.5;break;case Mh.ComponentProperty.BUTTON:this.value=this.states.includes(r)?i:0;break;case Mh.ComponentProperty.STATE:this.value=this.valueNodeProperty===Mh.VisualResponseProperty.VISIBILITY?this.states.includes(r):this.states.includes(r)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class g1e{constructor(e,t){if(!(e&&t&&t.visualResponses&&t.gamepadIndices&&0!==Object.keys(t.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=e,this.type=t.type,this.rootNodeName=t.rootNodeName,this.touchPointNodeName=t.touchPointNodeName,this.visualResponses={},Object.keys(t.visualResponses).forEach(i=>{const r=new A1e(t.visualResponses[i]);this.visualResponses[i]=r}),this.gamepadIndices=Object.assign({},t.gamepadIndices),this.values={state:Mh.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(e){if(this.values.state=Mh.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&e.buttons.length>this.gamepadIndices.button){const t=e.buttons[this.gamepadIndices.button];this.values.button=t.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,t.pressed||1===this.values.button?this.values.state=Mh.ComponentState.PRESSED:(t.touched||this.values.button>Mh.ButtonTouchThreshold)&&(this.values.state=Mh.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&e.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=e.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===Mh.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>Mh.AxisTouchThreshold&&(this.values.state=Mh.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&e.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=e.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===Mh.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>Mh.AxisTouchThreshold&&(this.values.state=Mh.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach(t=>{t.updateFromComponent(this.values)})}}class _1e{constructor(e,t,i){if(!e)throw new Error("No xrInputSource supplied");if(!t)throw new Error("No profile supplied");this.xrInputSource=e,this.assetUrl=i,this.id=t.profileId,this.layoutDescription=t.layouts[e.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach(r=>{this.components[r]=new g1e(r,this.layoutDescription.components[r])}),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const e=[];return Object.values(this.components).forEach(t=>{e.push(t.data)}),e}updateFromGamepad(){Object.values(this.components).forEach(e=>{e.updateFromGamepad(this.xrInputSource.gamepad)})}}class b1e extends Wa{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(e){return this.envMap==e||(this.envMap=e,this.traverse(t=>{t.isMesh&&(t.material.envMap=this.envMap,t.material.needsUpdate=!0)})),this}updateMatrixWorld(e){super.updateMatrixWorld(e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach(t=>{Object.values(t.visualResponses).forEach(i=>{const{valueNode:r,minNode:s,maxNode:o,value:l,valueNodeProperty:h}=i;r&&(h===Mh.VisualResponseProperty.VISIBILITY?r.visible=l:h===Mh.VisualResponseProperty.TRANSFORM&&(r.quaternion.slerpQuaternions(s.quaternion,o.quaternion,l),r.position.lerpVectors(s.position,o.position,l)))})}))}}function wW(n,e){(function x1e(n,e){Object.values(n.components).forEach(t=>{const{type:i,touchPointNodeName:r,visualResponses:s}=t;if(i===Mh.ComponentType.TOUCHPAD)if(t.touchPointNode=e.getObjectByName(r),t.touchPointNode){const o=new ev(.001),l=new wh({color:255}),h=new jo(o,l);t.touchPointNode.add(h)}else console.warn(`Could not find touch dot, ${t.touchPointNodeName}, in touchpad component ${t.id}`);Object.values(s).forEach(o=>{const{valueNodeName:l,minNodeName:h,maxNodeName:u,valueNodeProperty:f}=o;if(f===Mh.VisualResponseProperty.TRANSFORM){if(o.minNode=e.getObjectByName(h),o.maxNode=e.getObjectByName(u),!o.minNode)return void console.warn(`Could not find ${h} in the model`);if(!o.maxNode)return void console.warn(`Could not find ${u} in the model`)}o.valueNode=e.getObjectByName(l),o.valueNode||console.warn(`Could not find ${l} in the model`)})})})(n.motionController,e),n.envMap&&e.traverse(t=>{t.isMesh&&(t.material.envMap=n.envMap,t.material.needsUpdate=!0)}),n.add(e)}class w1e{constructor(e=null,t=null){this.gltfLoader=e,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.onLoad=t,this.gltfLoader||(this.gltfLoader=new vB)}setPath(e){return this.path=e,this}createControllerModel(e){const t=new b1e;let i=null;return e.addEventListener("connected",r=>{const s=r.data;"tracked-pointer"!==s.targetRayMode||!s.gamepad||function f1e(n,e){return FL.apply(this,arguments)}(s,this.path,"generic-trigger").then(({profile:o,assetPath:l})=>{t.motionController=new _1e(s,o,l);const h=this._assetCache[t.motionController.assetUrl];if(h)i=h.scene.clone(),wW(t,i),this.onLoad&&this.onLoad(i);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(t.motionController.assetUrl,u=>{this._assetCache[t.motionController.assetUrl]=u,i=u.scene.clone(),wW(t,i),this.onLoad&&this.onLoad(i)},null,()=>{throw new Error(`Asset ${t.motionController.assetUrl} missing or malformed.`)})}}).catch(o=>{console.warn(o)})}),e.addEventListener("disconnected",()=>{t.motionController=null,t.remove(i),i=null}),t}}let CW=(()=>{class n extends bW{constructor(){super(Mm.VR),this.sessionInit=()=>({optionalFeatures:["local-floor","bounded-floor","hand-tracking"]})}setXRSession(t,i,r){super.setXRSession(t,i,r),this.setupVRControls()}onXRSessionEnded(){super.onXRSessionEnded(),this.controller1?.removeEventListener("selectstart",this.onControllerSelectStart),this.controller1?.removeEventListener("selectend",this.onControllerSelectEnd)}setupVRControls(){this.controller1=this.renderer.xr.getController(0),this.getCameraGroup().add(this.controller1),this.controller2=this.renderer.xr.getController(1),this.getCameraGroup().add(this.controller2);const t=new w1e;this.controllerGrip1=this.renderer.xr.getControllerGrip(0),this.controllerGrip1.add(t.createControllerModel(this.controllerGrip1)),this.getCameraGroup().add(this.controllerGrip1),this.controllerGrip2=this.renderer.xr.getControllerGrip(1),this.controllerGrip2.add(t.createControllerModel(this.controllerGrip2)),this.getCameraGroup().add(this.controllerGrip2);const i=(new Hs).setFromPoints([new Dt(0,0,0),new Dt(0,0,-1)]),r=new kg(i);r.name="line",r.scale.z=50,this.controller1.add(r.clone()),this.controller2.add(r.clone());const o=new Dt;let l;this.onControllerSelectStart=()=>{console.log("Select: c1 position "+this.controller1.position.toArray().join(", ")),console.log("Select: CG position "+this.cameraGroup?.position.toArray().join(", ")),l=setInterval(()=>{this.moveInDirection(o,30)},20)},this.onControllerSelectEnd=()=>{clearInterval(l)},this.controller1.addEventListener("selectstart",this.onControllerSelectStart),this.controller1.addEventListener("selectend",this.onControllerSelectEnd)}moveInDirection(t,i){this.xrCamera?.getWorldDirection(t),this.cameraGroup?.position.addScaledVector(t,i),this.xrCamera.position.addScaledVector(t,i)}}return n.SESSION_TYPE="immersive-vr",n})(),OL=(()=>{class n extends bW{constructor(t,i){super(Mm.AR),this.scene=t,this.camera=i,this.previousValues={sceneScale:1,cameraNear:10},this.previousValues.sceneScale=t.scale.x,this.previousValues.cameraNear=i.near,this.sessionInit=()=>n.enableDomOverlay?{optionalFeatures:["dom-overlay"],domOverlay:{root:document.body}}:{}}onXRSessionStarted(t){var i=()=>super.onXRSessionStarted,r=this;return(0,al.A)(function*(){document.body.style.setProperty("background-color","transparent"),r.previousValues.sceneScale=r.scene.scale.x,r.previousValues.cameraNear=r.camera.near,r.scaleScene(1e-5),r.camera.near=.01,r.renderer.xr.setReferenceSpaceType("local"),yield i().call(r,t)})()}onXRSessionEnded(){document.body.style.removeProperty("background-color"),this.scaleScene(this.previousValues.sceneScale),this.camera.near=this.previousValues.cameraNear,super.onXRSessionEnded()}scaleScene(t){[el.EVENT_DATA_ID,el.GEOMETRIES_ID,el.LABELS_ID].forEach(i=>{this.scene.getObjectByName(i)?.scale.setScalar(t)})}}return n.SESSION_TYPE="immersive-ar",n.enableDomOverlay=!0,n})();!function(){const n=Wa.prototype.updateMatrixWorld;Wa.prototype.updateMatrixWorld=function(){this.visible&&n.apply(this)}}();class C1e{constructor(e){this.infoLogger=e,this.origin=new Dt(0,0,0),this.ignoreList=[(new lB).type,(new qC).type,(new qj).type],this.prev3DCoord=new Dt,this.prevIntersectName="",this.distanceCanvas=document.createElement("canvas"),this.displayColor="black",this.originChanged=new os,this.shiftGrid=!1,this.stopShifting=new os,this.saveBlob=function(){const t=document.createElement("a");return document.body.appendChild(t),t.style.display="none",function(r,s){const o=window.URL.createObjectURL(r);t.href=o,t.download=s,t.click()}}(),this.rendererManager=new O_e,this.loadingManager=new yx}init(e){this.clipPlanes=[new MA(new Dt(0,1,0),0),new MA(new Dt(0,-1,0),0)],this.sceneManager=new el(this.ignoreList),this.exportManager=new aye,this.importManager=new Xye(this.clipPlanes,el.EVENT_DATA_ID,el.GEOMETRIES_ID),this.rendererManager.init(e.elementId),this.controlsManager=new F_e(this.rendererManager,e.defaultView),this.controlsManager.hideTubeTracksOnZoom(this.sceneManager.getScene(),200),this.effectsManager=new h1e(this.controlsManager.getMainCamera(),this.sceneManager.getScene(),this.rendererManager.getMainRenderer()),this.animationsManager=new n1e(this.sceneManager.getScene(),this.controlsManager.getActiveCamera(),this.rendererManager),this.vrManager=new CW,this.arManager=new OL(this.sceneManager.getScene(),this.controlsManager.getMainCamera()),this.colorManager=new u1e(this.sceneManager),this.getSelectionManager().init(this.controlsManager.getMainCamera(),this.sceneManager.getScene(),this.effectsManager,this.infoLogger),(new TA).setCamera(this.controlsManager.getActiveCamera())}setDarkColor(e){this.displayColor=e?"white":"black"}updateControls(){this.controlsManager.getActiveControls().update(),this.controlsManager.updateSync(),tq()}setAnimationLoop(e){this.uiLoop=e,this.animationLoop=()=>{this.uiLoop(),this.updateControls(),this.sceneManager.alignText(this.controlsManager.getMainCamera()),this.render()},this.rendererManager.getMainRenderer().setAnimationLoop(this.animationLoop)}stopAnimationLoop(){this.rendererManager.getMainRenderer().setAnimationLoop(null)}render(){this.rendererManager.render(this.sceneManager.getScene(),this.controlsManager.getOverlayCamera()),this.effectsManager.render(this.sceneManager.getScene(),this.controlsManager.getMainCamera()),this.sceneManager.updateLights(this.controlsManager.getActiveCamera())}xrRender(e){this.uiLoop(),this.rendererManager.getMainRenderer().render(this.sceneManager.getScene(),e.getXRCamera()),this.sceneManager.updateLights(e.getXRCamera())}getSceneManager(){return this.sceneManager||(this.sceneManager=new el(this.ignoreList)),this.sceneManager}autoRotate(e){this.controlsManager.getActiveControls().autoRotate=e}filterRayIntersect(){null==this.stateManager&&(this.stateManager=new TA),null==this.isEventData&&(this.isEventData=e=>{let t=!1;return e.object.traverseAncestors(i=>{"EventData"==i.name&&(t=!0)}),t}),null==this.isVisible&&(this.isVisible=e=>{let t=!1;return this.clipPlanes.length>0&&(this.clipIntersection?this.clipPlanes.every(i=>i.distanceToPoint(e.point)<0)||(t=!0):this.clipPlanes.every(i=>i.distanceToPoint(e.point)>0)&&(t=!0)),t})}originChangedEmit(e){this.origin=e,this.originChanged.emit(e)}getMainIntersect(e){const t=this.controlsManager.getMainCamera(),i=this.sceneManager.getScene(),r=new Bj,s=new Fi;s.x=e.clientX/window.innerWidth*2-1,s.y=-e.clientY/window.innerHeight*2+1,r.setFromCamera(s,t);const o=r.intersectObjects(i.children);let l=null;if(o.length>0&&!this.stateManager.clippingEnabled.value){for(const h of o)if("gridline"!=h.object.name&&"XYZ Labels"!=h.object.name){l=h;break}}else for(const h of o)if("gridline"!=h.object.name&&"XYZ Labels"!=h.object.name){if(this.isEventData(h)){l=h;break}if(this.isVisible(h)){l=h;break}}return l}show3DMousePoints(e){this.filterRayIntersect(),null==this.show3DPointsCallback&&(this.show3DPointsCallback=t=>{const i=this.getMainIntersect(t);if(null!=i){const r=i.point,s=new Dt;s.subVectors(r,this.origin);const o=document.getElementsByTagName("app-root")[0],l=document.createElement("p");l.id="3dcoordinates",l.innerHTML=`${i.object.name}:\r\n\tOriginal (cm): (${Math.round(r.x/10)}, ${Math.round(r.y/10)}, ${Math.round(r.z/10)})`,(0!=this.origin.x||0!=this.origin.y||0!=this.origin.z)&&(l.innerHTML+=`\r\n\tCompared to grid (cm): (${Math.round(s.x/10)}, ${Math.round(s.y/10)}, ${Math.round(s.z/10)})`),l.style.whiteSpace="pre",l.style.color=this.displayColor,l.style.position="absolute",l.style.top=`${t.clientY+10}px`,l.style.left=`${t.clientX+10}px`;const h=document.createElement("div");h.id="circledDot",h.style.width="1rem",h.style.height="1rem",h.style.position="absolute",h.style.top=`calc(${t.clientY}px - 0.5rem)`,h.style.left=`calc(${t.clientX}px - 0.5rem)`,h.style.border=`2px solid ${this.displayColor}`,h.style.borderRadius="0.5rem",h.innerHTML=`\n            <div \n              style = "\n                background-color: ${this.displayColor}; \n                margin-top: calc(0.3rem - 1.5px);\n                margin-left: calc(0.3rem - 1.5px); \n                width: 0.4rem; \n                height: 0.4rem; \n                border-radius: 0.5rem;\n              "\n            ></div>`,o?.appendChild(l),o?.appendChild(h),setTimeout(()=>{document.getElementById("3dcoordinates")?.remove(),document.getElementById("circledDot")?.remove()},3e3)}}),e?window.addEventListener("click",this.show3DPointsCallback):window.removeEventListener("click",this.show3DPointsCallback)}show3DDistance(e){this.prev3DCoord=new Dt,this.prev2DCoord=new Fi,this.prevIntersectName="",this.filterRayIntersect(),null==this.show3DDistanceCallback&&(this.mousemoveCallback=this.drawLine.bind(this),this.show3DDistanceCallback=t=>{const i=this.getMainIntersect(t);if(null!=i)if(this.prevIntersectName){window.removeEventListener("mousemove",this.mousemoveCallback);const r=i.point.distanceTo(this.prev3DCoord)/10;this.drawLine(t);const s=this.distanceCanvas.getContext("2d");if(s){s.beginPath(),s.arc(t.clientX,t.clientY,7,0,2*Math.PI),s.stroke(),s.beginPath(),s.arc(t.clientX,t.clientY,3,0,2*Math.PI),s.fill(),s.font="15px Arial";let o=this.prev2DCoord.x,l=t.clientX;const h=this.prev2DCoord.y,u=t.clientY,f=(o+l)/2,y=(h+u)/2,B=(o-l)/(u-h),j=25/Math.sqrt(1+B*B),se=f+j,le=y+B*j;this.prev2DCoord.x>t.clientX?(o=this.prev2DCoord.x+20,l=t.clientX-s.measureText(i.object.name).width-20):(o=this.prev2DCoord.x-s.measureText(this.prevIntersectName).width-20,l=t.clientX+20),s.fillText(this.prevIntersectName,o,h),s.fillText(i.object.name,l,u),s.fillText(r.toFixed(2).toString()+"cm",se,le),setTimeout(()=>{null!=document.getElementById("3Ddistance")&&document.getElementById("3Ddistance")?.remove(),this.distanceCanvas.getContext("2d")?.clearRect(0,0,this.distanceCanvas.width,this.distanceCanvas.height)},3e3),this.prevIntersectName=""}}else{this.prev3DCoord=i.point,this.prev2DCoord=new Fi(t.clientX,t.clientY),this.prevIntersectName=i.object.name;const r=document.getElementsByTagName("app-root")[0];null==this.distanceCanvas&&(this.distanceCanvas=document.createElement("canvas"),this.distanceCanvas.id="3Ddistance",this.distanceCanvas.width=window.innerWidth,this.distanceCanvas.height=window.innerHeight,this.distanceCanvas.style.position="absolute",this.distanceCanvas.style.bottom="0"),r?.appendChild(this.distanceCanvas);const s=this.distanceCanvas.getContext("2d");s&&(s.strokeStyle=this.displayColor,s.lineWidth=2,s.fillStyle=this.displayColor,s.beginPath(),s.arc(this.prev2DCoord.x,this.prev2DCoord.y,7,0,2*Math.PI),s.stroke(),s.beginPath(),s.arc(this.prev2DCoord.x,this.prev2DCoord.y,3,0,2*Math.PI),s.fill()),window.addEventListener("mousemove",this.mousemoveCallback)}}),e?window.addEventListener("click",this.show3DDistanceCallback):(window.removeEventListener("click",this.show3DDistanceCallback),window.removeEventListener("mousemove",this.mousemoveCallback),null!=document.getElementById("3Ddistance")&&document.getElementById("3Ddistance")?.remove(),null!=this.distanceCanvas&&this.distanceCanvas.getContext("2d")?.clearRect(0,0,this.distanceCanvas.width,this.distanceCanvas.height))}drawLine(e){const t=this.distanceCanvas.getContext("2d");t&&(t.clearRect(0,0,this.distanceCanvas.width,this.distanceCanvas.height),t.beginPath(),t.moveTo(this.prev2DCoord.x,this.prev2DCoord.y),t.lineTo(e.clientX,e.clientY),t.stroke(),t.beginPath(),t.arc(this.prev2DCoord.x,this.prev2DCoord.y,7,0,2*Math.PI),t.stroke(),t.beginPath(),t.arc(this.prev2DCoord.x,this.prev2DCoord.y,3,0,2*Math.PI),t.fill())}shiftCartesianGrid(){this.shiftGrid=!0,this.filterRayIntersect(),null==this.shiftCartesianGridCallback&&(this.shiftCartesianGridCallback=t=>{const i=this.getMainIntersect(t);null!=i&&this.originChangedEmit(i.point)});const e=t=>{window.removeEventListener("click",this.shiftCartesianGridCallback),this.stopShifting.emit(!0),this.shiftGrid=!1,window.removeEventListener("contextmenu",e)};window.addEventListener("click",this.shiftCartesianGridCallback),window.addEventListener("contextmenu",e)}setClipping(e){this.rendererManager.setLocalClippingEnabled(e)}setClippingAngle(e,t){const i=new zc;i.setFromAxisAngle(new Dt(0,0,1),e*Math.PI/180),this.clipPlanes[0].normal.set(0,-1,0).applyQuaternion(i);const r=new zc;r.setFromAxisAngle(new Dt(0,0,1),(e+t)*Math.PI/180),this.clipPlanes[1].normal.set(0,1,0).applyQuaternion(r),(this.clipIntersection&&t>180||!this.clipIntersection&&t<180)&&(this.clipIntersection=t<180,this.sceneManager.getGeometries().traverse(o=>{o instanceof jo&&o.material instanceof ch&&(o.material.clipIntersection=this.clipIntersection)}))}animateCameraTransform(e,t,i){this.animateCameraPosition(e,i),this.animateCameraTarget(t,i)}swapCameras(e){let t;t=e?"OrthographicCamera":"PerspectiveCamera",this.controlsManager.getMainCamera().type!==t&&this.controlsManager.swapControls()}loadOBJGeometry(e,t,i,r,s=!0,o=!0){var l=this;return(0,al.A)(function*(){const h=l.sceneManager.getGeometries(),u=yield l.importManager.loadOBJGeometry(e,t,i,r,o),{object:f}=u;return f.visible=s,h.add(f),u})()}loadGLTFGeometry(e,t,i,r,s){var o=this;return(0,al.A)(function*(){const l=o.sceneManager.getGeometries(),h=yield o.importManager.loadGLTFGeometry(e,t,i,r,s);for(const{object:u}of h)l.add(u),o.infoLogger.add(t,"Loaded GLTF scene");return h})()}parseOBJGeometry(e,t,i=!0){const r=this.sceneManager.getGeometries(),s=this.importManager.parseOBJGeometry(e,t);return s.visible=i,r.add(s),{object:s}}parseGLTFGeometry(e){var t=this;return(0,al.A)(function*(){const i=yield t.importManager.parseGLTFGeometry(e);for(const{object:r}of i)t.sceneManager.getGeometries().add(r),t.infoLogger.add(e.name,"Parsed GLTF geometry");return i})()}parsePhnxScene(e){var t=this;return(0,al.A)(function*(){yield t.importManager.parsePhnxScene(e,(r,s)=>{null!=r&&t.sceneManager.getScene().add(r),null!=s&&t.sceneManager.getScene().add(s)})})()}loadJSONGeometry(e,t,i,r,s=!0){var o=this;return(0,al.A)(function*(){const l=o.sceneManager.getGeometries(),{object:h}=yield o.importManager.loadJSONGeometry(e,t,i,r);return h.visible=s,l.add(h),{object:h}})()}exportSceneToOBJ(){const e=this.sceneManager.getCleanScene();this.exportManager.exportSceneToOBJ(e)}exportPhoenixScene(){const e=this.sceneManager.getCleanScene();this.exportManager.exportPhoenixScene(e,this.sceneManager.getEventData(),this.sceneManager.getGeometries())}fixOverlayView(e){this.rendererManager.setFixOverlay(e)}setSelectedObjectDisplay(e){this.getSelectionManager().setSelectedObject(e)}eventDataDepthTest(e){this.sceneManager.eventDataDepthTest(e)}enableSelecting(e){this.getSelectionManager().setSelecting(e)}clearEventData(){this.sceneManager.clearEventData()}addEventDataTypeGroup(e){return this.sceneManager.addEventDataTypeGroup(e)}setOverlayRenderer(e){this.rendererManager&&this.rendererManager.setOverlayRenderer(e)}zoomTo(e,t){this.controlsManager.zoomTo(e,t)}getSelectionManager(){return this.selectionManager||(this.selectionManager=new Yye),this.selectionManager}animateCameraPosition(e,t){const i=new zf(this.controlsManager.getActiveCamera().position);i.to({x:e[0],y:e[1],z:e[2]},t),i.start()}animateCameraTarget(e,t){const i=new zf(this.controlsManager.getActiveControls().target);i.to({x:e[0],y:e[1],z:e[2]},t),i.start()}getActiveObjectId(){return this.getSelectionManager().getActiveObjectId()}lookAtObject(e,t=!1){1==t?this.controlsManager.lookAtObject(e,this.getSceneManager().getGeometries(),1e3):this.controlsManager.lookAtObject(e,this.getSceneManager().getEventData(),0)}getObjectPosition(e){return this.controlsManager.getObjectPosition(e,this.getSceneManager().getScene())}highlightObject(e,t=!1){this.selectionManager.highlightObject(e,1==t?this.getSceneManager().getGeometries():this.getSceneManager().getEventData())}enableHighlighting(){this.selectionManager.enableHighlighting()}disableHighlighting(){this.selectionManager.disableHighlighting()}enableKeyboardControls(){document.addEventListener("keydown",e=>{if(!["input","textarea"].includes(e.target?.tagName.toLowerCase())&&e.shiftKey)switch(e.code){case"KeyR":this.autoRotate(!this.controlsManager.getActiveControls().autoRotate);break;case"Equal":this.zoomTo(1/1.2,100);break;case"Minus":this.zoomTo(1.2,100);break;case"KeyC":this.setClipping(!this.rendererManager.getLocalClipping()),this.rendererManager.getLocalClipping()&&this.setClippingAngle(0,180);break;case"KeyV":{const i="OrthographicCamera"===this.controlsManager.getMainCamera().type;this.swapCameras(!i);break}}})}animateThroughEvent(e,t,i){this.animationsManager.animateThroughEvent(e,t,i)}animatePreset(e,t){this.animationsManager.animatePreset(e,t)}animateEventWithCollision(e,t){this.animationsManager.animateEventWithCollision(e,t)}animateClippingWithCollision(e,t){this.animationsManager.animateClippingWithCollision(e,t)}croppedSize(e,t,i,r){let s=t,o=e;return i*t<r*e?s=r*e/i:o=i*t/r,{width:o,height:s}}checkScreenShotCanvasSize(e,t,i="Stretch"){const r=this.rendererManager.getMainRenderer(),s=new Fi;r.getSize(s);const o=this.croppedSize(e,t,s.width,s.height),l=window.devicePixelRatio,h=r.getContext(),u=h.getParameter(h.MAX_RENDERBUFFER_SIZE);return o.width/l<u&&o.height/l<u}makeScreenShot(e,t,i="Strech"){const r=this.rendererManager.getMainRenderer(),s=new Fi;r.getSize(s);const o=this.croppedSize(e,t,s.width,s.height),l=(o.height-t)/2,h=(o.width-e)/2,u=getComputedStyle(document.body).getPropertyValue("--phoenix-background-color"),f=window.devicePixelRatio,y=document.getElementById("screenshotCanvas");y.width=e,y.height=t,y.style.width=(e/f).toString()+"px",y.style.height=(t/f).toString()+"px";const T=y.getContext("2d");T&&(T.fillStyle=u,T.fillRect(0,0,e,t),r.setSize(o.width/f,o.height/f,!1),this.render(),T.drawImage(r.domElement,h,l,e,t,0,0,e,t)),r.setSize(s.width,s.height,!1),this.render();const B=document.getElementById("experimentInfo");if(null!=B){const j=B.clientHeight*o.height/s.height,ne=B.clientWidth*o.width/s.width;v_e()(B,{backgroundColor:u,ignoreElements:le=>"CANVAS"==le.tagName}).then(le=>{le.toBlob(Ee=>{T?.drawImage(le,j/6,j/6,ne,j),y.toBlob(Pe=>{if(Pe){const Ve=document.createElement("a");document.body.appendChild(Ve),Ve.style.display="none";const Ft=window.URL.createObjectURL(Pe);Ve.href=Ft,Ve.download="screencapture.png",Ve.click()}})})})}}initXRSession(e,t){const i=e===Mm.VR?this.vrManager:this.arManager,r=this.rendererManager.getMainRenderer();r.xr.enabled=!0,r.xr.setAnimationLoop(this.xrRender.bind(this,i)),i.setXRSession(r,()=>{const o=i.getCameraGroup(this.controlsManager.getMainCamera());this.sceneManager.getScene().add(o)},t)}endXRSession(e){const t=e===Mm.VR?this.vrManager:this.arManager;this.sceneManager.getScene().remove(t.getCameraGroup());const i=this.rendererManager.getMainRenderer();i.xr.setAnimationLoop(null),i.xr.enabled=!1,t.endXRSession()}getObjectByName(e){return this.getSceneManager().getScene().getObjectByName(e)||new Wa}setAntialiasing(e){this.effectsManager.setAntialiasing(e)}addGeometryFromParameters(e){this.loadingManager.addLoadableItem("geom_from_params");const t=this.getSceneManager().getScene(),l=e.NumPhiEl,h=e.NumZEl,u=e.Radius,f=e.MinZ,y=e.MaxZ,T=e.TiltAngle,B=e.ZTiltAngle,j=e.PhiOffset,ne=e.Colour,le=new Tp(e.Xdim,e.Ydim,e.Zdim),Ee=new wh({color:ne,opacity:.5,transparent:!0}),Pe=(y-f)/h,Ve=2*Math.PI/l;let Ft=f+Pe/2;const Ct=Math.PI/2;let Lt;for(let Kt=0;Kt<h;Kt++){let Bt=j;for(let St=0;St<l;St++){Bt+=Ve,Lt=new Dt(u*Math.cos(Bt),u*Math.sin(Bt),Ft);const Dn=new jo(le.clone(),Ee);Dn.matrix.makeRotationFromEuler(new B0(B,0,Ct+Bt+T)),Dn.matrix.setPosition(Lt),Dn.matrixAutoUpdate=!1,t.add(Dn)}Ft+=Pe}this.loadingManager.itemLoaded("geom_from_params")}addLabelToObject(e,t,i){const r=this.controlsManager.getActiveControls(),s=this.getObjectPosition(t);this.getSceneManager().addLabelToObject(e,t,i,s,r)}getColorManager(){return this.colorManager}}var sT=function(){var n=0,e=document.createElement("div");function t(f){return e.appendChild(f.dom),f}function i(f){for(var y=0;y<e.children.length;y++)e.children[y].style.display=y===f?"block":"none";n=f}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(f){f.preventDefault(),i(++n%e.children.length)},!1);var r=(performance||Date).now(),s=r,o=0,l=t(new sT.Panel("FPS","#0ff","#002")),h=t(new sT.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=t(new sT.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:e,addPanel:t,showPanel:i,begin:function(){r=(performance||Date).now()},end:function(){o++;var f=(performance||Date).now();if(h.update(f-r,200),f>=s+1e3&&(l.update(1e3*o/(f-s),100),s=f,o=0,u)){var y=performance.memory;u.update(y.usedJSHeapSize/1048576,y.jsHeapSizeLimit/1048576)}return f},update:function(){r=this.end()},domElement:e,setMode:i}};sT.Panel=function(n,e,t){var i=1/0,r=0,s=Math.round,o=s(window.devicePixelRatio||1),l=80*o,h=48*o,u=3*o,f=2*o,y=3*o,T=15*o,B=74*o,j=30*o,ne=document.createElement("canvas");ne.width=l,ne.height=h,ne.style.cssText="width:80px;height:48px";var se=ne.getContext("2d");return se.font="bold "+9*o+"px Helvetica,Arial,sans-serif",se.textBaseline="top",se.fillStyle=t,se.fillRect(0,0,l,h),se.fillStyle=e,se.fillText(n,u,f),se.fillRect(y,T,B,j),se.fillStyle=t,se.globalAlpha=.9,se.fillRect(y,T,B,j),{dom:ne,update:function(le,Ee){i=Math.min(i,le),r=Math.max(r,le),se.fillStyle=t,se.globalAlpha=1,se.fillRect(0,0,l,T),se.fillStyle=e,se.fillText(s(le)+" "+n+" ("+s(i)+"-"+s(r)+")",u,f),se.drawImage(ne,y+o,T,B-o,j,y,T,B-o,j),se.fillRect(y+B-o,T,o,j),se.fillStyle=t,se.globalAlpha=.9,se.fillRect(y+B-o,T,o,s((1-le/Ee)*j))}}};const M1e=sT;var $C=function(n){return n[n.NotForced=0]="NotForced",n[n.On=1]="On",n[n.Off=2]="Off",n}($C||{});class ad{constructor(e,t,i,r,s=$C.NotForced,o=0,l=0){this.name=e,this.cameraPos=t,this.cameraTarget=i,this.icon=r,this.clipping=s,this.clippingStartAngle=o,this.clippingOpeningAngle=l}getIconURL(){return"assets/preset-views/"+this.icon+".svg#"+this.icon}}function XC(n,e){var t=n.__state.conversionName.toString(),i=Math.round(n.r),r=Math.round(n.g),s=Math.round(n.b),o=n.a,l=Math.round(n.h),h=n.s.toFixed(1),u=n.v.toFixed(1);if(e||"THREE_CHAR_HEX"===t||"SIX_CHAR_HEX"===t){for(var f=n.hex.toString(16);f.length<6;)f="0"+f;return"#"+f}return"CSS_RGB"===t?"rgb("+i+","+r+","+s+")":"CSS_RGBA"===t?"rgba("+i+","+r+","+s+","+o+")":"HEX"===t?"0x"+n.hex.toString(16):"RGB_ARRAY"===t?"["+i+","+r+","+s+"]":"RGBA_ARRAY"===t?"["+i+","+r+","+s+","+o+"]":"RGB_OBJ"===t?"{r:"+i+",g:"+r+",b:"+s+"}":"RGBA_OBJ"===t?"{r:"+i+",g:"+r+",b:"+s+",a:"+o+"}":"HSV_OBJ"===t?"{h:"+l+",s:"+h+",v:"+u+"}":"HSVA_OBJ"===t?"{h:"+l+",s:"+h+",v:"+u+",a:"+o+"}":"unknown format"}var MW=Array.prototype.forEach,oT=Array.prototype.slice,cr={BREAK:{},extend:function(e){return this.each(oT.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(t[r])||(e[r]=t[r])}.bind(this))},this),e},defaults:function(e){return this.each(oT.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(e[r])&&(e[r]=t[r])}.bind(this))},this),e},compose:function(){var e=oT.call(arguments);return function(){for(var t=oT.call(arguments),i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},each:function(e,t,i){if(e)if(MW&&e.forEach&&e.forEach===MW)e.forEach(t,i);else if(e.length===e.length+0){var s,r=void 0;for(r=0,s=e.length;r<s;r++)if(r in e&&t.call(i,e[r],r)===this.BREAK)return}else for(var o in e)if(t.call(i,e[o],o)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,i){var r=void 0;return function(){var s=this,o=arguments,h=i||!r;clearTimeout(r),r=setTimeout(function l(){r=null,i||e.apply(s,o)},t),h&&e.apply(s,o)}},toArray:function(e){return e.toArray?e.toArray():oT.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(n){function e(t){return n.apply(this,arguments)}return e.toString=function(){return n.toString()},e}(function(n){return isNaN(n)}),isArray:Array.isArray||function(n){return n.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}},S1e=[{litmus:cr.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:XC},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:XC},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:XC},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:XC}}},{litmus:cr.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:cr.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:cr.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(cr.isNumber(e.r)&&cr.isNumber(e.g)&&cr.isNumber(e.b)&&cr.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(cr.isNumber(e.r)&&cr.isNumber(e.g)&&cr.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(cr.isNumber(e.h)&&cr.isNumber(e.s)&&cr.isNumber(e.v)&&cr.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(cr.isNumber(e.h)&&cr.isNumber(e.s)&&cr.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],aT=void 0,xB=void 0,wB=function(){xB=!1;var e=arguments.length>1?cr.toArray(arguments):arguments[0];return cr.each(S1e,function(t){if(t.litmus(e))return cr.each(t.conversions,function(i,r){if(aT=i.read(e),!1===xB&&!1!==aT)return xB=aT,aT.conversionName=r,aT.conversion=i,cr.BREAK}),cr.BREAK}),xB},EW=void 0,lT={hsv_to_rgb:function(e,t,i){var r=Math.floor(e/60)%6,s=e/60-Math.floor(e/60),o=i*(1-t),l=i*(1-s*t),h=i*(1-(1-s)*t),u=[[i,h,o],[l,i,o],[o,i,h],[o,l,i],[h,o,i],[i,o,l]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(e,t,i){var r=Math.min(e,t,i),s=Math.max(e,t,i),o=s-r,l=void 0;return 0===s?{h:NaN,s:0,v:0}:(l=e===s?(t-i)/o:t===s?2+(i-e)/o:4+(e-t)/o,(l/=6)<0&&(l+=1),{h:360*l,s:o/s,v:s/255})},rgb_to_hex:function(e,t,i){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),this.hex_with_component(r,0,i)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,i){return i<<(EW=8*t)|e&~(255<<EW)}},T1e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Lg=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},Ng=function(){function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),ov=function n(e,t,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var s=Object.getPrototypeOf(e);return null===s?void 0:n(s,t,i)}if("value"in r)return r.value;var o=r.get;return void 0===o?void 0:o.call(i)},av=function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)},lv=function(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?n:e},Hu=function(){function n(){if(Lg(this,n),this.__state=wB.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return Ng(n,[{key:"toString",value:function(){return XC(this)}},{key:"toHexString",value:function(){return XC(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),n}();function LL(n,e,t){Object.defineProperty(n,e,{get:function(){return"RGB"===this.__state.space||Hu.recalculateRGB(this,e,t),this.__state[e]},set:function(r){"RGB"!==this.__state.space&&(Hu.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=r}})}function NL(n,e){Object.defineProperty(n,e,{get:function(){return"HSV"===this.__state.space||Hu.recalculateHSV(this),this.__state[e]},set:function(i){"HSV"!==this.__state.space&&(Hu.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=i}})}Hu.recalculateRGB=function(n,e,t){if("HEX"===n.__state.space)n.__state[e]=lT.component_from_hex(n.__state.hex,t);else{if("HSV"!==n.__state.space)throw new Error("Corrupted color state");cr.extend(n.__state,lT.hsv_to_rgb(n.__state.h,n.__state.s,n.__state.v))}},Hu.recalculateHSV=function(n){var e=lT.rgb_to_hsv(n.r,n.g,n.b);cr.extend(n.__state,{s:e.s,v:e.v}),cr.isNaN(e.h)?cr.isUndefined(n.__state.h)&&(n.__state.h=0):n.__state.h=e.h},Hu.COMPONENTS=["r","g","b","h","s","v","hex","a"],LL(Hu.prototype,"r",2),LL(Hu.prototype,"g",1),LL(Hu.prototype,"b",0),NL(Hu.prototype,"h"),NL(Hu.prototype,"s"),NL(Hu.prototype,"v"),Object.defineProperty(Hu.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(Hu.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=lT.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var cv=function(){function n(e,t){Lg(this,n),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return Ng(n,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),n}(),SW={};cr.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(n,e){cr.each(n,function(t){SW[t]=e})});var I1e=/(\d+(\.\d+)?)px/;function F0(n){if("0"===n||cr.isUndefined(n))return 0;var e=n.match(I1e);return cr.isNull(e)?0:parseFloat(e[1])}var Ei={makeSelectable:function(e,t){void 0===e||void 0===e.style||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,i){var r=i,s=t;cr.isUndefined(s)&&(s=!0),cr.isUndefined(r)&&(r=!0),e.style.position="absolute",s&&(e.style.left=0,e.style.right=0),r&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,i,r){var s=i||{},o=SW[t];if(!o)throw new Error("Event type "+t+" not supported.");var l=document.createEvent(o);switch(o){case"MouseEvents":l.initMouseEvent(t,s.bubbles||!1,s.cancelable||!0,window,s.clickCount||1,0,0,s.x||s.clientX||0,s.y||s.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var f=l.initKeyboardEvent||l.initKeyEvent;cr.defaults(s,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),f(t,s.bubbles||!1,s.cancelable,window,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.keyCode,s.charCode);break;default:l.initEvent(t,s.bubbles||!1,s.cancelable||!0)}cr.defaults(l,r),e.dispatchEvent(l)},bind:function(e,t,i,r){return e.addEventListener?e.addEventListener(t,i,r||!1):e.attachEvent&&e.attachEvent("on"+t,i),Ei},unbind:function(e,t,i,r){return e.removeEventListener?e.removeEventListener(t,i,r||!1):e.detachEvent&&e.detachEvent("on"+t,i),Ei},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var i=e.className.split(/ +/);-1===i.indexOf(t)&&(i.push(t),e.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return Ei},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var i=e.className.split(/ +/),r=i.indexOf(t);-1!==r&&(i.splice(r,1),e.className=i.join(" "))}else e.className=void 0;return Ei},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return F0(t["border-left-width"])+F0(t["border-right-width"])+F0(t["padding-left"])+F0(t["padding-right"])+F0(t.width)},getHeight:function(e){var t=getComputedStyle(e);return F0(t["border-top-width"])+F0(t["border-bottom-width"])+F0(t["padding-top"])+F0(t["padding-bottom"])+F0(t.height)},getOffset:function(e){var t=e,i={left:0,top:0};if(t.offsetParent)do{i.left+=t.offsetLeft,i.top+=t.offsetTop,t=t.offsetParent}while(t);return i},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},UL=function(n){function e(t,i){Lg(this,e);var r=lv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),s=r;return r.__prev=r.getValue(),r.__checkbox=document.createElement("input"),r.__checkbox.setAttribute("type","checkbox"),Ei.bind(r.__checkbox,"change",function o(){s.setValue(!s.__prev)},!1),r.domElement.appendChild(r.__checkbox),r.updateDisplay(),r}return av(e,n),Ng(e,[{key:"setValue",value:function(i){var r=ov(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),ov(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(cv),TW=function(n){function e(t,i,r){Lg(this,e);var s=lv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),o=r,l=s;if(s.__select=document.createElement("select"),cr.isArray(o)){var h={};cr.each(o,function(u){h[u]=u}),o=h}return cr.each(o,function(u,f){var y=document.createElement("option");y.innerHTML=f,y.setAttribute("value",u),l.__select.appendChild(y)}),s.updateDisplay(),Ei.bind(s.__select,"change",function(){l.setValue(this.options[this.selectedIndex].value)}),s.domElement.appendChild(s.__select),s}return av(e,n),Ng(e,[{key:"setValue",value:function(i){var r=ov(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return Ei.isActive(this.__select)?this:(this.__select.value=this.getValue(),ov(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(cv),DW=function(n){function e(t,i){Lg(this,e);var r=lv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),s=r;function o(){s.setValue(s.__input.value)}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),Ei.bind(r.__input,"keyup",o),Ei.bind(r.__input,"change",o),Ei.bind(r.__input,"blur",function l(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}),Ei.bind(r.__input,"keydown",function(h){13===h.keyCode&&this.blur()}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return av(e,n),Ng(e,[{key:"updateDisplay",value:function(){return Ei.isActive(this.__input)||(this.__input.value=this.getValue()),ov(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(cv);function IW(n){var e=n.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var zL=function(n){function e(t,i,r){Lg(this,e);var s=lv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),o=r||{};return s.__min=o.min,s.__max=o.max,s.__step=o.step,s.__impliedStep=cr.isUndefined(s.__step)?0===s.initialValue?1:Math.pow(10,Math.floor(Math.log(Math.abs(s.initialValue))/Math.LN10))/10:s.__step,s.__precision=IW(s.__impliedStep),s}return av(e,n),Ng(e,[{key:"setValue",value:function(i){var r=i;return void 0!==this.__min&&r<this.__min?r=this.__min:void 0!==this.__max&&r>this.__max&&(r=this.__max),void 0!==this.__step&&r%this.__step!=0&&(r=Math.round(r/this.__step)*this.__step),ov(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(i){return this.__min=i,this}},{key:"max",value:function(i){return this.__max=i,this}},{key:"step",value:function(i){return this.__step=i,this.__impliedStep=i,this.__precision=IW(i),this}}]),e}(cv),cT=function(n){function e(t,i,r){Lg(this,e);var s=lv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,r));s.__truncationSuspended=!1;var o=s,l=void 0;function u(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function y(j){var ne=l-j.clientY;o.setValue(o.getValue()+ne*o.__impliedStep),l=j.clientY}function T(){Ei.unbind(window,"mousemove",y),Ei.unbind(window,"mouseup",T),u()}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),Ei.bind(s.__input,"change",function h(){var j=parseFloat(o.__input.value);cr.isNaN(j)||o.setValue(j)}),Ei.bind(s.__input,"blur",function f(){u()}),Ei.bind(s.__input,"mousedown",function B(j){Ei.bind(window,"mousemove",y),Ei.bind(window,"mouseup",T),l=j.clientY}),Ei.bind(s.__input,"keydown",function(j){13===j.keyCode&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,u())}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return av(e,n),Ng(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():function B1e(n,e){var t=Math.pow(10,e);return Math.round(n*t)/t}(this.getValue(),this.__precision),ov(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(zL);function BW(n,e,t,i,r){return i+(n-e)/(t-e)*(r-i)}var CB=function(n){function e(t,i,r,s,o){Lg(this,e);var l=lv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,{min:r,max:s,step:o})),h=l;function f(ne){ne.preventDefault();var se=h.__background.getBoundingClientRect();return h.setValue(BW(ne.clientX,se.left,se.right,h.__min,h.__max)),!1}function y(){Ei.unbind(window,"mousemove",f),Ei.unbind(window,"mouseup",y),h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}function B(ne){var se=ne.touches[0].clientX,le=h.__background.getBoundingClientRect();h.setValue(BW(se,le.left,le.right,h.__min,h.__max))}function j(){Ei.unbind(window,"touchmove",B),Ei.unbind(window,"touchend",j),h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}return l.__background=document.createElement("div"),l.__foreground=document.createElement("div"),Ei.bind(l.__background,"mousedown",function u(ne){document.activeElement.blur(),Ei.bind(window,"mousemove",f),Ei.bind(window,"mouseup",y),f(ne)}),Ei.bind(l.__background,"touchstart",function T(ne){1===ne.touches.length&&(Ei.bind(window,"touchmove",B),Ei.bind(window,"touchend",j),B(ne))}),Ei.addClass(l.__background,"slider"),Ei.addClass(l.__foreground,"slider-fg"),l.updateDisplay(),l.__background.appendChild(l.__foreground),l.domElement.appendChild(l.__background),l}return av(e,n),Ng(e,[{key:"updateDisplay",value:function(){var i=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*i+"%",ov(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(zL),HL=function(n){function e(t,i,r){Lg(this,e);var s=lv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),o=s;return s.__button=document.createElement("div"),s.__button.innerHTML=void 0===r?"Fire":r,Ei.bind(s.__button,"click",function(l){return l.preventDefault(),o.fire(),!1}),Ei.addClass(s.__button,"button"),s.domElement.appendChild(s.__button),s}return av(e,n),Ng(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(cv),MB=function(n){function e(t,i){Lg(this,e);var r=lv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));r.__color=new Hu(r.getValue()),r.__temp=new Hu(0);var s=r;r.domElement=document.createElement("div"),Ei.makeSelectable(r.domElement,!1),r.__selector=document.createElement("div"),r.__selector.className="selector",r.__saturation_field=document.createElement("div"),r.__saturation_field.className="saturation-field",r.__field_knob=document.createElement("div"),r.__field_knob.className="field-knob",r.__field_knob_border="2px solid ",r.__hue_knob=document.createElement("div"),r.__hue_knob.className="hue-knob",r.__hue_field=document.createElement("div"),r.__hue_field.className="hue-field",r.__input=document.createElement("input"),r.__input.type="text",r.__input_textShadow="0 1px 1px ",Ei.bind(r.__input,"keydown",function(ne){13===ne.keyCode&&y.call(this)}),Ei.bind(r.__input,"blur",y),Ei.bind(r.__selector,"mousedown",function(){Ei.addClass(this,"drag").bind(window,"mouseup",function(){Ei.removeClass(s.__selector,"drag")})}),Ei.bind(r.__selector,"touchstart",function(){Ei.addClass(this,"drag").bind(window,"touchend",function(){Ei.removeClass(s.__selector,"drag")})});var o=document.createElement("div");function l(ne){B(ne),Ei.bind(window,"mousemove",B),Ei.bind(window,"touchmove",B),Ei.bind(window,"mouseup",u),Ei.bind(window,"touchend",u)}function h(ne){j(ne),Ei.bind(window,"mousemove",j),Ei.bind(window,"touchmove",j),Ei.bind(window,"mouseup",f),Ei.bind(window,"touchend",f)}function u(){Ei.unbind(window,"mousemove",B),Ei.unbind(window,"touchmove",B),Ei.unbind(window,"mouseup",u),Ei.unbind(window,"touchend",u),T()}function f(){Ei.unbind(window,"mousemove",j),Ei.unbind(window,"touchmove",j),Ei.unbind(window,"mouseup",f),Ei.unbind(window,"touchend",f),T()}function y(){var ne=wB(this.value);!1!==ne?(s.__color.__state=ne,s.setValue(s.__color.toOriginal())):this.value=s.__color.toString()}function T(){s.__onFinishChange&&s.__onFinishChange.call(s,s.__color.toOriginal())}function B(ne){-1===ne.type.indexOf("touch")&&ne.preventDefault();var se=s.__saturation_field.getBoundingClientRect(),le=ne.touches&&ne.touches[0]||ne,Ve=(le.clientX-se.left)/(se.right-se.left),Ft=1-(le.clientY-se.top)/(se.bottom-se.top);return Ft>1?Ft=1:Ft<0&&(Ft=0),Ve>1?Ve=1:Ve<0&&(Ve=0),s.__color.v=Ft,s.__color.s=Ve,s.setValue(s.__color.toOriginal()),!1}function j(ne){-1===ne.type.indexOf("touch")&&ne.preventDefault();var se=s.__hue_field.getBoundingClientRect(),Pe=1-((ne.touches&&ne.touches[0]||ne).clientY-se.top)/(se.bottom-se.top);return Pe>1?Pe=1:Pe<0&&(Pe=0),s.__color.h=360*Pe,s.setValue(s.__color.toOriginal()),!1}return cr.extend(r.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),cr.extend(r.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:r.__field_knob_border+(r.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),cr.extend(r.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),cr.extend(r.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),cr.extend(o.style,{width:"100%",height:"100%",background:"none"}),PW(o,"top","rgba(0,0,0,0)","#000"),cr.extend(r.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),function R1e(n){n.style.background="",n.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",n.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}(r.__hue_field),cr.extend(r.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:r.__input_textShadow+"rgba(0,0,0,0.7)"}),Ei.bind(r.__saturation_field,"mousedown",l),Ei.bind(r.__saturation_field,"touchstart",l),Ei.bind(r.__field_knob,"mousedown",l),Ei.bind(r.__field_knob,"touchstart",l),Ei.bind(r.__hue_field,"mousedown",h),Ei.bind(r.__hue_field,"touchstart",h),r.__saturation_field.appendChild(o),r.__selector.appendChild(r.__field_knob),r.__selector.appendChild(r.__saturation_field),r.__selector.appendChild(r.__hue_field),r.__hue_field.appendChild(r.__hue_knob),r.domElement.appendChild(r.__input),r.domElement.appendChild(r.__selector),r.updateDisplay(),r}return av(e,n),Ng(e,[{key:"updateDisplay",value:function(){var i=wB(this.getValue());if(!1!==i){var r=!1;cr.each(Hu.COMPONENTS,function(l){if(!cr.isUndefined(i[l])&&!cr.isUndefined(this.__color.__state[l])&&i[l]!==this.__color.__state[l])return r=!0,{}},this),r&&cr.extend(this.__color.__state,i)}cr.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var s=this.__color.v<.5||this.__color.s>.5?255:0,o=255-s;cr.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+s+","+s+","+s+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,PW(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),cr.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+s+","+s+","+s+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),e}(cv),P1e=["-moz-","-o-","-webkit-","-ms-",""];function PW(n,e,t,i){n.style.background="",cr.each(P1e,function(r){n.style.cssText+="background: "+r+"linear-gradient("+e+", "+t+" 0%, "+i+" 100%); "})}var O1e=function(e,t){var i=e[t];return cr.isArray(arguments[2])||cr.isObject(arguments[2])?new TW(e,t,arguments[2]):cr.isNumber(i)?cr.isNumber(arguments[2])&&cr.isNumber(arguments[3])?cr.isNumber(arguments[4])?new CB(e,t,arguments[2],arguments[3],arguments[4]):new CB(e,t,arguments[2],arguments[3]):cr.isNumber(arguments[4])?new cT(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new cT(e,t,{min:arguments[2],max:arguments[3]}):cr.isString(i)?new DW(e,t):cr.isFunction(i)?new HL(e,t,""):cr.isBoolean(i)?new UL(e,t):null},N1e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function L1e(n){setTimeout(n,1e3/60)},U1e=function(){function n(){Lg(this,n),this.backgroundElement=document.createElement("div"),cr.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),Ei.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),cr.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;Ei.bind(this.backgroundElement,"click",function(){e.hide()})}return Ng(n,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),cr.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,i=function r(){t.domElement.style.display="none",t.backgroundElement.style.display="none",Ei.unbind(t.domElement,"webkitTransitionEnd",r),Ei.unbind(t.domElement,"transitionend",r),Ei.unbind(t.domElement,"oTransitionEnd",r)};Ei.bind(this.domElement,"webkitTransitionEnd",i),Ei.bind(this.domElement,"transitionend",i),Ei.bind(this.domElement,"oTransitionEnd",i),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-Ei.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-Ei.getHeight(this.domElement)/2+"px"}}]),n}();!function(e,t){var i=t||document,r=document.createElement("style");r.type="text/css",r.innerHTML=e;var s=i.getElementsByTagName("head")[0];try{s.appendChild(r)}catch{}}(function E1e(n){if(n&&!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=n,document.head.appendChild(e),n}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var hT="Default",uT=function(){try{return!!window.localStorage}catch{return!1}}(),dT=void 0,OW=!0,YC=void 0,VL=!1,LW=[],vc=function n(e){var t=this,i=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),Ei.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=cr.defaults(i,{closeOnTop:!1,autoPlace:!0,width:n.DEFAULT_WIDTH}),i=cr.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),cr.isUndefined(i.load)?i.load={preset:hT}:i.preset&&(i.load.preset=i.preset),cr.isUndefined(i.parent)&&i.hideable&&LW.push(this),i.resizable=cr.isUndefined(i.parent)&&i.resizable,i.autoPlace&&cr.isUndefined(i.scrollable)&&(i.scrollable=!0);var r=uT&&"true"===localStorage.getItem(KC(0,"isLocal")),s=void 0,o=void 0;if(Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},closeOnTop:{get:function(){return i.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:i.load.preset},set:function(T){t.parent?t.getRoot().preset=T:i.load.preset=T,function q1e(n){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].value===n.preset&&(n.__preset_select.selectedIndex=e)}(this),t.revert()}},width:{get:function(){return i.width},set:function(T){i.width=T,jL(t,T)}},name:{get:function(){return i.name},set:function(T){i.name=T,o&&(o.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(T){i.closed=T,i.closed?Ei.addClass(t.__ul,n.CLASS_CLOSED):Ei.removeClass(t.__ul,n.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=T?n.TEXT_OPEN:n.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return r},set:function(T){uT&&(r=T,T?Ei.bind(window,"unload",s):Ei.unbind(window,"unload",s),localStorage.setItem(KC(0,"isLocal"),T))}}}),cr.isUndefined(i.parent)){if(this.closed=i.closed||!1,Ei.addClass(this.domElement,n.CLASS_MAIN),Ei.makeSelectable(this.domElement,!1),uT&&r){t.useLocalStorage=!0;var l=localStorage.getItem(KC(0,"gui"));l&&(i.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=n.TEXT_CLOSED,Ei.addClass(this.__closeButton,n.CLASS_CLOSE_BUTTON),i.closeOnTop?(Ei.addClass(this.__closeButton,n.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(Ei.addClass(this.__closeButton,n.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),Ei.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{void 0===i.closed&&(i.closed=!0);var h=document.createTextNode(i.name);Ei.addClass(h,"controller-name"),o=GL(t,h),Ei.addClass(this.__ul,n.CLASS_CLOSED),Ei.addClass(o,"title"),Ei.bind(o,"click",function(T){return T.preventDefault(),t.closed=!t.closed,!1}),i.closed||(this.closed=!1)}i.autoPlace&&(cr.isUndefined(i.parent)&&(OW&&(YC=document.createElement("div"),Ei.addClass(YC,"dg"),Ei.addClass(YC,n.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(YC),OW=!1),YC.appendChild(this.domElement),Ei.addClass(this.domElement,n.CLASS_AUTO_PLACE)),this.parent||jL(t,i.width)),this.__resizeHandler=function(){t.onResizeDebounced()},Ei.bind(window,"resize",this.__resizeHandler),Ei.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),Ei.bind(this.__ul,"transitionend",this.__resizeHandler),Ei.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),i.resizable&&function G1e(n){var e=void 0;function t(s){return s.preventDefault(),n.width+=e-s.clientX,n.onResize(),e=s.clientX,!1}function i(){Ei.removeClass(n.__closeButton,vc.CLASS_DRAG),Ei.unbind(window,"mousemove",t),Ei.unbind(window,"mouseup",i)}function r(s){return s.preventDefault(),e=s.clientX,Ei.addClass(n.__closeButton,vc.CLASS_DRAG),Ei.bind(window,"mousemove",t),Ei.bind(window,"mouseup",i),!1}n.__resize_handle=document.createElement("div"),cr.extend(n.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),Ei.bind(n.__resize_handle,"mousedown",r),Ei.bind(n.__closeButton,"mousedown",r),n.domElement.insertBefore(n.__resize_handle,n.domElement.firstElementChild)}(this),this.saveToLocalStorageIfPossible=s=function(){uT&&"true"===localStorage.getItem(KC(0,"isLocal"))&&localStorage.setItem(KC(0,"gui"),JSON.stringify(t.getSaveObject()))},i.parent||function f(){var y=t.getRoot();y.width+=1,cr.defer(function(){y.width-=1})}()};function GL(n,e,t){var i=document.createElement("li");return e&&i.appendChild(e),t?n.__ul.insertBefore(i,t):n.__ul.appendChild(i),n.onResize(),i}function NW(n){Ei.unbind(window,"resize",n.__resizeHandler),n.saveToLocalStorageIfPossible&&Ei.unbind(window,"unload",n.saveToLocalStorageIfPossible)}function qL(n,e){var t=n.__preset_select[n.__preset_select.selectedIndex];t.innerHTML=e?t.value+"*":t.value}function UW(n,e){var t=n.getRoot(),i=t.__rememberedObjects.indexOf(e.object);if(-1!==i){var r=t.__rememberedObjectIndecesToControllers[i];if(void 0===r&&(t.__rememberedObjectIndecesToControllers[i]=r={}),r[e.property]=e,t.load&&t.load.remembered){var s=t.load.remembered,o=void 0;if(s[n.preset])o=s[n.preset];else{if(!s[hT])return;o=s[hT]}if(o[i]&&void 0!==o[i][e.property]){var l=o[i][e.property];e.initialValue=l,e.setValue(l)}}}}function fT(n,e,t,i){if(void 0===e[t])throw new Error('Object "'+e+'" has no property "'+t+'"');var r=void 0;if(i.color)r=new MB(e,t);else{var s=[e,t].concat(i.factoryArgs);r=O1e.apply(n,s)}i.before instanceof cv&&(i.before=i.before.__li),UW(n,r),Ei.addClass(r.domElement,"c");var o=document.createElement("span");Ei.addClass(o,"property-name"),o.innerHTML=r.property;var l=document.createElement("div");l.appendChild(o),l.appendChild(r.domElement);var h=GL(n,l,i.before);return Ei.addClass(h,vc.CLASS_CONTROLLER_ROW),Ei.addClass(h,r instanceof MB?"color":T1e(r.getValue())),function H1e(n,e,t){if(t.__li=e,t.__gui=n,cr.extend(t,{options:function(o){if(arguments.length>1){var l=t.__li.nextElementSibling;return t.remove(),fT(n,t.object,t.property,{before:l,factoryArgs:[cr.toArray(arguments)]})}if(cr.isArray(o)||cr.isObject(o)){var h=t.__li.nextElementSibling;return t.remove(),fT(n,t.object,t.property,{before:h,factoryArgs:[o]})}},name:function(o){return t.__li.firstElementChild.firstElementChild.innerHTML=o,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof CB){var i=new cT(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});cr.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(s){var o=t[s],l=i[s];t[s]=i[s]=function(){var h=Array.prototype.slice.call(arguments);return l.apply(i,h),o.apply(t,h)}}),Ei.addClass(e,"has-slider"),t.domElement.insertBefore(i.domElement,t.domElement.firstElementChild)}else if(t instanceof cT){var r=function(o){if(cr.isNumber(t.__min)&&cr.isNumber(t.__max)){var l=t.__li.firstElementChild.firstElementChild.innerHTML,h=t.__gui.__listening.indexOf(t)>-1;t.remove();var u=fT(n,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return u.name(l),h&&u.listen(),u}return o};t.min=cr.compose(r,t.min),t.max=cr.compose(r,t.max)}else t instanceof UL?(Ei.bind(e,"click",function(){Ei.fakeEvent(t.__checkbox,"click")}),Ei.bind(t.__checkbox,"click",function(s){s.stopPropagation()})):t instanceof HL?(Ei.bind(e,"click",function(){Ei.fakeEvent(t.__button,"click")}),Ei.bind(e,"mouseover",function(){Ei.addClass(t.__button,"hover")}),Ei.bind(e,"mouseout",function(){Ei.removeClass(t.__button,"hover")})):t instanceof MB&&(Ei.addClass(e,"color"),t.updateDisplay=cr.compose(function(s){return e.style.borderLeftColor=t.__color.toString(),s},t.updateDisplay),t.updateDisplay());t.setValue=cr.compose(function(s){return n.getRoot().__preset_select&&t.isModified()&&qL(n.getRoot(),!0),s},t.setValue)}(n,h,r),n.__controllers.push(r),r}function KC(n,e){return document.location.href+"."+e}function QL(n,e,t){var i=document.createElement("option");i.innerHTML=e,i.value=e,n.__preset_select.appendChild(i),t&&(n.__preset_select.selectedIndex=n.__preset_select.length-1)}function zW(n,e){e.style.display=n.useLocalStorage?"block":"none"}function jL(n,e){n.domElement.style.width=e+"px",n.__save_row&&n.autoPlace&&(n.__save_row.style.width=e+"px"),n.__closeButton&&(n.__closeButton.style.width=e+"px")}function EB(n,e){var t={};return cr.each(n.__rememberedObjects,function(i,r){var s={};cr.each(n.__rememberedObjectIndecesToControllers[r],function(l,h){s[h]=e?l.initialValue:l.getValue()}),t[r]=s}),t}function HW(n){0!==n.length&&N1e.call(window,function(){HW(n)}),cr.each(n,function(e){e.updateDisplay()})}vc.toggleHide=function(){VL=!VL,cr.each(LW,function(n){n.domElement.style.display=VL?"none":""})},vc.CLASS_AUTO_PLACE="a",vc.CLASS_AUTO_PLACE_CONTAINER="ac",vc.CLASS_MAIN="main",vc.CLASS_CONTROLLER_ROW="cr",vc.CLASS_TOO_TALL="taller-than-window",vc.CLASS_CLOSED="closed",vc.CLASS_CLOSE_BUTTON="close-button",vc.CLASS_CLOSE_TOP="close-top",vc.CLASS_CLOSE_BOTTOM="close-bottom",vc.CLASS_DRAG="drag",vc.DEFAULT_WIDTH=245,vc.TEXT_CLOSED="Close Controls",vc.TEXT_OPEN="Open Controls",vc._keydownHandler=function(n){"text"!==document.activeElement.type&&(72===n.which||72===n.keyCode)&&vc.toggleHide()},Ei.bind(window,"keydown",vc._keydownHandler,!1),cr.extend(vc.prototype,{add:function(e,t){return fT(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return fT(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;cr.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&YC.removeChild(this.domElement);var e=this;cr.each(this.__folders,function(t){e.removeFolder(t)}),Ei.unbind(window,"keydown",vc._keydownHandler,!1),NW(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var i=new vc(t);this.__folders[e]=i;var r=GL(this,i.domElement);return Ei.addClass(r,"folder"),i},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],NW(e);var t=this;cr.each(e.__folders,function(i){e.removeFolder(i)}),cr.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=Ei.getOffset(e.__ul).top,i=0;cr.each(e.__ul.childNodes,function(r){e.autoPlace&&r===e.__save_row||(i+=Ei.getHeight(r))}),window.innerHeight-t-20<i?(Ei.addClass(e.domElement,vc.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(Ei.removeClass(e.domElement,vc.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&cr.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:cr.debounce(function(){this.onResize()},50),remember:function(){if(cr.isUndefined(dT)&&((dT=new U1e).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;cr.each(Array.prototype.slice.call(arguments),function(t){0===e.__rememberedObjects.length&&function V1e(n){var e=n.__save_row=document.createElement("li");Ei.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),Ei.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",Ei.addClass(t,"button gears");var i=document.createElement("span");i.innerHTML="Save",Ei.addClass(i,"button"),Ei.addClass(i,"save");var r=document.createElement("span");r.innerHTML="New",Ei.addClass(r,"button"),Ei.addClass(r,"save-as");var s=document.createElement("span");s.innerHTML="Revert",Ei.addClass(s,"button"),Ei.addClass(s,"revert");var o=n.__preset_select=document.createElement("select");if(n.load&&n.load.remembered?cr.each(n.load.remembered,function(y,T){QL(n,T,T===n.preset)}):QL(n,hT,!1),Ei.bind(o,"change",function(){for(var y=0;y<n.__preset_select.length;y++)n.__preset_select[y].innerHTML=n.__preset_select[y].value;n.preset=this.value}),e.appendChild(o),e.appendChild(t),e.appendChild(i),e.appendChild(r),e.appendChild(s),uT){var l=document.getElementById("dg-local-explain"),h=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(KC(0,"isLocal"))&&h.setAttribute("checked","checked"),zW(n,l),Ei.bind(h,"change",function(){n.useLocalStorage=!n.useLocalStorage,zW(n,l)})}var f=document.getElementById("dg-new-constructor");Ei.bind(f,"keydown",function(y){y.metaKey&&(67===y.which||67===y.keyCode)&&dT.hide()}),Ei.bind(t,"click",function(){f.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),dT.show(),f.focus(),f.select()}),Ei.bind(i,"click",function(){n.save()}),Ei.bind(r,"click",function(){var y=prompt("Enter a new preset name.");y&&n.saveAs(y)}),Ei.bind(s,"click",function(){n.revert()})}(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&jL(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=EB(this)),e.folders={},cr.each(this.__folders,function(t,i){e.folders[i]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=EB(this),qL(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[hT]=EB(this,!0)),this.load.remembered[e]=EB(this),this.preset=e,QL(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){cr.each(this.__controllers,function(t){this.getRoot().load.remembered?UW(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),cr.each(this.__folders,function(t){t.revert(t)}),e||qL(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&HW(this.__listening)},updateDisplay:function(){cr.each(this.__controllers,function(e){e.updateDisplay()}),cr.each(this.__folders,function(e){e.updateDisplay()})}});var VW=vc;class GW{constructor(e="eventDisplay",t){this.three=t,this.guiParameters={rotate:void 0,axis:void 0,lowRes:void 0,eventData:void 0,geometries:{show:!0,wireframe:!1},labels:void 0},this.maxPositionX=4e3,this.maxPositionY=4e3,this.maxPositionZ=4e3,this.gui=new VW,this.gui.domElement.id="gui",this.gui.domElement.style.cssText="position: absolute; right: 0; top: 2rem; z-index: 11;",(document.getElementById(e)??document.body).appendChild(this.gui.domElement),this.sceneManager=t.getSceneManager()}clear(){const e=document.getElementById("gui");e?.remove()}addGeometryFolder(){null==this.geomFolder&&(this.geomFolder=this.gui.addFolder(el.GEOMETRIES_ID)),this.guiParameters.geometries={show:!0,wireframe:!1},this.geomFolder.add(this.guiParameters.geometries,"show").name("Show").listen().onChange(s=>{this.sceneManager.objectVisibility(this.sceneManager.getObjectByName(el.GEOMETRIES_ID),s)}),this.geomFolder.add(this.guiParameters.geometries,"wireframe").name("Wireframe").listen().onChange(s=>{this.sceneManager.wireframeGeometries(s)})}addGeometry(e,t){const{name:i,material:r,visible:s}=e,o=r?.color;this.guiParameters[i]={show:s,color:o??"#000000",x:0,y:0,z:0,detectorOpacity:1,remove:this.removeOBJ(e),scale:1};const l=this.geomFolder.addFolder(i);l.addColor(this.guiParameters[i],"color").name("Color").onChange(T=>this.sceneManager.changeObjectColor(e,T)),l.add(this.guiParameters[i],"detectorOpacity",0,1).name("Opacity").onFinishChange(T=>this.sceneManager.setGeometryOpacity(e,T)),l.add(this.guiParameters[i],"show").name("Show").listen().onChange(T=>this.sceneManager.objectVisibility(e,T)),l.add(this.guiParameters[i],"scale",0,1e3).name("Scale").onChange(T=>{this.sceneManager.scaleObject(e,T)}),l.add(this.guiParameters[i],"x",-this.maxPositionX,this.maxPositionX).name("X").onChange(T=>this.sceneManager.getObjectPosition(i).setX(T)),l.add(this.guiParameters[i],"y",-this.maxPositionY,this.maxPositionY).name("Y").onChange(T=>this.sceneManager.getObjectPosition(i).setY(T)),l.add(this.guiParameters[i],"z",-this.maxPositionZ,this.maxPositionZ).name("Z").onChange(T=>this.sceneManager.getObjectPosition(i).setZ(T)),l.add(this.guiParameters[i],"remove").name("Remove")}removeOBJ(e){return()=>{const t=this.geomFolder.__folders[e.name];t&&this.geomFolder.removeFolder(t),this.sceneManager.removeGeometry(e)}}addEventDataFolder(){this.eventFolder&&this.gui?.removeFolder(this.eventFolder),this.eventFolder=this.gui.addFolder("Event Data"),this.guiParameters.eventData={show:!0,depthTest:!0},this.eventFolder.add(this.guiParameters.eventData,"show").name("Show").listen().onChange(i=>this.sceneManager.groupVisibility(el.EVENT_DATA_ID,i)),this.eventFolder.add(this.guiParameters.eventData,"depthTest").name("Depth Test").listen().onChange(i=>this.three.eventDataDepthTest(i))}addEventDataTypeFolder(e){const t=this.eventFolder.addFolder(e);this.guiParameters.eventData[e]=!0,t.add(this.guiParameters.eventData,e).name("Show").listen().onChange(r=>this.sceneManager.objectVisibility(this.sceneManager.getObjectByName(el.EVENT_DATA_ID).getObjectByName(e),r))}addCollection(e,t,i,r){const s=this.eventFolder.__folders[e];if(!s)return;this.guiParameters[t]={show:!0,color:0,randomColor:()=>this.three.getColorManager().collectionColorRandom(t),resetCut:()=>this.sceneManager.groupVisibility(t,!0,el.EVENT_DATA_ID)};const o=s.addFolder(t);o.add(this.guiParameters[t],"show").name("Show").listen().onChange(u=>{const f=this.sceneManager.getObjectByName(el.EVENT_DATA_ID).getObjectByName(t);f&&this.sceneManager.objectVisibility(f,u)});const h=o.addColor(this.guiParameters[t],"color").name("Color");if(h.onChange(u=>this.three.getColorManager().collectionColor(t,u)),h.setValue(r?.getHex()),o.add(this.guiParameters[t],"randomColor").name("Random Color"),i){const u=o.addFolder("Cuts");u.add(this.guiParameters[t],"resetCut").name("Reset cuts");for(const f of i)u.add({minValue:f.minValue},"minValue",f.minValue,f.maxValue).name("min "+f.field).onChange(B=>{f.minValue=B,this.sceneManager.collectionFilter(t,i)}),u.add({maxValue:f.maxValue},"maxValue",f.minValue,f.maxValue).name("max "+f.field).onChange(B=>{f.maxValue=B,this.sceneManager.collectionFilter(t,i)})}}addLabelsFolder(e){if(null!=this.labelsFolder)return;const{onToggle:t,onSizeChange:i,onColorChange:r,onSaveLabels:s,onLoadLabels:o}=e;this.labelsFolder=this.gui.addFolder(el.LABELS_ID),this.guiParameters.labels={show:!0,size:1,color:"#a8a8a8",saveLabels:s,loadLabels:o},this.labelsFolder.add(this.guiParameters.labels,"show").name("Show").listen().onChange(t),this.labelsFolder.add(this.guiParameters.labels,"size",0,10).name("Size").onFinishChange(i),this.labelsFolder.addColor(this.guiParameters.labels,"color").name("Color").onChange(r),this.labelsFolder.add(this.guiParameters.labels,"saveLabels").name("Save Labels"),this.labelsFolder.add(this.guiParameters.labels,"loadLabels").name("Load Labels")}addLabel(e,t){this.guiParameters[e]={show:!0,color:11513775};const i=this.labelsFolder.addFolder(e);i.add(this.guiParameters[e],"show").name("Show").listen().onChange(o=>{const l=this.sceneManager.getObjectByName(el.LABELS_ID).getObjectByName(e);l&&this.sceneManager.objectVisibility(l,o)}),i.addColor(this.guiParameters[e],"color").name("\xc7olor").onChange(o=>this.sceneManager.changeObjectColor(this.sceneManager.getObjectByName(e),o)),this.guiParameters[e].removeLabel=()=>{t?.(),this.removeLabel(e,i)},i.add(this.guiParameters[e],"removeLabel").name("Remove")}removeLabel(e,t){t||(t=this.labelsFolder.__folders[e]),t&&this.labelsFolder.removeFolder(t)}getEventDataTypeFolder(e){return this.eventFolder.__folders[e]}}var Em=function(n){return n.CHARGE="charge",n.MOM="mom",n.VERTEX="vertex",n}(Em||{});class X1e{constructor(e,t,i,r){this.colorManager=e,this.allColorByOptions=[{key:Em.CHARGE,name:"Charge "+rv.getPrettySymbol("charge"),initialize:this.initChargeColorOptions.bind(this),apply:this.applyChargeColorOptions.bind(this)},{key:Em.MOM,name:"Momentum "+rv.getPrettySymbol("mom"),initialize:this.initMomColorOptions.bind(this),apply:this.applyMomColorOptions.bind(this)},{key:Em.VERTEX,name:"Vertex",apply:this.applyVertexColorOptions.bind(this)}],this.chargeColors={"-1":"#ff0000",0:"#ff0000",1:"#ff0000"},this.momColors={min:{value:0,color:"#ff0000"},max:{value:5e4,color:"#ff0000"}},this.collectionName=t.name,this.colorOptionsFolder=t.addChild("Color Options"),this.colorOptionsFolder.addConfig("color",{label:"Color",color:i?`#${i?.getHexString()}`:void 0,onChange:s=>this.colorManager.collectionColor(this.collectionName,s)}),this.colorOptionsFolder.addConfig("button",{label:"Random",onClick:()=>this.colorManager.collectionColorRandom(this.collectionName)}),r?.length&&r?.length>0&&(this.colorByOptions=this.allColorByOptions.filter(s=>r.includes(s.key)),this.initColorByOptions(),this.colorByOptions.forEach(s=>s.initialize?.()),this.onlySelectedColorByOption())}initColorByOptions(){this.selectedColorByOption=this.colorByOptions[0].key,this.colorOptionsFolder.addConfig("select",{label:"Color by",options:this.colorByOptions.map(e=>e.name),onChange:e=>{const t=this.colorByOptions.find(i=>i.name===e);t?.key&&(this.selectedColorByOption=t.key),t?.apply?.(),this.onlySelectedColorByOption()}})}initChargeColorOptions(){[-1,0,1].forEach(e=>{const t=e.toString();this.colorOptionsFolder.addConfig("color",{label:`${rv.getPrettySymbol("charge")}=${e}`,group:Em.CHARGE,color:this.chargeColors[t],onChange:i=>{this.chargeColors[t]=i,this.selectedColorByOption===Em.CHARGE&&this.colorManager.colorObjectsByProperty(i,this.collectionName,r=>this.shouldColorByCharge(r,e))}})})}applyChargeColorOptions(){[-1,0,1].forEach(e=>{this.colorManager.colorObjectsByProperty(this.chargeColors[e.toString()],this.collectionName,t=>this.shouldColorByCharge(t,e))})}shouldColorByCharge(e,t){return Math.sign(1/parseInt(e?.dparams?.[4]))===t||e?.charge===t}initMomColorOptions(){Object.entries(this.momColors).forEach(([e,t])=>{this.colorOptionsFolder.addConfig("slider",{label:rv.getPrettySymbol("mom")+" "+e,group:Em.MOM,min:this.momColors.min.value,max:this.momColors.max.value,value:this.momColors[e].value,step:10,allowCustomValue:!0,onChange:i=>{this.momColors[e].value=i,this.selectedColorByOption===Em.MOM&&(this.colorByMomentum("min"),this.colorByMomentum("max"))}}),this.colorOptionsFolder.addConfig("color",{label:rv.getPrettySymbol("mom")+" "+e+" color",group:Em.MOM,color:t.color,onChange:i=>{this.momColors[e].color=i,this.selectedColorByOption===Em.MOM&&this.colorByMomentum(e)}})})}applyMomColorOptions(){this.colorByMomentum("min"),this.colorByMomentum("max")}colorByMomentum(e){this.colorManager.colorObjectsByProperty(this.momColors[e].color,this.collectionName,t=>{const i=this.getMomentum(t),r=(this.momColors.min.value+this.momColors.max.value)/2;return"max"===e&&i>r&&i<this.momColors.max.value||"min"===e&&i<r&&i>this.momColors.min.value})}getMomentum(e){return e?.dparams?.[4]?Math.abs(1/parseFloat(e?.dparams?.[4])):e?.mom}applyVertexColorOptions(){this.colorManager.colorTracksByVertex(this.collectionName)}onlySelectedColorByOption(){this.colorOptionsFolder.configs.forEach(e=>{e.hidden=void 0!==e.group&&e.group!==this.selectedColorByOption})}}class WL{constructor(e,t){this.phoenixMenuRoot=e,this.three=t,this.sceneManager=t.getSceneManager()}clear(){this.phoenixMenuRoot&&this.phoenixMenuRoot.truncate(),this.eventFolderState=void 0}addGeometryFolder(){void 0===this.eventFolderState&&(this.geomFolder=this.phoenixMenuRoot.addChild("Detector",e=>{this.sceneManager.groupVisibility(el.GEOMETRIES_ID,e)},"perspective")),this.geomFolder.addConfig("checkbox",{label:"Wireframe",isChecked:!1,onChange:e=>{this.sceneManager.wireframeGeometries(e)}}).addConfig("slider",{label:"Opacity",min:0,max:1,step:.01,allowCustomValue:!0,onChange:e=>{this.sceneManager.setGeometryOpacity(this.sceneManager.getObjectByName(el.GEOMETRIES_ID),e)}}).addConfig("slider",{label:"Scale",min:0,max:20,step:.01,allowCustomValue:!0,onChange:e=>{this.sceneManager.scaleObject(this.sceneManager.getObjectByName(el.GEOMETRIES_ID),e)}})}addGeometry(e,t){const{name:i,material:r,visible:s}=e,o=r?.color;let l=this.geomFolder;t&&(l=this.geomFolder.findInTreeOrCreate(t));let h=i.lastIndexOf(" > ");h<0?h=0:h+=3;const u=l.addChild(i.substring(h),f=>{this.sceneManager.objectVisibility(e,f)});u.toggleState=s,u.addConfig("color",{label:"Color",color:o?`#${new nr(o).getHexString()}`:void 0,onChange:f=>{this.sceneManager.changeObjectColor(e,f)}}).addConfig("slider",{label:"Opacity",min:0,max:1,step:.05,allowCustomValue:!0,onChange:f=>{this.sceneManager.setGeometryOpacity(e,f)}}).addConfig("button",{label:"Remove",onClick:()=>{u.remove(),this.sceneManager.removeGeometry(e)}})}addEventDataFolder(){this.eventFolder&&(this.eventFolderState=this.eventFolder.getNodeState(),this.eventFolder.remove()),this.eventFolder=this.phoenixMenuRoot.addChild("Event Data",e=>{this.sceneManager.groupVisibility(el.EVENT_DATA_ID,e)},"event-folder"),this.eventFolder.addConfig("checkbox",{label:"Depth Test",isChecked:!0,onChange:e=>{this.three.eventDataDepthTest(e)}})}addEventDataTypeFolder(e){this.eventFolder.addChild(e,t=>{this.sceneManager.objectVisibility(this.sceneManager.getObjectByName(el.EVENT_DATA_ID).getObjectByName(e),t)})}addCollection(e,t,i,r){const s=this.eventFolder.children.find(h=>h.name===e);if(!s)return;const o=s.addChild(t,h=>{const u=this.sceneManager.getObjectByName(el.EVENT_DATA_ID).getObjectByName(t);u&&this.sceneManager.objectVisibility(u,h)});this.addDrawOptions(o,t),i&&i.length>0&&this.addCutOptions(o,t,i);const l=[];"Tracks"===s.name&&l.push(Em.CHARGE,Em.MOM,Em.VERTEX),new X1e(this.three.getColorManager(),o,r||new nr,l)}addCutOptions(e,t,i){const r=e.addChild("Cut Options");r.addConfig("label",{label:"Cuts"}).addConfig("button",{label:"Reset cuts",onClick:()=>{this.sceneManager.groupVisibility(t,!0,el.EVENT_DATA_ID);for(const s of i)s.reset()}});for(const s of i)r.addConfig("rangeSlider",{label:rv.getPrettySymbol(s.field),min:s.minValue,max:s.maxValue,step:s.step,value:s.minValue,highValue:s.maxValue,enableMin:s.minCutActive,enableMax:s.maxCutActive,onChange:({value:o,highValue:l})=>{s.minValue=o,s.maxValue=l,this.sceneManager.collectionFilter(t,i)},setEnableMin:o=>{s.enableMinCut(o),this.sceneManager.collectionFilter(t,i)},setEnableMax:o=>{s.enableMaxCut(o),this.sceneManager.collectionFilter(t,i)}})}addDrawOptions(e,t){const i=e.addChild("Draw Options");i.addConfig("slider",{label:"Opacity",min:.1,step:.1,max:1,onChange:r=>{const s=this.sceneManager.getObjectByName(el.EVENT_DATA_ID);if(s){const o=s.getObjectByName(t);o&&this.sceneManager.setGeometryOpacity(o,r)}}}),i.addConfig("checkbox",{label:"Wireframe",onChange:r=>this.sceneManager.wireframeObjects(this.sceneManager.getObjectByName(el.EVENT_DATA_ID)?.getObjectByName(t),r)})}addLabelsFolder(e){if(this.labelsFolder)return;const{onToggle:t,onSizeChange:i,onColorChange:r,onSaveLabels:s,onLoadLabels:o}=e;this.labelsFolder=this.phoenixMenuRoot.addChild(el.LABELS_ID,t,"info"),this.labelsFolder.addConfig("slider",{label:"Size",min:0,max:10,step:.01,allowCustomValue:!0,onChange:i}),this.labelsFolder.addConfig("color",{label:"Color",color:"#a8a8a8",onChange:r}),this.labelsFolder.addConfig("button",{label:"Save Labels",onClick:s}),this.labelsFolder.addConfig("button",{label:"Load Labels",onClick:o})}addLabel(e,t){let i=this.labelsFolder.children.find(r=>r.name===e);i||(i=this.labelsFolder.addChild(e,r=>{const s=this.sceneManager.getObjectByName(el.LABELS_ID).getObjectByName(e);s&&this.sceneManager.objectVisibility(s,r)}),i.addConfig("color",{label:"Color",color:"#a8a8a8",onChange:r=>{this.sceneManager.changeObjectColor(this.sceneManager.getObjectByName(e),r)}}),i.addConfig("button",{label:"Remove",onClick:()=>{t?.(),this.removeLabel(e,i)}}))}removeLabel(e,t){t||(t=this.labelsFolder?.children.find(i=>i.name===e)),t?.remove()}getEventDataTypeFolder(e){return this.eventFolder.children.find(t=>t.name===e)}loadEventFolderState(){this.eventFolderState&&this.eventFolder.loadStateFromJSON(this.eventFolderState)}}const qW=n=>{try{return localStorage.getItem(n)}catch(e){console.warn("Exception in localStorage",e)}},K1e=[{name:"Cavern to ID",positions:[{position:[66388.95051168812,5264.228603228927,-46910.7848593543],duration:1e3},{position:[12834.18729094943,677.7571205763458,135.68755273443463],duration:2e3},{position:[312.02688693297375,25.884223757326,270.10019006776236],duration:3500},{position:[263.3640855132258,19.874838262525053,-318.16541790248885],duration:3e3},{position:[5534.140362338047,234.03507981484574,-2933.619479808285],duration:2e3},{position:[2681.277288705242,646.5795158318147,5628.5248735111745],duration:1e3},{position:[-6062.586283740076,790.5876682946184,1381.1675900848818],duration:1e3},{position:[-1766.7693725879053,1007.1048030984678,-5928.901341784575],duration:1e3},{position:[12814.982506255355,2516.987185037266,-22891.902734328327],duration:1e3}],animateEventAfterInterval:5e3,collisionDuration:6e3}];class Z1e{constructor(e){this.three=e,this.uiMenus=[],this.geomFolderAdded=!1,this.labelsFolderAdded=!1}init(e){this.clearUI(),this.configuration=e,this.showStats(e.elementId),this.uiMenus=[],e.enableDatGUIMenu&&this.uiMenus.push(new GW(e.elementId,this.three)),e.phoenixMenuRoot&&this.uiMenus.push(new WL(e.phoenixMenuRoot,this.three)),e.forceColourTheme?this.setDarkTheme("dark"==e.forceColourTheme.toLocaleLowerCase()):this.detectColorScheme(),this.stateManager=new TA,e.phoenixMenuRoot&&this.stateManager.setPhoenixMenuRoot(e.phoenixMenuRoot)}showStats(e="eventDisplay"){this.stats=new M1e,this.stats.showPanel(0),this.stats.dom.className="ui-element",this.stats.dom.id="statsElement",this.stats.domElement.style.cssText="position: absolute; left: 0px; cursor: pointer; opacity: 0.9; z-index: 10; bottom: 0px;";let t=document.getElementById(e);null==t&&(t=document.body),t.appendChild(this.stats.dom)}updateUI(){this.stats.update()}clearUI(){this.uiMenus.forEach(e=>e.clear()),this.geomFolderAdded=!1,this.labelsFolderAdded=!1}addGeomFolder(){this.geomFolderAdded=!0,this.uiMenus.forEach(e=>e.addGeometryFolder())}addGeometry(e,t){this.geomFolderAdded||this.addGeomFolder(),this.uiMenus.forEach(i=>i.addGeometry(e,t))}addEventDataFolder(){this.uiMenus.forEach(e=>e.addEventDataFolder())}addEventDataTypeFolder(e){this.uiMenus.forEach(t=>t.addEventDataTypeFolder(e))}addCollection(e,t,i,r){this.uiMenus.forEach(s=>s.addCollection(e,t,i,r))}addLabelsFolder(){const e=this.three.getSceneManager();this.labelsFolderAdded=!0;const t=l=>{e.objectVisibility(e.getObjectByName(el.LABELS_ID),l)},i=l=>{const h=e.getObjectByName(el.LABELS_ID);e.scaleObject(h,l)},r=l=>{const h=e.getObjectByName(el.LABELS_ID);e.changeObjectColor(h,l)},s=()=>{const l=this.configuration?.eventDataLoader?.getLabelsObject();l&&_B(JSON.stringify(l),"phoenix-labels.json")},o=()=>{this.loadLabelsFile()};this.uiMenus.forEach(l=>l.addLabelsFolder({onToggle:t,onSizeChange:i,onColorChange:r,onSaveLabels:s,onLoadLabels:o}))}addLabel(e){this.labelsFolderAdded||this.addLabelsFolder(),this.uiMenus.forEach(t=>t?.addLabel(e,()=>this.removeLabel(e)))}removeLabel(e,t){this.three.getSceneManager().removeLabel(e);const i=e.split(" > "),r=this.configuration.eventDataLoader?.getLabelsObject();delete r?.[i[0]]?.[i[1]]?.[i[2]],t&&this.uiMenus.forEach(s=>s.removeLabel(e))}geometryVisibility(e,t){const i=this.three.getSceneManager();i.objectVisibility(i.getObjectByName(e),t)}rotateStartAngleClipping(e){const t=this.stateManager.getOpeningClippingAngle();this.three.setClippingAngle(e,t),this.stateManager.setStartClippingAngle(e)}rotateOpeningAngleClipping(e){const t=this.stateManager.getStartClippingAngle();this.three.setClippingAngle(t,e),this.stateManager.setOpeningClippingAngle(e)}setClipping(e){this.three.setClipping(e),this.stateManager.setClippingEnabled(e)}detectColorScheme(){let e=!1;qW("theme")?"dark"===qW("theme")&&(e=!0):window.matchMedia&&matchMedia("(prefers-color-scheme: dark)").matches&&(e=!0),this.darkTheme=e,this.setDarkTheme(e)}setDarkTheme(e){const t=e?"dark":"light";((n,e)=>{try{localStorage.setItem("theme",e)}catch(t){console.warn("Exception in localStorage",t)}})(0,t),document.documentElement.setAttribute("data-theme",t),this.three.setDarkColor(e)}getDarkTheme(){return this.darkTheme}setAutoRotate(e){this.three.autoRotate(e)}setShowAxis(e){this.three.getSceneManager().setAxis(e)}translateCartesianGrid(e){this.three.getSceneManager().translateCartesianGrid(e)}translateCartesianLabels(e){this.three.getSceneManager().translateCartesianLabels(e)}showLabels(e){this.three.getSceneManager().showLabels(e)}setShowCartesianGrid(e,t,i){typeof i>"u"?this.three.getSceneManager().setCartesianGrid(e,t):this.three.getSceneManager().setCartesianGrid(e,t,i)}getCartesianGridConfig(){return this.three.getSceneManager().getCartesianGridConfig()}setShowEtaPhiGrid(e){this.three.getSceneManager().setEtaPhiGrid(e)}show3DMousePoints(e){this.three.show3DMousePoints(e)}show3DDistance(e){this.three.show3DDistance(e)}shiftCartesianGridByPointer(){this.three.shiftCartesianGrid()}getPresetViews(){return this.configuration&&this.configuration.presetViews?this.configuration.presetViews:[]}getPresetAnimations(){return this.configuration?.presetAnimations?this.configuration?.presetAnimations:K1e}displayView(e){this.three.animateCameraTransform(e.cameraPos,e.cameraTarget,1e3),e.clipping!=$C.NotForced&&(this.rotateStartAngleClipping(e.clippingStartAngle),this.rotateOpeningAngleClipping(e.clippingOpeningAngle),this.setClipping(e.clipping==$C.On))}toggleOrthographicView(e){this.three.swapCameras(e)}setOverlayRenderer(e){this.three.setOverlayRenderer(e)}enableKeyboardControls(){document.addEventListener("keydown",e=>{if(!["input","textarea"].includes(e.target?.tagName.toLowerCase())&&e.shiftKey&&("KeyT"===e.code&&this.setDarkTheme(!this.getDarkTheme()),this.configuration?.presetViews&&e.code.startsWith("Digit"))){const i=parseInt(e.code.slice(-1))-1;this.configuration.presetViews?.[i]&&this.displayView(this.configuration.presetViews[i])}})}loadLabelsFile(){const e=this.configuration?.eventDataLoader,t=e?.getLabelsObject();e&&t&&tW(i=>{console.log("UIManager: loading Labels");const r=JSON.parse(i);for(const s of Object.keys(r))for(const o of Object.keys(r[s])){const l=e.getCollection(o);if(l)for(const h of Object.keys(r[s][o])){const u=r[s][o][h],f=l[h].uuid,y=e.addLabelToEventObject(u,o,Number(h));this.addLabel(y),this.three.addLabelToObject(u,f,y)}else console.log("WARNING - cannot find ",o," in eventDataLoader. Skipping.")}})}loadEventFolderPhoenixMenuState(){this.uiMenus.find(t=>t instanceof WL)?.loadEventFolderState()}getUIMenus(){return this.uiMenus}}class J1e{constructor(){this.infoLoggerList=[],this.maxEntries=10}add(e,t){this.infoLoggerList.length>this.maxEntries&&this.infoLoggerList.pop(),this.infoLoggerList.unshift(t?t+": "+e:e)}getInfoLoggerList(){return this.infoLoggerList}}class Cl{constructor(e,t,i,r=1,s=!0,o=!0){this.field=e,this.minValue=t,this.maxValue=i,this.step=r,this.minCutActive=s,this.maxCutActive=o,this.defaultMinValue=t,this.defaultMaxValue=i,this.defaultApplyMinValue=s,this.defaultApplyMaxValue=o}enableMaxCut(e){this.maxCutActive=e}enableMinCut(e){this.minCutActive=e}cutPassed(e){return(!this.maxCutActive||e<=this.maxValue)&&(!this.minCutActive||e>this.minValue)}reset(){this.minValue=this.defaultMinValue,this.maxValue=this.defaultMaxValue,this.minCutActive=this.defaultApplyMinValue,this.maxCutActive=this.defaultApplyMaxValue}}const tve=new Dt,QW=new class m_e{constructor(e=new Dt,t=new Dt){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Oj.subVectors(e,this.start),hB.subVectors(this.end,this.start);const i=hB.dot(hB);let s=hB.dot(Oj)/i;return t&&(s=xh(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},$L=new MA,jW=new Dt,TB=new xm;class nve{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new WW,this.unassigned=new WW,this.vertices=[]}setFromPoints(e){if(e.length>=4){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.vertices.push(new ive(e[t]));this.compute()}return this}setFromObject(e){const t=[];return e.updateMatrixWorld(!0),e.traverse(function(i){const r=i.geometry;if(void 0!==r){const s=r.attributes.position;if(void 0!==s)for(let o=0,l=s.count;o<l;o++){const h=new Dt;h.fromBufferAttribute(s,o).applyMatrix4(i.matrixWorld),t.push(h)}}}),this.setFromPoints(t)}containsPoint(e){const t=this.faces;for(let i=0,r=t.length;i<r;i++)if(t[i].distanceToPoint(e)>this.tolerance)return!1;return!0}intersectRay(e,t){const i=this.faces;let r=-1/0,s=1/0;for(let o=0,l=i.length;o<l;o++){const h=i[o],u=h.distanceToPoint(e.origin),f=h.normal.dot(e.direction);if(u>0&&f>=0)return null;const y=0!==f?-u/f:0;if(!(y<=0)&&(f>0?s=Math.min(y,s):r=Math.max(y,r),r>s))return null}return e.at(r!==-1/0?r:s,t),t}intersectsRay(e){return null!==this.intersectRay(e,tve)}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(e,t){return e.face=t,null===t.outside?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this}removeVertexFromFace(e,t){return e===t.outside&&(t.outside=null!==e.next&&e.next.face===t?e.next:null),this.assigned.remove(e),this}removeAllVerticesFromFace(e){if(null!==e.outside){const t=e.outside;let i=e.outside;for(;null!==i.next&&i.next.face===e;)i=i.next;return this.assigned.removeSubList(t,i),t.prev=i.next=null,e.outside=null,t}}deleteFaceVertices(e,t){const i=this.removeAllVerticesFromFace(e);if(void 0!==i)if(void 0===t)this.unassigned.appendChain(i);else{let r=i;do{const s=r.next;t.distanceToPoint(r.point)>this.tolerance?this.addVertexToFace(r,t):this.unassigned.append(r),r=s}while(null!==r)}return this}resolveUnassignedPoints(e){if(!1===this.unassigned.isEmpty()){let t=this.unassigned.first();do{const i=t.next;let r=this.tolerance,s=null;for(let o=0;o<e.length;o++){const l=e[o];if(0===l.mark){const h=l.distanceToPoint(t.point);if(h>r&&(r=h,s=l),r>1e3*this.tolerance)break}}null!==s&&this.addVertexToFace(t,s),t=i}while(null!==t)}return this}computeExtremes(){const e=new Dt,t=new Dt,i=[],r=[];for(let s=0;s<3;s++)i[s]=r[s]=this.vertices[0];e.copy(this.vertices[0].point),t.copy(this.vertices[0].point);for(let s=0,o=this.vertices.length;s<o;s++){const l=this.vertices[s],h=l.point;for(let u=0;u<3;u++)h.getComponent(u)<e.getComponent(u)&&(e.setComponent(u,h.getComponent(u)),i[u]=l);for(let u=0;u<3;u++)h.getComponent(u)>t.getComponent(u)&&(t.setComponent(u,h.getComponent(u)),r[u]=l)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(e.x),Math.abs(t.x))+Math.max(Math.abs(e.y),Math.abs(t.y))+Math.max(Math.abs(e.z),Math.abs(t.z))),{min:i,max:r}}computeInitialHull(){const e=this.vertices,t=this.computeExtremes(),i=t.min,r=t.max;let s=0,o=0;for(let T=0;T<3;T++){const B=r[T].point.getComponent(T)-i[T].point.getComponent(T);B>s&&(s=B,o=T)}const l=i[o],h=r[o];let u,f;s=0,QW.set(l.point,h.point);for(let T=0,B=this.vertices.length;T<B;T++){const j=e[T];if(j!==l&&j!==h){QW.closestPointToPoint(j.point,!0,jW);const ne=jW.distanceToSquared(j.point);ne>s&&(s=ne,u=j)}}s=-1,$L.setFromCoplanarPoints(l.point,h.point,u.point);for(let T=0,B=this.vertices.length;T<B;T++){const j=e[T];if(j!==l&&j!==h&&j!==u){const ne=Math.abs($L.distanceToPoint(j.point));ne>s&&(s=ne,f=j)}}const y=[];if($L.distanceToPoint(f.point)<0){y.push(Ug.create(l,h,u),Ug.create(f,h,l),Ug.create(f,u,h),Ug.create(f,l,u));for(let T=0;T<3;T++){const B=(T+1)%3;y[T+1].getEdge(2).setTwin(y[0].getEdge(B)),y[T+1].getEdge(1).setTwin(y[B+1].getEdge(0))}}else{y.push(Ug.create(l,u,h),Ug.create(f,l,h),Ug.create(f,h,u),Ug.create(f,u,l));for(let T=0;T<3;T++){const B=(T+1)%3;y[T+1].getEdge(2).setTwin(y[0].getEdge((3-T)%3)),y[T+1].getEdge(0).setTwin(y[B+1].getEdge(1))}}for(let T=0;T<4;T++)this.faces.push(y[T]);for(let T=0,B=e.length;T<B;T++){const j=e[T];if(j!==l&&j!==h&&j!==u&&j!==f){s=this.tolerance;let ne=null;for(let se=0;se<4;se++){const le=this.faces[se].distanceToPoint(j.point);le>s&&(s=le,ne=this.faces[se])}null!==ne&&this.addVertexToFace(j,ne)}}return this}reindexFaces(){const e=[];for(let t=0;t<this.faces.length;t++){const i=this.faces[t];0===i.mark&&e.push(i)}return this.faces=e,this}nextVertexToAdd(){if(!1===this.assigned.isEmpty()){let e,t=0;const i=this.assigned.first().face;let r=i.outside;do{const s=i.distanceToPoint(r.point);s>t&&(t=s,e=r),r=r.next}while(null!==r&&r.face===i);return e}}computeHorizon(e,t,i,r){let s;this.deleteFaceVertices(i),i.mark=1,s=null===t?t=i.getEdge(0):t.next;do{const o=s.twin,l=o.face;0===l.mark&&(l.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,o,l,r):r.push(s)),s=s.next}while(s!==t);return this}addAdjoiningFace(e,t){const i=Ug.create(e,t.tail(),t.head());return this.faces.push(i),i.getEdge(-1).setTwin(t.twin),i.getEdge(0)}addNewFaces(e,t){this.newFaces=[];let i=null,r=null;for(let s=0;s<t.length;s++){const l=this.addAdjoiningFace(e,t[s]);null===i?i=l:l.next.setTwin(r),this.newFaces.push(l.face),r=l}return i.next.setTwin(r),this}addVertexToHull(e){const t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let e;for(this.computeInitialHull();void 0!==(e=this.nextVertexToAdd());)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}class Ug{constructor(){this.normal=new Dt,this.midpoint=new Dt,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}static create(e,t,i){const r=new Ug,s=new XL(e,r),o=new XL(t,r),l=new XL(i,r);return s.next=l.prev=o,o.next=s.prev=l,l.next=o.prev=s,r.edge=s,r.compute()}getEdge(e){let t=this.edge;for(;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t}compute(){const e=this.edge.tail(),t=this.edge.head(),i=this.edge.next.head();return TB.set(e.point,t.point,i.point),TB.getNormal(this.normal),TB.getMidpoint(this.midpoint),this.area=TB.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(e){return this.normal.dot(e)-this.constant}}class XL{constructor(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceTo(e.point):-1}lengthSquared(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceToSquared(e.point):-1}setTwin(e){return this.twin=e,e.twin=this,this}}class ive{constructor(e){this.point=e,this.prev=null,this.next=null,this.face=null}}class WW{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(e,t){return t.prev=e.prev,t.next=e,null===t.prev?this.head=t:t.prev.next=t,e.prev=t,this}insertAfter(e,t){return t.prev=e,t.next=e.next,null===t.next?this.tail=t:t.next.prev=t,e.next=t,this}append(e){return null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this}appendChain(e){for(null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail;null!==e.next;)e=e.next;return this.tail=e,this}remove(e){return null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,this}removeSubList(e,t){return null===e.prev?this.head=t.next:e.prev.next=t.next,null===t.next?this.tail=e.prev:t.next.prev=e.prev,this}isEmpty(){return null===this.head}}class rve extends Hs{constructor(e=[]){super();const t=[],i=[],s=(new nve).setFromPoints(e).faces;for(let o=0;o<s.length;o++){const l=s[o];let h=l.edge;do{const u=h.head().point;t.push(u.x,u.y,u.z),i.push(l.normal.x,l.normal.y,l.normal.z),h=h.next}while(h!==l.edge)}this.setAttribute("position",new Bs(t,3)),this.setAttribute("normal",new Bs(i,3))}}const Bp={Hits:new nr(16711680),Tracks:new nr(16711680),Jets:new nr(2200782),CaloClusters:new nr(16765286),MuonChambers:new nr(16711680),Vertices:new nr(16765286),MissingEnergy:new nr(16777215),PlanarCaloCells:new nr(16774810)};class YL{static step(e){const t=e.q/(e.unitC*e.p);let i,r,s,o,l=new Dt,h=new Dt,u=new Dt;const f=KL.get(e.pos),y=e.dir.clone().cross(f).multiplyScalar(t),T=se=>{i=se*se,r=se/2;const le=e.pos.clone().add(e.dir.clone().multiplyScalar(r)).add(y.clone().multiplyScalar(i/8));s=KL.get(le),l=e.dir.clone().add(y.clone().multiplyScalar(r)).cross(s).multiplyScalar(t),h=e.dir.clone().add(l.clone().multiplyScalar(r)).cross(s).multiplyScalar(t);const Ee=e.pos.clone().add(e.dir.clone().multiplyScalar(se)).add(h.clone().multiplyScalar(i/2));o=KL.get(Ee),u=e.dir.clone().add(h.clone().multiplyScalar(se)).cross(o).multiplyScalar(t);const Pe=y.clone().sub(l).sub(h).add(u);return se*(Math.abs(Pe.x)+Math.abs(Pe.y)+Math.abs(Pe.z))};let B=T(e.stepSize);for(;B>2e-4;)e.stepSize*=.5,B=T(e.stepSize);const j=e.stepSize,ne=Math.pow(j,2);return e.pos.add(e.dir.clone().multiplyScalar(j)).add(y.clone().add(l).add(h).multiplyScalar(ne/6)),e.dir.add(y.clone().add(l.clone().multiplyScalar(2)).add(h.clone().multiplyScalar(2)).add(u).multiplyScalar(j/6)),e.dir.normalize(),e.stepSize}static propagate(e,t,i,r,s=-1,o=1e3,l=()=>!0){const h=new sve;h.pos=e,h.dir=t,h.p=i,h.q=r,h.maxStepSize=s;const u=[];for(;h.pathLength<o;){h.pathLength+=YL.step(h);const f=JSON.parse(JSON.stringify(h));if(u.push({pos:f.pos,dir:f.dir}),!l(f.pos))break}return u}}class sve{constructor(){this.pos=new Dt(0,0,0),this.dir=new Dt(0,0,0),this.p=0,this.q=1,this.unitC=3.3333,this.stepSize=1e3,this.maxStepSize=10,this.pathLength=0}}class KL{static get(e){return new Dt(0,0,2)}}class pT{static extrapolationLimit(e){return!(e.z>3e3||Math.sqrt(e.x*e.x+e.y*e.y)>1100)}static getTracksWithRungeKutta(e){const t=Object.assign({},e);for(const r of Object.keys(t))for(const s of t[r])s.pos=pT.extrapolateTrackPositions(s);return{}}static extrapolateTrackPositions(e,t=pT.extrapolationLimit){const i=e.dparams,r=i[0],o=i[2];let l=i[3];const h=i[4];let u;l<0&&(l+=Math.PI),u=0!==h?Math.abs(1/h):Number.MAX_VALUE;const f=Math.round(u*h),y=jf.sphericalToCartesian(u,l,o),T=jf.sphericalToCartesian(r,l,o),B=[];B.push([T.x,T.y,T.z]);const j=y.clone();j.normalize();const se=YL.propagate(T,j,u,f,5,1500,t).map(le=>[le.pos.x,le.pos.y,le.pos.z]);return B.concat(se)}}class Eh{static getTracks(e){const t=new AW,i=new t1e({linewidth:2});for(const s of e){if(s.pos?.length>2||(s.dparams&&(s.pos=pT.extrapolateTrackPositions(s)),s.extended=!0),s.pos.length<2){console.log("Track too short, and extrapolation failed.");continue}s?.dparams&&(s?.phi||(s.phi=s.dparams[2]),s?.eta||(s.eta=jf.thetaToEta(s.dparams[3])),s?.d0||(s.d0=s.dparams[0]),s?.z0||(s.z0=s.dparams[1]));const o=s.pos.map(f=>new Dt(f[0],f[1],f[2])),h=new V5(o).getPoints(50),u=s.color?parseInt(s.color,16):Bp.Tracks.getHex();s.tid=t.addTrack(h,u),s.material=i}t.process();const r=new jo(t,i);r.name="Track";for(const s of e)s.uuid=r.uuid;return r}static getTrack(e){e.pos?.length>2||(e.dparams&&(e.pos=pT.extrapolateTrackPositions(e)),e.extended=!0);const t=e.pos,i=new Xl;if(t.length<2)return console.log("Track too short, and extrapolation failed."),i;e?.dparams&&(e?.phi||(e.phi=e.dparams[2]),e?.eta||(e.eta=jf.thetaToEta(e.dparams[3])),e?.d0||(e.d0=e.dparams[0]),e?.z0||(e.z0=e.dparams[1]));const r=e.color?parseInt(e.color,16):Bp.Tracks.getHex(),s=e.linewidth?e.linewidth:2,o=[];for(let ne=0;ne<t.length;ne++){o.push(new Dt(t[ne][0],t[ne][1],t[ne][2]));const se=Math.sqrt(t[ne][0]*t[ne][0]+t[ne][1]*t[ne][1]+t[ne][2]*t[ne][2]);Math.acos(t[ne][2]/se)}const l=new V5(o),h=new lx(l,void 0,s),u=new hj({color:r}),f=new jo(h,u),y=l.getPoints(50),T=(new Hs).setFromPoints(y),B=new Bc({color:r,linewidth:s}),j=new kg(T,B);j.name="Track",i.add(f),i.add(j);for(const ne of[f,i,j])ne.userData=Object.assign({},e),ne.name="Track";return e.uuid=i.uuid,i}static getJet(e){const i=e.phi,r=e.theta?e.theta:jf.etaToTheta(e.eta),s=.2*(e.energy?e.energy:e.et),o=Math.sin(i),l=Math.cos(i),h=Math.sin(r),u=Math.cos(r),f=new Dt(.5*s*l*h,.5*s*o*h,.5*s*u),y=e.coneR?s*Math.sin(e.coneR):.1*s,T=l*h,B=o*h,j=u,ne=new Dt(0,1,0),se=new Dt(T,B,j),le=new zc;le.setFromUnitVectors(ne,se);const Ee=new OC(y,10,s,50,50,!1),Pe=new wh({color:e.color??Bp.Jets,opacity:.3,transparent:!0});Pe.opacity=.5;const Ve=new jo(Ee,Pe);return Ve.position.copy(f),Ve.quaternion.copy(le),Ve.userData=Object.assign({},e),Ve.name="Jet",e.uuid=Ve.uuid,Ve}static getHits(e){let t,r="Point",s=3,o=!1;if(!(e.length>0))return console.log("No hits! Aborting from getHits."),new Wa;{const f=e[0];Array.isArray(f)?(o=!0,t={pos:e}):(t=e,"type"in f&&(r=f.type))}("Line"===r||"Box"===r)&&(s=6);const l=e.length*s;o&&(length=l);const h=new Float32Array(l);let u=0;for(const f of e)for(let y=0;y<s;++y,++u)h[u]=o?f[y]:f.pos[y];switch(r){case"Point":return Eh.hitsToPoints(h,e,t);case"CircularPoint":return Eh.hitsToCircularPoints(h,e,t);case"Line":return Eh.hitsToLines(h,e,t);case"Box":return Eh.hitsToBoxes(h,e,t);default:return console.log("ERROR: Unknown hit type!"),new Wa}}static hitsToPoints(e,t,i){const r=new Hs;r.setAttribute("position",new To(e,3)),r.computeBoundingSphere();const o=new sy({size:10,color:parseInt(t[0].color)??Bp.Hits}),l=new sx(r,o);return l.userData={},l.name="Hit",t.uuid=l.uuid,l}static hitsToCircularPoints(e,t,i){const r=new Hs;r.setAttribute("position",new To(e,3)),r.computeBoundingSphere();const s=document.createElement("canvas");s.width=128,s.height=128;const o=s.getContext("2d");o&&(o.clearRect(0,0,128,128),o.fillStyle="white",o.beginPath(),o.arc(64,64,64,0,2*Math.PI),o.fill());const l=new XQ(s),h=new sy({size:t[0].size??10,color:t[0].color??Bp.Hits,map:l,alphaMap:l,alphaTest:.5}),u=new sx(r,h);return u.userData={},u.name="CircularHit",t.uuid=u.uuid,u}static hitsToLines(e,t,i){const r=new Hs;r.setAttribute("position",new To(e,3)),r.computeBoundingSphere();const s=new Bc({linewidth:2,color:t.color??Bp.Hits}),o=new yc(r,s);return o.userData={},o.name="LineHit",t.uuid=o.uuid,o}static hitsToBoxes(e,t,i){const r=[];for(let h=0;h<e.length;h+=6){const u=new Tp(e[h+3],e[h+4],e[h+5]);u.translate(e[h],e[h+1],e[h+2]),r.push(u)}const s=wL(r);s.computeBoundingSphere();const o=new Og({color:parseInt(t[0].color)??Bp.Hits}),l=new jo(s,o);return l.userData={},l.name="BoxHit",t.uuid=l.uuid,l}static getCluster(e,t=1800,i=3600,r=.03){const l=Eh.getCaloCube(e,e.side??40,e.energy*r),h=Eh.getCaloPosition(e,t,i);return l.position.copy(h),l.lookAt(new Dt(0,0,0)),l.userData=Object.assign({},e),l.name="Cluster",e.uuid=l.uuid,l}static getCaloPosition(e,t=1800,i=3600,r=!0){const s=e.theta??jf.etaToTheta(e.eta),l=jf.sphericalToCartesian(r?e.radius??t+i:e.radius??t,s,e.phi);if(e.z&&l.setLength(l.length()*e.z/Math.abs(l.z)),!e.radius&&!e.z){Math.abs(l.z)>i&&l.setLength(l.length()*i/Math.abs(l.z));const h=l.x*l.x+l.y*l.y,u=t*t;h>u&&l.setLength(l.length()*Math.sqrt(u)/Math.sqrt(h))}return l}static getCaloCube(e,t=30,i=30){const r=e.side??t;let s=e.length??i;s<r&&(s=r);const o=new Tp(r,r,s),l=new Og({color:e.color??Bp.CaloClusters,opacity:e.opacity??1,transparent:1!=(e.opacity??1)});return new jo(o,l)}static getCaloCell(e){const o=Eh.getCaloCube(e,30,30),l=Eh.getCaloPosition(e,1700,2e3);return o.position.copy(l),e.radius||e.z?e.z&&!e.radius&&o.lookAt(new Dt(l.x,l.y,0)):o.lookAt(new Dt(0,0,0)),e.radius&&o.lookAt(new Dt(0,0,l.z)),o.userData=Object.assign({},e),o.name="Cluster",e.uuid=o.uuid,o}static getPlanarCaloCells(e){const t=[];for(const s of e){const o=s.pos;if(!o)continue;const l=.22*s.energy,h=s.cellSize,u=s.plane,f=new Tp(h,h,l);f.translate(o[0],o[1],u[3]+l/2);const y=new zc;y.setFromUnitVectors(new Dt(0,0,1),new Dt(...u.slice(0,3))),f.applyQuaternion(y),t.push(f)}const i=new Og({color:e[0].color??Bp.PlanarCaloCells}),r=new jo(wL(t),i);r.userData=Object.assign({},e[0]),r.name="PlanarCaloCell";for(const s of e)s.uuid=r.uuid;return r}static getPlanarCaloCell(e){const t=e.pos;if(!t)return new Wa;const i=.22*e.energy,r=e.cellSize,s=e.plane,o=new Tp(r,r,i),l=new Wa,h=new Og({color:e.color??Bp.PlanarCaloCells}),u=new jo(o,h);l.add(u);const f=new Dt(...t.slice(0,2),s[3]+i/2);u.position.copy(f);const y=new zc;return y.setFromUnitVectors(new Dt(0,0,1),new Dt(...s.slice(0,3))),l.quaternion.copy(y),l.userData=Object.assign({},e),l.name="PlanarCaloCell",e.uuid=l.uuid,l}static getVertex(e){const t=new ev(e.size??3),i=new Og({color:e.color??Bp.Vertices}),r=new jo(t,i);return"pos"in e?(r.position.x=e.pos[0],r.position.y=e.pos[1],r.position.z=e.pos[2]):(r.position.x=e.x,r.position.y=e.y,r.position.z=e.z),r.userData=Object.assign({},e),r.name="Vertex",e.uuid=r.uuid,r}static getMissingEnergy(e){const t=[];t.push(new Dt(0,0,0)),t.push(new Dt(e.etx,e.ety,0));const i=(new Hs).setFromPoints(t),r=new cx({linewidth:2,dashSize:2,color:e.color??Bp.MissingEnergy}),s=new kg(i,r);return s.computeLineDistances(),s.userData=Object.assign({},e),s.name="Missing Energy",e.uuid=s.uuid,s}static getIrregularCaloCell(e){const t=[];for(let l=0;l<24;l+=3)t.push(new Dt(e.vtx[l],e.vtx[l+1],e.vtx[l+2]));const i=new rve(t),r=new nr("rgb("+e.color[0].toString()+","+e.color[1].toString()+","+e.color[2].toString()+")"),s=new Og({color:r,transparent:!0,opacity:e.opacity}),o=new jo(i,s);return o.userData=Object.assign({},e),o.name="IrregularCaloCell",e.uuid=o.uuid,o}}const $W=(n,e,t)=>`${n} > ${e} > ${t}`;class hv{constructor(){this.labelsObject={},this.loadingManager=new yx,this.stateManager=new TA}buildEventData(e,t,i,r){this.graphicsLibrary=t,this.ui=i,this.eventData=e,this.loadObjectTypes(e);const s=e["event number"]?e["event number"]:e.eventNumber,o=e["run number"]?e["run number"]:e.runNumber;r.add("Event#"+s+" from run#"+o,"Loaded"),this.stateManager.eventMetadata={runNumber:o,eventNumber:s}}getEventsList(e){const t=[];for(const i in e)null!==e[i]&&t.push(i);return t}getCollections(){if(!this.eventData)return[];const e=[];for(const t in this.eventData)if(this.eventData[t]&&"object"==typeof this.eventData[t])for(const i in this.eventData[t])e.push(i);return e}getCollection(e){if(!this.eventData)return null;for(const t in this.eventData)if(this.eventData[t])for(const i in this.eventData[t])if(i===e)return this.eventData[t][i]}loadObjectTypes(e){const t=parseFloat(Math.PI.toFixed(2));if(e.Tracks){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-4,4,.1),new Cl("chi2",0,100),new Cl("dof",0,100),new Cl("pT",0,5e4,.1),new Cl("z0",-30,30,.1),new Cl("d0",-30,30,.1)];this.addObjectType(e.Tracks,Eh.getTrack,"Tracks",!1,i)}if(e.Jets){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-5,5,.1),new Cl("energy",0,6e5,100)],s=this.addScaleOptions("jetsScale","Jets Scale",o=>{this.graphicsLibrary.getSceneManager().scaleJets(o)});this.addObjectType(e.Jets,Eh.getJet,"Jets",!1,i,s)}if(e.Hits&&this.addObjectType(e.Hits,Eh.getHits,"Hits",!0),e.CaloClusters){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-5,5,.1),new Cl("energy",0,1e4)],s=this.addScaleOptions("caloClustersScale","CaloClusters Scale",o=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("CaloClusters",o,"z")});this.addObjectType(e.CaloClusters,Eh.getCluster,"CaloClusters",!1,i,s)}if(e.CaloCells){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-5,5,.1),new Cl("energy",0,1e4)],s=this.addScaleOptions("caloCellsScale","CaloCells Scale",o=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("CaloCells",o,"z")});this.addObjectType(e.CaloCells,Eh.getCaloCell,"CaloCells",!1,i,s)}if(e.PlanarCaloCells){const i=[new Cl("energy",0,1e4)],s=this.addScaleOptions("planarCaloCellsScale","PlanarCaloCells Scale",l=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("PlanarCaloCells",l,"z")}),o={};for(const l in e.PlanarCaloCells){const h=e.PlanarCaloCells[l],u=h.plane,f=new Dt(...u.slice(0,3)).normalize();h.cells.forEach(y=>y.plane=[...f.toArray(),u[3]]),o[l]=h.cells}this.addObjectType(o,Eh.getPlanarCaloCell,"PlanarCaloCells",!1,i,s)}if(e.IrregularCaloCells){const i=[new Cl("layer",0,10),new Cl("energy",0,1e4)],s=this.addScaleOptions("IrregularCaloCellsScale","IrregularCaloCells Scale",o=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("IrregularCaloCells",o,"z")});this.addObjectType(e.IrregularCaloCells,Eh.getIrregularCaloCell,"IrregularCaloCells",!1,i,s)}if(e.Muons){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-4,4,.1),new Cl("energy",0,1e4),new Cl("pT",0,5e4)];this.addObjectType(e.Muons,this.getCompoundTrack,"Muons",!1,i)}if(e.Photons){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-4,4,.1),new Cl("energy",0,1e4),new Cl("pT",0,5e4)];this.addObjectType(e.Photons,this.getCompoundCluster,"Photons",!1,i)}if(e.Electrons){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-4,4,.1),new Cl("energy",0,1e4),new Cl("pT",0,5e4)];this.addObjectType(e.Electrons,this.getCompoundTrack,"Electrons",!1,i)}if(e.Vertices){const i=[new Cl("vertexType",0,5)],s=this.addScaleOptions("verticesScale","Vertices Scale",o=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("Vertices",o)});this.addObjectType(e.Vertices,Eh.getVertex,"Vertices",!1,i,s)}e.MissingEnergy&&this.addObjectType(e.MissingEnergy,Eh.getMissingEnergy,"MissingEnergy",!1,[],(r,s)=>{const o=l=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("MissingEnergy",l)};r&&r.add({jetsScale:100},"jetsScale",1,200).name("Size (%)").onChange(o),s&&s.addConfig("slider",{label:"Size (%)",value:100,min:1,max:200,allowCustomValue:!0,onChange:o})})}addObjectType(e,t,i,r=!1,s,o){const l=this.graphicsLibrary.addEventDataTypeGroup(i),h=this.getObjectTypeCollections(e);this.ui.addEventDataTypeFolder(i);for(const y of h){const T=e[y];console.log(`${i} collection ${y} has ${T.length} constituents.`),0!=T.length?(this.addCollection(T,y,t,i,l,r),s=s?.filter(B=>B.field in T[0]),this.ui.addCollection(i,y,s)):console.log("Skipping")}const u=this.ui.getUIMenus().find(y=>y instanceof GW)?.getEventDataTypeFolder(i),f=this.ui.getUIMenus().find(y=>y instanceof WL)?.getEventDataTypeFolder(i);o?.(u,f)}addCollection(e,t,i,r,s,o){const l=new Xl;if(l.name=t,o){const h=i.bind(this)(e,r);h&&l.add(h)}else for(const h of e){const u=i.bind(this)(h,r);u&&l.add(u)}s.add(l)}getObjectTypeCollections(e){const t=[];for(const i in e)null!==e[i]&&t.push(i);return t}getCompoundTrack(e,t=""){return this.getCompound(e,t,!0,!1)}getCompoundCluster(e,t=""){return this.getCompound(e,t,!1,!0)}getCompound(e,t="",i=!1,r=!1){const s=new Xl;if("LinkedClusters"in e&&e.LinkedClusters)for(const o of e.LinkedClusters){const l=o.split(":")[0],h=o.split(":")[1];if(l&&h&&this.eventData.CaloClusters&&this.eventData.CaloClusters[l]){const u=this.eventData.CaloClusters[l][h];if(u){const f=Eh.getCluster(u);f.name=t+" Cluster",s.add(f)}}}else if(r){const l=Eh.getCluster({energy:e?.energy,phi:e?.phi,eta:e?.eta});l.name=t+" Cluster",s.add(l)}if("LinkedTracks"in e&&e.LinkedTracks)for(const o of e.LinkedTracks){const l=o.split(":")[0],h=o.split(":")[1];if(l&&h&&this.eventData.Tracks&&this.eventData.Tracks[l]){const u=this.eventData.Tracks[l][h];if(u){const f=Eh.getTrack(u);f?(f.name=t+" Track",s.add(f)):console.log("WARNING: failed to get a track back.")}}}else if(i){new Dt(0,0,0);const l=jf.etaToTheta(e.eta),h=e.pt/Math.cos(Math.PI/2-l);let u=0;"pdgId"in e&&(u=e.pdgId>0?1:-1);const y=Eh.getTrack({dparams:[0,0,e.phi,l,u/h]});y?(y.name=t+" Track",s.add(y)):console.log("WARNING: failed to get a track back.")}return e.uuid=s.uuid,s.name=t,s}getEventMetadata(){const e=[],t=[[{keys:["runNumber","run number"],label:"Run"},{keys:["eventNumber","event number"],label:"Event"},{keys:["ls"],label:"LS"},{keys:["lumiBlock"],label:"LumiBlock"}],[{keys:["time"],label:"Data recorded"}]],i=Object.keys(this.eventData);for(const r of t){const s={};for(const o of r)for(const l of o.keys)if(i.includes(l)&&l in this.eventData){s[o.label]=this.eventData[l];break}Object.keys(s).length>0&&e.push({label:Object.keys(s).join(" / "),value:Object.values(s).join(" / ")})}return e}addLabelToEventObject(e,t,i){for(const r in this.eventData)if(this.eventData?.[r]?.[t])return this.labelsObject[r]=this.labelsObject[r]||{},this.labelsObject[r][t]=this.labelsObject[r][t]||{},this.labelsObject[r][t][i]=e,this.eventData[r][t][i].labelText=e,$W(r,t,i);return"Unknown"}getLabelsObject(){return this.labelsObject}addScaleOptions(e,t,i){return(r,s)=>{r&&r.add({[e]:1},e,.001,100).name(t).onChange(i),s&&s.addConfig("slider",{label:t,value:1,min:.001,step:.01,max:100,allowCustomValue:!0,onChange:i})}}}class uv extends hv{constructor(e=[]){super(),this.data={},this.thickTrackCollections=e}process(e){console.log("Processing JiveXML event data"),this.data=e}getEventData(){const i=(new DOMParser).parseFromString(this.data,"text/xml").getElementsByTagName("Event")[0],r={eventNumber:i.getAttribute("eventNumber"),runNumber:i.getAttribute("runNumber"),lumiBlock:i.getAttribute("lumiBlock"),time:i.getAttribute("dateTime"),Hits:void 0,Tracks:{},Jets:{},CaloClusters:{},CaloCells:{},PlanarCaloCells:{},Vertices:{},Electrons:{},Muons:{},Photons:{},MissingEnergy:{}};return this.getPixelClusters(i,r),this.getSCTClusters(i,r),this.getTRT_DriftCircles(i,r),this.getMuonPRD(i,"MDT",r),this.getRPC(i,r),this.getMuonPRD(i,"TGC",r),this.getMuonPRD(i,"CSCD",r),this.getMuonPRD(i,"MM",r),this.getMuonPRD(i,"STGC",r),this.getTracks(i,r),this.getJets(i,r),this.getCaloClusters(i,r),this.getCaloCells(i,"LAr",r),this.getCaloCells(i,"HEC",r),this.getCaloCells(i,"Tile",r),this.getVertices(i,r),this.getMissingEnergy(i,r),this.getElectrons(i,r),this.getMuons(i,r),this.getPhotons(i,r),r}getNumberArrayFromHTML(e,t){let i=[];const r=e.getElementsByTagName(t);return r.length&&(i=r[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number)),i}getStringArrayFromHTML(e,t){return e.getElementsByTagName(t)[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(String)}getPositionOfHit(e,t){for(const i in t.Hits)for(const r of t.Hits[i])if(null==r)console.log("Empty hit");else if("id"in r&&r.id==e)return[!0,r.pos[0],r.pos[1],r.pos[2]];return[!1,0,0,0]}getTracks(e,t){const i=e.getElementsByTagName("Track"),r=Array.from(i),s={};for(const o of r){let l=o.getAttribute("storeGateKey")??"Unknown";"Tracks"===l&&(l="Tracks_");let h=!1;this.thickTrackCollections.find(ti=>ti===l)&&(h=!0);const u=Number(o.getAttribute("count")),f=[];let T=[],B=[],j=[],ne=[];if(0===o.getElementsByTagName("numPolyline").length)console.log("WARNING the track collection "+l+" has no line information. Will rely on Phoenix to extrapolate.");else{ne=this.getNumberArrayFromHTML(o,"numPolyline");const ti=o.getElementsByTagName("polylineX");ti.length>0?(T=ti[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),B=this.getNumberArrayFromHTML(o,"polylineY"),j=this.getNumberArrayFromHTML(o,"polylineZ")):(ne=[],T=[],B=[],j=[])}const se=this.getNumberArrayFromHTML(o,"chi2"),le=this.getNumberArrayFromHTML(o,"numDoF"),Ee=this.getNumberArrayFromHTML(o,"pt"),Pe=this.getNumberArrayFromHTML(o,"d0"),Ve=this.getNumberArrayFromHTML(o,"z0"),Ft=this.getNumberArrayFromHTML(o,"phi0"),Ct=this.getNumberArrayFromHTML(o,"cotTheta");let Bt;this.getNumberArrayFromHTML(o,"hits"),this.getNumberArrayFromHTML(o,"numHits"),(u!=Ee.length||u!=Pe.length||u!=Ve.length||u!=Ct.length)&&console.log("ERROR: Wrong number of some track variables. Corrupted JiveXML?"),o.getElementsByTagName("trackAuthor").length&&(Bt=this.getNumberArrayFromHTML(o,"trackAuthor"));let St=0;ne&&ne.length!=u&&console.log("numPolyline ",ne.length,"numOfTracks",u);for(let ti=0;ti<u;ti++){let ci=!0;const vi=!1,bi={chi2:0,dof:0,pT:0,phi:0,eta:0,pos:[],dparams:[],hits:{},author:{},badtrack:[],linewidth:h?20:void 0};se.length>=ti&&(bi.chi2=se[ti]),le.length>=ti&&(bi.dof=le[ti]),Bt?.length>=ti&&(bi.author=Bt[ti]);let Un=Math.atan(1/Ct[ti]);bi.pT=1e3*Math.abs(Ee[ti]);const _i=bi.pT/Math.sin(Un);bi.dparams=[Pe[ti],Ve[ti],Ft[ti],Un,1/_i],bi.phi=Ft[ti],Un<0&&(Un+=Math.PI),bi.phi>Math.PI?bi.phi-=2*Math.PI:bi.phi<-Math.PI&&(bi.phi+=2*Math.PI),jf.anglesAreSane(Un,bi.phi)||(s["Improper angles"]++,bi.badtrack.push("Improper angles"),ci=!1),bi.eta=jf.thetaToEta(Un),Number.isNaN(bi.eta)&&(bi.badtrack.push("Invalid eta"),ci=!1);const si=[];let Nr=0,Wr=0,so=0,Po=0,Ci=0;if(ne){(St+ne[ti]>T.length||St+ne[ti]>B.length||St+ne[ti]>j.length)&&console.log("ERROR: not enough points left for this track. Corrupted JiveXML?");for(let yr=0;yr<ne[ti];yr++)so=10*T[St+yr],Po=10*B[St+yr],Ci=10*j[St+yr],si.push([so,Po,Ci]),Wr=Math.sqrt(so*so+Po*Po+Ci*Ci),Wr<Nr&&(console.log("WARNING: track positions do not seem to be sorted radially"),s["Hits not sorted"]++,bi.badtrack.push("Hits not sorted")),vi&&(console.log("pos: ",yr,"/",ne[ti],":",si),console.log("theta:",Un,"theta from hit",Math.acos(Ci/Wr))),Nr=Wr;St+=ne[ti],bi.pos=si}ci&&f.push(bi)}ne&&(St!=T.length||St!=B.length||St!=j.length)&&console.log("ERROR: something has gone wrong with assigning the positions to the tracks!"),t.Tracks[l]=f}for(const o in s)s[o]>0&&console.log(s[o]+' tracks had "'+o+'" and were marked as bad.')}getPixelClusters(e,t){if(t.Hits={},0===e.getElementsByTagName("PixCluster").length)return;const i=e.getElementsByTagName("PixCluster")[0],r=Number(i.getAttribute("count")),s=this.getNumberArrayFromHTML(i,"id"),o=this.getNumberArrayFromHTML(i,"x0"),l=this.getNumberArrayFromHTML(i,"y0"),h=this.getNumberArrayFromHTML(i,"z0"),u=this.getNumberArrayFromHTML(i,"eloss");t.Hits.Pixel=[];for(let f=0;f<r;f++){const y={pos:[],id:0,energyLoss:0};y.pos=[10*o[f],10*l[f],10*h[f]],y.id=s[f],y.energyLoss=u[f],t.Hits.Pixel.push(y)}}getSCTClusters(e,t){if(0===e.getElementsByTagName("STC").length)return;const i=e.getElementsByTagName("STC")[0],r=Number(i.getAttribute("count")),s=this.getNumberArrayFromHTML(i,"id"),o=this.getNumberArrayFromHTML(i,"phiModule"),l=this.getNumberArrayFromHTML(i,"side"),h=this.getNumberArrayFromHTML(i,"x0"),u=this.getNumberArrayFromHTML(i,"y0"),f=this.getNumberArrayFromHTML(i,"z0");t.Hits.SCT=[];for(let y=0;y<r;y++){const T={pos:[],id:0,phiModule:0,side:0};T.pos=[10*h[y],10*u[y],10*f[y]],T.id=s[y],T.phiModule=o[y],T.side=l[y],t.Hits.SCT.push(T)}}getTRT_DriftCircles(e,t){if(0===e.getElementsByTagName("TRT").length)return;const i=e.getElementsByTagName("TRT")[0],r=Number(i.getAttribute("count")),s=this.getNumberArrayFromHTML(i,"driftR"),o=this.getNumberArrayFromHTML(i,"id"),l=this.getNumberArrayFromHTML(i,"noise"),h=this.getNumberArrayFromHTML(i,"phi"),u=this.getNumberArrayFromHTML(i,"rhoz"),f=this.getNumberArrayFromHTML(i,"sub"),y=this.getNumberArrayFromHTML(i,"threshold"),T=this.getNumberArrayFromHTML(i,"timeOverThreshold");t.Hits.TRT=[];for(let B=0;B<r;B++){const j={pos:[],id:0,type:"Line",driftR:0,threshold:0,timeOverThreshold:0,noise:!1};if(1==f[B]||2==f[B]){const ne=1==f[B]?-3.5:3.5,se=1==f[B]?-742:742;j.pos=[Math.cos(h[B])*u[B]*10,Math.sin(h[B])*u[B]*10,ne,Math.cos(h[B])*u[B]*10,Math.sin(h[B])*u[B]*10,se]}else{const ne=Math.abs(u[B])>280?480:640,se=1030;j.pos=[Math.cos(h[B])*ne,Math.sin(h[B])*ne,10*u[B],Math.cos(h[B])*se,Math.sin(h[B])*se,10*u[B]]}j.id=o[B],j.driftR=s[B],j.noise=l[B],j.threshold=y[B],j.timeOverThreshold=T[B],t.Hits.TRT.push(j)}}getMuonPRD(e,t,i){if(0===e.getElementsByTagName(t).length)return;const r=e.getElementsByTagName(t)[0];"CSCD"==t&&(t="CSC");const s=Number(r.getAttribute("count")),o=this.getNumberArrayFromHTML(r,"x"),l=this.getNumberArrayFromHTML(r,"y"),h=this.getNumberArrayFromHTML(r,"z"),u=this.getNumberArrayFromHTML(r,"length"),f=this.getNumberArrayFromHTML(r,"id"),y=this.getStringArrayFromHTML(r,"identifier");i.Hits[t]=[];for(let T=0;T<s;T++){const B={pos:this.getMuonLinePositions(T,o,l,h,u),id:f[T],type:"Line",identifier:y[T]};i.Hits[t].push(B)}}getRPC(e,t){const i="RPC";if(0===e.getElementsByTagName(i).length)return;const r=e.getElementsByTagName(i)[0],s=Number(r.getAttribute("count")),o=this.getNumberArrayFromHTML(r,"x"),l=this.getNumberArrayFromHTML(r,"y"),h=this.getNumberArrayFromHTML(r,"z"),u=this.getNumberArrayFromHTML(r,"length"),f=this.getNumberArrayFromHTML(r,"width"),y=this.getNumberArrayFromHTML(r,"id"),T=this.getStringArrayFromHTML(r,"identifier");t.Hits[i]=[];for(let B=0;B<s;B++){const j={pos:this.getMuonLinePositions(B,o,l,h,u),id:y[B],type:"Line",identifier:T[B],width:f[B]};t.Hits[i].push(j)}}getMuonLinePositions(e,t,i,r,s){const o=Math.sqrt(t[e]*t[e]+i[e]*i[e]),l=s[e]/o;return[10*t[e]-i[e]*l*5,10*i[e]+t[e]*l*5,10*r[e],10*t[e]+i[e]*l*5,10*i[e]-t[e]*l*5,10*r[e]]}getJets(e,t){const i=e.getElementsByTagName("Jet"),r=Array.from(i);for(const s of r){const o=Number(s.getAttribute("count")),l=this.getNumberArrayFromHTML(s,"phi"),h=this.getNumberArrayFromHTML(s,"eta"),u=this.getNumberArrayFromHTML(s,"energy"),f=this.getNumberArrayFromHTML(s,"coneR"),y=[];for(let B=0;B<o;B++)y.push({coneR:f[B]??.4,phi:l[B],eta:h[B],energy:1e3*u[B]});const T=s.getAttribute("storeGateKey");T&&(t.Jets[T]=y)}}getCaloClusters(e,t){const i=e.getElementsByTagName("Cluster"),r=Array.from(i);for(const s of r){const o=Number(s.getAttribute("count")),l=this.getNumberArrayFromHTML(s,"phi"),h=this.getNumberArrayFromHTML(s,"eta"),u=this.getNumberArrayFromHTML(s,"et"),f=[];for(let T=0;T<o;T++)f.push({phi:l[T],eta:h[T],energy:1e3*u[T]});const y=s.getAttribute("storeGateKey");y&&(t.CaloClusters[y]=f)}}getFCALCaloCells(e,t,i){if(0===e.getElementsByTagName(t).length)return;const r=e.getElementsByTagName(t)[0],s=Number(r.getAttribute("count")),o=this.getNumberArrayFromHTML(r,"x"),l=this.getNumberArrayFromHTML(r,"y"),h=this.getNumberArrayFromHTML(r,"z"),u=this.getNumberArrayFromHTML(r,"dx"),y=(this.getNumberArrayFromHTML(r,"dy"),this.getNumberArrayFromHTML(r,"dz")),T=this.getNumberArrayFromHTML(r,"channel"),j=(this.getNumberArrayFromHTML(r,"energy"),this.getNumberArrayFromHTML(r,"id")),ne=this.getStringArrayFromHTML(r,"slot");i.PlanarCaloCells[t]={cells:[]};let se=0;for(let le=0;le<s;le++){const Ee=h.length?10*h[le]:10;i.PlanarCaloCells[t].cells.push({pos:[10*o[le],10*l[le],Ee],length:y.length?10*y[le]:u[le],cellSize:10*u[le],id:j[le],slot:ne[le],channel:T[le]}),se&&se!=Ee&&console.log("WARNING - we're assuming that all cells have the same z. This is apparently not correct!"),se=Ee}i.PlanarCaloCells[t].plane=[10,10,se]}getCaloCells(e,t="FCAL",i){if(0===e.getElementsByTagName(t).length)return;const r=e.getElementsByTagName(t)[0],s=Number(r.getAttribute("count")),o=this.getNumberArrayFromHTML(r,"eta"),l=this.getNumberArrayFromHTML(r,"phi"),h=this.getNumberArrayFromHTML(r,"channel"),u=this.getNumberArrayFromHTML(r,"energy"),f=this.getNumberArrayFromHTML(r,"id");this.getStringArrayFromHTML(r,"slot"),i.CaloCells[t]=[];for(let T=0;T<s;T++)i.CaloCells[t].push({eta:o[T],phi:l[T],id:f[T],energy:u[T],channel:h[T]})}getVertices(e,t){const i=e.getElementsByTagName("RVx"),r=Array.from(i);for(const s of r){const o=Number(s.getAttribute("count")),l=s.getElementsByTagName("x")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),h=s.getElementsByTagName("y")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),u=s.getElementsByTagName("z")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),f=s.getElementsByTagName("chi2")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),y=s.getElementsByTagName("primVxCand")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),T=s.getElementsByTagName("vertexType")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),B=s.getElementsByTagName("numTracks")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),j=s.getElementsByTagName("sgkey")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(String),ne=s.getElementsByTagName("tracks")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),se=[];let le=0;for(let Pe=0;Pe<o;Pe++){const Ve=le+B[Pe],Ft=[];for(;le<Ve;le++)le>ne.length&&console.log("Error! TrackIndex exceeds maximum number of track indices."),Ft.push(ne[le]);se.push({x:l[Pe],y:h[Pe],z:u[Pe],chi2:f[Pe],primVxCand:y[Pe],vertexType:T[Pe],linkedTracks:Ft,linkedTrackCollection:j[Pe]})}const Ee=s.getAttribute("storeGateKey");Ee&&(t.Vertices[Ee]=se)}}getMuons(e,t){const i=e.getElementsByTagName("Muon"),r=Array.from(i);for(const s of r){const o=Number(s.getAttribute("count")),l=[];for(let u=0;u<o;u++){const f=this.getNumberArrayFromHTML(s,"chi2"),y=this.getNumberArrayFromHTML(s,"energy"),T=this.getNumberArrayFromHTML(s,"eta"),B=this.getNumberArrayFromHTML(s,"phi"),j=this.getNumberArrayFromHTML(s,"pt"),ne=this.getNumberArrayFromHTML(s,"pdgId");l.push({chi2:f[u],energy:y[u],eta:T[u],phi:B[u],pt:1e3*j[u],pdgId:ne[u]})}const h=s.getAttribute("storeGateKey");h&&(t.Muons[h]=l)}}getElectrons(e,t){const i=e.getElementsByTagName("Electron"),r=Array.from(i);for(const s of r){const o=Number(s.getAttribute("count")),l=[];for(let u=0;u<o;u++){const f=this.getStringArrayFromHTML(s,"author"),y=this.getNumberArrayFromHTML(s,"energy"),T=this.getNumberArrayFromHTML(s,"eta"),B=this.getNumberArrayFromHTML(s,"phi"),j=this.getNumberArrayFromHTML(s,"pt"),ne=this.getNumberArrayFromHTML(s,"pdgId");l.push({author:f[u],energy:y[u],eta:T[u],phi:B[u],pt:1e3*j[u],pdgId:ne[u]})}const h=s.getAttribute("storeGateKey");h&&(t.Electrons[h]=l)}}getPhotons(e,t){const i=e.getElementsByTagName("Photon"),r=Array.from(i);for(const s of r){const o=Number(s.getAttribute("count")),l=[];for(let u=0;u<o;u++){const f=this.getStringArrayFromHTML(s,"author"),y=this.getNumberArrayFromHTML(s,"energy"),T=this.getNumberArrayFromHTML(s,"eta"),B=this.getNumberArrayFromHTML(s,"phi"),j=this.getNumberArrayFromHTML(s,"pt");l.push({author:f[u],energy:y[u],eta:T[u],phi:B[u],pt:1e3*j[u]})}const h=s.getAttribute("storeGateKey");h&&(t.Photons[h]=l)}}getMissingEnergy(e,t){const i=e.getElementsByTagName("ETMis"),r=Array.from(i);for(const s of r){const o=Number(s.getAttribute("count")),l=[];for(let u=0;u<o;u++){const f=this.getStringArrayFromHTML(s,"et"),y=this.getNumberArrayFromHTML(s,"etx"),T=this.getNumberArrayFromHTML(s,"ety");l.push({et:f[u],etx:y[u],ety:T[u]})}const h=s.getAttribute("storeGateKey");h&&(t.MissingEnergy[h]=l)}}}const XW=function(){var n=(0,al.A)(function*(e){const t=new(bB()),i={};yield t.loadAsync(e);for(const r in t.files){const s=(yield t.file(r)?.async("string"))??"Unable to read file";i[r]=s}return i});return function(t){return n.apply(this,arguments)}}(),ove={file:"",type:"",config:"",hideWidgets:!1,embed:!1};class ave{constructor(e,t){this.eventDisplay=e,this.configuration=t,this.urlOptions=new URLSearchParams(window.location.href.substr(window.location.href.lastIndexOf("?")))}applyOptions(){this.applyEventOptions(this.configuration.defaultEventFile?.eventFile,this.configuration.defaultEventFile?.eventType),this.applyHideWidgetsOptions(),this.applyEmbedOption()}applyEventOptions(e="",t=""){if(!("fetch"in window))return;let i,r;(!this.urlOptions.get("file")&&this.urlOptions.get("type")||this.urlOptions.get("file")&&!this.urlOptions.get("type"))&&(console.log("WARNING - if you set one of type or file, then you need to set both!"),console.log("WARNING - reverting to defaults!")),this.urlOptions.get("file")&&this.urlOptions.get("type")?(console.log("Setting and config from urlOptions"),i=this.urlOptions.get("file")??"",r=this.urlOptions.get("type")?.toLowerCase()??""):(console.log("Setting and config from defaults"),i=e,r=t),console.log("Loading ",i,"of type",r);const s=()=>{this.urlOptions.get("config")&&(this.eventDisplay.getLoadingManager().addLoadableItem("url_config"),fetch(this.urlOptions.get("config")??"").then(l=>l.json()).then(l=>{(new TA).loadStateFromJSON(l)}).finally(()=>{this.eventDisplay.getLoadingManager().itemLoaded("url_config")}))};i&&r?(this.eventDisplay.getLoadingManager().addLoadableItem("url_event"),(l=>"jivexml"===r?(console.log("Opening JiveXML"),this.handleJiveXMLEvent(l)):"zip"===r?(console.log("Opening zip file"),this.handleZipFileEvents(l)):this.handleJSONEvent(l))(i).catch(l=>{this.eventDisplay.getInfoLogger().add("Could not find the file specified in URL.","Error"),console.error("Could not find the file specified in URL.",l)}).finally(()=>{s(),this.eventDisplay.getLoadingManager().itemLoaded("url_event")})):s()}handleJiveXMLEvent(e){var t=this;return(0,al.A)(function*(){const i=yield(yield fetch(e)).text();t.configuration.eventDataLoader||(t.configuration.eventDataLoader=new uv);const r=t.configuration.eventDataLoader;r.process(i);const s=r.getEventData();t.eventDisplay.buildEventDataFromJSON(s)})()}handleJSONEvent(e){var t=this;return(0,al.A)(function*(){const i=yield(yield fetch(e)).json();t.configuration.eventDataLoader=new hv,t.eventDisplay.parsePhoenixEvents(i)})()}handleZipFileEvents(e){var t=this;return(0,al.A)(function*(){const i=yield(yield fetch(e)).arrayBuffer(),r={};let s;try{s=yield XW(i)}catch(l){return console.error("Error while reading zip",l),void t.eventDisplay.getInfoLogger().add("Could not read zip file","Error")}Object.keys(s).filter(l=>l.endsWith(".json")).forEach(l=>{Object.assign(r,JSON.parse(s[l]))});const o=t.configuration.eventDataLoader instanceof uv?t.configuration.eventDataLoader:new uv;Object.keys(s).filter(l=>l.endsWith(".xml")||l.startsWith("JiveXML")).forEach(l=>{o.process(s[l]);const h=o.getEventData();Object.assign(r,{[l]:h})}),t.eventDisplay.parsePhoenixEvents(r)})()}applyHideWidgetsOptions(){this.hideIdsWithURLOption({hideWidgets:["mainLogo","uiMenu","experimentInfo","phoenixMenu","statsElement","gui"]})}applyEmbedOption(){"true"===this.urlOptions.get("embed")&&(this.hideIdsWithURLOption({embed:["mainLogo","uiMenu","experimentInfo","phoenixMenu","statsElement","gui"]}),document.getElementById("embedMenu")?.style.setProperty("display","block"))}hideIdsWithURLOption(e){Object.entries(e).forEach(([t,i])=>{"true"===this.urlOptions.get(t)&&i.forEach(r=>{document.getElementById(r)?.style.setProperty("display","none")})})}getURLOptions(){return this.urlOptions}}class lve{constructor(e){this.onEventsChange=[],this.onDisplayedEventChange=[],this.loadingManager=new yx,this.infoLogger=new J1e,this.graphicsLibrary=new C1e(this.infoLogger),this.ui=new Z1e(this.graphicsLibrary),e&&this.init(e)}init(e){this.configuration=e,this.graphicsLibrary.init(e),this.ui.init(e),this.getStateManager().setEventDisplay(this),this.graphicsLibrary.setAnimationLoop(()=>{this.ui.updateUI()}),this.urlOptionsManager=new ave(this,e),!1!==e.allowUrlOptions&&this.urlOptionsManager.applyOptions(),this.enableEventDisplayConsole(),this.enableKeyboardControls()}initXR(e,t){this.graphicsLibrary.initXRSession(e,t)}endXR(e){this.graphicsLibrary.endXRSession(e)}parsePhoenixEvents(e){this.eventsData=e,typeof this.configuration.eventDataLoader>"u"&&(this.configuration.eventDataLoader=new hv);const t=this.configuration.eventDataLoader.getEventsList(e);return this.loadEvent(t[0]),this.onEventsChange.forEach(i=>i(t)),t}buildEventDataFromJSON(e){this.resetLabels(),this.ui.addEventDataFolder(),this.ui.addLabelsFolder(),this.graphicsLibrary.clearEventData(),this.configuration.eventDataLoader&&this.configuration.eventDataLoader.buildEventData(e,this.graphicsLibrary,this.ui,this.infoLogger),this.onDisplayedEventChange.forEach(t=>t(e)),this.ui.loadEventFolderPhoenixMenuState()}loadEvent(e){const t=this.eventsData[e];t&&this.buildEventDataFromJSON(t)}getThreeManager(){return this.graphicsLibrary}getUIManager(){return this.ui}getInfoLogger(){return this.infoLogger}getLoadingManager(){return this.loadingManager}getStateManager(){return this.stateManager||(this.stateManager=new TA),this.stateManager}getURLOptionsManager(){return this.urlOptionsManager}loadOBJGeometry(e,t,i,r,s,o=!0,l=!0){var h=this;return(0,al.A)(function*(){h.loadingManager.addLoadableItem(`obj_geom_${t}`);const{object:u}=yield h.graphicsLibrary.loadOBJGeometry(e,t,i,s,o,l);h.ui.addGeometry(u,r),h.loadingManager.itemLoaded(`obj_geom_${t}`),h.infoLogger.add(t,"Loaded OBJ geometry")})()}parseOBJGeometry(e,t,i,r=!0){this.loadingManager.addLoadableItem(`parse_obj_${t}`);const{object:s}=this.graphicsLibrary.parseOBJGeometry(e,t,r);this.ui.addGeometry(s,i),this.loadingManager.itemLoaded(`parse_obj_${t}`)}exportToOBJ(){this.graphicsLibrary.exportSceneToOBJ(),this.infoLogger.add("Exported scene to OBJ")}parsePhoenixDisplay(e){var t=this;return(0,al.A)(function*(){const i=JSON.parse(e);i.sceneConfiguration&&i.scene&&(t.ui.addEventDataFolder(),t.ui.addLabelsFolder(),t.graphicsLibrary.clearEventData(),t.loadSceneConfiguration(i.sceneConfiguration),t.loadingManager.addLoadableItem(`parse_phnx_${name}`),yield t.graphicsLibrary.parsePhnxScene(i.scene),t.loadingManager.itemLoaded(`parse_phnx_${name}`))})()}exportPhoenixDisplay(){this.graphicsLibrary.exportPhoenixScene()}parseGLTFGeometry(e){var t=this;return(0,al.A)(function*(){const i=e.name.split("/").pop();t.loadingManager.addLoadableItem(`parse_gltf_${i}`);const r=yield t.graphicsLibrary.parseGLTFGeometry(e);for(const{object:s,menuNodeName:o}of r)t.ui.addGeometry(s,o);t.loadingManager.itemLoaded(`parse_gltf_${i}`)})()}loadGLTFGeometry(e,t,i="",r=1,s=!0){var o=this;return(0,al.A)(function*(){o.loadingManager.addLoadableItem(`gltf_geom_${t}`);const l=yield o.graphicsLibrary.loadGLTFGeometry(e,t,i,r,s);for(const{object:h,menuNodeName:u}of l)o.ui.addGeometry(h,u);o.loadingManager.itemLoaded(`gltf_geom_${t}`)})()}loadJSONGeometry(e,t,i,r,s,o=!0){var l=this;return(0,al.A)(function*(){l.loadingManager.addLoadableItem(`json_geom_${t}`);const{object:h}=yield l.graphicsLibrary.loadJSONGeometry(e,t,r,s,o);l.ui.addGeometry(h,i),l.loadingManager.itemLoaded(`json_geom_${t}`),l.infoLogger.add(t,"Loaded JSON geometry")})()}loadRootJSONGeometry(e,t,i,r,s,o=!0){var l=this;return(0,al.A)(function*(){l.loadingManager.addLoadableItem("root_json_geom");const h=yield(0,KG.httpRequest)(e,"object");yield l.loadJSONGeometry((0,ZG.build)(h,{dflt_colors:!0}).toJSON(),t,i,r,s,o),l.loadingManager.itemLoaded("root_json_geom")})()}loadRootGeometry(e,t,i,r,s,o,l=!0){var h=this;return(0,al.A)(function*(){h.loadingManager.addLoadableItem("root_geom"),KG.settings.UseStamp=!1;const f=yield(yield(0,JG.Tq)(e)).readObject(t);yield h.loadJSONGeometry((0,ZG.build)(f,{dflt_colors:!0}).toJSON(),i,r,s,o,l),h.loadingManager.itemLoaded("root_geom")})()}buildGeometryFromParameters(e){this.graphicsLibrary.addGeometryFromParameters(e)}zoomTo(e,t){this.graphicsLibrary.zoomTo(e,t)}loadSceneConfiguration(e){for(const t of Object.keys(e.eventData)){this.ui.addEventDataTypeFolder(t);const i=e.eventData[t];for(const r of i)this.ui.addCollection(t,r)}for(const t of e.geometries)this.ui.addGeometry(t,"#ffffff")}getCollection(e){return this.configuration.eventDataLoader?this.configuration.eventDataLoader.getCollection(e):{}}getCollections(){return this.configuration.eventDataLoader?this.configuration.eventDataLoader.getCollections():[]}listenToDisplayedEventChange(e){this.onDisplayedEventChange.push(e)}listenToLoadedEventsChange(e){this.onEventsChange.push(e)}getEventMetadata(){return this.configuration.eventDataLoader?this.configuration.eventDataLoader.getEventMetadata():[]}enableEventDisplayConsole(){window.EventDisplay={loadGLTFGeometry:(e,t)=>{this.loadGLTFGeometry(e,t)},loadOBJGeometry:(e,t,i,r,s)=>{this.loadOBJGeometry(e,t,i,r,s)},loadJSONGeometry:(e,t,i,r,s,o=!0)=>{this.loadJSONGeometry(e,t,i,r,s,o)},buildGeometryFromParameters:e=>this.buildGeometryFromParameters(e),scene:this.getThreeManager().getSceneManager().getScene()}}setOverlayRenderer(e){this.graphicsLibrary.setOverlayRenderer(e)}allowSelection(e){this.graphicsLibrary.setSelectedObjectDisplay(e)}enableSelecting(e){this.graphicsLibrary.enableSelecting(e)}fixOverlayView(e){this.graphicsLibrary.fixOverlayView(e)}getActiveObjectId(){return this.graphicsLibrary.getActiveObjectId()}lookAtObject(e,t=!1){1==t?(this.graphicsLibrary.lookAtObject(e,!0),this.graphicsLibrary.highlightObject(e,!0)):(this.graphicsLibrary.lookAtObject(e),this.graphicsLibrary.highlightObject(e))}highlightObject(e,t=!1){this.graphicsLibrary.highlightObject(e,1==t)}enableHighlighting(){this.graphicsLibrary.enableHighlighting()}disableHighlighting(){this.graphicsLibrary.disableHighlighting()}enableKeyboardControls(){this.ui.enableKeyboardControls(),this.graphicsLibrary.enableKeyboardControls()}animateThroughEvent(e,t,i){this.graphicsLibrary.animateThroughEvent(e,t,i)}animatePreset(e,t){this.graphicsLibrary.animatePreset(e,t)}animateEventWithCollision(e,t){this.graphicsLibrary.animateEventWithCollision(e,t)}animateClippingWithCollision(e,t){this.graphicsLibrary.animateClippingWithCollision(e,t)}addLabelToObject(e,t,i,r){if(!this.configuration.eventDataLoader)return;const s=this.configuration.eventDataLoader.addLabelToEventObject(e,t,i);e?(this.ui.addLabel(s),this.graphicsLibrary.addLabelToObject(e,r,s)):this.ui.removeLabel(s,!0)}resetLabels(){if(!this.configuration.eventDataLoader)return;const e=this.configuration.eventDataLoader.getLabelsObject();for(const t in e)for(const i in e[t])for(const r in e[t][i]){const s=$W(t,i,r);this.ui.removeLabel(s,!0),delete e[t][i][r]}}}class ZC{constructor(e,t,i,r,s,o){this.toggleState=!0,this.children=[],this.configs=[],this.nodeLevel=0,this.childrenToggleState={},this.childrenActive=!1,this.configActive=!1,this.name=e,t&&(this.icon=t),i&&(this.onToggle=i),r&&(this.children=r),s&&(this.configs=s),o&&(this.parent=o)}addChild(e,t,i){const r=new ZC(e,i,t);return r.parent=this,r.nodeLevel=this.nodeLevel+1,this.children.push(r),r}removeChild(e){const t=this.children.indexOf(e);return this.children.splice(t,1),this}remove(){this.parent?this.parent.removeChild(this):console.error("Cannot delete root node of phoenix menu. Set it to undefined/null instead.")}truncate(){this.children=[]}addConfig(e,t){const i=this.configs.push({type:e,...t});return this.applyConfigState(this.configs[i-1]),this}toggleSelfAndDescendants(e){this.onToggle?.(e),this.toggleState=e;for(const t of this.children)e?(t.toggleState=this.childrenToggleState[t.name],t.toggleSelfAndDescendants(t.toggleState)):(this.childrenToggleState[t.name]=t.toggleState,t.toggleSelfAndDescendants(e))}applyConfigState(e){"checkbox"===e.type&&e?.isChecked?e.onChange?.(e?.isChecked):"color"===e.type&&e?.color?("Labels"===this.name||"Labels"===this.parent?.name||void 0!==e.group)&&e.onChange?.(e?.color):"slider"===e.type&&e?.value?e.onChange?.(e?.value):"rangeSlider"===e.type&&void 0!==e?.value&&(e.onChange?.({value:e?.value,highValue:e?.highValue}),e.setEnableMin?.(e?.enableMin),e.setEnableMax?.(e?.enableMax))}getNodeState(){const e={};e.name=this.name,e.nodeLevel=this.nodeLevel,e.toggleState=this.toggleState,e.childrenActive=this.childrenActive,e.configs=this.configs,e.children=[];for(const t of this.children)e.children.push(t.getNodeState());return e}loadStateFromJSON(e){let t;t="string"==typeof e?JSON.parse(e):e,this.childrenActive=t.childrenActive,this.toggleState=t.toggleState,void 0!==this.toggleState&&this.onToggle?.(this.toggleState);for(const i of t.configs){const r=this.configs.filter(o=>o.type===i.type&&o.label===i.label);if(r.length>1&&console.error("Multiple configs found with same label and type in phoenix menu node."),0===r.length)return void console.error("No config found with label and type in phoenix menu node. Aborting.");const s=r[0];if(s){for(const o in i)s[o]=i[o];this.applyConfigState(s)}}for(const i of t.children){const r=this.children.filter(s=>s.name===i.name&&s.nodeLevel===i.nodeLevel)[0];r&&r.loadStateFromJSON(i)}}findInTree(e){if(this.name===e)return this;for(const t of this.children){const i=t.findInTree(e);if(i)return i}}findInTreeOrCreate(e){let t=this;return e.split(">").forEach(i=>{i=i.trim();const r=t.findInTree(i);t=r||t.addChild(i,()=>{})}),t}}class cve{static getMuonChamber(e){let t=[];const i=(...u)=>{t=t.concat(...u.map(f=>e[f]))};i("front_1","front_2","front_3"),i("front_3","front_4","front_1"),i("back_1","back_2","back_3"),i("back_3","back_4","back_1"),i("back_1","back_2","front_2"),i("front_2","front_1","back_1"),i("back_4","back_3","front_3"),i("front_3","front_4","back_4"),i("front_1","front_4","back_4"),i("back_4","back_1","front_1"),i("front_2","back_2","back_3"),i("back_3","front_3","front_2");const r=new Hs;r.attributes.position=new To(new Float32Array(t),3),r.computeVertexNormals();const s=new jo(r,new wh({color:e.color??Bp.MuonChambers,transparent:!0,opacity:.1,side:2}));s.userData=Object.assign({},e),s.name="MuonChamber";const o=new tj(r),l=new yc(o,new Bc({color:16777215,transparent:!0,opacity:.7})),h=new Xl;return h.add(s),h.add(l),e.uuid=s.uuid,h}}class YW extends hv{constructor(){super(),this.geometryScale=1e3,this.data={}}loadObjectTypes(e){super.loadObjectTypes(e),e.MuonChambers&&this.addObjectType(e.MuonChambers,cve.getMuonChamber,"MuonChambers")}readIgArchive(e,t,i){this.loadingManager.addLoadableItem("ig_archive");const r=new(bB()),s=[],o=l=>{r.loadAsync(l).then(()=>{let h=Object.keys(r.files);i&&(h=h.filter(f=>f.includes(i)));let u=1;for(const f of h)f.toLowerCase().startsWith("events")?r?.file(f).async("string").then(y=>{y=y.replace(/'/g,'"').replace(/\(/g,"[").replace(/\)/g,"]").replace(/nan/g,"0");const T=JSON.parse(y);T.eventPath=f,s.push(T),u===h.length&&(t(s),this.loadingManager.itemLoaded("ig_archive")),u++}):(u===h.length&&(t(s),this.loadingManager.itemLoaded("ig_archive")),u++)})};e instanceof File?o(e):fetch(e).then(l=>l.arrayBuffer()).then(l=>{o(l)})}loadEventDataFromIg(e,t,i){this.readIgArchive(e,r=>{i(r[0])},t)}getEventData(){const e=this.data?.Collections?.Event_V2?.[0],t={runNumber:e?.[0],eventNumber:e?.[1],ls:e?.[2],time:e?.[5],Hits:{},Tracks:{},Jets:{},CaloClusters:{},MuonChambers:{}};t.Hits=this.getTrackingClusters(t.Hits),t.Tracks=this.getTracks(),t.Jets=this.getJets(),t.CaloClusters=this.getCaloClusters(),t.MuonChambers=this.getMuonChambers();for(const i of["Hits","Tracks","Jets","CaloClusters","MuonChambers"])0===Object.keys(t[i]).length&&(t[i]=void 0);return t}getAllEventsData(e){const t={};for(const i of e)this.data=i,t[i.eventPath]=this.getEventData();return t}getTrackingClusters(e){const i=this.getObjectCollections(["TrackingRecHits_V1","SiStripClusters_V1","SiPixelClusters_V1","CSCLCTDigis_V1"],r=>{r.pos&&(r.pos=r.pos.map(s=>s*this.geometryScale))});return Object.assign(e,i),e}getCaloClusters(){return this.getObjectCollections(["SuperClusters_V1"],i=>{i.energy&&(i.energy*=this.geometryScale)})}getJets(){let e={};const t=Object.keys(this.data.Collections).filter(r=>r.toLowerCase().includes("jets"));return e=this.getObjectCollections(t,r=>{for(const s of["et","energy"])if(r[s]){r[s]*=this.geometryScale;break}},[{attribute:"et",min:10},{attribute:"energy",min:10}]),e}getMuonChambers(){return this.getObjectCollections(["MatchingCSCs_V1","MuonChambers_V1"],i=>{for(const r of Object.keys(i))(r.startsWith("front")||r.startsWith("back"))&&(i[r]=i[r].map(s=>s*this.geometryScale))})}getObjectCollections(e,t,i){const r={};e=e.filter(s=>this.data.Collections[s]);for(const s of e){r[s]=[];const o=this.data.Types[s];for(const l of this.data.Collections[s]){const h={};if(o.forEach((u,f)=>{h[u[0]]=l[f]}),i){let u=!0,f=!0;for(const y of i)if(h[y.attribute]){if(y.max&&h[y.attribute]>y.max){u=!1;break}if(y.min&&h[y.attribute]<y.min){f=!1;break}}u&&f&&(t?.(h),r[s].push(h))}else t?.(h),r[s].push(h)}0===r[s].length&&delete r[s]}return r}getTracks(){const e={};let t=[{collection:"Tracks_V1",extras:"Extras_V1",assocs:"TrackExtras_V1",color:"0xff0000",min_pt:1},{collection:"Tracks_V2",extras:"Extras_V1",assocs:"TrackExtras_V1",color:"0xff0000",min_pt:1},{collection:"Tracks_V3",extras:"Extras_V1",assocs:"TrackExtras_V1",color:"0xff0000",min_pt:1},{collection:"StandaloneMuons_V2",extras:"Extras_V1",assocs:"MuonTrackExtras_V1",color:"0xf57842",min_pt:1},{collection:"PATStandaloneMuons_V1",extras:"Extras_V1",assocs:"PATMuonTrackExtras_V1",color:"0xf5aa42",min_pt:1},{collection:"TrackerMuons_V2",extras:"Extras_V1",assocs:"MuonTrackerExtras_V1",color:"0xe8d546",min_pt:2},{collection:"GsfElectrons_V1",extras:"Extras_V1",assocs:"GsfElectronExtras_V1",color:"0x1CFF1A",min_pt:10},{collection:"GsfElectrons_V2",extras:"Extras_V1",assocs:"GsfElectronExtras_V1",color:"0x1bcf9f",min_pt:10},{collection:"GsfElectrons_V3",extras:"Extras_V1",assocs:"GsfElectronExtras_V1",color:"0x1ad9ff",min_pt:10},{collection:"PATElectrons_V1",extras:"Extras_V1",assocs:"PATElectronExtras_V1",color:"0x1a40ff",min_pt:1}];t=t.filter(i=>this.data.Collections[i.collection]);for(const i of t){e[i.collection]=[];const r=this.data.Collections[i.collection],s=this.data.Collections[i.extras],o=this.data.Associations[i.assocs],l=this.data.Types[i.collection];let h,u,f,y,T,B,j,ne,se,le,Ee,Pe;for(let Ve=0;Ve<o.length;Ve++){if(Pe={},l.forEach((Ct,Lt)=>{Pe[Ct[0]]=r[Ve][Lt]}),Pe.pt<i.min_pt)continue;Pe.color=i.color,h=o[Ve][0][1],u=o[Ve][1][1],f=new Dt(s[u][0][0],s[u][0][1],s[u][0][2]),y=new Dt(s[u][1][0],s[u][1][1],s[u][1][2]),y.normalize(),T=new Dt(s[u][2][0],s[u][2][1],s[u][2][2]),B=new Dt(s[u][3][0],s[u][3][1],s[u][3][2]),B.normalize(),j=f.distanceTo(T),ne=.25*j,se=new Dt(f.x+ne*y.x,f.y+ne*y.y,f.z+ne*y.z),le=new Dt(T.x+ne*B.x,T.y+ne*B.y,T.z+ne*B.z),Ee=new G5(f,se,T);const Ft=[];for(const Ct of Ee.getPoints(24))Ct.multiplyScalar(this.geometryScale),Ft.push([Ct.x,Ct.y,Ct.z]);Pe.pos=Ft,e[i.collection].push(Pe)}0===e[i.collection].length&&delete e[i.collection]}return e}getEventMetadata(){const e=super.getEventMetadata(),t=this.data?.Collections?.Event_V2?.[0];return t?.[3]&&e.push({label:"Orbit",value:t[3]}),e}}class hve extends hv{constructor(){super(),this.eventData={}}setRawEventData(e){this.rawEventData=e}processEventData(){return Object.entries(this.rawEventData).forEach(([e,t])=>{const i={Vertices:{},Tracks:{},Hits:{},CaloCells:{},CaloClusters:{},Jets:{},MissingEnergy:{},"event number":this.getEventNumber(t),"run number":this.getRunNumber(t)};this.colorTracks(t),i.Vertices=this.getVertices(t),i.Tracks=this.getTracks(t),i.Hits=this.getHits(t),i.CaloCells=this.getCells(t),i.CaloClusters=this.getCaloClusters(t),i.Jets=this.getJets(t),i.MissingEnergy=this.getMissingEnergy(t),this.eventData[e]=i}),!0}getEventData(){return this.eventData}getNumEvents(){return Object.keys(this.rawEventData).length}getRunNumber(e){if(!("EventHeader"in e))return 0;const t=e.EventHeader.collection;return"runNumber"in t?0:t[0].runNumber}getEventNumber(e){if(!("EventHeader"in e))return 0;const t=e.EventHeader.collection;return"eventNumber"in t?0:t[0].eventNumber}colorTracks(e){let t,i,r,s;"ReconstructedParticles"in e&&(t=e.ReconstructedParticles.collection,"Particle"in e&&(i=e.Particle.collection,"MCRecoAssociations"in e&&(r=e.MCRecoAssociations.collection,"EFlowTrack"in e&&(s=e.EFlowTrack.collection,r.forEach(o=>{const u=i[o.sim.index].PDG;t[o.rec.index].tracks.forEach(y=>{const T=s[y.index];11===Math.abs(u)?(T.color="00ff00",T.pid="electron"):22===Math.abs(u)?(T.color="ff0000",T.pid="photon"):211===Math.abs(u)||111===Math.abs(u)?(T.color="a52a2a",T.pid="pion"):2212===Math.abs(u)?(T.color="778899",T.pid="proton"):321===Math.abs(u)?(T.color="5f9ea0",T.pid="kaon"):(T.color="0000cd",T.pid="other"),T.pdgid=u})})))))}getVertices(e){const t={};for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||!("collection"in r)||"edm4hep::VertexCollection"!==r.collType)continue;const s=[],o=r.collection,l=this.randomColor();o.forEach(h=>{const u=[];"position"in h&&(u.push(.1*h.position.x),u.push(.1*h.position.y),u.push(.1*h.position.z)),s.push({pos:u,size:.2,color:"#"+l})}),t[i]=s}return t}getTracks(e){const t={};for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||"edm4hep::TrackCollection"!==r.collType||!("collection"in r))continue;const o=[],l=[],h=[],u=[],f=[],y=[];r.collection.forEach(T=>{const B=[];"trackerHits"in T&&T.trackerHits.forEach(le=>{const Pe=this.getCollByID(e,le.collectionID)[le.index];B.push([.1*Pe.position.x,.1*Pe.position.y,.1*Pe.position.z])}),"trackStates"in T&&0===B.length&&T.trackStates.forEach(le=>{"referencePoint"in le&&B.push([.1*le.referencePoint.x,.1*le.referencePoint.y,.1*le.referencePoint.z])});let j="0000cd";"color"in T&&(j=T.color);const ne={pos:B,color:j};"pid"in T?"electron"==T.pid?o.push(ne):"photon"==T.pid?l.push(ne):"pion"==T.pid?h.push(ne):"proton"==T.pid?u.push(ne):"kaon"==T.pid?f.push(ne):y.push(ne):y.push(ne)}),t[i+" | Electrons"]=o,t[i+" | Photons"]=l,t[i+" | Pions"]=h,t[i+" | Protons"]=u,t[i+" | Kaons"]=f,t[i+" | Other"]=y}return t}getHits(e){const t={};for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r&&r.collType.includes("edm4hep::")&&r.collType.includes("TrackerHitCollection")&&"collection"in r))continue;const s=r.collection,o=[],l=this.randomColor();s.forEach(h=>{const u=[];"position"in h&&(u.push(.1*h.position.x),u.push(.1*h.position.y),u.push(.1*h.position.z)),o.push({type:"CircularPoint",pos:u,color:"#"+l,size:2})}),t[i]=o}return t}getCells(e){const t={};for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r&&r.collType.includes("edm4hep::")&&r.collType.includes("CalorimeterHitCollection")&&"collection"in r))continue;const s=r.collection,o=[];let l=1e9;for(let f=0;f<1e4;++f){const y=Math.floor(Math.random()*s.length),T=Math.floor(Math.random()*s.length);if(y===T)continue;const B=Math.pow(s[y].position.x-s[T].position.x,2),j=Math.pow(s[y].position.y-s[T].position.y,2),ne=Math.pow(s[y].position.z-s[T].position.z,2),se=Math.sqrt(B+j+ne);se<l&&(l=se)}const h=.1*Math.floor(l)>1?.1*Math.floor(l):1,u=Math.floor(358*Math.random());s.forEach(f=>{const y=.1*f.position.x,T=.1*f.position.y,B=.1*f.position.z,j=Math.sqrt(Math.pow(y,2)+Math.pow(T,2)+Math.pow(B,2)),ne=Math.sqrt(Math.pow(y,2)+Math.pow(T,2)),se=Math.asinh(B/ne),le=Math.acos(y/ne)*Math.sign(T),Ee=this.valToLightness(f.energy,.001,1),Pe=this.valToOpacity(f.energy,.001,1),Ve={eta:se,phi:le,energy:f.energy,radius:j,side:h,length:h,color:"#"+this.convHSLtoHEX(u,90,Ee),opacity:Pe};o.push(Ve)}),t[i]=o}return t}getCaloClusters(e){const t={};for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||"edm4hep::ClusterCollection"!==r.collType||!("collection"in r))continue;const o=[];r.collection.forEach(l=>{const h=.1*l.position.x,u=.1*l.position.y,f=.1*l.position.z,y=Math.sqrt(Math.pow(h,2)+Math.pow(u,2)+Math.pow(f,2)),T=Math.sqrt(Math.pow(h,2)+Math.pow(u,2)),B=Math.asinh(f/T),j=Math.acos(h/T)*Math.sign(u);o.push({eta:B,phi:j,energy:100*l.energy,radius:y,side:4})}),t[i]=o}return t}getJets(e){const t={};for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||"edm4hep::ReconstructedParticleCollection"!==r.collType||!i.includes("Jet")&&!i.includes("jet")||!("collection"in r))continue;const s=[];r.collection.forEach(l=>{if(!("momentum"in l)||!("energy"in l))return;const h=l.momentum.x,u=l.momentum.y,f=l.momentum.z,y=Math.sqrt(Math.pow(h,2)+Math.pow(u,2)),T=Math.asinh(f/y),B=Math.acos(h/y)*Math.sign(u);s.push({eta:T,phi:B,energy:1e3*l.energy})}),t[i]=s}return t}getMissingEnergy(e){const t={};for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||"edm4hep::ReconstructedParticleCollection"!==r.collType||!i.includes("Missing")&&!i.includes("missing")||!("collection"in r))continue;const s=[];r.collection.forEach(h=>{if(!("momentum"in h)||!("energy"in h))return;const u=h.momentum.x,f=h.momentum.y,y=h.momentum.z,T=Math.sqrt(Math.pow(u,2)+Math.pow(f,2)+Math.pow(y,2));s.push({etx:h.energy*u/T*10,ety:h.energy*f/T*10,color:"#ff69b4"})}),t[i]=s}return t}randomColor(){return Math.floor(16777215*Math.random()).toString(16).padStart(6,"0").toUpperCase()}convHSLtoHEX(e,t,i){i/=100;const r=t*Math.min(i,1-i)/100,s=o=>{const l=(o+e/30)%12,h=i-r*Math.max(Math.min(l-3,9-l,1),-1);return Math.round(255*h).toString(16).padStart(2,"0")};return`${s(0)}${s(8)}${s(4)}`}valToLightness(e,t,i){let r=80-65*(e-t)/(i-t);return r<20&&(r=20),r>85&&(r=85),r}valToOpacity(e,t,i){let r=.2+.65*(e-t)/(i-t);return r<.2&&(r=.2),r>.8&&(r=.8),r}getCollByID(e,t){for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if("collID"in r&&r.collID===t)return r.collection}}}class uve extends hv{constructor(){super(),this.hitData=[],this.particleData=[],this.truthData={}}processHits(e){const t=e.split("\n");let i;console.log("Event has this many hits:",t.length);for(let r=1;r<t.length;r++)i=t[r].split(","),this.hitData[i[0]]=[parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3])]}processParticles(e){const t=e.split("\n");let i;console.log("Event has this many particles:",t.length);for(let r=1;r<t.length;r++)i=t[r].split(","),this.particleData.push({particle_id:parseInt(i[0]),vertex_pos:[parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3])],mom:[parseFloat(i[4]),parseFloat(i[5]),parseFloat(i[6])]})}processTruth(e){const t=e.split("\n");let i;console.log("Event has this many truth: ",t.length);for(let r=1;r<t.length;r++)i=t[r].split(","),this.truthData[i[0]]=[i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8]]}getEventData(e){const t={eventNumber:e,runNumber:0,Hits:{Reconstructed:[]},Tracks:{Particles:[]}};if(this.hitData){t.Hits.Reconstructed=[];let s=Math.round(this.hitData.length/5e3);s<1&&(s=1);let o=0;for(let l=1;l<this.hitData.length;l++)l%s||(t.Hits.Reconstructed[o++]=[[this.hitData[l][0],this.hitData[l][1],this.hitData[l][2]]])}if(console.log("Will show this many hits",t.Hits.Reconstructed.length),this.truthData){if(this.particleData)for(let h=0;h<this.particleData.length;h++)t.Tracks.Particles[h]={particle_id:this.particleData[h].particle_id,pos:[this.particleData[h].vertex_pos],mom:this.particleData[h].mom};let s,o;const l=parseInt(String(this.truthData.length/10));for(let h=1;h<this.truthData.length;h++){s=h,o=parseInt(this.truthData[h][0]);for(let u=0;u<t.Tracks.Particles.length;u++)t.Tracks.Particles[u].particle_id===o&&t.Tracks.Particles[u].pos.push([parseFloat(this.truthData[h][1]),parseFloat(this.truthData[h][2]),parseFloat(this.truthData[h][3])]);h%l==0&&(document.getElementById("info").innerHTML="Processed "+100*h/this.truthData.length+"% of event data.")}}for(let s=0;s<t.Tracks.Particles.length;s++);return t}}let ll=(()=>{class n extends lve{constructor(){super()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),KW=(()=>{class n{eventDisplay;year;constructor(t){this.eventDisplay=t,this.year=(new Date).getFullYear(),this.eventDisplay.getThreeManager().stopAnimationLoop()}ngAfterViewInit(){this.eventDisplay.getUIManager().detectColorScheme()}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-home"]],decls:71,vars:1,consts:[[1,"container"],[1,"pricing-header","p-3","pt-md-5","pb-md-4","text-center"],["src","assets/images/logo-text.svg","alt","",1,"logo","mb-4"],[1,"lead"],[1,"row","centered"],[1,"card"],["src","assets/images/playground.svg","alt","Card image cap",1,"card-img-top"],[1,"card-body","d-flex","flex-column"],[1,"card-title"],[1,"card-text"],["routerLink","/playground",1,"btn","btn-primary"],["src","assets/images/geometry.svg","alt","Card image cap",1,"card-img-top"],["routerLink","/geometry",1,"btn","btn-primary"],["src","assets/images/atlas.svg","alt","Card image cap",1,"card-img-top"],["routerLink","/atlas",1,"btn","btn-primary"],["src","assets/images/lhcb.svg","alt","Card image cap",1,"card-img-top"],["routerLink","/lhcb",1,"btn","btn-primary"],["src","assets/images/cms.svg","alt","Card image cap",1,"card-img-top"],["routerLink","/cms",1,"btn","btn-primary"],["src","assets/images/trackml2.png","alt","Card image cap",1,"card-img-top"],["routerLink","/trackml",1,"btn","btn-primary"],["href","https://github.com/HSF/phoenix"],["href","https://github.com/HSF/phoenix/blob/main/README.md"]],template:function(i,r){1&i&&(Wt(0,"div",0)(1,"div",1),Er(2,"img",2),Wt(3,"p",3),ki(4,"Application for visualizing High Energy Physics data."),un()(),Wt(5,"div",4)(6,"div",5),Er(7,"img",6),Wt(8,"div",7)(9,"h5",8),ki(10,"Playground"),un(),Wt(11,"p",9),ki(12," Get started with the different Phoenix features. "),un(),Wt(13,"a",10),ki(14,"Show"),un()()(),Wt(15,"div",5),Er(16,"img",11),Wt(17,"div",7)(18,"h5",8),ki(19,"Geometry display"),un(),Wt(20,"p",9),ki(21,"This test should show some simple geometry."),un(),Wt(22,"a",12),ki(23,"Show"),un()()(),Wt(24,"div",5),Er(25,"img",13),Wt(26,"div",7)(27,"h5",8),ki(28,"ATLAS"),un(),Wt(29,"p",9),ki(30,"Show the ATLAS detector. One simple event."),un(),Wt(31,"a",14),ki(32,"Show"),un()()(),Wt(33,"div",5),Er(34,"img",15),Wt(35,"div",7)(36,"h5",8),ki(37,"LHCb"),un(),Wt(38,"p",9),ki(39,"Show the LHCb detector. One simple event."),un(),Wt(40,"a",16),ki(41,"Show"),un()()(),Wt(42,"div",5),Er(43,"img",17),Wt(44,"div",7)(45,"h5",8),ki(46,"CMS"),un(),Wt(47,"p",9),ki(48,"Show the CMS detector. One simple event."),un(),Wt(49,"a",18),ki(50,"Show"),un()()(),Wt(51,"div",5),Er(52,"img",19),Wt(53,"div",7)(54,"h5",8),ki(55,"TrackML"),un(),Wt(56,"p",9),ki(57," Visualisation for TrackML. Shows how to write a custom event loader. "),un(),Wt(58,"a",20),ki(59,"Show"),un()()()()(),Wt(60,"footer")(61,"p")(62,"em"),ki(63),un(),ki(64," Phoenix Project "),un(),Wt(65,"p")(66,"a",21),ki(67," Github "),un(),ki(68," - "),Wt(69,"a",22),ki(70," Documentation "),un()()()),2&i&&(F(63),_A(r.year))},dependencies:[ES],styles:["h1[_ngcontent-%COMP%]{font-family:Circular}.logo[_ngcontent-%COMP%]{margin-top:2em;max-width:24em}.row[_ngcontent-%COMP%]{justify-content:center}.card[_ngcontent-%COMP%]{margin:1.2em;border:1px solid rgba(88,88,88,.08);box-shadow:var(--phoenix-box-shadow);padding:1em;width:20em;background-color:var(--phoenix-background-color-secondary);border-radius:10px}.card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary)}.card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-family:Circular;color:var(--phoenix-text-color)}.card[_ngcontent-%COMP%]   .card-img-top[_ngcontent-%COMP%]{width:100%;height:10em;object-fit:contain;border-radius:10px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{justify-content:space-between}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{border-radius:10px}.lead[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary)}footer[_ngcontent-%COMP%]{background-color:var(--phoenix-background-color);margin:5rem 1rem 3rem;color:var(--phoenix-text-color-secondary)}footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center}footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary)}footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--phoenix-text-color-secondary)}"]})}return n})(),vx=(()=>{class n{constructor(){}ngOnInit(){}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=wr({type:n,selectors:[["app-nav"]],decls:2,vars:0,consts:[["id","mainLogo","routerLink","/",1,"main-logo","fixed-top","p-2","mx-auto","mt-2"],["src","assets/images/logo-text.svg"]],template:function(i,r){1&i&&(Wt(0,"a",0),Er(1,"img",1),un())},dependencies:[ES],styles:[".main-logo[_ngcontent-%COMP%]{width:140px;z-index:9999}.main-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transition:all .5s}.main-logo[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:drop-shadow(0px 0px 10px var(--phoenix-text-color));transition:all .5s}"]})}return n})(),ZL=(()=>{class n{error=new WC;subscribeToError(t){this.error.onUpdate(t)}setError(t){this.error.update(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const dve=n=>({"load-complete":n}),fve=n=>({width:n});function pve(n,e){if(1&n&&(Wt(0,"div",7),Er(1,"span"),un()),2&n){const t=pr(2);F(),function _g(n){vg(y7,nte,n,!1)}(jd(2,fve,t.progress+"%"))}}function mve(n,e){if(1&n&&(bg(0),Er(1,"img",3),Wt(2,"p",4),ki(3," Loading..."),Er(4,"br"),Wt(5,"small",5),ki(6,"(This may take a while)"),un()(),Rs(7,pve,2,4,"div",6),xg()),2&n){const t=pr();F(7),jn("ngIf",void 0!==t.progress)}}function Ave(n,e){1&n&&(Wt(0,"p"),ki(1," An error occurred while loading the application. Please try refreshing the page. "),un())}let bx=(()=>{class n{errorMessageService;loaded=!1;progress;error;constructor(t){this.errorMessageService=t,this.errorMessageService.subscribeToError(i=>{this.loaded||(this.error=i)})}static \u0275fac=function(i){return new(i||n)(Q(ZL))};static \u0275cmp=wr({type:n,selectors:[["app-loader"]],inputs:{loaded:"loaded",progress:"progress"},decls:4,vars:5,consts:[["errorContainer",""],[1,"loader-wrapper","d-flex","position-absolute","flex-column","justify-content-center","align-items-center","w-100","h-100","p-5","text-center",3,"ngClass"],[4,"ngIf","ngIfElse"],["src","assets/images/logo-small.svg","alt","Loader"],[1,"mt-5"],[1,"text-muted"],["class","loading-bar",4,"ngIf"],[1,"loading-bar"]],template:function(i,r){if(1&i&&(Wt(0,"div",1),Rs(1,mve,8,1,"ng-container",2)(2,Ave,2,0,"ng-template",null,0,xk),un()),2&i){const s=Ha(3);jn("ngClass",jd(3,dve,r.loaded)),F(),jn("ngIf",void 0===r.error)("ngIfElse",s)}},dependencies:[Mg,Wd],styles:[".loader-wrapper[_ngcontent-%COMP%]{background:var(--phoenix-background-color);z-index:9998}.loader-wrapper.load-complete[_ngcontent-%COMP%]{display:none!important}.loader-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:5rem;height:5rem;animation:loader 2s infinite}.loader-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--phoenix-text-color)}.loader-wrapper[_ngcontent-%COMP%]   .loading-bar[_ngcontent-%COMP%]{width:15rem;max-width:90%;height:.5rem;background:var(--phoenix-background-color-tertiary);border-radius:2.5rem;overflow:hidden}.loader-wrapper[_ngcontent-%COMP%]   .loading-bar[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;height:100%;border-radius:2.5rem;background:linear-gradient(to right,var(--phoenix-primary),var(--phoenix-secondary));transition:all .5s}@keyframes _ngcontent-%COMP%_app-loader_loader{0%,to{transform:scale(.1) rotate(0)}95%{transform:scale(1) rotate(15deg)}}"]})}return n})(),gve=(()=>{class n{eventDisplay;loaded=!1;loadingProgress=0;constructor(t){this.eventDisplay=t}ngOnInit(){this.eventDisplay.init({}),this.eventDisplay.buildGeometryFromParameters({ModuleName:"Module 2",Xdim:10,Ydim:1,Zdim:45,NumPhiEl:64,NumZEl:10,Radius:75,MinZ:-250,MaxZ:250,TiltAngle:.3,PhiOffset:0,Colour:65280,EdgeColour:4494424}),this.eventDisplay.getLoadingManager().addProgressListener(i=>this.loadingProgress=i),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}copyCode(){const t=document.getElementById("geometryCode").textContent.trim(),i=document.createElement("input");document.body.appendChild(i),i.value=t,i.select(),document.execCommand("copy"),document.body.removeChild(i)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-geometry"]],decls:14,vars:3,consts:[[3,"loaded","progress"],[1,"demo-info"],["id","geometryCode"],[1,"copy-code",3,"click"],["id","eventDisplay"]],template:function(i,r){1&i&&(Er(0,"app-loader",0)(1,"app-nav"),Wt(2,"div",1)(3,"p")(4,"b"),ki(5,"Geometry Demo"),un()(),Wt(6,"p"),ki(7,"Try opening the console and typing:"),un(),Wt(8,"code",2),ki(9),un(),Wt(10,"p",3),mi("click",function(){return r.copyCode()}),Wt(11,"b"),ki(12,"Copy"),un()()(),Er(13,"div",4)),2&i&&(jn("loaded",r.loaded)("progress",r.loadingProgress),F(9),dl(" ",'var parameters = { ModuleName: "Module 3", Xdim: 10., Ydim: 1., Zdim: 45, NumPhiEl: 64, NumZEl: 10, Radius: 105, MinZ: -250, MaxZ: 250, TiltAngle: 0.3, PhiOffset: 0.0, Colour: 0xffff00, EdgeColour: 0x449458 }; window.EventDisplay.buildGeometryFromParameters(parameters);'," "))},dependencies:[vx,bx],styles:[".demo-info[_ngcontent-%COMP%]{position:absolute;top:5rem;left:1rem;font-size:.8rem;color:var(--phoenix-text-color-secondary);width:20rem;max-width:40%}.demo-info[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary);cursor:text}.demo-info[_ngcontent-%COMP%]   .copy-code[_ngcontent-%COMP%]{cursor:pointer}"]})}return n})();var ef=function(n){return n.JSON="JSON",n.EDM4HEPJSON="EDM4HEPJSON",n.JIVEXML="JIVEXML",n.IG="IG",n.ZIP="ZIP",n}(ef||{});class xx{format;fileType;handler;accept;constructor(e,t,i,r){this.format=e,this.fileType=t,this.handler=i,this.accept=r}}const yve=JSON.parse('{"phoenixMenu":{"name":"Phoenix Menu","nodeLevel":0,"toggleState":true,"childrenActive":false,"configs":[{"type":"button","label":"Save state"},{"type":"button","label":"Load state"}],"children":[{"name":"Detector","nodeLevel":1,"toggleState":true,"childrenActive":false,"configs":[{"type":"checkbox","label":"Wireframe","isChecked":false},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.01,"allowCustomValue":true},{"type":"slider","label":"Scale","min":0,"max":20,"step":0.01,"allowCustomValue":true}],"children":[{"name":"Magnets","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Barrel Toroid","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Endcap","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Feet","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Warm structure","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]}]},{"name":"Calorimeters","nodeLevel":2,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"LAr Barrel","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"LAr EC1","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"LAr FCAL","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"LAr HEC","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Tile Cal","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Tile Cal EC","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]}]},{"name":"Inner Detector","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Beam","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Pixel","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"SCT","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"SCT Endcaps","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"TRT","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"TRT Endcaps","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]}]},{"name":"Muon Spectrometer","nodeLevel":2,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Endcaps","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Extra wheel","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Big wheel","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Outer Wheel","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Big Wheel MDT ","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Small Wheel","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Small Wheel Hub","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Small Wheel Feet","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"TGC2","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"TGC3","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]}]},{"name":"Barrel","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Muon Barrel Inner","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Muon Barrel Middle","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Muon Barrel Outer","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]}]}]}]},{"name":"Event Data","nodeLevel":1,"toggleState":true,"childrenActive":false,"configs":[{"type":"checkbox","label":"Depth Test","isChecked":true}],"children":[{"name":"Tracks","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Tracks_","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"CombinedMuonTracks","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"childrenActive":false,"configs":[{"type":"color","label":"Color","color":"#0adb2d","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"MuonSpectrometerTracks","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"CombinedInDetTracks","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"GSFTracks","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"InDetTrackParticles_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"CombinedMuonTrackParticles_xAOD","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"GSFTrackParticles_xAOD","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]}]},{"name":"Jets","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Jets Scale","value":1,"min":0.001,"step":0.01,"max":100,"allowCustomValue":true}],"children":[{"name":"AntiKt4EMTopoJets_xAOD","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":100000,"step":100,"value":0,"highValue":100000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"AntiKt4LCTopoJets_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":100000,"step":100,"value":0,"highValue":100000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"AntiKt10LCTopoJets_xAOD","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":100000,"step":100,"value":0,"highValue":100000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"Hits","nodeLevel":2,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Pixel","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"SCT","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"TRT","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"MDT","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"RPC","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"TGC","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"CSC","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"CaloClusters","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"CaloClusters Scale","value":1,"min":0.001,"step":0.01,"max":100,"allowCustomValue":true}],"children":[{"name":"egammaClusters_xAOD","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"CaloCalTopoClusters","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"CaloCells","nodeLevel":2,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"LAr","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"HEC","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"PlanarCaloCells","nodeLevel":2,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"PlanarCaloCells Scale","value":1,"min":0.001,"step":0.01,"max":100,"allowCustomValue":true}],"children":[]},{"name":"Muons","nodeLevel":2,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Muons_xAOD","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"Muons","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"Photons","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Photons_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"Electrons","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Electrons_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"ForwardElectrons_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"HLT_xAOD__ElectronContainer_egamma_Electrons_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"Vertices","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Vertices Scale","value":1,"min":0.001,"step":0.01,"max":100,"allowCustomValue":true}],"children":[{"name":"Vertices_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"vertexType","min":0,"max":5,"step":1,"value":0,"highValue":5}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"MissingEnergy","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Size (%)","value":100,"min":1,"max":200,"allowCustomValue":true}],"children":[{"name":"MET_Reference_AntiKt4EMTopo_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"MET_Calo_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"MET_LocHadTopo_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"MET_Core_AntiKt4LCTopo_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]}]},{"name":"Labels","nodeLevel":1,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Size","min":0,"max":10,"step":0.01,"allowCustomValue":true},{"type":"color","label":"Color","color":"#a8a8a8"},{"type":"button","label":"Save Labels"},{"type":"button","label":"Load Labels"}],"children":[]}]},"eventDisplay":{"cameraPosition":[3096.1557286722164,2821.4315307500133,4232.068942374551],"startClippingAngle":0,"openingClippingAngle":90}}');let eN;try{eN=typeof Intl<"u"&&Intl.v8BreakIterator}catch{eN=!1}let mT,uh=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?DH(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!eN)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(td))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function zg(n){return function vve(){if(null==mT&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>mT=!0}))}finally{mT=mT||!1}return mT}()?n:!!n.capture}var O0=function(n){return n[n.NORMAL=0]="NORMAL",n[n.NEGATED=1]="NEGATED",n[n.INVERTED=2]="INVERTED",n}(O0||{});let DB,wx,tN;function JW(){if(null==wx){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return wx=!1,wx;if("scrollBehavior"in document.documentElement.style)wx=!0;else{const n=Element.prototype.scrollTo;wx=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return wx}function AT(){if("object"!=typeof document||!document)return O0.NORMAL;if(null==DB){const n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",n.appendChild(t),document.body.appendChild(n),DB=O0.NORMAL,0===n.scrollLeft&&(n.scrollLeft=1,DB=0===n.scrollLeft?O0.NEGATED:O0.INVERTED),n.remove()}return DB}function IB(n){if(function bve(){if(null==tN){const n=typeof document<"u"?document.head:null;tN=!(!n||!n.createShadowRoot&&!n.attachShadow)}return tN}()){const e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function nN(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const e=n.shadowRoot.activeElement;if(e===n)break;n=e}return n}function Sm(n){return n.composedPath?n.composedPath()[0]:n.target}function iN(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function eM(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}class Ove extends pt{constructor(e,t){super()}schedule(e,t=0){return this}}const PB={setInterval(n,e,...t){const{delegate:i}=PB;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=PB;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class oN extends Ove{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return PB.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&PB.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,ht(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const aN={now:()=>(aN.delegate||Date).now(),delegate:void 0};class gT{constructor(e,t=gT.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}gT.now=aN.now;class lN extends gT{constructor(e,t=gT.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const _T=new lN(oN),Lve=_T;function RB(n,e=_T){return Fn((t,i)=>{let r=null,s=null,o=null;const l=()=>{if(r){r.unsubscribe(),r=null;const u=s;s=null,i.next(u)}};function h(){const u=o+n,f=e.now();if(f<u)return r=this.schedule(void 0,u-f),void i.add(r);l()}t.subscribe(ai(i,u=>{s=u,o=e.now(),r||(r=e.schedule(h,n),i.add(r))},()=>{l(),i.complete()},void 0,()=>{s=r=null}))})}function cN(n){return Nc((e,t)=>n<=t)}function Nve(n,e){return n===e}function r$(n){return null!=n&&"false"!=`${n}`}function Cx(n,e=0){return function Uve(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):2===arguments.length?e:0}function vT(n){return Array.isArray(n)?n:[n]}function du(n){return null==n?"":"string"==typeof n?n:`${n}px`}function Pp(n){return n instanceof ro?n.nativeElement:n}let s$=(()=>{class n{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Gve=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({providers:[s$]})}return n})();const o$=new Set;let Mx,qve=(()=>{class n{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):jve}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function Qve(n,e){if(!o$.has(n))try{Mx||(Mx=document.createElement("style"),e&&Mx.setAttribute("nonce",e),Mx.setAttribute("type","text/css"),document.head.appendChild(Mx)),Mx.sheet&&(Mx.sheet.insertRule(`@media ${n} {body{ }}`,0),o$.add(n))}catch(t){console.error(t)}}(t,this._nonce),this._matchMedia(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(uh),Wn(u1,8))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function jve(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let Wve=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new Qt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return a$(vT(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=Bb(a$(vT(t)).map(o=>this._registerQuery(o).observable));return s=Pb(s.pipe(lh(1)),s.pipe(cN(1),RB(0))),s.pipe(kn(o=>{const l={matches:!1,breakpoints:{}};return o.forEach(({matches:h,query:u})=>{l.matches=l.matches||h,l.breakpoints[u]=h}),l}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new Be(o=>{const l=h=>this._zone.run(()=>o.next(h));return i.addListener(l),()=>{i.removeListener(l)}}).pipe(Mp(i),kn(({matches:o})=>({query:t,matches:o})),fl(this._destroySubject)),mql:i};return this._queries.set(t,s),s}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(qve),Wn(ns))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function a$(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}function kB(n,e){return n.getAttribute(e)?.match(/\S+/g)??[]}const c$="cdk-describedby-message",FB="cdk-describedby-host";let uN=0,Yve=(()=>{class n{constructor(t,i){this._platform=i,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+uN++,this._document=t,this._id=oi(uA)+"-"+uN++}describe(t,i,r){if(!this._canBeDescribed(t,i))return;const s=dN(i,r);"string"!=typeof i?(h$(i,this._id),this._messageRegistry.set(s,{messageElement:i,referenceCount:0})):this._messageRegistry.has(s)||this._createMessageElement(i,r),this._isElementDescribedByMessage(t,s)||this._addMessageReference(t,s)}removeDescription(t,i,r){if(!i||!this._isElementNode(t))return;const s=dN(i,r);if(this._isElementDescribedByMessage(t,s)&&this._removeMessageReference(t,s),"string"==typeof i){const o=this._messageRegistry.get(s);o&&0===o.referenceCount&&this._deleteMessageElement(s)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const t=this._document.querySelectorAll(`[${FB}="${this._id}"]`);for(let i=0;i<t.length;i++)this._removeCdkDescribedByReferenceIds(t[i]),t[i].removeAttribute(FB);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(t,i){const r=this._document.createElement("div");h$(r,this._id),r.textContent=t,i&&r.setAttribute("role",i),this._createMessagesContainer(),this._messagesContainer.appendChild(r),this._messageRegistry.set(dN(t,i),{messageElement:r,referenceCount:0})}_deleteMessageElement(t){this._messageRegistry.get(t)?.messageElement?.remove(),this._messageRegistry.delete(t)}_createMessagesContainer(){if(this._messagesContainer)return;const t="cdk-describedby-message-container",i=this._document.querySelectorAll(`.${t}[platform="server"]`);for(let s=0;s<i.length;s++)i[s].remove();const r=this._document.createElement("div");r.style.visibility="hidden",r.classList.add(t),r.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&r.setAttribute("platform","server"),this._document.body.appendChild(r),this._messagesContainer=r}_removeCdkDescribedByReferenceIds(t){const i=kB(t,"aria-describedby").filter(r=>0!=r.indexOf(c$));t.setAttribute("aria-describedby",i.join(" "))}_addMessageReference(t,i){const r=this._messageRegistry.get(i);(function $ve(n,e,t){const i=kB(n,e);t=t.trim(),!i.some(r=>r.trim()===t)&&(i.push(t),n.setAttribute(e,i.join(" ")))})(t,"aria-describedby",r.messageElement.id),t.setAttribute(FB,this._id),r.referenceCount++}_removeMessageReference(t,i){const r=this._messageRegistry.get(i);r.referenceCount--,function Xve(n,e,t){const i=kB(n,e);t=t.trim();const r=i.filter(s=>s!==t);r.length?n.setAttribute(e,r.join(" ")):n.removeAttribute(e)}(t,"aria-describedby",r.messageElement.id),t.removeAttribute(FB)}_isElementDescribedByMessage(t,i){const r=kB(t,"aria-describedby"),s=this._messageRegistry.get(i),o=s&&s.messageElement.id;return!!o&&-1!=r.indexOf(o)}_canBeDescribed(t,i){if(!this._isElementNode(t))return!1;if(i&&"object"==typeof i)return!0;const r=null==i?"":`${i}`.trim(),s=t.getAttribute("aria-label");return!(!r||s&&s.trim()===r)}_isElementNode(t){return t.nodeType===this._document.ELEMENT_NODE}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ca),Wn(uh))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function dN(n,e){return"string"==typeof n?`${e||""}/${n}`:n}function h$(n,e){n.id||(n.id=`${c$}-${e}-${uN++}`)}class u${constructor(e,t){this._letterKeyStream=new Qt,this._items=[],this._selectedItemIndex=-1,this._pressedLetters=[],this._selectedItem=new Qt,this.selectedItem=this._selectedItem;const i="number"==typeof t?.debounceInterval?t.debounceInterval:200;t?.skipPredicate&&(this._skipPredicateFn=t.skipPredicate),this.setItems(e),this._setupKeyHandler(i)}destroy(){this._pressedLetters=[],this._letterKeyStream.complete(),this._selectedItem.complete()}setCurrentSelectedItemIndex(e){this._selectedItemIndex=e}setItems(e){this._items=e}handleKey(e){const t=e.keyCode;e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))}isTyping(){return this._pressedLetters.length>0}reset(){this._pressedLetters=[]}_setupKeyHandler(e){this._letterKeyStream.pipe(Xc(t=>this._pressedLetters.push(t)),RB(e),Nc(()=>this._pressedLetters.length>0),kn(()=>this._pressedLetters.join("").toLocaleUpperCase())).subscribe(t=>{for(let i=1;i<this._items.length+1;i++){const s=this._items[(this._selectedItemIndex+i)%this._items.length];if(!this._skipPredicateFn?.(s)&&0===s.getLabel?.().toLocaleUpperCase().trim().indexOf(t)){this._selectedItem.next(s);break}}this._pressedLetters=[]})}}class Zve{constructor(e,t){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._typeaheadSubscription=pt.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=i=>i.disabled,this.tabOut=new Qt,this.change=new Qt,e instanceof Bf?this._itemChangesSubscription=e.changes.subscribe(i=>this._itemsChanged(i.toArray())):fD(e)&&(this._effectRef=function iH(n,e){Of("NgSignals"),!e?.injector&&o_();const t=e?.injector??oi(Dr),i=!0!==e?.manualCleanup?t.get(mc):null,r=new Ase(t.get(fse),n,typeof Zone>"u"?null:Zone.current,i,t,e?.allowSignalWrites??!1),s=t.get(Ac,null,{optional:!0});return s&&8&s._lView[Ys]?(s._lView[QA]??=[]).push(r.watcher.notify):r.watcher.notify(),r}(()=>this._itemsChanged(e()),{injector:t}))}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){this._typeaheadSubscription.unsubscribe();const t=this._getItemsArray();return this._typeahead=new u$(t,{debounceInterval:"number"==typeof e?e:void 0,skipPredicate:i=>this._skipPredicateFn(i)}),this._typeaheadSubscription=this._typeahead.selectedItem.subscribe(i=>{this.setActiveItem(i)}),this}cancelTypeahead(){return this._typeahead?.reset(),this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,t=10){return this._pageUpAndDown={enabled:e,delta:t},this}setActiveItem(e){const t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex+this._pageUpAndDown.delta,o=this._getItemsArray().length;this._setActiveItemByIndex(s<o?s:o-1,-1);break}return;default:return void((r||eM(e,"shiftKey"))&&this._typeahead?.handleKey(e))}this._typeahead?.reset(),e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return!!this._typeahead&&this._typeahead.isTyping()}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),i="number"==typeof e?e:t.indexOf(e);this._activeItem=t[i]??null,this._activeItemIndex=i,this._typeahead?.setCurrentSelectedItemIndex(i)}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._typeahead?.destroy(),this.tabOut.complete(),this.change.complete()}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let i=1;i<=t.length;i++){const r=(this._activeItemIndex+e*i+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const i=this._getItemsArray();if(i[e]){for(;this._skipPredicateFn(i[e]);)if(!i[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return fD(this._items)?this._items():this._items instanceof Bf?this._items.toArray():this._items}_itemsChanged(e){if(this._typeahead?.setItems(e),this._activeItem){const t=e.indexOf(this._activeItem);t>-1&&t!==this._activeItemIndex&&(this._activeItemIndex=t,this._typeahead?.setCurrentSelectedItemIndex(t))}}}class d$ extends Zve{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(e){return this._origin=e,this}setActiveItem(e){super.setActiveItem(e),this.activeItem&&this.activeItem.focus(this._origin)}}let pN=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function ibe(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function nbe(n){try{return n.frameElement}catch{return null}}(function ube(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(i&&(-1===m$(i)||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),s=m$(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function cbe(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function hbe(n){return!function sbe(n){return function abe(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function rbe(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function obe(n){return function lbe(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||p$(n))}(t)&&!this.isDisabled(t)&&(i?.ignoreVisibility||this.isVisible(t))}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(uh))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function p$(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function m$(n){if(!p$(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class A${get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,t,i,r,s=!1,o){this._element=e,this._checker=t,this._ngZone=i,this._document=r,this._injector=o,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return i?.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=0;i<t.length;i++){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=t.length-1;i>=0;i--){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._injector?AA(e,{injector:this._injector}):setTimeout(e)}}let g$=(()=>{class n{constructor(t,i,r){this._checker=t,this._ngZone=i,this._injector=oi(Dr),this._document=r}create(t,i=!1){return new A$(t,this._checker,this._ngZone,this._document,i,this._injector)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(pN),Wn(ns),Wn(ca))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function OB(n){return 0===n.buttons||0===n.detail}function LB(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const dbe=new Ai("cdk-input-modality-detector-options"),fbe={ignoreKeys:[18,17,224,91,16]},tM=zg({passive:!0,capture:!0});let pbe=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new dn(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(l=>l===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Sm(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(OB(o)?"keyboard":"mouse"),this._mostRecentTarget=Sm(o))},this._onTouchstart=o=>{LB(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Sm(o))},this._options={...fbe,...s},this.modalityDetected=this._modality.pipe(cN(1)),this.modalityChanged=this.modalityDetected.pipe(function hN(n,e=W){return n=n??Nve,Fn((t,i)=>{let r,s=!0;t.subscribe(ai(i,o=>{const l=e(o);(s||!n(r,l))&&(s=!1,r=l,i.next(o))}))})}()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,tM),r.addEventListener("mousedown",this._onMousedown,tM),r.addEventListener("touchstart",this._onTouchstart,tM)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,tM),document.removeEventListener("mousedown",this._onMousedown,tM),document.removeEventListener("touchstart",this._onTouchstart,tM))}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(uh),Wn(ns),Wn(ca),Wn(dbe,8))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var NB=function(n){return n[n.IMMEDIATE=0]="IMMEDIATE",n[n.EVENTUAL=1]="EVENTUAL",n}(NB||{});const Abe=new Ai("cdk-focus-monitor-default-options"),UB=zg({passive:!0,capture:!0});let cy=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Qt,this._rootNodeFocusAndBlurListener=l=>{for(let u=Sm(l);u;u=u.parentElement)"focus"===l.type?this._onFocus(l,u):this._onBlur(l,u)},this._document=s,this._detectionMode=o?.detectionMode||NB.IMMEDIATE}monitor(t,i=!1){const r=Pp(t);if(!this._platform.isBrowser||1!==r.nodeType)return ds();const s=IB(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const l={checkChildren:i,subject:new Qt,rootNode:s};return this._elementInfo.set(r,l),this._registerGlobalListeners(l),l.subject}stopMonitoring(t){const i=Pp(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=Pp(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([l,h])=>this._originChanged(l,i,h)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return this._detectionMode===NB.EVENTUAL||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,this._detectionMode===NB.IMMEDIATE&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=Sm(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,UB),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,UB)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(fl(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,UB),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,UB),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(i))return!0;return!1}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ns),Wn(uh),Wn(pbe),Wn(ca,8),Wn(Abe,8))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Ex=function(n){return n[n.NONE=0]="NONE",n[n.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",n[n.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",n}(Ex||{});const y$="cdk-high-contrast-black-on-white",v$="cdk-high-contrast-white-on-black",mN="cdk-high-contrast-active";let b$=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=oi(Wve).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Ex.NONE;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Ex.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Ex.BLACK_ON_WHITE}return Ex.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(mN,y$,v$),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();i===Ex.BLACK_ON_WHITE?t.add(mN,y$):i===Ex.WHITE_ON_BLACK&&t.add(mN,v$)}}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(uh),Wn(ca))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),x$=(()=>{class n{constructor(t){t._applyBodyHighContrastModeCssClasses()}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(b$))};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({imports:[Gve]})}return n})();function Tm(...n){const e=lS(n),t=function Vae(n,e){return"number"==typeof gF(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?$d(i[0]):k2(t)(cu(i,e)):Am}let AN,_be=1;const zB={};function w$(n){return n in zB&&(delete zB[n],!0)}const ybe={setImmediate(n){const e=_be++;return zB[e]=!0,AN||(AN=Promise.resolve()),AN.then(()=>w$(e)&&n()),e},clearImmediate(n){w$(n)}},{setImmediate:vbe,clearImmediate:bbe}=ybe,HB={setImmediate(...n){const{delegate:e}=HB;return(e?.setImmediate||vbe)(...n)},clearImmediate(n){const{delegate:e}=HB;return(e?.clearImmediate||bbe)(n)},delegate:void 0},gN=new class wbe extends lN{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class xbe extends oN{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=HB.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(HB.clearImmediate(t),e._scheduled===t&&(e._scheduled=void 0))}});function C$(n,e){return e?t=>Pb(e.pipe(lh(1),function Cbe(){return Fn((n,e)=>{n.subscribe(ai(e,fn))})}()),t.pipe(C$(n))):nd((t,i)=>$d(n(t,i)).pipe(lh(1),WV(t)))}function VB(n=0,e,t=Lve){let i=-1;return null!=e&&(tV(e)?t=e:i=e),new Be(r=>{let s=function Mbe(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}function M$(n,e=_T){const t=VB(n,e);return C$(()=>t)}const Ebe=new Ai("cdk-dir-doc",{providedIn:"root",factory:function Sbe(){return oi(ca)}}),Tbe=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Rp=(()=>{class n{constructor(t){this.value="ltr",this.change=new os,t&&(this.value=function Dbe(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?Tbe.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(Ebe,8))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),bT=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({})}return n})();const Ibe=["mat-internal-form-field",""],Bbe=["*"],Rbe=new Ai("mat-sanity-checks",{providedIn:"root",factory:function Pbe(){return!0}});let zh=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!iN()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(b$),Wn(Rbe,8),Wn(ca))};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({imports:[bT,bT]})}return n})();var kp=function(n){return n[n.FADING_IN=0]="FADING_IN",n[n.VISIBLE=1]="VISIBLE",n[n.FADING_OUT=2]="FADING_OUT",n[n.HIDDEN=3]="HIDDEN",n}(kp||{});class zbe{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=kp.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}}const T$=zg({passive:!0,capture:!0});class Hbe{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=Sm(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){const s=this._events.get(t);if(s){const o=s.get(i);o?o.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,T$)})}removeHandler(e,t,i){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(i),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,T$)))}}const D$={enterDuration:225,exitDuration:150},I$=zg({passive:!0,capture:!0}),B$=["mousedown","touchstart"],P$=["mouseup","mouseleave","touchend","touchcancel"];class GB{static#e=this._eventManager=new Hbe;constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Pp(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...D$,...i.animation};i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function Gbe(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),l=e-r.left,h=t-r.top,u=s.enterDuration,f=document.createElement("div");f.classList.add("mat-ripple-element"),f.style.left=l-o+"px",f.style.top=h-o+"px",f.style.height=2*o+"px",f.style.width=2*o+"px",null!=i.color&&(f.style.backgroundColor=i.color),f.style.transitionDuration=`${u}ms`,this._containerElement.appendChild(f);const y=window.getComputedStyle(f),B=y.transitionDuration,j="none"===y.transitionProperty||"0s"===B||"0s, 0s"===B||0===r.width&&0===r.height,ne=new zbe(this,f,i,j);f.style.transform="scale3d(1, 1, 1)",ne.state=kp.FADING_IN,i.persistent||(this._mostRecentTransientRipple=ne);let se=null;return!j&&(u||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const le=()=>{se&&(se.fallbackTimer=null),clearTimeout(Pe),this._finishRippleTransition(ne)},Ee=()=>this._destroyRipple(ne),Pe=setTimeout(Ee,u+100);f.addEventListener("transitionend",le),f.addEventListener("transitioncancel",Ee),se={onTransitionEnd:le,onTransitionCancel:Ee,fallbackTimer:Pe}}),this._activeRipples.set(ne,se),(j||!u)&&this._finishRippleTransition(ne),ne}fadeOutRipple(e){if(e.state===kp.FADING_OUT||e.state===kp.HIDDEN)return;const t=e.element,i={...D$,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=kp.FADING_OUT,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Pp(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,B$.forEach(i=>{GB._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{P$.forEach(t=>{this._triggerElement.addEventListener(t,this,I$)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===kp.FADING_IN?this._startFadeOutTransition(e):e.state===kp.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=kp.VISIBLE,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=kp.HIDDEN,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel),null!==t.fallbackTimer&&clearTimeout(t.fallbackTimer)),e.element.remove()}_onMousedown(e){const t=OB(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!LB(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(e.state===kp.VISIBLE||e.config.terminateOnPointerUp&&e.state===kp.FADING_IN)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(B$.forEach(t=>GB._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&(P$.forEach(t=>e.removeEventListener(t,this,I$)),this._pointerUpEventsRegistered=!1))}}const _N=new Ai("mat-ripple-global-options");let L0=(()=>{class n{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new GB(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(ns),Q(uh),Q(_N,8),Q(gh,8))};static#t=this.\u0275dir=mr({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){2&i&&Ka("mat-ripple-unbounded",r.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0})}return n})(),qB=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({imports:[zh,zh]})}return n})();const R$={capture:!0},k$=["focus","mousedown","mouseenter","touchstart"],yN="mat-ripple-loader-uninitialized",vN="mat-ripple-loader-class-name",F$="mat-ripple-loader-centered",QB="mat-ripple-loader-disabled";let qbe=(()=>{class n{constructor(){this._document=oi(ca,{optional:!0}),this._animationMode=oi(gh,{optional:!0}),this._globalRippleOptions=oi(_N,{optional:!0}),this._platform=oi(uh),this._ngZone=oi(ns),this._hosts=new Map,this._onInteraction=t=>{const i=Sm(t);if(i instanceof HTMLElement){const r=i.closest(`[${yN}="${this._globalRippleOptions?.namespace??""}"]`);r&&this._createRipple(r)}},this._ngZone.runOutsideAngular(()=>{for(const t of k$)this._document?.addEventListener(t,this._onInteraction,R$)})}ngOnDestroy(){const t=this._hosts.keys();for(const i of t)this.destroyRipple(i);for(const i of k$)this._document?.removeEventListener(i,this._onInteraction,R$)}configureRipple(t,i){t.setAttribute(yN,this._globalRippleOptions?.namespace??""),(i.className||!t.hasAttribute(vN))&&t.setAttribute(vN,i.className||""),i.centered&&t.setAttribute(F$,""),i.disabled&&t.setAttribute(QB,"")}getRipple(t){return this._hosts.get(t)||this._createRipple(t)}setDisabled(t,i){const r=this._hosts.get(t);r?r.disabled=i:i?t.setAttribute(QB,""):t.removeAttribute(QB)}_createRipple(t){if(!this._document)return;const i=this._hosts.get(t);if(i)return i;t.querySelector(".mat-ripple")?.remove();const r=this._document.createElement("span");r.classList.add("mat-ripple",t.getAttribute(vN)),t.append(r);const s=new L0(new ro(r),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return s._isInitialized=!0,s.trigger=t,s.centered=t.hasAttribute(F$),s.disabled=t.hasAttribute(QB),this.attachRipple(t,s),s}attachRipple(t,i){t.removeAttribute(yN),this._hosts.set(t,i)}destroyRipple(t){const i=this._hosts.get(t);i&&(i.ngOnDestroy(),this._hosts.delete(t))}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),bN=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=wr({type:n,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(i,r){2&i&&Ka("mdc-form-field--align-end","before"===r.labelPosition)},inputs:{labelPosition:"labelPosition"},standalone:!0,features:[ah],attrs:Ibe,ngContentSelectors:Bbe,decls:1,vars:0,template:function(i,r){1&i&&(xd(),ou(0))},styles:[".mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-flex;align-items:center;vertical-align:middle}.mat-internal-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mat-internal-form-field>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end .mdc-form-field--align-end label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0}"],encapsulation:2,changeDetection:0})}return n})();class xN{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class hy extends xN{constructor(e,t,i,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}}class wT extends xN{constructor(e,t,i,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class Qbe extends xN{constructor(e){super(),this.element=e instanceof ro?e.nativeElement:e}}class wN{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof hy?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof wT?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof Qbe?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class jbe extends wN{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=o=>{const l=o.element,h=this._document.createComment("dom-portal");l.parentNode.insertBefore(h,l),this.outletElement.appendChild(l),this._attachedPortal=o,super.setDisposeFn(()=>{h.parentNode&&h.parentNode.replaceChild(l,h)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||Dr.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let nM=(()=>{class n extends wN{constructor(t,i,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new os,this.attachDomPortal=s=>{const o=s.element,l=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(l,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(o,l)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);const i=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=i.createComponent(s,i.length,t.injector||i.injector,t.projectableNodes||void 0);return i!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}static#e=this.\u0275fac=function(i){return new(i||n)(Q(_b),Q(Fh),Q(ca))};static#t=this.\u0275dir=mr({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[Fo]})}return n})(),jB=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({})}return n})();var Wo=function(n){return n[n.State=0]="State",n[n.Transition=1]="Transition",n[n.Sequence=2]="Sequence",n[n.Group=3]="Group",n[n.Animate=4]="Animate",n[n.Keyframes=5]="Keyframes",n[n.Style=6]="Style",n[n.Trigger=7]="Trigger",n[n.Reference=8]="Reference",n[n.AnimateChild=9]="AnimateChild",n[n.AnimateRef=10]="AnimateRef",n[n.Query=11]="Query",n[n.Stagger=12]="Stagger",n}(Wo||{});const uy="*";function CT(n,e){return{type:Wo.Trigger,name:n,definitions:e,options:{}}}function N0(n,e=null){return{type:Wo.Animate,styles:e,timings:n}}function ld(n){return{type:Wo.Style,styles:n,offset:null}}function dy(n,e,t){return{type:Wo.State,name:n,styles:e,options:t}}function U0(n,e,t=null){return{type:Wo.Transition,expr:n,animation:e,options:t}}class MT{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class U${constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,l)=>Math.max(o,l.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}const Jbe=["addListener","removeListener"],exe=["addEventListener","removeEventListener"],txe=["on","off"];function Sx(n,e,t,i){if(We(t)&&(i=t,t=void 0),i)return Sx(n,e,t).pipe(TF(i));const[r,s]=function rxe(n){return We(n.addEventListener)&&We(n.removeEventListener)}(n)?exe.map(o=>l=>n[o](e,l,t)):function nxe(n){return We(n.addListener)&&We(n.removeListener)}(n)?Jbe.map(z$(n,e)):function ixe(n){return We(n.on)&&We(n.off)}(n)?txe.map(z$(n,e)):[];if(!r&&xF(n))return nd(o=>Sx(o,e,t))($d(n));if(!r)throw new TypeError("Invalid event target");return new Be(o=>{const l=(...h)=>o.next(1<h.length?h:h[0]);return r(l),()=>s(l)})}function z$(n,e){return t=>i=>n[t](e,i)}const ET={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=ET;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new pt(()=>t?.(r))},requestAnimationFrame(...n){const{delegate:e}=ET;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=ET;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0},H$=new class oxe extends lN{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class sxe extends oN{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=ET.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(ET.cancelAnimationFrame(t),e._scheduled=void 0)}});function V$(n,e=_T){return function axe(n){return Fn((e,t)=>{let i=!1,r=null,s=null,o=!1;const l=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const u=r;r=null,t.next(u)}o&&t.complete()},h=()=>{s=null,o&&t.complete()};e.subscribe(ai(t,u=>{i=!0,r=u,s||$d(n(u)).subscribe(s=ai(t,l,h))},()=>{o=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>VB(n,e))}let WB=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new Qt,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Be(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(V$(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):ds()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(Nc(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=Pp(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Sx(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ns),Wn(uh),Wn(ca,8))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),G$=(()=>{class n{constructor(t,i,r,s){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=r,this.dir=s,this._destroyed=new Qt,this._elementScrolled=new Be(o=>this.ngZone.runOutsideAngular(()=>Sx(this.elementRef.nativeElement,"scroll").pipe(fl(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const i=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),r&&AT()!=O0.NORMAL?(null!=t.left&&(t.right=i.scrollWidth-i.clientWidth-t.left),AT()==O0.INVERTED?t.left=t.right:AT()==O0.NEGATED&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const i=this.elementRef.nativeElement;JW()?i.scrollTo(t):(null!=t.top&&(i.scrollTop=t.top),null!=t.left&&(i.scrollLeft=t.left))}measureScrollOffset(t){const i="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?r:i:"end"==t&&(t=o?i:r),o&&AT()==O0.INVERTED?t==i?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&AT()==O0.NEGATED?t==i?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==i?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(WB),Q(ns),Q(Rp,8))};static#t=this.\u0275dir=mr({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0})}return n})(),ST=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new Qt,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(V$(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(uh),Wn(ns),Wn(ca,8))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),TT=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({})}return n})(),q$=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({imports:[bT,TT,bT,TT]})}return n})();const Q$=JW();class hxe{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=du(-this._previousScrollPosition.left),e.style.top=du(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),Q$&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),Q$&&(i.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class uxe{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe(Nc(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class j${enable(){}disable(){}attach(){}}function MN(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function W$(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class dxe{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();MN(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let fxe=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new j$,this.close=o=>new uxe(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new hxe(this._viewportRuler,this._document),this.reposition=o=>new dxe(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(WB),Wn(ST),Wn(ns),Wn(ca))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class EN{constructor(e){if(this.scrollStrategy=new j$,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class pxe{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let X$=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ca))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),mxe=(()=>{class n extends X${constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const l=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>l.next(r)):l.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ca),Wn(ns,8))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Axe=(()=>{class n extends X${constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=Sm(s)},this._clickListener=s=>{const o=Sm(s),l="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const h=this._attachedOverlays.slice();for(let u=h.length-1;u>-1;u--){const f=h[u];if(f._outsidePointerEvents.observers.length<1||!f.hasAttached())continue;if(Y$(f.overlayElement,o)||Y$(f.overlayElement,l))break;const y=f._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>y.next(s)):y.next(s)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ca),Wn(uh),Wn(ns,8))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Y$(n,e){const t=typeof ShadowRoot<"u"&&ShadowRoot;let i=e;for(;i;){if(i===n)return!0;i=t&&i instanceof ShadowRoot?i.host:i.parentNode}return!1}let $B=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||iN()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(t),iN()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ca),Wn(uh))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class XB{constructor(e,t,i,r,s,o,l,h,u,f=!1,y){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=l,this._location=h,this._outsideClickDispatcher=u,this._animationsDisabled=f,this._injector=y,this._backdropElement=null,this._backdropClick=new Qt,this._attachments=new Qt,this._detachments=new Qt,this._locationChanges=pt.EMPTY,this._backdropClickHandler=T=>this._backdropClick.next(T),this._backdropTransitionendHandler=T=>{this._disposeBackdrop(T.target)},this._keydownEvents=new Qt,this._outsidePointerEvents=new Qt,this._renders=new Qt,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy,this._afterRenderRef=wg(()=>function LU(n,e){!e?.injector&&o_();const t=e?.injector??oi(Dr);return Qd(t)?(Of("NgAfterRender"),NU(n,t,e,!1)):UU}(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),AA(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=du(this._config.width),e.height=du(this._config.height),e.minWidth=du(this._config.minWidth),e.minHeight=du(this._config.minHeight),e.maxWidth=du(this._config.maxWidth),e.maxHeight=du(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){const r=vT(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{const e=this._renders.pipe(fl(Tm(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const K$="cdk-overlay-connected-position-bounding-box",gxe=/([A-Za-z%]+)$/;class _xe{get positions(){return this._preferredPositions}constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Qt,this._resizeSubscription=pt.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(K$),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let o;for(let l of this._preferredPositions){let h=this._getOriginPoint(e,r,l),u=this._getOverlayPoint(h,t,l),f=this._getOverlayFit(u,t,i,l);if(f.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(l,h);this._canFitWithFlexibleDimensions(f,u,i)?s.push({position:l,origin:h,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(h,l)}):(!o||o.overlayFit.visibleArea<f.visibleArea)&&(o={overlayFit:f,overlayPoint:u,originPoint:h,position:l,overlayRect:t})}if(s.length){let l=null,h=-1;for(const u of s){const f=u.boundingBoxRect.width*u.boundingBoxRect.height*(u.position.weight||1);f>h&&(h=f,l=u)}return this._isPushed=!1,void this._applyPosition(l.position,l.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Tx(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(K$),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r,s;if("center"==i.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,l=this._isRtl()?e.left:e.right;r="start"==i.originX?o:l}return t.left<0&&(r-=t.left),s="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=J$(t);let{x:o,y:l}=e,h=this._getOffset(r,"x"),u=this._getOffset(r,"y");h&&(o+=h),u&&(l+=u);let T=0-l,B=l+s.height-i.height,j=this._subtractOverflows(s.width,0-o,o+s.width-i.width),ne=this._subtractOverflows(s.height,T,B),se=j*ne;return{visibleArea:se,isCompletelyWithinViewport:s.width*s.height===se,fitsInViewportVertically:ne===s.height,fitsInViewportHorizontally:j==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,o=Z$(this._overlayRef.getConfig().minHeight),l=Z$(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=o&&o<=r)&&(e.fitsInViewportHorizontally||null!=l&&l<=s)}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=J$(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),l=Math.max(e.y+r.height-s.height,0),h=Math.max(s.top-i.top-e.y,0),u=Math.max(s.left-i.left-e.x,0);let f=0,y=0;return f=r.width<=s.width?u||-o:e.x<this._viewportMargin?s.left-i.left-e.x:0,y=r.height<=s.height?h||-l:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:f,y},{x:e.x+f,y:e.y+y}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._positionChanges.observers.length){const i=this._getScrollVisibility();if(e!==this._lastPosition||!this._lastScrollVisibility||!function yxe(n,e){return n===e||n.isOriginClipped===e.isOriginClipped&&n.isOriginOutsideView===e.isOriginOutsideView&&n.isOverlayClipped===e.isOverlayClipped&&n.isOverlayOutsideView===e.isOverlayOutsideView}(this._lastScrollVisibility,i)){const r=new pxe(e,i);this._positionChanges.next(r)}this._lastScrollVisibility=i}this._lastPosition=e,this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,o,l,f,y,T;if("top"===t.overlayY)o=e.y,s=i.height-o+this._viewportMargin;else if("bottom"===t.overlayY)l=i.height-e.y+2*this._viewportMargin,s=i.height-l+this._viewportMargin;else{const B=Math.min(i.bottom-e.y+i.top,e.y),j=this._lastBoundingBoxSize.height;s=2*B,o=e.y-B,s>j&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-j/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)T=i.width-e.x+2*this._viewportMargin,f=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)y=e.x,f=i.right-e.x;else{const B=Math.min(i.right-e.x+i.left,e.x),j=this._lastBoundingBoxSize.width;f=2*B,y=e.x-B,f>j&&!this._isInitialRender&&!this._growAfterOpen&&(y=e.x-j/2)}return{top:o,left:y,bottom:l,right:T,width:f,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=du(i.height),r.top=du(i.top),r.bottom=du(i.bottom),r.width=du(i.width),r.left=du(i.left),r.right=du(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=du(s)),o&&(r.maxWidth=du(o))}this._lastBoundingBoxSize=i,Tx(this._boundingBox.style,r)}_resetBoundingBoxStyles(){Tx(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Tx(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const f=this._viewportRuler.getViewportScrollPosition();Tx(i,this._getExactOverlayY(t,e,f)),Tx(i,this._getExactOverlayX(t,e,f))}else i.position="static";let l="",h=this._getOffset(t,"x"),u=this._getOffset(t,"y");h&&(l+=`translateX(${h}px) `),u&&(l+=`translateY(${u}px)`),i.transform=l.trim(),o.maxHeight&&(r?i.maxHeight=du(o.maxHeight):s&&(i.maxHeight="")),o.maxWidth&&(r?i.maxWidth=du(o.maxWidth):s&&(i.maxWidth="")),Tx(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=du(s.y),r}_getExactOverlayX(e,t,i){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=du(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:W$(e,i),isOriginOutsideView:MN(e,i),isOverlayClipped:W$(t,i),isOverlayOutsideView:MN(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&vT(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof ro)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function Tx(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function Z$(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(gxe);return t&&"px"!==t?null:parseFloat(e)}return n||null}function J$(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const eX="cdk-global-overlay-wrapper";class vxe{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(eX),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:l}=i,h=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),u=!("100%"!==s&&"100vh"!==s||l&&"100%"!==l&&"100vh"!==l),f=this._xPosition,y=this._xOffset,T="rtl"===this._overlayRef.getConfig().direction;let B="",j="",ne="";h?ne="flex-start":"center"===f?(ne="center",T?j=y:B=y):T?"left"===f||"end"===f?(ne="flex-end",B=y):("right"===f||"start"===f)&&(ne="flex-start",j=y):"left"===f||"start"===f?(ne="flex-start",B=y):("right"===f||"end"===f)&&(ne="flex-end",j=y),e.position=this._cssPosition,e.marginLeft=h?"0":B,e.marginTop=u?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=h?"0":j,t.justifyContent=ne,t.alignItems=u?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(eX),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let bxe=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new vxe}flexibleConnectedTo(t){return new _xe(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ST),Wn(ca),Wn(uh),Wn($B))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),xxe=0,fu=(()=>{class n{constructor(t,i,r,s,o,l,h,u,f,y,T,B){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=l,this._ngZone=h,this._document=u,this._directionality=f,this._location=y,this._outsideClickDispatcher=T,this._animationsModuleType=B}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),o=new EN(t);return o.direction=o.direction||this._directionality.value,new XB(s,i,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType,this._injector.get(th))}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+xxe++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(yA)),new jbe(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(fxe),Wn($B),Wn(_b),Wn(bxe),Wn(mxe),Wn(Dr),Wn(ns),Wn(ca),Wn(Rp),Wn(Sb),Wn(Axe),Wn(gh,8))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Mxe={provide:new Ai("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{const n=oi(fu);return()=>n.scrollStrategies.reposition()}}),deps:[fu],useFactory:function Cxe(n){return()=>n.scrollStrategies.reposition()}};let DT=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({providers:[fu,Mxe],imports:[bT,jB,q$,q$]})}return n})();const Exe=["mat-menu-item",""],Sxe=[[["mat-icon"],["","matMenuItemIcon",""]],"*"],Txe=["mat-icon, [matMenuItemIcon]","*"];function Dxe(n,e){1&n&&(Fr(),Wt(0,"svg",2),Er(1,"polygon",3),un())}const Ixe=["*"];function Bxe(n,e){if(1&n){const t=zo();Wt(0,"div",0),mi("keydown",function(r){return pi(t),fi(pr()._handleKeydown(r))})("click",function(){return pi(t),fi(pr().closed.emit("click"))})("@transformMenu.start",function(r){return pi(t),fi(pr()._onAnimationStart(r))})("@transformMenu.done",function(r){return pi(t),fi(pr()._onAnimationDone(r))}),Wt(1,"div",1),ou(2),un()()}if(2&n){const t=pr();gA(t._classList),jn("id",t.panelId)("@transformMenu",t._panelAnimationState),ja("aria-label",t.ariaLabel||null)("aria-labelledby",t.ariaLabelledby||null)("aria-describedby",t.ariaDescribedby||null)}}const SN=new Ai("MAT_MENU_PANEL");let fy=(()=>{class n{constructor(t,i,r,s,o){this._elementRef=t,this._document=i,this._focusMonitor=r,this._parentMenu=s,this._changeDetectorRef=o,this.role="menuitem",this.disabled=!1,this.disableRipple=!1,this._hovered=new Qt,this._focused=new Qt,this._highlighted=!1,this._triggersSubmenu=!1,s?.addItem?.(this)}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._getHostElement(),t,i):this._getHostElement().focus(i),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(t){this.disabled&&(t.preventDefault(),t.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const t=this._elementRef.nativeElement.cloneNode(!0),i=t.querySelectorAll("mat-icon, .material-icons");for(let r=0;r<i.length;r++)i[r].remove();return t.textContent?.trim()||""}_setHighlighted(t){this._highlighted=t,this._changeDetectorRef?.markForCheck()}_setTriggersSubmenu(t){this._triggersSubmenu=t,this._changeDetectorRef?.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(ca),Q(cy),Q(SN,8),Q(Ac))};static#t=this.\u0275cmp=wr({type:n,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-mdc-menu-item","mat-mdc-focus-indicator"],hostVars:8,hostBindings:function(i,r){1&i&&mi("click",function(o){return r._checkDisabled(o)})("mouseenter",function(){return r._handleMouseEnter()}),2&i&&(ja("role",r.role)("tabindex",r._getTabIndex())("aria-disabled",r.disabled)("disabled",r.disabled||null),Ka("mat-mdc-menu-item-highlighted",r._highlighted)("mat-mdc-menu-item-submenu-trigger",r._triggersSubmenu))},inputs:{role:"role",disabled:[2,"disabled","disabled",js],disableRipple:[2,"disableRipple","disableRipple",js]},exportAs:["matMenuItem"],standalone:!0,features:[kl,ah],attrs:Exe,ngContentSelectors:Txe,decls:5,vars:3,consts:[[1,"mat-mdc-menu-item-text"],["matRipple","",1,"mat-mdc-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["viewBox","0 0 5 10","focusable","false","aria-hidden","true",1,"mat-mdc-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(i,r){1&i&&(xd(Sxe),ou(0),Wt(1,"span",0),ou(2,1),un(),Er(3,"div",1),Rs(4,Dxe,2,0,":svg:svg",2)),2&i&&(F(3),jn("matRippleDisabled",r.disableRipple||r.disabled)("matRippleTrigger",r._getHostElement()),F(),U_(r._triggersSubmenu?4:-1))},dependencies:[L0],encapsulation:2,changeDetection:0})}return n})();const Pxe=new Ai("MatMenuContent"),YB={transformMenu:CT("transformMenu",[dy("void",ld({opacity:0,transform:"scale(0.8)"})),U0("void => enter",N0("120ms cubic-bezier(0, 0, 0.2, 1)",ld({opacity:1,transform:"scale(1)"}))),U0("* => void",N0("100ms 25ms linear",ld({opacity:0})))]),fadeInItems:CT("fadeInItems",[dy("showing",ld({opacity:1})),U0("void => *",[ld({opacity:0}),N0("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let Rxe=0;const kxe=new Ai("mat-menu-default-options",{providedIn:"root",factory:function Fxe(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let py=(()=>{class n{get xPosition(){return this._xPosition}set xPosition(t){this._xPosition=t,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(t){this._yPosition=t,this.setPositionClasses()}set panelClass(t){const i=this._previousPanelClass,r={...this._classList};i&&i.length&&i.split(" ").forEach(s=>{r[s]=!1}),this._previousPanelClass=t,t&&t.length&&(t.split(" ").forEach(s=>{r[s]=!0}),this._elementRef.nativeElement.className=""),this._classList=r}get classList(){return this.panelClass}set classList(t){this.panelClass=t}constructor(t,i,r,s){this._elementRef=t,this._changeDetectorRef=s,this._elevationPrefix="mat-elevation-z",this._baseElevation=null,this._directDescendantItems=new Bf,this._classList={},this._panelAnimationState="void",this._animationDone=new Qt,this.closed=new os,this.close=this.closed,this.panelId="mat-menu-panel-"+Rxe++,this._injector=oi(Dr),this.overlayPanelClass=r.overlayPanelClass||"",this._xPosition=r.xPosition,this._yPosition=r.yPosition,this.backdropClass=r.backdropClass,this.overlapTrigger=r.overlapTrigger,this.hasBackdrop=r.hasBackdrop}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new d$(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(Mp(this._directDescendantItems),Ru(t=>Tm(...t.map(i=>i._focused)))).subscribe(t=>this._keyManager.updateActiveItem(t)),this._directDescendantItems.changes.subscribe(t=>{const i=this._keyManager;if("enter"===this._panelAnimationState&&i.activeItem?._hasFocus()){const r=t.toArray(),s=Math.max(0,Math.min(r.length-1,i.activeItemIndex||0));r[s]&&!r[s].disabled?i.setActiveItem(s):i.setNextItemActive()}})}ngOnDestroy(){this._keyManager?.destroy(),this._directDescendantItems.destroy(),this.closed.complete(),this._firstItemFocusRef?.destroy()}_hovered(){return this._directDescendantItems.changes.pipe(Mp(this._directDescendantItems),Ru(i=>Tm(...i.map(r=>r._hovered))))}addItem(t){}removeItem(t){}_handleKeydown(t){const i=t.keyCode,r=this._keyManager;switch(i){case 27:eM(t)||(t.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===i||40===i)&&r.setFocusOrigin("keyboard"),void r.onKeydown(t)}t.stopPropagation()}focusFirstItem(t="program"){this._firstItemFocusRef?.destroy(),this._firstItemFocusRef=AA(()=>{let i=null;if(this._directDescendantItems.length&&(i=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),!i||!i.contains(document.activeElement)){const r=this._keyManager;r.setFocusOrigin(t).setFirstItemActive(),!r.activeItem&&i&&i.focus()}},{injector:this._injector})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(t){if(null===this._baseElevation){const l=("function"==typeof getComputedStyle?getComputedStyle(this._elementRef.nativeElement):null)?.getPropertyValue("--mat-menu-base-elevation-level")||"8";this._baseElevation=parseInt(l)}const i=Math.min(this._baseElevation+t,24),r=`${this._elevationPrefix}${i}`,s=Object.keys(this._classList).find(o=>o.startsWith(this._elevationPrefix));if(!s||s===this._previousElevation){const o={...this._classList};this._previousElevation&&(o[this._previousElevation]=!1),o[r]=!0,this._previousElevation=r,this._classList=o}}setPositionClasses(t=this.xPosition,i=this.yPosition){this._classList={...this._classList,"mat-menu-before":"before"===t,"mat-menu-after":"after"===t,"mat-menu-above":"above"===i,"mat-menu-below":"below"===i},this._changeDetectorRef?.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(t){this._animationDone.next(t),this._isAnimating=!1}_onAnimationStart(t){this._isAnimating=!0,"enter"===t.toState&&0===this._keyManager.activeItemIndex&&(t.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(Mp(this._allItems)).subscribe(t=>{this._directDescendantItems.reset(t.filter(i=>i._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(ns),Q(kxe),Q(Ac))};static#t=this.\u0275cmp=wr({type:n,selectors:[["mat-menu"]],contentQueries:function(i,r,s){if(1&i&&(Cp(s,Pxe,5),Cp(s,fy,5),Cp(s,fy,4)),2&i){let o;ia(o=ra())&&(r.lazyContent=o.first),ia(o=ra())&&(r._allItems=o),ia(o=ra())&&(r.items=o)}},viewQuery:function(i,r){if(1&i&&ul(ni,5),2&i){let s;ia(s=ra())&&(r.templateRef=s.first)}},hostVars:3,hostBindings:function(i,r){2&i&&ja("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},inputs:{backdropClass:"backdropClass",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:[2,"overlapTrigger","overlapTrigger",js],hasBackdrop:[2,"hasBackdrop","hasBackdrop",t=>null==t?null:js(t)],panelClass:[0,"class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"},exportAs:["matMenu"],standalone:!0,features:[Bo([{provide:SN,useExisting:n}]),kl,ah],ngContentSelectors:Ixe,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-mdc-menu-panel","mat-mdc-elevation-specific",3,"keydown","click","id"],[1,"mat-mdc-menu-content"]],template:function(i,r){1&i&&(xd(),Rs(0,Bxe,3,7,"ng-template"))},styles:['mat-menu{display:none}.mat-mdc-menu-content{margin:0;padding:8px 0;outline:0}.mat-mdc-menu-content,.mat-mdc-menu-content .mat-mdc-menu-item .mat-mdc-menu-item-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;flex:1;white-space:normal;font-family:var(--mat-menu-item-label-text-font, var(--mat-app-label-large-font));line-height:var(--mat-menu-item-label-text-line-height, var(--mat-app-label-large-line-height));font-size:var(--mat-menu-item-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mat-menu-item-label-text-tracking, var(--mat-app-label-large-tracking));font-weight:var(--mat-menu-item-label-text-weight, var(--mat-app-label-large-weight))}.mat-mdc-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;box-sizing:border-box;outline:0;border-radius:var(--mat-menu-container-shape, var(--mat-app-corner-extra-small));background-color:var(--mat-menu-container-color, var(--mat-app-surface-container));will-change:transform,opacity}.mat-mdc-menu-panel.ng-animating{pointer-events:none}.mat-mdc-menu-panel.ng-animating:has(.mat-mdc-menu-content:empty){display:none}.cdk-high-contrast-active .mat-mdc-menu-panel{outline:solid 1px}.mat-mdc-menu-panel .mat-divider{color:var(--mat-menu-divider-color, var(--mat-app-surface-variant));margin-bottom:var(--mat-menu-divider-bottom-spacing);margin-top:var(--mat-menu-divider-top-spacing)}.mat-mdc-menu-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:var(--mat-menu-item-leading-spacing);padding-right:var(--mat-menu-item-trailing-spacing);-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer;width:100%;text-align:left;box-sizing:border-box;color:inherit;font-size:inherit;background:none;text-decoration:none;margin:0;min-height:48px}[dir=rtl] .mat-mdc-menu-item{padding-right:var(--mat-menu-item-leading-spacing);padding-left:var(--mat-menu-item-trailing-spacing)}.mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]){padding-left:var(--mat-menu-item-with-icon-leading-spacing);padding-right:var(--mat-menu-item-with-icon-trailing-spacing)}[dir=rtl] .mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]){padding-right:var(--mat-menu-item-with-icon-leading-spacing);padding-left:var(--mat-menu-item-with-icon-trailing-spacing)}.mat-mdc-menu-item::-moz-focus-inner{border:0}.mat-mdc-menu-item,.mat-mdc-menu-item:visited,.mat-mdc-menu-item:link{color:var(--mat-menu-item-label-text-color, var(--mat-app-on-surface))}.mat-mdc-menu-item .mat-icon-no-color,.mat-mdc-menu-item .mat-mdc-menu-submenu-icon{color:var(--mat-menu-item-icon-color, var(--mat-app-on-surface-variant))}.mat-mdc-menu-item[disabled]{cursor:default;opacity:.38}.mat-mdc-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.mat-mdc-menu-item:focus{outline:0}.mat-mdc-menu-item .mat-icon{flex-shrink:0;margin-right:var(--mat-menu-item-spacing);height:var(--mat-menu-item-icon-size);width:var(--mat-menu-item-icon-size)}[dir=rtl] .mat-mdc-menu-item{text-align:right}[dir=rtl] .mat-mdc-menu-item .mat-icon{margin-right:0;margin-left:var(--mat-menu-item-spacing)}.mat-mdc-menu-item:not([disabled]):hover{background-color:var(--mat-menu-item-hover-state-layer-color)}.mat-mdc-menu-item:not([disabled]).cdk-program-focused,.mat-mdc-menu-item:not([disabled]).cdk-keyboard-focused,.mat-mdc-menu-item:not([disabled]).mat-mdc-menu-item-highlighted{background-color:var(--mat-menu-item-focus-state-layer-color)}.cdk-high-contrast-active .mat-mdc-menu-item{margin-top:1px}.mat-mdc-menu-submenu-icon{width:var(--mat-menu-item-icon-size);height:10px;fill:currentColor;padding-left:var(--mat-menu-item-spacing)}[dir=rtl] .mat-mdc-menu-submenu-icon{padding-right:var(--mat-menu-item-spacing);padding-left:0}[dir=rtl] .mat-mdc-menu-submenu-icon polygon{transform:scaleX(-1);transform-origin:center}.cdk-high-contrast-active .mat-mdc-menu-submenu-icon{fill:CanvasText}.mat-mdc-menu-item .mat-mdc-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}'],encapsulation:2,data:{animation:[YB.transformMenu,YB.fadeInItems]},changeDetection:0})}return n})();const tX=new Ai("mat-menu-scroll-strategy",{providedIn:"root",factory:()=>{const n=oi(fu);return()=>n.scrollStrategies.reposition()}}),Lxe={provide:tX,deps:[fu],useFactory:function Oxe(n){return()=>n.scrollStrategies.reposition()}},nX=zg({passive:!0});let iM=(()=>{class n{get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(t){this.menu=t}get menu(){return this._menu}set menu(t){t!==this._menu&&(this._menu=t,this._menuCloseSubscription.unsubscribe(),t&&(this._menuCloseSubscription=t.close.subscribe(i=>{this._destroyMenu(i),("click"===i||"tab"===i)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(i)})),this._menuItemInstance?._setTriggersSubmenu(this.triggersSubmenu()))}constructor(t,i,r,s,o,l,h,u,f){this._overlay=t,this._element=i,this._viewContainerRef=r,this._menuItemInstance=l,this._dir=h,this._focusMonitor=u,this._ngZone=f,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=pt.EMPTY,this._hoverSubscription=pt.EMPTY,this._menuCloseSubscription=pt.EMPTY,this._changeDetectorRef=oi(Ac),this._handleTouchStart=y=>{LB(y)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new os,this.onMenuOpen=this.menuOpened,this.menuClosed=new os,this.onMenuClose=this.menuClosed,this._scrollStrategy=s,this._parentMaterialMenu=o instanceof py?o:void 0,i.nativeElement.addEventListener("touchstart",this._handleTouchStart,nX)}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,nX),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!!(this._menuItemInstance&&this._parentMaterialMenu&&this.menu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){const t=this.menu;if(this._menuOpen||!t)return;const i=this._createOverlay(t),r=i.getConfig(),s=r.positionStrategy;this._setPosition(t,s),r.hasBackdrop=null==t.hasBackdrop?!this.triggersSubmenu():t.hasBackdrop,i.attach(this._getPortal(t)),t.lazyContent&&t.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(t),t instanceof py&&(t._startAnimation(),t._directDescendantItems.changes.pipe(fl(t.close)).subscribe(()=>{s.withLockedPosition(!1).reapplyLastPosition(),s.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._element,t,i):this._element.nativeElement.focus(i)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(t){if(!this._overlayRef||!this.menuOpen)return;const i=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===t||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,i instanceof py?(i._resetAnimation(),i.lazyContent?i._animationDone.pipe(Nc(r=>"void"===r.toState),lh(1),fl(i.lazyContent._attached)).subscribe({next:()=>i.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),i?.lazyContent?.detach())}_initMenu(t){t.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,t.direction=this.dir,this._setMenuElevation(t),t.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(t){if(t.setElevation){let i=0,r=t.parentMenu;for(;r;)i++,r=r.parentMenu;t.setElevation(i)}}_setIsMenuOpen(t){t!==this._menuOpen&&(this._menuOpen=t,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(t),this._changeDetectorRef.markForCheck())}_createOverlay(t){if(!this._overlayRef){const i=this._getOverlayConfig(t);this._subscribeToPositions(t,i.positionStrategy),this._overlayRef=this._overlay.create(i),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(t){return new EN({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:t.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:t.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(t,i){t.setPositionClasses&&i.positionChanges.subscribe(r=>{const s="start"===r.connectionPair.overlayX?"after":"before",o="top"===r.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>t.setPositionClasses(s,o)):t.setPositionClasses(s,o)})}_setPosition(t,i){let[r,s]="before"===t.xPosition?["end","start"]:["start","end"],[o,l]="above"===t.yPosition?["bottom","top"]:["top","bottom"],[h,u]=[o,l],[f,y]=[r,s],T=0;if(this.triggersSubmenu()){if(y=r="before"===t.xPosition?"start":"end",s=f="end"===r?"start":"end",this._parentMaterialMenu){if(null==this._parentInnerPadding){const B=this._parentMaterialMenu.items.first;this._parentInnerPadding=B?B._getHostElement().offsetTop:0}T="bottom"===o?this._parentInnerPadding:-this._parentInnerPadding}}else t.overlapTrigger||(h="top"===o?"bottom":"top",u="top"===l?"bottom":"top");i.withPositions([{originX:r,originY:h,overlayX:f,overlayY:o,offsetY:T},{originX:s,originY:h,overlayX:y,overlayY:o,offsetY:T},{originX:r,originY:u,overlayX:f,overlayY:l,offsetY:-T},{originX:s,originY:u,overlayX:y,overlayY:l,offsetY:-T}])}_menuClosingActions(){const t=this._overlayRef.backdropClick(),i=this._overlayRef.detachments();return Tm(t,this._parentMaterialMenu?this._parentMaterialMenu.closed:ds(),this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(Nc(o=>o!==this._menuItemInstance),Nc(()=>this._menuOpen)):ds(),i)}_handleMousedown(t){OB(t)||(this._openedBy=0===t.button?"mouse":void 0,this.triggersSubmenu()&&t.preventDefault())}_handleKeydown(t){const i=t.keyCode;(13===i||32===i)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===i&&"ltr"===this.dir||37===i&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(t){this.triggersSubmenu()?(t.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(Nc(t=>t===this._menuItemInstance&&!t.disabled),M$(0,gN)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof py&&this.menu._isAnimating?this.menu._animationDone.pipe(lh(1),M$(0,gN),fl(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(t){return(!this._portal||this._portal.templateRef!==t.templateRef)&&(this._portal=new wT(t.templateRef,this._viewContainerRef)),this._portal}static#e=this.\u0275fac=function(i){return new(i||n)(Q(fu),Q(ro),Q(Fh),Q(tX),Q(SN,8),Q(fy,10),Q(Rp,8),Q(cy),Q(ns))};static#t=this.\u0275dir=mr({type:n,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-mdc-menu-trigger"],hostVars:3,hostBindings:function(i,r){1&i&&mi("click",function(o){return r._handleClick(o)})("mousedown",function(o){return r._handleMousedown(o)})("keydown",function(o){return r._handleKeydown(o)}),2&i&&ja("aria-haspopup",r.menu?"menu":null)("aria-expanded",r.menuOpen)("aria-controls",r.menuOpen?r.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:[0,"mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:[0,"matMenuTriggerFor","menu"],menuData:[0,"matMenuTriggerData","menuData"],restoreFocus:[0,"matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"},exportAs:["matMenuTrigger"],standalone:!0})}return n})(),Nxe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({providers:[Lxe],imports:[rS,qB,zh,DT,TT,zh]})}return n})();const Uxe=["tooltip"],rX=new Ai("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{const n=oi(fu);return()=>n.scrollStrategies.reposition({scrollThrottle:20})}}),Hxe={provide:rX,deps:[fu],useFactory:function zxe(n){return()=>n.scrollStrategies.reposition({scrollThrottle:20})}},Gxe=new Ai("mat-tooltip-default-options",{providedIn:"root",factory:function Vxe(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}}),sX="tooltip-panel",oX=zg({passive:!0});let my=(()=>{class n{get position(){return this._position}set position(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(t){this._positionAtOrigin=r$(t),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(t){const i=r$(t);this._disabled!==i&&(this._disabled=i,i?this.hide(0):this._setupPointerEnterEventsIfNeeded(),this._syncAriaDescription(this.message))}get showDelay(){return this._showDelay}set showDelay(t){this._showDelay=Cx(t)}get hideDelay(){return this._hideDelay}set hideDelay(t){this._hideDelay=Cx(t),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(t){const i=this._message;this._message=null!=t?String(t).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage()),this._syncAriaDescription(i)}get tooltipClass(){return this._tooltipClass}set tooltipClass(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}constructor(t,i,r,s,o,l,h,u,f,y,T,B){this._overlay=t,this._elementRef=i,this._scrollDispatcher=r,this._viewContainerRef=s,this._ngZone=o,this._platform=l,this._ariaDescriber=h,this._focusMonitor=u,this._dir=y,this._defaultOptions=T,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._tooltipComponent=$xe,this._viewportMargin=8,this._cssClassPrefix="mat-mdc",this.touchGestures="auto",this._message="",this._passiveListeners=[],this._touchstartTimeout=null,this._destroyed=new Qt,this._injector=oi(Dr),this._scrollStrategy=f,this._document=B,T&&(this._showDelay=T.showDelay,this._hideDelay=T.hideDelay,T.position&&(this.position=T.position),T.positionAtOrigin&&(this.positionAtOrigin=T.positionAtOrigin),T.touchGestures&&(this.touchGestures=T.touchGestures),T.tooltipClass&&(this.tooltipClass=T.tooltipClass)),y.change.pipe(fl(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)}),this._viewportMargin=8}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(fl(this._destroyed)).subscribe(t=>{t?"keyboard"===t&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const t=this._elementRef.nativeElement;this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([i,r])=>{t.removeEventListener(i,r,oX)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(t,this.message,"tooltip"),this._focusMonitor.stopMonitoring(t)}show(t=this.showDelay,i){if(this.disabled||!this.message||this._isTooltipVisible())return void this._tooltipInstance?._cancelPendingAnimations();const r=this._createOverlay(i);this._detach(),this._portal=this._portal||new hy(this._tooltipComponent,this._viewContainerRef);const s=this._tooltipInstance=r.attach(this._portal).instance;s._triggerElement=this._elementRef.nativeElement,s._mouseLeaveHideDelay=this._hideDelay,s.afterHidden().pipe(fl(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),s.show(t)}hide(t=this.hideDelay){const i=this._tooltipInstance;i&&(i.isVisible()?i.hide(t):(i._cancelPendingAnimations(),this._detach()))}toggle(t){this._isTooltipVisible()?this.hide():this.show(void 0,t)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(t){if(this._overlayRef){const s=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!t)&&s._origin instanceof ro)return this._overlayRef;this._detach()}const i=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),r=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin&&t||this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(i);return r.positionChanges.pipe(fl(this._destroyed)).subscribe(s=>{this._updateCurrentPositionClass(s.connectionPair),this._tooltipInstance&&s.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:r,panelClass:`${this._cssClassPrefix}-${sX}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(fl(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(fl(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(fl(this._destroyed)).subscribe(s=>{this._isTooltipVisible()&&27===s.keyCode&&!eM(s)&&(s.preventDefault(),s.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(t){const i=t.getConfig().positionStrategy,r=this._getOrigin(),s=this._getOverlayPosition();i.withPositions([this._addOffset({...r.main,...s.main}),this._addOffset({...r.fallback,...s.fallback})])}_addOffset(t){const r=!this._dir||"ltr"==this._dir.value;return"top"===t.originY?t.offsetY=-8:"bottom"===t.originY?t.offsetY=8:"start"===t.originX?t.offsetX=r?-8:8:"end"===t.originX&&(t.offsetX=r?8:-8),t}_getOrigin(){const t=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i||"below"==i?r={originX:"center",originY:"above"==i?"top":"bottom"}:"before"==i||"left"==i&&t||"right"==i&&!t?r={originX:"start",originY:"center"}:("after"==i||"right"==i&&t||"left"==i&&!t)&&(r={originX:"end",originY:"center"});const{x:s,y:o}=this._invertPosition(r.originX,r.originY);return{main:r,fallback:{originX:s,originY:o}}}_getOverlayPosition(){const t=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i?r={overlayX:"center",overlayY:"bottom"}:"below"==i?r={overlayX:"center",overlayY:"top"}:"before"==i||"left"==i&&t||"right"==i&&!t?r={overlayX:"end",overlayY:"center"}:("after"==i||"right"==i&&t||"left"==i&&!t)&&(r={overlayX:"start",overlayY:"center"});const{x:s,y:o}=this._invertPosition(r.overlayX,r.overlayY);return{main:r,fallback:{overlayX:s,overlayY:o}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),AA(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}_invertPosition(t,i){return"above"===this.position||"below"===this.position?"top"===i?i="bottom":"bottom"===i&&(i="top"):"end"===t?t="start":"start"===t&&(t="end"),{x:t,y:i}}_updateCurrentPositionClass(t){const{overlayY:i,originX:r,originY:s}=t;let o;if(o="center"===i?this._dir&&"rtl"===this._dir.value?"end"===r?"left":"right":"start"===r?"left":"right":"bottom"===i&&"top"===s?"above":"below",o!==this._currentPosition){const l=this._overlayRef;if(l){const h=`${this._cssClassPrefix}-${sX}-`;l.removePanelClass(h+this._currentPosition),l.addPanelClass(h+o)}this._currentPosition=o}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",t=>{let i;this._setupPointerExitEventsIfNeeded(),void 0!==t.x&&void 0!==t.y&&(i=t),this.show(void 0,i)}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",t=>{const i=t.targetTouches?.[0],r=i?{x:i.clientX,y:i.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>{this._touchstartTimeout=null,this.show(void 0,r)},this._defaultOptions.touchLongPressShowDelay??500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const t=[];if(this._platformSupportsMouseEvents())t.push(["mouseleave",i=>{const r=i.relatedTarget;(!r||!this._overlayRef?.overlayElement.contains(r))&&this.hide()}],["wheel",i=>this._wheelListener(i)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const i=()=>{this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};t.push(["touchend",i],["touchcancel",i])}this._addListeners(t),this._passiveListeners.push(...t)}_addListeners(t){t.forEach(([i,r])=>{this._elementRef.nativeElement.addEventListener(i,r,oX)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(t){if(this._isTooltipVisible()){const i=this._document.elementFromPoint(t.clientX,t.clientY),r=this._elementRef.nativeElement;i!==r&&!r.contains(i)&&this.hide()}}_disableNativeGesturesIfNecessary(){const t=this.touchGestures;if("off"!==t){const i=this._elementRef.nativeElement,r=i.style;("on"===t||"INPUT"!==i.nodeName&&"TEXTAREA"!==i.nodeName)&&(r.userSelect=r.msUserSelect=r.webkitUserSelect=r.MozUserSelect="none"),("on"===t||!i.draggable)&&(r.webkitUserDrag="none"),r.touchAction="none",r.webkitTapHighlightColor="transparent"}}_syncAriaDescription(t){this._ariaDescriptionPending||(this._ariaDescriptionPending=!0,this._ariaDescriber.removeDescription(this._elementRef.nativeElement,t,"tooltip"),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriptionPending=!1,this.message&&!this.disabled&&this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}static#e=this.\u0275fac=function(i){return new(i||n)(Q(fu),Q(ro),Q(WB),Q(Fh),Q(ns),Q(uh),Q(Yve),Q(cy),Q(rX),Q(Rp),Q(Gxe,8),Q(ca))};static#t=this.\u0275dir=mr({type:n,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(i,r){2&i&&Ka("mat-mdc-tooltip-disabled",r.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"],standalone:!0})}return n})(),$xe=(()=>{class n{constructor(t,i,r){this._changeDetectorRef=t,this._elementRef=i,this._isMultiline=!1,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new Qt,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide",this._animationsDisabled="NoopAnimations"===r}show(t){null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},t)}hide(t){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},t)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:t}){(!t||!this._triggerElement.contains(t))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){const t=this._elementRef.nativeElement.getBoundingClientRect();return t.height>24&&t.width>=200}_handleAnimationEnd({animationName:t}){(t===this._showAnimation||t===this._hideAnimation)&&this._finalizeAnimation(t===this._showAnimation)}_cancelPendingAnimations(){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(t){t?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(t){const i=this._tooltip.nativeElement,r=this._showAnimation,s=this._hideAnimation;if(i.classList.remove(t?s:r),i.classList.add(t?r:s),this._isVisible!==t&&(this._isVisible=t,this._changeDetectorRef.markForCheck()),t&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const o=getComputedStyle(i);("0s"===o.getPropertyValue("animation-duration")||"none"===o.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}t&&this._onShow(),this._animationsDisabled&&(i.classList.add("_mat-animation-noopable"),this._finalizeAnimation(t))}static#e=this.\u0275fac=function(i){return new(i||n)(Q(Ac),Q(ro),Q(gh,8))};static#t=this.\u0275cmp=wr({type:n,selectors:[["mat-tooltip-component"]],viewQuery:function(i,r){if(1&i&&ul(Uxe,7),2&i){let s;ia(s=ra())&&(r._tooltip=s.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(i,r){1&i&&mi("mouseleave",function(o){return r._handleMouseLeave(o)}),2&i&&UE("zoom",r.isVisible()?1:null)},standalone:!0,features:[ah],decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mat-mdc-tooltip-surface","mdc-tooltip__surface"]],template:function(i,r){if(1&i){const s=zo();Wt(0,"div",1,0),mi("animationend",function(l){return pi(s),fi(r._handleAnimationEnd(l))}),Wt(2,"div",2),ki(3),un()()}2&i&&(Ka("mdc-tooltip--multiline",r._isMultiline),jn("ngClass",r.tooltipClass),F(3),_A(r.message))},dependencies:[Mg],styles:['.mat-mdc-tooltip{position:relative;transform:scale(0);display:inline-flex}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-surface{word-break:normal;overflow-wrap:anywhere;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center;will-change:transform,opacity;background-color:var(--mdc-plain-tooltip-container-color, var(--mat-app-inverse-surface));color:var(--mdc-plain-tooltip-supporting-text-color, var(--mat-app-inverse-on-surface));border-radius:var(--mdc-plain-tooltip-container-shape, var(--mat-app-corner-extra-small));font-family:var(--mdc-plain-tooltip-supporting-text-font, var(--mat-app-body-small-font));font-size:var(--mdc-plain-tooltip-supporting-text-size, var(--mat-app-body-small-size));font-weight:var(--mdc-plain-tooltip-supporting-text-weight, var(--mat-app-body-small-weight));line-height:var(--mdc-plain-tooltip-supporting-text-line-height, var(--mat-app-body-small-line-height));letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking, var(--mat-app-body-small-tracking))}.mat-mdc-tooltip-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:right}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0})}return n})(),Xxe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({providers:[Hxe],imports:[x$,rS,DT,zh,zh,TT]})}return n})();const Yxe=n=>({disabled:n}),Kxe=n=>({"active-icon":n});let Hc=(()=>{class n{icon;active;tooltip;disabled=!1;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=wr({type:n,selectors:[["app-menu-toggle"]],inputs:{icon:"icon",active:"active",tooltip:"tooltip",disabled:"disabled"},decls:3,vars:10,consts:[["matTooltipPosition","above","matTooltipTouchGestures","off",1,"menu-toggle",3,"ngClass","matTooltip"],[1,"menu-toggle-icon",3,"ngClass"]],template:function(i,r){1&i&&(Wt(0,"button",0),Fr(),Wt(1,"svg",1),Er(2,"use"),un()()),2&i&&(jn("ngClass",jd(6,Yxe,r.disabled))("matTooltip",r.tooltip),F(),jn("ngClass",jd(8,Kxe,r.active)),F(),x2("href","assets/icons/",r.icon,".svg#",r.icon,""))},dependencies:[Mg,my],styles:["[_nghost-%COMP%]{display:flex;margin:0 .6rem}[_nghost-%COMP%]   .menu-toggle[_ngcontent-%COMP%]{display:flex;background:unset;border:none;height:2.5rem;width:2.5rem;min-height:2.5rem;min-width:2.5rem;padding:.65rem;cursor:pointer;align-self:center;transition:all .4s}[_nghost-%COMP%]   .menu-toggle-icon[_ngcontent-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   .menu-toggle-icon.active-icon[_ngcontent-%COMP%]{--phoenix-options-icon-path: #00bcd4}[_nghost-%COMP%]   .menu-toggle[_ngcontent-%COMP%]:hover{background-color:var(--phoenix-options-icon-bg);border-radius:40%;transition:all .4s}[_nghost-%COMP%]   .menu-toggle.disabled[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.4}"]})}return n})();function Zxe(n,e){if(1&n){const t=zo();Wt(0,"button",2),mi("click",function(){const r=pi(t).$implicit;return fi(pr().animatePreset(r))}),ki(1),un()}if(2&n){const t=e.$implicit;F(),dl(" ",t," ")}}const aX={"Cavern to ID":{name:"Cavern to ID",positions:[{position:[66388.95051168812,5264.228603228927,-46910.7848593543],duration:1e3},{position:[12834.18729094943,677.7571205763458,135.68755273443463],duration:2e3},{position:[312.02688693297375,25.884223757326,270.10019006776236],duration:3500},{position:[263.3640855132258,19.874838262525053,-318.16541790248885],duration:3e3},{position:[5534.140362338047,234.03507981484574,-2933.619479808285],duration:2e3},{position:[2681.277288705242,646.5795158318147,5628.5248735111745],duration:1e3},{position:[-6062.586283740076,790.5876682946184,1381.1675900848818],duration:1e3},{position:[-1766.7693725879053,1007.1048030984678,-5928.901341784575],duration:1e3},{position:[12814.982506255355,2516.987185037266,-22891.902734328327],duration:1e3}],animateEventAfterInterval:5e3,collisionDuration:6e3}};let TN=(()=>{class n{eventDisplay;animationPresets=aX;animationPresetsKeys=Object.keys(this.animationPresets);isAnimating=!1;constructor(t){this.eventDisplay=t}animatePreset(t){this.setDetectorOpacity(.2),this.eventDisplay.animatePreset(this.animationPresets[t],()=>{this.setDetectorOpacity(1)})}animateCamera(){this.isAnimating||(this.isAnimating=!0,this.eventDisplay.animateThroughEvent([11976,7262,11927],3e3,()=>{this.isAnimating=!1}))}setDetectorOpacity(t){const i=this.eventDisplay.getThreeManager().getSceneManager(),r=i.getObjectByName(el.GEOMETRIES_ID);i.setGeometryOpacity(r,t)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-animate-camera"]],inputs:{animationPresets:"animationPresets"},decls:6,vars:2,consts:[["animationPresets",""],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"],["tooltip","Preset animations","icon","animate-camera",3,"matMenuTriggerFor"]],template:function(i,r){if(1&i){const s=zo();Wt(0,"mat-menu",null,0),Rs(2,Zxe,2,1,"button",1),Wt(3,"button",2),mi("click",function(){return pi(s),fi(r.animateCamera())}),ki(4,"Animate camera"),un()(),Er(5,"app-menu-toggle",3)}if(2&i){const s=Ha(1);F(2),jn("ngForOf",r.animationPresetsKeys),F(3),jn("matMenuTriggerFor",s)}},dependencies:[pm,py,fy,iM,Hc]})}return n})();const Jxe=["*"],ewe=n=>({"ui-menu-hidden":n});let DN=(()=>{class n{hideUIMenu=!1;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=wr({type:n,selectors:[["app-ui-menu-wrapper"]],ngContentSelectors:Jxe,decls:6,vars:5,consts:[["id","uiMenu"],["id","hideUIMenu","matTooltipPosition","above",3,"click","matTooltip","ngClass"],["href","assets/icons/expand.svg#expand"],["id","optionsPanel",3,"hidden"]],template:function(i,r){1&i&&(xd(),Wt(0,"div",0)(1,"button",1),mi("click",function(){return r.hideUIMenu=!r.hideUIMenu}),Fr(),Wt(2,"svg"),Er(3,"use",2),un()(),vo(),Wt(4,"div",3),ou(5),un()()),2&i&&(F(),jn("matTooltip",r.hideUIMenu?"Show toolbar":"Hide toolbar")("ngClass",jd(3,ewe,r.hideUIMenu)),F(3),jn("hidden",r.hideUIMenu))},dependencies:[Mg,my],styles:["#uiMenu[_ngcontent-%COMP%]{position:absolute;bottom:1rem;width:100%;box-sizing:border-box;display:flex;flex-direction:column;align-items:center}#optionsPanel[_ngcontent-%COMP%]{display:flex;align-items:center;background:var(--phoenix-background-color-secondary);border:1px solid var(--phoenix-background-color-tertiary);box-shadow:var(--phoenix-box-shadow);border-radius:30px;max-width:95%;padding:.3rem 1rem;overflow-x:scroll;z-index:90}#hideUIMenu[_ngcontent-%COMP%]{background:var(--phoenix-background-color-secondary);height:1.2rem;width:3rem;border:1px solid var(--phoenix-border);border-bottom:none;box-shadow:var(--phoenix-box-shadow);border-top-left-radius:15px;border-top-right-radius:15px;padding:3px}#hideUIMenu[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:100%;width:100%;vertical-align:top;transition:all .3s}#hideUIMenu.ui-menu-hidden[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transform:scaleY(-1);transition:all .3s}"]})}return n})();let cX=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(i){return new(i||n)(Q(L_),Q(ro))};static#t=this.\u0275dir=mr({type:n})}return n})(),Dx=(()=>{class n extends cX{static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=yt(n)))(r||n)}})();static#t=this.\u0275dir=mr({type:n,features:[Fo]})}return n})();const Wf=new Ai(""),nwe={provide:Wf,useExisting:Ma(()=>KB),multi:!0},rwe=new Ai("");let KB=(()=>{class n extends cX{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function iwe(){const n=O1()?O1().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Q(L_),Q(ro),Q(rwe,8))};static#t=this.\u0275dir=mr({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&mi("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[Bo([nwe]),Fo]})}return n})();const pu=new Ai(""),fv=new Ai("");function vX(n){return null!=n}function bX(n){return KE(n)?cu(n):n}function xX(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function wX(n,e){return e.map(t=>t(n))}function CX(n){return n.map(e=>function owe(n){return!n.validate}(e)?e:t=>e.validate(t))}function IN(n){return null!=n?function MX(n){if(!n)return null;const e=n.filter(vX);return 0==e.length?null:function(t){return xX(wX(t,e))}}(CX(n)):null}function EX(n){if(!n)return null;const e=n.filter(vX);return 0==e.length?null:function(t){return function lX(...n){const e=nV(n),{args:t,keys:i}=VV(n),r=new Be(s=>{const{length:o}=t;if(!o)return void s.complete();const l=new Array(o);let h=o,u=o;for(let f=0;f<o;f++){let y=!1;$d(t[f]).subscribe(ai(s,T=>{y||(y=!0,u--),l[f]=T},()=>h--,void 0,()=>{(!h||!y)&&(u||s.next(i?GV(i,l):l),s.complete())}))}});return e?r.pipe(TF(e)):r}(wX(t,e).map(bX)).pipe(kn(xX))}}function BN(n){return null!=n?EX(CX(n)):null}function SX(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function PN(n){return n?Array.isArray(n)?n:[n]:[]}function JB(n,e){return Array.isArray(n)?n.includes(e):n===e}function IX(n,e){const t=PN(e);return PN(n).forEach(r=>{JB(t,r)||t.push(r)}),t}function BX(n,e){return PN(e).filter(t=>!JB(n,t))}class PX{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=IN(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=BN(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class $f extends PX{get formDirective(){return null}get path(){return null}}class pv extends PX{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class RX{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}}let eP=(()=>{class n extends RX{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Q(pv,2))};static#t=this.\u0275dir=mr({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&Ka("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Fo]})}return n})();const IT="VALID",nP="INVALID",rM="PENDING",BT="DISABLED";class sM{}class FX extends sM{constructor(e,t){super(),this.value=e,this.source=t}}class FN extends sM{constructor(e,t){super(),this.pristine=e,this.source=t}}class ON extends sM{constructor(e,t){super(),this.touched=e,this.source=t}}class iP extends sM{constructor(e,t){super(),this.status=e,this.source=t}}function rP(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class UN{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=nS(()=>this.statusReactive()),this.statusReactive=N_(void 0),this._pristine=nS(()=>this.pristineReactive()),this.pristineReactive=N_(!0),this._touched=nS(()=>this.touchedReactive()),this.touchedReactive=N_(!1),this._events=new Qt,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return wg(this.statusReactive)}set status(e){wg(()=>this.statusReactive.set(e))}get valid(){return this.status===IT}get invalid(){return this.status===nP}get pending(){return this.status==rM}get disabled(){return this.status===BT}get enabled(){return this.status!==BT}get pristine(){return wg(this.pristineReactive)}set pristine(e){wg(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return wg(this.touchedReactive)}set touched(e){wg(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(IX(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(IX(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(BX(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(BX(e,this._rawAsyncValidators))}hasValidator(e){return JB(this._rawValidators,e)}hasAsyncValidator(e){return JB(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){const t=!1===this.touched;this.touched=!0;const i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched({...e,sourceControl:i}),t&&!1!==e.emitEvent&&this._events.next(new ON(!0,i))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){const t=!0===this.touched;this.touched=!1,this._pendingTouched=!1;const i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&!1!==e.emitEvent&&this._events.next(new ON(!1,i))}markAsDirty(e={}){const t=!0===this.pristine;this.pristine=!1;const i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty({...e,sourceControl:i}),t&&!1!==e.emitEvent&&this._events.next(new FN(!1,i))}markAsPristine(e={}){const t=!1===this.pristine;this.pristine=!0,this._pendingDirty=!1;const i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&!1!==e.emitEvent&&this._events.next(new FN(!0,i))}markAsPending(e={}){this.status=rM;const t=e.sourceControl??this;!1!==e.emitEvent&&(this._events.next(new iP(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending({...e,sourceControl:t})}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=BT,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue();const i=e.sourceControl??this;!1!==e.emitEvent&&(this._events.next(new FX(this.value,i)),this._events.next(new iP(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t},this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=IT,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t},this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){const i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===IT||this.status===rM)&&this._runAsyncValidator(i,e.emitEvent)}const t=e.sourceControl??this;!1!==e.emitEvent&&(this._events.next(new FX(this.value,t)),this._events.next(new iP(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity({...e,sourceControl:t})}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?BT:IT}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=rM,this._hasOwnPendingAsyncValidator={emitEvent:!1!==t};const i=bX(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();const e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent,this,t.shouldHaveEmitted)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new iP(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new os,this.statusChanges=new os}_calculateStatus(){return this._allControlsDisabled()?BT:this.errors?nP:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(rM)?rM:this._anyControlsHaveStatus(nP)?nP:IT}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){const i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new FN(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new ON(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){rP(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function pwe(n){return Array.isArray(n)?IN(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function mwe(n){return Array.isArray(n)?BN(n):n||null}(this._rawAsyncValidators)}}const Ix=new Ai("CallSetDisabledState",{providedIn:"root",factory:()=>PT}),PT="always";function RT(n,e,t=PT){(function HN(n,e){const t=function TX(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(SX(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function DX(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(SX(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();aP(e._rawValidators,r),aP(e._rawAsyncValidators,r)})(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function _we(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&NX(n,e)})}(n,e),function vwe(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function ywe(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&NX(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function gwe(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function aP(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function NX(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function HX(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function VX(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}Promise.resolve();const GX=class extends UN{constructor(e=null,t,i){super(function LN(n){return(rP(n)?n.validators:n)||null}(t),function NN(n,e){return(rP(e)?e.asyncValidators:n)||null}(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),rP(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=VX(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){HX(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){HX(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){VX(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},Twe={provide:pv,useExisting:Ma(()=>FT)},jX=Promise.resolve();let FT=(()=>{class n extends pv{constructor(t,i,r,s,o,l){super(),this._changeDetectorRef=o,this.callSetDisabledState=l,this.control=new GX,this._registered=!1,this.name="",this.update=new os,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function qN(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===KB?t=s:function wwe(n){return Object.getPrototypeOf(n.constructor)===Dx}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function GN(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){RT(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){jX.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&js(i);jX.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function sP(n,e){return[...e.path,n]}(t,this._parent):[t]}static#e=this.\u0275fac=function(i){return new(i||n)(Q($f,9),Q(pu,10),Q(fv,10),Q(Wf,10),Q(Ac,8),Q(Ix,8))};static#t=this.\u0275dir=mr({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Bo([Twe]),Fo,dc]})}return n})();const Iwe={provide:Wf,useExisting:Ma(()=>jN),multi:!0};let jN=(()=>{class n extends Dx{writeValue(t){this.setProperty("value",t??"")}registerOnChange(t){this.onChange=i=>{t(""==i?null:parseFloat(i))}}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=yt(n)))(r||n)}})();static#t=this.\u0275dir=mr({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,r){1&i&&mi("input",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},features:[Bo([Iwe]),Fo]})}return n})();const WN=new Ai(""),Uwe={provide:Wf,useExisting:Ma(()=>KN),multi:!0};function ZX(n,e){return null==n?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let KN=(()=>{class n extends Dx{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const r=ZX(this._getOptionId(t),t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){const i=function zwe(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i):t}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=yt(n)))(r||n)}})();static#t=this.\u0275dir=mr({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){1&i&&mi("change",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Bo([Uwe]),Fo]})}return n})(),oM=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(ZX(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(L_),Q(KN,9))};static#t=this.\u0275dir=mr({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return n})();const Hwe={provide:Wf,useExisting:Ma(()=>ZN),multi:!0};function JX(n,e){return null==n?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let ZN=(()=>{class n extends Dx{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let i;if(this.value=t,Array.isArray(t)){const r=t.map(s=>this._getOptionId(s));i=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{const r=[],s=i.selectedOptions;if(void 0!==s){const o=s;for(let l=0;l<o.length;l++){const u=this._getOptionValue(o[l].value);r.push(u)}}else{const o=i.options;for(let l=0;l<o.length;l++){const h=o[l];if(h.selected){const u=this._getOptionValue(h.value);r.push(u)}}}this.value=r,t(r)}}_registerOption(t){const i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){const i=function Vwe(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=yt(n)))(r||n)}})();static#t=this.\u0275dir=mr({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){1&i&&mi("change",function(o){return r.onChange(o.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Bo([Hwe]),Fo]})}return n})(),aM=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(JX(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(JX(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(L_),Q(ZN,9))};static#t=this.\u0275dir=mr({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return n})(),lY=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({})}return n})(),Zwe=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Ix,useValue:t.callSetDisabledState??PT}]}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({imports:[lY]})}return n})(),Jwe=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:WN,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Ix,useValue:t.callSetDisabledState??PT}]}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({imports:[lY]})}return n})();const e2e=["input"],t2e=["label"],n2e=["*"],i2e=new Ai("mat-checkbox-default-options",{providedIn:"root",factory:cY});function cY(){return{color:"accent",clickAction:"check-indeterminate",disabledInteractive:!1}}var tf=function(n){return n[n.Init=0]="Init",n[n.Checked=1]="Checked",n[n.Unchecked=2]="Unchecked",n[n.Indeterminate=3]="Indeterminate",n}(tf||{});const r2e={provide:Wf,useExisting:Ma(()=>mv),multi:!0};class s2e{}let o2e=0;const hY=cY();let mv=(()=>{class n{focus(){this._inputElement.nativeElement.focus()}_createChangeEvent(t){const i=new s2e;return i.source=this,i.checked=t,i}_getAnimationTargetElement(){return this._inputElement?.nativeElement}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(t,i,r,s,o,l){this._elementRef=t,this._changeDetectorRef=i,this._ngZone=r,this._animationMode=o,this._options=l,this._animationClasses={uncheckedToChecked:"mdc-checkbox--anim-unchecked-checked",uncheckedToIndeterminate:"mdc-checkbox--anim-unchecked-indeterminate",checkedToUnchecked:"mdc-checkbox--anim-checked-unchecked",checkedToIndeterminate:"mdc-checkbox--anim-checked-indeterminate",indeterminateToChecked:"mdc-checkbox--anim-indeterminate-checked",indeterminateToUnchecked:"mdc-checkbox--anim-indeterminate-unchecked"},this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new os,this.indeterminateChange=new os,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=tf.Init,this._controlValueAccessorChangeFn=()=>{},this._validatorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||hY,this.color=this._options.color||hY.color,this.tabIndex=parseInt(s)||0,this.id=this._uniqueId="mat-mdc-checkbox-"+ ++o2e,this.disabledInteractive=l?.disabledInteractive??!1}ngOnChanges(t){t.required&&this._validatorChangeFn()}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(t){t!=this.checked&&(this._checked=t,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(t){t!==this.disabled&&(this._disabled=t,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(t){const i=t!=this._indeterminate;this._indeterminate=t,i&&(this._transitionCheckState(this._indeterminate?tf.Indeterminate:this.checked?tf.Checked:tf.Unchecked),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(t){this.checked=!!t}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t}validate(t){return this.required&&!0!==t.value?{required:!0}:null}registerOnValidatorChange(t){this._validatorChangeFn=t}_transitionCheckState(t){let i=this._currentCheckState,r=this._getAnimationTargetElement();if(i!==t&&r&&(this._currentAnimationClass&&r.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(i,t),this._currentCheckState=t,this._currentAnimationClass.length>0)){r.classList.add(this._currentAnimationClass);const s=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{r.classList.remove(s)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){const t=this._options?.clickAction;this.disabled||"noop"===t?(this.disabled&&this.disabledInteractive||!this.disabled&&"noop"===t)&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate):(this.indeterminate&&"check"!==t&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?tf.Checked:tf.Unchecked),this._emitChangeEvent())}_onInteractionEvent(t){t.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(t,i){if("NoopAnimations"===this._animationMode)return"";switch(t){case tf.Init:if(i===tf.Checked)return this._animationClasses.uncheckedToChecked;if(i==tf.Indeterminate)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case tf.Unchecked:return i===tf.Checked?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case tf.Checked:return i===tf.Unchecked?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case tf.Indeterminate:return i===tf.Checked?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(t){const i=this._inputElement;i&&(i.nativeElement.indeterminate=t)}_onInputClick(){this._handleInputClick()}_onTouchTargetClick(){this._handleInputClick(),this.disabled||this._inputElement.nativeElement.focus()}_preventBubblingFromLabel(t){t.target&&this._labelElement.nativeElement.contains(t.target)&&t.stopPropagation()}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(Ac),Q(ns),an("tabindex"),Q(gh,8),Q(i2e,8))};static#t=this.\u0275cmp=wr({type:n,selectors:[["mat-checkbox"]],viewQuery:function(i,r){if(1&i&&(ul(e2e,5),ul(t2e,5),ul(L0,5)),2&i){let s;ia(s=ra())&&(r._inputElement=s.first),ia(s=ra())&&(r._labelElement=s.first),ia(s=ra())&&(r.ripple=s.first)}},hostAttrs:[1,"mat-mdc-checkbox"],hostVars:16,hostBindings:function(i,r){2&i&&(k1("id",r.id),ja("tabindex",null)("aria-label",null)("aria-labelledby",null),gA(r.color?"mat-"+r.color:"mat-accent"),Ka("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mdc-checkbox--disabled",r.disabled)("mat-mdc-checkbox-disabled",r.disabled)("mat-mdc-checkbox-checked",r.checked)("mat-mdc-checkbox-disabled-interactive",r.disabledInteractive))},inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],id:"id",required:[2,"required","required",js],labelPosition:"labelPosition",name:"name",value:"value",disableRipple:[2,"disableRipple","disableRipple",js],tabIndex:[2,"tabIndex","tabIndex",t=>null==t?void 0:vh(t)],color:"color",disabledInteractive:[2,"disabledInteractive","disabledInteractive",js],checked:[2,"checked","checked",js],disabled:[2,"disabled","disabled",js],indeterminate:[2,"indeterminate","indeterminate",js]},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],standalone:!0,features:[Bo([r2e,{provide:pu,useExisting:n,multi:!0}]),kl,dc,ah],ngContentSelectors:n2e,decls:15,vars:20,consts:[["checkbox",""],["input",""],["label",""],["mat-internal-form-field","",3,"click","labelPosition"],[1,"mdc-checkbox"],[1,"mat-mdc-checkbox-touch-target",3,"click"],["type","checkbox",1,"mdc-checkbox__native-control",3,"blur","click","change","checked","indeterminate","disabled","id","required","tabIndex"],[1,"mdc-checkbox__ripple"],[1,"mdc-checkbox__background"],["focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mdc-checkbox__checkmark"],["fill","none","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-checkbox__checkmark-path"],[1,"mdc-checkbox__mixedmark"],["mat-ripple","",1,"mat-mdc-checkbox-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-label",3,"for"]],template:function(i,r){if(1&i){const s=zo();xd(),Wt(0,"div",3),mi("click",function(l){return pi(s),fi(r._preventBubblingFromLabel(l))}),Wt(1,"div",4,0)(3,"div",5),mi("click",function(){return pi(s),fi(r._onTouchTargetClick())}),un(),Wt(4,"input",6,1),mi("blur",function(){return pi(s),fi(r._onBlur())})("click",function(){return pi(s),fi(r._onInputClick())})("change",function(l){return pi(s),fi(r._onInteractionEvent(l))}),un(),Er(6,"div",7),Wt(7,"div",8),Fr(),Wt(8,"svg",9),Er(9,"path",10),un(),vo(),Er(10,"div",11),un(),Er(11,"div",12),un(),Wt(12,"label",13,2),ou(14),un()()}if(2&i){const s=Ha(2);jn("labelPosition",r.labelPosition),F(4),Ka("mdc-checkbox--selected",r.checked),jn("checked",r.checked)("indeterminate",r.indeterminate)("disabled",r.disabled&&!r.disabledInteractive)("id",r.inputId)("required",r.required)("tabIndex",r.disabled&&!r.disabledInteractive?-1:r.tabIndex),ja("aria-label",r.ariaLabel||null)("aria-labelledby",r.ariaLabelledby)("aria-describedby",r.ariaDescribedby)("aria-checked",r.indeterminate?"mixed":null)("aria-disabled",!(!r.disabled||!r.disabledInteractive)||null)("name",r.name)("value",r.value),F(7),jn("matRippleTrigger",s)("matRippleDisabled",r.disableRipple||r.disabled)("matRippleCentered",!0),F(),jn("for",r.inputId)}},dependencies:[L0,bN],styles:['.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom;padding:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2);margin:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2)}.mdc-checkbox:hover .mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity));background-color:var(--mdc-checkbox-unselected-hover-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox:hover .mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity));background-color:var(--mdc-checkbox-unselected-focus-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox .mdc-checkbox__native-control:focus~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-focus-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox:active .mdc-checkbox__native-control~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity));background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color, var(--mat-app-primary))}.mdc-checkbox:active .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color, var(--mat-app-primary))}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity));background-color:var(--mdc-checkbox-selected-hover-state-layer-color, var(--mat-app-primary))}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-hover-state-layer-color, var(--mat-app-primary))}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity));background-color:var(--mdc-checkbox-selected-focus-state-layer-color, var(--mat-app-primary))}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-focus-state-layer-color, var(--mat-app-primary))}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity));background-color:var(--mdc-checkbox-selected-pressed-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-pressed-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox .mdc-checkbox__native-control~.mdc-checkbox__ripple{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox .mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit;width:var(--mdc-checkbox-state-layer-size, 40px);height:var(--mdc-checkbox-state-layer-size, 40px);top:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2);right:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2)}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.cdk-high-contrast-active .mdc-checkbox--disabled{opacity:.5}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:rgba(0,0,0,0);pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms cubic-bezier(0.4, 0, 0.6, 1);-webkit-print-color-adjust:exact;color-adjust:exact;border-color:var(--mdc-checkbox-unselected-icon-color, var(--mat-app-on-surface-variant));top:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2)}.mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-icon-color, var(--mat-app-primary));background-color:var(--mdc-checkbox-selected-icon-color, var(--mat-app-primary))}.mdc-checkbox--disabled .mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color)}.mdc-checkbox__native-control:disabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:disabled:indeterminate~.mdc-checkbox__background{background-color:var(--mdc-checkbox-disabled-selected-icon-color);border-color:rgba(0,0,0,0)}.mdc-checkbox:hover .mdc-checkbox__native-control:not(:checked)~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-hover-icon-color, var(--mat-app-on-surface));background-color:rgba(0,0,0,0)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mat-app-primary));background-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mat-app-primary))}.mdc-checkbox__native-control:focus:focus:not(:checked)~.mdc-checkbox__background,.mdc-checkbox__native-control:focus:focus:not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color, var(--mat-app-on-surface))}.mdc-checkbox__native-control:focus:focus:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:focus:focus:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mat-app-primary));background-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mat-app-primary))}.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox:hover .mdc-checkbox__native-control~.mdc-checkbox__background,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__background,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color)}.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{background-color:var(--mdc-checkbox-disabled-selected-icon-color);border-color:rgba(0,0,0,0)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms cubic-bezier(0.4, 0, 0.6, 1);color:var(--mdc-checkbox-selected-checkmark-color, var(--mat-app-on-primary))}.cdk-high-contrast-active .mdc-checkbox__checkmark{color:CanvasText}.mdc-checkbox--disabled .mdc-checkbox__checkmark,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__checkmark{color:var(--mdc-checkbox-disabled-selected-checkmark-color, var(--mat-app-surface))}.cdk-high-contrast-active .mdc-checkbox--disabled .mdc-checkbox__checkmark,.cdk-high-contrast-active .mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__checkmark{color:CanvasText}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1);border-color:var(--mdc-checkbox-selected-checkmark-color, var(--mat-app-on-primary))}.cdk-high-contrast-active .mdc-checkbox__mixedmark{margin:0 1px}.mdc-checkbox--disabled .mdc-checkbox__mixedmark,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-disabled-selected-checkmark-color, var(--mat-app-surface))}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{transition:border-color 90ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms cubic-bezier(0, 0, 0.2, 1),transform 180ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mat-mdc-checkbox{display:inline-block;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-checkbox._mat-animation-noopable .mdc-checkbox *,.mat-mdc-checkbox._mat-animation-noopable .mdc-checkbox *::before{transition:none !important;animation:none !important}.mat-mdc-checkbox label{cursor:pointer}.mat-mdc-checkbox .mat-internal-form-field{color:var(--mat-checkbox-label-text-color, var(--mat-app-on-surface));font-family:var(--mat-checkbox-label-text-font, var(--mat-app-body-medium-font));line-height:var(--mat-checkbox-label-text-line-height, var(--mat-app-body-medium-line-height));font-size:var(--mat-checkbox-label-text-size, var(--mat-app-body-medium-size));letter-spacing:var(--mat-checkbox-label-text-tracking, var(--mat-app-body-medium-tracking));font-weight:var(--mat-checkbox-label-text-weight, var(--mat-app-body-medium-weight))}.mat-mdc-checkbox.mat-mdc-checkbox-disabled.mat-mdc-checkbox-disabled-interactive{pointer-events:auto}.mat-mdc-checkbox.mat-mdc-checkbox-disabled.mat-mdc-checkbox-disabled-interactive input{cursor:default}.mat-mdc-checkbox.mat-mdc-checkbox-disabled label{cursor:default;color:var(--mat-checkbox-disabled-label-color)}.mat-mdc-checkbox label:empty{display:none}.mat-mdc-checkbox .mdc-checkbox__ripple{opacity:0}.mat-mdc-checkbox-ripple,.mdc-checkbox__ripple{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-checkbox-ripple:not(:empty),.mdc-checkbox__ripple:not(:empty){transform:translateZ(0)}.mat-mdc-checkbox-ripple .mat-ripple-element{opacity:.1}.mat-mdc-checkbox-touch-target{position:absolute;top:50%;left:50%;height:48px;width:48px;transform:translate(-50%, -50%);display:var(--mat-checkbox-touch-target-display)}.mat-mdc-checkbox-ripple::before{border-radius:50%}.mdc-checkbox__native-control:focus~.mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return n})(),c2e=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({imports:[mv,zh,zh]})}return n})();var h2e=Te(6279);function uY(n){const e=n.cloneNode(!0),t=e.querySelectorAll("[id]"),i=n.nodeName.toLowerCase();e.removeAttribute("id");for(let r=0;r<t.length;r++)t[r].removeAttribute("id");return"canvas"===i?pY(n,e):("input"===i||"select"===i||"textarea"===i)&&fY(n,e),dY("canvas",n,e,pY),dY("input, textarea, select",n,e,fY),e}function dY(n,e,t,i){const r=e.querySelectorAll(n);if(r.length){const s=t.querySelectorAll(n);for(let o=0;o<r.length;o++)i(r[o],s[o])}}let d2e=0;function fY(n,e){"file"!==e.type&&(e.value=n.value),"radio"===e.type&&e.name&&(e.name=`mat-clone-${e.name}-${d2e++}`)}function pY(n,e){const t=e.getContext("2d");if(t)try{t.drawImage(n,0,0)}catch{}}function e6(n){const e=n.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}function t6(n,e,t){const{top:i,bottom:r,left:s,right:o}=n;return t>=i&&t<=r&&e>=s&&e<=o}function OT(n,e,t){n.top+=e,n.bottom=n.top+n.height,n.left+=t,n.right=n.left+n.width}function mY(n,e,t,i){const{top:r,right:s,bottom:o,left:l,width:h,height:u}=n,f=h*e,y=u*e;return i>r-y&&i<o+y&&t>l-f&&t<s+f}class AY{constructor(e){this._document=e,this.positions=new Map}clear(){this.positions.clear()}cache(e){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),e.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:e6(t)})})}handleScroll(e){const t=Sm(e),i=this.positions.get(t);if(!i)return null;const r=i.scrollPosition;let s,o;if(t===this._document){const u=this.getViewportScrollPosition();s=u.top,o=u.left}else s=t.scrollTop,o=t.scrollLeft;const l=r.top-s,h=r.left-o;return this.positions.forEach((u,f)=>{u.clientRect&&t!==f&&t.contains(f)&&OT(u.clientRect,l,h)}),r.top=s,r.left=o,{top:l,left:h}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function gY(n,e){const t=n.rootNodes;if(1===t.length&&t[0].nodeType===e.ELEMENT_NODE)return t[0];const i=e.createElement("div");return t.forEach(r=>i.appendChild(r)),i}function n6(n,e,t){for(let i in e)if(e.hasOwnProperty(i)){const r=e[i];r?n.setProperty(i,r,t?.has(i)?"important":""):n.removeProperty(i)}return n}function lM(n,e){const t=e?"":"none";n6(n.style,{"touch-action":e?"":"none","-webkit-user-drag":e?"":"none","-webkit-tap-highlight-color":e?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function _Y(n,e,t){n6(n.style,{position:e?"":"fixed",top:e?"":"0",opacity:e?"":"0",left:e?"":"-999em"},t)}function hP(n,e){return e&&"none"!=e?n+" "+e:n}function yY(n,e){n.style.width=`${e.width}px`,n.style.height=`${e.height}px`,n.style.transform=uP(e.left,e.top)}function uP(n,e){return`translate3d(${Math.round(n)}px, ${Math.round(e)}px, 0)`}function vY(n){const e=n.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(n)*e}function i6(n,e){return n.getPropertyValue(e).split(",").map(i=>i.trim())}const p2e=new Set(["position"]);class m2e{get element(){return this._preview}constructor(e,t,i,r,s,o,l,h,u){this._document=e,this._rootElement=t,this._direction=i,this._initialDomRect=r,this._previewTemplate=s,this._previewClass=o,this._pickupPositionOnPage=l,this._initialTransform=h,this._zIndex=u}attach(e){this._preview=this._createPreview(),e.appendChild(this._preview),bY(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(e){this._preview.style.transform=e}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(e){this._preview.classList.add(e)}getTransitionDuration(){return function f2e(n){const e=getComputedStyle(n),t=i6(e,"transition-property"),i=t.find(l=>"transform"===l||"all"===l);if(!i)return 0;const r=t.indexOf(i),s=i6(e,"transition-duration"),o=i6(e,"transition-delay");return vY(s[r])+vY(o[r])}(this._preview)}addEventListener(e,t){this._preview.addEventListener(e,t)}removeEventListener(e,t){this._preview.removeEventListener(e,t)}_createPreview(){const e=this._previewTemplate,t=this._previewClass,i=e?e.template:null;let r;if(i&&e){const s=e.matchSize?this._initialDomRect:null,o=e.viewContainer.createEmbeddedView(i,e.context);o.detectChanges(),r=gY(o,this._document),this._previewEmbeddedView=o,e.matchSize?yY(r,s):r.style.transform=uP(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=uY(this._rootElement),yY(r,this._initialDomRect),this._initialTransform&&(r.style.transform=this._initialTransform);return n6(r.style,{"pointer-events":"none",margin:bY(r)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},p2e),lM(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("popover","manual"),r.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(s=>r.classList.add(s)):r.classList.add(t)),r}}function bY(n){return"showPopover"in n}const xY=zg({passive:!0}),dP=zg({passive:!1}),wY=zg({passive:!1,capture:!0}),CY=new Set(["position"]);class g2e{get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(e){e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(t=>lM(t,e)))}constructor(e,t,i,r,s,o){this._config=t,this._document=i,this._ngZone=r,this._viewportRuler=s,this._dragDropRegistry=o,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=N_(!1),this._moveEvents=new Qt,this._pointerMoveSubscription=pt.EMPTY,this._pointerUpSubscription=pt.EMPTY,this._scrollSubscription=pt.EMPTY,this._resizeSubscription=pt.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this.scale=1,this._disabled=!1,this.beforeStarted=new Qt,this.started=new Qt,this.released=new Qt,this.ended=new Qt,this.entered=new Qt,this.exited=new Qt,this.dropped=new Qt,this.moved=this._moveEvents,this._pointerDown=l=>{if(this.beforeStarted.next(),this._handles.length){const h=this._getTargetHandle(l);h&&!this._disabledHandles.has(h)&&!this.disabled&&this._initializeDragSequence(h,l)}else this.disabled||this._initializeDragSequence(this._rootElement,l)},this._pointerMove=l=>{const h=this._getPointerPositionOnPage(l);if(!this._hasStartedDragging()){if(Math.abs(h.x-this._pickupPositionOnPage.x)+Math.abs(h.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const B=Date.now()>=this._dragStartTime+this._getDragStartDelay(l),j=this._dropContainer;if(!B)return void this._endDragSequence(l);(!j||!j.isDragging()&&!j.isReceiving())&&(l.cancelable&&l.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(l)))}return}l.cancelable&&l.preventDefault();const u=this._getConstrainedPointerPosition(h);if(this._hasMoved=!0,this._lastKnownPointerPosition=h,this._updatePointerDirectionDelta(u),this._dropContainer)this._updateActiveDropContainer(u,h);else{const f=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,y=this._activeTransform;y.x=u.x-f.x+this._passiveTransform.x,y.y=u.y-f.y+this._passiveTransform.y,this._applyRootElementTransform(y.x,y.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:u,event:l,distance:this._getDragDistance(u),delta:this._pointerDirectionDelta})})},this._pointerUp=l=>{this._endDragSequence(l)},this._nativeDragStart=l=>{if(this._handles.length){const h=this._getTargetHandle(l);h&&!this._disabledHandles.has(h)&&!this.disabled&&l.preventDefault()}else this.disabled||l.preventDefault()},this.withRootElement(e).withParent(t.parentDragRef||null),this._parentPositions=new AY(i),o.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(e){this._handles=e.map(i=>Pp(i)),this._handles.forEach(i=>lM(i,this.disabled)),this._toggleNativeDragInteractions();const t=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&t.add(i)}),this._disabledHandles=t,this}withPreviewTemplate(e){return this._previewTemplate=e,this}withPlaceholderTemplate(e){return this._placeholderTemplate=e,this}withRootElement(e){const t=Pp(e);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,dP),t.addEventListener("touchstart",this._pointerDown,xY),t.addEventListener("dragstart",this._nativeDragStart,dP)}),this._initialTransform=void 0,this._rootElement=t),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(e){return this._boundaryElement=e?Pp(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(e){return this._parentDragRef=e,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(e){!this._disabledHandles.has(e)&&this._handles.indexOf(e)>-1&&(this._disabledHandles.add(e),lM(e,!0))}enableHandle(e){this._disabledHandles.has(e)&&(this._disabledHandles.delete(e),lM(e,this.disabled))}withDirection(e){return this._direction=e,this}_withDropContainer(e){this._dropContainer=e}getFreeDragPosition(){const e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}setFreeDragPosition(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}withPreviewContainer(e){return this._previewContainer=e,this}_sortFromLastPointerPosition(){const e=this._lastKnownPointerPosition;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e),e)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._getShadowRoot()?.removeEventListener("selectstart",EY,wY)}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(e){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging()))if(this.released.next({source:this,event:e}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(e),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const t=this._getPointerPositionOnPage(e);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t,event:e})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(e){LT(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const t=this._getShadowRoot(),i=this._dropContainer;if(t&&this._ngZone.runOutsideAngular(()=>{t.addEventListener("selectstart",EY,wY)}),i){const r=this._rootElement,s=r.parentNode,o=this._placeholder=this._createPlaceholderElement(),l=this._anchor=this._anchor||this._document.createComment("");s.insertBefore(l,r),this._initialTransform=r.style.transform||"",this._preview=new m2e(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3),this._preview.attach(this._getPreviewInsertionPoint(s,t)),_Y(r,!1,CY),this._document.body.appendChild(s.replaceChild(o,r)),this.started.next({source:this,event:e}),i.start(),this._initialContainer=i,this._initialIndex=i.getItemIndex(this)}else this.started.next({source:this,event:e}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(i?i.getScrollableParents():[])}_initializeDragSequence(e,t){this._parentDragRef&&t.stopPropagation();const i=this.isDragging(),r=LT(t),s=!r&&0!==t.button,o=this._rootElement,l=Sm(t),h=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),u=r?LB(t):OB(t);if(l&&l.draggable&&"mousedown"===t.type&&t.preventDefault(),i||s||h||u)return;if(this._handles.length){const T=o.style;this._rootElementTapHighlight=T.webkitTapHighlightColor||"",T.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(T=>this._updateOnScroll(T)),this._boundaryElement&&(this._boundaryRect=e6(this._boundaryElement));const f=this._previewTemplate;this._pickupPositionInElement=f&&f.template&&!f.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,e,t);const y=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:y.x,y:y.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(e){_Y(this._rootElement,!0,CY),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const t=this._dropContainer,i=t.getItemIndex(this),r=this._getPointerPositionOnPage(e),s=this._getDragDistance(r),o=t._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:s,dropPoint:r,event:e}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:o,distance:s,dropPoint:r,event:e}),t.drop(this,i,this._initialIndex,this._initialContainer,o,s,r,e),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:e,y:t},{x:i,y:r}){let s=this._initialContainer._getSiblingContainerFromPosition(this,e,t);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(e,t)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=s,this._dropContainer.enter(this,e,t,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,r),this._dropContainer._sortItem(this,e,t,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(e,t):this._applyPreviewTransform(e-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const e=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(e.left,e.top);const t=this._preview.getTransitionDuration();return 0===t?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{const r=o=>{(!o||this._preview&&Sm(o)===this._preview.element&&"transform"===o.propertyName)&&(this._preview?.removeEventListener("transitionend",r),i(),clearTimeout(s))},s=setTimeout(r,1.5*t);this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){const e=this._placeholderTemplate,t=e?e.template:null;let i;return t?(this._placeholderRef=e.viewContainer.createEmbeddedView(t,e.context),this._placeholderRef.detectChanges(),i=gY(this._placeholderRef,this._document)):i=uY(this._rootElement),i.style.pointerEvents="none",i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(e,t,i){const r=t===this._rootElement?null:t,s=r?r.getBoundingClientRect():e,o=LT(i)?i.targetTouches[0]:i,l=this._getViewportScrollPosition();return{x:s.left-e.left+(o.pageX-s.left-l.left),y:s.top-e.top+(o.pageY-s.top-l.top)}}_getPointerPositionOnPage(e){const t=this._getViewportScrollPosition(),i=LT(e)?e.touches[0]||e.changedTouches[0]||{pageX:0,pageY:0}:e,r=i.pageX-t.left,s=i.pageY-t.top;if(this._ownerSVGElement){const o=this._ownerSVGElement.getScreenCTM();if(o){const l=this._ownerSVGElement.createSVGPoint();return l.x=r,l.y=s,l.matrixTransform(o.inverse())}}return{x:r,y:s}}_getConstrainedPointerPosition(e){const t=this._dropContainer?this._dropContainer.lockAxis:null;let{x:i,y:r}=this.constrainPosition?this.constrainPosition(e,this,this._initialDomRect,this._pickupPositionInElement):e;if("x"===this.lockAxis||"x"===t?r=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):("y"===this.lockAxis||"y"===t)&&(i=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){const{x:s,y:o}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,l=this._boundaryRect,{width:h,height:u}=this._getPreviewRect(),f=l.top+o,y=l.bottom-(u-o);i=MY(i,l.left+s,l.right-(h-s)),r=MY(r,f,y)}return{x:i,y:r}}_updatePointerDirectionDelta(e){const{x:t,y:i}=e,r=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,o=Math.abs(t-s.x),l=Math.abs(i-s.y);return o>this._config.pointerDirectionChangeThreshold&&(r.x=t>s.x?1:-1,s.x=t),l>this._config.pointerDirectionChangeThreshold&&(r.y=i>s.y?1:-1,s.y=i),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,lM(this._rootElement,e))}_removeRootElementListeners(e){e.removeEventListener("mousedown",this._pointerDown,dP),e.removeEventListener("touchstart",this._pointerDown,xY),e.removeEventListener("dragstart",this._nativeDragStart,dP)}_applyRootElementTransform(e,t){const i=1/this.scale,r=uP(e*i,t*i),s=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=s.transform&&"none"!=s.transform?s.transform:""),s.transform=hP(r,this._initialTransform)}_applyPreviewTransform(e,t){const i=this._previewTemplate?.template?void 0:this._initialTransform,r=uP(e,t);this._preview.setTransform(hP(r,i))}_getDragDistance(e){const t=this._pickupPositionOnPage;return t?{x:e.x-t.x,y:e.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:e,y:t}=this._passiveTransform;if(0===e&&0===t||this.isDragging()||!this._boundaryElement)return;const i=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(0===r.width&&0===r.height||0===i.width&&0===i.height)return;const s=r.left-i.left,o=i.right-r.right,l=r.top-i.top,h=i.bottom-r.bottom;r.width>i.width?(s>0&&(e+=s),o>0&&(e-=o)):e=0,r.height>i.height?(l>0&&(t+=l),h>0&&(t-=h)):t=0,(e!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:e})}_getDragStartDelay(e){const t=this.dragStartDelay;return"number"==typeof t?t:LT(e)?t.touch:t?t.mouse:0}_updateOnScroll(e){const t=this._parentPositions.handleScroll(e);if(t){const i=Sm(e);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&OT(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=IB(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(e,t){const i=this._previewContainer||"global";if("parent"===i)return e;if("global"===i){const r=this._document;return t||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return Pp(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_getTargetHandle(e){return this._handles.find(t=>e.target&&(e.target===t||t.contains(e.target)))}}function MY(n,e,t){return Math.max(e,Math.min(t,n))}function LT(n){return"t"===n.type[0]}function EY(n){n.preventDefault()}function SY(n,e,t){const i=NT(e,n.length-1),r=NT(t,n.length-1);if(i===r)return;const s=n[i],o=r<i?-1:1;for(let l=i;l!==r;l+=o)n[l]=n[l+o];n[r]=s}function NT(n,e){return Math.max(0,Math.min(e,n))}class TY{constructor(e){this._dragDropRegistry=e,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(e){this.withItems(e)}sort(e,t,i,r){const s=this._itemPositions,o=this._getItemIndexFromPointerPosition(e,t,i,r);if(-1===o&&s.length>0)return null;const l="horizontal"===this.orientation,h=s.findIndex(se=>se.drag===e),u=s[o],y=u.clientRect,T=h>o?1:-1,B=this._getItemOffsetPx(s[h].clientRect,y,T),j=this._getSiblingOffsetPx(h,s,T),ne=s.slice();return SY(s,h,o),s.forEach((se,le)=>{if(ne[le]===se)return;const Ee=se.drag===e,Pe=Ee?B:j,Ve=Ee?e.getPlaceholderElement():se.drag.getRootElement();se.offset+=Pe;const Ft=Math.round(se.offset*(1/se.drag.scale));l?(Ve.style.transform=hP(`translate3d(${Ft}px, 0, 0)`,se.initialTransform),OT(se.clientRect,0,Pe)):(Ve.style.transform=hP(`translate3d(0, ${Ft}px, 0)`,se.initialTransform),OT(se.clientRect,Pe,0))}),this._previousSwap.overlaps=t6(y,t,i),this._previousSwap.drag=u.drag,this._previousSwap.delta=l?r.x:r.y,{previousIndex:h,currentIndex:o}}enter(e,t,i,r){const s=null==r||r<0?this._getItemIndexFromPointerPosition(e,t,i):r,o=this._activeDraggables,l=o.indexOf(e),h=e.getPlaceholderElement();let u=o[s];if(u===e&&(u=o[s+1]),!u&&(null==s||-1===s||s<o.length-1)&&this._shouldEnterAsFirstChild(t,i)&&(u=o[0]),l>-1&&o.splice(l,1),u&&!this._dragDropRegistry.isDragging(u)){const f=u.getRootElement();f.parentElement.insertBefore(h,f),o.splice(s,0,e)}else this._element.appendChild(h),o.push(e);h.style.transform="",this._cacheItemPositions()}withItems(e){this._activeDraggables=e.slice(),this._cacheItemPositions()}withSortPredicate(e){this._sortPredicate=e}reset(){this._activeDraggables?.forEach(e=>{const t=e.getRootElement();if(t){const i=this._itemPositions.find(r=>r.drag===e)?.initialTransform;t.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(e){return("horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions).findIndex(i=>i.drag===e)}updateOnScroll(e,t){this._itemPositions.forEach(({clientRect:i})=>{OT(i,e,t)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}withElementContainer(e){this._element=e}_cacheItemPositions(){const e="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(t=>{const i=t.getVisibleElement();return{drag:t,offset:0,initialTransform:i.style.transform||"",clientRect:e6(i)}}).sort((t,i)=>e?t.clientRect.left-i.clientRect.left:t.clientRect.top-i.clientRect.top)}_getItemOffsetPx(e,t,i){const r="horizontal"===this.orientation;let s=r?t.left-e.left:t.top-e.top;return-1===i&&(s+=r?t.width-e.width:t.height-e.height),s}_getSiblingOffsetPx(e,t,i){const r="horizontal"===this.orientation,s=t[e].clientRect,o=t[e+-1*i];let l=s[r?"width":"height"]*i;if(o){const h=r?"left":"top",u=r?"right":"bottom";-1===i?l-=o.clientRect[h]-s[u]:l+=s[h]-o.clientRect[u]}return l}_shouldEnterAsFirstChild(e,t){if(!this._activeDraggables.length)return!1;const i=this._itemPositions,r="horizontal"===this.orientation;if(i[0].drag!==this._activeDraggables[0]){const o=i[i.length-1].clientRect;return r?e>=o.right:t>=o.bottom}{const o=i[0].clientRect;return r?e<=o.left:t<=o.top}}_getItemIndexFromPointerPosition(e,t,i,r){const s="horizontal"===this.orientation,o=this._itemPositions.findIndex(({drag:l,clientRect:h})=>l!==e&&((!r||l!==this._previousSwap.drag||!this._previousSwap.overlaps||(s?r.x:r.y)!==this._previousSwap.delta)&&(s?t>=Math.floor(h.left)&&t<Math.floor(h.right):i>=Math.floor(h.top)&&i<Math.floor(h.bottom))));return-1!==o&&this._sortPredicate(o,e)?o:-1}}class _2e{constructor(e,t){this._document=e,this._dragDropRegistry=t,this._previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1},this._relatedNodes=[]}start(e){const t=this._element.childNodes;this._relatedNodes=[];for(let i=0;i<t.length;i++){const r=t[i];this._relatedNodes.push([r,r.nextSibling])}this.withItems(e)}sort(e,t,i,r){const s=this._getItemIndexFromPointerPosition(e,t,i),o=this._previousSwap;if(-1===s||this._activeItems[s]===e)return null;const l=this._activeItems[s];if(o.drag===l&&o.overlaps&&o.deltaX===r.x&&o.deltaY===r.y)return null;const h=this.getItemIndex(e),u=e.getPlaceholderElement(),f=l.getRootElement();s>h?f.after(u):f.before(u),SY(this._activeItems,h,s);const y=this._getRootNode().elementFromPoint(t,i);return o.deltaX=r.x,o.deltaY=r.y,o.drag=l,o.overlaps=f===y||f.contains(y),{previousIndex:h,currentIndex:s}}enter(e,t,i,r){let s=null==r||r<0?this._getItemIndexFromPointerPosition(e,t,i):r;-1===s&&(s=this._getClosestItemIndexToPointer(e,t,i));const o=this._activeItems[s],l=this._activeItems.indexOf(e);l>-1&&this._activeItems.splice(l,1),o&&!this._dragDropRegistry.isDragging(o)?(this._activeItems.splice(s,0,e),o.getRootElement().before(e.getPlaceholderElement())):(this._activeItems.push(e),this._element.appendChild(e.getPlaceholderElement()))}withItems(e){this._activeItems=e.slice()}withSortPredicate(e){this._sortPredicate=e}reset(){const e=this._element,t=this._previousSwap;for(let i=this._relatedNodes.length-1;i>-1;i--){const[r,s]=this._relatedNodes[i];r.parentNode===e&&r.nextSibling!==s&&(null===s?e.appendChild(r):s.parentNode===e&&e.insertBefore(r,s))}this._relatedNodes=[],this._activeItems=[],t.drag=null,t.deltaX=t.deltaY=0,t.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(e){return this._activeItems.indexOf(e)}updateOnScroll(){this._activeItems.forEach(e=>{this._dragDropRegistry.isDragging(e)&&e._sortFromLastPointerPosition()})}withElementContainer(e){e!==this._element&&(this._element=e,this._rootNode=void 0)}_getItemIndexFromPointerPosition(e,t,i){const r=this._getRootNode().elementFromPoint(Math.floor(t),Math.floor(i)),s=r?this._activeItems.findIndex(o=>{const l=o.getRootElement();return r===l||l.contains(r)}):-1;return-1!==s&&this._sortPredicate(s,e)?s:-1}_getRootNode(){return this._rootNode||(this._rootNode=IB(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(e,t,i){if(0===this._activeItems.length)return-1;if(1===this._activeItems.length)return 0;let r=1/0,s=-1;for(let o=0;o<this._activeItems.length;o++){const l=this._activeItems[o];if(l!==e){const{x:h,y:u}=l.getRootElement().getBoundingClientRect(),f=Math.hypot(t-h,i-u);f<r&&(r=f,s=o)}}return s}}var DA=function(n){return n[n.NONE=0]="NONE",n[n.UP=1]="UP",n[n.DOWN=2]="DOWN",n}(DA||{}),Xf=function(n){return n[n.NONE=0]="NONE",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n}(Xf||{});class y2e{constructor(e,t,i,r,s){this._dragDropRegistry=t,this._ngZone=r,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new Qt,this.entered=new Qt,this.exited=new Qt,this.dropped=new Qt,this.sorted=new Qt,this.receivingStarted=new Qt,this.receivingStopped=new Qt,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=pt.EMPTY,this._verticalScrollDirection=DA.NONE,this._horizontalScrollDirection=Xf.NONE,this._stopScrollTimers=new Qt,this._cachedShadowRoot=null,this._scrollableElements=[],this._direction="ltr",this._startScrollInterval=()=>{this._stopScrolling(),function u2e(n=0,e=_T){return n<0&&(n=0),VB(n,n,e)}(0,H$).pipe(fl(this._stopScrollTimers)).subscribe(()=>{const l=this._scrollNode,h=this.autoScrollStep;this._verticalScrollDirection===DA.UP?l.scrollBy(0,-h):this._verticalScrollDirection===DA.DOWN&&l.scrollBy(0,h),this._horizontalScrollDirection===Xf.LEFT?l.scrollBy(-h,0):this._horizontalScrollDirection===Xf.RIGHT&&l.scrollBy(h,0)})};const o=this.element=Pp(e);this._document=i,this.withOrientation("vertical").withElementContainer(o),t.registerDropContainer(this),this._parentPositions=new AY(i)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(e,t,i,r){this._draggingStarted(),null==r&&this.sortingDisabled&&(r=this._draggables.indexOf(e)),this._sortStrategy.enter(e,t,i,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}exit(e){this._reset(),this.exited.next({item:e,container:this})}drop(e,t,i,r,s,o,l,h={}){this._reset(),this.dropped.next({item:e,currentIndex:t,previousIndex:i,container:this,previousContainer:r,isPointerOverContainer:s,distance:o,dropPoint:l,event:h})}withItems(e){const t=this._draggables;return this._draggables=e,e.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(t.filter(r=>r.isDragging()).every(r=>-1===e.indexOf(r))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(e){return this._direction=e,this._sortStrategy instanceof TY&&(this._sortStrategy.direction=e),this}connectedTo(e){return this._siblings=e.slice(),this}withOrientation(e){if("mixed"===e)this._sortStrategy=new _2e(this._document,this._dragDropRegistry);else{const t=new TY(this._dragDropRegistry);t.direction=this._direction,t.orientation=e,this._sortStrategy=t}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((t,i)=>this.sortPredicate(t,i,this)),this}withScrollableParents(e){const t=this._container;return this._scrollableElements=-1===e.indexOf(t)?[t,...e]:e.slice(),this}withElementContainer(e){if(e===this._container)return this;Pp(this.element);const i=this._scrollableElements.indexOf(this._container),r=this._scrollableElements.indexOf(e);return i>-1&&this._scrollableElements.splice(i,1),r>-1&&this._scrollableElements.splice(r,1),this._sortStrategy&&this._sortStrategy.withElementContainer(e),this._cachedShadowRoot=null,this._scrollableElements.unshift(e),this._container=e,this}getScrollableParents(){return this._scrollableElements}getItemIndex(e){return this._isDragging?this._sortStrategy.getItemIndex(e):this._draggables.indexOf(e)}isReceiving(){return this._activeSiblings.size>0}_sortItem(e,t,i,r){if(this.sortingDisabled||!this._domRect||!mY(this._domRect,.05,t,i))return;const s=this._sortStrategy.sort(e,t,i,r);s&&this.sorted.next({previousIndex:s.previousIndex,currentIndex:s.currentIndex,container:this,item:e})}_startScrollingIfNecessary(e,t){if(this.autoScrollDisabled)return;let i,r=DA.NONE,s=Xf.NONE;if(this._parentPositions.positions.forEach((o,l)=>{l===this._document||!o.clientRect||i||mY(o.clientRect,.05,e,t)&&([r,s]=function v2e(n,e,t,i,r){const s=BY(e,r),o=PY(e,i);let l=DA.NONE,h=Xf.NONE;if(s){const u=n.scrollTop;s===DA.UP?u>0&&(l=DA.UP):n.scrollHeight-u>n.clientHeight&&(l=DA.DOWN)}if(o){const u=n.scrollLeft;"rtl"===t?o===Xf.RIGHT?u<0&&(h=Xf.RIGHT):n.scrollWidth+u>n.clientWidth&&(h=Xf.LEFT):o===Xf.LEFT?u>0&&(h=Xf.LEFT):n.scrollWidth-u>n.clientWidth&&(h=Xf.RIGHT)}return[l,h]}(l,o.clientRect,this._direction,e,t),(r||s)&&(i=l))}),!r&&!s){const{width:o,height:l}=this._viewportRuler.getViewportSize(),h={width:o,height:l,top:0,right:o,bottom:l,left:0};r=BY(h,t),s=PY(h,e),i=window}i&&(r!==this._verticalScrollDirection||s!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=s,this._scrollNode=i,(r||s)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const e=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;const e=this._container.style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(t=>t._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(e,t){return null!=this._domRect&&t6(this._domRect,e,t)}_getSiblingContainerFromPosition(e,t,i){return this._siblings.find(r=>r._canReceive(e,t,i))}_canReceive(e,t,i){if(!this._domRect||!t6(this._domRect,t,i)||!this.enterPredicate(e,this))return!1;const r=this._getShadowRoot().elementFromPoint(t,i);return!!r&&(r===this._container||this._container.contains(r))}_startReceiving(e,t){const i=this._activeSiblings;!i.has(e)&&t.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(i.add(e),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:e,receiver:this,items:t}))}_stopReceiving(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:e,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(e=>{if(this.isDragging()){const t=this._parentPositions.handleScroll(e);t&&this._sortStrategy.updateOnScroll(t.top,t.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const e=IB(this._container);this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const e=this._sortStrategy.getActiveItemsSnapshot().filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,e))}}function BY(n,e){const{top:t,bottom:i,height:r}=n,s=.05*r;return e>=t-s&&e<=t+s?DA.UP:e>=i-s&&e<=i+s?DA.DOWN:DA.NONE}function PY(n,e){const{left:t,right:i,width:r}=n,s=.05*r;return e>=t-s&&e<=t+s?Xf.LEFT:e>=i-s&&e<=i+s?Xf.RIGHT:Xf.NONE}const fP=zg({passive:!1,capture:!0}),pP=new Set;let b2e=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=wr({type:n,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],standalone:!0,features:[ah],decls:0,vars:0,template:function(i,r){},styles:["@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}"],encapsulation:2,changeDetection:0})}return n})(),x2e=(()=>{class n{constructor(t,i){this._ngZone=t,this._appRef=oi(yA),this._environmentInjector=oi(th),this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=N_([]),this._globalListeners=new Map,this._draggingPredicate=r=>r.isDragging(),this.pointerMove=new Qt,this.pointerUp=new Qt,this.scroll=new Qt,this._preventDefaultWhileDragging=r=>{this._activeDragInstances().length>0&&r.preventDefault()},this._persistentTouchmoveListener=r=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&r.preventDefault(),this.pointerMove.next(r))},this._document=i}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,fP)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,fP)}startDragging(t,i){if(!(this._activeDragInstances().indexOf(t)>-1)&&(this._loadResets(),this._activeDragInstances.update(r=>[...r,t]),1===this._activeDragInstances().length)){const r=i.type.startsWith("touch");this._globalListeners.set(r?"touchend":"mouseup",{handler:s=>this.pointerUp.next(s),options:!0}).set("scroll",{handler:s=>this.scroll.next(s),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:fP}),r||this._globalListeners.set("mousemove",{handler:s=>this.pointerMove.next(s),options:fP}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((s,o)=>{this._document.addEventListener(o,s.handler,s.options)})})}}stopDragging(t){this._activeDragInstances.update(i=>{const r=i.indexOf(t);return r>-1?(i.splice(r,1),[...i]):i}),0===this._activeDragInstances().length&&this._clearGlobalListeners()}isDragging(t){return this._activeDragInstances().indexOf(t)>-1}scrolled(t){const i=[this.scroll];return t&&t!==this._document&&i.push(new Be(r=>this._ngZone.runOutsideAngular(()=>{const o=l=>{this._activeDragInstances().length&&r.next(l)};return t.addEventListener("scroll",o,!0),()=>{t.removeEventListener("scroll",o,!0)}}))),Tm(...i)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,i)=>{this._document.removeEventListener(i,t.handler,t.options)}),this._globalListeners.clear()}_loadResets(){if(!pP.has(this._appRef)){pP.add(this._appRef);const t=function gse(n,e){const t=Ro(n),i=e.elementInjector||Zm();return new BE(t).create(i,e.projectableNodes,e.hostElement,e.environmentInjector)}(b2e,{environmentInjector:this._environmentInjector});this._appRef.onDestroy(()=>{pP.delete(this._appRef),0===pP.size&&t.destroy()})}}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ns),Wn(ca))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const w2e={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let r6=(()=>{class n{constructor(t,i,r,s){this._document=t,this._ngZone=i,this._viewportRuler=r,this._dragDropRegistry=s}createDrag(t,i=w2e){return new g2e(t,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new y2e(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ca),Wn(ns),Wn(ST),Wn(x2e))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const UT=new Ai("CDK_DRAG_PARENT"),RY=new Ai("CdkDragHandle");let kY=(()=>{class n{get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._stateChanges.next(this)}constructor(t,i){this.element=t,this._parentDrag=i,this._stateChanges=new Qt,this._disabled=!1,i?._addHandle(this)}ngOnDestroy(){this._parentDrag?._removeHandle(this),this._stateChanges.complete()}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(UT,12))};static#t=this.\u0275dir=mr({type:n,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:[2,"cdkDragHandleDisabled","disabled",js]},standalone:!0,features:[Bo([{provide:RY,useExisting:n}]),kl]})}return n})();const FY=new Ai("CDK_DRAG_CONFIG"),OY=new Ai("CdkDropList");let s6=(()=>{class n{static#e=this._dragInstances=[];get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=t,this._dragRef.disabled=this._disabled}constructor(t,i,r,s,o,l,h,u,f,y,T){this.element=t,this.dropContainer=i,this._ngZone=s,this._viewContainerRef=o,this._dir=h,this._changeDetectorRef=f,this._selfHandle=y,this._parentDrag=T,this._destroyed=new Qt,this._handles=new dn([]),this.scale=1,this.started=new os,this.released=new os,this.ended=new os,this.entered=new os,this.exited=new os,this.dropped=new os,this.moved=new Be(B=>{const j=this._dragRef.moved.pipe(kn(ne=>({source:this,pointerPosition:ne.pointerPosition,event:ne.event,delta:ne.delta,distance:ne.distance}))).subscribe(B);return()=>{j.unsubscribe()}}),this._injector=oi(Dr),this._dragRef=u.createDrag(t,{dragStartThreshold:l&&null!=l.dragStartThreshold?l.dragStartThreshold:5,pointerDirectionChangeThreshold:l&&null!=l.pointerDirectionChangeThreshold?l.pointerDirectionChangeThreshold:5,zIndex:l?.zIndex}),this._dragRef.data=this,n._dragInstances.push(this),l&&this._assignDefaults(l),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this),i._dropListRef.beforeStarted.pipe(fl(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(t){this._dragRef.setFreeDragPosition(t)}ngAfterViewInit(){AA(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(t){const i=t.rootElementSelector,r=t.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const t=n._dragInstances.indexOf(this);t>-1&&n._dragInstances.splice(t,1),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(t){const i=this._handles.getValue();i.push(t),this._handles.next(i)}_removeHandle(t){const i=this._handles.getValue(),r=i.indexOf(t);r>-1&&(i.splice(r,1),this._handles.next(i))}_setPreviewTemplate(t){this._previewTemplate=t}_resetPreviewTemplate(t){t===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(t){this._placeholderTemplate=t}_resetPlaceholderTemplate(t){t===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){const t=this.element.nativeElement;let i=t;this.rootElementSelector&&(i=void 0!==t.closest?t.closest(this.rootElementSelector):t.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||t)}_getBoundaryElement(){const t=this.boundaryElement;return t?"string"==typeof t?this.element.nativeElement.closest(t):Pp(t):null}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){const i=this._dir,r=this.dragStartDelay,s=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,o=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.scale=this.scale,t.dragStartDelay="object"==typeof r&&r?r:Cx(r),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(s).withPreviewTemplate(o).withPreviewContainer(this.previewContainer||"global"),i&&t.withDirection(i.value)}}),t.beforeStarted.pipe(lh(1)).subscribe(()=>{if(this._parentDrag)return void t.withParent(this._parentDrag._dragRef);let i=this.element.nativeElement.parentElement;for(;i;){if(i.classList.contains("cdk-drag")){t.withParent(n._dragInstances.find(r=>r.element.nativeElement===i)?._dragRef||null);break}i=i.parentElement}})}_handleEvents(t){t.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),t.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(t){const{lockAxis:i,dragStartDelay:r,constrainPosition:s,previewClass:o,boundaryElement:l,draggingDisabled:h,rootElementSelector:u,previewContainer:f}=t;this.disabled=h??!1,this.dragStartDelay=r||0,i&&(this.lockAxis=i),s&&(this.constrainPosition=s),o&&(this.previewClass=o),l&&(this.boundaryElement=l),u&&(this.rootElementSelector=u),f&&(this.previewContainer=f)}_setupHandlesListener(){this._handles.pipe(Xc(t=>{const i=t.map(r=>r.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),Ru(t=>Tm(...t.map(i=>i._stateChanges.pipe(Mp(i))))),fl(this._destroyed)).subscribe(t=>{const i=this._dragRef,r=t.element.nativeElement;t.disabled?i.disableHandle(r):i.enableHandle(r)})}static#t=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(OY,12),Q(ca),Q(ns),Q(Fh),Q(FY,8),Q(Rp,8),Q(r6),Q(Ac),Q(RY,10),Q(UT,12))};static#n=this.\u0275dir=mr({type:n,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(i,r){2&i&&Ka("cdk-drag-disabled",r.disabled)("cdk-drag-dragging",r._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",js],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",vh]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[Bo([{provide:UT,useExisting:n}]),kl,dc]})}return n})(),B2e=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({providers:[r6],imports:[TT]})}return n})();const P2e=["overlayCard"],R2e=["resizeHandleCorner"],k2e=["*"],F2e=n=>({"with-body":n}),O2e=n=>({expand:n}),L2e=n=>({"transparent-bg":n});function N2e(n,e){if(1&n&&(Wt(0,"div",11),Fr(),Wt(1,"svg"),Er(2,"use"),un()()),2&n){const t=pr(2);F(2),x2("href","assets/icons/",t.icon,".svg#",t.icon,"")}}function U2e(n,e){if(1&n){const t=zo();Wt(0,"div",6),Rs(1,N2e,3,3,"div",7),Wt(2,"h5",8),ki(3),un(),Wt(4,"button",9),mi("click",function(){pi(t);const r=pr();return fi(r.showBody=!r.showBody)}),Fr(),Wt(5,"svg"),Er(6,"use",10),un()()()}if(2&n){const t=pr();jn("ngClass",jd(4,F2e,t.showBody)),F(),jn("ngIf",t.icon),F(2),_A(t.overlayTitle),F(),jn("ngClass",jd(6,O2e,t.showBody))}}function z2e(n,e){if(1&n&&(Wt(0,"div",12),ou(1),un()),2&n){const t=pr();jn("ngClass",jd(1,L2e,t.transparentBody))}}function H2e(n,e){if(1&n){const t=zo();Wt(0,"span",13,1),mi("cdkDragMoved",function(){return pi(t),fi(pr().onResize())}),un()}2&n&&jn("hidden",!pr().showBody)}let cM=(()=>{class n{overlayTitle;active=!1;icon;resizable=!1;transparentBody=!1;keepAspectRatioFixed=!1;showBody=!0;aspectRatio=window.innerWidth/window.innerHeight;overlayCard;resizeHandleCorner;MIN_RES_WIDTH=300;MIN_RES_HEIGHT=100;ngAfterViewInit(){if(this.resizable){const t=this.resizeHandleCorner.nativeElement;t.style.bottom="0",t.style.right="0",new h2e.ResizeSensor(this.overlayCard.nativeElement,()=>{this.resetHandlePosition()}),window.addEventListener("resize",()=>{this.resetHandlePosition()})}}onResize(){const i=this.overlayCard.nativeElement,r=this.resizeHandleCorner.nativeElement.getBoundingClientRect(),s=i.getBoundingClientRect(),o=r.left-s.left+r.width,l=r.top-s.top+r.height;this.setHandleTransform(s,r),o>this.MIN_RES_WIDTH&&l>this.MIN_RES_HEIGHT&&(i.style.width=o+"px",i.style.height=this.keepAspectRatioFixed?o/this.aspectRatio+30+"px":l+"px")}resetHandlePosition(){const t=this.resizeHandleCorner.nativeElement;this.setHandleTransform(this.overlayCard.nativeElement.getBoundingClientRect(),t.getBoundingClientRect()),t.style.bottom=null,t.style.right=null}setHandleTransform(t,i){this.resizeHandleCorner.nativeElement.style.transform=`translate3d(${t.width-i.width}px, ${t.height-i.height}px, 0)`}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=wr({type:n,selectors:[["app-overlay"]],viewQuery:function(i,r){if(1&i&&(ul(P2e,5),ul(R2e,5)),2&i){let s;ia(s=ra())&&(r.overlayCard=s.first),ia(s=ra())&&(r.resizeHandleCorner=s.first)}},inputs:{overlayTitle:"overlayTitle",active:"active",icon:"icon",resizable:"resizable",transparentBody:"transparentBody",keepAspectRatioFixed:"keepAspectRatioFixed"},ngContentSelectors:k2e,decls:5,vars:4,consts:[["overlayCard",""],["resizeHandleCorner",""],["cdkDrag","","cdkDragBoundary","body",1,"overlay-card","card",3,"hidden"],["class","card-header d-flex justify-content-between","cdkDragHandle","",3,"ngClass",4,"ngIf"],["class","overlay-card-content",3,"ngClass",4,"ngIf"],["class","resize-handle corner","cdkDrag","",3,"hidden","cdkDragMoved",4,"ngIf"],["cdkDragHandle","",1,"card-header","d-flex","justify-content-between",3,"ngClass"],["class","align-self-center card-icon",4,"ngIf"],[1,"align-self-center","m-0","px-2"],["matTooltip","Expand / Collapse","matTooltipPosition","right",1,"align-self-center","card-icon","btn-blank","expandCollapse",3,"click","ngClass"],["href","assets/icons/expand.svg#expand"],[1,"align-self-center","card-icon"],[1,"overlay-card-content",3,"ngClass"],["cdkDrag","",1,"resize-handle","corner",3,"cdkDragMoved","hidden"]],template:function(i,r){1&i&&(xd(),Wt(0,"div",2,0),Rs(2,U2e,7,8,"div",3)(3,z2e,2,3,"div",4)(4,H2e,2,1,"span",5),un()),2&i&&(jn("hidden",!r.active),F(2),jn("ngIf",r.overlayTitle),F(),jn("ngIf",r.showBody),F(),jn("ngIf",r.resizable))},dependencies:[Mg,Wd,s6,kY,my],styles:[".overlay-card.card{color:var(--phoenix-text-color);background:none;max-width:100vw;font-size:12px;min-width:300px;height:100%;max-height:70vh;box-shadow:none;border:none;position:relative;z-index:200}.overlay-card.card .card-header{width:12rem;background:var(--phoenix-background-color-secondary);box-shadow:var(--phoenix-box-shadow);padding:.4rem .8rem;border-radius:10px;border:none;cursor:move;text-align:center;transition:all .2s}.overlay-card.card .card-header.with-body{border-bottom-left-radius:0;border-bottom-right-radius:0}.overlay-card.card .card-header .card-icon{display:flex;height:.7rem;width:.7rem}.overlay-card.card .card-header h5{font-size:.9rem}.overlay-card.card .card-header .expandCollapse{cursor:pointer;transition:all .2s}.overlay-card.card .card-header .expandCollapse.expand{transform:scaleY(-1)}.overlay-card.card .card-header .expandCollapse svg{width:100%;height:100%}.overlay-card.card .overlay-card-content{background:var(--phoenix-background-color-secondary);box-shadow:var(--phoenix-box-shadow);border-radius:0 10px 10px;overflow:auto;height:100%}.overlay-card.card .overlay-card-content.transparent-bg{background:none}.overlay-card.card .list-group{color:var(--phoenix-text-color-secondary);background:var(--phoenix-background-color-secondary);max-height:40vh;overflow:auto}.overlay-card.card .list-group .list-group-item{background-color:var(--phoenix-background-color-secondary);border-color:var(--phoenix-border)}.overlay-card.card .resize-handle{width:1rem;height:1rem;cursor:nwse-resize;position:absolute}.overlay-card.card .resize-handle.corner{border-right:.2rem solid var(--phoenix-text-color);border-bottom:.2rem solid var(--phoenix-text-color)}\n"],encapsulation:2})}return n})();const V2e=(n,e,t)=>({"active-object":n,"is-cut":e,"d-none":t});function G2e(n,e){if(1&n&&(Wt(0,"option",15),ki(1),un()),2&n){const t=e.$implicit;jn("value",t),F(),dl(" ",t," ")}}function q2e(n,e){if(1&n){const t=zo();Wt(0,"mat-checkbox",16),mi("change",function(r){return pi(t),fi(pr(3).toggleInvisible(r.checked))}),ki(1," Hide Invisible Objects "),un()}}function Q2e(n,e){if(1&n){const t=zo();Wt(0,"div",7)(1,"div",8)(2,"span"),ki(3,"Choose a collection: "),un(),Wt(4,"div",9)(5,"label",10),ki(6,"Event"),un(),Wt(7,"select",11),mi("change",function(r){return pi(t),fi(pr(2).changeCollection(r.target.value))}),Wt(8,"option",12),ki(9,"Choose Collection"),un(),Rs(10,G2e,2,2,"option",13),un()(),Rs(11,q2e,2,0,"mat-checkbox",14),un()()}if(2&n){const t=pr(2);F(10),jn("ngForOf",t.collections),F(),jn("ngIf",t.showingCollection)}}function j2e(n,e){if(1&n){const t=zo();Wt(0,"th")(1,"div",20)(2,"div"),ki(3),un(),Wt(4,"div",21)(5,"button",22),mi("click",function(){const r=pi(t).$implicit;return fi(pr(3).sort(r,"dec"))}),Fr(),Wt(6,"svg"),Er(7,"use",23),un()(),vo(),Wt(8,"button",24),mi("click",function(){const r=pi(t).$implicit;return fi(pr(3).sort(r,"asc"))}),Fr(),Wt(9,"svg"),Er(10,"use",23),un()()()()()}if(2&n){const t=e.$implicit,i=pr(3);F(3),dl(" ",i.getPrettySymbol(t)," ")}}function W2e(n,e){if(1&n){const t=zo();Wt(0,"div",33)(1,"button",34),mi("click",function(){pi(t);const r=pr().$implicit;return fi(pr(3).lookAtObject(r.uuid))}),Fr(),Wt(2,"svg"),Er(3,"use",35),un()(),vo(),Wt(4,"button",36),mi("click",function(){pi(t);const r=pr().$implicit;return fi(pr(3).highlightObject(r.uuid))}),Fr(),Wt(5,"svg"),Er(6,"use",37),un()()()}}function $2e(n,e){if(1&n&&(Wt(0,"td"),ki(1),un()),2&n){const t=e.$implicit,i=pr().$implicit;F(),dl(" ",i[t]," ")}}function X2e(n,e){if(1&n){const t=zo();Wt(0,"tr",25)(1,"td"),ki(2),un(),Wt(3,"td"),Rs(4,W2e,7,0,"div",26),un(),Wt(5,"td")(6,"div",27)(7,"div",28),Er(8,"input",29),un(),Wt(9,"div",30)(10,"button",31),mi("click",function(){const r=pi(t),s=r.$implicit,o=r.index;return fi(pr(3).addLabel(o,s.uuid))}),Fr(),Wt(11,"svg"),Er(12,"use",32),un()()()()(),Rs(13,$2e,2,1,"td",18),un()}if(2&n){const t=e.$implicit,i=e.index,r=pr(3);jn("ngClass",P9(7,V2e,r.activeObject&&r.activeObject.value===t.uuid,t.isCut,t.isCut&&r.hideInvisible)),ja("id",t.uuid),F(2),dl("#",i,""),F(2),jn("ngIf",t.uuid),F(4),pk("value",t.labelText),jn("id","label"+i),F(5),jn("ngForOf",r.collectionColumns)}}function Y2e(n,e){if(1&n&&(Wt(0,"table",17)(1,"thead")(2,"tr")(3,"th"),ki(4,"No."),un(),Wt(5,"th"),ki(6,"Selection"),un(),Wt(7,"th"),ki(8,"Label"),un(),Rs(9,j2e,11,1,"th",18),un()(),Wt(10,"tbody"),Rs(11,X2e,14,11,"tr",19),un()()),2&n){const t=pr(2);F(9),jn("ngForOf",t.collectionColumns),F(2),jn("ngForOf",t.showingCollection)}}function K2e(n,e){1&n&&(Wt(0,"p",38),ki(1," Load event data to be able to display information about the collections here. "),un())}function Z2e(n,e){if(1&n&&(Wt(0,"div",2),Rs(1,Q2e,12,2,"div",3),Wt(2,"div",4),Rs(3,Y2e,12,2,"table",5)(4,K2e,2,0,"p",6),un()()),2&n){const t=pr();F(),jn("ngIf",null!=t.collections),F(2),jn("ngIf",t.showingCollection),F(),jn("ngIf",!t.collections)}}let LY=(()=>{class n{elementRef;eventDisplay;showObjectsInfo;hideInvisible;collections;selectedCollection;showingCollection;collectionColumns;getPrettySymbol=rv.getPrettySymbol;activeObject;constructor(t,i){this.elementRef=t,this.eventDisplay=i}ngOnInit(){this.eventDisplay.listenToDisplayedEventChange(t=>this.collections=this.eventDisplay.getCollections()),this.activeObject=this.eventDisplay.getActiveObjectId(),this.activeObject.onUpdate(t=>{document.getElementById(t)&&document.getElementById(t).scrollIntoView(!1)})}changeCollection(t){const i=this.getEventDataGroup();this.selectedCollection=t,this.showingCollection=this.eventDisplay.getCollection(t).map(r=>({...r,isCut:!i.getObjectByProperty("uuid",r.uuid)?.visible})),this.collectionColumns=Object.keys(this.showingCollection[0]).filter(r=>!["uuid","hits","isCut","labelText"].includes(r))}sort(t,i){this.showingCollection.sort("asc"===i?(r,s)=>r[t]<s[t]?-1:1:(r,s)=>r[t]>s[t]?-1:1)}lookAtObject(t){t&&(this.activeObject.update(t),this.eventDisplay.lookAtObject(t))}highlightObject(t){t&&(this.activeObject.update(t),this.eventDisplay.highlightObject(t))}enableHighlighting(){this.eventDisplay.enableHighlighting()}disableHighlighting(){this.eventDisplay.disableHighlighting()}toggleInvisible(t){this.hideInvisible=t}addLabel(t,i){const r=this.elementRef.nativeElement.querySelector(`#label${t}`).value;this.selectedCollection&&this.eventDisplay.addLabelToObject(r,this.selectedCollection,t,i)}getEventDataGroup(){return this.eventDisplay.getThreeManager().getSceneManager().getScene().getObjectByName(el.EVENT_DATA_ID)}static \u0275fac=function(i){return new(i||n)(Q(ro),Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-collections-info-overlay"]],inputs:{showObjectsInfo:"showObjectsInfo"},decls:2,vars:3,consts:[["overlayTitle","Collections Info","icon","info",3,"resizable","active"],["class","collectionsInfo m-2",4,"ngIf"],[1,"collectionsInfo","m-2"],["class","collectionSelector mb-2 d-flex align-items-center",4,"ngIf"],[1,"boxBody","table-responsive"],["id","collectionTable","class","table table-borderless table-sm",4,"ngIf"],["class","emptyBox",4,"ngIf"],[1,"collectionSelector","mb-2","d-flex","align-items-center"],[1,"d-flex","align-items-center"],[1,"eventSelector"],["for","event"],["id","collection","name","collection",3,"change"],["value","","selected","","disabled","","hidden",""],[3,"value",4,"ngFor","ngForOf"],[3,"change",4,"ngIf"],[3,"value"],[3,"change"],["id","collectionTable",1,"table","table-borderless","table-sm"],[4,"ngFor","ngForOf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"head-wrapper"],[1,"sort-options"],[1,"icon-wrapper","icon-button","btn-blank","up",3,"click"],["href","assets/icons/expand.svg#expand"],[1,"icon-wrapper","icon-button","btn-blank",3,"click"],[3,"ngClass"],["class","row justify-content-center icon-wrapper",4,"ngIf"],[1,"row","m-0","add-label"],[1,"col-10","p-0"],["type","text",1,"form-control","form-control-sm",3,"value","id"],[1,"col-2","p-0","pl-2","text-center","icon-wrapper"],["matTooltip","Add, update or remove object label",1,"object-select","btn-blank",3,"click"],["href","assets/icons/update.svg#update"],[1,"row","justify-content-center","icon-wrapper"],["matTooltip","Move camera to object",1,"object-select","btn-blank",3,"click"],["href","assets/icons/views.svg#views"],["matTooltip","Highlight object",1,"object-select","btn-blank",3,"click"],["href","assets/icons/cursor.svg#cursor"],[1,"emptyBox"]],template:function(i,r){1&i&&(Wt(0,"app-overlay",0),Rs(1,Z2e,5,3,"div",1),un()),2&i&&(jn("resizable",!0)("active",r.showObjectsInfo),F(),jn("ngIf",r.showObjectsInfo))},dependencies:[Mg,pm,Wd,my,oM,aM,mv,cM],styles:[".collectionsInfo[_ngcontent-%COMP%]{height:95%}.collectionsInfo[_ngcontent-%COMP%]   .collectionSelector[_ngcontent-%COMP%]{height:15%;min-height:2rem}.collectionsInfo[_ngcontent-%COMP%]   .collectionSelector[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary);margin-right:1rem}.collectionsInfo[_ngcontent-%COMP%]   .collectionSelector[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{margin-left:1rem}.boxBody[_ngcontent-%COMP%]{height:85%;overflow:scroll}.boxBody[_ngcontent-%COMP%]   p.emptyBox[_ngcontent-%COMP%]{max-width:21em}.boxBody[_ngcontent-%COMP%]   .add-label[_ngcontent-%COMP%]{min-width:8rem}.boxBody[_ngcontent-%COMP%]   .add-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.1rem .3rem;font-size:.75rem}#collectionTable[_ngcontent-%COMP%]{position:relative;color:var(--phoenix-text-color-secondary)}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:100;background:var(--phoenix-background-color-secondary)}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]{display:flex;flex-direction:row}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;width:1rem;height:1rem;padding:.2rem}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]   .icon-wrapper.up[_ngcontent-%COMP%]{transform:rotate(180deg)}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%}#collectionTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{padding-right:1.2rem}#collectionTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:last-child{padding-right:0}#collectionTable[_ngcontent-%COMP%]   tr.is-cut[_ngcontent-%COMP%]{opacity:.5}#collectionTable[_ngcontent-%COMP%]   tr.active-object[_ngcontent-%COMP%]{color:var(--phoenix-background-color);background:var(--phoenix-text-color);box-shadow:0 0 15px var(--phoenix-text-color)}#collectionTable[_ngcontent-%COMP%]   tr.active-object[_ngcontent-%COMP%]   div.icon-wrapper[_ngcontent-%COMP%]{--phoenix-options-icon-path: var(--phoenix-background-color);--phoenix-options-icon-bg: var(--phoenix-text-color-hover)}#collectionTable[_ngcontent-%COMP%]   tr.active-object[_ngcontent-%COMP%]   .add-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{--phoenix-text-color: var(--phoenix-background-color);--phoenix-background-color-tertiary: var( --phoenix-text-color-secondary );--phoenix-border: var(--phoenix-background-color)}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]{position:relative;width:1.6rem;height:1.6rem;margin-right:.4em;text-align:center;background-color:var(--phoenix-options-icon-bg);border-radius:10px;cursor:pointer}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]:last-child{margin-right:0}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]:hover{border:1px solid var(--phoenix-options-icon-path)}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:absolute;top:0;left:0;padding:.4rem;width:100%;height:100%;vertical-align:top}.eventSelector[_ngcontent-%COMP%]{display:flex}.eventSelector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none;color:var(--phoenix-text-color-secondary)}.eventSelector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:9rem;padding:5px 10px;font-size:12px;border:1px solid rgba(88,88,88,.08);box-shadow:var(--phoenix-icon-shadow);background-color:var(--phoenix-background-color-tertiary);color:var(--phoenix-text-color-secondary)}"]})}return n})(),a6=(()=>{class n{overlay;showObjectsInfo=!1;overlayWindow;constructor(t){this.overlay=t}ngOnInit(){const t=this.overlay.create(),i=new hy(LY);this.overlayWindow=t.attach(i),this.overlayWindow.instance.showObjectsInfo=this.showObjectsInfo}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.showObjectsInfo=!this.showObjectsInfo,this.overlayWindow.instance.showObjectsInfo=this.showObjectsInfo,this.showObjectsInfo?this.overlayWindow.instance.enableHighlighting():this.overlayWindow.instance.disableHighlighting()}static \u0275fac=function(i){return new(i||n)(Q(fu))};static \u0275cmp=wr({type:n,selectors:[["app-collections-info"]],decls:1,vars:1,consts:[["tooltip","Event data collections info","icon","info",3,"click","active"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.toggleOverlay()}),un()),2&i&&jn("active",r.showObjectsInfo)},dependencies:[Hc]})}return n})();const J2e=n=>({"active-object":n});function eCe(n,e){if(1&n&&(Wt(0,"option",13),ki(1),un()),2&n){const t=e.$implicit;jn("value",t.name),F(),dl(" ",t.name," ")}}function tCe(n,e){if(1&n){const t=zo();Wt(0,"div",7)(1,"div",8)(2,"span"),ki(3,"Choose a collection: "),un(),Wt(4,"div",9)(5,"select",10),mi("change",function(r){return pi(t),fi(pr(2).changeCollection(r.target.value))}),Wt(6,"option",11),ki(7,"Choose Collection"),un(),Rs(8,eCe,2,2,"option",12),un()()()()}if(2&n){const t=pr(2);F(8),jn("ngForOf",t.children)}}function nCe(n,e){if(1&n){const t=zo();Wt(0,"div",18)(1,"button",19),mi("click",function(){pi(t);const r=pr().$implicit;return fi(pr(3).lookAtObject(r.uuid))}),Fr(),Wt(2,"svg"),Er(3,"use",20),un()(),vo(),Wt(4,"button",21),mi("click",function(){pi(t);const r=pr().$implicit;return fi(pr(3).highlightObject(r.uuid))}),Fr(),Wt(5,"svg"),Er(6,"use",22),un()()()}}function iCe(n,e){if(1&n&&(Wt(0,"tr",16)(1,"td"),ki(2),un(),Wt(3,"td"),Rs(4,nCe,7,0,"div",17),un()()),2&n){const t=e.$implicit,i=e.index,r=pr(3);jn("ngClass",jd(4,J2e,r.activeObject&&r.activeObject.value===t.uuid)),ja("id",t.uuid),F(2),dl("#",i,""),F(2),jn("ngIf",t.uuid)}}function rCe(n,e){if(1&n&&(Wt(0,"table",14)(1,"thead")(2,"tr")(3,"th"),ki(4,"No."),un(),Wt(5,"th"),ki(6,"Selection"),un()()(),Wt(7,"tbody"),Rs(8,iCe,5,6,"tr",15),un()()),2&n){const t=pr(2);F(8),jn("ngForOf",t.showingCollection)}}function sCe(n,e){1&n&&(Wt(0,"p",23),ki(1," Load event data to be able to display information about the collections here. "),un())}function oCe(n,e){if(1&n&&(Wt(0,"div",2),Rs(1,tCe,9,1,"div",3),Wt(2,"div",4),Rs(3,rCe,9,1,"table",5)(4,sCe,2,0,"p",6),un()()),2&n){const t=pr();F(),jn("ngIf",null!=t.children),F(2),jn("ngIf",t.showingCollection),F(),jn("ngIf",!t.children)}}let NY=(()=>{class n{eventDisplay;browseDetectorParts;selectedCollection;showingCollection;activeObject;children;constructor(t){this.eventDisplay=t}ngOnInit(){this.children=this.eventDisplay.getThreeManager().getSceneManager().getGeometries().children,this.activeObject=this.eventDisplay.getActiveObjectId(),this.activeObject.onUpdate(t=>{document.getElementById(t)&&document.getElementById(t).scrollIntoView(!1)})}changeCollection(t){this.selectedCollection=t;for(const i of this.children)if(i.name===this.selectedCollection){this.showingCollection=i.children;break}}lookAtObject(t){t&&(this.activeObject.update(t),this.eventDisplay.lookAtObject(t,!0))}highlightObject(t){t&&(this.activeObject.update(t),this.eventDisplay.highlightObject(t,!0))}enableHighlighting(){this.eventDisplay.enableHighlighting()}disableHighlighting(){this.eventDisplay.disableHighlighting()}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-geometry-browser-overlay"]],inputs:{browseDetectorParts:"browseDetectorParts"},decls:2,vars:3,consts:[["overlayTitle","Browse Display","icon","info",3,"resizable","active"],["class","collectionsInfo m-2",4,"ngIf"],[1,"collectionsInfo","m-2"],["class","collectionSelector mb-2 d-flex align-items-center",4,"ngIf"],[1,"boxBody","table-responsive"],["id","collectionTable","class","table table-borderless table-sm",4,"ngIf"],["class","emptyBox",4,"ngIf"],[1,"collectionSelector","mb-2","d-flex","align-items-center"],[1,"d-flex","align-items-center"],[1,"eventSelector"],["id","detectorCollection","name","detectorCollection",3,"change"],["value","","selected","","disabled","","hidden",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["id","collectionTable",1,"table","table-borderless","table-sm"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["class","row justify-content-center icon-wrapper",4,"ngIf"],[1,"row","justify-content-center","icon-wrapper"],["matTooltip","Move camera to object",1,"object-select","btn-blank",3,"click"],["href","assets/icons/views.svg#views"],["matTooltip","Highlight object",1,"object-select","btn-blank",3,"click"],["href","assets/icons/cursor.svg#cursor"],[1,"emptyBox"]],template:function(i,r){1&i&&(Wt(0,"app-overlay",0),Rs(1,oCe,5,3,"div",1),un()),2&i&&(jn("resizable",!0)("active",r.browseDetectorParts),F(),jn("ngIf",r.browseDetectorParts))},dependencies:[Mg,pm,Wd,my,oM,aM,cM],styles:[".collectionsInfo[_ngcontent-%COMP%]{height:95%}.collectionsInfo[_ngcontent-%COMP%]   .collectionSelector[_ngcontent-%COMP%]{height:15%;min-height:2rem}.collectionsInfo[_ngcontent-%COMP%]   .collectionSelector[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary);margin-right:1rem}.boxBody[_ngcontent-%COMP%]{height:85%;overflow:scroll}.boxBody[_ngcontent-%COMP%]   p.emptyBox[_ngcontent-%COMP%]{max-width:21em}#collectionTable[_ngcontent-%COMP%]{position:relative;color:var(--phoenix-text-color-secondary)}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:100;background:var(--phoenix-background-color-secondary)}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-right:10px;margin-left:-92px}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;width:1rem;height:1rem;padding:.2rem}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%}#collectionTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{padding-right:1.2rem}#collectionTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:last-child{padding-right:0}#collectionTable[_ngcontent-%COMP%]   tr.active-object[_ngcontent-%COMP%]{color:var(--phoenix-background-color);background:var(--phoenix-text-color);box-shadow:0 0 15px var(--phoenix-text-color)}#collectionTable[_ngcontent-%COMP%]   tr.active-object[_ngcontent-%COMP%]   div.icon-wrapper[_ngcontent-%COMP%]{--phoenix-options-icon-path: var(--phoenix-background-color);--phoenix-options-icon-bg: var(--phoenix-text-color-hover)}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]{position:relative;width:1.6rem;height:1.6rem;margin-right:.4em;text-align:center;background-color:var(--phoenix-options-icon-bg);border-radius:10px;cursor:pointer}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]:last-child{margin-right:0}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]:hover{border:1px solid var(--phoenix-options-icon-path)}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:absolute;top:0;left:0;padding:.4rem;width:100%;height:100%;vertical-align:top}.eventSelector[_ngcontent-%COMP%]{display:flex}.eventSelector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none;color:var(--phoenix-text-color-secondary)}.eventSelector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:9rem;padding:5px 10px;font-size:12px;border:1px solid rgba(88,88,88,.08);box-shadow:var(--phoenix-icon-shadow);background-color:var(--phoenix-background-color-tertiary);color:var(--phoenix-text-color-secondary)}"]})}return n})(),UY=(()=>{class n{overlay;browseDetectorParts=!1;overlayWindow;constructor(t){this.overlay=t}ngOnInit(){const t=this.overlay.create(),i=new hy(NY);this.overlayWindow=t.attach(i),this.overlayWindow.instance.browseDetectorParts=this.browseDetectorParts}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.browseDetectorParts=!this.browseDetectorParts,this.overlayWindow.instance.browseDetectorParts=this.browseDetectorParts,this.browseDetectorParts?this.overlayWindow.instance.enableHighlighting():this.overlayWindow.instance.disableHighlighting()}static \u0275fac=function(i){return new(i||n)(Q(fu))};static \u0275cmp=wr({type:n,selectors:[["app-geometry-browser"]],decls:1,vars:1,consts:[["tooltip","Browse geometry","icon","info",3,"click","active"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.toggleOverlay()}),un()),2&i&&jn("active",r.browseDetectorParts)},dependencies:[Hc]})}return n})();function aCe(n,e){}class mP{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}}let zY=(()=>{class n extends wN{constructor(t,i,r,s,o,l,h,u){super(),this._elementRef=t,this._focusTrapFactory=i,this._config=s,this._interactivityChecker=o,this._ngZone=l,this._overlayRef=h,this._focusMonitor=u,this._platform=oi(uh),this._focusTrap=null,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._ariaLabelledByQueue=[],this._changeDetectorRef=oi(Ac),this._injector=oi(Dr),this._isDestroyed=!1,this.attachDomPortal=f=>{this._portalOutlet.hasAttached();const y=this._portalOutlet.attachDomPortal(f);return this._contentAttached(),y},this._document=r,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(t){this._ariaLabelledByQueue.push(t),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(t){const i=this._ariaLabelledByQueue.indexOf(t);i>-1&&(this._ariaLabelledByQueue.splice(i,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._isDestroyed=!0,this._restoreFocus()}attachComponentPortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachComponentPortal(t);return this._contentAttached(),i}attachTemplatePortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachTemplatePortal(t);return this._contentAttached(),i}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(t,i){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(i)}_focusByCssSelector(t,i){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,i)}_trapFocus(){this._isDestroyed||AA(()=>{const t=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||t.focus();break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElement()||this._focusDialogContainer();break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}},{injector:this._injector})}_restoreFocus(){const t=this._config.restoreFocus;let i=null;if("string"==typeof t?i=this._document.querySelector(t):"boolean"==typeof t?i=t?this._elementFocusedBeforeDialogWasOpened:null:t&&(i=t),this._config.restoreFocus&&i&&"function"==typeof i.focus){const r=nN(),s=this._elementRef.nativeElement;(!r||r===this._document.body||r===s||s.contains(r))&&(this._focusMonitor?(this._focusMonitor.focusVia(i,this._closeInteractionType),this._closeInteractionType=null):i.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,i=nN();return t===i||t.contains(i)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=nN()))}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(g$),Q(ca,8),Q(mP),Q(pN),Q(ns),Q(XB),Q(cy))};static#t=this.\u0275cmp=wr({type:n,selectors:[["cdk-dialog-container"]],viewQuery:function(i,r){if(1&i&&ul(nM,7),2&i){let s;ia(s=ra())&&(r._portalOutlet=s.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(i,r){2&i&&ja("id",r._config.id||null)("role",r._config.role)("aria-modal",r._config.ariaModal)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null)},standalone:!0,features:[Fo,ah],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(i,r){1&i&&Rs(0,aCe,0,0,"ng-template",0)},dependencies:[nM],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2})}return n})();class l6{constructor(e,t){this.overlayRef=e,this.config=t,this.closed=new Qt,this.disableClose=t.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(i=>{27===i.keyCode&&!this.disableClose&&!eM(i)&&(i.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{!1!==t.closeOnOverlayDetachments&&this.close()})}close(e,t){if(this.containerInstance){const i=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),i.next(e),i.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",t=""){return this.overlayRef.updateSize({width:e,height:t}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}}const HY=new Ai("DialogScrollStrategy",{providedIn:"root",factory:()=>{const n=oi(fu);return()=>n.scrollStrategies.block()}}),lCe=new Ai("DialogData"),cCe=new Ai("DefaultDialogConfig");let uCe=0,VY=(()=>{class n{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(t,i,r,s,o,l){this._overlay=t,this._injector=i,this._defaultOptions=r,this._parentDialog=s,this._overlayContainer=o,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Qt,this._afterOpenedAtThisLevel=new Qt,this._ariaHiddenElements=new Map,this.afterAllClosed=bI(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Mp(void 0))),this._scrollStrategy=l}open(t,i){(i={...this._defaultOptions||new mP,...i}).id=i.id||"cdk-dialog-"+uCe++,i.id&&this.getDialogById(i.id);const s=this._getOverlayConfig(i),o=this._overlay.create(s),l=new l6(o,i),h=this._attachContainer(o,l,i);return l.containerInstance=h,this._attachDialogContent(t,l,h,i),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(l),l.closed.subscribe(()=>this._removeOpenDialog(l,!0)),this.afterOpened.next(l),l}closeAll(){c6(this.openDialogs,t=>t.close())}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){c6(this._openDialogsAtThisLevel,t=>{!1===t.config.closeOnDestroy&&this._removeOpenDialog(t,!1)}),c6(this._openDialogsAtThisLevel,t=>t.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(t){const i=new EN({positionStrategy:t.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,width:t.width,height:t.height,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(i.backdropClass=t.backdropClass),i}_attachContainer(t,i,r){const s=r.injector||r.viewContainerRef?.injector,o=[{provide:mP,useValue:r},{provide:l6,useValue:i},{provide:XB,useValue:t}];let l;r.container?"function"==typeof r.container?l=r.container:(l=r.container.type,o.push(...r.container.providers(r))):l=zY;const h=new hy(l,r.viewContainerRef,Dr.create({parent:s||this._injector,providers:o}),r.componentFactoryResolver);return t.attach(h).instance}_attachDialogContent(t,i,r,s){if(t instanceof ni){const o=this._createInjector(s,i,r,void 0);let l={$implicit:s.data,dialogRef:i};s.templateContext&&(l={...l,..."function"==typeof s.templateContext?s.templateContext():s.templateContext}),r.attachTemplatePortal(new wT(t,null,l,o))}else{const o=this._createInjector(s,i,r,this._injector),l=r.attachComponentPortal(new hy(t,s.viewContainerRef,o,s.componentFactoryResolver));i.componentRef=l,i.componentInstance=l.instance}}_createInjector(t,i,r,s){const o=t.injector||t.viewContainerRef?.injector,l=[{provide:lCe,useValue:t.data},{provide:l6,useValue:i}];return t.providers&&("function"==typeof t.providers?l.push(...t.providers(i,t,r)):l.push(...t.providers)),t.direction&&(!o||!o.get(Rp,null,{optional:!0}))&&l.push({provide:Rp,useValue:{value:t.direction,change:ds()}}),Dr.create({parent:o||s,providers:l})}_removeOpenDialog(t,i){const r=this.openDialogs.indexOf(t);r>-1&&(this.openDialogs.splice(r,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,o)=>{s?o.setAttribute("aria-hidden",s):o.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),i&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const i=t.parentElement.children;for(let r=i.length-1;r>-1;r--){const s=i[r];s!==t&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(fu),Wn(Dr),Wn(cCe,8),Wn(n,12),Wn($B),Wn(HY))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function c6(n,e){let t=n.length;for(;t--;)e(n[t])}let dCe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({providers:[VY],imports:[DT,jB,x$,jB]})}return n})();function fCe(n,e){}class h6{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const u6="mdc-dialog--open",GY="mdc-dialog--opening",qY="mdc-dialog--closing";let QY=(()=>{class n extends zY{constructor(t,i,r,s,o,l,h,u,f){super(t,i,r,s,o,l,h,f),this._animationMode=u,this._animationStateChanged=new os,this._animationsEnabled="NoopAnimations"!==this._animationMode,this._actionSectionCount=0,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?WY(this._config.enterAnimationDuration)??150:0,this._exitAnimationDuration=this._animationsEnabled?WY(this._config.exitAnimationDuration)??75:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(jY,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(GY,u6)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(u6),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(u6),this._animationsEnabled?(this._hostElement.style.setProperty(jY,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(qY)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(t){this._actionSectionCount+=t,this._changeDetectorRef.markForCheck()}_clearAnimationClasses(){this._hostElement.classList.remove(GY,qY)}_waitForAnimationToComplete(t,i){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(i,t)}_requestAnimationFrame(t){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(t):t()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(t){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:t})}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}attachComponentPortal(t){const i=super.attachComponentPortal(t);return i.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),i}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(g$),Q(ca,8),Q(h6),Q(pN),Q(ns),Q(XB),Q(gh,8),Q(cy))};static#t=this.\u0275cmp=wr({type:n,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(i,r){2&i&&(k1("id",r._config.id),ja("aria-modal",r._config.ariaModal)("role",r._config.role)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null),Ka("_mat-animation-noopable",!r._animationsEnabled)("mat-mdc-dialog-container-with-actions",r._actionSectionCount>0))},standalone:!0,features:[Fo,ah],decls:3,vars:0,consts:[[1,"mat-mdc-dialog-inner-container","mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(i,r){1&i&&(Wt(0,"div",0)(1,"div",1),Rs(2,fCe,0,0,"ng-template",2),un()())},dependencies:[nM],styles:['.mat-mdc-dialog-container{width:100%;height:100%;display:block;box-sizing:border-box;max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;outline:0}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 80vw);min-width:var(--mat-dialog-container-min-width, 0)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, 80vw)}}.mat-mdc-dialog-inner-container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;transition:opacity linear var(--mat-dialog-transition-duration, 0ms);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mdc-dialog--closing .mat-mdc-dialog-inner-container{transition:opacity 75ms linear;transform:none}.mdc-dialog--open .mat-mdc-dialog-inner-container{opacity:1}._mat-animation-noopable .mat-mdc-dialog-inner-container{transition:none}.mat-mdc-dialog-surface{display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;width:100%;height:100%;position:relative;overflow-y:auto;outline:0;transform:scale(0.8);transition:transform var(--mat-dialog-transition-duration, 0ms) cubic-bezier(0, 0, 0.2, 1);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;box-shadow:var(--mat-dialog-container-elevation-shadow, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12));border-radius:var(--mdc-dialog-container-shape, var(--mat-app-corner-extra-large, 4px));background-color:var(--mdc-dialog-container-color, var(--mat-app-surface, white))}[dir=rtl] .mat-mdc-dialog-surface{text-align:right}.mdc-dialog--open .mat-mdc-dialog-surface,.mdc-dialog--closing .mat-mdc-dialog-surface{transform:none}._mat-animation-noopable .mat-mdc-dialog-surface{transition:none}.mat-mdc-dialog-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mat-mdc-dialog-title{display:block;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:var(--mat-dialog-headline-padding, 0 24px 9px)}.mat-mdc-dialog-title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mat-mdc-dialog-title{text-align:right}.mat-mdc-dialog-container .mat-mdc-dialog-title{color:var(--mdc-dialog-subhead-color, var(--mat-app-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mdc-dialog-subhead-font, var(--mat-app-headline-small-font, inherit));line-height:var(--mdc-dialog-subhead-line-height, var(--mat-app-headline-small-line-height, 1.5rem));font-size:var(--mdc-dialog-subhead-size, var(--mat-app-headline-small-size, 1rem));font-weight:var(--mdc-dialog-subhead-weight, var(--mat-app-headline-small-weight, 400));letter-spacing:var(--mdc-dialog-subhead-tracking, var(--mat-app-headline-small-tracking, 0.03125em))}.mat-mdc-dialog-content{display:block;flex-grow:1;box-sizing:border-box;margin:0;overflow:auto;max-height:65vh}.mat-mdc-dialog-content>:first-child{margin-top:0}.mat-mdc-dialog-content>:last-child{margin-bottom:0}.mat-mdc-dialog-container .mat-mdc-dialog-content{color:var(--mdc-dialog-supporting-text-color, var(--mat-app-on-surface-variant, rgba(0, 0, 0, 0.6)));font-family:var(--mdc-dialog-supporting-text-font, var(--mat-app-body-medium-font, inherit));line-height:var(--mdc-dialog-supporting-text-line-height, var(--mat-app-body-medium-line-height, 1.5rem));font-size:var(--mdc-dialog-supporting-text-size, var(--mat-app-body-medium-size, 1rem));font-weight:var(--mdc-dialog-supporting-text-weight, var(--mat-app-body-medium-weight, 400));letter-spacing:var(--mdc-dialog-supporting-text-tracking, var(--mat-app-body-medium-tracking, 0.03125em))}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0);padding:var(--mat-dialog-actions-padding, 8px);justify-content:var(--mat-dialog-actions-alignment, start)}.cdk-high-contrast-active .mat-mdc-dialog-actions{border-top-color:CanvasText}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}.mat-mdc-dialog-component-host{display:contents}'],encapsulation:2})}return n})();const jY="--mat-dialog-transition-duration";function WY(n){return null==n?null:"number"==typeof n?n:n.endsWith("ms")?Cx(n.substring(0,n.length-2)):n.endsWith("s")?1e3*Cx(n.substring(0,n.length-1)):"0"===n?0:null}var AP=function(n){return n[n.OPEN=0]="OPEN",n[n.CLOSING=1]="CLOSING",n[n.CLOSED=2]="CLOSED",n}(AP||{});class Px{constructor(e,t,i){this._ref=e,this._containerInstance=i,this._afterOpened=new Qt,this._beforeClosed=new Qt,this._state=AP.OPEN,this.disableClose=t.disableClose,this.id=e.id,e.addPanelClass("mat-mdc-dialog-panel"),i._animationStateChanged.pipe(Nc(r=>"opened"===r.state),lh(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),i._animationStateChanged.pipe(Nc(r=>"closed"===r.state),lh(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),Tm(this.backdropClick(),this.keydownEvents().pipe(Nc(r=>27===r.keyCode&&!this.disableClose&&!eM(r)))).subscribe(r=>{this.disableClose||(r.preventDefault(),function $Y(n,e,t){return n._closeInteractionType=e,n.close(t)}(this,"keydown"===r.type?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(Nc(t=>"closing"===t.state),lh(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=AP.CLOSING,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let t=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",t=""){return this._ref.updateSize(e,t),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=AP.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const d6=new Ai("MatMdcDialogData"),ACe=new Ai("mat-mdc-dialog-default-options"),XY=new Ai("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{const n=oi(fu);return()=>n.scrollStrategies.block()}});let _Ce=0,Rx=(()=>{class n{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(t,i,r,s,o,l,h,u){this._overlay=t,this._defaultOptions=s,this._scrollStrategy=o,this._parentDialog=l,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Qt,this._afterOpenedAtThisLevel=new Qt,this.dialogConfigClass=h6,this.afterAllClosed=bI(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Mp(void 0))),this._dialog=i.get(VY),this._dialogRefConstructor=Px,this._dialogContainerType=QY,this._dialogDataToken=d6}open(t,i){let r;(i={...this._defaultOptions||new h6,...i}).id=i.id||"mat-mdc-dialog-"+_Ce++,i.scrollStrategy=i.scrollStrategy||this._scrollStrategy();const s=this._dialog.open(t,{...i,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:i},{provide:mP,useValue:i}]},templateContext:()=>({dialogRef:r}),providers:(o,l,h)=>(r=new this._dialogRefConstructor(o,i,h),r.updatePosition(i?.position),[{provide:this._dialogContainerType,useValue:h},{provide:this._dialogDataToken,useValue:l.data},{provide:this._dialogRefConstructor,useValue:r}])});return r.componentRef=s.componentRef,r.componentInstance=s.componentInstance,this.openDialogs.push(r),this.afterOpened.next(r),r.afterClosed().subscribe(()=>{const o=this.openDialogs.indexOf(r);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||this._getAfterAllClosed().next())}),r}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(t){let i=t.length;for(;i--;)t[i].close()}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(fu),Wn(Dr),Wn(Sb,8),Wn(ACe,8),Wn(XY),Wn(n,12),Wn($B),Wn(gh,8))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),yCe=0,YY=(()=>{class n{constructor(t,i,r){this._dialogRef=t,this._elementRef=i,this._dialog=r}ngOnInit(){this._dialogRef||(this._dialogRef=function KY(n,e){let t=n.nativeElement.parentElement;for(;t&&!t.classList.contains("mat-mdc-dialog-container");)t=t.parentElement;return t?e.find(i=>i.id===t.id):null}(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{this._onAdd()})}ngOnDestroy(){this._dialogRef?._containerInstance&&Promise.resolve().then(()=>{this._onRemove()})}static#e=this.\u0275fac=function(i){return new(i||n)(Q(Px,8),Q(ro),Q(Rx))};static#t=this.\u0275dir=mr({type:n,standalone:!0})}return n})(),zT=(()=>{class n extends YY{constructor(){super(...arguments),this.id="mat-mdc-dialog-title-"+yCe++}_onAdd(){this._dialogRef._containerInstance?._addAriaLabelledBy?.(this.id)}_onRemove(){this._dialogRef?._containerInstance?._removeAriaLabelledBy?.(this.id)}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=yt(n)))(r||n)}})();static#t=this.\u0275dir=mr({type:n,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-mdc-dialog-title","mdc-dialog__title"],hostVars:1,hostBindings:function(i,r){2&i&&k1("id",r.id)},inputs:{id:"id"},exportAs:["matDialogTitle"],standalone:!0,features:[Fo]})}return n})(),HT=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=mr({type:n,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-mdc-dialog-content","mdc-dialog__content"],standalone:!0,features:[wU([G$])]})}return n})(),VT=(()=>{class n extends YY{_onAdd(){this._dialogRef._containerInstance?._updateActionSectionCount?.(1)}_onRemove(){this._dialogRef._containerInstance?._updateActionSectionCount?.(-1)}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=yt(n)))(r||n)}})();static#t=this.\u0275dir=mr({type:n,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-mdc-dialog-actions","mdc-dialog__actions"],hostVars:6,hostBindings:function(i,r){2&i&&Ka("mat-mdc-dialog-actions-align-start","start"===r.align)("mat-mdc-dialog-actions-align-center","center"===r.align)("mat-mdc-dialog-actions-align-end","end"===r.align)},inputs:{align:"align"},standalone:!0,features:[Fo]})}return n})();let bCe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({providers:[Rx],imports:[dCe,DT,jB,zh,zh]})}return n})();const xCe=["mat-button",""],wCe=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],CCe=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],TCe=new Ai("MAT_BUTTON_CONFIG"),DCe=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}];let JY=(()=>{class n{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(t){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,t)}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=t,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._updateRippleDisabled()}constructor(t,i,r,s){this._elementRef=t,this._platform=i,this._ngZone=r,this._animationMode=s,this._focusMonitor=oi(cy),this._rippleLoader=oi(qbe),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;const o=oi(TCe,{optional:!0}),l=t.nativeElement,h=l.classList;this.disabledInteractive=o?.disabledInteractive??!1,this.color=o?.color??null,this._rippleLoader?.configureRipple(l,{className:"mat-mdc-button-ripple"});for(const{attribute:u,mdcClasses:f}of DCe)l.hasAttribute(u)&&h.add(...f)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(t="program",i){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,i):this._elementRef.nativeElement.focus(i)}_getAriaDisabled(){return null!=this.ariaDisabled?this.ariaDisabled:!(!this.disabled||!this.disabledInteractive)||null}_getDisabledAttribute(){return!(this.disabledInteractive||!this.disabled)||null}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static#e=this.\u0275fac=function(i){Me()};static#t=this.\u0275dir=mr({type:n,inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",js],disabled:[2,"disabled","disabled",js],ariaDisabled:[2,"aria-disabled","ariaDisabled",js],disabledInteractive:[2,"disabledInteractive","disabledInteractive",js]},features:[kl]})}return n})(),hM=(()=>{class n extends JY{constructor(t,i,r,s){super(t,i,r,s)}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(uh),Q(ns),Q(gh,8))};static#t=this.\u0275cmp=wr({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(i,r){2&i&&(ja("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),gA(r.color?"mat-"+r.color:""),Ka("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[Fo,ah],attrs:xCe,ngContentSelectors:CCe,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(xd(wCe),Er(0,"span",0),ou(1),Wt(2,"span",1),ou(3,1),un(),ou(4,2),Er(5,"span",2)(6,"span",3)),2&i&&Ka("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mat-mdc-button-base{text-decoration:none}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-text-button-horizontal-padding, 8px);height:var(--mdc-text-button-container-height);font-family:var(--mdc-text-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-text-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-text-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-text-button-label-text-transform);font-weight:var(--mdc-text-button-label-text-weight, var(--mat-app-label-large-weight))}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color, var(--mat-app-primary))}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mat-app-corner-full))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, var(--mat-app-primary))}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-filled-button-horizontal-padding, 16px);height:var(--mdc-filled-button-container-height);font-family:var(--mdc-filled-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-filled-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-filled-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-filled-button-label-text-transform);font-weight:var(--mdc-filled-button-label-text-weight, var(--mat-app-label-large-weight))}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color, var(--mat-app-on-primary))}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, var(--mat-app-on-primary));background-color:var(--mdc-filled-button-container-color, var(--mat-app-primary))}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mat-app-corner-full))}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow, var(--mat-app-level1));height:var(--mdc-protected-button-container-height);font-family:var(--mdc-protected-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-protected-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-protected-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-protected-button-label-text-transform);font-weight:var(--mdc-protected-button-label-text-weight, var(--mat-app-label-large-weight))}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color, var(--mat-app-primary))}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, var(--mat-app-primary));background-color:var(--mdc-protected-button-container-color, var(--mat-app-surface))}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mat-app-corner-full))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow, var(--mat-app-level2))}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow, var(--mat-app-level1))}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow, var(--mat-app-level1))}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow, var(--mat-app-level0))}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-outlined-button-horizontal-padding, 15px);height:var(--mdc-outlined-button-container-height);font-family:var(--mdc-outlined-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-outlined-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-outlined-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-outlined-button-label-text-transform);font-weight:var(--mdc-outlined-button-label-text-weight, var(--mat-app-label-large-weight));border-radius:var(--mdc-outlined-button-container-shape, var(--mat-app-corner-full));border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color, var(--mat-app-primary))}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, var(--mat-app-primary));border-color:var(--mdc-outlined-button-outline-color, var(--mat-app-outline))}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button .mdc-button__ripple{border-width:var(--mdc-outlined-button-outline-width);border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}return n})(),PCe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({imports:[zh,qB,zh]})}return n})();function RCe(n,e){if(1&n){const t=zo();bg(0),Wt(1,"input",29,5),mi("change",function(r){return fi(pi(t).$implicit.handler(r.target.files))}),un(),Wt(3,"button",13),mi("click",function(){return pi(t),fi(Ha(2).click())}),Er(4,"img",30),ki(5),un(),xg()}if(2&n){const t=e.$implicit;F(),jn("accept",t.accept),F(4),dl(" Load ",t.fileType," ")}}function kCe(n,e){if(1&n&&(Wt(0,"div")(1,"p",10)(2,"b"),ki(3,"Event data"),un()(),Wt(4,"div",11),Rs(5,RCe,6,2,"ng-container",28),un()()),2&n){const t=pr();F(5),jn("ngForOf",t.eventDataOptionsWithHandler)}}let eK=(()=>{class n{eventDisplay;dialogRef;eventDataImportOptions=[ef.JSON];eventDataOptionsWithHandler;supportedEventDataFormats=[new xx(ef.JSON,".json",this.handleJSONEventDataInput.bind(this),"application/json"),new xx(ef.EDM4HEPJSON,".edm4hep.json",this.handleEDM4HEPJSONEventDataInput.bind(this),"application/json"),new xx(ef.JIVEXML,".xml",this.handleJiveXMLDataInput.bind(this),"text/xml"),new xx(ef.ZIP,".zip",this.handleZipEventDataInput.bind(this),".zip"),new xx(ef.IG,".ig",this.handleIgEventDataInput.bind(this),".ig")];constructor(t,i){this.eventDisplay=t,this.dialogRef=i}ngOnInit(){this.eventDataOptionsWithHandler=this.supportedEventDataFormats.filter(t=>this.eventDataImportOptions.includes(t.format)),this.eventDataImportOptions.forEach(t=>{if(t instanceof xx){const i=t.handler.bind(this);t.handler=r=>{i(r),this.onClose()},this.eventDataOptionsWithHandler.push(t)}})}getSupportedEventDataFormats(){return this.eventDataImportOptions.map(t=>t instanceof xx?t.format:t).filter(t=>"ZIP"!==t).join(", ")}onClose(){this.dialogRef.close()}handleJSONEventDataInput(t){this.handleFileInput(t[0],"json",r=>{const s="string"==typeof r?JSON.parse(r):r;this.eventDisplay.parsePhoenixEvents(s)})}handleEDM4HEPJSONEventDataInput(t){this.handleFileInput(t[0],"json",r=>{const s="string"==typeof r?JSON.parse(r):r,o=new hve;o.setRawEventData(s),o.processEventData(),this.eventDisplay.parsePhoenixEvents(o.getEventData())})}handleJiveXMLDataInput(t){this.handleFileInput(t[0],"xml",r=>{const s=this.getJiveXMLLoader();s.process(r);const o=s.getEventData();this.eventDisplay.buildEventDataFromJSON(o)})}getJiveXMLLoader(){return this.eventDisplay?.configuration?.eventDataLoader instanceof uv?this.eventDisplay.configuration.eventDataLoader:new uv}handleOBJInput(t){this.handleFileInput(t[0],"obj",(r,s)=>{this.eventDisplay.parseOBJGeometry(r,s)})}handleSceneInput(t){this.handleFileInput(t[0],"phnx",r=>{this.eventDisplay.parsePhoenixDisplay(r)})}handleGLTFInput(t){this.isFileOfExtension(t[0].name,"gltf,glb,gltf.zip,glb.zip")&&(r=>{this.eventDisplay.parseGLTFGeometry(r)})(t[0])}handlePhoenixInput(t){this.handleFileInput(t[0],"phnx",r=>{this.eventDisplay.parsePhoenixDisplay(r)})}handleROOTInput(t){var i=this;return(0,al.A)(function*(){const r=prompt("Enter object name in ROOT file");yield i.eventDisplay.loadRootGeometry(URL.createObjectURL(t[0]),r,t[0].name.split(".")[0]),i.onClose()})()}handleRootJSONInput(t){var i=this;return(0,al.A)(function*(){if(!i.isFileOfExtension(t[0].name,"gz"))return;const r=t[0].name.split(".")[0];yield i.eventDisplay.loadRootJSONGeometry(URL.createObjectURL(t[0]),r),i.onClose()})()}handleIgEventDataInput(t){const i=new YW;i.readIgArchive(t[0],r=>{const s=i.getAllEventsData(r);this.eventDisplay.parsePhoenixEvents(s),this.onClose()})}handleZipEventDataInput(t){var i=this;return(0,al.A)(function*(){if(!i.isFileOfExtension(t[0].name,"zip,json.zip"))return;const r={};let s;try{s=yield XW(t[0])}catch(l){return console.error("Error while reading zip",l),void i.eventDisplay.getInfoLogger().add("Could not read zip file","Error")}Object.keys(s).filter(l=>l.endsWith(".json")).forEach(l=>{Object.assign(r,JSON.parse(s[l]))});const o=i.getJiveXMLLoader();Object.keys(s).filter(l=>l.endsWith(".xml")||l.startsWith("JiveXML")).forEach(l=>{o.process(s[l]);const h=o.getEventData();Object.assign(r,{[l]:h})}),i.eventDisplay.parsePhoenixEvents(r),i.onClose()})()}handleFileInput(t,i,r){const s=new FileReader;this.isFileOfExtension(t.name,i)&&(s.onload=()=>{r(s.result.toString(),t.name.split(".")[0])},s.readAsText(t)),this.onClose()}isFileOfExtension(t,i){return!!i.split(",").includes(t.slice(t.indexOf(".")+1))||(console.error("Error: Invalid file format!"),this.eventDisplay.getInfoLogger().add("Invalid file format!","Error"),!1)}saveScene(){this.eventDisplay.exportPhoenixDisplay()}exportOBJ(){this.eventDisplay.exportToOBJ()}static \u0275fac=function(i){return new(i||n)(Q(ll),Q(Px))};static \u0275cmp=wr({type:n,selectors:[["app-io-options-dialog"]],inputs:{eventDataImportOptions:"eventDataImportOptions"},decls:47,vars:1,consts:[["objFileInput",""],["gltfFileInput",""],["rootFileInput",""],["rootJSONFileInput",""],["loadSceneInput",""],["eventDataFileInput",""],[1,"dialog"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-content"],[4,"ngIf"],[1,"text-center"],[1,"row","centered"],["type","file","tabindex","-1","accept",".obj","name","image",1,"file-input",3,"change"],[1,"file-input-button",3,"click"],["src","assets/icons/obj.svg","alt",""],["type","file","tabindex","-1","accept",".gltf,.glb,.gltf.zip,.glb.zip","name","image",1,"file-input",3,"change"],["src","assets/icons/gltf.svg","alt",""],["type","file","tabindex","-1","accept",".root",1,"file-input",3,"change"],["src","assets/icons/file-import.svg","alt",""],["type","file","tabindex","-1","accept",".json.gz",1,"file-input",3,"change"],["id","exportScene",1,"file-input-button","load-export",3,"click"],["src","assets/icons/save.svg","alt",""],["type","file","tabindex","-1","accept",".phnx","name","image",1,"file-input",3,"change"],["id","importScene",1,"file-input-button","load-export",3,"click"],["src","assets/icons/upload.svg","alt",""],["id","exportOBJ",1,"file-input-button","export-button",3,"click"],["mat-dialog-actions","","align","end"],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"click"],[4,"ngFor","ngForOf"],["type","file","tabindex","-1",1,"file-input",3,"change","accept"],["src","assets/icons/eventData.svg","alt","Event data icon"]],template:function(i,r){if(1&i){const s=zo();Wt(0,"div",6)(1,"h1",7),ki(2,"Import and export"),un(),Wt(3,"div",8),Rs(4,kCe,6,1,"div",9),Wt(5,"p",10)(6,"b"),ki(7,"Geometries"),un()(),Wt(8,"div",11)(9,"input",12,0),mi("change",function(l){return pi(s),fi(r.handleOBJInput(l.target.files))}),un(),Wt(11,"button",13),mi("click",function(){return pi(s),fi(Ha(10).click())}),Er(12,"img",14),ki(13," Load .obj "),un(),Wt(14,"input",15,1),mi("change",function(l){return pi(s),fi(r.handleGLTFInput(l.target.files))}),un(),Wt(16,"button",13),mi("click",function(){return pi(s),fi(Ha(15).click())}),Er(17,"img",16),ki(18," Load .gltf/.glb "),un(),Wt(19,"input",17,2),mi("change",function(l){return pi(s),fi(r.handleROOTInput(l.target.files))}),un(),Wt(21,"button",13),mi("click",function(){return pi(s),fi(Ha(20).click())}),Er(22,"img",18),ki(23," Load .root "),un(),Wt(24,"input",19,3),mi("change",function(l){return pi(s),fi(r.handleRootJSONInput(l.target.files))}),un(),Wt(26,"button",13),mi("click",function(){return pi(s),fi(Ha(25).click())}),Er(27,"img",18),ki(28," Load .json.gz "),un()(),Wt(29,"p",10)(30,"b"),ki(31,"Scene"),un()(),Wt(32,"div",11)(33,"button",20),mi("click",function(){return pi(s),fi(r.saveScene())}),Er(34,"img",21),ki(35," Save scene "),un(),Wt(36,"input",22,4),mi("change",function(l){return pi(s),fi(r.handlePhoenixInput(l.target.files))}),un(),Wt(38,"button",23),mi("click",function(){return pi(s),fi(Ha(37).click())}),Er(39,"img",24),ki(40," Load scene "),un(),Wt(41,"button",25),mi("click",function(){return pi(s),fi(r.exportOBJ())}),Er(42,"img",14),ki(43," Save OBJ "),un()()(),Wt(44,"div",26)(45,"button",27),mi("click",function(){return pi(s),fi(r.onClose())}),ki(46," Close "),un()()()}2&i&&(F(4),jn("ngIf",r.eventDataImportOptions.length>0))},dependencies:[pm,Wd,zT,VT,HT,hM],styles:[".row[_ngcontent-%COMP%]{justify-content:center;margin:1rem 0}.file-input[_ngcontent-%COMP%]{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}.file-input-button[_ngcontent-%COMP%]{font-size:1em;font-weight:700;color:#fff;background-color:#6eaece;padding:1em .5em;border:none;border-radius:10px;width:8rem;margin:0 .4rem}.file-input-button.load-export[_ngcontent-%COMP%]{padding:.8em .2em;width:7rem}.file-input-button.load-export[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:1.2em}.file-input-button.export-button[_ngcontent-%COMP%]{background-color:#cb7133}.file-input-button.export-button[_ngcontent-%COMP%]:hover{background-color:#ad5b2d}.file-input-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:2em;display:block;width:100%}.file-input-button[_ngcontent-%COMP%]:hover{background-color:#118ab2}#exportScene[_ngcontent-%COMP%]{background-color:#5bd99e}#exportScene[_ngcontent-%COMP%]:hover{background-color:#05c292}#importScene[_ngcontent-%COMP%]{background-color:#ecc25e}#importScene[_ngcontent-%COMP%]:hover{background-color:#d6b44d}"]})}return n})(),f6=(()=>{class n{dialog;eventDataImportOptions=Object.values(ef);constructor(t){this.dialog=t}openIODialog(){this.dialog.open(eK,{panelClass:"dialog"}).componentInstance.eventDataImportOptions=this.eventDataImportOptions}static \u0275fac=function(i){return new(i||n)(Q(Rx))};static \u0275cmp=wr({type:n,selectors:[["app-io-options"]],inputs:{eventDataImportOptions:"eventDataImportOptions"},decls:1,vars:1,consts:[["tooltip","Import and export options","icon","import",3,"click","active"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.openIODialog()}),un()),2&i&&jn("active",!1)},dependencies:[Hc]})}return n})();const FCe=["overlayWindow"];let tK=(()=>{class n{eventDisplay;showOverlay=!0;transparentBody=!1;orthographicView=!1;overlayViewFixed=!1;overlayWindow;constructor(t){this.eventDisplay=t}ngAfterViewInit(){const t=this.initializeCanvas(this.overlayWindow.nativeElement);this.eventDisplay.setOverlayRenderer(t)}initializeCanvas(t){const i=window.innerWidth/2.5,r=window.innerHeight/2.5;return t.width=i,t.height=r,t.style.width=i.toString()+" px",t.style.height=r.toString()+" px",t}switchOverlayView(){this.orthographicView=!this.orthographicView,this.eventDisplay.getUIManager().toggleOrthographicView(this.orthographicView)}fixOverlayView(){this.overlayViewFixed=!this.overlayViewFixed,this.eventDisplay.fixOverlayView(this.overlayViewFixed)}toggleBgTransparency(){this.transparentBody=!this.transparentBody}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-overlay-view-window"]],viewQuery:function(i,r){if(1&i&&ul(FCe,5),2&i){let s;ia(s=ra())&&(r.overlayWindow=s.first)}},inputs:{showOverlay:"showOverlay"},decls:8,vars:9,consts:[["overlayWindow",""],["overlayTitle","Overlay View","icon","overlay",3,"resizable","transparentBody","active","keepAspectRatioFixed"],[1,"overlay-view-wrapper"],["id","overlay-canvas",3,"hidden"],[1,"overlay-view-controls","position-absolute","d-flex","flex-row"],["icon","transparent","matTooltip","Toggle background transparency",1,"overlay-view-control",3,"click"],["icon","move-lock",1,"overlay-view-control",3,"click","matTooltip","active"],[1,"overlay-view-control",3,"click","icon","matTooltip"]],template:function(i,r){if(1&i){const s=zo();Wt(0,"app-overlay",1)(1,"div",2),Er(2,"canvas",3,0),Wt(4,"div",4)(5,"app-menu-toggle",5),mi("click",function(){return pi(s),fi(r.toggleBgTransparency())}),un(),Wt(6,"app-menu-toggle",6),mi("click",function(){return pi(s),fi(r.fixOverlayView())}),un(),Wt(7,"app-menu-toggle",7),mi("click",function(){return pi(s),fi(r.switchOverlayView())}),un()()()()}2&i&&(jn("resizable",!0)("transparentBody",r.transparentBody)("active",r.showOverlay)("keepAspectRatioFixed",!0),F(2),jn("hidden",!r.showOverlay),F(4),jn("matTooltip",(r.overlayViewFixed?"Restore":"Fix")+" overlay view")("active",r.overlayViewFixed),F(),jn("icon",r.orthographicView?"orthographic":"perspective")("matTooltip","Switch to "+(r.orthographicView?"orthographic":"perspective")+" view"))},dependencies:[my,Hc,cM],styles:["#overlay-canvas[_ngcontent-%COMP%]{background-color:#0000001a;width:100%}.overlay-view-controls[_ngcontent-%COMP%]{bottom:1em;right:1em;opacity:0;transition:opacity .2s}.overlay-view-controls[_ngcontent-%COMP%]   .overlay-view-control[_ngcontent-%COMP%]{background:var(--phoenix-background-color-secondary);box-shadow:var(--phoenix-box-shadow);overflow:hidden;width:2.5rem;height:2.5rem;border-radius:50%;display:flex;justify-content:center;align-items:center}.overlay-view-wrapper[_ngcontent-%COMP%]:hover   .overlay-view-controls[_ngcontent-%COMP%]{opacity:1;transition:opacity .2s}"]})}return n})(),p6=(()=>{class n{overlay;overlayWindow;showOverlay=!1;constructor(t){this.overlay=t}ngOnInit(){const t=this.overlay.create(),i=new hy(tK);this.overlayWindow=t.attach(i),this.overlayWindow.instance.showOverlay=this.showOverlay}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.showOverlay=!this.showOverlay,this.overlayWindow.instance.showOverlay=this.showOverlay}static \u0275fac=function(i){return new(i||n)(Q(fu))};static \u0275cmp=wr({type:n,selectors:[["app-overlay-view"]],decls:1,vars:1,consts:[["tooltip","Overlay view","icon","overlay",3,"click","active"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.toggleOverlay()}),un()),2&i&&jn("active",r.showOverlay)},dependencies:[Hc]})}return n})(),nK=(()=>{class n{transform(t,i){let r="";return Array.isArray(t)?(r+="\n",t.forEach(s=>r+=s+"\n")):r=t.toString(),r}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=yl({name:"attributePipe",type:n,pure:!0})}return n})();function OCe(n,e){if(1&n&&(Wt(0,"div",4)(1,"strong"),ki(2),un(),ki(3),WE(4,"attributePipe"),un()),2&n){const t=e.$implicit;F(2),_A(t.attributeName),F(),dl(" : ",function N9(n,e,t){const i=n+Fs,r=gi(),s=im(r,i);return $E(r,i)?R9(r,jl(),e,s.transform,t,s):s.transform(t)}(4,2,t.attributeValue)," ")}}function LCe(n,e){if(1&n&&(Wt(0,"div",2),Rs(1,OCe,5,4,"div",3),un()),2&n){const t=pr();F(),jn("ngForOf",t.selectedObject.attributes)}}let iK=(()=>{class n{eventDisplay;hiddenSelectedInfo;selectedObject={name:"Object",attributes:[]};constructor(t){this.eventDisplay=t}ngOnInit(){this.eventDisplay.allowSelection(this.selectedObject)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-object-selection-overlay"]],inputs:{hiddenSelectedInfo:"hiddenSelectedInfo"},decls:2,vars:3,consts:[["icon","cursor",3,"overlayTitle","active"],["id","selectedObjectPanelBody","class","m-1",4,"ngIf"],["id","selectedObjectPanelBody",1,"m-1"],["class","attributeField",4,"ngFor","ngForOf"],[1,"attributeField"]],template:function(i,r){1&i&&(Wt(0,"app-overlay",0),Rs(1,LCe,2,1,"div",1),un()),2&i&&(jn("overlayTitle",r.selectedObject.name)("active",!r.hiddenSelectedInfo),F(),jn("ngIf",r.selectedObject.attributes.length>0))},dependencies:[pm,Wd,cM,nK],styles:["#selectedObjectPanelBody[_ngcontent-%COMP%]{padding:0 .8em;overflow:auto;max-width:300px;max-height:16rem;min-width:7rem}"]})}return n})(),m6=(()=>{class n{overlay;eventDisplay;hiddenSelectedInfo=!0;overlayWindow;constructor(t,i){this.overlay=t,this.eventDisplay=i}ngOnInit(){const t=this.overlay.create(),i=new hy(iK);this.overlayWindow=t.attach(i),this.overlayWindow.instance.hiddenSelectedInfo=this.hiddenSelectedInfo}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.hiddenSelectedInfo=!this.hiddenSelectedInfo,this.overlayWindow.instance.hiddenSelectedInfo=this.hiddenSelectedInfo,this.eventDisplay.enableSelecting(!this.hiddenSelectedInfo)}static \u0275fac=function(i){return new(i||n)(Q(fu),Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-object-selection"]],decls:1,vars:1,consts:[["tooltip","Object selection","icon","cursor",3,"click","active"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.toggleOverlay()}),un()),2&i&&jn("active",!r.hiddenSelectedInfo)},dependencies:[Hc]})}return n})();function NCe(n,e){if(1&n&&(Wt(0,"option",4),ki(1),un()),2&n){const t=e.$implicit;jn("value",t),F(),dl(" ",t," ")}}function UCe(n,e){if(1&n){const t=zo();Wt(0,"div",1)(1,"select",2),mi("change",function(r){return pi(t),fi(pr().changeEvent(r))}),Rs(2,NCe,2,2,"option",3),un()()}if(2&n){const t=pr();F(2),jn("ngForOf",t.events)}}let A6=(()=>{class n{eventDisplay;events;constructor(t){this.eventDisplay=t}ngOnInit(){this.eventDisplay.listenToLoadedEventsChange(t=>this.events=t)}changeEvent(t){this.eventDisplay.loadEvent(t.target.value)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-event-selector"]],decls:1,vars:1,consts:[["class","eventSelector mx-2","matTooltip","Event selector","matTooltipPosition","above",4,"ngIf"],["matTooltip","Event selector","matTooltipPosition","above",1,"eventSelector","mx-2"],["name","event",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,r){1&i&&Rs(0,UCe,3,1,"div",0),2&i&&jn("ngIf",null!=r.events)},dependencies:[pm,Wd,my,oM,aM],styles:[".eventSelector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:9rem;padding:5px 10px;font-size:12px;border:1px solid rgba(88,88,88,.08);box-shadow:var(--phoenix-icon-shadow);background-color:var(--phoenix-background-color-tertiary);color:var(--phoenix-text-color-secondary)}"]})}return n})();const zCe=["knob"],HCe=["valueIndicatorContainer"];function VCe(n,e){if(1&n&&(Wt(0,"div",2,1)(2,"div",5)(3,"span",6),ki(4),un()()()),2&n){const t=pr();F(4),_A(t.valueIndicatorText)}}const GCe=["trackActive"],qCe=["*"];function QCe(n,e){if(1&n&&Er(0,"div"),2&n){const t=e.$implicit,i=e.$index,r=pr(3);gA(0===t?"mdc-slider__tick-mark--active":"mdc-slider__tick-mark--inactive"),UE("transform",r._calcTickMarkTransform(i))}}function jCe(n,e){1&n&&function ED(n,e,t,i,r,s,o,l,h,u,f,y,T){Of("NgControlFlow");const B=gi(),j=fo(),ne=void 0!==h,se=gi(),le=l?o.bind(se[Pl][hl]):o,Ee=new Cte(ne,le);se[Fs+n]=Ee,kE(B,j,n+1,e,t,i,r,Ql(j.consts,s)),ne&&kE(B,j,n+2,h,u,f,y,Ql(j.consts,T))}(0,QCe,1,4,"div",8,E7),2&n&&function SD(n){const e=Je(null),t=Cr();try{const i=gi(),r=i[vr],s=i[t],o=t+1,l=TD(i,o);if(void 0===s.liveCollection){const u=hk(r,o);s.liveCollection=new Mte(l,i,u)}else s.liveCollection.reset();const h=s.liveCollection;if(function xte(n,e,t){let i,r,s=0,o=n.length-1;if(Array.isArray(e)){let h=e.length-1;for(;s<=o&&s<=h;){const u=n.at(s),f=e[s],y=ak(s,u,s,f,t);if(0!==y){y<0&&n.updateValue(s,f),s++;continue}const T=n.at(o),B=e[h],j=ak(o,T,h,B,t);if(0!==j){j<0&&n.updateValue(o,B),o--,h--;continue}const ne=t(s,u),se=t(o,T),le=t(s,f);if(Object.is(le,se)){const Ee=t(h,B);Object.is(Ee,ne)?(n.swap(s,o),n.updateValue(o,B),h--,o--):n.move(o,s),n.updateValue(s,f),s++}else if(i??=new M7,r??=C7(n,s,o,t),lk(n,i,s,le))n.updateValue(s,f),s++,o++;else if(r.has(le))i.set(ne,n.detach(s)),o--;else{const Ee=n.create(s,e[s]);n.attach(s,Ee),s++,o++}}for(;s<=h;)w7(n,i,t,s,e[s]),s++}else if(null!=e){const h=e[Symbol.iterator]();let u=h.next();for(;!u.done&&s<=o;){const f=n.at(s),y=u.value,T=ak(s,f,s,y,t);if(0!==T)T<0&&n.updateValue(s,y),s++,u=h.next();else{i??=new M7,r??=C7(n,s,o,t);const B=t(s,y);if(lk(n,i,s,B))n.updateValue(s,y),s++,o++,u=h.next();else if(r.has(B)){const j=t(s,f);i.set(j,n.detach(s)),o--}else n.attach(s,n.create(s,y)),s++,o++,u=h.next()}}for(;!u.done;)w7(n,i,t,n.length,u.value),u=h.next()}for(;s<=o;)n.destroy(n.detach(o--));i?.forEach(h=>{n.destroy(h)})}(h,n,s.trackByFn),h.updateIndexes(),s.hasEmptyBlock){const u=Eu(),f=0===h.length;if(Oh(i,u,f)){const y=t+2,T=TD(i,y);if(f){const B=hk(r,y),j=gb(T,B.tView.ssrId);Qo(T,$s(i,B,void 0,{dehydratedView:j}),0,ya(B,j))}else rc(T,0)}}}finally{Je(e)}}(pr(2)._tickMarks)}function WCe(n,e){if(1&n&&(Wt(0,"div",6,1),Rs(2,jCe,2,0),un()),2&n){const t=pr();F(2),U_(t._cachedWidth?2:-1)}}function $Ce(n,e){if(1&n&&Er(0,"mat-slider-visual-thumb",7),2&n){const t=pr();jn("discrete",t.discrete)("thumbPosition",1)("valueIndicatorText",t.startValueIndicatorText)}}var Ho=function(n){return n[n.START=1]="START",n[n.END=2]="END",n}(Ho||{}),uM=function(n){return n[n.ACTIVE=0]="ACTIVE",n[n.INACTIVE=1]="INACTIVE",n}(uM||{});const gP=new Ai("_MatSlider"),rK=new Ai("_MatSliderThumb"),sK=new Ai("_MatSliderRangeThumb"),oK=new Ai("_MatSliderVisualThumb");let XCe=(()=>{class n{constructor(t,i,r,s){this._cdr=t,this._ngZone=i,this._slider=s,this._isHovered=!1,this._isActive=!1,this._isValueIndicatorVisible=!1,this._platform=oi(uh),this._onPointerMove=o=>{if(this._sliderInput._isFocused)return;const l=this._hostElement.getBoundingClientRect(),h=this._slider._isCursorOnSliderThumb(o,l);this._isHovered=h,h?this._showHoverRipple():this._hideRipple(this._hoverRippleRef)},this._onMouseLeave=()=>{this._isHovered=!1,this._hideRipple(this._hoverRippleRef)},this._onFocus=()=>{this._hideRipple(this._hoverRippleRef),this._showFocusRipple(),this._hostElement.classList.add("mdc-slider__thumb--focused")},this._onBlur=()=>{this._isActive||this._hideRipple(this._focusRippleRef),this._isHovered&&this._showHoverRipple(),this._hostElement.classList.remove("mdc-slider__thumb--focused")},this._onDragStart=o=>{0===o.button&&(this._isActive=!0,this._showActiveRipple())},this._onDragEnd=()=>{this._isActive=!1,this._hideRipple(this._activeRippleRef),this._sliderInput._isFocused||this._hideRipple(this._focusRippleRef),this._platform.SAFARI&&this._showHoverRipple()},this._hostElement=r.nativeElement}ngAfterViewInit(){this._ripple.radius=24,this._sliderInput=this._slider._getInput(this.thumbPosition),this._sliderInputEl=this._sliderInput._hostElement;const t=this._sliderInputEl;this._ngZone.runOutsideAngular(()=>{t.addEventListener("pointermove",this._onPointerMove),t.addEventListener("pointerdown",this._onDragStart),t.addEventListener("pointerup",this._onDragEnd),t.addEventListener("pointerleave",this._onMouseLeave),t.addEventListener("focus",this._onFocus),t.addEventListener("blur",this._onBlur)})}ngOnDestroy(){const t=this._sliderInputEl;t&&(t.removeEventListener("pointermove",this._onPointerMove),t.removeEventListener("pointerdown",this._onDragStart),t.removeEventListener("pointerup",this._onDragEnd),t.removeEventListener("pointerleave",this._onMouseLeave),t.removeEventListener("focus",this._onFocus),t.removeEventListener("blur",this._onBlur))}_showHoverRipple(){this._isShowingRipple(this._hoverRippleRef)||(this._hoverRippleRef=this._showRipple({enterDuration:0,exitDuration:0}),this._hoverRippleRef?.element.classList.add("mat-mdc-slider-hover-ripple"))}_showFocusRipple(){this._isShowingRipple(this._focusRippleRef)||(this._focusRippleRef=this._showRipple({enterDuration:0,exitDuration:0},!0),this._focusRippleRef?.element.classList.add("mat-mdc-slider-focus-ripple"))}_showActiveRipple(){this._isShowingRipple(this._activeRippleRef)||(this._activeRippleRef=this._showRipple({enterDuration:225,exitDuration:400}),this._activeRippleRef?.element.classList.add("mat-mdc-slider-active-ripple"))}_isShowingRipple(t){return t?.state===kp.FADING_IN||t?.state===kp.VISIBLE}_showRipple(t,i){if(!this._slider.disabled&&(this._showValueIndicator(),this._slider._isRange&&this._slider._getThumb(this.thumbPosition===Ho.START?Ho.END:Ho.START)._showValueIndicator(),!this._slider._globalRippleOptions?.disabled||i))return this._ripple.launch({animation:this._slider._noopAnimations?{enterDuration:0,exitDuration:0}:t,centered:!0,persistent:!0})}_hideRipple(t){if(t?.fadeOut(),this._isShowingAnyRipple())return;this._slider._isRange||this._hideValueIndicator();const i=this._getSibling();i._isShowingAnyRipple()||(this._hideValueIndicator(),i._hideValueIndicator())}_showValueIndicator(){this._hostElement.classList.add("mdc-slider__thumb--with-indicator")}_hideValueIndicator(){this._hostElement.classList.remove("mdc-slider__thumb--with-indicator")}_getSibling(){return this._slider._getThumb(this.thumbPosition===Ho.START?Ho.END:Ho.START)}_getValueIndicatorContainer(){return this._valueIndicatorContainer?.nativeElement}_getKnob(){return this._knob.nativeElement}_isShowingAnyRipple(){return this._isShowingRipple(this._hoverRippleRef)||this._isShowingRipple(this._focusRippleRef)||this._isShowingRipple(this._activeRippleRef)}static#e=this.\u0275fac=function(i){return new(i||n)(Q(Ac),Q(ns),Q(ro),Q(gP))};static#t=this.\u0275cmp=wr({type:n,selectors:[["mat-slider-visual-thumb"]],viewQuery:function(i,r){if(1&i&&(ul(L0,5),ul(zCe,5),ul(HCe,5)),2&i){let s;ia(s=ra())&&(r._ripple=s.first),ia(s=ra())&&(r._knob=s.first),ia(s=ra())&&(r._valueIndicatorContainer=s.first)}},hostAttrs:[1,"mdc-slider__thumb","mat-mdc-slider-visual-thumb"],inputs:{discrete:"discrete",thumbPosition:"thumbPosition",valueIndicatorText:"valueIndicatorText"},standalone:!0,features:[Bo([{provide:oK,useExisting:n}]),ah],decls:4,vars:2,consts:[["knob",""],["valueIndicatorContainer",""],[1,"mdc-slider__value-indicator-container"],[1,"mdc-slider__thumb-knob"],["matRipple","",1,"mat-mdc-focus-indicator",3,"matRippleDisabled"],[1,"mdc-slider__value-indicator"],[1,"mdc-slider__value-indicator-text"]],template:function(i,r){1&i&&(Rs(0,VCe,5,1,"div",2),Er(1,"div",3,0)(3,"div",4)),2&i&&(U_(r.discrete?0:-1),F(3),jn("matRippleDisabled",!0))},dependencies:[L0],styles:[".mat-mdc-slider-visual-thumb .mat-ripple{height:100%;width:100%}.mat-mdc-slider .mdc-slider__tick-marks{justify-content:start}.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--inactive{position:absolute;left:2px}"],encapsulation:2,changeDetection:0})}return n})(),g6=(()=>{class n{get disabled(){return this._disabled}set disabled(t){this._disabled=t;const i=this._getInput(Ho.END),r=this._getInput(Ho.START);i&&(i.disabled=this._disabled),r&&(r.disabled=this._disabled)}get discrete(){return this._discrete}set discrete(t){this._discrete=t,this._updateValueIndicatorUIs()}get min(){return this._min}set min(t){const i=isNaN(t)?this._min:t;this._min!==i&&this._updateMin(i)}_updateMin(t){const i=this._min;this._min=t,this._isRange?this._updateMinRange({old:i,new:t}):this._updateMinNonRange(t),this._onMinMaxOrStepChange()}_updateMinRange(t){const i=this._getInput(Ho.END),r=this._getInput(Ho.START),s=i.value,o=r.value;r.min=t.new,i.min=Math.max(t.new,r.value),r.max=Math.min(i.max,i.value),r._updateWidthInactive(),i._updateWidthInactive(),t.new<t.old?this._onTranslateXChangeBySideEffect(i,r):this._onTranslateXChangeBySideEffect(r,i),s!==i.value&&this._onValueChange(i),o!==r.value&&this._onValueChange(r)}_updateMinNonRange(t){const i=this._getInput(Ho.END);if(i){const r=i.value;i.min=t,i._updateThumbUIByValue(),this._updateTrackUI(i),r!==i.value&&this._onValueChange(i)}}get max(){return this._max}set max(t){const i=isNaN(t)?this._max:t;this._max!==i&&this._updateMax(i)}_updateMax(t){const i=this._max;this._max=t,this._isRange?this._updateMaxRange({old:i,new:t}):this._updateMaxNonRange(t),this._onMinMaxOrStepChange()}_updateMaxRange(t){const i=this._getInput(Ho.END),r=this._getInput(Ho.START),s=i.value,o=r.value;i.max=t.new,r.max=Math.min(t.new,i.value),i.min=r.value,i._updateWidthInactive(),r._updateWidthInactive(),t.new>t.old?this._onTranslateXChangeBySideEffect(r,i):this._onTranslateXChangeBySideEffect(i,r),s!==i.value&&this._onValueChange(i),o!==r.value&&this._onValueChange(r)}_updateMaxNonRange(t){const i=this._getInput(Ho.END);if(i){const r=i.value;i.max=t,i._updateThumbUIByValue(),this._updateTrackUI(i),r!==i.value&&this._onValueChange(i)}}get step(){return this._step}set step(t){const i=isNaN(t)?this._step:t;this._step!==i&&this._updateStep(i)}_updateStep(t){this._step=t,this._isRange?this._updateStepRange():this._updateStepNonRange(),this._onMinMaxOrStepChange()}_updateStepRange(){const t=this._getInput(Ho.END),i=this._getInput(Ho.START),r=t.value,s=i.value,o=i.value;t.min=this._min,i.max=this._max,t.step=this._step,i.step=this._step,this._platform.SAFARI&&(t.value=t.value,i.value=i.value),t.min=Math.max(this._min,i.value),i.max=Math.min(this._max,t.value),i._updateWidthInactive(),t._updateWidthInactive(),t.value<o?this._onTranslateXChangeBySideEffect(i,t):this._onTranslateXChangeBySideEffect(t,i),r!==t.value&&this._onValueChange(t),s!==i.value&&this._onValueChange(i)}_updateStepNonRange(){const t=this._getInput(Ho.END);if(t){const i=t.value;t.step=this._step,this._platform.SAFARI&&(t.value=t.value),t._updateThumbUIByValue(),i!==t.value&&this._onValueChange(t)}}constructor(t,i,r,s,o,l){this._ngZone=t,this._cdr=i,this._elementRef=r,this._dir=s,this._globalRippleOptions=o,this._disabled=!1,this._discrete=!1,this.showTickMarks=!1,this._min=0,this.disableRipple=!1,this._max=100,this._step=1,this.displayWith=h=>`${h}`,this._rippleRadius=24,this.startValueIndicatorText="",this.endValueIndicatorText="",this._isRange=!1,this._isRtl=!1,this._hasViewInitialized=!1,this._tickMarkTrackWidth=0,this._hasAnimation=!1,this._resizeTimer=null,this._platform=oi(uh),this._knobRadius=8,this._thumbsOverlap=!1,this._noopAnimations="NoopAnimations"===l,this._dirChangeSubscription=this._dir.change.subscribe(()=>this._onDirChange()),this._isRtl="rtl"===this._dir.value}ngAfterViewInit(){this._platform.isBrowser&&this._updateDimensions();const t=this._getInput(Ho.END),i=this._getInput(Ho.START);this._isRange=!!t&&!!i,this._cdr.detectChanges();const r=this._getThumb(Ho.END);this._rippleRadius=r._ripple.radius,this._inputPadding=this._rippleRadius-this._knobRadius,this._isRange?this._initUIRange(t,i):this._initUINonRange(t),this._updateTrackUI(t),this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._observeHostResize(),this._cdr.detectChanges()}_initUINonRange(t){t.initProps(),t.initUI(),this._updateValueIndicatorUI(t),this._hasViewInitialized=!0,t._updateThumbUIByValue()}_initUIRange(t,i){t.initProps(),t.initUI(),i.initProps(),i.initUI(),t._updateMinMax(),i._updateMinMax(),t._updateStaticStyles(),i._updateStaticStyles(),this._updateValueIndicatorUIs(),this._hasViewInitialized=!0,t._updateThumbUIByValue(),i._updateThumbUIByValue()}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._resizeObserver?.disconnect(),this._resizeObserver=null}_onDirChange(){this._isRtl="rtl"===this._dir.value,this._isRange?this._onDirChangeRange():this._onDirChangeNonRange(),this._updateTickMarkUI()}_onDirChangeRange(){const t=this._getInput(Ho.END),i=this._getInput(Ho.START);t._setIsLeftThumb(),i._setIsLeftThumb(),t.translateX=t._calcTranslateXByValue(),i.translateX=i._calcTranslateXByValue(),t._updateStaticStyles(),i._updateStaticStyles(),t._updateWidthInactive(),i._updateWidthInactive(),t._updateThumbUIByValue(),i._updateThumbUIByValue()}_onDirChangeNonRange(){this._getInput(Ho.END)._updateThumbUIByValue()}_observeHostResize(){typeof ResizeObserver>"u"||!ResizeObserver||this._ngZone.runOutsideAngular(()=>{this._resizeObserver=new ResizeObserver(()=>{this._isActive()||(this._resizeTimer&&clearTimeout(this._resizeTimer),this._onResize())}),this._resizeObserver.observe(this._elementRef.nativeElement)})}_isActive(){return this._getThumb(Ho.START)._isActive||this._getThumb(Ho.END)._isActive}_getValue(t=Ho.END){const i=this._getInput(t);return i?i.value:this.min}_skipUpdate(){return!(!this._getInput(Ho.START)?._skipUIUpdate&&!this._getInput(Ho.END)?._skipUIUpdate)}_updateDimensions(){this._cachedWidth=this._elementRef.nativeElement.offsetWidth,this._cachedLeft=this._elementRef.nativeElement.getBoundingClientRect().left}_setTrackActiveStyles(t){const i=this._trackActive.nativeElement.style;i.left=t.left,i.right=t.right,i.transformOrigin=t.transformOrigin,i.transform=t.transform}_calcTickMarkTransform(t){return`translateX(${t*(this._tickMarkTrackWidth/(this._tickMarks.length-1))}px`}_onTranslateXChange(t){this._hasViewInitialized&&(this._updateThumbUI(t),this._updateTrackUI(t),this._updateOverlappingThumbUI(t))}_onTranslateXChangeBySideEffect(t,i){this._hasViewInitialized&&(t._updateThumbUIByValue(),i._updateThumbUIByValue())}_onValueChange(t){this._hasViewInitialized&&(this._updateValueIndicatorUI(t),this._updateTickMarkUI(),this._cdr.detectChanges())}_onMinMaxOrStepChange(){this._hasViewInitialized&&(this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.markForCheck())}_onResize(){if(this._hasViewInitialized){if(this._updateDimensions(),this._isRange){const t=this._getInput(Ho.END),i=this._getInput(Ho.START);t._updateThumbUIByValue(),i._updateThumbUIByValue(),t._updateStaticStyles(),i._updateStaticStyles(),t._updateMinMax(),i._updateMinMax(),t._updateWidthInactive(),i._updateWidthInactive()}else{const t=this._getInput(Ho.END);t&&t._updateThumbUIByValue()}this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.detectChanges()}}_areThumbsOverlapping(){const t=this._getInput(Ho.START),i=this._getInput(Ho.END);return!(!t||!i)&&i.translateX-t.translateX<20}_updateOverlappingThumbClassNames(t){const i=t.getSibling(),r=this._getThumb(t.thumbPosition);this._getThumb(i.thumbPosition)._hostElement.classList.remove("mdc-slider__thumb--top"),r._hostElement.classList.toggle("mdc-slider__thumb--top",this._thumbsOverlap)}_updateOverlappingThumbUI(t){!this._isRange||this._skipUpdate()||this._thumbsOverlap!==this._areThumbsOverlapping()&&(this._thumbsOverlap=!this._thumbsOverlap,this._updateOverlappingThumbClassNames(t))}_updateThumbUI(t){this._skipUpdate()||(this._getThumb(t.thumbPosition===Ho.END?Ho.END:Ho.START)._hostElement.style.transform=`translateX(${t.translateX}px)`)}_updateValueIndicatorUI(t){if(this._skipUpdate())return;const i=this.displayWith(t.value);if(this._hasViewInitialized?t._valuetext.set(i):t._hostElement.setAttribute("aria-valuetext",i),this.discrete){t.thumbPosition===Ho.START?this.startValueIndicatorText=i:this.endValueIndicatorText=i;const r=this._getThumb(t.thumbPosition);i.length<3?r._hostElement.classList.add("mdc-slider__thumb--short-value"):r._hostElement.classList.remove("mdc-slider__thumb--short-value")}}_updateValueIndicatorUIs(){const t=this._getInput(Ho.END),i=this._getInput(Ho.START);t&&this._updateValueIndicatorUI(t),i&&this._updateValueIndicatorUI(i)}_updateTickMarkTrackUI(){if(!this.showTickMarks||this._skipUpdate())return;const t=this._step&&this._step>0?this._step:1,r=(Math.floor(this.max/t)*t-this.min)/(this.max-this.min);this._tickMarkTrackWidth=this._cachedWidth*r-6}_updateTrackUI(t){this._skipUpdate()||(this._isRange?this._updateTrackUIRange(t):this._updateTrackUINonRange(t))}_updateTrackUIRange(t){const i=t.getSibling();if(!i||!this._cachedWidth)return;const r=Math.abs(i.translateX-t.translateX)/this._cachedWidth;this._setTrackActiveStyles(t._isLeftThumb&&this._cachedWidth?{left:"auto",right:this._cachedWidth-i.translateX+"px",transformOrigin:"right",transform:`scaleX(${r})`}:{left:`${i.translateX}px`,right:"auto",transformOrigin:"left",transform:`scaleX(${r})`})}_updateTrackUINonRange(t){this._setTrackActiveStyles(this._isRtl?{left:"auto",right:"0px",transformOrigin:"right",transform:`scaleX(${1-t.fillPercentage})`}:{left:"0px",right:"auto",transformOrigin:"left",transform:`scaleX(${t.fillPercentage})`})}_updateTickMarkUI(){if(!this.showTickMarks||void 0===this.step||void 0===this.min||void 0===this.max)return;const t=this.step>0?this.step:1;this._isRange?this._updateTickMarkUIRange(t):this._updateTickMarkUINonRange(t),this._isRtl&&this._tickMarks.reverse()}_updateTickMarkUINonRange(t){const i=this._getValue();let r=Math.max(Math.round((i-this.min)/t),0),s=Math.max(Math.round((this.max-i)/t),0);this._isRtl?r++:s++,this._tickMarks=Array(r).fill(uM.ACTIVE).concat(Array(s).fill(uM.INACTIVE))}_updateTickMarkUIRange(t){const i=this._getValue(),r=this._getValue(Ho.START),s=Math.max(Math.round((r-this.min)/t),0),o=Math.max(Math.round((i-r)/t)+1,0),l=Math.max(Math.round((this.max-i)/t),0);this._tickMarks=Array(s).fill(uM.INACTIVE).concat(Array(o).fill(uM.ACTIVE),Array(l).fill(uM.INACTIVE))}_getInput(t){return t===Ho.END&&this._input?this._input:this._inputs?.length?t===Ho.START?this._inputs.first:this._inputs.last:void 0}_getThumb(t){return t===Ho.END?this._thumbs?.last:this._thumbs?.first}_setTransition(t){this._hasAnimation=!this._platform.IOS&&t&&!this._noopAnimations,this._elementRef.nativeElement.classList.toggle("mat-mdc-slider-with-animation",this._hasAnimation)}_isCursorOnSliderThumb(t,i){const r=i.width/2,h=t.clientY-(i.y+r);return Math.pow(t.clientX-(i.x+r),2)+Math.pow(h,2)<Math.pow(r,2)}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ns),Q(Ac),Q(ro),Q(Rp,8),Q(_N,8),Q(gh,8))};static#t=this.\u0275cmp=wr({type:n,selectors:[["mat-slider"]],contentQueries:function(i,r,s){if(1&i&&(Cp(s,rK,5),Cp(s,sK,4)),2&i){let o;ia(o=ra())&&(r._input=o.first),ia(o=ra())&&(r._inputs=o)}},viewQuery:function(i,r){if(1&i&&(ul(GCe,5),ul(oK,5)),2&i){let s;ia(s=ra())&&(r._trackActive=s.first),ia(s=ra())&&(r._thumbs=s)}},hostAttrs:[1,"mat-mdc-slider","mdc-slider"],hostVars:12,hostBindings:function(i,r){2&i&&(gA("mat-"+(r.color||"primary")),Ka("mdc-slider--range",r._isRange)("mdc-slider--disabled",r.disabled)("mdc-slider--discrete",r.discrete)("mdc-slider--tick-marks",r.showTickMarks)("_mat-animation-noopable",r._noopAnimations))},inputs:{disabled:[2,"disabled","disabled",js],discrete:[2,"discrete","discrete",js],showTickMarks:[2,"showTickMarks","showTickMarks",js],min:[2,"min","min",vh],color:"color",disableRipple:[2,"disableRipple","disableRipple",js],max:[2,"max","max",vh],step:[2,"step","step",vh],displayWith:"displayWith"},exportAs:["matSlider"],standalone:!0,features:[Bo([{provide:gP,useExisting:n}]),kl,ah],ngContentSelectors:qCe,decls:9,vars:5,consts:[["trackActive",""],["tickMarkContainer",""],[1,"mdc-slider__track"],[1,"mdc-slider__track--inactive"],[1,"mdc-slider__track--active"],[1,"mdc-slider__track--active_fill"],[1,"mdc-slider__tick-marks"],[3,"discrete","thumbPosition","valueIndicatorText"],[3,"class","transform"]],template:function(i,r){1&i&&(xd(),ou(0),Wt(1,"div",2),Er(2,"div",3),Wt(3,"div",4),Er(4,"div",5,0),un(),Rs(6,WCe,3,1,"div",6),un(),Rs(7,$Ce,1,3,"mat-slider-visual-thumb",7),Er(8,"mat-slider-visual-thumb",7)),2&i&&(F(6),U_(r.showTickMarks?6:-1),F(),U_(r._isRange?7:-1),F(),jn("discrete",r.discrete)("thumbPosition",2)("valueIndicatorText",r.endValueIndicatorText))},dependencies:[XCe],styles:['.mdc-slider__track{position:absolute;top:50%;transform:translateY(-50%);width:100%;pointer-events:none;height:var(--mdc-slider-inactive-track-height)}.mdc-slider__track--active,.mdc-slider__track--inactive{display:flex;height:100%;position:absolute;width:100%}.mdc-slider__track--active{overflow:hidden;border-radius:var(--mdc-slider-active-track-shape, var(--mat-app-corner-full));height:var(--mdc-slider-active-track-height);top:calc((var(--mdc-slider-inactive-track-height) - var(--mdc-slider-active-track-height))/2)}.mdc-slider__track--active_fill{border-top-style:solid;box-sizing:border-box;height:100%;width:100%;position:relative;transform-origin:left;transition:transform 80ms ease;border-color:var(--mdc-slider-active-track-color, var(--mat-app-primary));border-top-width:var(--mdc-slider-active-track-height)}.mdc-slider--disabled .mdc-slider__track--active_fill{border-color:var(--mdc-slider-disabled-active-track-color, var(--mat-app-on-surface))}[dir=rtl] .mdc-slider__track--active_fill{-webkit-transform-origin:right;transform-origin:right}.mdc-slider__track--inactive{left:0;top:0;opacity:.24;background-color:var(--mdc-slider-inactive-track-color, var(--mat-app-surface-variant));height:var(--mdc-slider-inactive-track-height);border-radius:var(--mdc-slider-inactive-track-shape, var(--mat-app-corner-full))}.mdc-slider--disabled .mdc-slider__track--inactive{background-color:var(--mdc-slider-disabled-inactive-track-color, var(--mat-app-on-surface));opacity:.24}.mdc-slider__track--inactive::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.cdk-high-contrast-active .mdc-slider__track--inactive::before{border-color:CanvasText}.mdc-slider__value-indicator-container{bottom:44px;left:50%;pointer-events:none;position:absolute;transform:translateX(-50%);transform:var(--mat-slider-value-indicator-container-transform)}.mdc-slider__thumb--with-indicator .mdc-slider__value-indicator-container{pointer-events:auto}.mdc-slider__value-indicator{display:flex;align-items:center;border-radius:4px;height:32px;padding:0 12px;transform:scale(0);transform-origin:bottom;opacity:1;transition:transform 100ms cubic-bezier(0.4, 0, 1, 1);word-break:normal;background-color:var(--mdc-slider-label-container-color, var(--mat-app-primary));color:var(--mdc-slider-label-label-text-color, var(--mat-app-on-primary));width:var(--mat-slider-value-indicator-width);height:var(--mat-slider-value-indicator-height);padding:var(--mat-slider-value-indicator-padding);opacity:var(--mat-slider-value-indicator-opacity);border-radius:var(--mat-slider-value-indicator-border-radius)}.mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:transform 100ms cubic-bezier(0, 0, 0.2, 1);transform:scale(1)}.mdc-slider__value-indicator::before{border-left:6px solid rgba(0,0,0,0);border-right:6px solid rgba(0,0,0,0);border-top:6px solid;bottom:-5px;content:"";height:0;left:50%;position:absolute;transform:translateX(-50%);width:0;display:var(--mat-slider-value-indicator-caret-display);border-top-color:var(--mdc-slider-label-container-color, var(--mat-app-primary))}.mdc-slider__value-indicator::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.cdk-high-contrast-active .mdc-slider__value-indicator::after{border-color:CanvasText}.mdc-slider__value-indicator-text{text-align:center;width:var(--mat-slider-value-indicator-width);transform:var(--mat-slider-value-indicator-text-transform);font-family:var(--mdc-slider-label-label-text-font, var(--mat-app-label-medium-font));font-size:var(--mdc-slider-label-label-text-size, var(--mat-app-label-medium-size));font-weight:var(--mdc-slider-label-label-text-weight, var(--mat-app-label-medium-weight));line-height:var(--mdc-slider-label-label-text-line-height, var(--mat-app-label-medium-line-height));letter-spacing:var(--mdc-slider-label-label-text-tracking, var(--mat-app-label-medium-tracking))}.mdc-slider__thumb{-webkit-user-select:none;user-select:none;display:flex;left:-24px;outline:none;position:absolute;height:48px;width:48px;pointer-events:none}.mdc-slider--discrete .mdc-slider__thumb{transition:transform 80ms ease}.mdc-slider--disabled .mdc-slider__thumb{pointer-events:none}.mdc-slider__thumb--top{z-index:1}.mdc-slider__thumb-knob{position:absolute;box-sizing:border-box;left:50%;top:50%;transform:translate(-50%, -50%);border-style:solid;width:var(--mdc-slider-handle-width);height:var(--mdc-slider-handle-height);border-width:calc(var(--mdc-slider-handle-height)/2) calc(var(--mdc-slider-handle-width)/2);box-shadow:var(--mdc-slider-handle-elevation, var(--mat-app-level1));background-color:var(--mdc-slider-handle-color, var(--mat-app-primary));border-color:var(--mdc-slider-handle-color, var(--mat-app-primary));border-radius:var(--mdc-slider-handle-shape, var(--mat-app-corner-full))}.mdc-slider__thumb:hover .mdc-slider__thumb-knob{background-color:var(--mdc-slider-hover-handle-color, var(--mat-app-primary));border-color:var(--mdc-slider-hover-handle-color, var(--mat-app-primary))}.mdc-slider__thumb--focused .mdc-slider__thumb-knob{background-color:var(--mdc-slider-focus-handle-color, var(--mat-app-primary));border-color:var(--mdc-slider-focus-handle-color, var(--mat-app-primary))}.mdc-slider--disabled .mdc-slider__thumb-knob{background-color:var(--mdc-slider-disabled-handle-color, var(--mat-app-on-surface));border-color:var(--mdc-slider-disabled-handle-color, var(--mat-app-on-surface))}.mdc-slider__thumb--top .mdc-slider__thumb-knob,.mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border:solid 1px #fff;box-sizing:content-box;border-color:var(--mdc-slider-with-overlap-handle-outline-color, var(--mat-app-on-primary));border-width:var(--mdc-slider-with-overlap-handle-outline-width)}.mdc-slider__tick-marks{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:space-between;padding:0 1px;position:absolute;width:100%}.mdc-slider__tick-mark--active,.mdc-slider__tick-mark--inactive{width:var(--mdc-slider-with-tick-marks-container-size);height:var(--mdc-slider-with-tick-marks-container-size);border-radius:var(--mdc-slider-with-tick-marks-container-shape, var(--mat-app-corner-full))}.mdc-slider__tick-mark--inactive{opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity);background-color:var(--mdc-slider-with-tick-marks-inactive-container-color, var(--mat-app-on-surface-variant))}.mdc-slider--disabled .mdc-slider__tick-mark--inactive{opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity);background-color:var(--mdc-slider-with-tick-marks-disabled-container-color, var(--mat-app-on-surface))}.mdc-slider__tick-mark--active{opacity:var(--mdc-slider-with-tick-marks-active-container-opacity);background-color:var(--mdc-slider-with-tick-marks-active-container-color, var(--mat-app-on-primary))}.mdc-slider__input{cursor:pointer;left:2px;margin:0;height:44px;opacity:0;position:absolute;top:2px;width:44px;box-sizing:content-box}.mdc-slider__input.mat-mdc-slider-input-no-pointer-events{pointer-events:none}.mdc-slider__input.mat-slider__right-input{left:auto;right:0}.mat-mdc-slider{display:inline-block;box-sizing:border-box;outline:none;vertical-align:middle;cursor:pointer;height:48px;margin:0 8px;position:relative;touch-action:pan-y;width:auto;min-width:112px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-slider.mdc-slider--disabled{cursor:auto;opacity:.38}.mat-mdc-slider .mdc-slider__thumb,.mat-mdc-slider .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider.mdc-slider--discrete .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider .mat-ripple .mat-ripple-element{background-color:var(--mat-slider-ripple-color, var(--mat-app-primary))}.mat-mdc-slider .mat-ripple .mat-mdc-slider-hover-ripple{background-color:var(--mat-slider-hover-state-layer-color)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-focus-ripple,.mat-mdc-slider .mat-ripple .mat-mdc-slider-active-ripple{background-color:var(--mat-slider-focus-state-layer-color)}.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__track--active_fill,.mat-mdc-slider._mat-animation-noopable .mdc-slider__value-indicator{transition:none}.mat-mdc-slider .mat-mdc-focus-indicator::before{border-radius:50%}.mdc-slider__thumb--focused .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return n})();const KCe={provide:Wf,useExisting:Ma(()=>GT),multi:!0};let GT=(()=>{class n{get value(){return vh(this._hostElement.value,0)}set value(t){const i=(t=isNaN(t)?0:t)+"";this._hasSetInitialValue?this._isActive||this._setValue(i):this._initialValue=i}_setValue(t){this._hostElement.value=t,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges(),this._slider._cdr.markForCheck()}get translateX(){return this._slider.min>=this._slider.max?(this._translateX=this._tickMarkOffset,this._translateX):(void 0===this._translateX&&(this._translateX=this._calcTranslateXByValue()),this._translateX)}set translateX(t){this._translateX=t}get min(){return vh(this._hostElement.min,0)}set min(t){this._hostElement.min=t+"",this._cdr.detectChanges()}get max(){return vh(this._hostElement.max,0)}set max(t){this._hostElement.max=t+"",this._cdr.detectChanges()}get step(){return vh(this._hostElement.step,0)}set step(t){this._hostElement.step=t+"",this._cdr.detectChanges()}get disabled(){return js(this._hostElement.disabled)}set disabled(t){this._hostElement.disabled=t,this._cdr.detectChanges(),this._slider.disabled!==this.disabled&&(this._slider.disabled=this.disabled)}get percentage(){return this._slider.min>=this._slider.max?this._slider._isRtl?1:0:(this.value-this._slider.min)/(this._slider.max-this._slider.min)}get fillPercentage(){return this._slider._cachedWidth?0===this._translateX?0:this.translateX/this._slider._cachedWidth:this._slider._isRtl?1:0}_setIsFocused(t){this._isFocused=t}constructor(t,i,r,s){this._ngZone=t,this._elementRef=i,this._cdr=r,this._slider=s,this.valueChange=new os,this.dragStart=new os,this.dragEnd=new os,this.thumbPosition=Ho.END,this._valuetext=N_(""),this._knobRadius=8,this._tickMarkOffset=3,this._isActive=!1,this._isFocused=!1,this._hasSetInitialValue=!1,this._destroyed=new Qt,this._skipUIUpdate=!1,this._onTouchedFn=()=>{},this._isControlInitialized=!1,this._platform=oi(uh),this._hostElement=i.nativeElement,this._ngZone.runOutsideAngular(()=>{this._hostElement.addEventListener("pointerdown",this._onPointerDown.bind(this)),this._hostElement.addEventListener("pointermove",this._onPointerMove.bind(this)),this._hostElement.addEventListener("pointerup",this._onPointerUp.bind(this))})}ngOnDestroy(){this._hostElement.removeEventListener("pointerdown",this._onPointerDown),this._hostElement.removeEventListener("pointermove",this._onPointerMove),this._hostElement.removeEventListener("pointerup",this._onPointerUp),this._destroyed.next(),this._destroyed.complete(),this.dragStart.complete(),this.dragEnd.complete()}initProps(){this._updateWidthInactive(),this.disabled!==this._slider.disabled&&(this._slider.disabled=!0),this.step=this._slider.step,this.min=this._slider.min,this.max=this._slider.max,this._initValue()}initUI(){this._updateThumbUIByValue()}_initValue(){this._hasSetInitialValue=!0,void 0===this._initialValue?this.value=this._getDefaultValue():(this._hostElement.value=this._initialValue,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges())}_getDefaultValue(){return this.min}_onBlur(){this._setIsFocused(!1),this._onTouchedFn()}_onFocus(){this._slider._setTransition(!1),this._slider._updateTrackUI(this),this._setIsFocused(!0)}_onChange(){this.valueChange.emit(this.value),this._isActive&&this._updateThumbUIByValue({withAnimation:!0})}_onInput(){this._onChangeFn?.(this.value),(this._slider.step||!this._isActive)&&this._updateThumbUIByValue({withAnimation:!0}),this._slider._onValueChange(this)}_onNgControlValueChange(){(!this._isActive||!this._isFocused)&&(this._slider._onValueChange(this),this._updateThumbUIByValue()),this._slider.disabled=this._formControl.disabled}_onPointerDown(t){if(!this.disabled&&0===t.button){if(this._platform.IOS){const i=this._slider._isCursorOnSliderThumb(t,this._slider._getThumb(this.thumbPosition)._hostElement.getBoundingClientRect());return this._isActive=i,this._updateWidthActive(),void this._slider._updateDimensions()}this._isActive=!0,this._setIsFocused(!0),this._updateWidthActive(),this._slider._updateDimensions(),this._slider.step||this._updateThumbUIByPointerEvent(t,{withAnimation:!0}),this.disabled||(this._handleValueCorrection(t),this.dragStart.emit({source:this,parent:this._slider,value:this.value}))}}_handleValueCorrection(t){this._skipUIUpdate=!0,setTimeout(()=>{this._skipUIUpdate=!1,this._fixValue(t)},0)}_fixValue(t){const i=t.clientX-this._slider._cachedLeft,r=this._slider._cachedWidth,s=0===this._slider.step?1:this._slider.step,o=Math.floor((this._slider.max-this._slider.min)/s),u=Math.round((this._slider._isRtl?1-i/r:i/r)*o)/o*(this._slider.max-this._slider.min)+this._slider.min,f=Math.round(u/s)*s;if(f===this.value)return this._slider._onValueChange(this),void(this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(t,{withAnimation:this._slider._hasAnimation}));this.value=f,this.valueChange.emit(this.value),this._onChangeFn?.(this.value),this._slider._onValueChange(this),this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(t,{withAnimation:this._slider._hasAnimation})}_onPointerMove(t){!this._slider.step&&this._isActive&&this._updateThumbUIByPointerEvent(t)}_onPointerUp(){this._isActive&&(this._isActive=!1,this._platform.SAFARI&&this._setIsFocused(!1),this.dragEnd.emit({source:this,parent:this._slider,value:this.value}),setTimeout(()=>this._updateWidthInactive(),this._platform.IOS?10:0))}_clamp(t){const i=this._tickMarkOffset;return Math.max(Math.min(t,this._slider._cachedWidth-this._tickMarkOffset),i)}_calcTranslateXByValue(){return this._slider._isRtl?(1-this.percentage)*(this._slider._cachedWidth-2*this._tickMarkOffset)+this._tickMarkOffset:this.percentage*(this._slider._cachedWidth-2*this._tickMarkOffset)+this._tickMarkOffset}_calcTranslateXByPointerEvent(t){return t.clientX-this._slider._cachedLeft}_updateWidthActive(){}_updateWidthInactive(){this._hostElement.style.padding=`0 ${this._slider._inputPadding}px`,this._hostElement.style.width=`calc(100% + ${this._slider._inputPadding-2*this._tickMarkOffset}px)`,this._hostElement.style.left=`-${this._slider._rippleRadius-this._tickMarkOffset}px`}_updateThumbUIByValue(t){this.translateX=this._clamp(this._calcTranslateXByValue()),this._updateThumbUI(t)}_updateThumbUIByPointerEvent(t,i){this.translateX=this._clamp(this._calcTranslateXByPointerEvent(t)),this._updateThumbUI(i)}_updateThumbUI(t){this._slider._setTransition(!!t?.withAnimation),this._slider._onTranslateXChange(this)}writeValue(t){(this._isControlInitialized||null!==t)&&(this.value=t)}registerOnChange(t){this._onChangeFn=t,this._isControlInitialized=!0}registerOnTouched(t){this._onTouchedFn=t}setDisabledState(t){this.disabled=t}focus(){this._hostElement.focus()}blur(){this._hostElement.blur()}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ns),Q(ro),Q(Ac),Q(gP))};static#t=this.\u0275dir=mr({type:n,selectors:[["input","matSliderThumb",""]],hostAttrs:["type","range",1,"mdc-slider__input"],hostVars:1,hostBindings:function(i,r){1&i&&mi("change",function(){return r._onChange()})("input",function(){return r._onInput()})("blur",function(){return r._onBlur()})("focus",function(){return r._onFocus()}),2&i&&ja("aria-valuetext",r._valuetext())},inputs:{value:[2,"value","value",vh]},outputs:{valueChange:"valueChange",dragStart:"dragStart",dragEnd:"dragEnd"},exportAs:["matSliderThumb"],standalone:!0,features:[Bo([KCe,{provide:rK,useExisting:n}]),kl]})}return n})(),eMe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({imports:[zh,qB]})}return n})(),_6=(()=>{class n{eventDisplay;clippingEnabled;startClippingAngle;openingClippingAngle;constructor(t){this.eventDisplay=t;const i=this.eventDisplay.getStateManager();i.clippingEnabled.onUpdate(r=>this.clippingEnabled=r),i.startClippingAngle.onUpdate(r=>this.startClippingAngle=r),i.openingClippingAngle.onUpdate(r=>this.openingClippingAngle=r)}changeStartClippingAngle(t){this.eventDisplay.getUIManager().rotateStartAngleClipping(t)}changeOpeningClippingAngle(t){this.eventDisplay.getUIManager().rotateOpeningAngleClipping(t)}toggleClipping(t){const i=t.checked;this.eventDisplay.getUIManager().setClipping(i),this.clippingEnabled=i}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-object-clipping"]],decls:17,vars:5,consts:[["menu",""],["clippingCheckbox",""],["startingAngleSlider",""],["openingAngleSlider",""],[1,"mat-menu"],["mat-menu-item","",3,"click"],[3,"click","change","checked"],["mat-menu-item","",1,"slider-btn",3,"focus"],["min","0","max","360","step","1","thumbLabel",""],["matSliderThumb","",3,"valueChange","value"],["tooltip","Geometry clipping","icon","clipping",3,"matMenuTriggerFor","active"]],template:function(i,r){if(1&i){const s=zo();Wt(0,"mat-menu",4,0)(2,"button",5),mi("click",function(l){pi(s);const h=Ha(4);return l.stopPropagation(),fi(h._inputElement.nativeElement.click())}),Wt(3,"mat-checkbox",6,1),mi("click",function(l){return pi(s),fi(l.stopPropagation())})("change",function(l){return pi(s),fi(r.toggleClipping(l))}),ki(5," Clipping "),un()(),Wt(6,"button",7),mi("focus",function(){return pi(s),fi(Ha(9).focus())}),Wt(7,"mat-slider",8)(8,"input",9,2),mi("valueChange",function(l){return pi(s),fi(r.changeStartClippingAngle(l))}),un()(),ki(10," Start Angle "),un(),Wt(11,"button",7),mi("focus",function(){return pi(s),fi(Ha(14).focus())}),Wt(12,"mat-slider",8)(13,"input",9,3),mi("valueChange",function(l){return pi(s),fi(r.changeOpeningClippingAngle(l))}),un()(),ki(15," Opening Angle "),un()(),Er(16,"app-menu-toggle",10)}if(2&i){const s=Ha(1);F(3),jn("checked",r.clippingEnabled),F(5),jn("value",r.startClippingAngle),F(5),jn("value",r.openingClippingAngle),F(3),jn("matMenuTriggerFor",s)("active",r.clippingEnabled)}},dependencies:[py,fy,iM,g6,GT,mv,Hc],styles:[".slider-btn[_ngcontent-%COMP%]{overflow:visible}mat-slider[_ngcontent-%COMP%]{margin-left:.75rem;margin-right:.75rem}"]})}return n})(),_P=(()=>{class n{eventDisplay;darkTheme=!1;constructor(t){this.eventDisplay=t}ngOnInit(){this.darkTheme=this.eventDisplay.getUIManager().getDarkTheme()}setDarkTheme(){this.darkTheme=!this.darkTheme,this.eventDisplay.getUIManager().setDarkTheme(this.darkTheme)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-dark-theme"]],decls:1,vars:1,consts:[["tooltip","Dark theme","icon","dark",3,"click","active"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.setDarkTheme()}),un()),2&i&&jn("active",r.darkTheme)},dependencies:[Hc]})}return n})(),yP=(()=>{class n{eventDisplay;autoRotate=!1;constructor(t){this.eventDisplay=t}toggleAutoRotate(){this.autoRotate=!this.autoRotate,this.eventDisplay.getUIManager().setAutoRotate(this.autoRotate)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-auto-rotate"]],decls:1,vars:1,consts:[["tooltip","Auto rotate","icon","rotate",3,"click","active"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.toggleAutoRotate()}),un()),2&i&&jn("active",r.autoRotate)},dependencies:[Hc]})}return n})(),aK=(()=>{class n{data;dialogRef;eventDisplay;cartesianPos=new Dt;originChangedSub=null;stopShiftingSub=null;showCartesianGrid;gridConfig;scale;shiftGrid;constructor(t,i,r){this.data=t,this.dialogRef=i,this.eventDisplay=r}ngOnInit(){this.shiftGrid=this.eventDisplay.getThreeManager().shiftGrid,this.showCartesianGrid=this.data.gridVisible,this.scale=this.data.scale,this.gridConfig=this.eventDisplay.getUIManager().getCartesianGridConfig(),this.cartesianPos=this.eventDisplay.getThreeManager().origin}onClose(){this.dialogRef.close()}onSave(t,i,r){this.shiftCartesianGridByValues(new Dt(10*t,10*i,10*r))}shiftCartesianGridByPointer(){this.shiftGrid=!0,this.eventDisplay.getUIManager().shiftCartesianGridByPointer(),this.originChangedSub=this.eventDisplay.getThreeManager().originChanged.subscribe(t=>{this.translateGrid(t)}),this.stopShiftingSub=this.eventDisplay.getThreeManager().stopShifting.subscribe(t=>{t&&(this.originChangedSub.unsubscribe(),this.stopShiftingSub.unsubscribe())}),this.onClose()}shiftCartesianGridByValues(t){this.translateGrid(t),this.eventDisplay.getThreeManager().originChangedEmit(t)}translateGrid(t){const i=t,r=this.cartesianPos,s=new Dt(i.x-r.x,i.y-r.y,i.z-r.z);this.eventDisplay.getUIManager().translateCartesianGrid(s.clone()),this.eventDisplay.getUIManager().translateCartesianLabels(s.clone()),this.cartesianPos=i}addXYPlanes(t){this.gridConfig.zDistance=Number(t.target.value),this.callSetShowCartesianGrid()}addYZPlanes(t){this.gridConfig.xDistance=Number(t.target.value),this.callSetShowCartesianGrid()}addZXPlanes(t){this.gridConfig.yDistance=Number(t.target.value),this.callSetShowCartesianGrid()}changeSparsity(t){this.gridConfig.sparsity=Number(t.target.value),this.callSetShowCartesianGrid()}showXYPlanes(t){this.gridConfig.showXY=t.checked,this.callSetShowCartesianGrid()}showYZPlanes(t){this.gridConfig.showYZ=t.checked,this.callSetShowCartesianGrid()}showZXPlanes(t){this.gridConfig.showZX=t.checked,this.callSetShowCartesianGrid()}callSetShowCartesianGrid(){this.eventDisplay.getUIManager().setShowCartesianGrid(this.showCartesianGrid,this.scale,this.gridConfig)}calcPlanes(t){return Math.max(0,1+2*Math.floor(10*t/(this.scale*this.gridConfig.sparsity)))}static \u0275fac=function(i){return new(i||n)(Q(d6),Q(Px),Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-cartesian-grid-config"]],decls:65,vars:28,consts:[["xPos",""],["yPos",""],["zPos",""],["showXYPlanesCheckbox",""],["xyPlaneSlider",""],["showYZPlanesCheckbox",""],["yzPlaneSlider",""],["showZXPlanesCheckbox",""],["zxPlaneSlider",""],["sparsitySlider",""],["mat-dialog-title",""],["mat-dialog-content","",1,"container","dialog-content"],[1,"item-config-single"],[1,"item-config-group"],["for","xPos",1,"item-config-label"],["type","number","placeholder","Origin X","name","xPos","id","xPos",1,"form-control",3,"value"],["for","yPos",1,"item-config-label"],["type","number","placeholder","Origin Y","name","yPos","id","yPos",1,"form-control",3,"value"],["for","zPos",1,"item-config-label"],["type","number","placeholder","Origin Z","name","zPos","id","zPos",1,"form-control",3,"value"],["mat-stroked-button","",3,"click","disabled"],["mat-menu-item","",1,"explain-button",2,"margin","0.5rem 0",3,"click","disabled"],[1,"explain-text"],["mat-menu-item","",3,"click"],[3,"ngModelChange","click","change","ngModel"],["mat-menu-item","",1,"slider-btn",3,"focus"],["min","-300","step","300","thumbLabel","",3,"max"],["matSliderThumb","",3,"input","value"],["min","1","max","5","step","1","thumbLabel",""],["mat-dialog-actions","","align","end"],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"click"]],template:function(i,r){if(1&i){const s=zo();Wt(0,"div")(1,"h1",10),ki(2,"Customize Cartesian Grid"),un(),Wt(3,"div",11)(4,"div",12)(5,"div",13)(6,"label",14),ki(7,"x (cm) : "),un(),Er(8,"input",15,0),WE(10,"number"),un(),Wt(11,"div",13)(12,"label",16),ki(13,"y (cm) : "),un(),Er(14,"input",17,1),WE(16,"number"),un(),Wt(17,"div",13)(18,"label",18),ki(19,"z (cm) : "),un(),Er(20,"input",19,2),WE(22,"number"),un(),Wt(23,"button",20),mi("click",function(){pi(s);const l=Ha(9),h=Ha(15),u=Ha(21);return fi(r.onSave(l.value,h.value,u.value))}),ki(24," Save "),un(),Wt(25,"button",21),mi("click",function(l){return pi(s),l.stopPropagation(),fi(r.shiftCartesianGridByPointer())}),ki(26," Shift Cartesian Grid on click "),Wt(27,"p",22),ki(28," Click on a point to shift the grid. Keep clicking at various points to continue shifting. Right click to stop. "),un()()(),Wt(29,"div")(30,"button",23),mi("click",function(){return pi(s),fi(Ha(32)._inputElement.nativeElement.click())}),Wt(31,"mat-checkbox",24,3),C0("ngModelChange",function(l){return pi(s),z_(r.gridConfig.showXY,l)||(r.gridConfig.showXY=l),fi(l)}),mi("click",function(l){return pi(s),fi(l.stopPropagation())})("change",function(l){return pi(s),fi(r.showXYPlanes(l))}),ki(33,"Show XY Planes "),un()(),Wt(34,"button",25),mi("focus",function(){return pi(s),fi(Ha(37).focus())}),Wt(35,"mat-slider",26)(36,"input",27,4),mi("input",function(l){return pi(s),fi(r.addXYPlanes(l))}),un()(),ki(38),un(),Wt(39,"button",23),mi("click",function(){return pi(s),fi(Ha(41)._inputElement.nativeElement.click())}),Wt(40,"mat-checkbox",24,5),C0("ngModelChange",function(l){return pi(s),z_(r.gridConfig.showYZ,l)||(r.gridConfig.showYZ=l),fi(l)}),mi("click",function(l){return pi(s),fi(l.stopPropagation())})("change",function(l){return pi(s),fi(r.showYZPlanes(l))}),ki(42,"Show YZ Planes "),un()(),Wt(43,"button",25),mi("focus",function(){return pi(s),fi(Ha(46).focus())}),Wt(44,"mat-slider",26)(45,"input",27,6),mi("input",function(l){return pi(s),fi(r.addYZPlanes(l))}),un()(),ki(47),un(),Wt(48,"button",23),mi("click",function(){return pi(s),fi(Ha(50)._inputElement.nativeElement.click())}),Wt(49,"mat-checkbox",24,7),C0("ngModelChange",function(l){return pi(s),z_(r.gridConfig.showZX,l)||(r.gridConfig.showZX=l),fi(l)}),mi("click",function(l){return pi(s),fi(l.stopPropagation())})("change",function(l){return pi(s),fi(r.showZXPlanes(l))}),ki(51,"Show ZX Planes "),un()(),Wt(52,"button",25),mi("focus",function(){return pi(s),fi(Ha(55).focus())}),Wt(53,"mat-slider",26)(54,"input",27,8),mi("input",function(l){return pi(s),fi(r.addZXPlanes(l))}),un()(),ki(56),un(),Wt(57,"button",25),mi("focus",function(){return pi(s),fi(Ha(60).focus())}),Wt(58,"mat-slider",28)(59,"input",27,9),mi("input",function(l){return pi(s),fi(r.changeSparsity(l))}),un()(),ki(61),un()()(),Wt(62,"div",29)(63,"button",30),mi("click",function(){return pi(s),fi(r.onClose())}),ki(64," Close "),un()()()}2&i&&(F(8),jn("value",FD(10,19,r.cartesianPos.x/10,"1.2-2")),F(6),jn("value",FD(16,22,r.cartesianPos.y/10,"1.2-2")),F(6),jn("value",FD(22,25,r.cartesianPos.z/10,"1.2-2")),F(3),jn("disabled",r.shiftGrid),F(2),jn("disabled",r.shiftGrid),F(6),w0("ngModel",r.gridConfig.showXY),F(4),jn("max",r.scale),F(),jn("value",r.gridConfig.zDistance),F(2),dl(" XY Plane (",r.calcPlanes(r.gridConfig.zDistance),") "),F(2),w0("ngModel",r.gridConfig.showYZ),F(4),jn("max",r.scale),F(),jn("value",r.gridConfig.xDistance),F(2),dl(" YZ Plane (",r.calcPlanes(r.gridConfig.xDistance),") "),F(2),w0("ngModel",r.gridConfig.showZX),F(4),jn("max",r.scale),F(),jn("value",r.gridConfig.yDistance),F(2),dl(" ZX Plane (",r.calcPlanes(r.gridConfig.yDistance),") "),F(3),jn("value",r.gridConfig.sparsity),F(2),dl(" Sparsity (",r.gridConfig.sparsity,") "))},dependencies:[zT,VT,HT,hM,eP,FT,fy,g6,GT,mv,SH],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.item-config-single[_ngcontent-%COMP%]{display:flex;flex-direction:column}.item-config-single[_ngcontent-%COMP%]   .item-config-group[_ngcontent-%COMP%]{margin:.1rem 2rem}.item-config-single[_ngcontent-%COMP%]   .item-config-group[_ngcontent-%COMP%]   .item-config-label[_ngcontent-%COMP%]{display:inline;margin:1rem}.item-config-single[_ngcontent-%COMP%]   .item-config-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:60%;display:inline}.item-config-single[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:.5rem 4rem}.item-config-single[_ngcontent-%COMP%]   .explain-button[_ngcontent-%COMP%]{padding-top:1rem}.item-config-single[_ngcontent-%COMP%]   .explain-text[_ngcontent-%COMP%]{width:20rem;opacity:.7;margin-top:.5rem;font-size:.9rem}"]})}return n})();function tMe(n,e){if(1&n&&(Fr(),Wt(0,"svg",15),Er(1,"use"),un()),2&n){const t=pr().$implicit;F(),x2("href","assets/icons/",t.icon,".svg#",t.icon,"")}}function nMe(n,e){if(1&n){const t=zo();Wt(0,"button",11),mi("click",function(r){const s=pi(t).$implicit;return fi(pr().displayView(r,s))}),Rs(1,tMe,2,3,"svg",14),ki(2),un()}if(2&n){const t=e.$implicit;F(),jn("ngIf",t.icon),F(),dl(" ",t.name," ")}}let y6=(()=>{class n{eventDisplay;dialog;trigger;showCartesianGrid=!1;scale=3e3;views;show3DPoints;origin=new Dt(0,0,0);sub;constructor(t,i){this.eventDisplay=t,this.dialog=i}ngOnInit(){this.views=this.eventDisplay.getUIManager().getPresetViews(),this.sub=this.eventDisplay.getThreeManager().originChanged.subscribe(t=>{this.origin=t})}openCartesianGridConfigDialog(){this.dialog.open(aK,{data:{gridVisible:this.showCartesianGrid,scale:this.scale},position:{bottom:"5rem",left:"3rem"}})}displayView(t,i){t.stopPropagation(),this.eventDisplay.getUIManager().displayView(i)}setAxis(t){const i=t.checked;this.eventDisplay.getUIManager().setShowAxis(i)}setEtaPhiGrid(t){const i=t.checked;this.eventDisplay.getUIManager().setShowEtaPhiGrid(i)}setCartesianGrid(t){this.showCartesianGrid=t.checked,this.eventDisplay.getUIManager().setShowCartesianGrid(this.showCartesianGrid,this.scale)}showLabels(t){this.eventDisplay.getUIManager().showLabels(t.checked)}show3DMousePoints(t){this.show3DPoints=t.checked,this.eventDisplay.getUIManager().show3DMousePoints(this.show3DPoints)}toggleShowDistance(t){this.trigger.closeMenu(),this.eventDisplay.getUIManager().show3DDistance(t.checked)}ngOnDestroy(){this.sub.unsubscribe()}static \u0275fac=function(i){return new(i||n)(Q(ll),Q(Rx))};static \u0275cmp=wr({type:n,selectors:[["app-view-options"]],viewQuery:function(i,r){if(1&i&&ul(iM,5),2&i){let s;ia(s=ra())&&(r.trigger=s.first)}},decls:31,vars:3,consts:[["viewOptions",""],["showCartesianGridCheckbox",""],["showEtaPhiGridCheckbox",""],["showAxisCheckbox",""],["showLabelsCheckbox",""],["showMouse3DPointsCheckbox",""],["show3DDistanceCheckbox",""],["mat-menu-item",""],[3,"click","change"],[1,"icon-wrapper","icon-button","btn-blank","item-settings",3,"click"],["href","assets/icons/gear.svg#gear"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["tooltip","View options and Tools","icon","views",3,"matMenuTriggerFor","active"],["class","view-icon",4,"ngIf"],[1,"view-icon"]],template:function(i,r){if(1&i){const s=zo();Wt(0,"mat-menu",null,0)(2,"button",7)(3,"mat-checkbox",8,1),mi("click",function(l){return pi(s),fi(l.stopPropagation())})("change",function(l){return pi(s),fi(r.setCartesianGrid(l))}),ki(5,"Show Cartesian Grid "),un(),Wt(6,"button",9),mi("click",function(){return pi(s),fi(r.openCartesianGridConfigDialog())}),Fr(),Wt(7,"svg"),Er(8,"use",10),un()()(),vo(),Wt(9,"button",11),mi("click",function(l){pi(s);const h=Ha(11);return l.stopPropagation(),fi(h._inputElement.nativeElement.click())}),Wt(10,"mat-checkbox",8,2),mi("click",function(l){return pi(s),fi(l.stopPropagation())})("change",function(l){return pi(s),fi(r.setEtaPhiGrid(l))}),ki(12,"Show Eta Phi Grid "),un()(),Wt(13,"button",11),mi("click",function(l){pi(s);const h=Ha(15);return l.stopPropagation(),fi(h._inputElement.nativeElement.click())}),Wt(14,"mat-checkbox",8,3),mi("click",function(l){return pi(s),fi(l.stopPropagation())})("change",function(l){return pi(s),fi(r.setAxis(l))}),ki(16,"Show Axis "),un()(),Wt(17,"button",11),mi("click",function(){return pi(s),fi(Ha(19)._inputElement.nativeElement.click())}),Wt(18,"mat-checkbox",8,4),mi("click",function(l){return pi(s),fi(l.stopPropagation())})("change",function(l){return pi(s),fi(r.showLabels(l))}),ki(20,"Show Labels "),un()(),Wt(21,"button",11),mi("click",function(l){pi(s);const h=Ha(23);return l.stopPropagation(),fi(h._inputElement.nativeElement.click())}),Wt(22,"mat-checkbox",8,5),mi("click",function(l){return pi(s),fi(l.stopPropagation())})("change",function(l){return pi(s),fi(r.show3DMousePoints(l))}),ki(24,"Show 3D Coordinates "),un()(),Wt(25,"button",11),mi("click",function(l){pi(s);const h=Ha(27);return l.stopPropagation(),fi(h._inputElement.nativeElement.click())}),Wt(26,"mat-checkbox",8,6),mi("click",function(l){return pi(s),fi(l.stopPropagation())})("change",function(l){return pi(s),fi(r.toggleShowDistance(l))}),ki(28,"Show 3D Distance "),un()(),Rs(29,nMe,3,2,"button",12),un(),Er(30,"app-menu-toggle",13)}if(2&i){const s=Ha(1);F(29),jn("ngForOf",r.views),F(),jn("matMenuTriggerFor",s)("active",!1)}},dependencies:[pm,Wd,py,fy,iM,mv,Hc],styles:[".view-icon[_ngcontent-%COMP%]{width:1.2rem;height:1.2rem;margin-right:.5rem}.icon-wrapper[_ngcontent-%COMP%]{display:inline-block;width:1.5rem;height:1.5rem;padding:.23rem;transition:all .4s;transform:translateY(27%)}.icon-wrapper.icon-button[_ngcontent-%COMP%]:hover{background:var(--phoenix-options-icon-bg);border-radius:40%;cursor:pointer}.icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:top}.item-settings[_ngcontent-%COMP%]{margin-right:.2rem;margin-left:.5rem}"]})}return n})();function rMe(n,e){1&n&&(Wt(0,"li",2),ki(1," No actions. "),un())}function sMe(n,e){if(1&n&&(Wt(0,"li",2),ki(1),un()),2&n){const t=e.$implicit;F(),dl(" ",t," ")}}let lK=(()=>{class n{eventDisplay;showInfoPanel;actionsList=[];version="3.0.0";constructor(t){this.eventDisplay=t}ngOnInit(){this.actionsList=this.eventDisplay.getInfoLogger().getInfoLoggerList()}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-info-panel-overlay"]],inputs:{showInfoPanel:"showInfoPanel"},decls:6,vars:5,consts:[["overlayTitle","Info Panel","icon","info-panel",3,"resizable","active"],[1,"list-group","list-group-flush"],[1,"list-group-item"],["class","list-group-item",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"]],template:function(i,r){1&i&&(Wt(0,"app-overlay",0)(1,"ul",1)(2,"li",2),ki(3),un(),Rs(4,rMe,2,0,"li",3)(5,sMe,2,1,"li",4),un()()),2&i&&(jn("resizable",!0)("active",r.showInfoPanel),F(3),dl(" Phoenix Version: ",r.version," "),F(),jn("ngIf",0===r.actionsList.length),F(),jn("ngForOf",r.actionsList))},dependencies:[pm,Wd,cM],styles:[".list-group-item[_ngcontent-%COMP%]{font-size:.8rem;padding:.5rem 1rem}"]})}return n})(),v6=(()=>{class n{overlay;showInfoPanel=!1;overlayWindow;constructor(t){this.overlay=t}ngOnInit(){const t=this.overlay.create(),i=new hy(lK);this.overlayWindow=t.attach(i),this.overlayWindow.instance.showInfoPanel=this.showInfoPanel}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.showInfoPanel=!this.showInfoPanel,this.overlayWindow.instance.showInfoPanel=this.showInfoPanel}static \u0275fac=function(i){return new(i||n)(Q(fu))};static \u0275cmp=wr({type:n,selectors:[["app-info-panel"]],decls:1,vars:1,consts:[["tooltip","Info panel","icon","info-panel",3,"click","active"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.toggleOverlay()}),un()),2&i&&jn("active",r.showInfoPanel)},dependencies:[Hc]})}return n})(),vP=(()=>{class n{eventDisplay;orthographicView=!1;constructor(t){this.eventDisplay=t}switchMainView(){this.orthographicView=!this.orthographicView,this.eventDisplay.getUIManager().toggleOrthographicView(this.orthographicView)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-main-view-toggle"]],decls:1,vars:2,consts:[[3,"click","icon","matTooltip"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.switchMainView()}),un()),2&i&&jn("icon",r.orthographicView?"perspective":"orthographic")("matTooltip","Switch to "+(r.orthographicView?"perspective":"orthographic")+" view")},dependencies:[my,Hc]})}return n})(),b6=(()=>{class n{eventDisplay;allCameras;zoomFactor=1.1;zoomTimeout;zoomTime=200;constructor(t){this.eventDisplay=t}zoomTo(t){this.zoomTime=this.zoomTime>30?Math.floor(this.zoomTime/1.1):this.zoomTime,this.eventDisplay.zoomTo(t,this.zoomTime),this.zoomTimeout=setTimeout(()=>{this.zoomTo(t)},this.zoomTime)}zoomIn(t){t&&this.zoomTo(1/this.zoomFactor)}zoomOut(t){t&&this.zoomTo(this.zoomFactor)}clearZoom(){this.zoomTime=200,clearTimeout(this.zoomTimeout)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-zoom-controls"]],decls:3,vars:2,consts:[[1,"d-flex"],["tooltip","Zoom out (hold)","icon","zoom-out",3,"click","touchstart","mousedown","mouseup","mouseleave","touchend","touchcancel","touchmove","active"],["tooltip","Zoom in (hold)","icon","zoom-in",3,"click","touchstart","mousedown","mouseup","mouseleave","touchend","touchcancel","touchmove","active"]],template:function(i,r){1&i&&(Wt(0,"div",0)(1,"app-menu-toggle",1),mi("click",function(){return r.zoomOut(!0),r.clearZoom()})("touchstart",function(){return r.zoomOut(!0)})("mousedown",function(o){return r.zoomOut(0===o.button)})("mouseup",function(){return r.clearZoom()})("mouseleave",function(){return r.clearZoom()})("touchend",function(){return r.clearZoom()})("touchcancel",function(){return r.clearZoom()})("touchmove",function(){return r.clearZoom()}),un(),Wt(2,"app-menu-toggle",2),mi("click",function(){return r.zoomIn(!0),r.clearZoom()})("touchstart",function(){return r.zoomIn(!0)})("mousedown",function(o){return r.zoomIn(0===o.button)})("mouseup",function(){return r.clearZoom()})("mouseleave",function(){return r.clearZoom()})("touchend",function(){return r.clearZoom()})("touchcancel",function(){return r.clearZoom()})("touchmove",function(){return r.clearZoom()}),un()()),2&i&&(F(),jn("active",!1),F(),jn("active",!1))},dependencies:[Hc]})}return n})(),bP=(()=>{class n{eventDisplay;isAnimating=!1;constructor(t){this.eventDisplay=t}toggleAnimateEvent(){this.isAnimating||(this.isAnimating=!0,this.eventDisplay.animateEventWithCollision(1e4,()=>{this.isAnimating=!1}))}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-animate-event"]],decls:1,vars:1,consts:[["tooltip","Animate event","icon","event-folder",3,"click","active"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.toggleAnimateEvent()}),un()),2&i&&jn("active",r.isAnimating)},dependencies:[Hc]})}return n})(),x6=(()=>{class n{eventDisplay;vrSupported=!1;vrActive=!1;constructor(t){this.eventDisplay=t,navigator?.xr?.isSessionSupported?.(CW.SESSION_TYPE).then(i=>{i&&(this.vrSupported=!0)}).catch(i=>console.warn("Error in VR",i))}toggleVr(){this.vrActive?(this.eventDisplay.endXR(Mm.VR),this.vrActive=!1):(this.eventDisplay.initXR(Mm.VR,()=>{this.vrActive=!1,this.eventDisplay.endXR(Mm.VR)}),this.vrActive=!0)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-vr-toggle"]],decls:1,vars:3,consts:[["icon","vr",3,"click","disabled","active","tooltip"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.vrSupported&&r.toggleVr()}),un()),2&i&&jn("disabled",!r.vrSupported)("active",r.vrActive)("tooltip",r.vrSupported?r.vrActive?"Exit VR":"Enter VR":"VR not supported")},dependencies:[Hc]})}return n})();function oMe(n,e){if(1&n){const t=zo();bg(0),Wt(1,"button",4),mi("click",function(){return pi(t),fi(pr().toggleAr(!0))}),ki(2,"AR with overlays"),un(),Wt(3,"button",4),mi("click",function(){return pi(t),fi(pr().toggleAr(!1))}),ki(4,"AR without overlays"),un(),xg()}}function aMe(n,e){1&n&&(Wt(0,"button",5),ki(1,"AR not supported"),un())}let w6=(()=>{class n{eventDisplay;arSupported=!1;arActive=!1;constructor(t){this.eventDisplay=t,navigator.xr?.isSessionSupported?.(OL.SESSION_TYPE).then(i=>{i&&(this.arSupported=!0)}).catch(i=>console.warn("Error in AR",i))}toggleAr(t=!0){OL.enableDomOverlay=t,this.arActive?(this.eventDisplay.endXR(Mm.AR),this.arActive=!1):(this.eventDisplay.initXR(Mm.AR,()=>{this.arActive=!1,this.eventDisplay.endXR(Mm.AR)}),this.arActive=!0)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-ar-toggle"]],decls:5,vars:6,consts:[["arToggleOptions",""],[4,"ngIf"],["mat-menu-item","","disabled","",4,"ngIf"],["icon","ar",3,"click","matMenuTriggerFor","disabled","active","tooltip"],["mat-menu-item","",3,"click"],["mat-menu-item","","disabled",""]],template:function(i,r){if(1&i){const s=zo();Wt(0,"mat-menu",null,0),Rs(2,oMe,5,0,"ng-container",1)(3,aMe,2,0,"button",2),un(),Wt(4,"app-menu-toggle",3),mi("click",function(){return pi(s),fi(r.arSupported&&(r.arActive?r.toggleAr():null))}),un()}if(2&i){const s=Ha(1);F(2),jn("ngIf",r.arSupported),F(),jn("ngIf",!r.arSupported),F(),jn("matMenuTriggerFor",s)("disabled",!r.arSupported)("active",r.arActive)("tooltip",r.arSupported?r.arActive?"Exit AR":"Enter AR":"AR not supported")}},dependencies:[Wd,py,fy,iM,Hc]})}return n})(),C6=(()=>{class n{ssMode=!1;ngOnInit(){document.onfullscreenchange=()=>{document.fullscreenElement||this.toggleSSMode()}}toggleSSMode(){this.ssMode=!this.ssMode,document.body.classList.toggle("ss-mode"),this.ssMode?(setTimeout(()=>{document.addEventListener("click",this.onDocumentClick),document.addEventListener("touchstart",this.onDocumentClick)},1),document.documentElement.requestFullscreen?.()):(document.removeEventListener("click",this.onDocumentClick),document.removeEventListener("touchstart",this.onDocumentClick))}onDocumentClick=()=>{document.exitFullscreen?.()};static \u0275fac=function(i){return new(i||n)};static \u0275cmp=wr({type:n,selectors:[["app-ss-mode"]],decls:1,vars:1,consts:[["tooltip","Screenshot mode: phoenix will become fullscreen and the menu is suppressed","icon","ss-mode",3,"click","active"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.toggleSSMode()}),un()),2&i&&jn("active",r.ssMode)},dependencies:[Hc],styles:["#uiMenu,#phoenixMenu,#mainLogo,#statsElement{transition:opacity .4s}.ss-mode #uiMenu,.ss-mode #phoenixMenu,.ss-mode #mainLogo,.ss-mode #statsElement{visibility:hidden;opacity:0}\n"],encapsulation:2})}return n})(),cMe=(()=>{class n{constructor(){this._listeners=[]}notify(t,i){for(let r of this._listeners)r(t,i)}listen(t){return this._listeners.push(t),()=>{this._listeners=this._listeners.filter(i=>t!==i)}}ngOnDestroy(){this._listeners=[]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const hMe=["input"],uMe=["formField"],dMe=["*"];let hK=0;class uK{constructor(e,t){this.source=e,this.value=t}}const fMe={provide:Wf,useExisting:Ma(()=>fK),multi:!0},dK=new Ai("MatRadioGroup"),pMe=new Ai("mat-radio-default-options",{providedIn:"root",factory:function mMe(){return{color:"accent",disabledInteractive:!1}}});let fK=(()=>{class n{get name(){return this._name}set name(t){this._name=t,this._updateRadioButtonNames()}get labelPosition(){return this._labelPosition}set labelPosition(t){this._labelPosition="before"===t?"before":"after",this._markRadiosForCheck()}get value(){return this._value}set value(t){this._value!==t&&(this._value=t,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}_checkSelectedRadioButton(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)}get selected(){return this._selected}set selected(t){this._selected=t,this.value=t?t.value:null,this._checkSelectedRadioButton()}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._markRadiosForCheck()}get required(){return this._required}set required(t){this._required=t,this._markRadiosForCheck()}get disabledInteractive(){return this._disabledInteractive}set disabledInteractive(t){this._disabledInteractive=t,this._markRadiosForCheck()}constructor(t){this._changeDetector=t,this._value=null,this._name="mat-radio-group-"+hK++,this._selected=null,this._isInitialized=!1,this._labelPosition="after",this._disabled=!1,this._required=!1,this._controlValueAccessorChangeFn=()=>{},this.onTouched=()=>{},this.change=new os,this._disabledInteractive=!1}ngAfterContentInit(){this._isInitialized=!0,this._buttonChanges=this._radios.changes.subscribe(()=>{this.selected&&!this._radios.find(t=>t===this.selected)&&(this._selected=null)})}ngOnDestroy(){this._buttonChanges?.unsubscribe()}_touch(){this.onTouched&&this.onTouched()}_updateRadioButtonNames(){this._radios&&this._radios.forEach(t=>{t.name=this.name,t._markForCheck()})}_updateSelectedRadioFromValue(){this._radios&&(null===this._selected||this._selected.value!==this._value)&&(this._selected=null,this._radios.forEach(i=>{i.checked=this.value===i.value,i.checked&&(this._selected=i)}))}_emitChangeEvent(){this._isInitialized&&this.change.emit(new uK(this._selected,this._value))}_markRadiosForCheck(){this._radios&&this._radios.forEach(t=>t._markForCheck())}writeValue(t){this.value=t,this._changeDetector.markForCheck()}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetector.markForCheck()}static#e=this.\u0275fac=function(i){return new(i||n)(Q(Ac))};static#t=this.\u0275dir=mr({type:n,selectors:[["mat-radio-group"]],contentQueries:function(i,r,s){if(1&i&&Cp(s,E6,5),2&i){let o;ia(o=ra())&&(r._radios=o)}},hostAttrs:["role","radiogroup",1,"mat-mdc-radio-group"],inputs:{color:"color",name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:[2,"disabled","disabled",js],required:[2,"required","required",js],disabledInteractive:[2,"disabledInteractive","disabledInteractive",js]},outputs:{change:"change"},exportAs:["matRadioGroup"],standalone:!0,features:[Bo([fMe,{provide:dK,useExisting:n}]),kl]})}return n})(),E6=(()=>{class n{get checked(){return this._checked}set checked(t){this._checked!==t&&(this._checked=t,t&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!t&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),t&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(t){this._value!==t&&(this._value=t,null!==this.radioGroup&&(this.checked||(this.checked=this.radioGroup.value===t),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(t){this._labelPosition=t}get disabled(){return this._disabled||null!==this.radioGroup&&this.radioGroup.disabled}set disabled(t){this._setDisabled(t)}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(t){this._required=t}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._defaultOptions&&this._defaultOptions.color||"accent"}set color(t){this._color=t}get disabledInteractive(){return this._disabledInteractive||null!==this.radioGroup&&this.radioGroup.disabledInteractive}set disabledInteractive(t){this._disabledInteractive=t}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(t,i,r,s,o,l,h,u){this._elementRef=i,this._changeDetector=r,this._focusMonitor=s,this._radioDispatcher=o,this._defaultOptions=h,this._ngZone=oi(ns),this._uniqueId="mat-radio-"+ ++hK,this.id=this._uniqueId,this.disableRipple=!1,this.tabIndex=0,this.change=new os,this._checked=!1,this._value=null,this._removeUniqueSelectionListener=()=>{},this._injector=oi(Dr),this._onInputClick=f=>{this.disabled&&this.disabledInteractive&&f.preventDefault()},this.radioGroup=t,this._noopAnimations="NoopAnimations"===l,this._disabledInteractive=h?.disabledInteractive??!1,u&&(this.tabIndex=vh(u,0))}focus(t,i){i?this._focusMonitor.focusVia(this._inputElement,i,t):this._inputElement.nativeElement.focus(t)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name),this._removeUniqueSelectionListener=this._radioDispatcher.listen((t,i)=>{t!==this.id&&i===this.name&&(this.checked=!1)})}ngDoCheck(){this._updateTabIndex()}ngAfterViewInit(){this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{!t&&this.radioGroup&&this.radioGroup._touch()}),this._ngZone.runOutsideAngular(()=>{this._inputElement.nativeElement.addEventListener("click",this._onInputClick)})}ngOnDestroy(){this._inputElement?.nativeElement.removeEventListener("click",this._onInputClick),this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new uK(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputInteraction(t){if(t.stopPropagation(),!this.checked&&!this.disabled){const i=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),i&&this.radioGroup._emitChangeEvent())}}_onTouchTargetClick(t){this._onInputInteraction(t),(!this.disabled||this.disabledInteractive)&&this._inputElement?.nativeElement.focus()}_setDisabled(t){this._disabled!==t&&(this._disabled=t,this._changeDetector.markForCheck())}_updateTabIndex(){const t=this.radioGroup;let i;if(i=t&&t.selected&&!this.disabled?t.selected===this?this.tabIndex:-1:this.tabIndex,i!==this._previousTabIndex){const r=this._inputElement?.nativeElement;r&&(r.setAttribute("tabindex",i+""),this._previousTabIndex=i,AA(()=>{queueMicrotask(()=>{t&&t.selected&&t.selected!==this&&document.activeElement===r&&(t.selected?._inputElement.nativeElement.focus(),document.activeElement===r&&this._inputElement.nativeElement.blur())})},{injector:this._injector}))}}static#e=this.\u0275fac=function(i){return new(i||n)(Q(dK,8),Q(ro),Q(Ac),Q(cy),Q(cMe),Q(gh,8),Q(pMe,8),an("tabindex"))};static#t=this.\u0275cmp=wr({type:n,selectors:[["mat-radio-button"]],viewQuery:function(i,r){if(1&i&&(ul(hMe,5),ul(uMe,7,ro)),2&i){let s;ia(s=ra())&&(r._inputElement=s.first),ia(s=ra())&&(r._rippleTrigger=s.first)}},hostAttrs:[1,"mat-mdc-radio-button"],hostVars:19,hostBindings:function(i,r){1&i&&mi("focus",function(){return r._inputElement.nativeElement.focus()}),2&i&&(ja("id",r.id)("tabindex",null)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),Ka("mat-primary","primary"===r.color)("mat-accent","accent"===r.color)("mat-warn","warn"===r.color)("mat-mdc-radio-checked",r.checked)("mat-mdc-radio-disabled",r.disabled)("mat-mdc-radio-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable",r._noopAnimations))},inputs:{id:"id",name:"name",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],disableRipple:[2,"disableRipple","disableRipple",js],tabIndex:[2,"tabIndex","tabIndex",t=>null==t?0:vh(t)],checked:[2,"checked","checked",js],value:"value",labelPosition:"labelPosition",disabled:[2,"disabled","disabled",js],required:[2,"required","required",js],color:"color",disabledInteractive:[2,"disabledInteractive","disabledInteractive",js]},outputs:{change:"change"},exportAs:["matRadioButton"],standalone:!0,features:[kl,ah],ngContentSelectors:dMe,decls:13,vars:17,consts:[["formField",""],["input",""],["mat-internal-form-field","",3,"labelPosition"],[1,"mdc-radio"],[1,"mat-mdc-radio-touch-target",3,"click"],["type","radio",1,"mdc-radio__native-control",3,"change","id","checked","disabled","required"],[1,"mdc-radio__background"],[1,"mdc-radio__outer-circle"],[1,"mdc-radio__inner-circle"],["mat-ripple","",1,"mat-radio-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mdc-label",3,"for"]],template:function(i,r){if(1&i){const s=zo();xd(),Wt(0,"div",2,0)(2,"div",3)(3,"div",4),mi("click",function(l){return pi(s),fi(r._onTouchTargetClick(l))}),un(),Wt(4,"input",5,1),mi("change",function(l){return pi(s),fi(r._onInputInteraction(l))}),un(),Wt(6,"div",6),Er(7,"div",7)(8,"div",8),un(),Wt(9,"div",9),Er(10,"div",10),un()(),Wt(11,"label",11),ou(12),un()()}2&i&&(jn("labelPosition",r.labelPosition),F(2),Ka("mdc-radio--disabled",r.disabled),F(2),jn("id",r.inputId)("checked",r.checked)("disabled",r.disabled&&!r.disabledInteractive)("required",r.required),ja("name",r.name)("value",r.value)("aria-label",r.ariaLabel)("aria-labelledby",r.ariaLabelledby)("aria-describedby",r.ariaDescribedby)("aria-disabled",r.disabled&&r.disabledInteractive?"true":null),F(5),jn("matRippleTrigger",r._rippleTrigger.nativeElement)("matRippleDisabled",r._isRippleDisabled())("matRippleCentered",!0),F(2),jn("for",r.inputId))},dependencies:[L0,bN],styles:['.mat-mdc-radio-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-radio-button .mdc-radio{display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color;padding:calc((var(--mdc-radio-state-layer-size) - 20px)/2)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:not([disabled]):not(:focus)~.mdc-radio__background::before{opacity:.04;transform:scale(1)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:not([disabled])~.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-hover-icon-color, var(--mat-app-on-surface))}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-hover-icon-color, var(--mat-app-primary))}.mat-mdc-radio-button .mdc-radio:active .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-pressed-icon-color, var(--mat-app-on-surface))}.mat-mdc-radio-button .mdc-radio:active .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:active .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-pressed-icon-color, var(--mat-app-primary))}.mat-mdc-radio-button .mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mat-mdc-radio-button .mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1);width:var(--mdc-radio-state-layer-size);height:var(--mdc-radio-state-layer-size);top:calc(-1*(var(--mdc-radio-state-layer-size) - 20px)/2);left:calc(-1*(var(--mdc-radio-state-layer-size) - 20px)/2)}.mat-mdc-radio-button .mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-radio-button .mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 90ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-radio-button .mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;top:0;right:0;left:0;cursor:inherit;z-index:1;width:var(--mdc-radio-state-layer-size);height:var(--mdc-radio-state-layer-size)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{transition:border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color, var(--mat-app-on-surface));opacity:var(--mdc-radio-disabled-unselected-icon-opacity)}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{cursor:default}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color, var(--mat-app-on-surface));opacity:var(--mdc-radio-disabled-selected-icon-opacity)}.mat-mdc-radio-button .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-icon-color, var(--mat-app-on-surface-variant))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-icon-color, var(--mat-app-primary))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-focus-icon-color, var(--mat-app-primary))}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle{transform:scale(0.5);transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled{pointer-events:auto}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color, var(--mat-app-on-surface));opacity:var(--mdc-radio-disabled-unselected-icon-opacity)}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled:hover .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled:hover .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:checked:focus+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:checked:focus+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color, var(--mat-app-on-surface));opacity:var(--mdc-radio-disabled-selected-icon-opacity)}.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__background::before,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__outer-circle,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__inner-circle{transition:none !important}.mat-mdc-radio-button .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color, var(--mat-app-on-surface))}.mat-mdc-radio-button.mat-mdc-radio-checked .mat-ripple-element,.mat-mdc-radio-button.mat-mdc-radio-checked .mdc-radio__background::before{background-color:var(--mat-radio-checked-ripple-color, var(--mat-app-primary))}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mat-ripple-element,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color, var(--mat-app-on-surface))}.mat-mdc-radio-button .mat-internal-form-field{color:var(--mat-radio-label-text-color, var(--mat-app-on-surface));font-family:var(--mat-radio-label-text-font, var(--mat-app-body-medium-font));line-height:var(--mat-radio-label-text-line-height, var(--mat-app-body-medium-line-height));font-size:var(--mat-radio-label-text-size, var(--mat-app-body-medium-size));letter-spacing:var(--mat-radio-label-text-tracking, var(--mat-app-body-medium-tracking));font-weight:var(--mat-radio-label-text-weight, var(--mat-app-body-medium-weight))}.mat-mdc-radio-button .mdc-radio--disabled+label{color:var(--mat-radio-disabled-label-color)}.mat-mdc-radio-button .mat-radio-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:50%}.mat-mdc-radio-button .mat-radio-ripple .mat-ripple-element{opacity:.14}.mat-mdc-radio-button .mat-radio-ripple::before{border-radius:50%}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:focus:enabled:not(:checked)~.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-focus-icon-color, black)}.mat-mdc-radio-button.cdk-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-radio-disabled{cursor:default;pointer-events:none}.mat-mdc-radio-disabled.mat-mdc-radio-disabled-interactive{pointer-events:auto}.mat-mdc-radio-touch-target{position:absolute;top:50%;left:50%;height:48px;width:48px;transform:translate(-50%, -50%);display:var(--mat-radio-touch-target-display)}[dir=rtl] .mat-mdc-radio-touch-target{left:auto;right:50%;transform:translate(50%, -50%)}'],encapsulation:2,changeDetection:0})}return n})(),AMe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({imports:[zh,rS,qB,E6,zh]})}return n})();function gMe(n,e){if(1&n&&(Wt(0,"mat-radio-button",12),ki(1),un()),2&n){const t=e.$implicit;jn("value",t),F(),dl("",t," ")}}let S6=(()=>{class n{eventDisplay;fittings=["Crop","Stretch"];fitting="Crop";width=3840;height=2160;disabled=!1;constructor(t){this.eventDisplay=t}ngOnInit(){}checkSize(){return this.eventDisplay.getThreeManager().checkScreenShotCanvasSize(this.width,this.height,this.fitting)}setWidth(t){this.width=t,this.disabled=!this.checkSize()}setHeight(t){this.height=t,this.disabled=!this.checkSize()}buttonText(){return this.disabled?"Size too large":"Create picture"}makePicture(){this.eventDisplay.getThreeManager().makeScreenShot(this.width,this.height,this.fitting)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-make-picture"]],decls:20,vars:11,consts:[["menu",""],["width",""],["height",""],[1,"mat-menu"],["mat-menu-item","",1,"size-input",3,"click"],["mapInput","","type","number",3,"change","click","value"],["mat-menu-item","",3,"click"],[1,"fitting-radios",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["mat-menu-item","",1,"make-picture",3,"click","disabled"],["tooltip","Creates a picture from the current view: directly saves a png of arbitrary size from the current view","icon","png",3,"matMenuTriggerFor"],["hidden","","id","screenshotCanvas"],[3,"value"]],template:function(i,r){if(1&i){const s=zo();Wt(0,"mat-menu",3,0)(2,"button",4),mi("click",function(l){return pi(s),fi(l.stopPropagation())}),Wt(3,"label"),ki(4,"width"),un(),Wt(5,"input",5,1),mi("change",function(){pi(s);const l=Ha(6);return fi(r.setWidth(l.value))})("click",function(l){return pi(s),fi(l.stopPropagation())}),un()(),Wt(7,"button",4),mi("click",function(l){return pi(s),fi(l.stopPropagation())}),Wt(8,"label"),ki(9,"height"),un(),Wt(10,"input",5,2),mi("change",function(){pi(s);const l=Ha(11);return fi(r.setHeight(l.value))})("click",function(l){return pi(s),fi(l.stopPropagation())}),un()(),Wt(12,"button",6),mi("click",function(l){return pi(s),fi(l.stopPropagation())}),Wt(13,"mat-radio-group",7),C0("ngModelChange",function(l){return pi(s),z_(r.fitting,l)||(r.fitting=l),fi(l)}),Rs(14,gMe,2,2,"mat-radio-button",8),un()(),Wt(15,"button",9),mi("click",function(){return pi(s),fi(r.makePicture())}),ki(16),un()(),Er(17,"app-menu-toggle",10),Wt(18,"div"),Er(19,"canvas",11),un()}if(2&i){const s=Ha(1);F(5),Ka("badSize",r.disabled),jn("value",3840),F(5),Ka("badSize",r.disabled),jn("value",2610),F(3),w0("ngModel",r.fitting),F(),jn("ngForOf",r.fittings),F(),jn("disabled",r.disabled),F(),dl(" ",r.buttonText()," "),F(),jn("matMenuTriggerFor",s)}},dependencies:[pm,eP,FT,py,fy,iM,fK,E6,Hc],styles:[".size-input{background:transparent;color:var(--phoenix-text-color);text-align:center}.size-input label{width:60px}.size-input input{background:transparent;color:var(--phoenix-text-color);width:80px}.badSize{border-color:red}.make-picture{text-align:center;display:block}.make-picture span{padding:5px 25px;border:2px solid var(--phoenix-text-color);border-radius:8px}\n"],encapsulation:2})}return n})(),T6=(()=>{class n{eventDisplay;performanceMode=!1;constructor(t){this.eventDisplay=t}togglePerformance(){this.performanceMode=!this.performanceMode,this.eventDisplay.getThreeManager().setAntialiasing(!this.performanceMode)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-performance-toggle"]],decls:1,vars:1,consts:[["tooltip","Performance mode","icon","performance",3,"click","active"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.togglePerformance()}),un()),2&i&&jn("active",r.performanceMode)},dependencies:[Hc]})}return n})();var _Me=Te(7390);const yMe=["qrcodeCanvas"];let pK=(()=>{class n{dialogRef;baseLink;shareLink;embedLink;urlOptions=Object.assign({},ove);qrcodeCanvas;constructor(t){this.dialogRef=t;const i=window.location.href,r=-1===i.lastIndexOf("?")?i.length:i.lastIndexOf("?");this.baseLink=i.slice(0,r),this.shareLink=new WC(this.baseLink),this.embedLink=this.getEmbedLink()}ngAfterViewInit(){this.updateQRCode(this.shareLink.value),this.shareLink.onUpdate(this.updateQRCode.bind(this))}onClose(){this.dialogRef.close()}getEmbedLink(t=""){return`<iframe src="${this.baseLink}?embed=true${t?"&":""}${t}"></iframe>`}setOptionValue(t,i){this.urlOptions[t]=i,this.onOptionsChange()}onOptionsChange(){const t=Object.getOwnPropertyNames(this.urlOptions).reduce((i,r)=>(this.urlOptions[r]&&i.push(`${r}=${encodeURI(this.urlOptions[r])}`),i),[]).join("&");this.shareLink.update(this.baseLink+(t?"?":"")+t),this.embedLink=this.getEmbedLink(t)}copyText(t,i){const r=document.createElement("input");document.body.appendChild(r),r.value=t,r.select(),document.execCommand("copy"),document.body.removeChild(r),i.focus(),i.innerText="COPIED",setTimeout(()=>{i.innerText="COPY"},2e3)}updateQRCode(t){_Me.toCanvas(this.qrcodeCanvas.nativeElement,t)}static \u0275fac=function(i){return new(i||n)(Q(Px))};static \u0275cmp=wr({type:n,selectors:[["app-share-link-dialog"]],viewQuery:function(i,r){if(1&i&&ul(yMe,5),2&i){let s;ia(s=ra())&&(r.qrcodeCanvas=s.first)}},decls:49,vars:5,consts:[["qrcodeCanvas",""],[1,"dialog"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-content"],[1,"form-group","mt-2"],["for","eventDataFile"],["type","text","id","eventDataFile","placeholder","assets/files/event_data/atlaseventdump2.json",1,"form-control",3,"input","value"],[1,"form-group"],["for","eventDataType"],["id","eventDataType",1,"form-control",3,"input"],["selected","","value",""],["value","jivexml"],["value","json"],["for","configuration"],["type","text","id","configuration","placeholder","assets/files/config/phoenix-config.json",1,"form-control",3,"input","value"],[3,"change","checked"],[1,"share-box","my-2"],[1,"share-box-copy",3,"click"],[1,"qrcode","d-flex","justify-content-center"],["mat-dialog-actions",""],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(i,r){if(1&i){const s=zo();Wt(0,"div",1)(1,"h1",2),ki(2,"Create shareable link"),un(),Wt(3,"div",3)(4,"h5"),ki(5,"URL options"),un(),Wt(6,"div",4)(7,"label",5),ki(8,"Event data file (URL or path)"),un(),Wt(9,"input",6),mi("input",function(l){return pi(s),fi(r.setOptionValue("file",l.target.value))}),un()(),Wt(10,"div",7)(11,"label",8),ki(12,"Event data type"),un(),Wt(13,"select",9),mi("input",function(l){return pi(s),fi(r.setOptionValue("type",l.target.value))}),Wt(14,"option",10),ki(15,"Select"),un(),Wt(16,"option",11),ki(17,"JiveXML"),un(),Wt(18,"option",12),ki(19,"JSON"),un()()(),Wt(20,"div",7)(21,"label",13),ki(22,"Configuration (URL or path)"),un(),Wt(23,"input",14),mi("input",function(l){return pi(s),fi(r.setOptionValue("config",l.target.value))}),un()(),Wt(24,"div",7)(25,"mat-checkbox",15),mi("change",function(l){return pi(s),fi(r.setOptionValue("hideWidgets",l.checked))}),ki(26," Hide all widgets "),un()(),Wt(27,"h5"),ki(28,"Share"),un(),Wt(29,"div",16)(30,"span"),ki(31),un(),Wt(32,"button",17),mi("click",function(l){return pi(s),fi(r.copyText(r.shareLink.value,l.target))}),ki(33," COPY "),un()(),Wt(34,"h5"),ki(35,"Embed"),un(),Wt(36,"div",16)(37,"span"),ki(38),un(),Wt(39,"button",17),mi("click",function(l){return pi(s),fi(r.copyText(r.embedLink,l.target))}),ki(40," COPY "),un()(),Wt(41,"h5"),ki(42,"QR Code"),un(),Wt(43,"div",18),Er(44,"canvas",null,0),un()(),Wt(46,"div",19)(47,"button",20),mi("click",function(){return pi(s),fi(r.onClose())}),ki(48,"Close"),un()()()}2&i&&(F(9),jn("value",r.urlOptions.file),F(14),jn("value",r.urlOptions.config),F(2),jn("checked",r.urlOptions.hideWidgets),F(6),_A(r.shareLink.value),F(7),_A(r.embedLink))},dependencies:[zT,VT,HT,hM,oM,aM,mv],styles:[".share-box[_ngcontent-%COMP%]{width:30rem;max-width:100%;position:relative;background:var(--phoenix-background-color-tertiary);border:1px solid var(--phoenix-border);border-radius:.5rem;padding:1.25rem;word-wrap:break-word}.share-box[_ngcontent-%COMP%]   .share-box-copy[_ngcontent-%COMP%]{position:absolute;top:-1px;right:-1px;background:transparent;color:inherit;cursor:pointer;padding:.25rem .5rem;font-size:.75rem;border:1px solid var(--phoenix-border);border-radius:.5rem}.share-box[_ngcontent-%COMP%]   .share-box-copy[_ngcontent-%COMP%]:hover{background:var(--phoenix-border)}"]})}return n})(),D6=(()=>{class n{dialog;constructor(t){this.dialog=t}openShareLinkDialog(){this.dialog.open(pK)}static \u0275fac=function(i){return new(i||n)(Q(Rx))};static \u0275cmp=wr({type:n,selectors:[["app-share-link"]],decls:1,vars:1,consts:[["tooltip","Create shareable link","icon","share",3,"click","active"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.openShareLinkDialog()}),un()),2&i&&jn("active",!1)},dependencies:[Hc]})}return n})();const vMe=["*"];let qT=(()=>{class n{eventDataImportOptions=Object.values(ef);animationPresets=aX;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=wr({type:n,selectors:[["app-ui-menu"]],inputs:{eventDataImportOptions:"eventDataImportOptions",animationPresets:"animationPresets"},ngContentSelectors:vMe,decls:23,vars:2,consts:[[3,"animationPresets"],[3,"eventDataImportOptions"]],template:function(i,r){1&i&&(xd(),Wt(0,"app-ui-menu-wrapper"),Er(1,"app-event-selector")(2,"app-zoom-controls")(3,"app-view-options")(4,"app-auto-rotate")(5,"app-dark-theme")(6,"app-object-clipping")(7,"app-main-view-toggle")(8,"app-overlay-view")(9,"app-object-selection")(10,"app-info-panel")(11,"app-animate-event")(12,"app-animate-camera",0)(13,"app-collections-info")(14,"app-geometry-browser")(15,"app-performance-toggle")(16,"app-vr-toggle")(17,"app-ar-toggle")(18,"app-ss-mode")(19,"app-make-picture")(20,"app-io-options",1)(21,"app-share-link"),ou(22),un()),2&i&&(F(12),jn("animationPresets",r.animationPresets),F(8),jn("eventDataImportOptions",r.eventDataImportOptions))},dependencies:[DN,a6,UY,f6,p6,m6,A6,_6,_P,yP,y6,v6,vP,b6,TN,bP,x6,w6,C6,S6,T6,D6]})}return n})();function bMe(n,e){if(1&n&&(Wt(0,"a",5),Er(1,"img",6),un()),2&n){const t=pr();jn("href",t.url,T_),F(),jn("src",t.logo,T_)}}function xMe(n,e){if(1&n&&(Wt(0,"p")(1,"b"),ki(2),un()()),2&n){const t=pr();F(2),_A(t.tagline)}}function wMe(n,e){if(1&n&&(bg(0),Wt(1,"b"),ki(2),un(),ki(3),xg()),2&n){const t=pr().$implicit;F(2),dl("",t.label,": "),F(),dl("",t.value," ")}}function CMe(n,e){if(1&n&&(bg(0),ki(1),xg()),2&n){const t=pr().$implicit;F(),dl(" ",t," ")}}function MMe(n,e){if(1&n&&(Wt(0,"p"),Rs(1,wMe,4,2,"ng-container",3)(2,CMe,2,1,"ng-container",3),un()),2&n){const t=e.$implicit;F(),jn("ngIf",t.label),F(),jn("ngIf",!t.label)}}let xP=(()=>{class n{eventDisplay;experimentInfo;url;logo;tagline;constructor(t){this.eventDisplay=t}ngOnInit(){this.eventDisplay.listenToDisplayedEventChange(()=>{this.experimentInfo=this.eventDisplay.getEventMetadata()})}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-experiment-info"]],inputs:{url:"url",logo:"logo",tagline:"tagline"},decls:5,vars:3,consts:[["id","experimentInfo","cdkDrag","","cdkDragBoundary","body",1,"experimentInfo"],["class","experimentLogoWrapper","target","_blank","rel","noopener noreferrer",3,"href",4,"ngIf"],[1,"textInfo"],[4,"ngIf"],[4,"ngFor","ngForOf"],["target","_blank","rel","noopener noreferrer",1,"experimentLogoWrapper",3,"href"],["alt","",1,"experimentLogo",3,"src"]],template:function(i,r){1&i&&(Wt(0,"div",0),Rs(1,bMe,2,2,"a",1),Wt(2,"div",2),Rs(3,xMe,3,1,"p",3)(4,MMe,3,2,"p",4),un()()),2&i&&(F(),jn("ngIf",r.url),F(2),jn("ngIf",r.tagline),F(),jn("ngForOf",r.experimentInfo))},dependencies:[pm,Wd,s6],styles:[".experimentInfo[_ngcontent-%COMP%]{position:absolute;top:5rem;left:1rem;display:flex;flex-direction:row;justify-items:flex-end;justify-content:flex-end;align-items:center;align-content:center;font-family:Courier New,Lucida Console,monospace;cursor:move}.experimentLogoWrapper[_ngcontent-%COMP%]{width:6rem}.experimentLogoWrapper[_ngcontent-%COMP%]   .experimentLogo[_ngcontent-%COMP%]{width:100%;height:100%}.textInfo[_ngcontent-%COMP%]{margin-left:1rem}.textInfo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary);font-size:.8rem;margin-bottom:.5rem;-webkit-user-select:none;user-select:none}@media screen and (max-width: 768px){.experimentInfo[_ngcontent-%COMP%]{top:4rem;max-width:40%}.experimentLogoWrapper[_ngcontent-%COMP%]{height:4rem}.textInfo[_ngcontent-%COMP%]{display:none}}"]})}return n})();const EMe=["switch"],SMe=["*"];function TMe(n,e){1&n&&(Wt(0,"span",10),Fr(),Wt(1,"svg",12),Er(2,"path",13),un(),Wt(3,"svg",14),Er(4,"path",15),un()())}const DMe=new Ai("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1,hideIcon:!1,disabledInteractive:!1})}),IMe={provide:Wf,useExisting:Ma(()=>I6),multi:!0};class mK{constructor(e,t){this.source=e,this.checked=t}}let BMe=0,I6=(()=>{class n{_createChangeEvent(t){return new mK(this,t)}get buttonId(){return`${this.id||this._uniqueId}-button`}focus(){this._switchElement.nativeElement.focus()}get checked(){return this._checked}set checked(t){this._checked=t,this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(t,i,r,s,o,l){this._elementRef=t,this._focusMonitor=i,this._changeDetectorRef=r,this.defaults=o,this._onChange=h=>{},this._onTouched=()=>{},this._validatorOnChange=()=>{},this._checked=!1,this.name=null,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.disabled=!1,this.disableRipple=!1,this.tabIndex=0,this.change=new os,this.toggleChange=new os,this.tabIndex=parseInt(s)||0,this.color=o.color||"accent",this._noopAnimations="NoopAnimations"===l,this.id=this._uniqueId="mat-mdc-slide-toggle-"+ ++BMe,this.hideIcon=o.hideIcon??!1,this.disabledInteractive=o.disabledInteractive??!1,this._labelId=this._uniqueId+"-label"}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{"keyboard"===t||"program"===t?(this._focused=!0,this._changeDetectorRef.markForCheck()):t||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnChanges(t){t.required&&this._validatorOnChange()}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(t){this.checked=!!t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}validate(t){return this.required&&!0!==t.value?{required:!0}:null}registerOnValidatorChange(t){this._validatorOnChange=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}_handleClick(){this.disabled||(this.toggleChange.emit(),this.defaults.disableToggleValue||(this.checked=!this.checked,this._onChange(this.checked),this.change.emit(new mK(this,this.checked))))}_getAriaLabelledBy(){return this.ariaLabelledby?this.ariaLabelledby:this.ariaLabel?null:this._labelId}static#e=this.\u0275fac=function(i){return new(i||n)(Q(ro),Q(cy),Q(Ac),an("tabindex"),Q(DMe),Q(gh,8))};static#t=this.\u0275cmp=wr({type:n,selectors:[["mat-slide-toggle"]],viewQuery:function(i,r){if(1&i&&ul(EMe,5),2&i){let s;ia(s=ra())&&(r._switchElement=s.first)}},hostAttrs:[1,"mat-mdc-slide-toggle"],hostVars:13,hostBindings:function(i,r){2&i&&(k1("id",r.id),ja("tabindex",null)("aria-label",null)("name",null)("aria-labelledby",null),gA(r.color?"mat-"+r.color:""),Ka("mat-mdc-slide-toggle-focused",r._focused)("mat-mdc-slide-toggle-checked",r.checked)("_mat-animation-noopable",r._noopAnimations))},inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],required:[2,"required","required",js],color:"color",disabled:[2,"disabled","disabled",js],disableRipple:[2,"disableRipple","disableRipple",js],tabIndex:[2,"tabIndex","tabIndex",t=>null==t?0:vh(t)],checked:[2,"checked","checked",js],hideIcon:[2,"hideIcon","hideIcon",js],disabledInteractive:[2,"disabledInteractive","disabledInteractive",js]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],standalone:!0,features:[Bo([IMe,{provide:pu,useExisting:n,multi:!0}]),kl,dc,ah],ngContentSelectors:SMe,decls:13,vars:27,consts:[["switch",""],["mat-internal-form-field","",3,"labelPosition"],["role","switch","type","button",1,"mdc-switch",3,"click","tabIndex","disabled"],[1,"mdc-switch__track"],[1,"mdc-switch__handle-track"],[1,"mdc-switch__handle"],[1,"mdc-switch__shadow"],[1,"mdc-elevation-overlay"],[1,"mdc-switch__ripple"],["mat-ripple","",1,"mat-mdc-slide-toggle-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-switch__icons"],[1,"mdc-label",3,"click","for"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--on"],["d","M19.69,5.23L8.96,15.96l-4.23-4.23L2.96,13.5l6,6L21.46,7L19.69,5.23z"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--off"],["d","M20 13H4v-2h16v2z"]],template:function(i,r){if(1&i){const s=zo();xd(),Wt(0,"div",1)(1,"button",2,0),mi("click",function(){return pi(s),fi(r._handleClick())}),Er(3,"span",3),Wt(4,"span",4)(5,"span",5)(6,"span",6),Er(7,"span",7),un(),Wt(8,"span",8),Er(9,"span",9),un(),Rs(10,TMe,5,0,"span",10),un()()(),Wt(11,"label",11),mi("click",function(l){return pi(s),fi(l.stopPropagation())}),ou(12),un()()}if(2&i){const s=Ha(2);jn("labelPosition",r.labelPosition),F(),Ka("mdc-switch--selected",r.checked)("mdc-switch--unselected",!r.checked)("mdc-switch--checked",r.checked)("mdc-switch--disabled",r.disabled)("mat-mdc-slide-toggle-disabled-interactive",r.disabledInteractive),jn("tabIndex",r.disabled&&!r.disabledInteractive?-1:r.tabIndex)("disabled",r.disabled&&!r.disabledInteractive),ja("id",r.buttonId)("name",r.name)("aria-label",r.ariaLabel)("aria-labelledby",r._getAriaLabelledBy())("aria-describedby",r.ariaDescribedby)("aria-required",r.required||null)("aria-checked",r.checked)("aria-disabled",r.disabled&&r.disabledInteractive?"true":null),F(8),jn("matRippleTrigger",s)("matRippleDisabled",r.disableRipple||r.disabled)("matRippleCentered",!0),F(),U_(r.hideIcon?-1:10),F(),jn("for",r.buttonId),ja("id",r._labelId)}},dependencies:[L0,bN],styles:['.mdc-switch{align-items:center;background:none;border:none;cursor:pointer;display:inline-flex;flex-shrink:0;margin:0;outline:none;overflow:visible;padding:0;position:relative;width:var(--mdc-switch-track-width)}.mdc-switch.mdc-switch--disabled{cursor:default;pointer-events:none}.mdc-switch.mat-mdc-slide-toggle-disabled-interactive{pointer-events:auto}.mdc-switch__track{overflow:hidden;position:relative;width:100%;height:var(--mdc-switch-track-height);border-radius:var(--mdc-switch-track-shape, var(--mat-app-corner-full))}.mdc-switch--disabled.mdc-switch .mdc-switch__track{opacity:var(--mdc-switch-disabled-track-opacity)}.mdc-switch__track::before,.mdc-switch__track::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";height:100%;left:0;position:absolute;width:100%;border-width:var(--mat-switch-track-outline-width);border-color:var(--mat-switch-track-outline-color, var(--mat-app-outline))}.cdk-high-contrast-active .mdc-switch__track::before,.cdk-high-contrast-active .mdc-switch__track::after{border-color:currentColor}.mdc-switch--selected .mdc-switch__track::before,.mdc-switch--selected .mdc-switch__track::after{border-width:var(--mat-switch-selected-track-outline-width);border-color:var(--mat-switch-selected-track-outline-color)}.mdc-switch--disabled .mdc-switch__track::before,.mdc-switch--disabled .mdc-switch__track::after{border-width:var(--mat-switch-disabled-unselected-track-outline-width);border-color:var(--mat-switch-disabled-unselected-track-outline-color, var(--mat-app-on-surface))}.mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0);background:var(--mdc-switch-unselected-track-color, var(--mat-app-surface-variant))}.mdc-switch--selected .mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch--selected .mdc-switch__track::before{transform:translateX(-100%)}.mdc-switch--selected .mdc-switch__track::before{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mdc-switch--unselected .mdc-switch__track::before{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-hover-track-color, var(--mat-app-surface-variant))}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-focus-track-color, var(--mat-app-surface-variant))}.mdc-switch:enabled:active .mdc-switch__track::before{background:var(--mdc-switch-unselected-pressed-track-color, var(--mat-app-surface-variant))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__track::before,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__track::before,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__track::before,.mdc-switch.mdc-switch--disabled .mdc-switch__track::before{background:var(--mdc-switch-disabled-unselected-track-color, var(--mat-app-surface-variant))}.mdc-switch__track::after{transform:translateX(-100%);background:var(--mdc-switch-selected-track-color, var(--mat-app-primary))}[dir=rtl] .mdc-switch__track::after{transform:translateX(100%)}.mdc-switch--selected .mdc-switch__track::after{transform:translateX(0)}.mdc-switch--selected .mdc-switch__track::after{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::after{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-hover-track-color, var(--mat-app-primary))}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-focus-track-color, var(--mat-app-primary))}.mdc-switch:enabled:active .mdc-switch__track::after{background:var(--mdc-switch-selected-pressed-track-color, var(--mat-app-primary))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__track::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__track::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__track::after,.mdc-switch.mdc-switch--disabled .mdc-switch__track::after{background:var(--mdc-switch-disabled-selected-track-color, var(--mat-app-on-surface))}.mdc-switch__handle-track{height:100%;pointer-events:none;position:absolute;top:0;transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);left:0;right:auto;transform:translateX(0);width:calc(100% - var(--mdc-switch-handle-width))}[dir=rtl] .mdc-switch__handle-track{left:auto;right:0}.mdc-switch--selected .mdc-switch__handle-track{transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__handle-track{transform:translateX(-100%)}.mdc-switch__handle{display:flex;pointer-events:auto;position:absolute;top:50%;transform:translateY(-50%);left:0;right:auto;transition:width 75ms cubic-bezier(0.4, 0, 0.2, 1),height 75ms cubic-bezier(0.4, 0, 0.2, 1),margin 75ms cubic-bezier(0.4, 0, 0.2, 1);width:var(--mdc-switch-handle-width);height:var(--mdc-switch-handle-height);border-radius:var(--mdc-switch-handle-shape, var(--mat-app-corner-full))}[dir=rtl] .mdc-switch__handle{left:auto;right:0}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{width:var(--mat-switch-unselected-handle-size);height:var(--mat-switch-unselected-handle-size);margin:var(--mat-switch-unselected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-unselected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{width:var(--mat-switch-selected-handle-size);height:var(--mat-switch-selected-handle-size);margin:var(--mat-switch-selected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-selected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch__handle:has(.mdc-switch__icons){width:var(--mat-switch-with-icon-handle-size);height:var(--mat-switch-with-icon-handle-size)}.mat-mdc-slide-toggle .mdc-switch:active:not(.mdc-switch--disabled) .mdc-switch__handle{width:var(--mat-switch-pressed-handle-size);height:var(--mat-switch-pressed-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected:active:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-selected-pressed-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected:active:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-unselected-pressed-handle-horizontal-margin)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-selected-handle-opacity)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-unselected-handle-opacity)}.mdc-switch__handle::before,.mdc-switch__handle::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";width:100%;height:100%;left:0;position:absolute;top:0;transition:background-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1),border-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);z-index:-1}.cdk-high-contrast-active .mdc-switch__handle::before,.cdk-high-contrast-active .mdc-switch__handle::after{border-color:currentColor}.mdc-switch--selected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-selected-handle-color, var(--mat-app-on-primary))}.mdc-switch--selected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-hover-handle-color, var(--mat-app-primary-container))}.mdc-switch--selected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-focus-handle-color, var(--mat-app-primary-container))}.mdc-switch--selected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-selected-pressed-handle-color, var(--mat-app-primary-container))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:hover:not(:focus):not(:active) .mdc-switch__handle::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:focus:not(:active) .mdc-switch__handle::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:active .mdc-switch__handle::after,.mdc-switch--selected.mdc-switch--disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-selected-handle-color, var(--mat-app-surface))}.mdc-switch--unselected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-unselected-handle-color, var(--mat-app-outline))}.mdc-switch--unselected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-hover-handle-color, var(--mat-app-on-surface-variant))}.mdc-switch--unselected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-focus-handle-color, var(--mat-app-on-surface-variant))}.mdc-switch--unselected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-unselected-pressed-handle-color, var(--mat-app-on-surface-variant))}.mdc-switch--unselected.mdc-switch--disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-unselected-handle-color, var(--mat-app-on-surface))}.mdc-switch__handle::before{background:var(--mdc-switch-handle-surface-color)}.mdc-switch__shadow{border-radius:inherit;bottom:0;left:0;position:absolute;right:0;top:0}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation-shadow)}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__shadow,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__shadow,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__shadow,.mdc-switch.mdc-switch--disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation-shadow)}.mdc-switch__ripple{left:50%;position:absolute;top:50%;transform:translate(-50%, -50%);z-index:-1;width:var(--mdc-switch-state-layer-size);height:var(--mdc-switch-state-layer-size)}.mdc-switch__ripple::after{content:"";opacity:0}.mdc-switch--disabled .mdc-switch__ripple::after{display:none}.mat-mdc-slide-toggle-disabled-interactive .mdc-switch__ripple::after{display:block}.mdc-switch:hover .mdc-switch__ripple::after{opacity:.04;transition:75ms opacity cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mdc-switch .mdc-switch__ripple::after{opacity:.12}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:focus .mdc-switch__ripple::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:active .mdc-switch__ripple::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:hover:not(:focus) .mdc-switch__ripple::after,.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-hover-state-layer-color, var(--mat-app-on-surface))}.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-focus-state-layer-color, var(--mat-app-on-surface))}.mdc-switch--unselected:enabled:active .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-pressed-state-layer-color, var(--mat-app-on-surface));opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity));transition:opacity 75ms linear}.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background:var(--mdc-switch-selected-hover-state-layer-color, var(--mat-app-primary))}.mdc-switch--selected:enabled:focus .mdc-switch__ripple::after{background:var(--mdc-switch-selected-focus-state-layer-color, var(--mat-app-primary))}.mdc-switch--selected:enabled:active .mdc-switch__ripple::after{background:var(--mdc-switch-selected-pressed-state-layer-color, var(--mat-app-primary));opacity:var(--mdc-switch-selected-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity));transition:opacity 75ms linear}.mdc-switch__icons{position:relative;height:100%;width:100%;z-index:1}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__icons{opacity:var(--mdc-switch-disabled-unselected-icon-opacity)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__icons{opacity:var(--mdc-switch-disabled-selected-icon-opacity)}.mdc-switch__icon{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;opacity:0;transition:opacity 30ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-switch--unselected .mdc-switch__icon{width:var(--mdc-switch-unselected-icon-size);height:var(--mdc-switch-unselected-icon-size);fill:var(--mdc-switch-unselected-icon-color, var(--mat-app-surface-variant))}.mdc-switch--unselected.mdc-switch--disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-unselected-icon-color, var(--mat-app-surface-variant))}.mdc-switch--selected .mdc-switch__icon{width:var(--mdc-switch-selected-icon-size);height:var(--mdc-switch-selected-icon-size);fill:var(--mdc-switch-selected-icon-color, var(--mat-app-on-primary-container))}.mdc-switch--selected.mdc-switch--disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-selected-icon-color, var(--mat-app-on-surface))}.mdc-switch--selected .mdc-switch__icon--on,.mdc-switch--unselected .mdc-switch__icon--off{opacity:1;transition:opacity 45ms 30ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle{-webkit-user-select:none;user-select:none;display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple,.mat-mdc-slide-toggle .mdc-switch__ripple::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple:not(:empty),.mat-mdc-slide-toggle .mdc-switch__ripple::after:not(:empty){transform:translateZ(0)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-slide-toggle .mat-internal-form-field{color:var(--mat-switch-label-text-color, var(--mat-app-on-surface));font-family:var(--mat-switch-label-text-font, var(--mat-app-body-medium-font));line-height:var(--mat-switch-label-text-line-height, var(--mat-app-body-medium-line-height));font-size:var(--mat-switch-label-text-size, var(--mat-app-body-medium-size));letter-spacing:var(--mat-switch-label-text-tracking, var(--mat-app-body-medium-tracking));font-weight:var(--mat-switch-label-text-weight, var(--mat-app-body-medium-weight))}.mat-mdc-slide-toggle .mat-ripple-element{opacity:.12}.mat-mdc-slide-toggle .mat-mdc-focus-indicator::before{border-radius:50%}.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle-track,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__icon,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::after,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::after{transition:none}.mat-mdc-slide-toggle .mdc-switch:enabled+.mdc-label{cursor:pointer}.mat-mdc-slide-toggle .mdc-switch--disabled+label{color:var(--mdc-switch-disabled-label-text-color)}'],encapsulation:2,changeDetection:0})}return n})(),kMe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({imports:[I6,zh,zh]})}return n})();function FMe(n,e){if(1&n){const t=zo();Wt(0,"input",4),mi("input",function(r){return pi(t),fi(pr().onValueChange(r.target.value))}),un()}2&n&&jn("value",pr().value)}let AK=(()=>{class n{value=0;min=0;oldMin=0;max=100;oldMax=0;step=1;allowCustomValue=!1;onChange=new os;onValueChange(t){t&&this.onChange.emit(t)}toggleMinCut(t){t.checked?this.min=this.oldMin:(this.oldMin=this.min,this.min=Number.MIN_SAFE_INTEGER)}toggleMaxCut(t){t.checked?this.max=this.oldMax:(this.oldMax=this.max,this.max=Number.MAX_SAFE_INTEGER)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=wr({type:n,selectors:[["app-config-slider"]],inputs:{value:"value",min:"min",max:"max",step:"step",allowCustomValue:"allowCustomValue"},outputs:{onChange:"onChange"},decls:4,vars:5,consts:[[1,"d-flex","flex-row","align-items-center"],["thumbLabel","",1,"mx-2",3,"min","max","step"],["matSliderThumb","",3,"valueChange","value"],["class","config-slider-input","type","number",3,"value","input",4,"ngIf"],["type","number",1,"config-slider-input",3,"input","value"]],template:function(i,r){1&i&&(Wt(0,"div",0)(1,"mat-slider",1)(2,"input",2),mi("valueChange",function(o){return r.onValueChange(o)}),un()(),Rs(3,FMe,1,1,"input",3),un()),2&i&&(F(),jn("min",r.min)("max",r.max)("step",r.step),F(),jn("value",r.value),F(),jn("ngIf",r.allowCustomValue))},dependencies:[Wd,g6,GT],styles:[".config-slider-input[_ngcontent-%COMP%]{background:transparent;color:var(--phoenix-text-color);border:none;border-bottom:1px solid var(--phoenix-text-color);width:25%;-moz-appearance:textfield}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none}"]})}return n})();const OMe=["phoenixMenuItem"],LMe=n=>({"top.px":n}),NMe=n=>({"font-weight-bold w-100":n}),UMe=n=>({"p-0":n}),zMe=n=>({expanded:n});function HMe(n,e){1&n&&C2(0)}function VMe(n,e){if(1&n){const t=zo();bg(0),Wt(1,"mat-slide-toggle",9),mi("change",function(r){return pi(t),fi(pr().currentNode.toggleSelfAndDescendants(r.checked))}),Rs(2,HMe,1,0,"ng-container",10),un(),xg()}if(2&n){const t=pr(),i=Ha(5);F(),jn("checked",t.currentNode.toggleState),F(),jn("ngTemplateOutlet",i)}}function GMe(n,e){if(1&n&&(Wt(0,"span",14),Fr(),Wt(1,"svg"),Er(2,"use"),un()()),2&n){const t=pr(2);F(2),x2("href","assets/icons/",t.currentNode.icon,".svg#",t.currentNode.icon,"")}}function qMe(n,e){if(1&n&&(Wt(0,"span",11),Rs(1,GMe,3,3,"span",12),Wt(2,"span",13),ki(3),un()()),2&n){const t=pr();F(),jn("ngIf",t.currentNode.icon),F(),jn("title",t.currentNode.name),F(),_A(t.currentNode.name)}}function QMe(n,e){if(1&n){const t=zo();Wt(0,"div",20),mi("click",function(){return pi(t),fi(pr(2).currentNode.configActive=!1)}),un()}}function jMe(n,e){if(1&n&&(Wt(0,"label",26),ki(1),un()),2&n){const t=pr(2).$implicit;jn("ngClass",jd(2,NMe,"label"===t.type)),F(),dl(" ",t.label," ")}}function WMe(n,e){if(1&n){const t=zo();Wt(0,"mat-checkbox",9),mi("change",function(r){pi(t);const s=pr(3).$implicit;return s.onChange(r.checked),fi(s.isChecked=r.checked)}),un()}2&n&&jn("checked",pr(3).$implicit.isChecked)}function $Me(n,e){if(1&n){const t=zo();Wt(0,"app-config-slider",34),mi("onChange",function(r){pi(t);const s=pr(3).$implicit;return s.onChange(r),fi(s.value=r)}),un()}if(2&n){const t=pr(3).$implicit;jn("value",t.value)("min",t.min)("max",t.max)("step",t.step)("allowCustomValue",t.allowCustomValue)}}function XMe(n,e){if(1&n){const t=zo();Wt(0,"button",35),mi("click",function(){return pi(t),fi(pr(3).$implicit.onClick())}),ki(1),un()}if(2&n){const t=pr(3).$implicit;F(),dl(" ",t.label," ")}}function YMe(n,e){if(1&n){const t=zo();Wt(0,"input",36),mi("input",function(r){pi(t);const s=pr(3).$implicit;return s.onChange(r.target.value),fi(s.color=r.target.value)}),un()}2&n&&jn("value",pr(3).$implicit.color)}function KMe(n,e){if(1&n){const t=zo();Wt(0,"div",37)(1,"div",38)(2,"mat-checkbox",39),C0("ngModelChange",function(r){pi(t);const s=pr(3).$implicit;return z_(s.enableMin,r)||(s.enableMin=r),fi(r)}),mi("change",function(r){return pi(t),fi(pr(3).$implicit.setEnableMin(r.checked))}),un(),Wt(3,"mat-checkbox",39),C0("ngModelChange",function(r){pi(t);const s=pr(3).$implicit;return z_(s.enableMax,r)||(s.enableMax=r),fi(r)}),mi("change",function(r){return pi(t),fi(pr(3).$implicit.setEnableMax(r.checked))}),un()(),Wt(4,"div",38)(5,"input",40),C0("ngModelChange",function(r){pi(t);const s=pr(3).$implicit;return z_(s.value,r)||(s.value=r),fi(r)}),mi("input",function(r){pi(t);const s=pr(3).$implicit;return s.value=r.target.value,fi(s.onChange(s))}),un(),Wt(6,"input",41),C0("ngModelChange",function(r){pi(t);const s=pr(3).$implicit;return z_(s.highValue,r)||(s.highValue=r),fi(r)}),mi("input",function(r){pi(t);const s=pr(3).$implicit;return s.highValue=r.target.value,fi(s.onChange(s))}),un()()()}if(2&n){const t=pr(3).$implicit;F(2),w0("ngModel",t.enableMin),F(),w0("ngModel",t.enableMax),F(2),w0("ngModel",t.value),F(),w0("ngModel",t.highValue)}}function ZMe(n,e){if(1&n&&(Wt(0,"option",44),ki(1),un()),2&n){const t=e.$implicit;jn("value",t),F(),dl(" ",t," ")}}function JMe(n,e){if(1&n){const t=zo();Wt(0,"select",42),mi("change",function(r){return pi(t),fi(pr(3).$implicit.onChange(r.target.value))}),Rs(1,ZMe,2,2,"option",43),un()}if(2&n){const t=pr(3).$implicit;F(),jn("ngForOf",t.options)}}function eEe(n,e){if(1&n&&(Wt(0,"div",27),Rs(1,WMe,1,1,"mat-checkbox",28)(2,$Me,1,5,"app-config-slider",29)(3,XMe,2,1,"button",30)(4,YMe,1,1,"input",31)(5,KMe,7,4,"div",32)(6,JMe,2,1,"select",33),un()),2&n){const t=pr(2).$implicit;jn("ngClass",jd(7,UMe,"button"===t.type)),F(),jn("ngSwitchCase","checkbox"),F(),jn("ngSwitchCase","slider"),F(),jn("ngSwitchCase","button"),F(),jn("ngSwitchCase","color"),F(),jn("ngSwitchCase","rangeSlider"),F(),jn("ngSwitchCase","select")}}function tEe(n,e){if(1&n&&(Wt(0,"div",23),Rs(1,jMe,2,4,"label",24)(2,eEe,7,9,"div",25),un()),2&n){const t=pr().$implicit;F(),jn("ngIf","button"!==t.type),F(),jn("ngIf","label"!==t.type)}}function nEe(n,e){if(1&n&&(bg(0,21),Rs(1,tEe,3,2,"div",22),xg()),2&n){const t=e.$implicit;jn("ngSwitch",t.type),F(),jn("ngIf",!t.hidden)}}function iEe(n,e){if(1&n){const t=zo();Wt(0,"div")(1,"button",15),mi("click",function(){pi(t);const r=pr();return r.calculateConfigTop(),fi(r.currentNode.configActive=!r.currentNode.configActive)}),Fr(),Wt(2,"svg"),Er(3,"use",16),un()(),Rs(4,QMe,1,0,"div",17),vo(),Wt(5,"div",18),Rs(6,nEe,2,2,"ng-container",19),un()()}if(2&n){const t=pr();F(4),jn("ngIf",t.currentNode.configActive),F(),jn("hidden",!t.currentNode.configActive)("ngStyle",jd(4,LMe,t.configTop)),F(),jn("ngForOf",t.castConfigsToAny(t.currentNode.configs))}}function rEe(n,e){if(1&n){const t=zo();Wt(0,"button",45),mi("click",function(){pi(t);const r=pr();return fi(r.currentNode.childrenActive=!r.currentNode.childrenActive)}),Fr(),Wt(1,"svg"),Er(2,"use",46),un()()}if(2&n){const t=pr();jn("ngClass",jd(1,zMe,t.currentNode.childrenActive))}}function sEe(n,e){1&n&&Er(0,"app-phoenix-menu-item",49),2&n&&jn("currentNode",e.$implicit)}function oEe(n,e){if(1&n&&(Wt(0,"div",47),Rs(1,sEe,1,1,"app-phoenix-menu-item",48),un()),2&n){const t=pr();F(),jn("ngForOf",t.currentNode.children)}}let gK=(()=>{class n{cdr;currentNode;phoenixMenuItem;configTop;constructor(t){this.cdr=t}calculateConfigTop(){this.phoenixMenuItem&&(this.configTop=this.phoenixMenuItem.nativeElement.getBoundingClientRect().top,this.cdr.detectChanges())}castConfigsToAny(t){return t}static \u0275fac=function(i){return new(i||n)(Q(Ac))};static \u0275cmp=wr({type:n,selectors:[["app-phoenix-menu-item"]],viewQuery:function(i,r){if(1&i&&ul(OMe,5),2&i){let s;ia(s=ra())&&(r.phoenixMenuItem=s.first)}},inputs:{currentNode:"currentNode"},decls:10,vars:5,consts:[["phoenixMenuItem",""],["nodeName",""],[1,"phoenix-menu-item"],[1,"phoenix-menu-item-left","align-items-center"],[4,"ngIf","ngIfElse"],[1,"phoenix-menu-item-right"],[4,"ngIf"],["class","icon-wrapper icon-button btn-blank item-expand","data-testid","dropdown",3,"ngClass","click",4,"ngIf"],["class","phoenix-menu-children",4,"ngIf"],[3,"change","checked"],[4,"ngTemplateOutlet"],[1,"d-flex","w-100","align-items-center"],["class","icon-wrapper item-icon",4,"ngIf"],[1,"item-name",3,"title"],[1,"icon-wrapper","item-icon"],[1,"icon-wrapper","icon-button","btn-blank","item-settings",3,"click"],["href","assets/icons/gear.svg#gear"],["class","item-config-backdrop",3,"click",4,"ngIf"],[1,"item-config",3,"hidden","ngStyle"],[3,"ngSwitch",4,"ngFor","ngForOf"],[1,"item-config-backdrop",3,"click"],[3,"ngSwitch"],["class","item-config-single",4,"ngIf"],[1,"item-config-single"],["class","item-config-label","for","item-config-field",3,"ngClass",4,"ngIf"],["class","item-config-data",3,"ngClass",4,"ngIf"],["for","item-config-field",1,"item-config-label",3,"ngClass"],[1,"item-config-data",3,"ngClass"],[3,"checked","change",4,"ngSwitchCase"],[3,"value","min","max","step","allowCustomValue","onChange",4,"ngSwitchCase"],["class","w-100","mat-button","","mat-stroked-button","",3,"click",4,"ngSwitchCase"],["id","item-config-field","type","color",3,"value","input",4,"ngSwitchCase"],["class","range-slider",4,"ngSwitchCase"],["id","item-config-field","class","w-100",3,"change",4,"ngSwitchCase"],[3,"onChange","value","min","max","step","allowCustomValue"],["mat-button","","mat-stroked-button","",1,"w-100",3,"click"],["id","item-config-field","type","color",3,"input","value"],[1,"range-slider"],[1,"range-slider-inputs","d-flex","justify-content-between"],[3,"ngModelChange","change","ngModel"],["type","number","placeholder","Min","step","config.step",1,"form-control","form-control-sm",3,"ngModelChange","input","ngModel"],["type","number","placeholder","Max","step","config.step",1,"form-control","form-control-sm",3,"ngModelChange","input","ngModel"],["id","item-config-field",1,"w-100",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["data-testid","dropdown",1,"icon-wrapper","icon-button","btn-blank","item-expand",3,"click","ngClass"],["href","assets/icons/expand.svg#expand"],[1,"phoenix-menu-children"],[3,"currentNode",4,"ngFor","ngForOf"],[3,"currentNode"]],template:function(i,r){if(1&i&&(Wt(0,"div",2,0)(2,"div",3),Rs(3,VMe,3,2,"ng-container",4)(4,qMe,4,3,"ng-template",null,1,xk),un(),Wt(6,"div",5),Rs(7,iEe,7,6,"div",6)(8,rEe,3,3,"button",7),un()(),Rs(9,oEe,2,1,"div",8)),2&i){const s=Ha(5);F(3),jn("ngIf",r.currentNode.onToggle)("ngIfElse",s),F(4),jn("ngIf",r.currentNode.configs.length>0),F(),jn("ngIf",r.currentNode.children.length>0),F(),jn("ngIf",r.currentNode.childrenActive)}},dependencies:[Mg,pm,Wd,MH,CH,cI,xH,hM,oM,aM,KB,jN,eP,FT,I6,mv,n,AK],styles:[".phoenix-menu-item{width:100%;padding:.6rem;background:var(--phoenix-background-color-secondary);color:var(--phoenix-text-color);font-size:.8rem;transition:all .5s;display:flex;justify-content:space-between;align-items:center}.phoenix-menu-item-left{display:flex;justify-content:flex-start;min-width:0;padding-right:.5rem;overflow:hidden}.phoenix-menu-item-left .item-name{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.phoenix-menu-item-left .item-icon{margin-right:.2rem}.phoenix-menu-item-right{display:flex;justify-content:flex-end}.phoenix-menu-item-right .item-expand.expanded{transform:scaleY(-1)}.phoenix-menu-item-right .item-settings{margin-right:.2rem}.phoenix-menu-item-right .item-config-backdrop{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:110}.phoenix-menu-item-right .item-config{position:absolute;margin-top:-5rem;right:100%;width:14rem;padding:.5rem;background:var(--phoenix-background-color-secondary);color:var(--phoenix-text-color-secondary);box-shadow:var(--phoenix-box-shadow);display:flex;flex-direction:column;z-index:120}.phoenix-menu-item-right .item-config>*{margin-bottom:.4rem}.phoenix-menu-item-right .item-config>*:last-child{margin-bottom:0}.phoenix-menu-item-right .item-config .item-config-single{display:flex;flex-direction:row}.phoenix-menu-item-right .item-config .item-config-single .item-config-label{width:30%}.phoenix-menu-item-right .item-config .item-config-single .item-config-data{flex-grow:1;padding-left:.5rem}.phoenix-menu-item .icon-wrapper{display:inline-block;width:1.3rem;height:1.3rem;padding:.23rem;transition:all .4s}.phoenix-menu-item .icon-wrapper.icon-button:hover{background:var(--phoenix-options-icon-bg);border-radius:40%;cursor:pointer}.phoenix-menu-item .icon-wrapper svg{width:100%;height:100%;vertical-align:top}.phoenix-menu-item .mat-slide-toggle-bar{width:30px!important}.phoenix-menu-item .mat-slide-toggle-thumb{width:15px!important;height:15px!important;position:absolute;top:2px}.phoenix-menu-item .mat-slider-horizontal{min-width:0;width:100%;height:20px}.phoenix-menu-item .mat-slider-horizontal .mat-slider-wrapper{top:10px}.phoenix-menu-item label.mat-checkbox-layout{margin:0}@media screen and (max-width: 768px){.phoenix-menu-item{font-size:.75rem;padding:.5rem}.phoenix-menu-item .icon-wrapper{width:1rem;height:1rem;padding:.15rem}}.phoenix-menu-children{margin-left:.5rem;border-left:1px solid var(--phoenix-accent)}.range-slider .range-slider-inputs{gap:20%}\n"],encapsulation:2})}return n})(),QT=(()=>{class n{rootNode;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=wr({type:n,selectors:[["app-phoenix-menu"]],inputs:{rootNode:"rootNode"},decls:2,vars:1,consts:[["id","phoenixMenu"],[3,"currentNode"]],template:function(i,r){1&i&&(Wt(0,"div",0),Er(1,"app-phoenix-menu-item",1),un()),2&i&&(F(),jn("currentNode",r.rootNode))},dependencies:[gK],styles:["[_nghost-%COMP%]{width:15rem;max-width:45%;position:absolute;top:5rem;right:1rem}#phoenixMenu[_ngcontent-%COMP%]{background:var(--phoenix-background-color-secondary);max-height:75vh;overflow-y:auto;box-shadow:var(--phoenix-box-shadow);z-index:100}@media screen and (max-width: 768px){#phoenixMenu[_ngcontent-%COMP%]{top:4rem}}"]})}return n})(),_K=(()=>{class n{experimentLink;ngOnInit(){const t=new URL(window.location.href);t.searchParams.delete("embed"),this.experimentLink=t.toString()}goToExperiment(){window.open(this.experimentLink,"_blank")}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=wr({type:n,selectors:[["app-experiment-link"]],decls:1,vars:0,consts:[["tooltip","See full event display","icon","link",3,"click"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.goToExperiment()}),un())},dependencies:[Hc]})}return n})(),dM=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=wr({type:n,selectors:[["app-embed-menu"]],decls:8,vars:0,consts:[["id","embedMenu"],["id","embedMenuInner"]],template:function(i,r){1&i&&(Wt(0,"div",0)(1,"div",1),Er(2,"app-dark-theme")(3,"app-auto-rotate")(4,"app-main-view-toggle")(5,"app-animate-event")(6,"app-animate-camera")(7,"app-experiment-link"),un()())},dependencies:[_P,yP,vP,TN,bP,_K],styles:["#embedMenu[_ngcontent-%COMP%]{display:none}#embedMenu[_ngcontent-%COMP%]   #embedMenuInner[_ngcontent-%COMP%]{display:flex;position:absolute;left:1rem;bottom:1rem;background:var(--phoenix-background-color-secondary);border:1px solid var(--phoenix-background-color-tertiary);box-shadow:var(--phoenix-box-shadow);border-radius:30px;padding:.25rem 0}"]})}return n})(),aEe=(()=>{class n{eventDisplay;phoenixMenuRoot=new ZC("Phoenix Menu","phoenix-menu");eventDataImportOptions=[ef.JSON,ef.JIVEXML,ef.ZIP];loaded=!1;loadingProgress=0;constructor(t){this.eventDisplay=t}ngOnInit(){let t;t={eventFile:"assets/files/JiveXML/JiveXML_336567_2327102923.xml",eventType:"jivexml"};const i={eventDataLoader:new uv(["CombinedMuonTracks","MuonSpectrometerTracks","CombinedInDetTracks","Muons_xAOD"]),presetViews:[new ad("Left View",[0,0,-12e3],[0,0,0],"left-cube"),new ad("Center View",[-500,12e3,0],[0,0,0],"top-cube"),new ad("Right View",[0,0,12e3],[0,0,0],"right-cube")],defaultView:[4e3,0,4e3,0,0,0],phoenixMenuRoot:this.phoenixMenuRoot,defaultEventFile:t};this.eventDisplay.init(i),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Barrel-Toroid.gltf.zip","Barrel Toroid","Magnets",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/End-Cap-Toroid.gltf.zip","Endcap","Magnets",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Feet.gltf.zip","Feet","Magnets",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Warm-Structure.gltf.zip","Warm structure","Magnets",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Lar-Barrel.gltf.zip","LAr Barrel","Calorimeters",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Lar-EMEC.gltf.zip","LAr EC1","Calorimeters",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Lar-FCAL.gltf.zip","LAr FCAL","Calorimeters",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Lar-HEC.gltf.zip","LAr HEC","Calorimeters",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Tile-Barrel.gltf.zip","Tile Cal","Calorimeters",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Tile-End-Cap.gltf.zip","Tile Cal EC","Calorimeters",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Beam.gltf.zip","Beam","Inner Detector",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Pixel.gltf.zip","Pixel","Inner Detector",1e3,!0),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/SCT-BAR.gltf.zip","SCT","Inner Detector",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/SCT-EC.gltf.zip","SCT Endcaps","Inner Detector",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/TRT-BAR.gltf.zip","TRT","Inner Detector",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/TRT-EC.gltf.zip","TRT Endcaps","Inner Detector",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Extra-Wheel.gltf.zip","Extra wheel","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Big-Wheel.gltf.zip","Big wheel","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Outer-Wheel.gltf.zip","Outer Wheel","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Muon-Barrel-Inner.gltf.zip","Muon Barrel Inner","Muon Spectrometer > Barrel",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Muon-Barrel-Middle.gltf.zip","Muon Barrel Middle","Muon Spectrometer > Barrel",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Muon-Barrel-Outer.gltf.zip","Muon Barrel Outer","Muon Spectrometer > Barrel",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Muon-Big-Wheel-MDT.gltf.zip","Big Wheel MDT ","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Small-Wheel-Chambers.gltf.zip","Small Wheel","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Small-Wheel-Hub.gltf.zip","Small Wheel Hub","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Small-Wheel-NJD.gltf.zip","Small Wheel Feet","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/TGC2.gltf.zip","TGC2","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/TGC3.gltf.zip","TGC3","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.getLoadingManager().addProgressListener(r=>this.loadingProgress=r),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>{console.log("Loading default configuration."),this.loaded=!0,this.eventDisplay.getURLOptionsManager().getURLOptions().get("config")||(new TA).loadStateFromJSON(yve)})}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-atlas"]],decls:7,vars:4,consts:[[3,"loaded","progress"],[3,"eventDataImportOptions"],["logo","assets/images/atlas.svg","url","https://home.cern/science/experiments/atlas","tagline","ATLAS Experiment at CERN"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&Er(0,"app-loader",0)(1,"app-nav")(2,"app-ui-menu",1)(3,"app-embed-menu")(4,"app-experiment-info",2)(5,"app-phoenix-menu",3)(6,"div",4),2&i&&(jn("loaded",r.loaded)("progress",r.loadingProgress),F(2),jn("eventDataImportOptions",r.eventDataImportOptions),F(3),jn("rootNode",r.phoenixMenuRoot))},dependencies:[vx,qT,xP,QT,bx,dM]})}return n})(),yK=(()=>{class n{lastEventsURL="";lastEventsOptions=!1;unzip(t){return(0,al.A)(function*(){const i=new(bB());yield i.loadAsync(t);let r="",s=!1;for(const o in i.files){if(s){console.error("Zip archive contains more than one file. Ignoring all but first");break}r=yield i.file(o).async("string"),s=!0}return r})()}makeRequest(t,i,r,s={}){return fetch(t,s).then(o=>o[i]()).then(o=>{"blob"===i?o.arrayBuffer().then(l=>this.unzip(l)).then(l=>r(l)):r(o)}).catch(o=>(console.error(o),!0)),!1}loadJSONEvent(t,i){i.parsePhoenixEvents(JSON.parse(t))}loadJiveXMLEvent(t,i){let r;r=i.configuration.eventDataLoader instanceof uv?i.configuration.eventDataLoader:new uv,r.process(t);const s=r.getEventData();i.buildEventDataFromJSON(s)}loadEvent(t,i,r={}){this.lastEventsURL=t,this.lastEventsOptions=r;const s="zip"===t.split(".").pop(),o=s?t.substring(0,t.length-4):t;return this.makeRequest(t,s?"blob":"text",l=>{switch(o.split(".").pop()){case"xml":this.loadJiveXMLEvent(l,i);break;case"json":this.loadJSONEvent(l,i)}},r)}reloadLastEvents(t){this.lastEventsURL.length>0&&this.loadEvent(this.lastEventsURL,t,this.lastEventsOptions)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$i({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const lEe=(n,e)=>({"active-icon":n,"reload-icon":e});let vK=(()=>{class n{eventDisplay;fileLoader;interval;tooltip;icon;active=!1;reloading=!1;intervalId;events;constructor(t,i){this.eventDisplay=t,this.fileLoader=i}ngOnInit(){this.eventDisplay.listenToLoadedEventsChange(t=>{this.events=t,this.active&&(clearInterval(this.intervalId),this.startCycleInterval())})}toggleCycle(){this.reloading=this.active&&!this.reloading,this.active=!this.active||this.reloading,console.log(this.active,this.reloading),clearInterval(this.intervalId),this.active&&this.startCycleInterval()}startCycleInterval(t=0){let i=t;this.eventDisplay.loadEvent(this.events[i]),i=i+1>=this.events.length?-1:i+1,this.intervalId=setInterval(()=>{-1==i&&(this.reloading&&this.fileLoader.reloadLastEvents(this.eventDisplay),i=0),this.eventDisplay.loadEvent(this.events[i]),i=i+1>=this.events.length?-1:i+1},this.interval)}static \u0275fac=function(i){return new(i||n)(Q(ll),Q(yK))};static \u0275cmp=wr({type:n,selectors:[["app-cycle-events"]],inputs:{interval:"interval",tooltip:"tooltip",icon:"icon"},decls:3,vars:4,consts:[["matTooltip","Cycle (off/on/on+reload)","matTooltipPosition","above","matTooltipTouchGestures","off",1,"cycle-events",3,"click"],[1,"cycle-events-icon",3,"ngClass"],["href","assets/icons/cycle-events.svg#cycle-events"]],template:function(i,r){1&i&&(Wt(0,"button",0),mi("click",function(){return r.toggleCycle()}),Fr(),Wt(1,"svg",1),Er(2,"use",2),un()()),2&i&&(F(),jn("ngClass",function bk(n,e,t,i,r){return k9(gi(),jl(),n,e,t,i,r)}(1,lEe,r.active,r.reloading)))},dependencies:[Mg,my],styles:["[_nghost-%COMP%]{display:flex;margin:0 .6rem}[_nghost-%COMP%]   .cycle-events[_ngcontent-%COMP%]{display:flex;background:unset;border:none;height:2.5rem;width:2.5rem;min-height:2.5rem;min-width:2.5rem;padding:.65rem;cursor:pointer;align-self:center;transition:all .4s}[_nghost-%COMP%]   .cycle-events-icon[_ngcontent-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   .cycle-events-icon.active-icon[_ngcontent-%COMP%]{--phoenix-options-icon-path: #00bcd4}[_nghost-%COMP%]   .cycle-events-icon.reload-icon[_ngcontent-%COMP%]{--phoenix-options-icon-path: #77dd77}[_nghost-%COMP%]   .cycle-events[_ngcontent-%COMP%]:hover{background-color:var(--phoenix-options-icon-bg);border-radius:40%;transition:all .4s}[_nghost-%COMP%]   .cycle-events.disabled[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.4}"]})}return n})(),cEe=(()=>{class n{eventDisplay;open=!1;constructor(t){this.eventDisplay=t}moveVP(t,i){for(const r of["Modules","Support","RFFoil","DeliveryPipes"])t.getObjectByName("VP > Left > "+r).position.setComponent(0,i),t.getObjectByName("VP > Right > "+r).position.setComponent(0,-i)}toggleVP(){this.open=!this.open,this.moveVP(this.eventDisplay.getThreeManager().getSceneManager(),this.open?30:0)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-vp-toggle"]],decls:1,vars:2,consts:[[3,"click","tooltip","icon"]],template:function(i,r){1&i&&(Wt(0,"app-menu-toggle",0),mi("click",function(){return r.toggleVP()}),un()),2&i&&jn("tooltip",(r.open?"Close":"Open")+"VP")("icon",r.open?"closevp":"openvp")},dependencies:[Hc]})}return n})(),hEe=(()=>{class n{eventDisplay;events;phoenixMenuRoot=new ZC("Phoenix Menu","phoenix-menu");loaded=!1;loadingProgress=0;eventDataImportOptions=[ef.JSON,ef.ZIP];constructor(t){this.eventDisplay=t}ngOnInit(){const t={eventDataLoader:new hv,presetViews:[new ad("Global View",[-8e3,6e3,0],[0,0,8e3],"perspective",$C.On,90,90),new ad("Calo View",[-8e3,6e3,16e3],[0,0,12e3],"perspective",$C.On,90,90),new ad("Side View",[-12e3,0,12e3],[0,0,12e3],"right-cube"),new ad("Vertex Locator View",[-500,1e3,0],[0,0,0],"top-cube"),new ad("Front View",[0,0,-6e3],[0,0,0],"left-cube"),new ad("Top View",[0,16e3,12e3],[0,0,12e3],"top-cube")],defaultView:[-8e3,6e3,0,0,0,8e3],phoenixMenuRoot:this.phoenixMenuRoot,defaultEventFile:{eventFile:"assets/files/lhcb/LHCbEventData.json",eventType:"json"}};this.eventDisplay.init(t);try{this.eventDisplay.loadGLTFGeometry("assets/geometry/LHCb/LHCb.glb.zip",void 0,void 0,1,!0)}catch(i){console.log("Error:",i)}this.eventDisplay.getLoadingManager().addProgressListener(i=>this.loadingProgress=i),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-lhcb"]],decls:28,vars:5,consts:[[3,"loaded","progress"],[3,"interval"],[3,"eventDataImportOptions"],["logo","assets/images/lhcb.svg","url","https://home.cern/science/experiments/lhcb","tagline","LHCb Experiment at CERN"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&(Er(0,"app-loader",0)(1,"app-nav"),Wt(2,"app-ui-menu-wrapper"),Er(3,"app-event-selector")(4,"app-cycle-events",1)(5,"app-zoom-controls")(6,"app-view-options")(7,"app-auto-rotate")(8,"app-dark-theme")(9,"app-object-clipping")(10,"app-main-view-toggle")(11,"app-overlay-view")(12,"app-object-selection")(13,"app-info-panel")(14,"app-animate-event")(15,"app-collections-info")(16,"app-performance-toggle")(17,"app-vr-toggle")(18,"app-ar-toggle")(19,"app-ss-mode")(20,"app-make-picture")(21,"app-io-options",2)(22,"app-share-link")(23,"app-vp-toggle"),un(),Er(24,"app-embed-menu")(25,"app-experiment-info",3)(26,"app-phoenix-menu",4)(27,"div",5)),2&i&&(jn("loaded",r.loaded)("progress",r.loadingProgress),F(4),jn("interval",5e3),F(17),jn("eventDataImportOptions",r.eventDataImportOptions),F(5),jn("rootNode",r.phoenixMenuRoot))},dependencies:[vx,DN,a6,f6,p6,m6,A6,_6,_P,yP,y6,xP,v6,vP,b6,QT,bP,x6,w6,C6,S6,T6,bx,D6,dM,vK,cEe]})}return n})(),uEe=(()=>{class n{eventDisplay;phoenixMenuRoot=new ZC("Phoenix Menu","phoenix-menu");loaded=!1;loadingProgress=0;eventDataImportOptions=[ef.JSON,ef.IG];constructor(t){this.eventDisplay=t}ngOnInit(){const t=new YW,i={eventDataLoader:t,presetViews:[new ad("Left View",[0,0,-12e3],[0,0,0],"left-cube"),new ad("Center View",[-500,12e3,0],[0,0,0],"top-cube"),new ad("Right View",[0,0,12e3],[0,0,0],"right-cube")],defaultView:[4e3,0,4e3,0,0,0],phoenixMenuRoot:this.phoenixMenuRoot};this.eventDisplay.init(i),this.eventDisplay.loadRootJSONGeometry("https://root.cern/js/files/geom/cms.json.gz","CMS Detector",void 0,10,!0),t.readIgArchive("assets/files/cms/Hto4l_120-130GeV.ig",r=>{const s=t.getAllEventsData(r);this.eventDisplay.parsePhoenixEvents(s)}),this.eventDisplay.getLoadingManager().addProgressListener(r=>this.loadingProgress=r),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}static \u0275fac=function(i){return new(i||n)(Q(ll))};static \u0275cmp=wr({type:n,selectors:[["app-cms"]],decls:7,vars:4,consts:[[3,"loaded","progress"],[3,"eventDataImportOptions"],["logo","assets/images/cms.svg","url","https://home.cern/science/experiments/cms","tagline","CMS Experiment at LHC, CERN"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&Er(0,"app-loader",0)(1,"app-nav")(2,"app-ui-menu",1)(3,"app-embed-menu")(4,"app-experiment-info",2)(5,"app-phoenix-menu",3)(6,"div",4),2&i&&(jn("loaded",r.loaded)("progress",r.loadingProgress),F(2),jn("eventDataImportOptions",r.eventDataImportOptions),F(3),jn("rootNode",r.phoenixMenuRoot))},dependencies:[vx,qT,xP,QT,bx,dM]})}return n})(),dEe=(()=>{class n{eventDisplay;http;hitsFile="assets/files/TrackML/event000001000-hits.csv";particlesFile="assets/files/TrackML/event000001000-particles.csv";truthFile="assets/files/TrackML/event000001000-truth.csv";filesProcessed=0;numFiles=3;trackMLLoader;httpOptions={headers:new mm({}),responseType:"text"};phoenixMenuRoot=new ZC("Phoenix Menu","phoenix-menu");loaded=!1;loadingProgress=0;constructor(t,i){this.eventDisplay=t,this.http=i}ngOnInit(){this.trackMLLoader=new uve;const t={eventDataLoader:this.trackMLLoader,presetViews:[new ad("Right View",[0,0,6e3],[0,0,0],"right-cube"),new ad("Center View",[-500,1e3,0],[0,0,0],"top-cube"),new ad("Left View",[0,0,-6e3],[0,0,0],"left-cube")],defaultView:[4e3,0,4e3,0,0,0],phoenixMenuRoot:this.phoenixMenuRoot};this.eventDisplay.init(t),this.eventDisplay.loadOBJGeometry("assets/geometry/TrackML/strip_long_simplified.obj","Long Strip",15311419,void 0,!0),this.eventDisplay.loadOBJGeometry("assets/geometry/TrackML/pixel_simplified.obj","Pixel",14854632,void 0,!0),this.eventDisplay.loadOBJGeometry("assets/geometry/TrackML/strip_short_simplified.obj","Short Strip",3579797,void 0,!0),this.eventDisplay.loadOBJGeometry("assets/geometry/TrackML/beampipe_simplified.obj","Beampipe",8355711,void 0,!0),this.eventDisplay.loadOBJGeometry("assets/geometry/TrackML/pixel_support_tube_simplified.obj","PST",8107007,void 0,!0),this.loadTrackMLData(),this.eventDisplay.getLoadingManager().addProgressListener(i=>this.loadingProgress=i),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}loadTrackMLData(){this.http.get(this.hitsFile,this.httpOptions).subscribe(t=>{this.loadHits(t),this.http.get(this.particlesFile,this.httpOptions).subscribe(i=>{this.loadParticles(i),this.http.get(this.truthFile,this.httpOptions).subscribe(r=>this.loadTruth(r))})})}loadHits(t){console.log("loading hits"),this.trackMLLoader.processHits(t),this.filesProcessed++,this.finishConversion()}loadParticles(t){console.log("loading particles"),this.trackMLLoader.processParticles(t),this.filesProcessed++,this.finishConversion()}loadTruth(t){console.log("loading truth"),this.trackMLLoader.processTruth(t),this.filesProcessed++,this.finishConversion()}finishConversion(){if(this.filesProcessed===this.numFiles){const t=this.trackMLLoader.getEventData("TrackMLEvent");this.eventDisplay.buildEventDataFromJSON(t)}}static \u0275fac=function(i){return new(i||n)(Q(ll),Q(hS))};static \u0275cmp=wr({type:n,selectors:[["app-trackml"]],decls:6,vars:3,consts:[[3,"loaded","progress"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&Er(0,"app-loader",0)(1,"app-nav")(2,"app-ui-menu")(3,"app-embed-menu")(4,"app-phoenix-menu",1)(5,"div",2),2&i&&(jn("loaded",r.loaded)("progress",r.loadingProgress),F(4),jn("rootNode",r.phoenixMenuRoot))},dependencies:[vx,qT,QT,bx,dM]})}return n})(),CEe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({imports:[zh,zh]})}return n})(),IEe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({})}return n})(),ASe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({imports:[zh,zh]})}return n})(),OSe=(()=>{class n{injector;constructor(t){this.injector=t}handleError(t){console.error("ERROR IN PHOENIX APP","\n",t),this.injector.get(ZL).setError(t)}static \u0275fac=function(i){return new(i||n)(Wn(Dr))};static \u0275prov=$i({token:n,factory:n.\u0275fac})}return n})(),LSe=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ua({type:n});static \u0275inj=oa({providers:[ll,ZL,{provide:qd,useClass:OSe}],imports:[rS,XG,B2e,bCe,PCe,Xxe,DT,Zwe,Jwe,Nxe,AMe,eMe,kMe,c2e,CEe,IEe,ASe]})}return n})(),NSe=(()=>{class n{eventDisplay;http;loaded=!1;loadingProgress=0;constructor(t,i){this.eventDisplay=t,this.http=i}ngOnInit(){const t={presetViews:[new ad("Left View",[0,0,-12e3],[0,0,0],"left-cube"),new ad("Center View",[-500,12e3,0],[0,0,0],"top-cube"),new ad("Right View",[0,0,12e3],[0,0,0],"right-cube")]};this.eventDisplay.init(t),this.eventDisplay.getLoadingManager().addProgressListener(i=>this.loadingProgress=i),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}static \u0275fac=function(i){return new(i||n)(Q(ll),Q(hS))};static \u0275cmp=wr({type:n,selectors:[["app-playground"]],decls:5,vars:2,consts:[[3,"loaded","progress"],["id","eventDisplay"]],template:function(i,r){1&i&&Er(0,"app-loader",0)(1,"app-nav")(2,"app-ui-menu")(3,"app-embed-menu")(4,"div",1),2&i&&jn("loaded",r.loaded)("progress",r.loadingProgress)},dependencies:[vx,qT,bx,dM]})}return n})();function VK(n){return new xi(3e3,!1)}function gv(n){switch(n.length){case 0:return new MT;case 1:return n[0];default:return new U$(n)}}function GK(n,e,t=new Map,i=new Map){const r=[],s=[];let o=-1,l=null;if(e.forEach(h=>{const u=h.get("offset"),f=u==o,y=f&&l||new Map;h.forEach((T,B)=>{let j=B,ne=T;if("offset"!==B)switch(j=n.normalizePropertyName(j,r),ne){case"!":ne=t.get(B);break;case uy:ne=i.get(B);break;default:ne=n.normalizeStyleValue(B,j,ne,r)}y.set(j,ne)}),f||s.push(y),l=y,o=u}),r.length)throw function aTe(){return new xi(3502,!1)}();return s}function O6(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&L6(t,"start",n)));break;case"done":n.onDone(()=>i(t&&L6(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&L6(t,"destroy",n)))}}function L6(n,e,t){const s=N6(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function N6(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function Dm(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function qK(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}const yTe=typeof document>"u"?null:document.documentElement;function U6(n){const e=n.parentNode||n.host||null;return e===yTe?null:e}let Fx=null,QK=!1;function jK(n,e){for(;e;){if(e===n)return!0;e=U6(e)}return!1}function WK(n,e,t){if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]}let z6=(()=>{class n{validateStyleProperty(t){return function bTe(n){Fx||(Fx=function xTe(){return typeof document<"u"?document.body:null}()||{},QK=!!Fx.style&&"WebkitAppearance"in Fx.style);let e=!0;return Fx.style&&!function vTe(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Fx.style,!e&&QK&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Fx.style)),e}(t)}containsElement(t,i){return jK(t,i)}getParentElement(t){return U6(t)}query(t,i,r){return WK(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,l=[],h){return new MT(r,s)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})();class H6{static#e=this.NOOP=new z6}class V6{}const CTe=1e3,G6="ng-enter",DP="ng-leave",IP="ng-trigger",BP=".ng-trigger",XK="ng-animating",q6=".ng-animating";function Ay(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Q6(parseFloat(e[1]),e[2])}function Q6(n,e){return"s"===e?n*CTe:n}function PP(n,e,t){return n.hasOwnProperty("duration")?n:function ETe(n,e,t){let r,s=0,o="";if("string"==typeof n){const l=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===l)return e.push(VK()),{duration:0,delay:0,easing:""};r=Q6(parseFloat(l[1]),l[2]);const h=l[3];null!=h&&(s=Q6(parseFloat(h),l[4]));const u=l[5];u&&(o=u)}else r=n;if(!t){let l=!1,h=e.length;r<0&&(e.push(function USe(){return new xi(3100,!1)}()),l=!0),s<0&&(e.push(function zSe(){return new xi(3101,!1)}()),l=!0),l&&e.splice(h,0,VK())}return{duration:r,delay:s,easing:o}}(n,e,t)}function H0(n,e,t){e.forEach((i,r)=>{const s=W6(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i})}function Ox(n,e){e.forEach((t,i)=>{const r=W6(i);n.style[r]=""})}function $T(n){return Array.isArray(n)?1==n.length?n[0]:function $be(n,e=null){return{type:Wo.Sequence,steps:n,options:e}}(n):n}const j6=new RegExp("{{\\s*(.+?)\\s*}}","g");function KK(n){let e=[];if("string"==typeof n){let t;for(;t=j6.exec(n);)e.push(t[1]);j6.lastIndex=0}return e}function XT(n,e,t){const i=`${n}`,r=i.replace(j6,(s,o)=>{let l=e[o];return null==l&&(t.push(function VSe(){return new xi(3003,!1)}()),l=""),l.toString()});return r==i?n:r}const DTe=/-+([a-z0-9])/g;function W6(n){return n.replace(DTe,(...e)=>e[1].toUpperCase())}function Im(n,e,t){switch(e.type){case Wo.Trigger:return n.visitTrigger(e,t);case Wo.State:return n.visitState(e,t);case Wo.Transition:return n.visitTransition(e,t);case Wo.Sequence:return n.visitSequence(e,t);case Wo.Group:return n.visitGroup(e,t);case Wo.Animate:return n.visitAnimate(e,t);case Wo.Keyframes:return n.visitKeyframes(e,t);case Wo.Style:return n.visitStyle(e,t);case Wo.Reference:return n.visitReference(e,t);case Wo.AnimateChild:return n.visitAnimateChild(e,t);case Wo.AnimateRef:return n.visitAnimateRef(e,t);case Wo.Query:return n.visitQuery(e,t);case Wo.Stagger:return n.visitStagger(e,t);default:throw function GSe(){return new xi(3004,!1)}()}}function $6(n,e){return window.getComputedStyle(n)[e]}const PTe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class ZK extends V6{normalizePropertyName(e,t){return W6(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if(PTe.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const l=i.match(/^[+-]?[\d\.]+([a-z]*)$/);l&&0==l[1].length&&r.push(function qSe(){return new xi(3005,!1)}())}return o+s}}const RP="*";const kP=new Set(["true","1"]),FP=new Set(["false","0"]);function JK(n,e){const t=kP.has(n)||FP.has(n),i=kP.has(e)||FP.has(e);return(r,s)=>{let o=n==RP||n==r,l=e==RP||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?kP.has(n):FP.has(n)),!l&&i&&"boolean"==typeof s&&(l=s?kP.has(e):FP.has(e)),o&&l}}const OTe=new RegExp("s*:selfs*,?","g");function X6(n,e,t,i){return new LTe(n).build(e,t,i)}class LTe{constructor(e){this._driver=e}build(e,t,i){const r=new zTe(t);return this._resetContextStyleTimingState(r),Im(this,$T(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function QSe(){return new xi(3006,!1)}()),e.definitions.forEach(l=>{if(this._resetContextStyleTimingState(t),l.type==Wo.State){const h=l,u=h.name;u.toString().split(/\s*,\s*/).forEach(f=>{h.name=f,s.push(this.visitState(h,t))}),h.name=u}else if(l.type==Wo.Transition){const h=this.visitTransition(l,t);i+=h.queryCount,r+=h.depCount,o.push(h)}else t.errors.push(function jSe(){return new xi(3007,!1)}())}),{type:Wo.Trigger,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(l=>{l instanceof Map&&l.forEach(h=>{KK(h).forEach(u=>{o.hasOwnProperty(u)||s.add(u)})})}),s.size&&t.errors.push(function WSe(){return new xi(3008,!1)}(0,s.values()))}return{type:Wo.State,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=Im(this,$T(e.animation),t),r=function RTe(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function kTe(n,e,t){if(":"==n[0]){const h=function FTe(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function iTe(){return new xi(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof h)return void e.push(h);n=h}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function nTe(){return new xi(3015,!1)}()),e;const r=i[1],s=i[2],o=i[3];e.push(JK(r,o)),"<"==s[0]&&(r!=RP||o!=RP)&&e.push(JK(o,r))}(i,t,e)):t.push(n),t}(e.expr,t.errors);return{type:Wo.Transition,matchers:r,animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Lx(e.options)}}visitSequence(e,t){return{type:Wo.Sequence,steps:e.steps.map(i=>Im(this,i,t)),options:Lx(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const l=Im(this,o,t);return r=Math.max(r,t.currentTime),l});return t.currentTime=r,{type:Wo.Group,steps:s,options:Lx(e.options)}}visitAnimate(e,t){const i=function VTe(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return Y6(PP(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=Y6(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=PP(t,e);return Y6(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:ld({});if(s.type==Wo.Keyframes)r=this.visitKeyframes(s,t);else{let o=e.styles,l=!1;if(!o){l=!0;const u={};i.easing&&(u.easing=i.easing),o=ld(u)}t.currentTime+=i.duration+i.delay;const h=this.visitStyle(o,t);h.isEmptyStep=l,r=h}return t.currentAnimateTimings=null,{type:Wo.Animate,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let l of r)"string"==typeof l?l===uy?i.push(l):t.errors.push(new xi(3002,!1)):i.push(new Map(Object.entries(l)));let s=!1,o=null;return i.forEach(l=>{if(l instanceof Map&&(l.has("easing")&&(o=l.get("easing"),l.delete("easing")),!s))for(let h of l.values())if(h.toString().indexOf("{{")>=0){s=!0;break}}),{type:Wo.Style,styles:i,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((l,h)=>{const u=t.collectedStyles.get(t.currentQuerySelector),f=u.get(h);let y=!0;f&&(s!=r&&s>=f.startTime&&r<=f.endTime&&(t.errors.push(function XSe(){return new xi(3010,!1)}()),y=!1),s=f.startTime),y&&u.set(h,{startTime:s,endTime:r}),t.options&&function TTe(n,e,t){const i=e.params||{},r=KK(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function HSe(){return new xi(3001,!1)}())})}(l,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:Wo.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function YSe(){return new xi(3011,!1)}()),i;let s=0;const o=[];let l=!1,h=!1,u=0;const f=e.steps.map(le=>{const Ee=this._makeStyleAst(le,t);let Pe=null!=Ee.offset?Ee.offset:function HTe(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(Ee.styles),Ve=0;return null!=Pe&&(s++,Ve=Ee.offset=Pe),h=h||Ve<0||Ve>1,l=l||Ve<u,u=Ve,o.push(Ve),Ee});h&&t.errors.push(function KSe(){return new xi(3012,!1)}()),l&&t.errors.push(function ZSe(){return new xi(3200,!1)}());const y=e.steps.length;let T=0;s>0&&s<y?t.errors.push(function JSe(){return new xi(3202,!1)}()):0==s&&(T=1/(y-1));const B=y-1,j=t.currentTime,ne=t.currentAnimateTimings,se=ne.duration;return f.forEach((le,Ee)=>{const Pe=T>0?Ee==B?1:T*Ee:o[Ee],Ve=Pe*se;t.currentTime=j+ne.delay+Ve,ne.duration=Ve,this._validateStyleAst(le,t),le.offset=Pe,i.styles.push(le)}),i}visitReference(e,t){return{type:Wo.Reference,animation:Im(this,$T(e.animation),t),options:Lx(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:Wo.AnimateChild,options:Lx(e.options)}}visitAnimateRef(e,t){return{type:Wo.AnimateRef,animation:this.visitReference(e.animation,t),options:Lx(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function NTe(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(OTe,"")),n=n.replace(/@\*/g,BP).replace(/@\w+/g,t=>BP+"-"+t.slice(1)).replace(/:animating/g,q6),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,Dm(t.collectedStyles,t.currentQuerySelector,new Map);const l=Im(this,$T(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:Wo.Query,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:l,originalSelector:e.selector,options:Lx(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function eTe(){return new xi(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:PP(e.timings,t.errors,!0);return{type:Wo.Stagger,animation:Im(this,$T(e.animation),t),timings:i,options:null}}}class zTe{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Lx(n){return n?(n={...n}).params&&(n.params=function UTe(n){return n?{...n}:null}(n.params)):n={},n}function Y6(n,e,t){return{duration:n,delay:e,easing:t}}function K6(n,e,t,i,r,s,o=null,l=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:l}}class OP{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const QTe=new RegExp(":enter","g"),WTe=new RegExp(":leave","g");function Z6(n,e,t,i,r,s=new Map,o=new Map,l,h,u=[]){return(new $Te).buildKeyframes(n,e,t,i,r,s,o,l,h,u)}class $Te{buildKeyframes(e,t,i,r,s,o,l,h,u,f=[]){u=u||new OP;const y=new J6(e,t,u,r,s,f,[]);y.options=h;const T=h.delay?Ay(h.delay):0;y.currentTimeline.delayNextStep(T),y.currentTimeline.setStyles([o],null,y.errors,h),Im(this,i,y);const B=y.timelines.filter(j=>j.containsAnimation());if(B.length&&l.size){let j;for(let ne=B.length-1;ne>=0;ne--){const se=B[ne];if(se.element===t){j=se;break}}j&&!j.allowOnlyTimelineStyles()&&j.setStyles([l],null,y.errors,h)}return B.length?B.map(j=>j.buildKeyframes()):[K6(t,[],[],[],0,T,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:Ay(XT(s,r?.params??{},t.errors));i.delayNextStep(o)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?Ay(i.duration):null,l=null!=i.delay?Ay(i.delay):null;return 0!==o&&e.forEach(h=>{const u=t.appendInstructionToTimeline(h,o,l);s=Math.max(s,u.duration+u.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Im(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){r.previousNode.type==Wo.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=LP);const o=Ay(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Im(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Ay(e.options.delay):0;e.steps.forEach(o=>{const l=t.createSubContext(e.options);s&&l.delayNextStep(s),Im(this,o,l),r=Math.max(r,l.currentTimeline.currentTime),i.push(l.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return PP(t.params?XT(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;s.type==Wo.Keyframes?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,l=t.createSubContext().currentTimeline;l.easing=i.easing,e.styles.forEach(h=>{l.forwardTime((h.offset||0)*s),l.setStyles(h.styles,h.easing,t.errors,t.options),l.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(l),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?Ay(r.delay):0;s&&(t.previousNode.type===Wo.Style||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=LP);let o=i;const l=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=l.length;let h=null;l.forEach((u,f)=>{t.currentQueryIndex=f;const y=t.createSubContext(e.options,u);s&&y.delayNextStep(s),u===t.element&&(h=y.currentTimeline),Im(this,e.animation,y),y.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,y.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),h&&(t.currentTimeline.mergeTimelineCollectedStyles(h),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),l=o*(t.currentQueryTotal-1);let h=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":h=l-h;break;case"full":h=i.currentStaggerTime}const f=t.currentTimeline;h&&f.delayNextStep(h);const y=f.currentTime;Im(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-y+(r.startTime-i.currentTimeline.startTime)}}const LP={};class J6{constructor(e,t,i,r,s,o,l,h){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=l,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=LP,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=h||new NP(this._driver,t,0),l.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=Ay(i.duration)),null!=i.delay&&(r.delay=Ay(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(l=>{(!t||!o.hasOwnProperty(l))&&(o[l]=XT(s[l],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new J6(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=LP,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new XTe(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let l=[];if(r&&l.push(this.element),e.length>0){e=(e=e.replace(QTe,"."+this._enterClassName)).replace(WTe,"."+this._leaveClassName);let u=this._driver.query(this.element,e,1!=i);0!==i&&(u=i<0?u.slice(u.length+i,u.length):u.slice(0,i)),l.push(...u)}return!s&&0==l.length&&o.push(function tTe(){return new xi(3014,!1)}()),l}}class NP{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new NP(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||uy),this._currentKeyframe.set(t,uy);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function YTe(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i??=e.keys();for(let s of i)t.set(s,uy)}else for(let[s,o]of r)t.set(s,o)}),t}(e,this._globalTimelineStyles);for(let[l,h]of o){const u=XT(h,s,i);this._pendingStyles.set(l,u),this._localTimelineStyles.has(l)||this._backFill.set(l,this._globalTimelineStyles.get(l)??uy),this._updateStyle(l,u)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((l,h)=>{const u=new Map([...this._backFill,...l]);u.forEach((f,y)=>{"!"===f?e.add(y):f===uy&&t.add(y)}),i||u.set("offset",h/this.duration),r.push(u)});const s=[...e.values()],o=[...t.values()];if(i){const l=r[0],h=new Map(l);l.set("offset",0),h.set("offset",1),r=[l,h]}return K6(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class XTe extends NP{constructor(e,t,i,r,s,o,l=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=l,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,l=t/o,h=new Map(e[0]);h.set("offset",0),s.push(h);const u=new Map(e[0]);u.set("offset",nZ(l)),s.push(u);const f=e.length-1;for(let y=1;y<=f;y++){let T=new Map(e[y]);const B=T.get("offset");T.set("offset",nZ((t+B*i)/o)),s.push(T)}i=o,t=0,r="",e=s}return K6(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function nZ(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}function iZ(n,e,t,i,r,s,o,l,h,u,f,y,T){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:l,queriedElements:h,preStyleProps:u,postStyleProps:f,totalTime:y,errors:T}}const e8={};class rZ{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function KTe(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,o,l,h,u,f){const y=[],T=this.ast.options&&this.ast.options.params||e8,j=this.buildStyles(i,l&&l.params||e8,y),ne=h&&h.params||e8,se=this.buildStyles(r,ne,y),le=new Set,Ee=new Map,Pe=new Map,Ve="void"===r,Ft={params:sZ(ne,T),delay:this.ast.options?.delay},Ct=f?[]:Z6(e,t,this.ast.animation,s,o,j,se,Ft,u,y);let Lt=0;return Ct.forEach(Kt=>{Lt=Math.max(Kt.duration+Kt.delay,Lt)}),y.length?iZ(t,this._triggerName,i,r,Ve,j,se,[],[],Ee,Pe,Lt,y):(Ct.forEach(Kt=>{const Bt=Kt.element,St=Dm(Ee,Bt,new Set);Kt.preStyleProps.forEach(ti=>St.add(ti));const Dn=Dm(Pe,Bt,new Set);Kt.postStyleProps.forEach(ti=>Dn.add(ti)),Bt!==t&&le.add(Bt)}),iZ(t,this._triggerName,i,r,Ve,j,se,Ct,[...le.values()],Ee,Pe,Lt))}}function sZ(n,e){const t={...e};return Object.entries(n).forEach(([i,r])=>{null!=r&&(t[i]=r)}),t}class ZTe{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=sZ(e,this.defaultParams);return this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,l)=>{o&&(o=XT(o,r,t));const h=this.normalizer.normalizePropertyName(l,t);o=this.normalizer.normalizeStyleValue(l,h,o,t),i.set(l,o)})}),i}}class e3e{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new ZTe(r.style,r.options&&r.options.params||{},i))}),oZ(this.states,"true","1"),oZ(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new rZ(e,r,this.states))}),this.fallbackTransition=function t3e(n,e){return new rZ(n,{type:Wo.Transition,animation:{type:Wo.Sequence,steps:[],options:null},matchers:[(o,l)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function oZ(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const n3e=new OP;class i3e{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],s=X6(this._driver,t,i,[]);if(i.length)throw function lTe(){return new xi(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=GK(this._normalizer,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let o;const l=new Map;if(s?(o=Z6(this._driver,t,s,G6,DP,new Map,new Map,i,n3e,r),o.forEach(f=>{const y=Dm(l,f.element,new Map);f.postStyleProps.forEach(T=>y.set(T,null))})):(r.push(function cTe(){return new xi(3300,!1)}()),o=[]),r.length)throw function hTe(){return new xi(3504,!1)}();l.forEach((f,y)=>{f.forEach((T,B)=>{f.set(B,this._driver.computeStyle(y,B,uy))})});const u=gv(o.map(f=>{const y=l.get(f.element);return this._buildPlayer(f,new Map,y)}));return this._playersById.set(e,u),u.onDestroy(()=>this.destroy(e)),this.players.push(u),u}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function uTe(){return new xi(3301,!1)}();return t}listen(e,t,i,r){const s=N6(t,"","","");return O6(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const aZ="ng-animate-queued",t8="ng-animate-disabled",l3e=[],lZ={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},c3e={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Vg="__ng_removed";class n8{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function f3e(n){return n??null}(i?e.value:e),i){const{value:s,...o}=e;this.options=o}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const YT="void",i8=new n8(YT);class h3e{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,IA(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function dTe(){return new xi(3302,!1)}();if(null==i||0==i.length)throw function fTe(){return new xi(3303,!1)}();if(!function p3e(n){return"start"==n||"done"==n}(i))throw function pTe(){return new xi(3400,!1)}();const s=Dm(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const l=Dm(this._engine.statesByElement,e,new Map);return l.has(t)||(IA(e,IP),IA(e,IP+"-"+t),l.set(t,i8)),()=>{this._engine.afterFlush(()=>{const h=s.indexOf(o);h>=0&&s.splice(h,1),this._triggers.has(t)||l.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function mTe(){return new xi(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new r8(this.id,t,e);let l=this._engine.statesByElement.get(e);l||(IA(e,IP),IA(e,IP+"-"+t),this._engine.statesByElement.set(e,l=new Map));let h=l.get(t);const u=new n8(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&h&&u.absorbOptions(h.options),l.set(t,u),h||(h=i8),u.value!==YT&&h.value===u.value){if(!function g3e(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(h.params,u.params)){const ne=[],se=s.matchStyles(h.value,h.params,ne),le=s.matchStyles(u.value,u.params,ne);ne.length?this._engine.reportError(ne):this._engine.afterFlush(()=>{Ox(e,se),H0(e,le)})}return}const T=Dm(this._engine.playersByElement,e,[]);T.forEach(ne=>{ne.namespaceId==this.id&&ne.triggerName==t&&ne.queued&&ne.destroy()});let B=s.matchTransition(h.value,u.value,e,u.params),j=!1;if(!B){if(!r)return;B=s.fallbackTransition,j=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:B,fromState:h,toState:u,player:o,isFallbackTransition:j}),j||(IA(e,aZ),o.onStart(()=>{pM(e,aZ)})),o.onDone(()=>{let ne=this.players.indexOf(o);ne>=0&&this.players.splice(ne,1);const se=this._engine.playersByElement.get(e);if(se){let le=se.indexOf(o);le>=0&&se.splice(le,1)}}),this.players.push(o),T.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,BP,!0);i.forEach(r=>{if(r[Vg])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const l=[];if(s.forEach((h,u)=>{if(o.set(u,h.value),this._triggers.has(u)){const f=this.trigger(e,u,YT,r);f&&l.push(f)}}),l.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&gv(l).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const h=this._triggers.get(o).fallbackTransition,u=i.get(o)||i8,f=new n8(YT),y=new r8(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:h,fromState:u,toState:f,player:y,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[Vg];(!s||s===lZ)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){IA(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(l=>{if(l.name==i.triggerName){const h=N6(s,i.triggerName,i.fromState.value,i.toState.value);h._data=e,O6(i.player,l.phase,h,l.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class u3e{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new h3e(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,l=this.driver.getParentElement(t);for(;l;){const h=r.get(l);if(h){const u=i.indexOf(h);i.splice(u+1,0,e),o=!0;break}l=this.driver.getParentElement(l)}o||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(e);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(UP(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!UP(t))return;const s=t[Vg];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),IA(e,t8)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),pM(e,t8))}removeNode(e,t,i){if(UP(t)){const r=e?this._fetchNamespace(e):null;r?r.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[Vg]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return UP(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,BP,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,q6,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return gv(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Vg];if(t&&t.setForRemoval){if(e[Vg]=lZ,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(t8)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)IA(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?gv(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function ATe(){return new xi(3402,!1)}()}_flushAnimations(e,t){const i=new OP,r=[],s=new Map,o=[],l=new Map,h=new Map,u=new Map,f=new Set;this.disabledNodes.forEach(Un=>{f.add(Un);const _i=this.driver.query(Un,".ng-animate-queued",!0);for(let si=0;si<_i.length;si++)f.add(_i[si])});const y=this.bodyNode,T=Array.from(this.statesByElement.keys()),B=uZ(T,this.collectedEnterElements),j=new Map;let ne=0;B.forEach((Un,_i)=>{const si=G6+ne++;j.set(_i,si),Un.forEach(ir=>IA(ir,si))});const se=[],le=new Set,Ee=new Set;for(let Un=0;Un<this.collectedLeaveElements.length;Un++){const _i=this.collectedLeaveElements[Un],si=_i[Vg];si&&si.setForRemoval&&(se.push(_i),le.add(_i),si.hasAnimation?this.driver.query(_i,".ng-star-inserted",!0).forEach(ir=>le.add(ir)):Ee.add(_i))}const Pe=new Map,Ve=uZ(T,Array.from(le));Ve.forEach((Un,_i)=>{const si=DP+ne++;Pe.set(_i,si),Un.forEach(ir=>IA(ir,si))}),e.push(()=>{B.forEach((Un,_i)=>{const si=j.get(_i);Un.forEach(ir=>pM(ir,si))}),Ve.forEach((Un,_i)=>{const si=Pe.get(_i);Un.forEach(ir=>pM(ir,si))}),se.forEach(Un=>{this.processLeaveNode(Un)})});const Ft=[],Ct=[];for(let Un=this._namespaceList.length-1;Un>=0;Un--)this._namespaceList[Un].drainQueuedTransitions(t).forEach(si=>{const ir=si.player,Nr=si.element;if(Ft.push(ir),this.collectedEnterElements.length){const Rr=Nr[Vg];if(Rr&&Rr.setForMove){if(Rr.previousTriggersValues&&Rr.previousTriggersValues.has(si.triggerName)){const Gs=Rr.previousTriggersValues.get(si.triggerName),to=this.statesByElement.get(si.element);if(to&&to.has(si.triggerName)){const lo=to.get(si.triggerName);lo.value=Gs,to.set(si.triggerName,lo)}}return void ir.destroy()}}const Wr=!y||!this.driver.containsElement(y,Nr),so=Pe.get(Nr),Po=j.get(Nr),Ci=this._buildInstruction(si,i,Po,so,Wr);if(Ci.errors&&Ci.errors.length)return void Ct.push(Ci);if(Wr)return ir.onStart(()=>Ox(Nr,Ci.fromStyles)),ir.onDestroy(()=>H0(Nr,Ci.toStyles)),void r.push(ir);if(si.isFallbackTransition)return ir.onStart(()=>Ox(Nr,Ci.fromStyles)),ir.onDestroy(()=>H0(Nr,Ci.toStyles)),void r.push(ir);const yr=[];Ci.timelines.forEach(Rr=>{Rr.stretchStartingKeyframe=!0,this.disabledNodes.has(Rr.element)||yr.push(Rr)}),Ci.timelines=yr,i.append(Nr,Ci.timelines),o.push({instruction:Ci,player:ir,element:Nr}),Ci.queriedElements.forEach(Rr=>Dm(l,Rr,[]).push(ir)),Ci.preStyleProps.forEach((Rr,Gs)=>{if(Rr.size){let to=h.get(Gs);to||h.set(Gs,to=new Set),Rr.forEach((lo,La)=>to.add(La))}}),Ci.postStyleProps.forEach((Rr,Gs)=>{let to=u.get(Gs);to||u.set(Gs,to=new Set),Rr.forEach((lo,La)=>to.add(La))})});if(Ct.length){const Un=[];Ct.forEach(_i=>{Un.push(function gTe(){return new xi(3505,!1)}())}),Ft.forEach(_i=>_i.destroy()),this.reportError(Un)}const Lt=new Map,Kt=new Map;o.forEach(Un=>{const _i=Un.element;i.has(_i)&&(Kt.set(_i,_i),this._beforeAnimationBuild(Un.player.namespaceId,Un.instruction,Lt))}),r.forEach(Un=>{const _i=Un.element;this._getPreviousPlayers(_i,!1,Un.namespaceId,Un.triggerName,null).forEach(ir=>{Dm(Lt,_i,[]).push(ir),ir.destroy()})});const Bt=se.filter(Un=>fZ(Un,h,u)),St=new Map;hZ(St,this.driver,Ee,u,uy).forEach(Un=>{fZ(Un,h,u)&&Bt.push(Un)});const ti=new Map;B.forEach((Un,_i)=>{hZ(ti,this.driver,new Set(Un),h,"!")}),Bt.forEach(Un=>{const _i=St.get(Un),si=ti.get(Un);St.set(Un,new Map([..._i?.entries()??[],...si?.entries()??[]]))});const ci=[],vi=[],bi={};o.forEach(Un=>{const{element:_i,player:si,instruction:ir}=Un;if(i.has(_i)){if(f.has(_i))return si.onDestroy(()=>H0(_i,ir.toStyles)),si.disabled=!0,si.overrideTotalTime(ir.totalTime),void r.push(si);let Nr=bi;if(Kt.size>1){let so=_i;const Po=[];for(;so=so.parentNode;){const Ci=Kt.get(so);if(Ci){Nr=Ci;break}Po.push(so)}Po.forEach(Ci=>Kt.set(Ci,Nr))}const Wr=this._buildAnimation(si.namespaceId,ir,Lt,s,ti,St);if(si.setRealPlayer(Wr),Nr===bi)ci.push(si);else{const so=this.playersByElement.get(Nr);so&&so.length&&(si.parentPlayer=gv(so)),r.push(si)}}else Ox(_i,ir.fromStyles),si.onDestroy(()=>H0(_i,ir.toStyles)),vi.push(si),f.has(_i)&&r.push(si)}),vi.forEach(Un=>{const _i=s.get(Un.element);if(_i&&_i.length){const si=gv(_i);Un.setRealPlayer(si)}}),r.forEach(Un=>{Un.parentPlayer?Un.syncPlayerEvents(Un.parentPlayer):Un.destroy()});for(let Un=0;Un<se.length;Un++){const _i=se[Un],si=_i[Vg];if(pM(_i,DP),si&&si.hasAnimation)continue;let ir=[];if(l.size){let Wr=l.get(_i);Wr&&Wr.length&&ir.push(...Wr);let so=this.driver.query(_i,q6,!0);for(let Po=0;Po<so.length;Po++){let Ci=l.get(so[Po]);Ci&&Ci.length&&ir.push(...Ci)}}const Nr=ir.filter(Wr=>!Wr.destroyed);Nr.length?m3e(this,_i,Nr):this.processLeaveNode(_i)}return se.length=0,ci.forEach(Un=>{this.players.push(Un),Un.onDone(()=>{Un.destroy();const _i=this.players.indexOf(Un);this.players.splice(_i,1)}),Un.play()}),ci}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const l=this.playersByQueriedElement.get(e);l&&(o=l)}else{const l=this.playersByElement.get(e);if(l){const h=!s||s==YT;l.forEach(u=>{u.queued||!h&&u.triggerName!=r||o.push(u)})}}return(i||r)&&(o=o.filter(l=>!(i&&i!=l.namespaceId||r&&r!=l.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,l=t.isRemovalTransition?void 0:t.triggerName;for(const h of t.timelines){const u=h.element,f=u!==s,y=Dm(i,u,[]);this._getPreviousPlayers(u,f,o,l,t.toState).forEach(B=>{const j=B.getRealPlayer();j.beforeDestroy&&j.beforeDestroy(),B.destroy(),y.push(B)})}Ox(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const l=t.triggerName,h=t.element,u=[],f=new Set,y=new Set,T=t.timelines.map(j=>{const ne=j.element;f.add(ne);const se=ne[Vg];if(se&&se.removedBeforeQueried)return new MT(j.duration,j.delay);const le=ne!==h,Ee=function A3e(n){const e=[];return dZ(n,e),e}((i.get(ne)||l3e).map(Lt=>Lt.getRealPlayer())).filter(Lt=>!!Lt.element&&Lt.element===ne),Pe=s.get(ne),Ve=o.get(ne),Ft=GK(this._normalizer,j.keyframes,Pe,Ve),Ct=this._buildPlayer(j,Ft,Ee);if(j.subTimeline&&r&&y.add(ne),le){const Lt=new r8(e,l,ne);Lt.setRealPlayer(Ct),u.push(Lt)}return Ct});u.forEach(j=>{Dm(this.playersByQueriedElement,j.element,[]).push(j),j.onDone(()=>function d3e(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,j.element,j))}),f.forEach(j=>IA(j,XK));const B=gv(T);return B.onDestroy(()=>{f.forEach(j=>pM(j,XK)),H0(h,t.toStyles)}),y.forEach(j=>{Dm(r,j,[]).push(B)}),B}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new MT(e.duration,e.delay)}}class r8{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new MT,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>O6(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Dm(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function UP(n){return n&&1===n.nodeType}function cZ(n,e){const t=n.style.display;return n.style.display=e??"none",t}function hZ(n,e,t,i,r){const s=[];t.forEach(h=>s.push(cZ(h)));const o=[];i.forEach((h,u)=>{const f=new Map;h.forEach(y=>{const T=e.computeStyle(u,y,r);f.set(y,T),(!T||0==T.length)&&(u[Vg]=c3e,o.push(u))}),n.set(u,f)});let l=0;return t.forEach(h=>cZ(h,s[l++])),o}function uZ(n,e){const t=new Map;if(n.forEach(l=>t.set(l,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(l){if(!l)return 1;let h=s.get(l);if(h)return h;const u=l.parentNode;return h=t.has(u)?u:r.has(u)?1:o(u),s.set(l,h),h}return e.forEach(l=>{const h=o(l);1!==h&&t.get(h).push(l)}),t}function IA(n,e){n.classList?.add(e)}function pM(n,e){n.classList?.remove(e)}function m3e(n,e,t){gv(t).onDone(()=>n.processLeaveNode(e))}function dZ(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof U$?dZ(i.players,e):e.push(i)}}function fZ(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class KT{constructor(e,t,i){this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new u3e(e.body,t,i),this._timelineEngine=new i3e(e.body,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let l=this._triggerCache[o];if(!l){const h=[],f=X6(this._driver,s,h,[]);if(h.length)throw function oTe(){return new xi(3404,!1)}();l=function JTe(n,e,t){return new e3e(n,e,t)}(r,f,this._normalizer),this._triggerCache[o]=l}this._transitionEngine.registerTrigger(t,r,l)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i){this._transitionEngine.removeNode(e,t,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=qK(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,l]=qK(i);return this._timelineEngine.listen(o,t,l,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}class ZT{static#e=this.initialStylesByElement=new WeakMap;constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let r=ZT.initialStylesByElement.get(e);r||ZT.initialStylesByElement.set(e,r=new Map),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&H0(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(H0(this._element,this._initialStyles),this._endStyles&&(H0(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(ZT.initialStylesByElement.delete(this._element),this._startStyles&&(Ox(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Ox(this._element,this._endStyles),this._endStyles=null),H0(this._element,this._initialStyles),this._state=3)}}function s8(n){let e=null;return n.forEach((t,i)=>{(function y3e(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class pZ{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;const t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:$6(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class mZ{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}containsElement(e,t){return jK(e,t)}getParentElement(e){return U6(e)}query(e,t,i){return WK(e,t,i)}computeStyle(e,t,i){return $6(e,t)}animate(e,t,i,r,s,o=[]){const h={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(h.easing=s);const u=new Map,f=o.filter(B=>B instanceof pZ);(function ITe(n,e){return 0===n||0===e})(i,r)&&f.forEach(B=>{B.currentSnapshot.forEach((j,ne)=>u.set(ne,j))});let y=function STe(n){return n.length?n[0]instanceof Map?n:n.map(e=>new Map(Object.entries(e))):[]}(t).map(B=>new Map(B));y=function BTe(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,o)=>{i.has(o)||r.push(o),i.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(l=>o.set(l,$6(n,l)))}}return e}(e,y,u);const T=function _3e(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=s8(e[0]),e.length>1&&(i=s8(e[e.length-1]))):e instanceof Map&&(t=s8(e)),t||i?new ZT(n,t,i):null}(e,y);return new pZ(e,y,h,T)}}const AZ="@.disabled";class gZ{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.parentNode(t)&&this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==AZ?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class v3e extends gZ{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==AZ?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function b3e(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function x3e(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,l=>{this.factory.scheduleListenerCallback(l._data||-1,i,l)})}return this.delegate.listen(e,t,i)}}class w3e{constructor(e,t,i){this.delegate=e,this.engine=t,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,t.onRemovalComplete=(r,s)=>{s?.removeChild(null,r)}}createRenderer(e,t){const r=this.delegate.createRenderer(e,t);if(!e||!t?.data?.animation){const u=this._rendererCache;let f=u.get(r);return f||(f=new gZ("",r,this.engine,()=>u.delete(r)),u.set(r,f)),f}const s=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(s,o,e,u.name,u)};return t.data.animation.forEach(l),new v3e(this,o,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,i){if(e>=0&&e<this._microtaskId)return void this._zone.run(()=>t(i));const r=this._animationCallbacksBuffer;0==r.length&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(s=>{const[o,l]=s;o(l)}),this._animationCallbacksBuffer=[]})}),r.push([t,i])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}const _Z=[{provide:V6,useFactory:function M3e(){return new ZK}},{provide:KT,useClass:(()=>{class n extends KT{constructor(t,i,r){super(t,i,r)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||n)(Wn(ca),Wn(H6),Wn(V6))};static#t=this.\u0275prov=$i({token:n,factory:n.\u0275fac})}return n})()},{provide:hD,useFactory:function E3e(n,e,t){return new w3e(n,e,t)},deps:[fF,KT,ns]}],o8=[{provide:H6,useFactory:()=>new mZ},{provide:gh,useValue:"BrowserAnimations"},..._Z],yZ=[{provide:H6,useClass:z6},{provide:gh,useValue:"NoopAnimations"},..._Z];let S3e=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?yZ:o8}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ua({type:n});static#n=this.\u0275inj=oa({providers:o8,imports:[ZH]})}return n})();const T3e=[{path:"",component:KW},{path:"home",component:KW},{path:"geometry",component:gve},{path:"atlas",component:aEe},{path:"lhcb",component:hEe},{path:"cms",component:uEe},{path:"trackml",component:dEe},{path:"playground",component:NSe}];let D3e=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ua({type:n,bootstrap:[Nue]});static \u0275inj=oa({imports:[ZH,Jle,XG.forRoot(T3e),S3e,LSe]})}return n})();Fae().bootstrapModule(D3e).catch(n=>console.error(n))},6279:(Gr,xt,Te)=>{Gr.exports={ResizeSensor:Te(9362),ElementQueries:Te(1604)}},1604:function(Gr,xt,Te){"use strict";var be,v,V;typeof window<"u"&&window,v=[Te(9362)],void 0!==(V="function"==typeof(be=function(Le){var xe=function(){var st,Ke={},ot=[];function Re(w){w||(w=document.documentElement);var b=window.getComputedStyle(w,null).fontSize;return parseFloat(b)||16}function Ie(w,b){var g=b.split(/\d/),C=g[g.length-1];switch(b=parseFloat(b),C){case"px":default:return b;case"em":return b*Re(w);case"rem":return b*Re();case"vw":return b*document.documentElement.clientWidth/100;case"vh":return b*document.documentElement.clientHeight/100;case"vmin":case"vmax":var N=document.documentElement.clientWidth/100,O=document.documentElement.clientHeight/100;return b*(0,Math["vmin"===C?"min":"max"])(N,O)}}function L(w,b){this.element=w;var g,C,N,O,H,X,ie,z,m=["min-width","min-height","max-width","max-height"];this.call=function(){for(g in N=function Qe(w){if(!w.getBoundingClientRect)return{width:w.offsetWidth,height:w.offsetHeight};var b=w.getBoundingClientRect();return{width:Math.round(b.width),height:Math.round(b.height)}}(this.element),X={},Ke[b])Ke[b].hasOwnProperty(g)&&(O=Ie(this.element,(C=Ke[b][g]).value),H="width"===C.property?N.width:N.height,ie="","min"===C.mode&&H>=O&&(ie+=C.value),"max"===C.mode&&H<=O&&(ie+=C.value),X[z=C.mode+"-"+C.property]||(X[z]=""),ie&&-1===(" "+X[z]+" ").indexOf(" "+ie+" ")&&(X[z]+=" "+ie));for(var I in m)m.hasOwnProperty(I)&&(X[m[I]]?this.element.setAttribute(m[I],X[m[I]].substr(1)):this.element.removeAttribute(m[I]))}}function he(w,b){w.elementQueriesSetupInformation||(w.elementQueriesSetupInformation=new L(w,b)),w.elementQueriesSensor||(w.elementQueriesSensor=new Le(w,function(){w.elementQueriesSetupInformation.call()}))}function re(w,b,g,C){if(typeof Ke[w]>"u"){Ke[w]=[];var N=ot.length;st.innerHTML+="\n"+w+" {animation: 0.1s element-queries;}",st.innerHTML+="\n"+w+" > .resize-sensor {min-width: "+N+"px;}",ot.push(w)}Ke[w].push({mode:b,property:g,value:C})}function fe(w){var b;if(document.querySelectorAll&&(b=w?w.querySelectorAll.bind(w):document.querySelectorAll.bind(document)),!b&&typeof $$<"u"&&(b=$$),!b&&typeof jQuery<"u"&&(b=jQuery),!b)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return b}function pe(w){var b=[],g=[],C=[],N=0,O=-1,H=[];for(var X in w.children)if(w.children.hasOwnProperty(X)&&w.children[X].tagName&&"img"===w.children[X].tagName.toLowerCase()){b.push(w.children[X]);var ie=w.children[X].getAttribute("min-width")||w.children[X].getAttribute("data-min-width"),z=w.children[X].getAttribute("data-src")||w.children[X].getAttribute("url");C.push(z),g.push({minWidth:ie}),ie?w.children[X].style.display="none":(N=b.length-1,w.children[X].style.display="block")}function I(){var R,A=!1;for(R in b)b.hasOwnProperty(R)&&g[R].minWidth&&w.offsetWidth>g[R].minWidth&&(A=R);if(A||(A=N),O!==A)if(H[A])b[O].style.display="none",b[A].style.display="block",O=A;else{var k=new Image;k.onload=function(){b[A].src=C[A],b[O].style.display="none",b[A].style.display="block",H[A]=!0,O=A},k.src=C[A]}else b[A].src=C[A]}O=N,w.resizeSensorInstance=new Le(w,I),I()}var K=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,G=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function D(w){var b,g,C,N;for(w=w.replace(/'/g,'"');null!==(b=K.exec(w));)for(g=b[1]+b[3],C=b[2];null!==(N=G.exec(C));)re(g,N[1],N[2],N[3])}function x(w){var b="";if(w)if("string"==typeof w)(-1!==(w=w.toLowerCase()).indexOf("min-width")||-1!==w.indexOf("max-width"))&&D(w);else for(var g=0,C=w.length;g<C;g++)1===w[g].type?(-1!==(b=w[g].selectorText||w[g].cssText).indexOf("min-height")||-1!==b.indexOf("max-height")||-1!==b.indexOf("min-width")||-1!==b.indexOf("max-width"))&&D(b):4===w[g].type?x(w[g].cssRules||w[g].rules):3===w[g].type&&w[g].styleSheet.hasOwnProperty("cssRules")&&x(w[g].styleSheet.cssRules)}var P=!1;this.init=function(){var w="animationstart";typeof document.documentElement.style.webkitAnimationName<"u"?w="webkitAnimationStart":typeof document.documentElement.style.MozAnimationName<"u"?w="mozanimationstart":typeof document.documentElement.style.OAnimationName<"u"&&(w="oanimationstart"),document.body.addEventListener(w,function(C){var N=C.target,O=N&&window.getComputedStyle(N,null),H=O&&O.getPropertyValue("animation-name");if(H&&-1!==H.indexOf("element-queries")){N.elementQueriesSensor=new Le(N,function(){N.elementQueriesSetupInformation&&N.elementQueriesSetupInformation.call()});var z=window.getComputedStyle(N.resizeSensor,null).getPropertyValue("min-width");z=parseInt(z.replace("px","")),he(C.target,ot[z])}}),P||((st=document.createElement("style")).type="text/css",st.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",st.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(st),P=!0);for(var b=0,g=document.styleSheets.length;b<g;b++)try{document.styleSheets[b].href&&0===document.styleSheets[b].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[b].href),x(document.styleSheets[b].cssRules||document.styleSheets[b].rules||document.styleSheets[b].cssText)}catch{}!function ce(){for(var b=fe()("[data-responsive-image],[responsive-image]"),g=0,C=b.length;g<C;g++)pe(b[g])}()},this.findElementQueriesElements=function(w){!function de(w){var b=fe(w);for(var g in Ke)if(Ke.hasOwnProperty(g))for(var C=b(g,w),N=0,O=C.length;N<O;N++)he(C[N],g)}(w)},this.update=function(){this.init()}};xe.update=function(){xe.instance.update()},xe.detach=function(st){st.elementQueriesSetupInformation?(st.elementQueriesSensor.detach(),delete st.elementQueriesSetupInformation,delete st.elementQueriesSensor):st.resizeSensorInstance&&(st.resizeSensorInstance.detach(),delete st.resizeSensorInstance)},xe.init=function(){xe.instance||(xe.instance=new xe),xe.instance.init()};return xe.findElementQueriesElements=function(st){xe.instance.findElementQueriesElements(st)},xe.listen=function(){!function(st){if(document.addEventListener)document.addEventListener("DOMContentLoaded",st,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var Ke=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(st(),clearInterval(Ke))},10);else window.onload=st}(xe.init)},xe})?be.apply(xt,v):be)&&(Gr.exports=V)},9362:function(Gr,xt,Te){"use strict";var be,v;typeof window<"u"&&window,void 0!==(v="function"==typeof(be=function(){if(typeof window>"u")return null;var V=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")(),Le=V.requestAnimationFrame||V.mozRequestAnimationFrame||V.webkitRequestAnimationFrame||function(Qe){return V.setTimeout(Qe,20)},xe=V.cancelAnimationFrame||V.mozCancelAnimationFrame||V.webkitCancelAnimationFrame||function(Qe){V.clearTimeout(Qe)};function Je(Qe,Ie){var L=Object.prototype.toString.call(Qe),he="[object Array]"===L||"[object NodeList]"===L||"[object HTMLCollection]"===L||"[object Object]"===L||typeof jQuery<"u"&&Qe instanceof jQuery||typeof Elements<"u"&&Qe instanceof Elements,re=0,fe=Qe.length;if(he)for(;re<fe;re++)Ie(Qe[re]);else Ie(Qe)}function st(Qe){if(!Qe.getBoundingClientRect)return{width:Qe.offsetWidth,height:Qe.offsetHeight};var Ie=Qe.getBoundingClientRect();return{width:Math.round(Ie.width),height:Math.round(Ie.height)}}function Ke(Qe,Ie){Object.keys(Ie).forEach(function(L){Qe.style[L]=Ie[L]})}var ot=function(Qe,Ie){var L=0;function he(){var de,pe,fe=[];this.add=function(ce){fe.push(ce)},this.call=function(ce){for(de=0,pe=fe.length;de<pe;de++)fe[de].call(this,ce)},this.remove=function(ce){var K=[];for(de=0,pe=fe.length;de<pe;de++)fe[de]!==ce&&K.push(fe[de]);fe=K},this.length=function(){return fe.length}}function re(fe,de){if(fe){if(fe.resizedAttached)return void fe.resizedAttached.add(de);fe.resizedAttached=new he,fe.resizedAttached.add(de),fe.resizeSensor=document.createElement("div"),fe.resizeSensor.dir="ltr",fe.resizeSensor.className="resize-sensor";var pe={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},ce={position:"absolute",left:"0px",top:"0px",transition:"0s"};Ke(fe.resizeSensor,pe);var K=document.createElement("div");K.className="resize-sensor-expand",Ke(K,pe);var G=document.createElement("div");Ke(G,ce),K.appendChild(G);var D=document.createElement("div");D.className="resize-sensor-shrink",Ke(D,pe);var x=document.createElement("div");Ke(x,ce),Ke(x,{width:"200%",height:"200%"}),D.appendChild(x),fe.resizeSensor.appendChild(K),fe.resizeSensor.appendChild(D),fe.appendChild(fe.resizeSensor);var P=window.getComputedStyle(fe),w=P?P.getPropertyValue("position"):null;"absolute"!==w&&"relative"!==w&&"fixed"!==w&&"sticky"!==w&&(fe.style.position="relative");var b=!1,g=0,C=st(fe),N=0,O=0,H=!0;L=0;var ie=function(){if(H){if(0===fe.offsetWidth&&0===fe.offsetHeight)return void(L||(L=Le(function(){L=0,ie()})));H=!1}var A,R;R=fe.offsetHeight,G.style.width=(A=fe.offsetWidth)+10+"px",G.style.height=R+10+"px",K.scrollLeft=A+10,K.scrollTop=R+10,D.scrollLeft=A+10,D.scrollTop=R+10};fe.resizeSensor.resetSensor=ie;var z=function(){g=0,b&&(N=C.width,O=C.height,fe.resizedAttached&&fe.resizedAttached.call(C))},m=function(){C=st(fe),(b=C.width!==N||C.height!==O)&&!g&&(g=Le(z)),ie()},I=function(A,R,k){A.attachEvent?A.attachEvent("on"+R,k):A.addEventListener(R,k)};I(K,"scroll",m),I(D,"scroll",m),L=Le(function(){L=0,ie()})}}Je(Qe,function(fe){re(fe,Ie)}),this.detach=function(fe){L||(xe(L),L=0),ot.detach(Qe,fe)},this.reset=function(){Qe.resizeSensor.resetSensor()}};if(ot.reset=function(Qe){Je(Qe,function(Ie){Ie.resizeSensor.resetSensor()})},ot.detach=function(Qe,Ie){Je(Qe,function(L){L&&(L.resizedAttached&&"function"==typeof Ie&&(L.resizedAttached.remove(Ie),L.resizedAttached.length())||L.resizeSensor&&(L.contains(L.resizeSensor)&&L.removeChild(L.resizeSensor),delete L.resizeSensor,delete L.resizedAttached))})},typeof MutationObserver<"u"){var Re=new MutationObserver(function(Qe){for(var Ie in Qe)if(Qe.hasOwnProperty(Ie))for(var L=Qe[Ie].addedNodes,he=0;he<L.length;he++)L[he].resizeSensor&&ot.reset(L[he])});document.addEventListener("DOMContentLoaded",function(Qe){Re.observe(document.body,{childList:!0,subtree:!0})})}return ot})?be.call(xt,Te,xt,Gr):be)&&(Gr.exports=v)},3039:Gr=>{"use strict";var xt={single_source_shortest_paths:function(Te,be,v){var V={},Le={};Le[be]=0;var Je,st,Ke,ot,Re,Ie,xe=xt.PriorityQueue.make();for(xe.push(be,0);!xe.empty();)for(Ke in ot=(Je=xe.pop()).cost,Re=Te[st=Je.value]||{})Re.hasOwnProperty(Ke)&&(Ie=ot+Re[Ke],(typeof Le[Ke]>"u"||Le[Ke]>Ie)&&(Le[Ke]=Ie,xe.push(Ke,Ie),V[Ke]=st));if(typeof v<"u"&&typeof Le[v]>"u"){var re=["Could not find a path from ",be," to ",v,"."].join("");throw new Error(re)}return V},extract_shortest_path_from_predecessor_list:function(Te,be){for(var v=[],V=be;V;)v.push(V),V=Te[V];return v.reverse(),v},find_path:function(Te,be,v){var V=xt.single_source_shortest_paths(Te,be,v);return xt.extract_shortest_path_from_predecessor_list(V,v)},PriorityQueue:{make:function(Te){var V,be=xt.PriorityQueue,v={};for(V in Te=Te||{},be)be.hasOwnProperty(V)&&(v[V]=be[V]);return v.queue=[],v.sorter=Te.sorter||be.default_sorter,v},default_sorter:function(Te,be){return Te.cost-be.cost},push:function(Te,be){this.queue.push({value:Te,cost:be}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};Gr.exports=xt},339:function(Gr){Gr.exports=function(){"use strict";var xt=function(te,Z){return(xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ae,oe){ae.__proto__=oe}||function(ae,oe){for(var qe in oe)Object.prototype.hasOwnProperty.call(oe,qe)&&(ae[qe]=oe[qe])})(te,Z)};function Te(te,Z){if("function"!=typeof Z&&null!==Z)throw new TypeError("Class extends value "+String(Z)+" is not a constructor or null");function ae(){this.constructor=te}xt(te,Z),te.prototype=null===Z?Object.create(Z):(ae.prototype=Z.prototype,new ae)}var be=function(){return be=Object.assign||function(Z){for(var ae,oe=1,qe=arguments.length;oe<qe;oe++)for(var ft in ae=arguments[oe])Object.prototype.hasOwnProperty.call(ae,ft)&&(Z[ft]=ae[ft]);return Z},be.apply(this,arguments)};function v(te,Z,ae,oe){return new(ae||(ae=Promise))(function(ft,Pt){function on(Kn){try{Vn(oe.next(Kn))}catch(li){Pt(li)}}function sn(Kn){try{Vn(oe.throw(Kn))}catch(li){Pt(li)}}function Vn(Kn){Kn.done?ft(Kn.value):function qe(ft){return ft instanceof ae?ft:new ae(function(Pt){Pt(ft)})}(Kn.value).then(on,sn)}Vn((oe=oe.apply(te,Z||[])).next())})}function V(te,Z){var oe,qe,ft,Pt,ae={label:0,sent:function(){if(1&ft[0])throw ft[1];return ft[1]},trys:[],ops:[]};return Pt={next:on(0),throw:on(1),return:on(2)},"function"==typeof Symbol&&(Pt[Symbol.iterator]=function(){return this}),Pt;function on(Vn){return function(Kn){return function sn(Vn){if(oe)throw new TypeError("Generator is already executing.");for(;ae;)try{if(oe=1,qe&&(ft=2&Vn[0]?qe.return:Vn[0]?qe.throw||((ft=qe.return)&&ft.call(qe),0):qe.next)&&!(ft=ft.call(qe,Vn[1])).done)return ft;switch(qe=0,ft&&(Vn=[2&Vn[0],ft.value]),Vn[0]){case 0:case 1:ft=Vn;break;case 4:return ae.label++,{value:Vn[1],done:!1};case 5:ae.label++,qe=Vn[1],Vn=[0];continue;case 7:Vn=ae.ops.pop(),ae.trys.pop();continue;default:if(!(ft=(ft=ae.trys).length>0&&ft[ft.length-1])&&(6===Vn[0]||2===Vn[0])){ae=0;continue}if(3===Vn[0]&&(!ft||Vn[1]>ft[0]&&Vn[1]<ft[3])){ae.label=Vn[1];break}if(6===Vn[0]&&ae.label<ft[1]){ae.label=ft[1],ft=Vn;break}if(ft&&ae.label<ft[2]){ae.label=ft[2],ae.ops.push(Vn);break}ft[2]&&ae.ops.pop(),ae.trys.pop();continue}Vn=Z.call(te,ae)}catch(Kn){Vn=[6,Kn],qe=0}finally{oe=ft=0}if(5&Vn[0])throw Vn[1];return{value:Vn[0]?Vn[1]:void 0,done:!0}}([Vn,Kn])}}}function Le(te,Z,ae){if(ae||2===arguments.length)for(var ft,oe=0,qe=Z.length;oe<qe;oe++)(ft||!(oe in Z))&&(ft||(ft=Array.prototype.slice.call(Z,0,oe)),ft[oe]=Z[oe]);return te.concat(ft||Z)}for(var xe=function(){function te(Z,ae,oe,qe){this.left=Z,this.top=ae,this.width=oe,this.height=qe}return te.prototype.add=function(Z,ae,oe,qe){return new te(this.left+Z,this.top+ae,this.width+oe,this.height+qe)},te.fromClientRect=function(Z,ae){return new te(ae.left+Z.windowBounds.left,ae.top+Z.windowBounds.top,ae.width,ae.height)},te.fromDOMRectList=function(Z,ae){var oe=Array.from(ae).find(function(qe){return 0!==qe.width});return oe?new te(oe.left+Z.windowBounds.left,oe.top+Z.windowBounds.top,oe.width,oe.height):te.EMPTY},te.EMPTY=new te(0,0,0,0),te}(),Je=function(te,Z){return xe.fromClientRect(te,Z.getBoundingClientRect())},Ke=function(te){for(var Z=[],ae=0,oe=te.length;ae<oe;){var qe=te.charCodeAt(ae++);if(qe>=55296&&qe<=56319&&ae<oe){var ft=te.charCodeAt(ae++);56320==(64512&ft)?Z.push(((1023&qe)<<10)+(1023&ft)+65536):(Z.push(qe),ae--)}else Z.push(qe)}return Z},ot=function(){for(var te=[],Z=0;Z<arguments.length;Z++)te[Z]=arguments[Z];if(String.fromCodePoint)return String.fromCodePoint.apply(String,te);var ae=te.length;if(!ae)return"";for(var oe=[],qe=-1,ft="";++qe<ae;){var Pt=te[qe];Pt<=65535?oe.push(Pt):oe.push(55296+((Pt-=65536)>>10),Pt%1024+56320),(qe+1===ae||oe.length>16384)&&(ft+=String.fromCharCode.apply(String,oe),oe.length=0)}return ft},Re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Qe=typeof Uint8Array>"u"?[]:new Uint8Array(256),Ie=0;Ie<64;Ie++)Qe[Re.charCodeAt(Ie)]=Ie;for(var L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",he=typeof Uint8Array>"u"?[]:new Uint8Array(256),re=0;re<64;re++)he[L.charCodeAt(re)]=re;for(var z=function(te,Z,ae){return te.slice?te.slice(Z,ae):new Uint16Array(Array.prototype.slice.call(te,Z,ae))},A=function(){function te(Z,ae,oe,qe,ft,Pt){this.initialValue=Z,this.errorValue=ae,this.highStart=oe,this.highValueIndex=qe,this.index=ft,this.data=Pt}return te.prototype.get=function(Z){var ae;if(Z>=0){if(Z<55296||Z>56319&&Z<=65535)return this.data[ae=((ae=this.index[Z>>5])<<2)+(31&Z)];if(Z<=65535)return this.data[ae=((ae=this.index[2048+(Z-55296>>5)])<<2)+(31&Z)];if(Z<this.highStart)return ae=this.index[ae=2080+(Z>>11)],this.data[ae=((ae=this.index[ae+=Z>>5&63])<<2)+(31&Z)];if(Z<=1114111)return this.data[this.highValueIndex]}return this.errorValue},te}(),R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k=typeof Uint8Array>"u"?[]:new Uint8Array(256),ee=0;ee<64;ee++)k[R.charCodeAt(ee)]=ee;var ae,oe,qe,Pt,on,Fe=10,dt=13,_t=15,kt=17,Tt=18,fn=19,ln=20,mn=21,jt=22,cn=24,gn=25,Cn=26,Ln=27,Zn=28,hi=30,Mr=32,Sr=33,ms=34,fs=35,W=37,me=38,_e=39,Be=40,Et=42,Nt=[9001,65288],Zt="\xd7",vn=(ae=function(te){var oe,ft,Pt,on,sn,Z=.75*te.length,ae=te.length,qe=0;"="===te[te.length-1]&&(Z--,"="===te[te.length-2]&&Z--);var Vn=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(Z):new Array(Z),Kn=Array.isArray(Vn)?Vn:new Uint8Array(Vn);for(oe=0;oe<ae;oe+=4)ft=he[te.charCodeAt(oe)],Pt=he[te.charCodeAt(oe+1)],on=he[te.charCodeAt(oe+2)],sn=he[te.charCodeAt(oe+3)],Kn[qe++]=ft<<2|Pt>>4,Kn[qe++]=(15&Pt)<<4|on>>2,Kn[qe++]=(3&on)<<6|63&sn;return Vn}("KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA=="),oe=Array.isArray(ae)?function(te){for(var Z=te.length,ae=[],oe=0;oe<Z;oe+=4)ae.push(te[oe+3]<<24|te[oe+2]<<16|te[oe+1]<<8|te[oe]);return ae}(ae):new Uint32Array(ae),qe=Array.isArray(ae)?function(te){for(var Z=te.length,ae=[],oe=0;oe<Z;oe+=2)ae.push(te[oe+1]<<8|te[oe]);return ae}(ae):new Uint16Array(ae),Pt=z(qe,12,oe[4]/2),on=2===oe[5]?z(qe,(24+oe[4])/2):function(te,Z,ae){return te.slice?te.slice(Z,ae):new Uint32Array(Array.prototype.slice.call(te,Z,ae))}(oe,Math.ceil((24+oe[4])/4)),new A(oe[0],oe[1],oe[2],oe[3],Pt,on)),Fn=[hi,36],ai=[1,2,3,5],$n=[Fe,8],kn=[Ln,Cn],Rn=ai.concat($n),ei=[me,_e,Be,ms,fs],Yi=[_t,dt],Y=function(te,Z,ae,oe){var qe=oe[ae];if(Array.isArray(te)?-1!==te.indexOf(qe):te===qe)for(var ft=ae;ft<=oe.length;){if((Pt=oe[++ft])===Z)return!0;if(Pt!==Fe)break}if(qe===Fe)for(ft=ae;ft>0;){var on=oe[--ft];if(Array.isArray(te)?-1!==te.indexOf(on):te===on)for(var sn=ae;sn<=oe.length;){var Pt;if((Pt=oe[++sn])===Z)return!0;if(Pt!==Fe)break}if(on!==Fe)break}return!1},E=function(te,Z){for(var ae=te;ae>=0;){var oe=Z[ae];if(oe!==Fe)return oe;ae--}return 0},J=function(te,Z,ae,oe,qe){if(0===ae[oe])return Zt;var ft=oe-1;if(Array.isArray(qe)&&!0===qe[ft])return Zt;var Pt=ft-1,on=ft+1,sn=Z[ft],Vn=Pt>=0?Z[Pt]:0,Kn=Z[on];if(2===sn&&3===Kn)return Zt;if(-1!==ai.indexOf(sn))return"!";if(-1!==ai.indexOf(Kn)||-1!==$n.indexOf(Kn))return Zt;if(8===E(ft,Z))return"\xf7";if(11===vn.get(te[ft])||(sn===Mr||sn===Sr)&&11===vn.get(te[on])||7===sn||7===Kn||9===sn||-1===[Fe,dt,_t].indexOf(sn)&&9===Kn||-1!==[kt,Tt,fn,cn,Zn].indexOf(Kn)||E(ft,Z)===jt||Y(23,jt,ft,Z)||Y([kt,Tt],mn,ft,Z)||Y(12,12,ft,Z))return Zt;if(sn===Fe)return"\xf7";if(23===sn||23===Kn)return Zt;if(16===Kn||16===sn)return"\xf7";if(-1!==[dt,_t,mn].indexOf(Kn)||14===sn||36===Vn&&-1!==Yi.indexOf(sn)||sn===Zn&&36===Kn||Kn===ln||-1!==Fn.indexOf(Kn)&&sn===gn||-1!==Fn.indexOf(sn)&&Kn===gn||sn===Ln&&-1!==[W,Mr,Sr].indexOf(Kn)||-1!==[W,Mr,Sr].indexOf(sn)&&Kn===Cn||-1!==Fn.indexOf(sn)&&-1!==kn.indexOf(Kn)||-1!==kn.indexOf(sn)&&-1!==Fn.indexOf(Kn)||-1!==[Ln,Cn].indexOf(sn)&&(Kn===gn||-1!==[jt,_t].indexOf(Kn)&&Z[on+1]===gn)||-1!==[jt,_t].indexOf(sn)&&Kn===gn||sn===gn&&-1!==[gn,Zn,cn].indexOf(Kn))return Zt;if(-1!==[gn,Zn,cn,kt,Tt].indexOf(Kn))for(var li=ft;li>=0;){if((Ni=Z[li])===gn)return Zt;if(-1===[Zn,cn].indexOf(Ni))break;li--}if(-1!==[Ln,Cn].indexOf(Kn))for(li=-1!==[kt,Tt].indexOf(sn)?Pt:ft;li>=0;){var Ni;if((Ni=Z[li])===gn)return Zt;if(-1===[Zn,cn].indexOf(Ni))break;li--}if(me===sn&&-1!==[me,_e,ms,fs].indexOf(Kn)||-1!==[_e,ms].indexOf(sn)&&-1!==[_e,Be].indexOf(Kn)||-1!==[Be,fs].indexOf(sn)&&Kn===Be||-1!==ei.indexOf(sn)&&-1!==[ln,Cn].indexOf(Kn)||-1!==ei.indexOf(Kn)&&sn===Ln||-1!==Fn.indexOf(sn)&&-1!==Fn.indexOf(Kn)||sn===cn&&-1!==Fn.indexOf(Kn)||-1!==Fn.concat(gn).indexOf(sn)&&Kn===jt&&-1===Nt.indexOf(te[on])||-1!==Fn.concat(gn).indexOf(Kn)&&sn===Tt)return Zt;if(41===sn&&41===Kn){for(var us=ae[ft],Pr=1;us>0&&41===Z[--us];)Pr++;if(Pr%2!=0)return Zt}return sn===Mr&&Kn===Sr?Zt:"\xf7"},Ae=function(te,Z){Z||(Z={lineBreak:"normal",wordBreak:"normal"});var ae=function(te,Z){void 0===Z&&(Z="strict");var ae=[],oe=[],qe=[];return te.forEach(function(ft,Pt){var on=vn.get(ft);if(on>50?(qe.push(!0),on-=50):qe.push(!1),-1!==["normal","auto","loose"].indexOf(Z)&&-1!==[8208,8211,12316,12448].indexOf(ft))return oe.push(Pt),ae.push(16);if(4===on||11===on){if(0===Pt)return oe.push(Pt),ae.push(hi);var sn=ae[Pt-1];return-1===Rn.indexOf(sn)?(oe.push(oe[Pt-1]),ae.push(sn)):(oe.push(Pt),ae.push(hi))}return oe.push(Pt),31===on?ae.push("strict"===Z?mn:W):on===Et||29===on?ae.push(hi):43===on?ae.push(ft>=131072&&ft<=196605||ft>=196608&&ft<=262141?W:hi):void ae.push(on)}),[oe,ae,qe]}(te,Z.lineBreak),oe=ae[0],qe=ae[1],ft=ae[2];return("break-all"===Z.wordBreak||"break-word"===Z.wordBreak)&&(qe=qe.map(function(on){return-1!==[gn,hi,Et].indexOf(on)?W:on})),[oe,qe,"keep-all"===Z.wordBreak?ft.map(function(on,sn){return on&&te[sn]>=19968&&te[sn]<=40959}):void 0]},Ce=function(){function te(Z,ae,oe,qe){this.codePoints=Z,this.required="!"===ae,this.start=oe,this.end=qe}return te.prototype.slice=function(){return ot.apply(void 0,this.codePoints.slice(this.start,this.end))},te}(),No=function(te){return te>=48&&te<=57},Yf=function(te){return No(te)||te>=65&&te<=70||te>=97&&te<=102},qg=function(te){return 10===te||9===te||32===te},q0=function(te){return function(te){return function(te){return te>=97&&te<=122}(te)||function(te){return te>=65&&te<=90}(te)}(te)||function(te){return te>=128}(te)||95===te},Ux=function(te){return q0(te)||No(te)||45===te},gM=function(te){return te>=0&&te<=8||11===te||te>=14&&te<=31||127===te},Kf=function(te,Z){return 92===te&&10!==Z},rf=function(te,Z,ae){return 45===te?q0(Z)||Kf(Z,ae):!!q0(te)||!(92!==te||!Kf(te,Z))},yy=function(te,Z,ae){return 43===te||45===te?!!No(Z)||46===Z&&No(ae):No(46===te?Z:te)},zx=function(te){var Z=0,ae=1;(43===te[Z]||45===te[Z])&&(45===te[Z]&&(ae=-1),Z++);for(var oe=[];No(te[Z]);)oe.push(te[Z++]);var qe=oe.length?parseInt(ot.apply(void 0,oe),10):0;46===te[Z]&&Z++;for(var ft=[];No(te[Z]);)ft.push(te[Z++]);var Pt=ft.length,on=Pt?parseInt(ot.apply(void 0,ft),10):0;(69===te[Z]||101===te[Z])&&Z++;var sn=1;(43===te[Z]||45===te[Z])&&(45===te[Z]&&(sn=-1),Z++);for(var Vn=[];No(te[Z]);)Vn.push(te[Z++]);var Kn=Vn.length?parseInt(ot.apply(void 0,Vn),10):0;return ae*(qe+on*Math.pow(10,-Pt))*Math.pow(10,sn*Kn)},_M={type:2},vy={type:3},Q0={type:4},j0={type:13},by={type:8},xy={type:21},PA={type:9},yv={type:10},Hx={type:11},vv={type:12},Vx={type:14},Op={type:23},Gx={type:1},yM={type:25},qx={type:24},vM={type:26},Qx={type:27},bM={type:28},jx={type:29},Wx={type:31},wy={type:32},W0=function(){function te(){this._value=[]}return te.prototype.write=function(Z){this._value=this._value.concat(Ke(Z))},te.prototype.read=function(){for(var Z=[],ae=this.consumeToken();ae!==wy;)Z.push(ae),ae=this.consumeToken();return Z},te.prototype.consumeToken=function(){var Z=this.consumeCodePoint();switch(Z){case 34:return this.consumeStringToken(34);case 35:var ae=this.peekCodePoint(0),oe=this.peekCodePoint(1),qe=this.peekCodePoint(2);if(Ux(ae)||Kf(oe,qe)){var ft=rf(ae,oe,qe)?2:1;return{type:5,value:this.consumeName(),flags:ft}}break;case 36:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),j0;break;case 39:return this.consumeStringToken(39);case 40:return _M;case 41:return vy;case 42:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),Vx;break;case 43:if(yy(Z,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(Z),this.consumeNumericToken();break;case 44:return Q0;case 45:var on=Z,sn=this.peekCodePoint(0),Vn=this.peekCodePoint(1);if(yy(on,sn,Vn))return this.reconsumeCodePoint(Z),this.consumeNumericToken();if(rf(on,sn,Vn))return this.reconsumeCodePoint(Z),this.consumeIdentLikeToken();if(45===sn&&62===Vn)return this.consumeCodePoint(),this.consumeCodePoint(),qx;break;case 46:if(yy(Z,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(Z),this.consumeNumericToken();break;case 47:if(42===this.peekCodePoint(0))for(this.consumeCodePoint();;){var Kn=this.consumeCodePoint();if(42===Kn&&47===(Kn=this.consumeCodePoint()))return this.consumeToken();if(-1===Kn)return this.consumeToken()}break;case 58:return vM;case 59:return Qx;case 60:if(33===this.peekCodePoint(0)&&45===this.peekCodePoint(1)&&45===this.peekCodePoint(2))return this.consumeCodePoint(),this.consumeCodePoint(),yM;break;case 64:var li=this.peekCodePoint(0),Ni=this.peekCodePoint(1),us=this.peekCodePoint(2);if(rf(li,Ni,us))return{type:7,value:this.consumeName()};break;case 91:return bM;case 92:if(Kf(Z,this.peekCodePoint(0)))return this.reconsumeCodePoint(Z),this.consumeIdentLikeToken();break;case 93:return jx;case 61:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),by;break;case 123:return Hx;case 125:return vv;case 117:case 85:var Pr=this.peekCodePoint(0),Cr=this.peekCodePoint(1);return 43===Pr&&(Yf(Cr)||63===Cr)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(Z),this.consumeIdentLikeToken();case 124:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),PA;if(124===this.peekCodePoint(0))return this.consumeCodePoint(),xy;break;case 126:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),yv;break;case-1:return wy}return qg(Z)?(this.consumeWhiteSpace(),Wx):No(Z)?(this.reconsumeCodePoint(Z),this.consumeNumericToken()):q0(Z)?(this.reconsumeCodePoint(Z),this.consumeIdentLikeToken()):{type:6,value:ot(Z)}},te.prototype.consumeCodePoint=function(){var Z=this._value.shift();return typeof Z>"u"?-1:Z},te.prototype.reconsumeCodePoint=function(Z){this._value.unshift(Z)},te.prototype.peekCodePoint=function(Z){return Z>=this._value.length?-1:this._value[Z]},te.prototype.consumeUnicodeRangeToken=function(){for(var Z=[],ae=this.consumeCodePoint();Yf(ae)&&Z.length<6;)Z.push(ae),ae=this.consumeCodePoint();for(var oe=!1;63===ae&&Z.length<6;)Z.push(ae),ae=this.consumeCodePoint(),oe=!0;if(oe)return{type:30,start:parseInt(ot.apply(void 0,Z.map(function(sn){return 63===sn?48:sn})),16),end:parseInt(ot.apply(void 0,Z.map(function(sn){return 63===sn?70:sn})),16)};var Pt=parseInt(ot.apply(void 0,Z),16);if(45===this.peekCodePoint(0)&&Yf(this.peekCodePoint(1))){this.consumeCodePoint(),ae=this.consumeCodePoint();for(var on=[];Yf(ae)&&on.length<6;)on.push(ae),ae=this.consumeCodePoint();return{type:30,start:Pt,end:parseInt(ot.apply(void 0,on),16)}}return{type:30,start:Pt,end:Pt}},te.prototype.consumeIdentLikeToken=function(){var Z=this.consumeName();return"url"===Z.toLowerCase()&&40===this.peekCodePoint(0)?(this.consumeCodePoint(),this.consumeUrlToken()):40===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:19,value:Z}):{type:20,value:Z}},te.prototype.consumeUrlToken=function(){var Z=[];if(this.consumeWhiteSpace(),-1===this.peekCodePoint(0))return{type:22,value:""};var ae=this.peekCodePoint(0);if(39===ae||34===ae){var oe=this.consumeStringToken(this.consumeCodePoint());return 0===oe.type&&(this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0))?(this.consumeCodePoint(),{type:22,value:oe.value}):(this.consumeBadUrlRemnants(),Op)}for(;;){var qe=this.consumeCodePoint();if(-1===qe||41===qe)return{type:22,value:ot.apply(void 0,Z)};if(qg(qe))return this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:22,value:ot.apply(void 0,Z)}):(this.consumeBadUrlRemnants(),Op);if(34===qe||39===qe||40===qe||gM(qe))return this.consumeBadUrlRemnants(),Op;if(92===qe){if(!Kf(qe,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),Op;Z.push(this.consumeEscapedCodePoint())}else Z.push(qe)}},te.prototype.consumeWhiteSpace=function(){for(;qg(this.peekCodePoint(0));)this.consumeCodePoint()},te.prototype.consumeBadUrlRemnants=function(){for(;;){var Z=this.consumeCodePoint();if(41===Z||-1===Z)return;Kf(Z,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},te.prototype.consumeStringSlice=function(Z){for(var oe="";Z>0;){var qe=Math.min(5e4,Z);oe+=ot.apply(void 0,this._value.splice(0,qe)),Z-=qe}return this._value.shift(),oe},te.prototype.consumeStringToken=function(Z){for(var ae="",oe=0;;){var qe=this._value[oe];if(-1===qe||void 0===qe||qe===Z)return{type:0,value:ae+=this.consumeStringSlice(oe)};if(10===qe)return this._value.splice(0,oe),Gx;if(92===qe){var ft=this._value[oe+1];-1!==ft&&void 0!==ft&&(10===ft?(ae+=this.consumeStringSlice(oe),oe=-1,this._value.shift()):Kf(qe,ft)&&(ae+=this.consumeStringSlice(oe),ae+=ot(this.consumeEscapedCodePoint()),oe=-1))}oe++}},te.prototype.consumeNumber=function(){var Z=[],ae=4,oe=this.peekCodePoint(0);for((43===oe||45===oe)&&Z.push(this.consumeCodePoint());No(this.peekCodePoint(0));)Z.push(this.consumeCodePoint());oe=this.peekCodePoint(0);var qe=this.peekCodePoint(1);if(46===oe&&No(qe))for(Z.push(this.consumeCodePoint(),this.consumeCodePoint()),ae=8;No(this.peekCodePoint(0));)Z.push(this.consumeCodePoint());oe=this.peekCodePoint(0),qe=this.peekCodePoint(1);var ft=this.peekCodePoint(2);if((69===oe||101===oe)&&((43===qe||45===qe)&&No(ft)||No(qe)))for(Z.push(this.consumeCodePoint(),this.consumeCodePoint()),ae=8;No(this.peekCodePoint(0));)Z.push(this.consumeCodePoint());return[zx(Z),ae]},te.prototype.consumeNumericToken=function(){var Z=this.consumeNumber(),ae=Z[0],oe=Z[1],qe=this.peekCodePoint(0),ft=this.peekCodePoint(1),Pt=this.peekCodePoint(2);return rf(qe,ft,Pt)?{type:15,number:ae,flags:oe,unit:this.consumeName()}:37===qe?(this.consumeCodePoint(),{type:16,number:ae,flags:oe}):{type:17,number:ae,flags:oe}},te.prototype.consumeEscapedCodePoint=function(){var Z=this.consumeCodePoint();if(Yf(Z)){for(var ae=ot(Z);Yf(this.peekCodePoint(0))&&ae.length<6;)ae+=ot(this.consumeCodePoint());qg(this.peekCodePoint(0))&&this.consumeCodePoint();var oe=parseInt(ae,16);return 0===oe||function(te){return te>=55296&&te<=57343}(oe)||oe>1114111?65533:oe}return-1===Z?65533:Z},te.prototype.consumeName=function(){for(var Z="";;){var ae=this.consumeCodePoint();if(Ux(ae))Z+=ot(ae);else{if(!Kf(ae,this.peekCodePoint(0)))return this.reconsumeCodePoint(ae),Z;Z+=ot(this.consumeEscapedCodePoint())}}},te}(),Ed=function(){function te(Z){this._tokens=Z}return te.create=function(Z){var ae=new W0;return ae.write(Z),new te(ae.read())},te.parseValue=function(Z){return te.create(Z).parseComponentValue()},te.parseValues=function(Z){return te.create(Z).parseComponentValues()},te.prototype.parseComponentValue=function(){for(var Z=this.consumeToken();31===Z.type;)Z=this.consumeToken();if(32===Z.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(Z);var ae=this.consumeComponentValue();do{Z=this.consumeToken()}while(31===Z.type);if(32===Z.type)return ae;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},te.prototype.parseComponentValues=function(){for(var Z=[];;){var ae=this.consumeComponentValue();if(32===ae.type)return Z;Z.push(ae),Z.push()}},te.prototype.consumeComponentValue=function(){var Z=this.consumeToken();switch(Z.type){case 11:case 28:case 2:return this.consumeSimpleBlock(Z.type);case 19:return this.consumeFunction(Z)}return Z},te.prototype.consumeSimpleBlock=function(Z){for(var ae={type:Z,values:[]},oe=this.consumeToken();;){if(32===oe.type||Yl(oe,Z))return ae;this.reconsumeToken(oe),ae.values.push(this.consumeComponentValue()),oe=this.consumeToken()}},te.prototype.consumeFunction=function(Z){for(var ae={name:Z.value,values:[],type:18};;){var oe=this.consumeToken();if(32===oe.type||3===oe.type)return ae;this.reconsumeToken(oe),ae.values.push(this.consumeComponentValue())}},te.prototype.consumeToken=function(){var Z=this._tokens.shift();return typeof Z>"u"?wy:Z},te.prototype.reconsumeToken=function(Z){this._tokens.unshift(Z)},te}(),Qu=function(te){return 15===te.type},Zf=function(te){return 17===te.type},Ca=function(te){return 20===te.type},Gc=function(te){return 0===te.type},Qg=function(te,Z){return Ca(te)&&te.value===Z},sf=function(te){return 31!==te.type},ju=function(te){return 31!==te.type&&4!==te.type},Ul=function(te){var Z=[],ae=[];return te.forEach(function(oe){if(4===oe.type){if(0===ae.length)throw new Error("Error parsing function args, zero tokens for arg");return Z.push(ae),void(ae=[])}31!==oe.type&&ae.push(oe)}),ae.length&&Z.push(ae),Z},Yl=function(te,Z){return 11===Z&&12===te.type||28===Z&&29===te.type||2===Z&&3===te.type},Sd=function(te){return 17===te.type||15===te.type},xc=function(te){return 16===te.type||Sd(te)},Cy=function(te){return te.length>1?[te[0],te[1]]:[te[0]]},cc={type:17,number:0,flags:4},$0={type:16,number:50,flags:4},af={type:16,number:100,flags:4},RA=function(te,Z,ae){var oe=te[0],qe=te[1];return[rl(oe,Z),rl(typeof qe<"u"?qe:oe,ae)]},rl=function(te,Z){if(16===te.type)return te.number/100*Z;if(Qu(te))switch(te.unit){case"rem":case"em":return 16*te.number;default:return te.number}return te.number},lf_parse=function(te,Z){if(15===Z.type)switch(Z.unit){case"deg":return Math.PI*Z.number/180;case"grad":return Math.PI/200*Z.number;case"rad":return Z.number;case"turn":return 2*Math.PI*Z.number}throw new Error("Unsupported angle type")},My=function(te){return 15===te.type&&("deg"===te.unit||"grad"===te.unit||"rad"===te.unit||"turn"===te.unit)},hd=function(te){switch(te.filter(Ca).map(function(ae){return ae.value}).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[cc,cc];case"to top":case"bottom":return wc(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[cc,af];case"to right":case"left":return wc(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[af,af];case"to bottom":case"top":return wc(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[af,cc];case"to left":case"right":return wc(270)}return 0},wc=function(te){return Math.PI*te/180},Kc_parse=function(te,Z){if(18===Z.type){var ae=km[Z.name];if(typeof ae>"u")throw new Error('Attempting to parse an unsupported color function "'+Z.name+'"');return ae(te,Z.values)}if(5===Z.type){if(3===Z.value.length){var oe=Z.value.substring(0,1),qe=Z.value.substring(1,2),ft=Z.value.substring(2,3);return co(parseInt(oe+oe,16),parseInt(qe+qe,16),parseInt(ft+ft,16),1)}if(4===Z.value.length){oe=Z.value.substring(0,1),qe=Z.value.substring(1,2),ft=Z.value.substring(2,3);var Pt=Z.value.substring(3,4);return co(parseInt(oe+oe,16),parseInt(qe+qe,16),parseInt(ft+ft,16),parseInt(Pt+Pt,16)/255)}if(6===Z.value.length)return oe=Z.value.substring(0,2),qe=Z.value.substring(2,4),ft=Z.value.substring(4,6),co(parseInt(oe,16),parseInt(qe,16),parseInt(ft,16),1);if(8===Z.value.length)return oe=Z.value.substring(0,2),qe=Z.value.substring(2,4),ft=Z.value.substring(4,6),Pt=Z.value.substring(6,8),co(parseInt(oe,16),parseInt(qe,16),parseInt(ft,16),parseInt(Pt,16)/255)}if(20===Z.type){var on=qo[Z.value.toUpperCase()];if(typeof on<"u")return on}return qo.TRANSPARENT},Hh=function(te){return!(255&te)},Jo=function(te){var Z=255&te,ae=255&te>>8,oe=255&te>>16,qe=255&te>>24;return Z<255?"rgba("+qe+","+oe+","+ae+","+Z/255+")":"rgb("+qe+","+oe+","+ae+")"},co=function(te,Z,ae,oe){return(te<<24|Z<<16|ae<<8|Math.round(255*oe))>>>0},Rm=function(te,Z){if(17===te.type)return te.number;if(16===te.type){var ae=3===Z?1:255;return 3===Z?te.number/100*ae:Math.round(te.number/100*ae)}return 0},Lp=function(te,Z){var ae=Z.filter(ju);if(3===ae.length){var oe=ae.map(Rm);return co(oe[0],oe[1],oe[2],1)}if(4===ae.length){var on=ae.map(Rm);return co(on[0],on[1],on[2],on[3])}return 0};function Ki(te,Z,ae){return ae<0&&(ae+=1),ae>=1&&(ae-=1),ae<1/6?(Z-te)*ae*6+te:ae<.5?Z:ae<2/3?6*(Z-te)*(2/3-ae)+te:te}var Cs=function(te,Z){var ae=Z.filter(ju),oe=ae[0],qe=ae[1],ft=ae[2],Pt=ae[3],on=(17===oe.type?wc(oe.number):lf_parse(te,oe))/(2*Math.PI),sn=xc(qe)?qe.number/100:0,Vn=xc(ft)?ft.number/100:0,Kn=typeof Pt<"u"&&xc(Pt)?rl(Pt,1):1;if(0===sn)return co(255*Vn,255*Vn,255*Vn,1);var li=Vn<=.5?Vn*(sn+1):Vn+sn-Vn*sn,Ni=2*Vn-li,us=Ki(Ni,li,on+1/3),Pr=Ki(Ni,li,on),Cr=Ki(Ni,li,on-1/3);return co(255*us,255*Pr,255*Cr,Kn)},km={hsl:Cs,hsla:Cs,rgb:Lp,rgba:Lp},Np=function(te,Z){return Kc_parse(te,Ed.create(Z).parseComponentValue())},qo={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Fm={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(te,Z){return Z.map(function(ae){if(Ca(ae))switch(ae.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},zl={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},cf=function(te,Z){var ae=Kc_parse(te,Z[0]),oe=Z[1];return oe&&xc(oe)?{color:ae,stop:oe}:{color:ae,stop:null}},jg=function(te,Z){var ae=te[0],oe=te[te.length-1];null===ae.stop&&(ae.stop=cc),null===oe.stop&&(oe.stop=af);for(var qe=[],ft=0,Pt=0;Pt<te.length;Pt++){var on=te[Pt].stop;if(null!==on){var sn=rl(on,Z);qe.push(sn>ft?sn:ft),ft=sn}else qe.push(null)}var Vn=null;for(Pt=0;Pt<qe.length;Pt++){var Kn=qe[Pt];if(null===Kn)null===Vn&&(Vn=Pt);else if(null!==Vn){for(var li=Pt-Vn,us=(Kn-qe[Vn-1])/(li+1),Pr=1;Pr<=li;Pr++)qe[Vn+Pr-1]=us*Pr;Vn=null}}return te.map(function(Cr,Co){return{color:Cr.color,stop:Math.max(Math.min(1,qe[Co]/Z),0)}})},Ma=function(te,Z,ae){var oe="number"==typeof te?te:function(te,Z,ae){var oe=Z/2,qe=ae/2,ft=rl(te[0],Z)-oe,Pt=qe-rl(te[1],ae);return(Math.atan2(Pt,ft)+2*Math.PI)%(2*Math.PI)}(te,Z,ae),qe=Math.abs(Z*Math.sin(oe))+Math.abs(ae*Math.cos(oe)),ft=Z/2,Pt=ae/2,on=qe/2,sn=Math.sin(oe-Math.PI/2)*on,Vn=Math.cos(oe-Math.PI/2)*on;return[qe,ft-Vn,ft+Vn,Pt-sn,Pt+sn]},Us=function(te,Z){return Math.sqrt(te*te+Z*Z)},tp=function(te,Z,ae,oe,qe){return[[0,0],[0,Z],[te,0],[te,Z]].reduce(function(Pt,on){var Kn=Us(ae-on[0],oe-on[1]);return(qe?Kn<Pt.optimumDistance:Kn>Pt.optimumDistance)?{optimumCorner:on,optimumDistance:Kn}:Pt},{optimumDistance:qe?1/0:-1/0,optimumCorner:null}).optimumCorner},hf=function(te,Z){var ae=wc(180),oe=[];return Ul(Z).forEach(function(qe,ft){if(0===ft){var Pt=qe[0];if(20===Pt.type&&-1!==["top","left","right","bottom"].indexOf(Pt.value))return void(ae=hd(qe));if(My(Pt))return void(ae=(lf_parse(te,Pt)+wc(270))%wc(360))}var on=cf(te,qe);oe.push(on)}),{angle:ae,stops:oe,type:1}},Vh="closest-side",X0="farthest-side",bv="closest-corner",kA="farthest-corner",Om="ellipse",Ya="contain",Hl=function(te,Z){var ae=0,oe=3,qe=[],ft=[];return Ul(Z).forEach(function(Pt,on){var sn=!0;if(0===on?sn=Pt.reduce(function(Kn,li){if(Ca(li))switch(li.value){case"center":return ft.push($0),!1;case"top":case"left":return ft.push(cc),!1;case"right":case"bottom":return ft.push(af),!1}else if(xc(li)||Sd(li))return ft.push(li),!1;return Kn},sn):1===on&&(sn=Pt.reduce(function(Kn,li){if(Ca(li))switch(li.value){case"circle":return ae=0,!1;case Om:return ae=1,!1;case Ya:case Vh:return oe=0,!1;case X0:return oe=1,!1;case bv:return oe=2,!1;case"cover":case kA:return oe=3,!1}else if(Sd(li)||xc(li))return Array.isArray(oe)||(oe=[]),oe.push(li),!1;return Kn},sn)),sn){var Vn=cf(te,Pt);qe.push(Vn)}}),{size:oe,shape:ae,stops:qe,position:ft,type:2}},Lm_parse=function(te,Z){if(22===Z.type){var ae={url:Z.value,type:0};return te.cache.addImage(Z.value),ae}if(18===Z.type){var oe=io[Z.name];if(typeof oe>"u")throw new Error('Attempting to parse an unsupported image function "'+Z.name+'"');return oe(te,Z.values)}throw new Error("Unsupported image type "+Z.type)};for(var io={"linear-gradient":function(te,Z){var ae=wc(180),oe=[];return Ul(Z).forEach(function(qe,ft){if(0===ft){var Pt=qe[0];if(20===Pt.type&&"to"===Pt.value)return void(ae=hd(qe));if(My(Pt))return void(ae=lf_parse(te,Pt))}var on=cf(te,qe);oe.push(on)}),{angle:ae,stops:oe,type:1}},"-moz-linear-gradient":hf,"-ms-linear-gradient":hf,"-o-linear-gradient":hf,"-webkit-linear-gradient":hf,"radial-gradient":function(te,Z){var ae=0,oe=3,qe=[],ft=[];return Ul(Z).forEach(function(Pt,on){var sn=!0;if(0===on){var Vn=!1;sn=Pt.reduce(function(li,Ni){if(Vn)if(Ca(Ni))switch(Ni.value){case"center":return ft.push($0),li;case"top":case"left":return ft.push(cc),li;case"right":case"bottom":return ft.push(af),li}else(xc(Ni)||Sd(Ni))&&ft.push(Ni);else if(Ca(Ni))switch(Ni.value){case"circle":return ae=0,!1;case Om:return ae=1,!1;case"at":return Vn=!0,!1;case Vh:return oe=0,!1;case"cover":case X0:return oe=1,!1;case Ya:case bv:return oe=2,!1;case kA:return oe=3,!1}else if(Sd(Ni)||xc(Ni))return Array.isArray(oe)||(oe=[]),oe.push(Ni),!1;return li},sn)}if(sn){var Kn=cf(te,Pt);qe.push(Kn)}}),{size:oe,shape:ae,stops:qe,position:ft,type:2}},"-moz-radial-gradient":Hl,"-ms-radial-gradient":Hl,"-o-radial-gradient":Hl,"-webkit-radial-gradient":Hl,"-webkit-gradient":function(te,Z){var ae=wc(180),oe=[],qe=1;return Ul(Z).forEach(function(sn,Vn){var Kn=sn[0];if(0===Vn){if(Ca(Kn)&&"linear"===Kn.value)return void(qe=1);if(Ca(Kn)&&"radial"===Kn.value)return void(qe=2)}if(18===Kn.type)if("from"===Kn.name){var li=Kc_parse(te,Kn.values[0]);oe.push({stop:cc,color:li})}else if("to"===Kn.name)li=Kc_parse(te,Kn.values[0]),oe.push({stop:af,color:li});else if("color-stop"===Kn.name){var Ni=Kn.values.filter(ju);if(2===Ni.length){li=Kc_parse(te,Ni[1]);var us=Ni[0];Zf(us)&&oe.push({stop:{type:16,number:100*us.number,flags:us.flags},color:li})}}}),1===qe?{angle:(ae+wc(180))%wc(360),stops:oe,type:qe}:{size:3,shape:0,stops:oe,position:[],type:qe}}},Dh={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(te,Z){if(0===Z.length)return[];var ae=Z[0];return 20===ae.type&&"none"===ae.value?[]:Z.filter(function(oe){return ju(oe)&&function Sy(te){return!(20===te.type&&"none"===te.value||18===te.type&&!io[te.name])}(oe)}).map(function(oe){return Lm_parse(te,oe)})}},$i={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(te,Z){return Z.map(function(ae){if(Ca(ae))switch(ae.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Mn={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(te,Z){return Ul(Z).map(function(ae){return ae.filter(xc)}).map(Cy)}},oa={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(te,Z){return Ul(Z).map(function(ae){return ae.filter(Ca).map(function(oe){return oe.value}).join(" ")}).map(zp)}},zp=function(te){switch(te){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}},Pc=function(te){return te.AUTO="auto",te.CONTAIN="contain",te.COVER="cover",te}(Pc||{}),ud={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(te,Z){return Ul(Z).map(function(ae){return ae.filter(Wu)})}},Wu=function(te){return Ca(te)||xc(te)},Gh=function(te){return{name:"border-"+te+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},uf=Gh("top"),np=Gh("right"),Hp=Gh("bottom"),Rc=Gh("left"),Ai=function(te){return{name:"border-radius-"+te,initialValue:"0 0",prefix:!1,type:1,parse:function(Z,ae){return Cy(ae.filter(xc))}}},Td=Ai("top-left"),ip=Ai("top-right"),Nm=Ai("bottom-right"),Vp=Ai("bottom-left"),df=function(te){return{name:"border-"+te+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(Z,ae){switch(ae){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Gp=df("top"),Xx=df("right"),$g=df("bottom"),Ty=df("left"),Qc=function(te){return{name:"border-"+te+"-width",initialValue:"0",type:0,prefix:!1,parse:function(Z,ae){return Qu(ae)?ae.number:0}}},rp=Qc("top"),FA=Qc("right"),K0=Qc("bottom"),Dd=Qc("left"),sp={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Kl={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(te,Z){return"rtl"===Z?1:0}},ff={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(te,Z){return Z.filter(Ca).reduce(function(ae,oe){return ae|mo(oe.value)},0)}},mo=function(te){switch(te){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},uo={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(te,Z){switch(Z){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},$o={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(te,Z){return 20===Z.type&&"normal"===Z.value?0:17===Z.type||15===Z.type?Z.number:0}},Dy=function(te){return te.NORMAL="normal",te.STRICT="strict",te}(Dy||{}),Iy={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(te,Z){return"strict"===Z?Dy.STRICT:Dy.NORMAL}},yu={name:"line-height",initialValue:"normal",prefix:!1,type:4},Um=function(te,Z){return Ca(te)&&"normal"===te.value?1.2*Z:17===te.type?Z*te.number:xc(te)?rl(te,Z):Z},qh={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(te,Z){return 20===Z.type&&"none"===Z.value?null:Lm_parse(te,Z)}},zm={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(te,Z){return"inside"===Z?0:1}},Xo={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(te,Z){switch(Z){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},Zc=function(te){return{name:"margin-"+te,initialValue:"0",prefix:!1,type:4}},By=Zc("top"),sl=Zc("right"),op=Zc("bottom"),xM=Zc("left"),wM={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(te,Z){return Z.filter(Ca).map(function(ae){switch(ae.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}})}},Il={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(te,Z){return"break-word"===Z?"break-word":"normal"}},pf=function(te){return{name:"padding-"+te,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},tl=pf("top"),xv=pf("right"),Qh=pf("bottom"),Py=pf("left"),wv={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(te,Z){switch(Z){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},qp={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(te,Z){switch(Z){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Yx={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(te,Z){return 1===Z.length&&Qg(Z[0],"none")?[]:Ul(Z).map(function(ae){for(var oe={color:qo.TRANSPARENT,offsetX:cc,offsetY:cc,blur:cc},qe=0,ft=0;ft<ae.length;ft++){var Pt=ae[ft];Sd(Pt)?(0===qe?oe.offsetX=Pt:1===qe?oe.offsetY=Pt:oe.blur=Pt,qe++):oe.color=Kc_parse(te,Pt)}return oe})}},vu={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(te,Z){switch(Z){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Z0={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(te,Z){if(20===Z.type&&"none"===Z.value)return null;if(18===Z.type){var ae=oi[Z.name];if(typeof ae>"u")throw new Error('Attempting to parse an unsupported transform function "'+Z.name+'"');return ae(Z.values)}return null}},oi={matrix:function(te){var Z=te.filter(function(ae){return 17===ae.type}).map(function(ae){return ae.number});return 6===Z.length?Z:null},matrix3d:function(te){var Z=te.filter(function(sn){return 17===sn.type}).map(function(sn){return sn.number});return 16===Z.length?[Z[0],Z[1],Z[4],Z[5],Z[12],Z[13]]:null}},kc={type:16,number:50,flags:4},OA=[kc,kc],LA={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(te,Z){var ae=Z.filter(xc);return 2!==ae.length?OA:[ae[0],ae[1]]}},Ry={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(te,Z){switch(Z){case"hidden":return 1;case"collapse":return 2;default:return 0}}},bu=function(te){return te.NORMAL="normal",te.BREAK_ALL="break-all",te.KEEP_ALL="keep-all",te}(bu||{}),dd={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(te,Z){switch(Z){case"break-all":return bu.BREAK_ALL;case"keep-all":return bu.KEEP_ALL;default:return bu.NORMAL}}},Xg={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(te,Z){if(20===Z.type)return{auto:!0,order:0};if(Zf(Z))return{auto:!1,order:Z.number};throw new Error("Invalid z-index number parsed")}},xu={name:"time",parse:function(te,Z){if(15===Z.type)switch(Z.unit.toLowerCase()){case"s":return 1e3*Z.number;case"ms":return Z.number}throw new Error("Unsupported time type")}},Cv={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(te,Z){return Zf(Z)?Z.number:1}},Hm={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},e_={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(te,Z){return Z.filter(Ca).map(function(ae){switch(ae.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(ae){return 0!==ae})}},mf={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(te,Z){var ae=[],oe=[];return Z.forEach(function(qe){switch(qe.type){case 20:case 0:ae.push(qe.value);break;case 17:ae.push(qe.number.toString());break;case 4:oe.push(ae.join(" ")),ae.length=0}}),ae.length&&oe.push(ae.join(" ")),oe.map(function(qe){return-1===qe.indexOf(" ")?qe:"'"+qe+"'"})}},t_={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},Ih={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(te,Z){return Zf(Z)?Z.number:Ca(Z)&&"bold"===Z.value?700:400}},Vm={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(te,Z){return Z.filter(Ca).map(function(ae){return ae.value})}},Qp={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(te,Z){switch(Z){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},Al=function(te,Z){return!!(te&Z)},Vl={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(te,Z){if(0===Z.length)return[];var ae=Z[0];return 20===ae.type&&"none"===ae.value?[]:Z}},n_={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(te,Z){if(0===Z.length)return null;var ae=Z[0];if(20===ae.type&&"none"===ae.value)return null;for(var oe=[],qe=Z.filter(sf),ft=0;ft<qe.length;ft++){var Pt=qe[ft],on=qe[ft+1];if(20===Pt.type){var sn=on&&Zf(on)?on.number:1;oe.push({counter:Pt.value,increment:sn})}}return oe}},fd={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(te,Z){if(0===Z.length)return[];for(var ae=[],oe=Z.filter(sf),qe=0;qe<oe.length;qe++){var ft=oe[qe],Pt=oe[qe+1];if(Ca(ft)&&"none"!==ft.value){var on=Pt&&Zf(Pt)?Pt.number:0;ae.push({counter:ft.value,reset:on})}}return ae}},Yg={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(te,Z){return Z.filter(Qu).map(function(ae){return xu.parse(te,ae)})}},NA={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(te,Z){if(0===Z.length)return null;var ae=Z[0];if(20===ae.type&&"none"===ae.value)return null;var oe=[],qe=Z.filter(Gc);if(qe.length%2!=0)return null;for(var ft=0;ft<qe.length;ft+=2)oe.push({open:qe[ft].value,close:qe[ft+1].value});return oe}},gl=function(te,Z,ae){if(!te)return"";var oe=te[Math.min(Z,te.length-1)];return oe?ae?oe.open:oe.close:""},jh={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(te,Z){return 1===Z.length&&Qg(Z[0],"none")?[]:Ul(Z).map(function(ae){for(var oe={color:255,offsetX:cc,offsetY:cc,blur:cc,spread:cc,inset:!1},qe=0,ft=0;ft<ae.length;ft++){var Pt=ae[ft];Qg(Pt,"inset")?oe.inset=!0:Sd(Pt)?(0===qe?oe.offsetX=Pt:1===qe?oe.offsetY=Pt:2===qe?oe.blur=Pt:oe.spread=Pt,qe++):oe.color=Kc_parse(te,Pt)}return oe})}},Bl={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(te,Z){var oe=[];return Z.filter(Ca).forEach(function(qe){switch(qe.value){case"stroke":oe.push(1);break;case"fill":oe.push(0);break;case"markers":oe.push(2)}}),[0,1,2].forEach(function(qe){-1===oe.indexOf(qe)&&oe.push(qe)}),oe}},ol={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Af={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(te,Z){return Qu(Z)?Z.number:0}},Bh=function(){function te(Z,ae){var oe,qe;this.animationDuration=is(Z,Yg,ae.animationDuration),this.backgroundClip=is(Z,Fm,ae.backgroundClip),this.backgroundColor=is(Z,zl,ae.backgroundColor),this.backgroundImage=is(Z,Dh,ae.backgroundImage),this.backgroundOrigin=is(Z,$i,ae.backgroundOrigin),this.backgroundPosition=is(Z,Mn,ae.backgroundPosition),this.backgroundRepeat=is(Z,oa,ae.backgroundRepeat),this.backgroundSize=is(Z,ud,ae.backgroundSize),this.borderTopColor=is(Z,uf,ae.borderTopColor),this.borderRightColor=is(Z,np,ae.borderRightColor),this.borderBottomColor=is(Z,Hp,ae.borderBottomColor),this.borderLeftColor=is(Z,Rc,ae.borderLeftColor),this.borderTopLeftRadius=is(Z,Td,ae.borderTopLeftRadius),this.borderTopRightRadius=is(Z,ip,ae.borderTopRightRadius),this.borderBottomRightRadius=is(Z,Nm,ae.borderBottomRightRadius),this.borderBottomLeftRadius=is(Z,Vp,ae.borderBottomLeftRadius),this.borderTopStyle=is(Z,Gp,ae.borderTopStyle),this.borderRightStyle=is(Z,Xx,ae.borderRightStyle),this.borderBottomStyle=is(Z,$g,ae.borderBottomStyle),this.borderLeftStyle=is(Z,Ty,ae.borderLeftStyle),this.borderTopWidth=is(Z,rp,ae.borderTopWidth),this.borderRightWidth=is(Z,FA,ae.borderRightWidth),this.borderBottomWidth=is(Z,K0,ae.borderBottomWidth),this.borderLeftWidth=is(Z,Dd,ae.borderLeftWidth),this.boxShadow=is(Z,jh,ae.boxShadow),this.color=is(Z,sp,ae.color),this.direction=is(Z,Kl,ae.direction),this.display=is(Z,ff,ae.display),this.float=is(Z,uo,ae.cssFloat),this.fontFamily=is(Z,mf,ae.fontFamily),this.fontSize=is(Z,t_,ae.fontSize),this.fontStyle=is(Z,Qp,ae.fontStyle),this.fontVariant=is(Z,Vm,ae.fontVariant),this.fontWeight=is(Z,Ih,ae.fontWeight),this.letterSpacing=is(Z,$o,ae.letterSpacing),this.lineBreak=is(Z,Iy,ae.lineBreak),this.lineHeight=is(Z,yu,ae.lineHeight),this.listStyleImage=is(Z,qh,ae.listStyleImage),this.listStylePosition=is(Z,zm,ae.listStylePosition),this.listStyleType=is(Z,Xo,ae.listStyleType),this.marginTop=is(Z,By,ae.marginTop),this.marginRight=is(Z,sl,ae.marginRight),this.marginBottom=is(Z,op,ae.marginBottom),this.marginLeft=is(Z,xM,ae.marginLeft),this.opacity=is(Z,Cv,ae.opacity);var ft=is(Z,wM,ae.overflow);this.overflowX=ft[0],this.overflowY=ft[ft.length>1?1:0],this.overflowWrap=is(Z,Il,ae.overflowWrap),this.paddingTop=is(Z,tl,ae.paddingTop),this.paddingRight=is(Z,xv,ae.paddingRight),this.paddingBottom=is(Z,Qh,ae.paddingBottom),this.paddingLeft=is(Z,Py,ae.paddingLeft),this.paintOrder=is(Z,Bl,ae.paintOrder),this.position=is(Z,qp,ae.position),this.textAlign=is(Z,wv,ae.textAlign),this.textDecorationColor=is(Z,Hm,null!==(oe=ae.textDecorationColor)&&void 0!==oe?oe:ae.color),this.textDecorationLine=is(Z,e_,null!==(qe=ae.textDecorationLine)&&void 0!==qe?qe:ae.textDecoration),this.textShadow=is(Z,Yx,ae.textShadow),this.textTransform=is(Z,vu,ae.textTransform),this.transform=is(Z,Z0,ae.transform),this.transformOrigin=is(Z,LA,ae.transformOrigin),this.visibility=is(Z,Ry,ae.visibility),this.webkitTextStrokeColor=is(Z,ol,ae.webkitTextStrokeColor),this.webkitTextStrokeWidth=is(Z,Af,ae.webkitTextStrokeWidth),this.wordBreak=is(Z,dd,ae.wordBreak),this.zIndex=is(Z,Xg,ae.zIndex)}return te.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&0===this.visibility},te.prototype.isTransparent=function(){return Hh(this.backgroundColor)},te.prototype.isTransformed=function(){return null!==this.transform},te.prototype.isPositioned=function(){return 0!==this.position},te.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},te.prototype.isFloating=function(){return 0!==this.float},te.prototype.isInlineLevel=function(){return Al(this.display,4)||Al(this.display,33554432)||Al(this.display,268435456)||Al(this.display,536870912)||Al(this.display,67108864)||Al(this.display,134217728)},te}(),Ba=function(){return function te(Z,ae){this.content=is(Z,Vl,ae.content),this.quotes=is(Z,NA,ae.quotes)}}(),_l=function(){return function te(Z,ae){this.counterIncrement=is(Z,n_,ae.counterIncrement),this.counterReset=is(Z,fd,ae.counterReset)}}(),is=function(te,Z,ae){var oe=new W0,qe=null!==ae&&typeof ae<"u"?ae.toString():Z.initialValue;oe.write(qe);var ft=new Ed(oe.read());switch(Z.type){case 2:var Pt=ft.parseComponentValue();return Z.parse(te,Ca(Pt)?Pt.value:Z.initialValue);case 0:return Z.parse(te,ft.parseComponentValue());case 1:return Z.parse(te,ft.parseComponentValues());case 4:return ft.parseComponentValue();case 3:switch(Z.format){case"angle":return lf_parse(te,ft.parseComponentValue());case"color":return Kc_parse(te,ft.parseComponentValue());case"image":return Lm_parse(te,ft.parseComponentValue());case"length":var on=ft.parseComponentValue();return Sd(on)?on:cc;case"length-percentage":var sn=ft.parseComponentValue();return xc(sn)?sn:cc;case"time":return xu.parse(te,ft.parseComponentValue())}}},jp=function(te,Z){var ae=function(te){switch(te.getAttribute("data-html2canvas-debug")){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}}(te);return 1===ae||Z===ae},Zl=function(){return function te(Z,ae){this.context=Z,this.textNodes=[],this.elements=[],this.flags=0,jp(ae,3),this.styles=new Bh(Z,window.getComputedStyle(ae,null)),r0(ae)&&(this.styles.animationDuration.some(function(oe){return oe>0})&&(ae.style.animationDuration="0s"),null!==this.styles.transform&&(ae.style.transform="none")),this.bounds=Je(this.context,ae),jp(ae,4)&&(this.flags|=16)}}(),i_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jc=typeof Uint8Array>"u"?[]:new Uint8Array(256),Wh=0;Wh<64;Wh++)jc[i_.charCodeAt(Wh)]=Wh;for(var $h=function(te,Z,ae){return te.slice?te.slice(Z,ae):new Uint16Array(Array.prototype.slice.call(te,Z,ae))},$u=function(){function te(Z,ae,oe,qe,ft,Pt){this.initialValue=Z,this.errorValue=ae,this.highStart=oe,this.highValueIndex=qe,this.index=ft,this.data=Pt}return te.prototype.get=function(Z){var ae;if(Z>=0){if(Z<55296||Z>56319&&Z<=65535)return this.data[ae=((ae=this.index[Z>>5])<<2)+(31&Z)];if(Z<=65535)return this.data[ae=((ae=this.index[2048+(Z-55296>>5)])<<2)+(31&Z)];if(Z<this.highStart)return ae=this.index[ae=2080+(Z>>11)],this.data[ae=((ae=this.index[ae+=Z>>5&63])<<2)+(31&Z)];if(Z<=1114111)return this.data[this.highValueIndex]}return this.errorValue},te}(),ua="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ap=typeof Uint8Array>"u"?[]:new Uint8Array(256),mr=0;mr<64;mr++)ap[ua.charCodeAt(mr)]=mr;var $p=8,$m=9,lp=11,cp=12,Zg=function(){for(var te=[],Z=0;Z<arguments.length;Z++)te[Z]=arguments[Z];if(String.fromCodePoint)return String.fromCodePoint.apply(String,te);var ae=te.length;if(!ae)return"";for(var oe=[],qe=-1,ft="";++qe<ae;){var Pt=te[qe];Pt<=65535?oe.push(Pt):oe.push(55296+((Pt-=65536)>>10),Pt%1024+56320),(qe+1===ae||oe.length>16384)&&(ft+=String.fromCharCode.apply(String,oe),oe.length=0)}return ft},Xm=function(te){var ae=function(te){var oe,ft,Pt,on,sn,Z=.75*te.length,ae=te.length,qe=0;"="===te[te.length-1]&&(Z--,"="===te[te.length-2]&&Z--);var Vn=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(Z):new Array(Z),Kn=Array.isArray(Vn)?Vn:new Uint8Array(Vn);for(oe=0;oe<ae;oe+=4)ft=jc[te.charCodeAt(oe)],Pt=jc[te.charCodeAt(oe+1)],on=jc[te.charCodeAt(oe+2)],sn=jc[te.charCodeAt(oe+3)],Kn[qe++]=ft<<2|Pt>>4,Kn[qe++]=(15&Pt)<<4|on>>2,Kn[qe++]=(3&on)<<6|63&sn;return Vn}(te),oe=Array.isArray(ae)?function(te){for(var Z=te.length,ae=[],oe=0;oe<Z;oe+=4)ae.push(te[oe+3]<<24|te[oe+2]<<16|te[oe+1]<<8|te[oe]);return ae}(ae):new Uint32Array(ae),qe=Array.isArray(ae)?function(te){for(var Z=te.length,ae=[],oe=0;oe<Z;oe+=2)ae.push(te[oe+1]<<8|te[oe]);return ae}(ae):new Uint16Array(ae),Pt=$h(qe,12,oe[4]/2),on=2===oe[5]?$h(qe,(24+oe[4])/2):function(te,Z,ae){return te.slice?te.slice(Z,ae):new Uint32Array(Array.prototype.slice.call(te,Z,ae))}(oe,Math.ceil((24+oe[4])/4));return new $u(oe[0],oe[1],oe[2],oe[3],Pt,on)}("AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA="),r_=function(te){return Xm.get(te)},Ly=function(te,Z,ae){var oe=ae-2,qe=Z[oe],ft=Z[ae-1],Pt=Z[ae];if(2===ft&&3===Pt)return"\xd7";if(2===ft||3===ft||4===ft||2===Pt||3===Pt||4===Pt)return"\xf7";if(ft===$p&&-1!==[$p,$m,lp,cp].indexOf(Pt)||(ft===lp||ft===$m)&&(Pt===$m||10===Pt)||(ft===cp||10===ft)&&10===Pt||13===Pt||5===Pt||7===Pt||1===ft)return"\xd7";if(13===ft&&14===Pt){for(;5===qe;)qe=Z[--oe];if(14===qe)return"\xd7"}if(15===ft&&15===Pt){for(var on=0;15===qe;)on++,qe=Z[--oe];if(on%2==0)return"\xd7"}return"\xf7"},Xp=function(te){var Z=function(te){for(var Z=[],ae=0,oe=te.length;ae<oe;){var qe=te.charCodeAt(ae++);if(qe>=55296&&qe<=56319&&ae<oe){var ft=te.charCodeAt(ae++);56320==(64512&ft)?Z.push(((1023&qe)<<10)+(1023&ft)+65536):(Z.push(qe),ae--)}else Z.push(qe)}return Z}(te),ae=Z.length,oe=0,qe=0,ft=Z.map(r_);return{next:function(){if(oe>=ae)return{done:!0,value:null};for(var Pt="\xd7";oe<ae&&"\xd7"===(Pt=Ly(0,ft,++oe)););if("\xd7"!==Pt||oe===ae){var on=Zg.apply(null,Z.slice(qe,oe));return qe=oe,{value:on,done:!1}}return{done:!0,value:null}}}},Zm=function(te){return 0===te[0]&&255===te[1]&&0===te[2]&&255===te[3]},hp=function(te,Z,ae,oe,qe){var ft="http://www.w3.org/2000/svg",Pt=document.createElementNS(ft,"svg"),on=document.createElementNS(ft,"foreignObject");return Pt.setAttributeNS(null,"width",te.toString()),Pt.setAttributeNS(null,"height",Z.toString()),on.setAttributeNS(null,"width","100%"),on.setAttributeNS(null,"height","100%"),on.setAttributeNS(null,"x",ae.toString()),on.setAttributeNS(null,"y",oe.toString()),on.setAttributeNS(null,"externalResourcesRequired","true"),Pt.appendChild(on),on.appendChild(qe),Pt},Jg=function(te){return new Promise(function(Z,ae){var oe=new Image;oe.onload=function(){return Z(oe)},oe.onerror=ae,oe.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(te))})},nh={get SUPPORT_RANGE_BOUNDS(){var te=function(te){if(te.createRange){var ae=te.createRange();if(ae.getBoundingClientRect){var oe=te.createElement("boundtest");oe.style.height="123px",oe.style.display="block",te.body.appendChild(oe),ae.selectNode(oe);var qe=ae.getBoundingClientRect(),ft=Math.round(qe.height);if(te.body.removeChild(oe),123===ft)return!0}}return!1}(document);return Object.defineProperty(nh,"SUPPORT_RANGE_BOUNDS",{value:te}),te},get SUPPORT_WORD_BREAKING(){var te=nh.SUPPORT_RANGE_BOUNDS&&function(te){var Z=te.createElement("boundtest");Z.style.width="50px",Z.style.display="block",Z.style.fontSize="12px",Z.style.letterSpacing="0px",Z.style.wordSpacing="0px",te.body.appendChild(Z);var ae=te.createRange();Z.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"";var oe=Z.firstChild,qe=Ke(oe.data).map(function(sn){return ot(sn)}),ft=0,Pt={},on=qe.every(function(sn,Vn){ae.setStart(oe,ft),ae.setEnd(oe,ft+sn.length);var Kn=ae.getBoundingClientRect();ft+=sn.length;var li=Kn.x>Pt.x||Kn.y>Pt.y;return Pt=Kn,0===Vn||li});return te.body.removeChild(Z),on}(document);return Object.defineProperty(nh,"SUPPORT_WORD_BREAKING",{value:te}),te},get SUPPORT_SVG_DRAWING(){var te=function(te){var Z=new Image,ae=te.createElement("canvas"),oe=ae.getContext("2d");if(!oe)return!1;Z.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{oe.drawImage(Z,0,0),ae.toDataURL()}catch{return!1}return!0}(document);return Object.defineProperty(nh,"SUPPORT_SVG_DRAWING",{value:te}),te},get SUPPORT_FOREIGNOBJECT_DRAWING(){var te="function"==typeof Array.from&&"function"==typeof window.fetch?function(te){var Z=te.createElement("canvas"),ae=100;Z.width=ae,Z.height=ae;var oe=Z.getContext("2d");if(!oe)return Promise.reject(!1);oe.fillStyle="rgb(0, 255, 0)",oe.fillRect(0,0,ae,ae);var qe=new Image,ft=Z.toDataURL();qe.src=ft;var Pt=hp(ae,ae,0,0,qe);return oe.fillStyle="red",oe.fillRect(0,0,ae,ae),Jg(Pt).then(function(on){oe.drawImage(on,0,0);var sn=oe.getImageData(0,0,ae,ae).data;oe.fillStyle="red",oe.fillRect(0,0,ae,ae);var Vn=te.createElement("div");return Vn.style.backgroundImage="url("+ft+")",Vn.style.height="100px",Zm(sn)?Jg(hp(ae,ae,0,0,Vn)):Promise.reject(!1)}).then(function(on){return oe.drawImage(on,0,0),Zm(oe.getImageData(0,0,ae,ae).data)}).catch(function(){return!1})}(document):Promise.resolve(!1);return Object.defineProperty(nh,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:te}),te},get SUPPORT_CORS_IMAGES(){var te=typeof(new Image).crossOrigin<"u";return Object.defineProperty(nh,"SUPPORT_CORS_IMAGES",{value:te}),te},get SUPPORT_RESPONSE_TYPE(){var te="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(nh,"SUPPORT_RESPONSE_TYPE",{value:te}),te},get SUPPORT_CORS_XHR(){var te="withCredentials"in new XMLHttpRequest;return Object.defineProperty(nh,"SUPPORT_CORS_XHR",{value:te}),te},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var te=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(nh,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:te}),te}},Kp=function(){return function te(Z,ae){this.text=Z,this.bounds=ae}}(),kd=function(te,Z){var ae=Z.ownerDocument;if(ae){var oe=ae.createElement("html2canvaswrapper");oe.appendChild(Z.cloneNode(!0));var qe=Z.parentNode;if(qe){qe.replaceChild(oe,Z);var ft=Je(te,oe);return oe.firstChild&&qe.replaceChild(oe.firstChild,oe),ft}}return xe.EMPTY},Ny=function(te,Z,ae){var oe=te.ownerDocument;if(!oe)throw new Error("Node has no owner document");var qe=oe.createRange();return qe.setStart(te,Z),qe.setEnd(te,Z+ae),qe},t0=function(te){if(nh.SUPPORT_NATIVE_TEXT_SEGMENTATION){var Z=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(Z.segment(te)).map(function(ae){return ae.segment})}return function(te){for(var oe,Z=Xp(te),ae=[];!(oe=Z.next()).done;)oe.value&&ae.push(oe.value.slice());return ae}(te)},s_=function(te,Z){return 0!==Z.letterSpacing?t0(te):function(te,Z){if(nh.SUPPORT_NATIVE_TEXT_SEGMENTATION){var ae=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(ae.segment(te)).map(function(oe){return oe.segment})}return Na(te,Z)}(te,Z)},Fd=[32,160,4961,65792,65793,4153,4241],Na=function(te,Z){for(var qe,ae=function(te,Z){var ae=Ke(te),oe=Ae(ae,Z),qe=oe[0],ft=oe[1],Pt=oe[2],on=ae.length,sn=0,Vn=0;return{next:function(){if(Vn>=on)return{done:!0,value:null};for(var Kn=Zt;Vn<on&&(Kn=J(ae,ft,qe,++Vn,Pt))===Zt;);if(Kn!==Zt||Vn===on){var li=new Ce(ae,Kn,sn,Vn);return sn=Vn,{value:li,done:!1}}return{done:!0,value:null}}}}(te,{lineBreak:Z.lineBreak,wordBreak:"break-word"===Z.overflowWrap?"break-word":Z.wordBreak}),oe=[],ft=function(){if(qe.value){var Pt=qe.value.slice(),on=Ke(Pt),sn="";on.forEach(function(Vn){-1===Fd.indexOf(Vn)?sn+=ot(Vn):(sn.length&&oe.push(sn),oe.push(ot(Vn)),sn="")}),sn.length&&oe.push(sn)}};!(qe=ae.next()).done;)ft();return oe},o_=function(){return function te(Z,ae,oe){this.text=Od(ae.data,oe.textTransform),this.textBounds=function(te,Z,ae,oe){var qe=s_(Z,ae),ft=[],Pt=0;return qe.forEach(function(on){if(ae.textDecorationLine.length||on.trim().length>0)if(nh.SUPPORT_RANGE_BOUNDS){var sn=Ny(oe,Pt,on.length).getClientRects();if(sn.length>1){var Vn=t0(on),Kn=0;Vn.forEach(function(Ni){ft.push(new Kp(Ni,xe.fromDOMRectList(te,Ny(oe,Kn+Pt,Ni.length).getClientRects()))),Kn+=Ni.length})}else ft.push(new Kp(on,xe.fromDOMRectList(te,sn)))}else{var li=oe.splitText(on.length);ft.push(new Kp(on,kd(te,oe))),oe=li}else nh.SUPPORT_RANGE_BOUNDS||(oe=oe.splitText(on.length));Pt+=on.length}),ft}(Z,this.text,oe,ae)}}(),Od=function(te,Z){switch(Z){case 1:return te.toLowerCase();case 3:return te.replace(VA,Ev);case 2:return te.toUpperCase();default:return te}},VA=/(^|\s|:|-|\(|\))([a-z])/g,Ev=function(te,Z,ae){return te.length>0?Z+ae.toUpperCase():te},Mc=function(te){function Z(ae,oe){var qe=te.call(this,ae,oe)||this;return qe.src=oe.currentSrc||oe.src,qe.intrinsicWidth=oe.naturalWidth,qe.intrinsicHeight=oe.naturalHeight,qe.context.cache.addImage(qe.src),qe}return Te(Z,te),Z}(Zl),a_=function(te){function Z(ae,oe){var qe=te.call(this,ae,oe)||this;return qe.canvas=oe,qe.intrinsicWidth=oe.width,qe.intrinsicHeight=oe.height,qe}return Te(Z,te),Z}(Zl),Uy=function(te){function Z(ae,oe){var qe=te.call(this,ae,oe)||this,ft=new XMLSerializer,Pt=Je(ae,oe);return oe.setAttribute("width",Pt.width+"px"),oe.setAttribute("height",Pt.height+"px"),qe.svg="data:image/svg+xml,"+encodeURIComponent(ft.serializeToString(oe)),qe.intrinsicWidth=oe.width.baseVal.value,qe.intrinsicHeight=oe.height.baseVal.value,qe.context.cache.addImage(qe.svg),qe}return Te(Z,te),Z}(Zl),Jm=function(te){function Z(ae,oe){var qe=te.call(this,ae,oe)||this;return qe.value=oe.value,qe}return Te(Z,te),Z}(Zl),n0=function(te){function Z(ae,oe){var qe=te.call(this,ae,oe)||this;return qe.start=oe.start,qe.reversed="boolean"==typeof oe.reversed&&!0===oe.reversed,qe}return Te(Z,te),Z}(Zl),zy=[{type:15,flags:0,unit:"px",number:3}],Sv=[{type:16,flags:0,number:50}],GA="checkbox",eA="radio",qA="password",Ml=707406591,vr=function(te){function Z(ae,oe){var qe=te.call(this,ae,oe)||this;switch(qe.type=oe.type.toLowerCase(),qe.checked=oe.checked,qe.value=function(te){var Z=te.type===qA?new Array(te.value.length+1).join("\u2022"):te.value;return 0===Z.length?te.placeholder||"":Z}(oe),(qe.type===GA||qe.type===eA)&&(qe.styles.backgroundColor=3739148031,qe.styles.borderTopColor=qe.styles.borderRightColor=qe.styles.borderBottomColor=qe.styles.borderLeftColor=2779096575,qe.styles.borderTopWidth=qe.styles.borderRightWidth=qe.styles.borderBottomWidth=qe.styles.borderLeftWidth=1,qe.styles.borderTopStyle=qe.styles.borderRightStyle=qe.styles.borderBottomStyle=qe.styles.borderLeftStyle=1,qe.styles.backgroundClip=[0],qe.styles.backgroundOrigin=[0],qe.bounds=function(te){return te.width>te.height?new xe(te.left+(te.width-te.height)/2,te.top,te.height,te.height):te.width<te.height?new xe(te.left,te.top+(te.height-te.width)/2,te.width,te.width):te}(qe.bounds)),qe.type){case GA:qe.styles.borderTopRightRadius=qe.styles.borderTopLeftRadius=qe.styles.borderBottomRightRadius=qe.styles.borderBottomLeftRadius=zy;break;case eA:qe.styles.borderTopRightRadius=qe.styles.borderTopLeftRadius=qe.styles.borderBottomRightRadius=qe.styles.borderBottomLeftRadius=Sv}return qe}return Te(Z,te),Z}(Zl),Ys=function(te){function Z(ae,oe){var qe=te.call(this,ae,oe)||this,ft=oe.options[oe.selectedIndex||0];return qe.value=ft&&ft.text||"",qe}return Te(Z,te),Z}(Zl),uc=function(te){function Z(ae,oe){var qe=te.call(this,ae,oe)||this;return qe.value=oe.value,qe}return Te(Z,te),Z}(Zl),Xu=function(te){function Z(ae,oe){var qe=te.call(this,ae,oe)||this;qe.src=oe.src,qe.width=parseInt(oe.width,10)||0,qe.height=parseInt(oe.height,10)||0,qe.backgroundColor=qe.styles.backgroundColor;try{if(oe.contentWindow&&oe.contentWindow.document&&oe.contentWindow.document.documentElement){qe.tree=hl(ae,oe.contentWindow.document.documentElement);var ft=oe.contentWindow.document.documentElement?Np(ae,getComputedStyle(oe.contentWindow.document.documentElement).backgroundColor):qo.TRANSPARENT,Pt=oe.contentWindow.document.body?Np(ae,getComputedStyle(oe.contentWindow.document.body).backgroundColor):qo.TRANSPARENT;qe.backgroundColor=Hh(ft)?Hh(Pt)?qe.styles.backgroundColor:Pt:ft}}catch{}return qe}return Te(Z,te),Z}(Zl),ih=["OL","UL","MENU"],$c=function(te,Z,ae,oe){for(var qe=Z.firstChild,ft=void 0;qe;qe=ft)if(ft=qe.nextSibling,_o(qe)&&qe.data.trim().length>0)ae.textNodes.push(new o_(te,qe,ae.styles));else if(Nd(qe))if(tm(qe)&&qe.assignedNodes)qe.assignedNodes().forEach(function(on){return $c(te,on,ae,oe)});else{var Pt=up(te,qe);Pt.styles.isVisible()&&(Ec(qe,Pt,oe)?Pt.flags|=4:Ld(Pt.styles)&&(Pt.flags|=2),-1!==ih.indexOf(qe.tagName)&&(Pt.flags|=8),ae.elements.push(Pt),qe.shadowRoot?$c(te,qe.shadowRoot,Pt,oe):!Kh(qe)&&!Jp(qe)&&!em(qe)&&$c(te,qe,Pt,oe))}},up=function(te,Z){return Yh(Z)?new Mc(te,Z):bf(Z)?new a_(te,Z):Jp(Z)?new Uy(te,Z):Pl(Z)?new Jm(te,Z):Zp(Z)?new n0(te,Z):tA(Z)?new vr(te,Z):em(Z)?new Ys(te,Z):Kh(Z)?new uc(te,Z):Fs(Z)?new Xu(te,Z):new Zl(te,Z)},hl=function(te,Z){var ae=up(te,Z);return ae.flags|=4,$c(te,Z,ae,ae),ae},Ec=function(te,Z,ae){return Z.styles.isPositionedWithZIndex()||Z.styles.opacity<1||Z.styles.isTransformed()||s0(te)&&ae.styles.isTransparent()},Ld=function(te){return te.isPositioned()||te.isFloating()},_o=function(te){return te.nodeType===Node.TEXT_NODE},Nd=function(te){return te.nodeType===Node.ELEMENT_NODE},r0=function(te){return Nd(te)&&typeof te.style<"u"&&!vf(te)},vf=function(te){return"object"==typeof te.className},Pl=function(te){return"LI"===te.tagName},Zp=function(te){return"OL"===te.tagName},tA=function(te){return"INPUT"===te.tagName},Jp=function(te){return"svg"===te.tagName},s0=function(te){return"BODY"===te.tagName},bf=function(te){return"CANVAS"===te.tagName},QA=function(te){return"VIDEO"===te.tagName},Yh=function(te){return"IMG"===te.tagName},Fs=function(te){return"IFRAME"===te.tagName},o0=function(te){return"STYLE"===te.tagName},Kh=function(te){return"TEXTAREA"===te.tagName},em=function(te){return"SELECT"===te.tagName},tm=function(te){return"SLOT"===te.tagName},ec=function(te){return te.tagName.indexOf("-")>0},WA=function(){function te(){this.counters={}}return te.prototype.getCounterValue=function(Z){var ae=this.counters[Z];return ae&&ae.length?ae[ae.length-1]:1},te.prototype.getCounterValues=function(Z){return this.counters[Z]||[]},te.prototype.pop=function(Z){var ae=this;Z.forEach(function(oe){return ae.counters[oe].pop()})},te.prototype.parse=function(Z){var ae=this,oe=Z.counterIncrement,qe=Z.counterReset,ft=!0;null!==oe&&oe.forEach(function(on){var sn=ae.counters[on.counter];sn&&0!==on.increment&&(ft=!1,sn.length||sn.push(1),sn[Math.max(0,sn.length-1)]+=on.increment)});var Pt=[];return ft&&qe.forEach(function(on){var sn=ae.counters[on.counter];Pt.push(on.counter),sn||(sn=ae.counters[on.counter]=[]),sn.push(on.reset)}),Pt},te}(),Sc={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},rh={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054f","\u054e","\u054d","\u054c","\u054b","\u054a","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053f","\u053e","\u053d","\u053c","\u053b","\u053a","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},l_={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05d9\u05f3","\u05d8\u05f3","\u05d7\u05f3","\u05d6\u05f3","\u05d5\u05f3","\u05d4\u05f3","\u05d3\u05f3","\u05d2\u05f3","\u05d1\u05f3","\u05d0\u05f3","\u05ea","\u05e9","\u05e8","\u05e7","\u05e6","\u05e4","\u05e2","\u05e1","\u05e0","\u05de","\u05dc","\u05db","\u05d9\u05d8","\u05d9\u05d7","\u05d9\u05d6","\u05d8\u05d6","\u05d8\u05d5","\u05d9","\u05d8","\u05d7","\u05d6","\u05d5","\u05d4","\u05d3","\u05d2","\u05d1","\u05d0"]},nm={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10f5","\u10f0","\u10ef","\u10f4","\u10ee","\u10ed","\u10ec","\u10eb","\u10ea","\u10e9","\u10e8","\u10e7","\u10e6","\u10e5","\u10e4","\u10f3","\u10e2","\u10e1","\u10e0","\u10df","\u10de","\u10dd","\u10f2","\u10dc","\u10db","\u10da","\u10d9","\u10d8","\u10d7","\u10f1","\u10d6","\u10d5","\u10d4","\u10d3","\u10d2","\u10d1","\u10d0"]},xf=function(te,Z,ae,oe,qe,ft){return te<Z||te>ae?XA(te,qe,ft.length>0):oe.integers.reduce(function(Pt,on,sn){for(;te>=on;)te-=on,Pt+=oe.values[sn];return Pt},"")+ft},Yu=function(te,Z,ae,oe){var qe="";do{ae||te--,qe=oe(te)+qe,te/=Z}while(te*Z>=Z);return qe},bl=function(te,Z,ae,oe,qe){var ft=ae-Z+1;return(te<0?"-":"")+(Yu(Math.abs(te),ft,oe,function(Pt){return ot(Math.floor(Pt%ft)+Z)})+qe)},dp=function(te,Z,ae){void 0===ae&&(ae=". ");var oe=Z.length;return Yu(Math.abs(te),oe,!1,function(qe){return Z[Math.floor(qe%oe)]})+ae},Ad=function(te,Z,ae,oe,qe,ft){if(te<-9999||te>9999)return XA(te,4,qe.length>0);var Pt=Math.abs(te),on=qe;if(0===Pt)return Z[0]+on;for(var sn=0;Pt>0&&sn<=4;sn++){var Vn=Pt%10;0===Vn&&Al(ft,1)&&""!==on?on=Z[Vn]+on:Vn>1||1===Vn&&0===sn||1===Vn&&1===sn&&Al(ft,2)||1===Vn&&1===sn&&Al(ft,4)&&te>100||1===Vn&&sn>1&&Al(ft,8)?on=Z[Vn]+(sn>0?ae[sn-1]:"")+on:1===Vn&&sn>0&&(on=ae[sn-1]+on),Pt=Math.floor(Pt/10)}return(te<0?oe:"")+on},c_="\ub9c8\uc774\ub108\uc2a4",XA=function(te,Z,ae){var oe=ae?". ":"",qe=ae?"\u3001":"",ft=ae?", ":"",Pt=ae?" ":"";switch(Z){case 0:return"\u2022"+Pt;case 1:return"\u25e6"+Pt;case 2:return"\u25fe"+Pt;case 5:var on=bl(te,48,57,!0,oe);return on.length<4?"0"+on:on;case 4:return dp(te,"\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d",qe);case 6:return xf(te,1,3999,Sc,3,oe).toLowerCase();case 7:return xf(te,1,3999,Sc,3,oe);case 8:return bl(te,945,969,!1,oe);case 9:return bl(te,97,122,!1,oe);case 10:return bl(te,65,90,!1,oe);case 11:return bl(te,1632,1641,!0,oe);case 12:case 49:return xf(te,1,9999,rh,3,oe);case 35:return xf(te,1,9999,rh,3,oe).toLowerCase();case 13:return bl(te,2534,2543,!0,oe);case 14:case 30:return bl(te,6112,6121,!0,oe);case 15:return dp(te,"\u5b50\u4e11\u5bc5\u536f\u8fb0\u5df3\u5348\u672a\u7533\u9149\u620c\u4ea5",qe);case 16:return dp(te,"\u7532\u4e59\u4e19\u4e01\u620a\u5df1\u5e9a\u8f9b\u58ec\u7678",qe);case 17:case 48:return Ad(te,"\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u842c","\u8ca0",qe,14);case 47:return Ad(te,"\u96f6\u58f9\u8cb3\u53c3\u8086\u4f0d\u9678\u67d2\u634c\u7396","\u62fe\u4f70\u4edf\u842c","\u8ca0",qe,15);case 42:return Ad(te,"\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u842c","\u8d1f",qe,14);case 41:return Ad(te,"\u96f6\u58f9\u8d30\u53c1\u8086\u4f0d\u9646\u67d2\u634c\u7396","\u62fe\u4f70\u4edf\u842c","\u8d1f",qe,15);case 26:return Ad(te,"\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u4e07","\u30de\u30a4\u30ca\u30b9",qe,0);case 25:return Ad(te,"\u96f6\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d","\u62fe\u767e\u5343\u4e07","\u30de\u30a4\u30ca\u30b9",qe,7);case 31:return Ad(te,"\uc601\uc77c\uc774\uc0bc\uc0ac\uc624\uc721\uce60\ud314\uad6c","\uc2ed\ubc31\ucc9c\ub9cc",c_,ft,7);case 33:return Ad(te,"\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u842c",c_,ft,0);case 32:return Ad(te,"\u96f6\u58f9\u8cb3\u53c3\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u62fe\u767e\u5343",c_,ft,7);case 18:return bl(te,2406,2415,!0,oe);case 20:return xf(te,1,19999,nm,3,oe);case 21:return bl(te,2790,2799,!0,oe);case 22:return bl(te,2662,2671,!0,oe);case 22:return xf(te,1,10999,l_,3,oe);case 23:return dp(te,"\u3042\u3044\u3046\u3048\u304a\u304b\u304d\u304f\u3051\u3053\u3055\u3057\u3059\u305b\u305d\u305f\u3061\u3064\u3066\u3068\u306a\u306b\u306c\u306d\u306e\u306f\u3072\u3075\u3078\u307b\u307e\u307f\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308a\u308b\u308c\u308d\u308f\u3090\u3091\u3092\u3093");case 24:return dp(te,"\u3044\u308d\u306f\u306b\u307b\u3078\u3068\u3061\u308a\u306c\u308b\u3092\u308f\u304b\u3088\u305f\u308c\u305d\u3064\u306d\u306a\u3089\u3080\u3046\u3090\u306e\u304a\u304f\u3084\u307e\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304d\u3086\u3081\u307f\u3057\u3091\u3072\u3082\u305b\u3059");case 27:return bl(te,3302,3311,!0,oe);case 28:return dp(te,"\u30a2\u30a4\u30a6\u30a8\u30aa\u30ab\u30ad\u30af\u30b1\u30b3\u30b5\u30b7\u30b9\u30bb\u30bd\u30bf\u30c1\u30c4\u30c6\u30c8\u30ca\u30cb\u30cc\u30cd\u30ce\u30cf\u30d2\u30d5\u30d8\u30db\u30de\u30df\u30e0\u30e1\u30e2\u30e4\u30e6\u30e8\u30e9\u30ea\u30eb\u30ec\u30ed\u30ef\u30f0\u30f1\u30f2\u30f3",qe);case 29:return dp(te,"\u30a4\u30ed\u30cf\u30cb\u30db\u30d8\u30c8\u30c1\u30ea\u30cc\u30eb\u30f2\u30ef\u30ab\u30e8\u30bf\u30ec\u30bd\u30c4\u30cd\u30ca\u30e9\u30e0\u30a6\u30f0\u30ce\u30aa\u30af\u30e4\u30de\u30b1\u30d5\u30b3\u30a8\u30c6\u30a2\u30b5\u30ad\u30e6\u30e1\u30df\u30b7\u30f1\u30d2\u30e2\u30bb\u30b9",qe);case 34:return bl(te,3792,3801,!0,oe);case 37:return bl(te,6160,6169,!0,oe);case 38:return bl(te,4160,4169,!0,oe);case 39:return bl(te,2918,2927,!0,oe);case 40:return bl(te,1776,1785,!0,oe);case 43:return bl(te,3046,3055,!0,oe);case 44:return bl(te,3174,3183,!0,oe);case 45:return bl(te,3664,3673,!0,oe);case 46:return bl(te,3872,3881,!0,oe);default:return bl(te,48,57,!0,oe)}},iA="data-html2canvas-ignore",h_=function(){function te(Z,ae,oe){if(this.context=Z,this.options=oe,this.scrolledElements=[],this.referenceElement=ae,this.counters=new WA,this.quoteDepth=0,!ae.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(ae.ownerDocument.documentElement,!1)}return te.prototype.toIFrame=function(Z,ae){var oe=this,qe=d_(Z,ae);if(!qe.contentWindow)return Promise.reject("Unable to find iframe window");var ft=Z.defaultView.pageXOffset,Pt=Z.defaultView.pageYOffset,on=qe.contentWindow,sn=on.document,Vn=Rv(qe).then(function(){return v(oe,void 0,void 0,function(){var Kn,li;return V(this,function(Ni){switch(Ni.label){case 0:return this.scrolledElements.forEach(MM),on&&(on.scrollTo(ae.left,ae.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(on.scrollY!==ae.top||on.scrollX!==ae.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(on.scrollX-ae.left,on.scrollY-ae.top,0,0))),Kn=this.options.onclone,typeof(li=this.clonedReferenceElement)>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:sn.fonts&&sn.fonts.ready?[4,sn.fonts.ready]:[3,2];case 1:Ni.sent(),Ni.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Kx(sn)]:[3,4];case 3:Ni.sent(),Ni.label=4;case 4:return"function"==typeof Kn?[2,Promise.resolve().then(function(){return Kn(sn,li)}).then(function(){return qe})]:[2,qe]}})})});return sn.open(),sn.write(CM(document.doctype)+"<html></html>"),Zx(this.referenceElement.ownerDocument,ft,Pt),sn.replaceChild(sn.adoptNode(this.documentElement),sn.documentElement),sn.close(),Vn},te.prototype.createElementClone=function(Z){if(jp(Z,2),bf(Z))return this.createCanvasClone(Z);if(QA(Z))return this.createVideoClone(Z);if(o0(Z))return this.createStyleClone(Z);var ae=Z.cloneNode(!1);return Yh(ae)&&(Yh(Z)&&Z.currentSrc&&Z.currentSrc!==Z.src&&(ae.src=Z.currentSrc,ae.srcset=""),"lazy"===ae.loading&&(ae.loading="eager")),ec(ae)?this.createCustomElementClone(ae):ae},te.prototype.createCustomElementClone=function(Z){var ae=document.createElement("html2canvascustomelement");return f_(Z.style,ae),ae},te.prototype.createStyleClone=function(Z){try{var ae=Z.sheet;if(ae&&ae.cssRules){var oe=[].slice.call(ae.cssRules,0).reduce(function(ft,Pt){return Pt&&"string"==typeof Pt.cssText?ft+Pt.cssText:ft},""),qe=Z.cloneNode(!1);return qe.textContent=oe,qe}}catch(ft){if(this.context.logger.error("Unable to access cssRules property",ft),"SecurityError"!==ft.name)throw ft}return Z.cloneNode(!1)},te.prototype.createCanvasClone=function(Z){var ae;if(this.options.inlineImages&&Z.ownerDocument){var oe=Z.ownerDocument.createElement("img");try{return oe.src=Z.toDataURL(),oe}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",Z)}}var qe=Z.cloneNode(!1);try{qe.width=Z.width,qe.height=Z.height;var ft=Z.getContext("2d"),Pt=qe.getContext("2d");if(Pt)if(!this.options.allowTaint&&ft)Pt.putImageData(ft.getImageData(0,0,Z.width,Z.height),0,0);else{var on=null!==(ae=Z.getContext("webgl2"))&&void 0!==ae?ae:Z.getContext("webgl");if(on){var sn=on.getContextAttributes();!1===sn?.preserveDrawingBuffer&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",Z)}Pt.drawImage(Z,0,0)}return qe}catch{this.context.logger.info("Unable to clone canvas as it is tainted",Z)}return qe},te.prototype.createVideoClone=function(Z){var ae=Z.ownerDocument.createElement("canvas");ae.width=Z.offsetWidth,ae.height=Z.offsetHeight;var oe=ae.getContext("2d");try{return oe&&(oe.drawImage(Z,0,0,ae.width,ae.height),this.options.allowTaint||oe.getImageData(0,0,ae.width,ae.height)),ae}catch{this.context.logger.info("Unable to clone video as it is tainted",Z)}var qe=Z.ownerDocument.createElement("canvas");return qe.width=Z.offsetWidth,qe.height=Z.offsetHeight,qe},te.prototype.appendChildNode=function(Z,ae,oe){(!Nd(ae)||!function(te){return"SCRIPT"===te.tagName}(ae)&&!ae.hasAttribute(iA)&&("function"!=typeof this.options.ignoreElements||!this.options.ignoreElements(ae)))&&(!this.options.copyStyles||!Nd(ae)||!o0(ae))&&Z.appendChild(this.cloneNode(ae,oe))},te.prototype.cloneChildNodes=function(Z,ae,oe){for(var qe=this,ft=Z.shadowRoot?Z.shadowRoot.firstChild:Z.firstChild;ft;ft=ft.nextSibling)if(Nd(ft)&&tm(ft)&&"function"==typeof ft.assignedNodes){var Pt=ft.assignedNodes();Pt.length&&Pt.forEach(function(on){return qe.appendChildNode(ae,on,oe)})}else this.appendChildNode(ae,ft,oe)},te.prototype.cloneNode=function(Z,ae){if(_o(Z))return document.createTextNode(Z.data);if(!Z.ownerDocument)return Z.cloneNode(!1);var oe=Z.ownerDocument.defaultView;if(oe&&Nd(Z)&&(r0(Z)||vf(Z))){var qe=this.createElementClone(Z);qe.style.transitionProperty="none";var ft=oe.getComputedStyle(Z),Pt=oe.getComputedStyle(Z,":before"),on=oe.getComputedStyle(Z,":after");this.referenceElement===Z&&r0(qe)&&(this.clonedReferenceElement=qe),s0(qe)&&SM(qe);var sn=this.counters.parse(new _l(this.context,ft)),Vn=this.resolvePseudoContent(Z,qe,Pt,u_.BEFORE);ec(Z)&&(ae=!0),QA(Z)||this.cloneChildNodes(Z,qe,ae),Vn&&qe.insertBefore(Vn,qe.firstChild);var Kn=this.resolvePseudoContent(Z,qe,on,u_.AFTER);return Kn&&qe.appendChild(Kn),this.counters.pop(sn),(ft&&(this.options.copyStyles||vf(Z))&&!Fs(Z)||ae)&&f_(ft,qe),(0!==Z.scrollTop||0!==Z.scrollLeft)&&this.scrolledElements.push([qe,Z.scrollLeft,Z.scrollTop]),(Kh(Z)||em(Z))&&(Kh(qe)||em(qe))&&(qe.value=Z.value),qe}return Z.cloneNode(!1)},te.prototype.resolvePseudoContent=function(Z,ae,oe,qe){var ft=this;if(oe){var Pt=oe.content,on=ae.ownerDocument;if(on&&Pt&&"none"!==Pt&&"-moz-alt-content"!==Pt&&"none"!==oe.display){this.counters.parse(new _l(this.context,oe));var sn=new Ba(this.context,oe),Vn=on.createElement("html2canvaspseudoelement");f_(oe,Vn),sn.content.forEach(function(li){if(0===li.type)Vn.appendChild(on.createTextNode(li.value));else if(22===li.type){var Ni=on.createElement("img");Ni.src=li.value,Ni.style.opacity="1",Vn.appendChild(Ni)}else if(18===li.type){if("attr"===li.name){var us=li.values.filter(Ca);us.length&&Vn.appendChild(on.createTextNode(Z.getAttribute(us[0].value)||""))}else if("counter"===li.name){var Pr=li.values.filter(ju),Co=Pr[1];if((Cr=Pr[0])&&Ca(Cr)){var kr=ft.counters.getCounterValue(Cr.value),Fr=Co&&Ca(Co)?Xo.parse(ft.context,Co.value):3;Vn.appendChild(on.createTextNode(XA(kr,Fr,!1)))}}else if("counters"===li.name){var Cr,Ua=li.values.filter(ju),vo=Ua[1];if(Co=Ua[2],(Cr=Ua[0])&&Ca(Cr)){var Mo=ft.counters.getCounterValues(Cr.value),as=Co&&Ca(Co)?Xo.parse(ft.context,Co.value):3,ga=vo&&0===vo.type?vo.value:"",aa=Mo.map(function(Ea){return XA(Ea,as,!1)}).join(ga);Vn.appendChild(on.createTextNode(aa))}}}else if(20===li.type)switch(li.value){case"open-quote":Vn.appendChild(on.createTextNode(gl(sn.quotes,ft.quoteDepth++,!0)));break;case"close-quote":Vn.appendChild(on.createTextNode(gl(sn.quotes,--ft.quoteDepth,!1)));break;default:Vn.appendChild(on.createTextNode(li.value))}}),Vn.className=p_+" "+dc;var Kn=qe===u_.BEFORE?" "+p_:" "+dc;return vf(ae)?ae.className.baseValue+=Kn:ae.className+=Kn,Vn}}},te.destroy=function(Z){return!!Z.parentNode&&(Z.parentNode.removeChild(Z),!0)},te}(),u_=function(te){return te[te.BEFORE=0]="BEFORE",te[te.AFTER=1]="AFTER",te}(u_||{}),d_=function(te,Z){var ae=te.createElement("iframe");return ae.className="html2canvas-container",ae.style.visibility="hidden",ae.style.position="fixed",ae.style.left="-10000px",ae.style.top="0px",ae.style.border="0",ae.width=Z.width.toString(),ae.height=Z.height.toString(),ae.scrolling="no",ae.setAttribute(iA,"true"),te.body.appendChild(ae),ae},Pv=function(te){return new Promise(function(Z){te.complete?Z():te.src?(te.onload=Z,te.onerror=Z):Z()})},Kx=function(te){return Promise.all([].slice.call(te.images,0).map(Pv))},Rv=function(te){return new Promise(function(Z,ae){var oe=te.contentWindow;if(!oe)return ae("No window assigned for iframe");var qe=oe.document;oe.onload=te.onload=function(){oe.onload=te.onload=null;var ft=setInterval(function(){qe.body.childNodes.length>0&&"complete"===qe.readyState&&(clearInterval(ft),Z(te))},50)}})},Vy=["all","d","content"],f_=function(te,Z){for(var ae=te.length-1;ae>=0;ae--){var oe=te.item(ae);-1===Vy.indexOf(oe)&&Z.style.setProperty(oe,te.getPropertyValue(oe))}return Z},CM=function(te){var Z="";return te&&(Z+="<!DOCTYPE ",te.name&&(Z+=te.name),te.internalSubset&&(Z+=te.internalSubset),te.publicId&&(Z+='"'+te.publicId+'"'),te.systemId&&(Z+='"'+te.systemId+'"'),Z+=">"),Z},Zx=function(te,Z,ae){te&&te.defaultView&&(Z!==te.defaultView.pageXOffset||ae!==te.defaultView.pageYOffset)&&te.defaultView.scrollTo(Z,ae)},MM=function(te){var Z=te[0],oe=te[2];Z.scrollLeft=te[1],Z.scrollTop=oe},p_="___html2canvas___pseudoelement_before",dc="___html2canvas___pseudoelement_after",Gy='{\n    content: "" !important;\n    display: none !important;\n}',SM=function(te){m_(te,"."+p_+":before"+Gy+"\n         ."+dc+":after"+Gy)},m_=function(te,Z){var ae=te.ownerDocument;if(ae){var oe=ae.createElement("style");oe.textContent=Z,te.appendChild(oe)}},Cf=function(){function te(){}return te.getOrigin=function(Z){var ae=te._link;return ae?(ae.href=Z,ae.href=ae.href,ae.protocol+ae.hostname+ae.port):"about:blank"},te.isSameOrigin=function(Z){return te.getOrigin(Z)===te._origin},te.setContext=function(Z){te._link=Z.document.createElement("a"),te._origin=te.getOrigin(Z.location.href)},te._origin="about:blank",te}(),Fv=function(){function te(Z,ae){this.context=Z,this._options=ae,this._cache={}}return te.prototype.addImage=function(Z){var ae=Promise.resolve();return this.has(Z)||(Pa(Z)||fp(Z))&&(this._cache[Z]=this.loadImage(Z)).catch(function(){}),ae},te.prototype.match=function(Z){return this._cache[Z]},te.prototype.loadImage=function(Z){return v(this,void 0,void 0,function(){var ae,oe,qe,ft,Pt=this;return V(this,function(on){switch(on.label){case 0:return ae=Cf.isSameOrigin(Z),oe=!A_(Z)&&!0===this._options.useCORS&&nh.SUPPORT_CORS_IMAGES&&!ae,qe=!A_(Z)&&!ae&&!Pa(Z)&&"string"==typeof this._options.proxy&&nh.SUPPORT_CORS_XHR&&!oe,ae||!1!==this._options.allowTaint||A_(Z)||Pa(Z)||qe||oe?(ft=Z,qe?[4,this.proxy(ft)]:[3,2]):[2];case 1:ft=on.sent(),on.label=2;case 2:return this.context.logger.debug("Added image "+Z.substring(0,256)),[4,new Promise(function(sn,Vn){var Kn=new Image;Kn.onload=function(){return sn(Kn)},Kn.onerror=Vn,(a0(ft)||oe)&&(Kn.crossOrigin="anonymous"),Kn.src=ft,!0===Kn.complete&&setTimeout(function(){return sn(Kn)},500),Pt._options.imageTimeout>0&&setTimeout(function(){return Vn("Timed out ("+Pt._options.imageTimeout+"ms) loading image")},Pt._options.imageTimeout)})];case 3:return[2,on.sent()]}})})},te.prototype.has=function(Z){return typeof this._cache[Z]<"u"},te.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},te.prototype.proxy=function(Z){var ae=this,oe=this._options.proxy;if(!oe)throw new Error("No proxy defined");var qe=Z.substring(0,256);return new Promise(function(ft,Pt){var on=nh.SUPPORT_RESPONSE_TYPE?"blob":"text",sn=new XMLHttpRequest;sn.onload=function(){if(200===sn.status)if("text"===on)ft(sn.response);else{var li=new FileReader;li.addEventListener("load",function(){return ft(li.result)},!1),li.addEventListener("error",function(Ni){return Pt(Ni)},!1),li.readAsDataURL(sn.response)}else Pt("Failed to proxy resource "+qe+" with status code "+sn.status)},sn.onerror=Pt;var Vn=oe.indexOf("?")>-1?"&":"?";if(sn.open("GET",""+oe+Vn+"url="+encodeURIComponent(Z)+"&responseType="+on),"text"!==on&&sn instanceof XMLHttpRequest&&(sn.responseType=on),ae._options.imageTimeout){var Kn=ae._options.imageTimeout;sn.timeout=Kn,sn.ontimeout=function(){return Pt("Timed out ("+Kn+"ms) proxying "+qe)}}sn.send()})},te}(),Jx=/^data:image\/svg\+xml/i,qy=/^data:image\/.*;base64,/i,Ov=/^data:image\/.*/i,fp=function(te){return nh.SUPPORT_SVG_DRAWING||!Qy(te)},A_=function(te){return Ov.test(te)},a0=function(te){return qy.test(te)},Pa=function(te){return"blob"===te.substr(0,4)},Qy=function(te){return"svg"===te.substr(-3).toLowerCase()||Jx.test(te)},rs=function(){function te(Z,ae){this.type=0,this.x=Z,this.y=ae}return te.prototype.add=function(Z,ae){return new te(this.x+Z,this.y+ae)},te}(),Tc=function(te,Z,ae){return new rs(te.x+(Z.x-te.x)*ae,te.y+(Z.y-te.y)*ae)},jy=function(){function te(Z,ae,oe,qe){this.type=1,this.start=Z,this.startControl=ae,this.endControl=oe,this.end=qe}return te.prototype.subdivide=function(Z,ae){var oe=Tc(this.start,this.startControl,Z),qe=Tc(this.startControl,this.endControl,Z),ft=Tc(this.endControl,this.end,Z),Pt=Tc(oe,qe,Z),on=Tc(qe,ft,Z),sn=Tc(Pt,on,Z);return ae?new te(this.start,oe,Pt,sn):new te(sn,on,ft,this.end)},te.prototype.add=function(Z,ae){return new te(this.start.add(Z,ae),this.startControl.add(Z,ae),this.endControl.add(Z,ae),this.end.add(Z,ae))},te.prototype.reverse=function(){return new te(this.end,this.endControl,this.startControl,this.start)},te}(),tc=function(te){return 1===te.type},im=function(){return function te(Z){var ae=Z.styles,oe=Z.bounds,qe=RA(ae.borderTopLeftRadius,oe.width,oe.height),ft=qe[0],Pt=qe[1],on=RA(ae.borderTopRightRadius,oe.width,oe.height),sn=on[0],Vn=on[1],Kn=RA(ae.borderBottomRightRadius,oe.width,oe.height),li=Kn[0],Ni=Kn[1],us=RA(ae.borderBottomLeftRadius,oe.width,oe.height),Pr=us[0],Cr=us[1],Co=[];Co.push((ft+sn)/oe.width),Co.push((Pr+li)/oe.width),Co.push((Pt+Cr)/oe.height),Co.push((Vn+Ni)/oe.height);var kr=Math.max.apply(Math,Co);kr>1&&(ft/=kr,Pt/=kr,sn/=kr,Vn/=kr,li/=kr,Ni/=kr,Pr/=kr,Cr/=kr);var Fr=oe.width-sn,Ua=oe.height-Ni,vo=oe.width-li,Mo=oe.height-Cr,as=ae.borderTopWidth,ga=ae.borderRightWidth,aa=ae.borderBottomWidth,Ks=ae.borderLeftWidth,El=rl(ae.paddingTop,Z.bounds.width),Ea=rl(ae.paddingRight,Z.bounds.width),Ra=rl(ae.paddingBottom,Z.bounds.width),ka=rl(ae.paddingLeft,Z.bounds.width);this.topLeftBorderDoubleOuterBox=ft>0||Pt>0?nl(oe.left+Ks/3,oe.top+as/3,ft-Ks/3,Pt-as/3,Js.TOP_LEFT):new rs(oe.left+Ks/3,oe.top+as/3),this.topRightBorderDoubleOuterBox=ft>0||Pt>0?nl(oe.left+Fr,oe.top+as/3,sn-ga/3,Vn-as/3,Js.TOP_RIGHT):new rs(oe.left+oe.width-ga/3,oe.top+as/3),this.bottomRightBorderDoubleOuterBox=li>0||Ni>0?nl(oe.left+vo,oe.top+Ua,li-ga/3,Ni-aa/3,Js.BOTTOM_RIGHT):new rs(oe.left+oe.width-ga/3,oe.top+oe.height-aa/3),this.bottomLeftBorderDoubleOuterBox=Pr>0||Cr>0?nl(oe.left+Ks/3,oe.top+Mo,Pr-Ks/3,Cr-aa/3,Js.BOTTOM_LEFT):new rs(oe.left+Ks/3,oe.top+oe.height-aa/3),this.topLeftBorderDoubleInnerBox=ft>0||Pt>0?nl(oe.left+2*Ks/3,oe.top+2*as/3,ft-2*Ks/3,Pt-2*as/3,Js.TOP_LEFT):new rs(oe.left+2*Ks/3,oe.top+2*as/3),this.topRightBorderDoubleInnerBox=ft>0||Pt>0?nl(oe.left+Fr,oe.top+2*as/3,sn-2*ga/3,Vn-2*as/3,Js.TOP_RIGHT):new rs(oe.left+oe.width-2*ga/3,oe.top+2*as/3),this.bottomRightBorderDoubleInnerBox=li>0||Ni>0?nl(oe.left+vo,oe.top+Ua,li-2*ga/3,Ni-2*aa/3,Js.BOTTOM_RIGHT):new rs(oe.left+oe.width-2*ga/3,oe.top+oe.height-2*aa/3),this.bottomLeftBorderDoubleInnerBox=Pr>0||Cr>0?nl(oe.left+2*Ks/3,oe.top+Mo,Pr-2*Ks/3,Cr-2*aa/3,Js.BOTTOM_LEFT):new rs(oe.left+2*Ks/3,oe.top+oe.height-2*aa/3),this.topLeftBorderStroke=ft>0||Pt>0?nl(oe.left+Ks/2,oe.top+as/2,ft-Ks/2,Pt-as/2,Js.TOP_LEFT):new rs(oe.left+Ks/2,oe.top+as/2),this.topRightBorderStroke=ft>0||Pt>0?nl(oe.left+Fr,oe.top+as/2,sn-ga/2,Vn-as/2,Js.TOP_RIGHT):new rs(oe.left+oe.width-ga/2,oe.top+as/2),this.bottomRightBorderStroke=li>0||Ni>0?nl(oe.left+vo,oe.top+Ua,li-ga/2,Ni-aa/2,Js.BOTTOM_RIGHT):new rs(oe.left+oe.width-ga/2,oe.top+oe.height-aa/2),this.bottomLeftBorderStroke=Pr>0||Cr>0?nl(oe.left+Ks/2,oe.top+Mo,Pr-Ks/2,Cr-aa/2,Js.BOTTOM_LEFT):new rs(oe.left+Ks/2,oe.top+oe.height-aa/2),this.topLeftBorderBox=ft>0||Pt>0?nl(oe.left,oe.top,ft,Pt,Js.TOP_LEFT):new rs(oe.left,oe.top),this.topRightBorderBox=sn>0||Vn>0?nl(oe.left+Fr,oe.top,sn,Vn,Js.TOP_RIGHT):new rs(oe.left+oe.width,oe.top),this.bottomRightBorderBox=li>0||Ni>0?nl(oe.left+vo,oe.top+Ua,li,Ni,Js.BOTTOM_RIGHT):new rs(oe.left+oe.width,oe.top+oe.height),this.bottomLeftBorderBox=Pr>0||Cr>0?nl(oe.left,oe.top+Mo,Pr,Cr,Js.BOTTOM_LEFT):new rs(oe.left,oe.top+oe.height),this.topLeftPaddingBox=ft>0||Pt>0?nl(oe.left+Ks,oe.top+as,Math.max(0,ft-Ks),Math.max(0,Pt-as),Js.TOP_LEFT):new rs(oe.left+Ks,oe.top+as),this.topRightPaddingBox=sn>0||Vn>0?nl(oe.left+Math.min(Fr,oe.width-ga),oe.top+as,Fr>oe.width+ga?0:Math.max(0,sn-ga),Math.max(0,Vn-as),Js.TOP_RIGHT):new rs(oe.left+oe.width-ga,oe.top+as),this.bottomRightPaddingBox=li>0||Ni>0?nl(oe.left+Math.min(vo,oe.width-Ks),oe.top+Math.min(Ua,oe.height-aa),Math.max(0,li-ga),Math.max(0,Ni-aa),Js.BOTTOM_RIGHT):new rs(oe.left+oe.width-ga,oe.top+oe.height-aa),this.bottomLeftPaddingBox=Pr>0||Cr>0?nl(oe.left+Ks,oe.top+Math.min(Mo,oe.height-aa),Math.max(0,Pr-Ks),Math.max(0,Cr-aa),Js.BOTTOM_LEFT):new rs(oe.left+Ks,oe.top+oe.height-aa),this.topLeftContentBox=ft>0||Pt>0?nl(oe.left+Ks+ka,oe.top+as+El,Math.max(0,ft-(Ks+ka)),Math.max(0,Pt-(as+El)),Js.TOP_LEFT):new rs(oe.left+Ks+ka,oe.top+as+El),this.topRightContentBox=sn>0||Vn>0?nl(oe.left+Math.min(Fr,oe.width+Ks+ka),oe.top+as+El,Fr>oe.width+Ks+ka?0:sn-Ks+ka,Vn-(as+El),Js.TOP_RIGHT):new rs(oe.left+oe.width-(ga+Ea),oe.top+as+El),this.bottomRightContentBox=li>0||Ni>0?nl(oe.left+Math.min(vo,oe.width-(Ks+ka)),oe.top+Math.min(Ua,oe.height+as+El),Math.max(0,li-(ga+Ea)),Ni-(aa+Ra),Js.BOTTOM_RIGHT):new rs(oe.left+oe.width-(ga+Ea),oe.top+oe.height-(aa+Ra)),this.bottomLeftContentBox=Pr>0||Cr>0?nl(oe.left+Ks+ka,oe.top+Mo,Math.max(0,Pr-(Ks+ka)),Cr-(aa+Ra),Js.BOTTOM_LEFT):new rs(oe.left+Ks+ka,oe.top+oe.height-(aa+Ra))}}(),Js=function(te){return te[te.TOP_LEFT=0]="TOP_LEFT",te[te.TOP_RIGHT=1]="TOP_RIGHT",te[te.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",te[te.BOTTOM_LEFT=3]="BOTTOM_LEFT",te}(Js||{}),nl=function(te,Z,ae,oe,qe){var ft=(Math.sqrt(2)-1)/3*4,Pt=ae*ft,on=oe*ft,sn=te+ae,Vn=Z+oe;switch(qe){case Js.TOP_LEFT:return new jy(new rs(te,Vn),new rs(te,Vn-on),new rs(sn-Pt,Z),new rs(sn,Z));case Js.TOP_RIGHT:return new jy(new rs(te,Z),new rs(te+Pt,Z),new rs(sn,Vn-on),new rs(sn,Vn));case Js.BOTTOM_RIGHT:return new jy(new rs(sn,Z),new rs(sn,Z+on),new rs(te+Pt,Vn),new rs(te,Vn));default:return new jy(new rs(sn,Vn),new rs(sn-Pt,Vn),new rs(te,Z+on),new rs(te,Z))}},YA=function(te){return[te.topLeftBorderBox,te.topRightBorderBox,te.bottomRightBorderBox,te.bottomLeftBorderBox]},Ql=function(te){return[te.topLeftPaddingBox,te.topRightPaddingBox,te.bottomRightPaddingBox,te.bottomLeftPaddingBox]},rA=function(){return function te(Z,ae,oe){this.offsetX=Z,this.offsetY=ae,this.matrix=oe,this.type=0,this.target=6}}(),sh=function(){return function te(Z,ae){this.path=Z,this.target=ae,this.type=1}}(),KA=function(){return function te(Z){this.opacity=Z,this.type=2,this.target=6}}(),g_=function(te){return 1===te.type},ZA=function(te,Z){return te.length===Z.length&&te.some(function(ae,oe){return ae===Z[oe]})},Mf=function(){return function te(Z){this.element=Z,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}}(),Br=function(){function te(Z,ae){if(this.container=Z,this.parent=ae,this.effects=[],this.curves=new im(this.container),this.container.styles.opacity<1&&this.effects.push(new KA(this.container.styles.opacity)),null!==this.container.styles.transform&&this.effects.push(new rA(this.container.bounds.left+this.container.styles.transformOrigin[0].number,this.container.bounds.top+this.container.styles.transformOrigin[1].number,this.container.styles.transform)),0!==this.container.styles.overflowX){var Pt=YA(this.curves),on=Ql(this.curves);ZA(Pt,on)?this.effects.push(new sh(Pt,6)):(this.effects.push(new sh(Pt,2)),this.effects.push(new sh(on,4)))}}return te.prototype.getEffects=function(Z){for(var ae=-1===[2,3].indexOf(this.container.styles.position),oe=this.parent,qe=this.effects.slice(0);oe;){var ft=oe.effects.filter(function(sn){return!g_(sn)});if(ae||0!==oe.container.styles.position||!oe.parent){if(qe.unshift.apply(qe,ft),ae=-1===[2,3].indexOf(oe.container.styles.position),0!==oe.container.styles.overflowX){var Pt=YA(oe.curves),on=Ql(oe.curves);ZA(Pt,on)||qe.unshift(new sh(on,6))}}else qe.unshift.apply(qe,ft);oe=oe.parent}return qe.filter(function(sn){return Al(sn.target,Z)})},te}(),zr=function(te,Z,ae,oe){te.container.elements.forEach(function(qe){var ft=Al(qe.flags,4),Pt=Al(qe.flags,2),on=new Br(qe,te);Al(qe.styles.display,2048)&&oe.push(on);var sn=Al(qe.flags,8)?[]:oe;if(ft||Pt){var Vn=ft||qe.styles.isPositioned()?ae:Z,Kn=new Mf(on);if(qe.styles.isPositioned()||qe.styles.opacity<1||qe.styles.isTransformed()){var li=qe.styles.zIndex.order;if(li<0){var Ni=0;Vn.negativeZIndex.some(function(Pr,Cr){return li>Pr.element.container.styles.zIndex.order?(Ni=Cr,!1):Ni>0}),Vn.negativeZIndex.splice(Ni,0,Kn)}else if(li>0){var us=0;Vn.positiveZIndex.some(function(Pr,Cr){return li>=Pr.element.container.styles.zIndex.order?(us=Cr+1,!1):us>0}),Vn.positiveZIndex.splice(us,0,Kn)}else Vn.zeroOrAutoZIndexOrTransformedOrOpacity.push(Kn)}else qe.styles.isFloating()?Vn.nonPositionedFloats.push(Kn):Vn.nonPositionedInlineLevel.push(Kn);zr(on,Kn,ft?Kn:ae,sn)}else qe.styles.isInlineLevel()?Z.inlineLevel.push(on):Z.nonInlineLevel.push(on),zr(on,Z,ae,sn);Al(qe.flags,8)&&Mu(qe,sn)})},Mu=function(te,Z){for(var ae=te instanceof n0?te.start:1,oe=te instanceof n0&&te.reversed,qe=0;qe<Z.length;qe++){var ft=Z[qe];ft.container instanceof Jm&&"number"==typeof ft.container.value&&0!==ft.container.value&&(ae=ft.container.value),ft.listValue=XA(ae,ft.container.styles.listStyleType,!0),ae+=oe?-1:1}},rm=function(te,Z){switch(Z){case 0:return nc(te.topLeftBorderBox,te.topLeftPaddingBox,te.topRightBorderBox,te.topRightPaddingBox);case 1:return nc(te.topRightBorderBox,te.topRightPaddingBox,te.bottomRightBorderBox,te.bottomRightPaddingBox);case 2:return nc(te.bottomRightBorderBox,te.bottomRightPaddingBox,te.bottomLeftBorderBox,te.bottomLeftPaddingBox);default:return nc(te.bottomLeftBorderBox,te.bottomLeftPaddingBox,te.topLeftBorderBox,te.topLeftPaddingBox)}},Ef=function(te,Z){var ae=[];return tc(te)?ae.push(te.subdivide(.5,!1)):ae.push(te),tc(Z)?ae.push(Z.subdivide(.5,!0)):ae.push(Z),ae},nc=function(te,Z,ae,oe){var qe=[];return tc(te)?qe.push(te.subdivide(.5,!1)):qe.push(te),tc(ae)?qe.push(ae.subdivide(.5,!0)):qe.push(ae),tc(oe)?qe.push(oe.subdivide(.5,!0).reverse()):qe.push(oe),tc(Z)?qe.push(Z.subdivide(.5,!1).reverse()):qe.push(Z),qe},y_=function(te){var ae=te.styles;return te.bounds.add(ae.borderLeftWidth,ae.borderTopWidth,-(ae.borderRightWidth+ae.borderLeftWidth),-(ae.borderTopWidth+ae.borderBottomWidth))},Sf=function(te){var Z=te.styles,ae=te.bounds,oe=rl(Z.paddingLeft,ae.width),qe=rl(Z.paddingRight,ae.width),ft=rl(Z.paddingTop,ae.width),Pt=rl(Z.paddingBottom,ae.width);return ae.add(oe+Z.borderLeftWidth,ft+Z.borderTopWidth,-(Z.borderRightWidth+Z.borderLeftWidth+oe+qe),-(Z.borderTopWidth+Z.borderBottomWidth+ft+Pt))},Hd=function(te,Z,ae){var oe=function(te,Z){return 0===te?Z.bounds:2===te?Sf(Z):y_(Z)}(fi(te.styles.backgroundOrigin,Z),te),qe=function(te,Z){return 0===te?Z.bounds:2===te?Sf(Z):y_(Z)}(fi(te.styles.backgroundClip,Z),te),ft=pi(fi(te.styles.backgroundSize,Z),ae,oe),Pt=ft[0],on=ft[1],sn=RA(fi(te.styles.backgroundPosition,Z),oe.width-Pt,oe.height-on);return[qa(fi(te.styles.backgroundRepeat,Z),sn,ft,oe,qe),Math.round(oe.left+sn[0]),Math.round(oe.top+sn[1]),Pt,on]},gi=function(te){return Ca(te)&&te.value===Pc.AUTO},fo=function(te){return"number"==typeof te},pi=function(te,Z,ae){var oe=Z[0],qe=Z[1],ft=Z[2],Pt=te[0],on=te[1];if(!Pt)return[0,0];if(xc(Pt)&&on&&xc(on))return[rl(Pt,ae.width),rl(on,ae.height)];var sn=fo(ft);if(Ca(Pt)&&(Pt.value===Pc.CONTAIN||Pt.value===Pc.COVER))return fo(ft)?ae.width/ae.height<ft!=(Pt.value===Pc.COVER)?[ae.width,ae.width/ft]:[ae.height*ft,ae.height]:[ae.width,ae.height];var Kn=fo(oe),li=fo(qe),Ni=Kn||li;if(gi(Pt)&&(!on||gi(on)))return Kn&&li?[oe,qe]:sn||Ni?Ni&&sn?[Kn?oe:qe*ft,li?qe:oe/ft]:[Kn?oe:ae.width,li?qe:ae.height]:[ae.width,ae.height];if(sn){var kr=0,Fr=0;return xc(Pt)?kr=rl(Pt,ae.width):xc(on)&&(Fr=rl(on,ae.height)),gi(Pt)?kr=Fr*ft:(!on||gi(on))&&(Fr=kr/ft),[kr,Fr]}var Ua=null,vo=null;if(xc(Pt)?Ua=rl(Pt,ae.width):on&&xc(on)&&(vo=rl(on,ae.height)),null!==Ua&&(!on||gi(on))&&(vo=Kn&&li?Ua/oe*qe:ae.height),null!==vo&&gi(Pt)&&(Ua=Kn&&li?vo/qe*oe:ae.width),null!==Ua&&null!==vo)return[Ua,vo];throw new Error("Unable to calculate background-size for element")},fi=function(te,Z){var ae=te[Z];return typeof ae>"u"?te[0]:ae},qa=function(te,Z,ae,oe,qe){var ft=Z[0],Pt=Z[1],on=ae[0],sn=ae[1];switch(te){case 2:return[new rs(Math.round(oe.left),Math.round(oe.top+Pt)),new rs(Math.round(oe.left+oe.width),Math.round(oe.top+Pt)),new rs(Math.round(oe.left+oe.width),Math.round(sn+oe.top+Pt)),new rs(Math.round(oe.left),Math.round(sn+oe.top+Pt))];case 3:return[new rs(Math.round(oe.left+ft),Math.round(oe.top)),new rs(Math.round(oe.left+ft+on),Math.round(oe.top)),new rs(Math.round(oe.left+ft+on),Math.round(oe.height+oe.top)),new rs(Math.round(oe.left+ft),Math.round(oe.height+oe.top))];case 1:return[new rs(Math.round(oe.left+ft),Math.round(oe.top+Pt)),new rs(Math.round(oe.left+ft+on),Math.round(oe.top+Pt)),new rs(Math.round(oe.left+ft+on),Math.round(oe.top+Pt+sn)),new rs(Math.round(oe.left+ft),Math.round(oe.top+Pt+sn))];default:return[new rs(Math.round(qe.left),Math.round(qe.top)),new rs(Math.round(qe.left+qe.width),Math.round(qe.top)),new rs(Math.round(qe.left+qe.width),Math.round(qe.height+qe.top)),new rs(Math.round(qe.left),Math.round(qe.height+qe.top))]}},sm="Hidden Text",Zh=function(){function te(Z){this._data={},this._document=Z}return te.prototype.parseMetrics=function(Z,ae){var oe=this._document.createElement("div"),qe=this._document.createElement("img"),ft=this._document.createElement("span"),Pt=this._document.body;oe.style.visibility="hidden",oe.style.fontFamily=Z,oe.style.fontSize=ae,oe.style.margin="0",oe.style.padding="0",oe.style.whiteSpace="nowrap",Pt.appendChild(oe),qe.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",qe.width=1,qe.height=1,qe.style.margin="0",qe.style.padding="0",qe.style.verticalAlign="baseline",ft.style.fontFamily=Z,ft.style.fontSize=ae,ft.style.margin="0",ft.style.padding="0",ft.appendChild(this._document.createTextNode(sm)),oe.appendChild(ft),oe.appendChild(qe);var on=qe.offsetTop-ft.offsetTop+2;oe.removeChild(ft),oe.appendChild(this._document.createTextNode(sm)),oe.style.lineHeight="normal",qe.style.verticalAlign="super";var sn=qe.offsetTop-oe.offsetTop+2;return Pt.removeChild(oe),{baseline:on,middle:sn}},te.prototype.getMetrics=function(Z,ae){var oe=Z+" "+ae;return typeof this._data[oe]>"u"&&(this._data[oe]=this.parseMetrics(Z,ae)),this._data[oe]},te}(),Vd=function(){return function te(Z,ae){this.context=Z,this.options=ae}}(),pp=function(te){function Z(ae,oe){var qe=te.call(this,ae,oe)||this;return qe._activeEffects=[],qe.canvas=oe.canvas?oe.canvas:document.createElement("canvas"),qe.ctx=qe.canvas.getContext("2d"),oe.canvas||(qe.canvas.width=Math.floor(oe.width*oe.scale),qe.canvas.height=Math.floor(oe.height*oe.scale),qe.canvas.style.width=oe.width+"px",qe.canvas.style.height=oe.height+"px"),qe.fontMetrics=new Zh(document),qe.ctx.scale(qe.options.scale,qe.options.scale),qe.ctx.translate(-oe.x,-oe.y),qe.ctx.textBaseline="bottom",qe._activeEffects=[],qe.context.logger.debug("Canvas renderer initialized ("+oe.width+"x"+oe.height+") with scale "+oe.scale),qe}return Te(Z,te),Z.prototype.applyEffects=function(ae){for(var oe=this;this._activeEffects.length;)this.popEffect();ae.forEach(function(qe){return oe.applyEffect(qe)})},Z.prototype.applyEffect=function(ae){this.ctx.save(),function(te){return 2===te.type}(ae)&&(this.ctx.globalAlpha=ae.opacity),function(te){return 0===te.type}(ae)&&(this.ctx.translate(ae.offsetX,ae.offsetY),this.ctx.transform(ae.matrix[0],ae.matrix[1],ae.matrix[2],ae.matrix[3],ae.matrix[4],ae.matrix[5]),this.ctx.translate(-ae.offsetX,-ae.offsetY)),g_(ae)&&(this.path(ae.path),this.ctx.clip()),this._activeEffects.push(ae)},Z.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},Z.prototype.renderStack=function(ae){return v(this,void 0,void 0,function(){return V(this,function(qe){switch(qe.label){case 0:return ae.element.container.styles.isVisible()?[4,this.renderStackContent(ae)]:[3,2];case 1:qe.sent(),qe.label=2;case 2:return[2]}})})},Z.prototype.renderNode=function(ae){return v(this,void 0,void 0,function(){return V(this,function(oe){switch(oe.label){case 0:return Al(ae.container.flags,16),ae.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(ae)]:[3,3];case 1:return oe.sent(),[4,this.renderNodeContent(ae)];case 2:oe.sent(),oe.label=3;case 3:return[2]}})})},Z.prototype.renderTextWithLetterSpacing=function(ae,oe,qe){var ft=this;0===oe?this.ctx.fillText(ae.text,ae.bounds.left,ae.bounds.top+qe):t0(ae.text).reduce(function(on,sn){return ft.ctx.fillText(sn,on,ae.bounds.top+qe),on+ft.ctx.measureText(sn).width},ae.bounds.left)},Z.prototype.createFontStyle=function(ae){var oe=ae.fontVariant.filter(function(Pt){return"normal"===Pt||"small-caps"===Pt}).join(""),qe=ng(ae.fontFamily).join(", "),ft=Qu(ae.fontSize)?""+ae.fontSize.number+ae.fontSize.unit:ae.fontSize.number+"px";return[[ae.fontStyle,oe,ae.fontWeight,ft,qe].join(" "),qe,ft]},Z.prototype.renderTextNode=function(ae,oe){return v(this,void 0,void 0,function(){var qe,Pt,on,sn,Vn,Kn,li,Ni=this;return V(this,function(us){return qe=this.createFontStyle(oe),Pt=qe[1],on=qe[2],this.ctx.font=qe[0],this.ctx.direction=1===oe.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",sn=this.fontMetrics.getMetrics(Pt,on),Vn=sn.baseline,Kn=sn.middle,li=oe.paintOrder,ae.textBounds.forEach(function(Pr){li.forEach(function(Cr){switch(Cr){case 0:Ni.ctx.fillStyle=Jo(oe.color),Ni.renderTextWithLetterSpacing(Pr,oe.letterSpacing,Vn);var Co=oe.textShadow;Co.length&&Pr.text.trim().length&&(Co.slice(0).reverse().forEach(function(kr){Ni.ctx.shadowColor=Jo(kr.color),Ni.ctx.shadowOffsetX=kr.offsetX.number*Ni.options.scale,Ni.ctx.shadowOffsetY=kr.offsetY.number*Ni.options.scale,Ni.ctx.shadowBlur=kr.blur.number,Ni.renderTextWithLetterSpacing(Pr,oe.letterSpacing,Vn)}),Ni.ctx.shadowColor="",Ni.ctx.shadowOffsetX=0,Ni.ctx.shadowOffsetY=0,Ni.ctx.shadowBlur=0),oe.textDecorationLine.length&&(Ni.ctx.fillStyle=Jo(oe.textDecorationColor||oe.color),oe.textDecorationLine.forEach(function(kr){switch(kr){case 1:Ni.ctx.fillRect(Pr.bounds.left,Math.round(Pr.bounds.top+Vn),Pr.bounds.width,1);break;case 2:Ni.ctx.fillRect(Pr.bounds.left,Math.round(Pr.bounds.top),Pr.bounds.width,1);break;case 3:Ni.ctx.fillRect(Pr.bounds.left,Math.ceil(Pr.bounds.top+Kn),Pr.bounds.width,1)}}));break;case 1:oe.webkitTextStrokeWidth&&Pr.text.trim().length&&(Ni.ctx.strokeStyle=Jo(oe.webkitTextStrokeColor),Ni.ctx.lineWidth=oe.webkitTextStrokeWidth,Ni.ctx.lineJoin=window.chrome?"miter":"round",Ni.ctx.strokeText(Pr.text,Pr.bounds.left,Pr.bounds.top+Vn)),Ni.ctx.strokeStyle="",Ni.ctx.lineWidth=0,Ni.ctx.lineJoin="miter"}})}),[2]})})},Z.prototype.renderReplacedElement=function(ae,oe,qe){if(qe&&ae.intrinsicWidth>0&&ae.intrinsicHeight>0){var ft=Sf(ae),Pt=Ql(oe);this.path(Pt),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(qe,0,0,ae.intrinsicWidth,ae.intrinsicHeight,ft.left,ft.top,ft.width,ft.height),this.ctx.restore()}},Z.prototype.renderNodeContent=function(ae){return v(this,void 0,void 0,function(){var oe,qe,ft,Pt,on,Kn,li,Ni,Pr,Cr,Co,kr,Fr,Ua,vo,Mo;return V(this,function(as){switch(as.label){case 0:this.applyEffects(ae.getEffects(4)),qe=ae.curves,ft=(oe=ae.container).styles,Pt=0,on=oe.textNodes,as.label=1;case 1:return Pt<on.length?[4,this.renderTextNode(on[Pt],ft)]:[3,4];case 2:as.sent(),as.label=3;case 3:return Pt++,[3,1];case 4:if(!(oe instanceof Mc))return[3,8];as.label=5;case 5:return as.trys.push([5,7,,8]),[4,this.context.cache.match(oe.src)];case 6:return Fr=as.sent(),this.renderReplacedElement(oe,qe,Fr),[3,8];case 7:return as.sent(),this.context.logger.error("Error loading image "+oe.src),[3,8];case 8:if(oe instanceof a_&&this.renderReplacedElement(oe,qe,oe.canvas),!(oe instanceof Uy))return[3,12];as.label=9;case 9:return as.trys.push([9,11,,12]),[4,this.context.cache.match(oe.svg)];case 10:return Fr=as.sent(),this.renderReplacedElement(oe,qe,Fr),[3,12];case 11:return as.sent(),this.context.logger.error("Error loading svg "+oe.svg.substring(0,255)),[3,12];case 12:return oe instanceof Xu&&oe.tree?[4,new Z(this.context,{scale:this.options.scale,backgroundColor:oe.backgroundColor,x:0,y:0,width:oe.width,height:oe.height}).render(oe.tree)]:[3,14];case 13:Kn=as.sent(),oe.width&&oe.height&&this.ctx.drawImage(Kn,0,0,oe.width,oe.height,oe.bounds.left,oe.bounds.top,oe.bounds.width,oe.bounds.height),as.label=14;case 14:if(oe instanceof vr&&(li=Math.min(oe.bounds.width,oe.bounds.height),oe.type===GA?oe.checked&&(this.ctx.save(),this.path([new rs(oe.bounds.left+.39363*li,oe.bounds.top+.79*li),new rs(oe.bounds.left+.16*li,oe.bounds.top+.5549*li),new rs(oe.bounds.left+.27347*li,oe.bounds.top+.44071*li),new rs(oe.bounds.left+.39694*li,oe.bounds.top+.5649*li),new rs(oe.bounds.left+.72983*li,oe.bounds.top+.23*li),new rs(oe.bounds.left+.84*li,oe.bounds.top+.34085*li),new rs(oe.bounds.left+.39363*li,oe.bounds.top+.79*li)]),this.ctx.fillStyle=Jo(Ml),this.ctx.fill(),this.ctx.restore()):oe.type===eA&&oe.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(oe.bounds.left+li/2,oe.bounds.top+li/2,li/4,0,2*Math.PI,!0),this.ctx.fillStyle=Jo(Ml),this.ctx.fill(),this.ctx.restore())),h0(oe)&&oe.value.length){switch(Ni=this.createFontStyle(ft),Pr=this.fontMetrics.getMetrics(vo=Ni[0],Ni[1]).baseline,this.ctx.font=vo,this.ctx.fillStyle=Jo(ft.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=u0(oe.styles.textAlign),Mo=Sf(oe),Cr=0,oe.styles.textAlign){case 1:Cr+=Mo.width/2;break;case 2:Cr+=Mo.width}Co=Mo.add(Cr,0,0,-Mo.height/2+1),this.ctx.save(),this.path([new rs(Mo.left,Mo.top),new rs(Mo.left+Mo.width,Mo.top),new rs(Mo.left+Mo.width,Mo.top+Mo.height),new rs(Mo.left,Mo.top+Mo.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Kp(oe.value,Co),ft.letterSpacing,Pr),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Al(oe.styles.display,2048))return[3,20];if(null===oe.styles.listStyleImage)return[3,19];if(0!==(kr=oe.styles.listStyleImage).type)return[3,18];Fr=void 0,Ua=kr.url,as.label=15;case 15:return as.trys.push([15,17,,18]),[4,this.context.cache.match(Ua)];case 16:return Fr=as.sent(),this.ctx.drawImage(Fr,oe.bounds.left-(Fr.width+10),oe.bounds.top),[3,18];case 17:return as.sent(),this.context.logger.error("Error loading list-style-image "+Ua),[3,18];case 18:return[3,20];case 19:ae.listValue&&-1!==oe.styles.listStyleType&&(vo=this.createFontStyle(ft)[0],this.ctx.font=vo,this.ctx.fillStyle=Jo(ft.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",Mo=new xe(oe.bounds.left,oe.bounds.top+rl(oe.styles.paddingTop,oe.bounds.width),oe.bounds.width,Um(ft.lineHeight,ft.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Kp(ae.listValue,Mo),ft.letterSpacing,Um(ft.lineHeight,ft.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),as.label=20;case 20:return[2]}})})},Z.prototype.renderStackContent=function(ae){return v(this,void 0,void 0,function(){var oe,qe,ft,Pt,on,sn,Vn,Kn,li,Ni,us,Pr,Cr,Co;return V(this,function(Fr){switch(Fr.label){case 0:return Al(ae.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(ae.element)];case 1:Fr.sent(),oe=0,qe=ae.negativeZIndex,Fr.label=2;case 2:return oe<qe.length?[4,this.renderStack(qe[oe])]:[3,5];case 3:Fr.sent(),Fr.label=4;case 4:return oe++,[3,2];case 5:return[4,this.renderNodeContent(ae.element)];case 6:Fr.sent(),ft=0,Pt=ae.nonInlineLevel,Fr.label=7;case 7:return ft<Pt.length?[4,this.renderNode(Pt[ft])]:[3,10];case 8:Fr.sent(),Fr.label=9;case 9:return ft++,[3,7];case 10:on=0,sn=ae.nonPositionedFloats,Fr.label=11;case 11:return on<sn.length?[4,this.renderStack(sn[on])]:[3,14];case 12:Fr.sent(),Fr.label=13;case 13:return on++,[3,11];case 14:Vn=0,Kn=ae.nonPositionedInlineLevel,Fr.label=15;case 15:return Vn<Kn.length?[4,this.renderStack(Kn[Vn])]:[3,18];case 16:Fr.sent(),Fr.label=17;case 17:return Vn++,[3,15];case 18:li=0,Ni=ae.inlineLevel,Fr.label=19;case 19:return li<Ni.length?[4,this.renderNode(Ni[li])]:[3,22];case 20:Fr.sent(),Fr.label=21;case 21:return li++,[3,19];case 22:us=0,Pr=ae.zeroOrAutoZIndexOrTransformedOrOpacity,Fr.label=23;case 23:return us<Pr.length?[4,this.renderStack(Pr[us])]:[3,26];case 24:Fr.sent(),Fr.label=25;case 25:return us++,[3,23];case 26:Cr=0,Co=ae.positiveZIndex,Fr.label=27;case 27:return Cr<Co.length?[4,this.renderStack(Co[Cr])]:[3,30];case 28:Fr.sent(),Fr.label=29;case 29:return Cr++,[3,27];case 30:return[2]}})})},Z.prototype.mask=function(ae){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(ae.slice(0).reverse()),this.ctx.closePath()},Z.prototype.path=function(ae){this.ctx.beginPath(),this.formatPath(ae),this.ctx.closePath()},Z.prototype.formatPath=function(ae){var oe=this;ae.forEach(function(qe,ft){var Pt=tc(qe)?qe.start:qe;0===ft?oe.ctx.moveTo(Pt.x,Pt.y):oe.ctx.lineTo(Pt.x,Pt.y),tc(qe)&&oe.ctx.bezierCurveTo(qe.startControl.x,qe.startControl.y,qe.endControl.x,qe.endControl.y,qe.end.x,qe.end.y)})},Z.prototype.renderRepeat=function(ae,oe,qe,ft){this.path(ae),this.ctx.fillStyle=oe,this.ctx.translate(qe,ft),this.ctx.fill(),this.ctx.translate(-qe,-ft)},Z.prototype.resizeImage=function(ae,oe,qe){var ft;if(ae.width===oe&&ae.height===qe)return ae;var on=(null!==(ft=this.canvas.ownerDocument)&&void 0!==ft?ft:document).createElement("canvas");return on.width=Math.max(1,oe),on.height=Math.max(1,qe),on.getContext("2d").drawImage(ae,0,0,ae.width,ae.height,0,0,oe,qe),on},Z.prototype.renderBackgroundImage=function(ae){return v(this,void 0,void 0,function(){var oe,qe,ft,Pt,on;return V(this,function(Vn){switch(Vn.label){case 0:oe=ae.styles.backgroundImage.length-1,qe=function(Kn){var li,Ni,us,Pr,Cr,Co,kr,Fr,Ua,vo,Mo,as,ga,aa,Ks,El,Ea,Ra,ka,Fc,Tf,kh,Jh,Zu,eu,Ap,Df,gp,If,om,_p;return V(this,function(rg){switch(rg.label){case 0:if(0!==Kn.type)return[3,5];li=void 0,Ni=Kn.url,rg.label=1;case 1:return rg.trys.push([1,3,,4]),[4,ft.context.cache.match(Ni)];case 2:return li=rg.sent(),[3,4];case 3:return rg.sent(),ft.context.logger.error("Error loading background-image "+Ni),[3,4];case 4:return li&&(us=Hd(ae,oe,[li.width,li.height,li.width/li.height]),El=us[0],kh=us[1],Jh=us[2],aa=ft.ctx.createPattern(ft.resizeImage(li,ka=us[3],Fc=us[4]),"repeat"),ft.renderRepeat(El,aa,kh,Jh)),[3,6];case 5:!function(te){return 1===te.type}(Kn)?function(te){return 2===te.type}(Kn)&&(Ks=Hd(ae,oe,[null,null,null]),El=Ks[0],Ea=Ks[1],Ra=Ks[2],Fc=Ks[4],kh=rl((Tf=0===Kn.position.length?[$0]:Kn.position)[0],ka=Ks[3]),Jh=rl(Tf[Tf.length-1],Fc),Zu=function(te,Z,ae,oe,qe){var ft=0,Pt=0;switch(te.size){case 0:0===te.shape?ft=Pt=Math.min(Math.abs(Z),Math.abs(Z-oe),Math.abs(ae),Math.abs(ae-qe)):1===te.shape&&(ft=Math.min(Math.abs(Z),Math.abs(Z-oe)),Pt=Math.min(Math.abs(ae),Math.abs(ae-qe)));break;case 2:if(0===te.shape)ft=Pt=Math.min(Us(Z,ae),Us(Z,ae-qe),Us(Z-oe,ae),Us(Z-oe,ae-qe));else if(1===te.shape){var on=Math.min(Math.abs(ae),Math.abs(ae-qe))/Math.min(Math.abs(Z),Math.abs(Z-oe)),sn=tp(oe,qe,Z,ae,!0);Pt=on*(ft=Us(sn[0]-Z,(sn[1]-ae)/on))}break;case 1:0===te.shape?ft=Pt=Math.max(Math.abs(Z),Math.abs(Z-oe),Math.abs(ae),Math.abs(ae-qe)):1===te.shape&&(ft=Math.max(Math.abs(Z),Math.abs(Z-oe)),Pt=Math.max(Math.abs(ae),Math.abs(ae-qe)));break;case 3:if(0===te.shape)ft=Pt=Math.max(Us(Z,ae),Us(Z,ae-qe),Us(Z-oe,ae),Us(Z-oe,ae-qe));else if(1===te.shape){on=Math.max(Math.abs(ae),Math.abs(ae-qe))/Math.max(Math.abs(Z),Math.abs(Z-oe));var li=tp(oe,qe,Z,ae,!1);Pt=on*(ft=Us(li[0]-Z,(li[1]-ae)/on))}}return Array.isArray(te.size)&&(ft=rl(te.size[0],oe),Pt=2===te.size.length?rl(te.size[1],qe):ft),[ft,Pt]}(Kn,kh,Jh,ka,Fc),Ap=Zu[1],(eu=Zu[0])>0&&Ap>0&&(Df=ft.ctx.createRadialGradient(Ea+kh,Ra+Jh,0,Ea+kh,Ra+Jh,eu),jg(Kn.stops,2*eu).forEach(function(am){return Df.addColorStop(am.stop,Jo(am.color))}),ft.path(El),ft.ctx.fillStyle=Df,eu!==Ap?(gp=ae.bounds.left+.5*ae.bounds.width,If=ae.bounds.top+.5*ae.bounds.height,_p=1/(om=Ap/eu),ft.ctx.save(),ft.ctx.translate(gp,If),ft.ctx.transform(1,0,0,om,0,0),ft.ctx.translate(-gp,-If),ft.ctx.fillRect(Ea,_p*(Ra-If)+If,ka,Fc*_p),ft.ctx.restore()):ft.ctx.fill())):(Pr=Hd(ae,oe,[null,null,null]),El=Pr[0],kh=Pr[1],Jh=Pr[2],Cr=Ma(Kn.angle,ka=Pr[3],Fc=Pr[4]),Co=Cr[0],kr=Cr[1],Fr=Cr[2],Ua=Cr[3],vo=Cr[4],(Mo=document.createElement("canvas")).width=ka,Mo.height=Fc,as=Mo.getContext("2d"),ga=as.createLinearGradient(kr,Ua,Fr,vo),jg(Kn.stops,Co).forEach(function(am){return ga.addColorStop(am.stop,Jo(am.color))}),as.fillStyle=ga,as.fillRect(0,0,ka,Fc),ka>0&&Fc>0&&(aa=ft.ctx.createPattern(Mo,"repeat"),ft.renderRepeat(El,aa,kh,Jh))),rg.label=6;case 6:return oe--,[2]}})},ft=this,Pt=0,on=ae.styles.backgroundImage.slice(0).reverse(),Vn.label=1;case 1:return Pt<on.length?[5,qe(on[Pt])]:[3,4];case 2:Vn.sent(),Vn.label=3;case 3:return Pt++,[3,1];case 4:return[2]}})})},Z.prototype.renderSolidBorder=function(ae,oe,qe){return v(this,void 0,void 0,function(){return V(this,function(ft){return this.path(rm(qe,oe)),this.ctx.fillStyle=Jo(ae),this.ctx.fill(),[2]})})},Z.prototype.renderDoubleBorder=function(ae,oe,qe,ft){return v(this,void 0,void 0,function(){var Pt,on;return V(this,function(sn){switch(sn.label){case 0:return oe<3?[4,this.renderSolidBorder(ae,qe,ft)]:[3,2];case 1:return sn.sent(),[2];case 2:return Pt=function(te,Z){switch(Z){case 0:return nc(te.topLeftBorderBox,te.topLeftBorderDoubleOuterBox,te.topRightBorderBox,te.topRightBorderDoubleOuterBox);case 1:return nc(te.topRightBorderBox,te.topRightBorderDoubleOuterBox,te.bottomRightBorderBox,te.bottomRightBorderDoubleOuterBox);case 2:return nc(te.bottomRightBorderBox,te.bottomRightBorderDoubleOuterBox,te.bottomLeftBorderBox,te.bottomLeftBorderDoubleOuterBox);default:return nc(te.bottomLeftBorderBox,te.bottomLeftBorderDoubleOuterBox,te.topLeftBorderBox,te.topLeftBorderDoubleOuterBox)}}(ft,qe),this.path(Pt),this.ctx.fillStyle=Jo(ae),this.ctx.fill(),on=function(te,Z){switch(Z){case 0:return nc(te.topLeftBorderDoubleInnerBox,te.topLeftPaddingBox,te.topRightBorderDoubleInnerBox,te.topRightPaddingBox);case 1:return nc(te.topRightBorderDoubleInnerBox,te.topRightPaddingBox,te.bottomRightBorderDoubleInnerBox,te.bottomRightPaddingBox);case 2:return nc(te.bottomRightBorderDoubleInnerBox,te.bottomRightPaddingBox,te.bottomLeftBorderDoubleInnerBox,te.bottomLeftPaddingBox);default:return nc(te.bottomLeftBorderDoubleInnerBox,te.bottomLeftPaddingBox,te.topLeftBorderDoubleInnerBox,te.topLeftPaddingBox)}}(ft,qe),this.path(on),this.ctx.fill(),[2]}})})},Z.prototype.renderNodeBackgroundAndBorders=function(ae){return v(this,void 0,void 0,function(){var oe,qe,ft,Pt,on,sn,Vn,Kn,li=this;return V(this,function(Ni){switch(Ni.label){case 0:return this.applyEffects(ae.getEffects(2)),qe=!Hh((oe=ae.container.styles).backgroundColor)||oe.backgroundImage.length,ft=[{style:oe.borderTopStyle,color:oe.borderTopColor,width:oe.borderTopWidth},{style:oe.borderRightStyle,color:oe.borderRightColor,width:oe.borderRightWidth},{style:oe.borderBottomStyle,color:oe.borderBottomColor,width:oe.borderBottomWidth},{style:oe.borderLeftStyle,color:oe.borderLeftColor,width:oe.borderLeftWidth}],Pt=Xy(fi(oe.backgroundClip,0),ae.curves),qe||oe.boxShadow.length?(this.ctx.save(),this.path(Pt),this.ctx.clip(),Hh(oe.backgroundColor)||(this.ctx.fillStyle=Jo(oe.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(ae.container)]):[3,2];case 1:Ni.sent(),this.ctx.restore(),oe.boxShadow.slice(0).reverse().forEach(function(us){li.ctx.save();var Pr=YA(ae.curves),Cr=us.inset?0:1e4,Co=function(te,Z,ae,oe,qe){return te.map(function(ft,Pt){switch(Pt){case 0:return ft.add(Z,ae);case 1:return ft.add(Z+oe,ae);case 2:return ft.add(Z+oe,ae+qe);case 3:return ft.add(Z,ae+qe)}return ft})}(Pr,(us.inset?1:-1)*us.spread.number-Cr,(us.inset?1:-1)*us.spread.number,us.spread.number*(us.inset?-2:2),us.spread.number*(us.inset?-2:2));us.inset?(li.path(Pr),li.ctx.clip(),li.mask(Co)):(li.mask(Pr),li.ctx.clip(),li.path(Co)),li.ctx.shadowOffsetX=us.offsetX.number+Cr,li.ctx.shadowOffsetY=us.offsetY.number,li.ctx.shadowColor=Jo(us.color),li.ctx.shadowBlur=us.blur.number,li.ctx.fillStyle=us.inset?Jo(us.color):"rgba(0,0,0,1)",li.ctx.fill(),li.ctx.restore()}),Ni.label=2;case 2:on=0,sn=0,Vn=ft,Ni.label=3;case 3:return sn<Vn.length?0!==(Kn=Vn[sn]).style&&!Hh(Kn.color)&&Kn.width>0?2!==Kn.style?[3,5]:[4,this.renderDashedDottedBorder(Kn.color,Kn.width,on,ae.curves,2)]:[3,11]:[3,13];case 4:return Ni.sent(),[3,11];case 5:return 3!==Kn.style?[3,7]:[4,this.renderDashedDottedBorder(Kn.color,Kn.width,on,ae.curves,3)];case 6:return Ni.sent(),[3,11];case 7:return 4!==Kn.style?[3,9]:[4,this.renderDoubleBorder(Kn.color,Kn.width,on,ae.curves)];case 8:return Ni.sent(),[3,11];case 9:return[4,this.renderSolidBorder(Kn.color,on,ae.curves)];case 10:Ni.sent(),Ni.label=11;case 11:on++,Ni.label=12;case 12:return sn++,[3,3];case 13:return[2]}})})},Z.prototype.renderDashedDottedBorder=function(ae,oe,qe,ft,Pt){return v(this,void 0,void 0,function(){var on,sn,Vn,Kn,li,Ni,us,Pr,Cr,Co,kr,Fr,Ua,vo,Mo,as;return V(this,function(ga){return this.ctx.save(),on=function(te,Z){switch(Z){case 0:return Ef(te.topLeftBorderStroke,te.topRightBorderStroke);case 1:return Ef(te.topRightBorderStroke,te.bottomRightBorderStroke);case 2:return Ef(te.bottomRightBorderStroke,te.bottomLeftBorderStroke);default:return Ef(te.bottomLeftBorderStroke,te.topLeftBorderStroke)}}(ft,qe),sn=rm(ft,qe),2===Pt&&(this.path(sn),this.ctx.clip()),tc(sn[0])?(Vn=sn[0].start.x,Kn=sn[0].start.y):(Vn=sn[0].x,Kn=sn[0].y),tc(sn[1])?(li=sn[1].end.x,Ni=sn[1].end.y):(li=sn[1].x,Ni=sn[1].y),us=0===qe||2===qe?Math.abs(Vn-li):Math.abs(Kn-Ni),this.ctx.beginPath(),this.formatPath(3===Pt?on:sn.slice(0,2)),Pr=oe<3?3*oe:2*oe,Cr=oe<3?2*oe:oe,3===Pt&&(Pr=oe,Cr=oe),Co=!0,us<=2*Pr?Co=!1:us<=2*Pr+Cr?(Pr*=kr=us/(2*Pr+Cr),Cr*=kr):(Fr=Math.floor((us+Cr)/(Pr+Cr)),Ua=(us-Fr*Pr)/(Fr-1),Cr=(vo=(us-(Fr+1)*Pr)/Fr)<=0||Math.abs(Cr-Ua)<Math.abs(Cr-vo)?Ua:vo),Co&&this.ctx.setLineDash(3===Pt?[0,Pr+Cr]:[Pr,Cr]),3===Pt?(this.ctx.lineCap="round",this.ctx.lineWidth=oe):this.ctx.lineWidth=2*oe+1.1,this.ctx.strokeStyle=Jo(ae),this.ctx.stroke(),this.ctx.setLineDash([]),2===Pt&&(tc(sn[0])&&(Mo=sn[3],as=sn[0],this.ctx.beginPath(),this.formatPath([new rs(Mo.end.x,Mo.end.y),new rs(as.start.x,as.start.y)]),this.ctx.stroke()),tc(sn[1])&&(Mo=sn[1],as=sn[2],this.ctx.beginPath(),this.formatPath([new rs(Mo.end.x,Mo.end.y),new rs(as.start.x,as.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},Z.prototype.render=function(ae){return v(this,void 0,void 0,function(){var oe;return V(this,function(qe){switch(qe.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Jo(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),oe=function(te){var Z=new Br(te,null),ae=new Mf(Z),oe=[];return zr(Z,ae,ae,oe),Mu(Z.container,oe),ae}(ae),[4,this.renderStack(oe)];case 1:return qe.sent(),this.applyEffects([]),[2,this.canvas]}})})},Z}(Vd),h0=function(te){return te instanceof uc||te instanceof Ys||te instanceof vr&&te.type!==eA&&te.type!==GA},Xy=function(te,Z){switch(te){case 0:return YA(Z);case 2:return function(te){return[te.topLeftContentBox,te.topRightContentBox,te.bottomRightContentBox,te.bottomLeftContentBox]}(Z);default:return Ql(Z)}},u0=function(te){switch(te){case 1:return"center";case 2:return"right";default:return"left"}},d0=["-apple-system","system-ui"],ng=function(te){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?te.filter(function(Z){return-1===d0.indexOf(Z)}):te},jl=function(te){function Z(ae,oe){var qe=te.call(this,ae,oe)||this;return qe.canvas=oe.canvas?oe.canvas:document.createElement("canvas"),qe.ctx=qe.canvas.getContext("2d"),qe.options=oe,qe.canvas.width=Math.floor(oe.width*oe.scale),qe.canvas.height=Math.floor(oe.height*oe.scale),qe.canvas.style.width=oe.width+"px",qe.canvas.style.height=oe.height+"px",qe.ctx.scale(qe.options.scale,qe.options.scale),qe.ctx.translate(-oe.x,-oe.y),qe.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+oe.width+"x"+oe.height+" at "+oe.x+","+oe.y+") with scale "+oe.scale),qe}return Te(Z,te),Z.prototype.render=function(ae){return v(this,void 0,void 0,function(){var oe,qe;return V(this,function(ft){switch(ft.label){case 0:return oe=hp(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,ae),[4,mh(oe)];case 1:return qe=ft.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Jo(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(qe,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},Z}(Vd),mh=function(te){return new Promise(function(Z,ae){var oe=new Image;oe.onload=function(){Z(oe)},oe.onerror=ae,oe.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(te))})},aA=function(){function te(Z){var oe=Z.enabled;this.id=Z.id,this.enabled=oe,this.start=Date.now()}return te.prototype.debug=function(){for(var Z=[],ae=0;ae<arguments.length;ae++)Z[ae]=arguments[ae];this.enabled&&(typeof window<"u"&&window.console&&"function"==typeof console.debug?console.debug.apply(console,Le([this.id,this.getTime()+"ms"],Z)):this.info.apply(this,Z))},te.prototype.getTime=function(){return Date.now()-this.start},te.prototype.info=function(){for(var Z=[],ae=0;ae<arguments.length;ae++)Z[ae]=arguments[ae];this.enabled&&typeof window<"u"&&window.console&&"function"==typeof console.info&&console.info.apply(console,Le([this.id,this.getTime()+"ms"],Z))},te.prototype.warn=function(){for(var Z=[],ae=0;ae<arguments.length;ae++)Z[ae]=arguments[ae];this.enabled&&(typeof window<"u"&&window.console&&"function"==typeof console.warn?console.warn.apply(console,Le([this.id,this.getTime()+"ms"],Z)):this.info.apply(this,Z))},te.prototype.error=function(){for(var Z=[],ae=0;ae<arguments.length;ae++)Z[ae]=arguments[ae];this.enabled&&(typeof window<"u"&&window.console&&"function"==typeof console.error?console.error.apply(console,Le([this.id,this.getTime()+"ms"],Z)):this.info.apply(this,Z))},te.instances={},te}(),Eu=function(){function te(Z,ae){var oe;this.windowBounds=ae,this.instanceName="#"+te.instanceCount++,this.logger=new aA({id:this.instanceName,enabled:Z.logging}),this.cache=null!==(oe=Z.cache)&&void 0!==oe?oe:new Fv(this,Z)}return te.instanceCount=1,te}();typeof window<"u"&&Cf.setContext(window);var ig=function(te,Z){return v(void 0,void 0,void 0,function(){var ae,oe,qe,ft,Pt,on,sn,Vn,Kn,li,Ni,us,Pr,Cr,Co,kr,Fr,Ua,vo,Mo,as,aa,Ks,El,Ea,Ra,ka,Fc,Tf,kh,Jh,Zu,eu,Ap,Df,gp,If,om;return V(this,function(_p){switch(_p.label){case 0:if(!te||"object"!=typeof te)return[2,Promise.reject("Invalid element provided as first argument")];if(!(ae=te.ownerDocument))throw new Error("Element is not attached to a Document");if(!(oe=ae.defaultView))throw new Error("Document is not attached to a Window");return qe={allowTaint:null!==(aa=Z.allowTaint)&&void 0!==aa&&aa,imageTimeout:null!==(Ks=Z.imageTimeout)&&void 0!==Ks?Ks:15e3,proxy:Z.proxy,useCORS:null!==(El=Z.useCORS)&&void 0!==El&&El},ft=be({logging:null===(Ea=Z.logging)||void 0===Ea||Ea,cache:Z.cache},qe),Pt={windowWidth:null!==(Ra=Z.windowWidth)&&void 0!==Ra?Ra:oe.innerWidth,windowHeight:null!==(ka=Z.windowHeight)&&void 0!==ka?ka:oe.innerHeight,scrollX:null!==(Fc=Z.scrollX)&&void 0!==Fc?Fc:oe.pageXOffset,scrollY:null!==(Tf=Z.scrollY)&&void 0!==Tf?Tf:oe.pageYOffset},on=new xe(Pt.scrollX,Pt.scrollY,Pt.windowWidth,Pt.windowHeight),sn=new Eu(ft,on),Vn=null!==(kh=Z.foreignObjectRendering)&&void 0!==kh&&kh,Kn={allowTaint:null!==(Jh=Z.allowTaint)&&void 0!==Jh&&Jh,onclone:Z.onclone,ignoreElements:Z.ignoreElements,inlineImages:Vn,copyStyles:Vn},sn.logger.debug("Starting document clone with size "+on.width+"x"+on.height+" scrolled to "+-on.left+","+-on.top),li=new h_(sn,te,Kn),(Ni=li.clonedReferenceElement)?[4,li.toIFrame(ae,on)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return us=_p.sent(),Pr=s0(Ni)||function(te){return"HTML"===te.tagName}(Ni)?function(te){var Z=te.body,ae=te.documentElement;if(!Z||!ae)throw new Error("Unable to get document size");var oe=Math.max(Math.max(Z.scrollWidth,ae.scrollWidth),Math.max(Z.offsetWidth,ae.offsetWidth),Math.max(Z.clientWidth,ae.clientWidth)),qe=Math.max(Math.max(Z.scrollHeight,ae.scrollHeight),Math.max(Z.offsetHeight,ae.offsetHeight),Math.max(Z.clientHeight,ae.clientHeight));return new xe(0,0,oe,qe)}(Ni.ownerDocument):Je(sn,Ni),Cr=Pr.width,Co=Pr.height,kr=Pr.left,Fr=Pr.top,Ua=mp(sn,Ni,Z.backgroundColor),vo={canvas:Z.canvas,backgroundColor:Ua,scale:null!==(eu=null!==(Zu=Z.scale)&&void 0!==Zu?Zu:oe.devicePixelRatio)&&void 0!==eu?eu:1,x:(null!==(Ap=Z.x)&&void 0!==Ap?Ap:0)+kr,y:(null!==(Df=Z.y)&&void 0!==Df?Df:0)+Fr,width:null!==(gp=Z.width)&&void 0!==gp?gp:Math.ceil(Cr),height:null!==(If=Z.height)&&void 0!==If?If:Math.ceil(Co)},Vn?(sn.logger.debug("Document cloned, using foreign object rendering"),[4,new jl(sn,vo).render(Ni)]):[3,3];case 2:return Mo=_p.sent(),[3,5];case 3:return sn.logger.debug("Document cloned, element located at "+kr+","+Fr+" with size "+Cr+"x"+Co+" using computed rendering"),sn.logger.debug("Starting DOM parsing"),as=hl(sn,Ni),Ua===as.styles.backgroundColor&&(as.styles.backgroundColor=qo.TRANSPARENT),sn.logger.debug("Starting renderer for element at "+vo.x+","+vo.y+" with size "+vo.width+"x"+vo.height),[4,new pp(sn,vo).render(as)];case 4:Mo=_p.sent(),_p.label=5;case 5:return(!(null!==(om=Z.removeContainer)&&void 0!==om)||om)&&(h_.destroy(us)||sn.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),sn.logger.debug("Finished rendering"),[2,Mo]}})})},mp=function(te,Z,ae){var oe=Z.ownerDocument,qe=oe.documentElement?Np(te,getComputedStyle(oe.documentElement).backgroundColor):qo.TRANSPARENT,ft=oe.body?Np(te,getComputedStyle(oe.body).backgroundColor):qo.TRANSPARENT,Pt="string"==typeof ae?Np(te,ae):null===ae?qo.TRANSPARENT:4294967295;return Z===oe.documentElement?Hh(qe)?Hh(ft)?Pt:ft:qe:Pt};return function(te,Z){return void 0===Z&&(Z={}),ig(te,Z)}}()},3347:Gr=>{Gr.exports=function xt(Te,be,v){function V(Je,st){if(!be[Je]){if(!Te[Je]){if(Le)return Le(Je,!0);var ot=new Error("Cannot find module '"+Je+"'");throw ot.code="MODULE_NOT_FOUND",ot}var Re=be[Je]={exports:{}};Te[Je][0].call(Re.exports,function(Qe){return V(Te[Je][1][Qe]||Qe)},Re,Re.exports,xt,Te,be,v)}return be[Je].exports}for(var Le=void 0,xe=0;xe<v.length;xe++)V(v[xe]);return V}({1:[function(xt,Te,be){"use strict";var v=xt("./utils"),V=xt("./support"),Le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";be.encode=function(xe){for(var Je,st,Ke,Re,Qe,Ie,L=[],he=0,re=xe.length,fe=re,de="string"!==v.getTypeOf(xe);he<xe.length;)fe=re-he,Ke=de?(Je=xe[he++],st=he<re?xe[he++]:0,he<re?xe[he++]:0):(Je=xe.charCodeAt(he++),st=he<re?xe.charCodeAt(he++):0,he<re?xe.charCodeAt(he++):0),Re=(3&Je)<<4|st>>4,Qe=1<fe?(15&st)<<2|Ke>>6:64,Ie=2<fe?63&Ke:64,L.push(Le.charAt(Je>>2)+Le.charAt(Re)+Le.charAt(Qe)+Le.charAt(Ie));return L.join("")},be.decode=function(xe){var Je,st,Ke,ot,Re,Qe,Ie=0,L=0;if("data:"===xe.substr(0,5))throw new Error("Invalid base64 input, it looks like a data url.");var re,fe=3*(xe=xe.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(xe.charAt(xe.length-1)===Le.charAt(64)&&fe--,xe.charAt(xe.length-2)===Le.charAt(64)&&fe--,fe%1!=0)throw new Error("Invalid base64 input, bad content length.");for(re=V.uint8array?new Uint8Array(0|fe):new Array(0|fe);Ie<xe.length;)Je=Le.indexOf(xe.charAt(Ie++))<<2|(ot=Le.indexOf(xe.charAt(Ie++)))>>4,st=(15&ot)<<4|(Re=Le.indexOf(xe.charAt(Ie++)))>>2,Ke=(3&Re)<<6|(Qe=Le.indexOf(xe.charAt(Ie++))),re[L++]=Je,64!==Re&&(re[L++]=st),64!==Qe&&(re[L++]=Ke);return re}},{"./support":30,"./utils":32}],2:[function(xt,Te,be){"use strict";var v=xt("./external"),V=xt("./stream/DataWorker"),Le=xt("./stream/Crc32Probe"),xe=xt("./stream/DataLengthProbe");function Je(st,Ke,ot,Re,Qe){this.compressedSize=st,this.uncompressedSize=Ke,this.crc32=ot,this.compression=Re,this.compressedContent=Qe}Je.prototype={getContentWorker:function(){var st=new V(v.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new xe("data_length")),Ke=this;return st.on("end",function(){if(this.streamInfo.data_length!==Ke.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),st},getCompressedWorker:function(){return new V(v.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},Je.createWorkerFrom=function(st,Ke,ot){return st.pipe(new Le).pipe(new xe("uncompressedSize")).pipe(Ke.compressWorker(ot)).pipe(new xe("compressedSize")).withStreamInfo("compression",Ke)},Te.exports=Je},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(xt,Te,be){"use strict";var v=xt("./stream/GenericWorker");be.STORE={magic:"\0\0",compressWorker:function(){return new v("STORE compression")},uncompressWorker:function(){return new v("STORE decompression")}},be.DEFLATE=xt("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(xt,Te,be){"use strict";var v=xt("./utils"),V=function(){for(var Le,xe=[],Je=0;Je<256;Je++){Le=Je;for(var st=0;st<8;st++)Le=1&Le?3988292384^Le>>>1:Le>>>1;xe[Je]=Le}return xe}();Te.exports=function(Le,xe){return void 0!==Le&&Le.length?"string"!==v.getTypeOf(Le)?function(Je,st,Ke){var Re=V,Qe=0+Ke;Je^=-1;for(var Ie=0;Ie<Qe;Ie++)Je=Je>>>8^Re[255&(Je^st[Ie])];return~Je}(0|xe,Le,Le.length):function(Je,st,Ke){var Re=V,Qe=0+Ke;Je^=-1;for(var Ie=0;Ie<Qe;Ie++)Je=Je>>>8^Re[255&(Je^st.charCodeAt(Ie))];return~Je}(0|xe,Le,Le.length):0}},{"./utils":32}],5:[function(xt,Te,be){"use strict";be.base64=!1,be.binary=!1,be.dir=!1,be.createFolders=!0,be.date=null,be.compression=null,be.compressionOptions=null,be.comment=null,be.unixPermissions=null,be.dosPermissions=null},{}],6:[function(xt,Te,be){"use strict";var v;v=typeof Promise<"u"?Promise:xt("lie"),Te.exports={Promise:v}},{lie:37}],7:[function(xt,Te,be){"use strict";var v=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",V=xt("pako"),Le=xt("./utils"),xe=xt("./stream/GenericWorker"),Je=v?"uint8array":"array";function st(Ke,ot){xe.call(this,"FlateWorker/"+Ke),this._pako=null,this._pakoAction=Ke,this._pakoOptions=ot,this.meta={}}be.magic="\b\0",Le.inherits(st,xe),st.prototype.processChunk=function(Ke){this.meta=Ke.meta,null===this._pako&&this._createPako(),this._pako.push(Le.transformTo(Je,Ke.data),!1)},st.prototype.flush=function(){xe.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},st.prototype.cleanUp=function(){xe.prototype.cleanUp.call(this),this._pako=null},st.prototype._createPako=function(){this._pako=new V[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var Ke=this;this._pako.onData=function(ot){Ke.push({data:ot,meta:Ke.meta})}},be.compressWorker=function(Ke){return new st("Deflate",Ke)},be.uncompressWorker=function(){return new st("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(xt,Te,be){"use strict";function v(Re,Qe){var Ie,L="";for(Ie=0;Ie<Qe;Ie++)L+=String.fromCharCode(255&Re),Re>>>=8;return L}function V(Re,Qe,Ie,L,he,re){var fe,de,pe=Re.file,ce=Re.compression,K=re!==Je.utf8encode,G=Le.transformTo("string",re(pe.name)),D=Le.transformTo("string",Je.utf8encode(pe.name)),x=pe.comment,P=Le.transformTo("string",re(x)),w=Le.transformTo("string",Je.utf8encode(x)),b=D.length!==pe.name.length,g=w.length!==x.length,C="",N="",O="",H=pe.dir,X=pe.date,ie={crc32:0,compressedSize:0,uncompressedSize:0};Qe&&!Ie||(ie.crc32=Re.crc32,ie.compressedSize=Re.compressedSize,ie.uncompressedSize=Re.uncompressedSize);var z=0;Qe&&(z|=8),K||!b&&!g||(z|=2048);var R,ee,m=0,I=0;H&&(m|=16),"UNIX"===he?(I=798,m|=(ee=R=pe.unixPermissions,R||(ee=H?16893:33204),(65535&ee)<<16)):(I=20,m|=function(R){return 63&(R||0)}(pe.dosPermissions)),fe=X.getUTCHours(),fe<<=6,fe|=X.getUTCMinutes(),fe<<=5,fe|=X.getUTCSeconds()/2,de=X.getUTCFullYear()-1980,de<<=4,de|=X.getUTCMonth()+1,de<<=5,de|=X.getUTCDate(),b&&(N=v(1,1)+v(st(G),4)+D,C+="up"+v(N.length,2)+N),g&&(O=v(1,1)+v(st(P),4)+w,C+="uc"+v(O.length,2)+O);var A="";return A+="\n\0",A+=v(z,2),A+=ce.magic,A+=v(fe,2),A+=v(de,2),A+=v(ie.crc32,4),A+=v(ie.compressedSize,4),A+=v(ie.uncompressedSize,4),A+=v(G.length,2),A+=v(C.length,2),{fileRecord:Ke.LOCAL_FILE_HEADER+A+G+C,dirRecord:Ke.CENTRAL_FILE_HEADER+v(I,2)+A+v(P.length,2)+"\0\0\0\0"+v(m,4)+v(L,4)+G+C+P}}var Le=xt("../utils"),xe=xt("../stream/GenericWorker"),Je=xt("../utf8"),st=xt("../crc32"),Ke=xt("../signature");function ot(Re,Qe,Ie,L){xe.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=Qe,this.zipPlatform=Ie,this.encodeFileName=L,this.streamFiles=Re,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}Le.inherits(ot,xe),ot.prototype.push=function(Re){var Qe=Re.meta.percent||0,Ie=this.entriesCount,L=this._sources.length;this.accumulate?this.contentBuffer.push(Re):(this.bytesWritten+=Re.data.length,xe.prototype.push.call(this,{data:Re.data,meta:{currentFile:this.currentFile,percent:Ie?(Qe+100*(Ie-L-1))/Ie:100}}))},ot.prototype.openedSource=function(Re){this.currentSourceOffset=this.bytesWritten,this.currentFile=Re.file.name;var Qe=this.streamFiles&&!Re.file.dir;if(Qe){var Ie=V(Re,Qe,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:Ie.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ot.prototype.closedSource=function(Re){this.accumulate=!1;var L,Qe=this.streamFiles&&!Re.file.dir,Ie=V(Re,Qe,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(Ie.dirRecord),Qe)this.push({data:(L=Re,Ke.DATA_DESCRIPTOR+v(L.crc32,4)+v(L.compressedSize,4)+v(L.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:Ie.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ot.prototype.flush=function(){for(var Re=this.bytesWritten,Qe=0;Qe<this.dirRecords.length;Qe++)this.push({data:this.dirRecords[Qe],meta:{percent:100}});var he,re,fe,ce,L=(he=this.dirRecords.length,re=this.bytesWritten-Re,fe=Re,ce=Le.transformTo("string",(0,this.encodeFileName)(this.zipComment)),Ke.CENTRAL_DIRECTORY_END+"\0\0\0\0"+v(he,2)+v(he,2)+v(re,4)+v(fe,4)+v(ce.length,2)+ce);this.push({data:L,meta:{percent:100}})},ot.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ot.prototype.registerPrevious=function(Re){this._sources.push(Re);var Qe=this;return Re.on("data",function(Ie){Qe.processChunk(Ie)}),Re.on("end",function(){Qe.closedSource(Qe.previous.streamInfo),Qe._sources.length?Qe.prepareNextSource():Qe.end()}),Re.on("error",function(Ie){Qe.error(Ie)}),this},ot.prototype.resume=function(){return!!xe.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},ot.prototype.error=function(Re){var Qe=this._sources;if(!xe.prototype.error.call(this,Re))return!1;for(var Ie=0;Ie<Qe.length;Ie++)try{Qe[Ie].error(Re)}catch{}return!0},ot.prototype.lock=function(){xe.prototype.lock.call(this);for(var Re=this._sources,Qe=0;Qe<Re.length;Qe++)Re[Qe].lock()},Te.exports=ot},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(xt,Te,be){"use strict";var v=xt("../compressions"),V=xt("./ZipFileWorker");be.generateWorker=function(Le,xe,Je){var st=new V(xe.streamFiles,Je,xe.platform,xe.encodeFileName),Ke=0;try{Le.forEach(function(ot,Re){Ke++;var Qe=function(re,fe){var de=re||fe,pe=v[de];if(!pe)throw new Error(de+" is not a valid compression method !");return pe}(Re.options.compression,xe.compression),L=Re.dir,he=Re.date;Re._compressWorker(Qe,Re.options.compressionOptions||xe.compressionOptions||{}).withStreamInfo("file",{name:ot,dir:L,date:he,comment:Re.comment||"",unixPermissions:Re.unixPermissions,dosPermissions:Re.dosPermissions}).pipe(st)}),st.entriesCount=Ke}catch(ot){st.error(ot)}return st}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(xt,Te,be){"use strict";function v(){if(!(this instanceof v))return new v;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var V=new v;for(var Le in this)"function"!=typeof this[Le]&&(V[Le]=this[Le]);return V}}(v.prototype=xt("./object")).loadAsync=xt("./load"),v.support=xt("./support"),v.defaults=xt("./defaults"),v.version="3.10.1",v.loadAsync=function(V,Le){return(new v).loadAsync(V,Le)},v.external=xt("./external"),Te.exports=v},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(xt,Te,be){"use strict";var v=xt("./utils"),V=xt("./external"),Le=xt("./utf8"),xe=xt("./zipEntries"),Je=xt("./stream/Crc32Probe"),st=xt("./nodejsUtils");function Ke(ot){return new V.Promise(function(Re,Qe){var Ie=ot.decompressed.getContentWorker().pipe(new Je);Ie.on("error",function(L){Qe(L)}).on("end",function(){Ie.streamInfo.crc32!==ot.decompressed.crc32?Qe(new Error("Corrupted zip : CRC32 mismatch")):Re()}).resume()})}Te.exports=function(ot,Re){var Qe=this;return Re=v.extend(Re||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:Le.utf8decode}),st.isNode&&st.isStream(ot)?V.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):v.prepareContent("the loaded zip file",ot,!0,Re.optimizedBinaryString,Re.base64).then(function(Ie){var L=new xe(Re);return L.load(Ie),L}).then(function(Ie){var L=[V.Promise.resolve(Ie)],he=Ie.files;if(Re.checkCRC32)for(var re=0;re<he.length;re++)L.push(Ke(he[re]));return V.Promise.all(L)}).then(function(Ie){for(var L=Ie.shift(),he=L.files,re=0;re<he.length;re++){var fe=he[re],de=fe.fileNameStr,pe=v.resolve(fe.fileNameStr);Qe.file(pe,fe.decompressed,{binary:!0,optimizedBinaryString:!0,date:fe.date,dir:fe.dir,comment:fe.fileCommentStr.length?fe.fileCommentStr:null,unixPermissions:fe.unixPermissions,dosPermissions:fe.dosPermissions,createFolders:Re.createFolders}),fe.dir||(Qe.file(pe).unsafeOriginalName=de)}return L.zipComment.length&&(Qe.comment=L.zipComment),Qe})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(xt,Te,be){"use strict";var v=xt("../utils"),V=xt("../stream/GenericWorker");function Le(xe,Je){V.call(this,"Nodejs stream input adapter for "+xe),this._upstreamEnded=!1,this._bindStream(Je)}v.inherits(Le,V),Le.prototype._bindStream=function(xe){var Je=this;(this._stream=xe).pause(),xe.on("data",function(st){Je.push({data:st,meta:{percent:0}})}).on("error",function(st){Je.isPaused?this.generatedError=st:Je.error(st)}).on("end",function(){Je.isPaused?Je._upstreamEnded=!0:Je.end()})},Le.prototype.pause=function(){return!!V.prototype.pause.call(this)&&(this._stream.pause(),!0)},Le.prototype.resume=function(){return!!V.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},Te.exports=Le},{"../stream/GenericWorker":28,"../utils":32}],13:[function(xt,Te,be){"use strict";var v=xt("readable-stream").Readable;function V(Le,xe,Je){v.call(this,xe),this._helper=Le;var st=this;Le.on("data",function(Ke,ot){st.push(Ke)||st._helper.pause(),Je&&Je(ot)}).on("error",function(Ke){st.emit("error",Ke)}).on("end",function(){st.push(null)})}xt("../utils").inherits(V,v),V.prototype._read=function(){this._helper.resume()},Te.exports=V},{"../utils":32,"readable-stream":16}],14:[function(xt,Te,be){"use strict";Te.exports={isNode:typeof Buffer<"u",newBufferFrom:function(v,V){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(v,V);if("number"==typeof v)throw new Error('The "data" argument must not be a number');return new Buffer(v,V)},allocBuffer:function(v){if(Buffer.alloc)return Buffer.alloc(v);var V=new Buffer(v);return V.fill(0),V},isBuffer:function(v){return Buffer.isBuffer(v)},isStream:function(v){return v&&"function"==typeof v.on&&"function"==typeof v.pause&&"function"==typeof v.resume}}},{}],15:[function(xt,Te,be){"use strict";function v(pe,ce,K){var G,D=Le.getTypeOf(ce),x=Le.extend(K||{},st);x.date=x.date||new Date,null!==x.compression&&(x.compression=x.compression.toUpperCase()),"string"==typeof x.unixPermissions&&(x.unixPermissions=parseInt(x.unixPermissions,8)),x.unixPermissions&&16384&x.unixPermissions&&(x.dir=!0),x.dosPermissions&&16&x.dosPermissions&&(x.dir=!0),x.dir&&(pe=he(pe)),x.createFolders&&(G=L(pe))&&re.call(this,G,!0),K&&void 0!==K.binary||(x.binary=!("string"===D&&!1===x.binary&&!1===x.base64)),(ce instanceof Ke&&0===ce.uncompressedSize||x.dir||!ce||0===ce.length)&&(x.base64=!1,x.binary=!0,ce="",x.compression="STORE",D="string");var w;w=ce instanceof Ke||ce instanceof xe?ce:Qe.isNode&&Qe.isStream(ce)?new Ie(pe,ce):Le.prepareContent(pe,ce,x.binary,x.optimizedBinaryString,x.base64);var b=new ot(pe,w,x);this.files[pe]=b}var V=xt("./utf8"),Le=xt("./utils"),xe=xt("./stream/GenericWorker"),Je=xt("./stream/StreamHelper"),st=xt("./defaults"),Ke=xt("./compressedObject"),ot=xt("./zipObject"),Re=xt("./generate"),Qe=xt("./nodejsUtils"),Ie=xt("./nodejs/NodejsStreamInputAdapter"),L=function(pe){"/"===pe.slice(-1)&&(pe=pe.substring(0,pe.length-1));var ce=pe.lastIndexOf("/");return 0<ce?pe.substring(0,ce):""},he=function(pe){return"/"!==pe.slice(-1)&&(pe+="/"),pe},re=function(pe,ce){return ce=void 0!==ce?ce:st.createFolders,pe=he(pe),this.files[pe]||v.call(this,pe,null,{dir:!0,createFolders:ce}),this.files[pe]};function fe(pe){return"[object RegExp]"===Object.prototype.toString.call(pe)}var de={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(pe){var ce,K,G;for(ce in this.files)G=this.files[ce],(K=ce.slice(this.root.length,ce.length))&&ce.slice(0,this.root.length)===this.root&&pe(K,G)},filter:function(pe){var ce=[];return this.forEach(function(K,G){pe(K,G)&&ce.push(G)}),ce},file:function(pe,ce,K){if(1!==arguments.length)return v.call(this,pe=this.root+pe,ce,K),this;if(fe(pe)){var G=pe;return this.filter(function(x,P){return!P.dir&&G.test(x)})}var D=this.files[this.root+pe];return D&&!D.dir?D:null},folder:function(pe){if(!pe)return this;if(fe(pe))return this.filter(function(D,x){return x.dir&&pe.test(D)});var K=re.call(this,this.root+pe),G=this.clone();return G.root=K.name,G},remove:function(pe){var ce=this.files[pe=this.root+pe];if(ce||("/"!==pe.slice(-1)&&(pe+="/"),ce=this.files[pe]),ce&&!ce.dir)delete this.files[pe];else for(var K=this.filter(function(D,x){return x.name.slice(0,pe.length)===pe}),G=0;G<K.length;G++)delete this.files[K[G].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(pe){var ce,K={};try{if((K=Le.extend(pe||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:V.utf8encode})).type=K.type.toLowerCase(),K.compression=K.compression.toUpperCase(),"binarystring"===K.type&&(K.type="string"),!K.type)throw new Error("No output type specified.");Le.checkSupport(K.type),"darwin"!==K.platform&&"freebsd"!==K.platform&&"linux"!==K.platform&&"sunos"!==K.platform||(K.platform="UNIX"),"win32"===K.platform&&(K.platform="DOS"),ce=Re.generateWorker(this,K,K.comment||this.comment||"")}catch(D){(ce=new xe("error")).error(D)}return new Je(ce,K.type||"string",K.mimeType)},generateAsync:function(pe,ce){return this.generateInternalStream(pe).accumulate(ce)},generateNodeStream:function(pe,ce){return(pe=pe||{}).type||(pe.type="nodebuffer"),this.generateInternalStream(pe).toNodejsStream(ce)}};Te.exports=de},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(xt,Te,be){"use strict";Te.exports=xt("stream")},{stream:void 0}],17:[function(xt,Te,be){"use strict";var v=xt("./DataReader");function V(Le){v.call(this,Le);for(var xe=0;xe<this.data.length;xe++)Le[xe]=255&Le[xe]}xt("../utils").inherits(V,v),V.prototype.byteAt=function(Le){return this.data[this.zero+Le]},V.prototype.lastIndexOfSignature=function(Le){for(var xe=Le.charCodeAt(0),Je=Le.charCodeAt(1),st=Le.charCodeAt(2),Ke=Le.charCodeAt(3),ot=this.length-4;0<=ot;--ot)if(this.data[ot]===xe&&this.data[ot+1]===Je&&this.data[ot+2]===st&&this.data[ot+3]===Ke)return ot-this.zero;return-1},V.prototype.readAndCheckSignature=function(Le){var xe=Le.charCodeAt(0),Je=Le.charCodeAt(1),st=Le.charCodeAt(2),Ke=Le.charCodeAt(3),ot=this.readData(4);return xe===ot[0]&&Je===ot[1]&&st===ot[2]&&Ke===ot[3]},V.prototype.readData=function(Le){if(this.checkOffset(Le),0===Le)return[];var xe=this.data.slice(this.zero+this.index,this.zero+this.index+Le);return this.index+=Le,xe},Te.exports=V},{"../utils":32,"./DataReader":18}],18:[function(xt,Te,be){"use strict";var v=xt("../utils");function V(Le){this.data=Le,this.length=Le.length,this.index=0,this.zero=0}V.prototype={checkOffset:function(Le){this.checkIndex(this.index+Le)},checkIndex:function(Le){if(this.length<this.zero+Le||Le<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+Le+"). Corrupted zip ?")},setIndex:function(Le){this.checkIndex(Le),this.index=Le},skip:function(Le){this.setIndex(this.index+Le)},byteAt:function(){},readInt:function(Le){var xe,Je=0;for(this.checkOffset(Le),xe=this.index+Le-1;xe>=this.index;xe--)Je=(Je<<8)+this.byteAt(xe);return this.index+=Le,Je},readString:function(Le){return v.transformTo("string",this.readData(Le))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var Le=this.readInt(4);return new Date(Date.UTC(1980+(Le>>25&127),(Le>>21&15)-1,Le>>16&31,Le>>11&31,Le>>5&63,(31&Le)<<1))}},Te.exports=V},{"../utils":32}],19:[function(xt,Te,be){"use strict";var v=xt("./Uint8ArrayReader");function V(Le){v.call(this,Le)}xt("../utils").inherits(V,v),V.prototype.readData=function(Le){this.checkOffset(Le);var xe=this.data.slice(this.zero+this.index,this.zero+this.index+Le);return this.index+=Le,xe},Te.exports=V},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(xt,Te,be){"use strict";var v=xt("./DataReader");function V(Le){v.call(this,Le)}xt("../utils").inherits(V,v),V.prototype.byteAt=function(Le){return this.data.charCodeAt(this.zero+Le)},V.prototype.lastIndexOfSignature=function(Le){return this.data.lastIndexOf(Le)-this.zero},V.prototype.readAndCheckSignature=function(Le){return Le===this.readData(4)},V.prototype.readData=function(Le){this.checkOffset(Le);var xe=this.data.slice(this.zero+this.index,this.zero+this.index+Le);return this.index+=Le,xe},Te.exports=V},{"../utils":32,"./DataReader":18}],21:[function(xt,Te,be){"use strict";var v=xt("./ArrayReader");function V(Le){v.call(this,Le)}xt("../utils").inherits(V,v),V.prototype.readData=function(Le){if(this.checkOffset(Le),0===Le)return new Uint8Array(0);var xe=this.data.subarray(this.zero+this.index,this.zero+this.index+Le);return this.index+=Le,xe},Te.exports=V},{"../utils":32,"./ArrayReader":17}],22:[function(xt,Te,be){"use strict";var v=xt("../utils"),V=xt("../support"),Le=xt("./ArrayReader"),xe=xt("./StringReader"),Je=xt("./NodeBufferReader"),st=xt("./Uint8ArrayReader");Te.exports=function(Ke){var ot=v.getTypeOf(Ke);return v.checkSupport(ot),"string"!==ot||V.uint8array?"nodebuffer"===ot?new Je(Ke):V.uint8array?new st(v.transformTo("uint8array",Ke)):new Le(v.transformTo("array",Ke)):new xe(Ke)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(xt,Te,be){"use strict";be.LOCAL_FILE_HEADER="PK\x03\x04",be.CENTRAL_FILE_HEADER="PK\x01\x02",be.CENTRAL_DIRECTORY_END="PK\x05\x06",be.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",be.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",be.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(xt,Te,be){"use strict";var v=xt("./GenericWorker"),V=xt("../utils");function Le(xe){v.call(this,"ConvertWorker to "+xe),this.destType=xe}V.inherits(Le,v),Le.prototype.processChunk=function(xe){this.push({data:V.transformTo(this.destType,xe.data),meta:xe.meta})},Te.exports=Le},{"../utils":32,"./GenericWorker":28}],25:[function(xt,Te,be){"use strict";var v=xt("./GenericWorker"),V=xt("../crc32");function Le(){v.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}xt("../utils").inherits(Le,v),Le.prototype.processChunk=function(xe){this.streamInfo.crc32=V(xe.data,this.streamInfo.crc32||0),this.push(xe)},Te.exports=Le},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(xt,Te,be){"use strict";var v=xt("../utils"),V=xt("./GenericWorker");function Le(xe){V.call(this,"DataLengthProbe for "+xe),this.propName=xe,this.withStreamInfo(xe,0)}v.inherits(Le,V),Le.prototype.processChunk=function(xe){xe&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+xe.data.length),V.prototype.processChunk.call(this,xe)},Te.exports=Le},{"../utils":32,"./GenericWorker":28}],27:[function(xt,Te,be){"use strict";var v=xt("../utils"),V=xt("./GenericWorker");function Le(xe){V.call(this,"DataWorker");var Je=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,xe.then(function(st){Je.dataIsReady=!0,Je.data=st,Je.max=st&&st.length||0,Je.type=v.getTypeOf(st),Je.isPaused||Je._tickAndRepeat()},function(st){Je.error(st)})}v.inherits(Le,V),Le.prototype.cleanUp=function(){V.prototype.cleanUp.call(this),this.data=null},Le.prototype.resume=function(){return!!V.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,v.delay(this._tickAndRepeat,[],this)),!0)},Le.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(v.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},Le.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var xe=null,Je=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":xe=this.data.substring(this.index,Je);break;case"uint8array":xe=this.data.subarray(this.index,Je);break;case"array":case"nodebuffer":xe=this.data.slice(this.index,Je)}return this.index=Je,this.push({data:xe,meta:{percent:this.max?this.index/this.max*100:0}})},Te.exports=Le},{"../utils":32,"./GenericWorker":28}],28:[function(xt,Te,be){"use strict";function v(V){this.name=V||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}v.prototype={push:function(V){this.emit("data",V)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(V){this.emit("error",V)}return!0},error:function(V){return!this.isFinished&&(this.isPaused?this.generatedError=V:(this.isFinished=!0,this.emit("error",V),this.previous&&this.previous.error(V),this.cleanUp()),!0)},on:function(V,Le){return this._listeners[V].push(Le),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(V,Le){if(this._listeners[V])for(var xe=0;xe<this._listeners[V].length;xe++)this._listeners[V][xe].call(this,Le)},pipe:function(V){return V.registerPrevious(this)},registerPrevious:function(V){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=V.streamInfo,this.mergeStreamInfo(),this.previous=V;var Le=this;return V.on("data",function(xe){Le.processChunk(xe)}),V.on("end",function(){Le.end()}),V.on("error",function(xe){Le.error(xe)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var V=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),V=!0),this.previous&&this.previous.resume(),!V},flush:function(){},processChunk:function(V){this.push(V)},withStreamInfo:function(V,Le){return this.extraStreamInfo[V]=Le,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var V in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,V)&&(this.streamInfo[V]=this.extraStreamInfo[V])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var V="Worker "+this.name;return this.previous?this.previous+" -> "+V:V}},Te.exports=v},{}],29:[function(xt,Te,be){"use strict";var v=xt("../utils"),V=xt("./ConvertWorker"),Le=xt("./GenericWorker"),xe=xt("../base64"),Je=xt("../support"),st=xt("../external"),Ke=null;if(Je.nodestream)try{Ke=xt("../nodejs/NodejsStreamOutputAdapter")}catch{}function Re(Qe,Ie,L){var he=Ie;switch(Ie){case"blob":case"arraybuffer":he="uint8array";break;case"base64":he="string"}try{this._internalType=he,this._outputType=Ie,this._mimeType=L,v.checkSupport(he),this._worker=Qe.pipe(new V(he)),Qe.lock()}catch(re){this._worker=new Le("error"),this._worker.error(re)}}Re.prototype={accumulate:function(Qe){return function ot(Qe,Ie){return new st.Promise(function(L,he){var re=[],fe=Qe._internalType,de=Qe._outputType,pe=Qe._mimeType;Qe.on("data",function(ce,K){re.push(ce),Ie&&Ie(K)}).on("error",function(ce){re=[],he(ce)}).on("end",function(){try{var ce=function(K,G,D){switch(K){case"blob":return v.newBlob(v.transformTo("arraybuffer",G),D);case"base64":return xe.encode(G);default:return v.transformTo(K,G)}}(de,function(K,G){var D,x=0,P=null,w=0;for(D=0;D<G.length;D++)w+=G[D].length;switch(K){case"string":return G.join("");case"array":return Array.prototype.concat.apply([],G);case"uint8array":for(P=new Uint8Array(w),D=0;D<G.length;D++)P.set(G[D],x),x+=G[D].length;return P;case"nodebuffer":return Buffer.concat(G);default:throw new Error("concat : unsupported type '"+K+"'")}}(fe,re),pe);L(ce)}catch(K){he(K)}re=[]}).resume()})}(this,Qe)},on:function(Qe,Ie){var L=this;return this._worker.on(Qe,"data"===Qe?function(he){Ie.call(L,he.data,he.meta)}:function(){v.delay(Ie,arguments,L)}),this},resume:function(){return v.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(Qe){if(v.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new Ke(this,{objectMode:"nodebuffer"!==this._outputType},Qe)}},Te.exports=Re},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(xt,Te,be){"use strict";if(be.base64=!0,be.array=!0,be.string=!0,be.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",be.nodebuffer=typeof Buffer<"u",be.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")be.blob=!1;else{var v=new ArrayBuffer(0);try{be.blob=0===new Blob([v],{type:"application/zip"}).size}catch{try{var V=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);V.append(v),be.blob=0===V.getBlob("application/zip").size}catch{be.blob=!1}}}try{be.nodestream=!!xt("readable-stream").Readable}catch{be.nodestream=!1}},{"readable-stream":16}],31:[function(xt,Te,be){"use strict";for(var v=xt("./utils"),V=xt("./support"),Le=xt("./nodejsUtils"),xe=xt("./stream/GenericWorker"),Je=new Array(256),st=0;st<256;st++)Je[st]=252<=st?6:248<=st?5:240<=st?4:224<=st?3:192<=st?2:1;function Ke(){xe.call(this,"utf-8 decode"),this.leftOver=null}function ot(){xe.call(this,"utf-8 encode")}Je[254]=Je[254]=1,be.utf8encode=function(Re){return V.nodebuffer?Le.newBufferFrom(Re,"utf-8"):function(Qe){var Ie,L,he,re,fe,de=Qe.length,pe=0;for(re=0;re<de;re++)55296==(64512&(L=Qe.charCodeAt(re)))&&re+1<de&&56320==(64512&(he=Qe.charCodeAt(re+1)))&&(L=65536+(L-55296<<10)+(he-56320),re++),pe+=L<128?1:L<2048?2:L<65536?3:4;for(Ie=V.uint8array?new Uint8Array(pe):new Array(pe),re=fe=0;fe<pe;re++)55296==(64512&(L=Qe.charCodeAt(re)))&&re+1<de&&56320==(64512&(he=Qe.charCodeAt(re+1)))&&(L=65536+(L-55296<<10)+(he-56320),re++),L<128?Ie[fe++]=L:(L<2048?Ie[fe++]=192|L>>>6:(L<65536?Ie[fe++]=224|L>>>12:(Ie[fe++]=240|L>>>18,Ie[fe++]=128|L>>>12&63),Ie[fe++]=128|L>>>6&63),Ie[fe++]=128|63&L);return Ie}(Re)},be.utf8decode=function(Re){return V.nodebuffer?v.transformTo("nodebuffer",Re).toString("utf-8"):function(Qe){var Ie,L,he,re,fe=Qe.length,de=new Array(2*fe);for(Ie=L=0;Ie<fe;)if((he=Qe[Ie++])<128)de[L++]=he;else if(4<(re=Je[he]))de[L++]=65533,Ie+=re-1;else{for(he&=2===re?31:3===re?15:7;1<re&&Ie<fe;)he=he<<6|63&Qe[Ie++],re--;1<re?de[L++]=65533:he<65536?de[L++]=he:(de[L++]=55296|(he-=65536)>>10&1023,de[L++]=56320|1023&he)}return de.length!==L&&(de.subarray?de=de.subarray(0,L):de.length=L),v.applyFromCharCode(de)}(Re=v.transformTo(V.uint8array?"uint8array":"array",Re))},v.inherits(Ke,xe),Ke.prototype.processChunk=function(Re){var Qe=v.transformTo(V.uint8array?"uint8array":"array",Re.data);if(this.leftOver&&this.leftOver.length){if(V.uint8array){var Ie=Qe;(Qe=new Uint8Array(Ie.length+this.leftOver.length)).set(this.leftOver,0),Qe.set(Ie,this.leftOver.length)}else Qe=this.leftOver.concat(Qe);this.leftOver=null}var L=function(re,fe){var de;for((fe=fe||re.length)>re.length&&(fe=re.length),de=fe-1;0<=de&&128==(192&re[de]);)de--;return de<0||0===de?fe:de+Je[re[de]]>fe?de:fe}(Qe),he=Qe;L!==Qe.length&&(V.uint8array?(he=Qe.subarray(0,L),this.leftOver=Qe.subarray(L,Qe.length)):(he=Qe.slice(0,L),this.leftOver=Qe.slice(L,Qe.length))),this.push({data:be.utf8decode(he),meta:Re.meta})},Ke.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:be.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},be.Utf8DecodeWorker=Ke,v.inherits(ot,xe),ot.prototype.processChunk=function(Re){this.push({data:be.utf8encode(Re.data),meta:Re.meta})},be.Utf8EncodeWorker=ot},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(xt,Te,be){"use strict";var v=xt("./support"),V=xt("./base64"),Le=xt("./nodejsUtils"),xe=xt("./external");function Je(Ie){return Ie}function st(Ie,L){for(var he=0;he<Ie.length;++he)L[he]=255&Ie.charCodeAt(he);return L}xt("setimmediate"),be.newBlob=function(Ie,L){be.checkSupport("blob");try{return new Blob([Ie],{type:L})}catch{try{var he=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return he.append(Ie),he.getBlob(L)}catch{throw new Error("Bug : can't construct the Blob.")}}};var Ke={stringifyByChunk:function(Ie,L,he){var re=[],fe=0,de=Ie.length;if(de<=he)return String.fromCharCode.apply(null,Ie);for(;fe<de;)re.push(String.fromCharCode.apply(null,"array"===L||"nodebuffer"===L?Ie.slice(fe,Math.min(fe+he,de)):Ie.subarray(fe,Math.min(fe+he,de)))),fe+=he;return re.join("")},stringifyByChar:function(Ie){for(var L="",he=0;he<Ie.length;he++)L+=String.fromCharCode(Ie[he]);return L},applyCanBeUsed:{uint8array:function(){try{return v.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return v.nodebuffer&&1===String.fromCharCode.apply(null,Le.allocBuffer(1)).length}catch{return!1}}()}};function ot(Ie){var L=65536,he=be.getTypeOf(Ie),re=!0;if("uint8array"===he?re=Ke.applyCanBeUsed.uint8array:"nodebuffer"===he&&(re=Ke.applyCanBeUsed.nodebuffer),re)for(;1<L;)try{return Ke.stringifyByChunk(Ie,he,L)}catch{L=Math.floor(L/2)}return Ke.stringifyByChar(Ie)}function Re(Ie,L){for(var he=0;he<Ie.length;he++)L[he]=Ie[he];return L}be.applyFromCharCode=ot;var Qe={};Qe.string={string:Je,array:function(Ie){return st(Ie,new Array(Ie.length))},arraybuffer:function(Ie){return Qe.string.uint8array(Ie).buffer},uint8array:function(Ie){return st(Ie,new Uint8Array(Ie.length))},nodebuffer:function(Ie){return st(Ie,Le.allocBuffer(Ie.length))}},Qe.array={string:ot,array:Je,arraybuffer:function(Ie){return new Uint8Array(Ie).buffer},uint8array:function(Ie){return new Uint8Array(Ie)},nodebuffer:function(Ie){return Le.newBufferFrom(Ie)}},Qe.arraybuffer={string:function(Ie){return ot(new Uint8Array(Ie))},array:function(Ie){return Re(new Uint8Array(Ie),new Array(Ie.byteLength))},arraybuffer:Je,uint8array:function(Ie){return new Uint8Array(Ie)},nodebuffer:function(Ie){return Le.newBufferFrom(new Uint8Array(Ie))}},Qe.uint8array={string:ot,array:function(Ie){return Re(Ie,new Array(Ie.length))},arraybuffer:function(Ie){return Ie.buffer},uint8array:Je,nodebuffer:function(Ie){return Le.newBufferFrom(Ie)}},Qe.nodebuffer={string:ot,array:function(Ie){return Re(Ie,new Array(Ie.length))},arraybuffer:function(Ie){return Qe.nodebuffer.uint8array(Ie).buffer},uint8array:function(Ie){return Re(Ie,new Uint8Array(Ie.length))},nodebuffer:Je},be.transformTo=function(Ie,L){if(L=L||"",!Ie)return L;be.checkSupport(Ie);var he=be.getTypeOf(L);return Qe[he][Ie](L)},be.resolve=function(Ie){for(var L=Ie.split("/"),he=[],re=0;re<L.length;re++){var fe=L[re];"."===fe||""===fe&&0!==re&&re!==L.length-1||(".."===fe?he.pop():he.push(fe))}return he.join("/")},be.getTypeOf=function(Ie){return"string"==typeof Ie?"string":"[object Array]"===Object.prototype.toString.call(Ie)?"array":v.nodebuffer&&Le.isBuffer(Ie)?"nodebuffer":v.uint8array&&Ie instanceof Uint8Array?"uint8array":v.arraybuffer&&Ie instanceof ArrayBuffer?"arraybuffer":void 0},be.checkSupport=function(Ie){if(!v[Ie.toLowerCase()])throw new Error(Ie+" is not supported by this platform")},be.MAX_VALUE_16BITS=65535,be.MAX_VALUE_32BITS=-1,be.pretty=function(Ie){var L,he,re="";for(he=0;he<(Ie||"").length;he++)re+="\\x"+((L=Ie.charCodeAt(he))<16?"0":"")+L.toString(16).toUpperCase();return re},be.delay=function(Ie,L,he){setImmediate(function(){Ie.apply(he||null,L||[])})},be.inherits=function(Ie,L){function he(){}he.prototype=L.prototype,Ie.prototype=new he},be.extend=function(){var Ie,L,he={};for(Ie=0;Ie<arguments.length;Ie++)for(L in arguments[Ie])Object.prototype.hasOwnProperty.call(arguments[Ie],L)&&void 0===he[L]&&(he[L]=arguments[Ie][L]);return he},be.prepareContent=function(Ie,L,he,re,fe){return xe.Promise.resolve(L).then(function(de){return v.blob&&(de instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(de)))&&typeof FileReader<"u"?new xe.Promise(function(pe,ce){var K=new FileReader;K.onload=function(G){pe(G.target.result)},K.onerror=function(G){ce(G.target.error)},K.readAsArrayBuffer(de)}):de}).then(function(de){var ce,pe=be.getTypeOf(de);return pe?("arraybuffer"===pe?de=be.transformTo("uint8array",de):"string"===pe&&(fe?de=V.decode(de):he&&!0!==re&&(de=st(ce=de,v.uint8array?new Uint8Array(ce.length):new Array(ce.length)))),de):xe.Promise.reject(new Error("Can't read the data of '"+Ie+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(xt,Te,be){"use strict";var v=xt("./reader/readerFor"),V=xt("./utils"),Le=xt("./signature"),xe=xt("./zipEntry"),Je=xt("./support");function st(Ke){this.files=[],this.loadOptions=Ke}st.prototype={checkSignature:function(Ke){if(!this.reader.readAndCheckSignature(Ke)){this.reader.index-=4;var ot=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+V.pretty(ot)+", expected "+V.pretty(Ke)+")")}},isSignature:function(Ke,ot){var Re=this.reader.index;this.reader.setIndex(Ke);var Qe=this.reader.readString(4)===ot;return this.reader.setIndex(Re),Qe},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var Ke=this.reader.readData(this.zipCommentLength),Re=V.transformTo(Je.uint8array?"uint8array":"array",Ke);this.zipComment=this.loadOptions.decodeFileName(Re)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var Ke,ot,Re,Qe=this.zip64EndOfCentralSize-44;0<Qe;)Ke=this.reader.readInt(2),ot=this.reader.readInt(4),Re=this.reader.readData(ot),this.zip64ExtensibleData[Ke]={id:Ke,length:ot,value:Re}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var Ke,ot;for(Ke=0;Ke<this.files.length;Ke++)this.reader.setIndex((ot=this.files[Ke]).localHeaderOffset),this.checkSignature(Le.LOCAL_FILE_HEADER),ot.readLocalPart(this.reader),ot.handleUTF8(),ot.processAttributes()},readCentralDir:function(){var Ke;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(Le.CENTRAL_FILE_HEADER);)(Ke=new xe({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(Ke);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var Ke=this.reader.lastIndexOfSignature(Le.CENTRAL_DIRECTORY_END);if(Ke<0)throw this.isSignature(0,Le.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(Ke);var ot=Ke;if(this.checkSignature(Le.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===V.MAX_VALUE_16BITS||this.diskWithCentralDirStart===V.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===V.MAX_VALUE_16BITS||this.centralDirRecords===V.MAX_VALUE_16BITS||this.centralDirSize===V.MAX_VALUE_32BITS||this.centralDirOffset===V.MAX_VALUE_32BITS){if(this.zip64=!0,(Ke=this.reader.lastIndexOfSignature(Le.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(Ke),this.checkSignature(Le.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,Le.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(Le.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(Le.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var Re=this.centralDirOffset+this.centralDirSize;this.zip64&&(Re+=20,Re+=12+this.zip64EndOfCentralSize);var Qe=ot-Re;if(0<Qe)this.isSignature(ot,Le.CENTRAL_FILE_HEADER)||(this.reader.zero=Qe);else if(Qe<0)throw new Error("Corrupted zip: missing "+Math.abs(Qe)+" bytes.")},prepareReader:function(Ke){this.reader=v(Ke)},load:function(Ke){this.prepareReader(Ke),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},Te.exports=st},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(xt,Te,be){"use strict";var v=xt("./reader/readerFor"),V=xt("./utils"),Le=xt("./compressedObject"),xe=xt("./crc32"),Je=xt("./utf8"),st=xt("./compressions"),Ke=xt("./support");function ot(Re,Qe){this.options=Re,this.loadOptions=Qe}ot.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(Re){var Qe,Ie;if(Re.skip(22),this.fileNameLength=Re.readInt(2),Ie=Re.readInt(2),this.fileName=Re.readData(this.fileNameLength),Re.skip(Ie),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(Qe=function(L){for(var he in st)if(Object.prototype.hasOwnProperty.call(st,he)&&st[he].magic===L)return st[he];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+V.pretty(this.compressionMethod)+" unknown (inner file : "+V.transformTo("string",this.fileName)+")");this.decompressed=new Le(this.compressedSize,this.uncompressedSize,this.crc32,Qe,Re.readData(this.compressedSize))},readCentralPart:function(Re){this.versionMadeBy=Re.readInt(2),Re.skip(2),this.bitFlag=Re.readInt(2),this.compressionMethod=Re.readString(2),this.date=Re.readDate(),this.crc32=Re.readInt(4),this.compressedSize=Re.readInt(4),this.uncompressedSize=Re.readInt(4);var Qe=Re.readInt(2);if(this.extraFieldsLength=Re.readInt(2),this.fileCommentLength=Re.readInt(2),this.diskNumberStart=Re.readInt(2),this.internalFileAttributes=Re.readInt(2),this.externalFileAttributes=Re.readInt(4),this.localHeaderOffset=Re.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");Re.skip(Qe),this.readExtraFields(Re),this.parseZIP64ExtraField(Re),this.fileComment=Re.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var Re=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==Re&&(this.dosPermissions=63&this.externalFileAttributes),3==Re&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var Re=v(this.extraFields[1].value);this.uncompressedSize===V.MAX_VALUE_32BITS&&(this.uncompressedSize=Re.readInt(8)),this.compressedSize===V.MAX_VALUE_32BITS&&(this.compressedSize=Re.readInt(8)),this.localHeaderOffset===V.MAX_VALUE_32BITS&&(this.localHeaderOffset=Re.readInt(8)),this.diskNumberStart===V.MAX_VALUE_32BITS&&(this.diskNumberStart=Re.readInt(4))}},readExtraFields:function(Re){var Qe,Ie,L,he=Re.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});Re.index+4<he;)Qe=Re.readInt(2),Ie=Re.readInt(2),L=Re.readData(Ie),this.extraFields[Qe]={id:Qe,length:Ie,value:L};Re.setIndex(he)},handleUTF8:function(){var Re=Ke.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=Je.utf8decode(this.fileName),this.fileCommentStr=Je.utf8decode(this.fileComment);else{var Qe=this.findExtraFieldUnicodePath();if(null!==Qe)this.fileNameStr=Qe;else{var Ie=V.transformTo(Re,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(Ie)}var L=this.findExtraFieldUnicodeComment();if(null!==L)this.fileCommentStr=L;else{var he=V.transformTo(Re,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(he)}}},findExtraFieldUnicodePath:function(){var Re=this.extraFields[28789];if(Re){var Qe=v(Re.value);return 1!==Qe.readInt(1)||xe(this.fileName)!==Qe.readInt(4)?null:Je.utf8decode(Qe.readData(Re.length-5))}return null},findExtraFieldUnicodeComment:function(){var Re=this.extraFields[25461];if(Re){var Qe=v(Re.value);return 1!==Qe.readInt(1)||xe(this.fileComment)!==Qe.readInt(4)?null:Je.utf8decode(Qe.readData(Re.length-5))}return null}},Te.exports=ot},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(xt,Te,be){"use strict";function v(Qe,Ie,L){this.name=Qe,this.dir=L.dir,this.date=L.date,this.comment=L.comment,this.unixPermissions=L.unixPermissions,this.dosPermissions=L.dosPermissions,this._data=Ie,this._dataBinary=L.binary,this.options={compression:L.compression,compressionOptions:L.compressionOptions}}var V=xt("./stream/StreamHelper"),Le=xt("./stream/DataWorker"),xe=xt("./utf8"),Je=xt("./compressedObject"),st=xt("./stream/GenericWorker");v.prototype={internalStream:function(Qe){var Ie=null,L="string";try{if(!Qe)throw new Error("No output type specified.");var he="string"===(L=Qe.toLowerCase())||"text"===L;"binarystring"!==L&&"text"!==L||(L="string"),Ie=this._decompressWorker();var re=!this._dataBinary;re&&!he&&(Ie=Ie.pipe(new xe.Utf8EncodeWorker)),!re&&he&&(Ie=Ie.pipe(new xe.Utf8DecodeWorker))}catch(fe){(Ie=new st("error")).error(fe)}return new V(Ie,L,"")},async:function(Qe,Ie){return this.internalStream(Qe).accumulate(Ie)},nodeStream:function(Qe,Ie){return this.internalStream(Qe||"nodebuffer").toNodejsStream(Ie)},_compressWorker:function(Qe,Ie){if(this._data instanceof Je&&this._data.compression.magic===Qe.magic)return this._data.getCompressedWorker();var L=this._decompressWorker();return this._dataBinary||(L=L.pipe(new xe.Utf8EncodeWorker)),Je.createWorkerFrom(L,Qe,Ie)},_decompressWorker:function(){return this._data instanceof Je?this._data.getContentWorker():this._data instanceof st?this._data:new Le(this._data)}};for(var Ke=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],ot=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},Re=0;Re<Ke.length;Re++)v.prototype[Ke[Re]]=ot;Te.exports=v},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(xt,Te,be){(function(v){"use strict";var V,Le,xe=v.MutationObserver||v.WebKitMutationObserver;if(xe){var Je=0,st=new xe(Qe),Ke=v.document.createTextNode("");st.observe(Ke,{characterData:!0}),V=function(){Ke.data=Je=++Je%2}}else if(v.setImmediate||void 0===v.MessageChannel)V="document"in v&&"onreadystatechange"in v.document.createElement("script")?function(){var Ie=v.document.createElement("script");Ie.onreadystatechange=function(){Qe(),Ie.onreadystatechange=null,Ie.parentNode.removeChild(Ie),Ie=null},v.document.documentElement.appendChild(Ie)}:function(){setTimeout(Qe,0)};else{var ot=new v.MessageChannel;ot.port1.onmessage=Qe,V=function(){ot.port2.postMessage(0)}}var Re=[];function Qe(){var Ie,L;Le=!0;for(var he=Re.length;he;){for(L=Re,Re=[],Ie=-1;++Ie<he;)L[Ie]();he=Re.length}Le=!1}Te.exports=function(Ie){1!==Re.push(Ie)||Le||V()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(xt,Te,be){"use strict";var v=xt("immediate");function V(){}var Le={},xe=["REJECTED"],Je=["FULFILLED"],st=["PENDING"];function Ke(he){if("function"!=typeof he)throw new TypeError("resolver must be a function");this.state=st,this.queue=[],this.outcome=void 0,he!==V&&Ie(this,he)}function ot(he,re,fe){this.promise=he,"function"==typeof re&&(this.onFulfilled=re,this.callFulfilled=this.otherCallFulfilled),"function"==typeof fe&&(this.onRejected=fe,this.callRejected=this.otherCallRejected)}function Re(he,re,fe){v(function(){var de;try{de=re(fe)}catch(pe){return Le.reject(he,pe)}de===he?Le.reject(he,new TypeError("Cannot resolve promise with itself")):Le.resolve(he,de)})}function Qe(he){var re=he&&he.then;if(he&&("object"==typeof he||"function"==typeof he)&&"function"==typeof re)return function(){re.apply(he,arguments)}}function Ie(he,re){var fe=!1;function de(K){fe||(fe=!0,Le.reject(he,K))}function pe(K){fe||(fe=!0,Le.resolve(he,K))}var ce=L(function(){re(pe,de)});"error"===ce.status&&de(ce.value)}function L(he,re){var fe={};try{fe.value=he(re),fe.status="success"}catch(de){fe.status="error",fe.value=de}return fe}(Te.exports=Ke).prototype.finally=function(he){if("function"!=typeof he)return this;var re=this.constructor;return this.then(function(fe){return re.resolve(he()).then(function(){return fe})},function(fe){return re.resolve(he()).then(function(){throw fe})})},Ke.prototype.catch=function(he){return this.then(null,he)},Ke.prototype.then=function(he,re){if("function"!=typeof he&&this.state===Je||"function"!=typeof re&&this.state===xe)return this;var fe=new this.constructor(V);return this.state!==st?Re(fe,this.state===Je?he:re,this.outcome):this.queue.push(new ot(fe,he,re)),fe},ot.prototype.callFulfilled=function(he){Le.resolve(this.promise,he)},ot.prototype.otherCallFulfilled=function(he){Re(this.promise,this.onFulfilled,he)},ot.prototype.callRejected=function(he){Le.reject(this.promise,he)},ot.prototype.otherCallRejected=function(he){Re(this.promise,this.onRejected,he)},Le.resolve=function(he,re){var fe=L(Qe,re);if("error"===fe.status)return Le.reject(he,fe.value);var de=fe.value;if(de)Ie(he,de);else{he.state=Je,he.outcome=re;for(var pe=-1,ce=he.queue.length;++pe<ce;)he.queue[pe].callFulfilled(re)}return he},Le.reject=function(he,re){he.state=xe,he.outcome=re;for(var fe=-1,de=he.queue.length;++fe<de;)he.queue[fe].callRejected(re);return he},Ke.resolve=function(he){return he instanceof this?he:Le.resolve(new this(V),he)},Ke.reject=function(he){var re=new this(V);return Le.reject(re,he)},Ke.all=function(he){var re=this;if("[object Array]"!==Object.prototype.toString.call(he))return this.reject(new TypeError("must be an array"));var fe=he.length,de=!1;if(!fe)return this.resolve([]);for(var pe=new Array(fe),ce=0,K=-1,G=new this(V);++K<fe;)D(he[K],K);return G;function D(x,P){re.resolve(x).then(function(w){pe[P]=w,++ce!==fe||de||(de=!0,Le.resolve(G,pe))},function(w){de||(de=!0,Le.reject(G,w))})}},Ke.race=function(he){if("[object Array]"!==Object.prototype.toString.call(he))return this.reject(new TypeError("must be an array"));var fe=he.length,de=!1;if(!fe)return this.resolve([]);for(var pe=-1,ce=new this(V);++pe<fe;)this.resolve(he[pe]).then(function(G){de||(de=!0,Le.resolve(ce,G))},function(G){de||(de=!0,Le.reject(ce,G))});return ce}},{immediate:36}],38:[function(xt,Te,be){"use strict";var v={};(0,xt("./lib/utils/common").assign)(v,xt("./lib/deflate"),xt("./lib/inflate"),xt("./lib/zlib/constants")),Te.exports=v},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(xt,Te,be){"use strict";var v=xt("./zlib/deflate"),V=xt("./utils/common"),Le=xt("./utils/strings"),xe=xt("./zlib/messages"),Je=xt("./zlib/zstream"),st=Object.prototype.toString,Ke=0,ot=-1,Re=0,Qe=8;function Ie(he){if(!(this instanceof Ie))return new Ie(he);this.options=V.assign({level:ot,method:Qe,chunkSize:16384,windowBits:15,memLevel:8,strategy:Re,to:""},he||{});var re=this.options;re.raw&&0<re.windowBits?re.windowBits=-re.windowBits:re.gzip&&0<re.windowBits&&re.windowBits<16&&(re.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Je,this.strm.avail_out=0;var fe=v.deflateInit2(this.strm,re.level,re.method,re.windowBits,re.memLevel,re.strategy);if(fe!==Ke)throw new Error(xe[fe]);if(re.header&&v.deflateSetHeader(this.strm,re.header),re.dictionary){var de;if(de="string"==typeof re.dictionary?Le.string2buf(re.dictionary):"[object ArrayBuffer]"===st.call(re.dictionary)?new Uint8Array(re.dictionary):re.dictionary,(fe=v.deflateSetDictionary(this.strm,de))!==Ke)throw new Error(xe[fe]);this._dict_set=!0}}function L(he,re){var fe=new Ie(re);if(fe.push(he,!0),fe.err)throw fe.msg||xe[fe.err];return fe.result}Ie.prototype.push=function(he,re){var fe,de,pe=this.strm,ce=this.options.chunkSize;if(this.ended)return!1;de=re===~~re?re:!0===re?4:0,pe.input="string"==typeof he?Le.string2buf(he):"[object ArrayBuffer]"===st.call(he)?new Uint8Array(he):he,pe.next_in=0,pe.avail_in=pe.input.length;do{if(0===pe.avail_out&&(pe.output=new V.Buf8(ce),pe.next_out=0,pe.avail_out=ce),1!==(fe=v.deflate(pe,de))&&fe!==Ke)return this.onEnd(fe),!(this.ended=!0);0!==pe.avail_out&&(0!==pe.avail_in||4!==de&&2!==de)||this.onData("string"===this.options.to?Le.buf2binstring(V.shrinkBuf(pe.output,pe.next_out)):V.shrinkBuf(pe.output,pe.next_out))}while((0<pe.avail_in||0===pe.avail_out)&&1!==fe);return 4===de?(fe=v.deflateEnd(this.strm),this.onEnd(fe),this.ended=!0,fe===Ke):2!==de||(this.onEnd(Ke),!(pe.avail_out=0))},Ie.prototype.onData=function(he){this.chunks.push(he)},Ie.prototype.onEnd=function(he){he===Ke&&(this.result="string"===this.options.to?this.chunks.join(""):V.flattenChunks(this.chunks)),this.chunks=[],this.err=he,this.msg=this.strm.msg},be.Deflate=Ie,be.deflate=L,be.deflateRaw=function(he,re){return(re=re||{}).raw=!0,L(he,re)},be.gzip=function(he,re){return(re=re||{}).gzip=!0,L(he,re)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(xt,Te,be){"use strict";var v=xt("./zlib/inflate"),V=xt("./utils/common"),Le=xt("./utils/strings"),xe=xt("./zlib/constants"),Je=xt("./zlib/messages"),st=xt("./zlib/zstream"),Ke=xt("./zlib/gzheader"),ot=Object.prototype.toString;function Re(Ie){if(!(this instanceof Re))return new Re(Ie);this.options=V.assign({chunkSize:16384,windowBits:0,to:""},Ie||{});var L=this.options;L.raw&&0<=L.windowBits&&L.windowBits<16&&(L.windowBits=-L.windowBits,0===L.windowBits&&(L.windowBits=-15)),!(0<=L.windowBits&&L.windowBits<16)||Ie&&Ie.windowBits||(L.windowBits+=32),15<L.windowBits&&L.windowBits<48&&!(15&L.windowBits)&&(L.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new st,this.strm.avail_out=0;var he=v.inflateInit2(this.strm,L.windowBits);if(he!==xe.Z_OK)throw new Error(Je[he]);this.header=new Ke,v.inflateGetHeader(this.strm,this.header)}function Qe(Ie,L){var he=new Re(L);if(he.push(Ie,!0),he.err)throw he.msg||Je[he.err];return he.result}Re.prototype.push=function(Ie,L){var he,re,fe,de,pe,ce,K=this.strm,G=this.options.chunkSize,D=this.options.dictionary,x=!1;if(this.ended)return!1;re=L===~~L?L:!0===L?xe.Z_FINISH:xe.Z_NO_FLUSH,K.input="string"==typeof Ie?Le.binstring2buf(Ie):"[object ArrayBuffer]"===ot.call(Ie)?new Uint8Array(Ie):Ie,K.next_in=0,K.avail_in=K.input.length;do{if(0===K.avail_out&&(K.output=new V.Buf8(G),K.next_out=0,K.avail_out=G),(he=v.inflate(K,xe.Z_NO_FLUSH))===xe.Z_NEED_DICT&&D&&(ce="string"==typeof D?Le.string2buf(D):"[object ArrayBuffer]"===ot.call(D)?new Uint8Array(D):D,he=v.inflateSetDictionary(this.strm,ce)),he===xe.Z_BUF_ERROR&&!0===x&&(he=xe.Z_OK,x=!1),he!==xe.Z_STREAM_END&&he!==xe.Z_OK)return this.onEnd(he),!(this.ended=!0);K.next_out&&(0!==K.avail_out&&he!==xe.Z_STREAM_END&&(0!==K.avail_in||re!==xe.Z_FINISH&&re!==xe.Z_SYNC_FLUSH)||("string"===this.options.to?(fe=Le.utf8border(K.output,K.next_out),de=K.next_out-fe,pe=Le.buf2string(K.output,fe),K.next_out=de,K.avail_out=G-de,de&&V.arraySet(K.output,K.output,fe,de,0),this.onData(pe)):this.onData(V.shrinkBuf(K.output,K.next_out)))),0===K.avail_in&&0===K.avail_out&&(x=!0)}while((0<K.avail_in||0===K.avail_out)&&he!==xe.Z_STREAM_END);return he===xe.Z_STREAM_END&&(re=xe.Z_FINISH),re===xe.Z_FINISH?(he=v.inflateEnd(this.strm),this.onEnd(he),this.ended=!0,he===xe.Z_OK):re!==xe.Z_SYNC_FLUSH||(this.onEnd(xe.Z_OK),!(K.avail_out=0))},Re.prototype.onData=function(Ie){this.chunks.push(Ie)},Re.prototype.onEnd=function(Ie){Ie===xe.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):V.flattenChunks(this.chunks)),this.chunks=[],this.err=Ie,this.msg=this.strm.msg},be.Inflate=Re,be.inflate=Qe,be.inflateRaw=function(Ie,L){return(L=L||{}).raw=!0,Qe(Ie,L)},be.ungzip=Qe},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(xt,Te,be){"use strict";var v=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";be.assign=function(xe){for(var Je=Array.prototype.slice.call(arguments,1);Je.length;){var st=Je.shift();if(st){if("object"!=typeof st)throw new TypeError(st+"must be non-object");for(var Ke in st)st.hasOwnProperty(Ke)&&(xe[Ke]=st[Ke])}}return xe},be.shrinkBuf=function(xe,Je){return xe.length===Je?xe:xe.subarray?xe.subarray(0,Je):(xe.length=Je,xe)};var V={arraySet:function(xe,Je,st,Ke,ot){if(Je.subarray&&xe.subarray)xe.set(Je.subarray(st,st+Ke),ot);else for(var Re=0;Re<Ke;Re++)xe[ot+Re]=Je[st+Re]},flattenChunks:function(xe){var Je,st,Ke,ot,Re,Qe;for(Je=Ke=0,st=xe.length;Je<st;Je++)Ke+=xe[Je].length;for(Qe=new Uint8Array(Ke),Je=ot=0,st=xe.length;Je<st;Je++)Qe.set(Re=xe[Je],ot),ot+=Re.length;return Qe}},Le={arraySet:function(xe,Je,st,Ke,ot){for(var Re=0;Re<Ke;Re++)xe[ot+Re]=Je[st+Re]},flattenChunks:function(xe){return[].concat.apply([],xe)}};be.setTyped=function(xe){xe?(be.Buf8=Uint8Array,be.Buf16=Uint16Array,be.Buf32=Int32Array,be.assign(be,V)):(be.Buf8=Array,be.Buf16=Array,be.Buf32=Array,be.assign(be,Le))},be.setTyped(v)},{}],42:[function(xt,Te,be){"use strict";var v=xt("./common"),V=!0,Le=!0;try{String.fromCharCode.apply(null,[0])}catch{V=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Le=!1}for(var xe=new v.Buf8(256),Je=0;Je<256;Je++)xe[Je]=252<=Je?6:248<=Je?5:240<=Je?4:224<=Je?3:192<=Je?2:1;function st(Ke,ot){if(ot<65537&&(Ke.subarray&&Le||!Ke.subarray&&V))return String.fromCharCode.apply(null,v.shrinkBuf(Ke,ot));for(var Re="",Qe=0;Qe<ot;Qe++)Re+=String.fromCharCode(Ke[Qe]);return Re}xe[254]=xe[254]=1,be.string2buf=function(Ke){var ot,Re,Qe,Ie,L,he=Ke.length,re=0;for(Ie=0;Ie<he;Ie++)55296==(64512&(Re=Ke.charCodeAt(Ie)))&&Ie+1<he&&56320==(64512&(Qe=Ke.charCodeAt(Ie+1)))&&(Re=65536+(Re-55296<<10)+(Qe-56320),Ie++),re+=Re<128?1:Re<2048?2:Re<65536?3:4;for(ot=new v.Buf8(re),Ie=L=0;L<re;Ie++)55296==(64512&(Re=Ke.charCodeAt(Ie)))&&Ie+1<he&&56320==(64512&(Qe=Ke.charCodeAt(Ie+1)))&&(Re=65536+(Re-55296<<10)+(Qe-56320),Ie++),Re<128?ot[L++]=Re:(Re<2048?ot[L++]=192|Re>>>6:(Re<65536?ot[L++]=224|Re>>>12:(ot[L++]=240|Re>>>18,ot[L++]=128|Re>>>12&63),ot[L++]=128|Re>>>6&63),ot[L++]=128|63&Re);return ot},be.buf2binstring=function(Ke){return st(Ke,Ke.length)},be.binstring2buf=function(Ke){for(var ot=new v.Buf8(Ke.length),Re=0,Qe=ot.length;Re<Qe;Re++)ot[Re]=Ke.charCodeAt(Re);return ot},be.buf2string=function(Ke,ot){var Re,Qe,Ie,L,he=ot||Ke.length,re=new Array(2*he);for(Re=Qe=0;Re<he;)if((Ie=Ke[Re++])<128)re[Qe++]=Ie;else if(4<(L=xe[Ie]))re[Qe++]=65533,Re+=L-1;else{for(Ie&=2===L?31:3===L?15:7;1<L&&Re<he;)Ie=Ie<<6|63&Ke[Re++],L--;1<L?re[Qe++]=65533:Ie<65536?re[Qe++]=Ie:(re[Qe++]=55296|(Ie-=65536)>>10&1023,re[Qe++]=56320|1023&Ie)}return st(re,Qe)},be.utf8border=function(Ke,ot){var Re;for((ot=ot||Ke.length)>Ke.length&&(ot=Ke.length),Re=ot-1;0<=Re&&128==(192&Ke[Re]);)Re--;return Re<0||0===Re?ot:Re+xe[Ke[Re]]>ot?Re:ot}},{"./common":41}],43:[function(xt,Te,be){"use strict";Te.exports=function(v,V,Le,xe){for(var Je=65535&v,st=v>>>16&65535,Ke=0;0!==Le;){for(Le-=Ke=2e3<Le?2e3:Le;st=st+(Je=Je+V[xe++]|0)|0,--Ke;);Je%=65521,st%=65521}return Je|st<<16}},{}],44:[function(xt,Te,be){"use strict";Te.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(xt,Te,be){"use strict";var v=function(){for(var V,Le=[],xe=0;xe<256;xe++){V=xe;for(var Je=0;Je<8;Je++)V=1&V?3988292384^V>>>1:V>>>1;Le[xe]=V}return Le}();Te.exports=function(V,Le,xe,Je){var st=v,Ke=Je+xe;V^=-1;for(var ot=Je;ot<Ke;ot++)V=V>>>8^st[255&(V^Le[ot])];return~V}},{}],46:[function(xt,Te,be){"use strict";var v,V=xt("../utils/common"),Le=xt("./trees"),xe=xt("./adler32"),Je=xt("./crc32"),st=xt("./messages"),Ke=0,Re=0,Qe=-2,he=2,re=8,de=286,pe=30,ce=19,K=2*de+1,G=15,D=3,x=258,P=x+D+1,w=42,b=113;function H($,tt){return $.msg=st[tt],tt}function X($){return($<<1)-(4<$?9:0)}function ie($){for(var tt=$.length;0<=--tt;)$[tt]=0}function z($){var tt=$.state,We=tt.pending;We>$.avail_out&&(We=$.avail_out),0!==We&&(V.arraySet($.output,tt.pending_buf,tt.pending_out,We,$.next_out),$.next_out+=We,tt.pending_out+=We,$.total_out+=We,$.avail_out-=We,tt.pending-=We,0===tt.pending&&(tt.pending_out=0))}function m($,tt){Le._tr_flush_block($,0<=$.block_start?$.block_start:-1,$.strstart-$.block_start,tt),$.block_start=$.strstart,z($.strm)}function I($,tt){$.pending_buf[$.pending++]=tt}function A($,tt){$.pending_buf[$.pending++]=tt>>>8&255,$.pending_buf[$.pending++]=255&tt}function R($,tt){var We,Ne,Fe=$.max_chain_length,ht=$.strstart,pt=$.prev_length,dt=$.nice_match,rt=$.strstart>$.w_size-P?$.strstart-($.w_size-P):0,_t=$.window,Yt=$.w_mask,kt=$.prev,Tt=$.strstart+x,fn=_t[ht+pt-1],ln=_t[ht+pt];$.prev_length>=$.good_match&&(Fe>>=2),dt>$.lookahead&&(dt=$.lookahead);do{if(_t[(We=tt)+pt]===ln&&_t[We+pt-1]===fn&&_t[We]===_t[ht]&&_t[++We]===_t[ht+1]){ht+=2,We++;do{}while(_t[++ht]===_t[++We]&&_t[++ht]===_t[++We]&&_t[++ht]===_t[++We]&&_t[++ht]===_t[++We]&&_t[++ht]===_t[++We]&&_t[++ht]===_t[++We]&&_t[++ht]===_t[++We]&&_t[++ht]===_t[++We]&&ht<Tt);if(Ne=x-(Tt-ht),ht=Tt-x,pt<Ne){if($.match_start=tt,dt<=(pt=Ne))break;fn=_t[ht+pt-1],ln=_t[ht+pt]}}}while((tt=kt[tt&Yt])>rt&&0!=--Fe);return pt<=$.lookahead?pt:$.lookahead}function k($){var tt,We,Ne,Fe,ht,pt,dt,rt,_t,Yt,kt=$.w_size;do{if(Fe=$.window_size-$.lookahead-$.strstart,$.strstart>=kt+(kt-P)){for(V.arraySet($.window,$.window,kt,kt,0),$.match_start-=kt,$.strstart-=kt,$.block_start-=kt,tt=We=$.hash_size;Ne=$.head[--tt],$.head[tt]=kt<=Ne?Ne-kt:0,--We;);for(tt=We=kt;Ne=$.prev[--tt],$.prev[tt]=kt<=Ne?Ne-kt:0,--We;);Fe+=kt}if(0===$.strm.avail_in)break;if(dt=$.window,rt=$.strstart+$.lookahead,Yt=void 0,(_t=Fe)<(Yt=(pt=$.strm).avail_in)&&(Yt=_t),We=0===Yt?0:(pt.avail_in-=Yt,V.arraySet(dt,pt.input,pt.next_in,Yt,rt),1===pt.state.wrap?pt.adler=xe(pt.adler,dt,Yt,rt):2===pt.state.wrap&&(pt.adler=Je(pt.adler,dt,Yt,rt)),pt.next_in+=Yt,pt.total_in+=Yt,Yt),$.lookahead+=We,$.lookahead+$.insert>=D)for($.ins_h=$.window[ht=$.strstart-$.insert],$.ins_h=($.ins_h<<$.hash_shift^$.window[ht+1])&$.hash_mask;$.insert&&($.ins_h=($.ins_h<<$.hash_shift^$.window[ht+D-1])&$.hash_mask,$.prev[ht&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=ht,ht++,$.insert--,!($.lookahead+$.insert<D)););}while($.lookahead<P&&0!==$.strm.avail_in)}function ee($,tt){for(var We,Ne;;){if($.lookahead<P){if(k($),$.lookahead<P&&tt===Ke)return 1;if(0===$.lookahead)break}if(We=0,$.lookahead>=D&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+D-1])&$.hash_mask,We=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),0!==We&&$.strstart-We<=$.w_size-P&&($.match_length=R($,We)),$.match_length>=D)if(Ne=Le._tr_tally($,$.strstart-$.match_start,$.match_length-D),$.lookahead-=$.match_length,$.match_length<=$.max_lazy_match&&$.lookahead>=D){for($.match_length--;$.strstart++,$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+D-1])&$.hash_mask,We=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart,0!=--$.match_length;);$.strstart++}else $.strstart+=$.match_length,$.match_length=0,$.ins_h=$.window[$.strstart],$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+1])&$.hash_mask;else Ne=Le._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++;if(Ne&&(m($,!1),0===$.strm.avail_out))return 1}return $.insert=$.strstart<D-1?$.strstart:D-1,4===tt?(m($,!0),0===$.strm.avail_out?3:4):$.last_lit&&(m($,!1),0===$.strm.avail_out)?1:2}function ge($,tt){for(var We,Ne,Fe;;){if($.lookahead<P){if(k($),$.lookahead<P&&tt===Ke)return 1;if(0===$.lookahead)break}if(We=0,$.lookahead>=D&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+D-1])&$.hash_mask,We=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),$.prev_length=$.match_length,$.prev_match=$.match_start,$.match_length=D-1,0!==We&&$.prev_length<$.max_lazy_match&&$.strstart-We<=$.w_size-P&&($.match_length=R($,We),$.match_length<=5&&(1===$.strategy||$.match_length===D&&4096<$.strstart-$.match_start)&&($.match_length=D-1)),$.prev_length>=D&&$.match_length<=$.prev_length){for(Fe=$.strstart+$.lookahead-D,Ne=Le._tr_tally($,$.strstart-1-$.prev_match,$.prev_length-D),$.lookahead-=$.prev_length-1,$.prev_length-=2;++$.strstart<=Fe&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+D-1])&$.hash_mask,We=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),0!=--$.prev_length;);if($.match_available=0,$.match_length=D-1,$.strstart++,Ne&&(m($,!1),0===$.strm.avail_out))return 1}else if($.match_available){if((Ne=Le._tr_tally($,0,$.window[$.strstart-1]))&&m($,!1),$.strstart++,$.lookahead--,0===$.strm.avail_out)return 1}else $.match_available=1,$.strstart++,$.lookahead--}return $.match_available&&(Ne=Le._tr_tally($,0,$.window[$.strstart-1]),$.match_available=0),$.insert=$.strstart<D-1?$.strstart:D-1,4===tt?(m($,!0),0===$.strm.avail_out?3:4):$.last_lit&&(m($,!1),0===$.strm.avail_out)?1:2}function ve($,tt,We,Ne,Fe){this.good_length=$,this.max_lazy=tt,this.nice_length=We,this.max_chain=Ne,this.func=Fe}function Se(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=re,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new V.Buf16(2*K),this.dyn_dtree=new V.Buf16(2*(2*pe+1)),this.bl_tree=new V.Buf16(2*(2*ce+1)),ie(this.dyn_ltree),ie(this.dyn_dtree),ie(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new V.Buf16(G+1),this.heap=new V.Buf16(2*de+1),ie(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new V.Buf16(2*de+1),ie(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function De($){var tt;return $&&$.state?($.total_in=$.total_out=0,$.data_type=he,(tt=$.state).pending=0,tt.pending_out=0,tt.wrap<0&&(tt.wrap=-tt.wrap),tt.status=tt.wrap?w:b,$.adler=2===tt.wrap?0:1,tt.last_flush=Ke,Le._tr_init(tt),Re):H($,Qe)}function Xe($){var We,tt=De($);return tt===Re&&((We=$.state).window_size=2*We.w_size,ie(We.head),We.max_lazy_match=v[We.level].max_lazy,We.good_match=v[We.level].good_length,We.nice_match=v[We.level].nice_length,We.max_chain_length=v[We.level].max_chain,We.strstart=0,We.block_start=0,We.lookahead=0,We.insert=0,We.match_length=We.prev_length=D-1,We.match_available=0,We.ins_h=0),tt}function ct($,tt,We,Ne,Fe,ht){if(!$)return Qe;var pt=1;if(-1===tt&&(tt=6),Ne<0?(pt=0,Ne=-Ne):15<Ne&&(pt=2,Ne-=16),Fe<1||9<Fe||We!==re||Ne<8||15<Ne||tt<0||9<tt||ht<0||4<ht)return H($,Qe);8===Ne&&(Ne=9);var dt=new Se;return($.state=dt).strm=$,dt.wrap=pt,dt.gzhead=null,dt.w_bits=Ne,dt.w_size=1<<dt.w_bits,dt.w_mask=dt.w_size-1,dt.hash_bits=Fe+7,dt.hash_size=1<<dt.hash_bits,dt.hash_mask=dt.hash_size-1,dt.hash_shift=~~((dt.hash_bits+D-1)/D),dt.window=new V.Buf8(2*dt.w_size),dt.head=new V.Buf16(dt.hash_size),dt.prev=new V.Buf16(dt.w_size),dt.lit_bufsize=1<<Fe+6,dt.pending_buf_size=4*dt.lit_bufsize,dt.pending_buf=new V.Buf8(dt.pending_buf_size),dt.d_buf=1*dt.lit_bufsize,dt.l_buf=3*dt.lit_bufsize,dt.level=tt,dt.strategy=ht,dt.method=We,Xe($)}v=[new ve(0,0,0,0,function($,tt){var We=65535;for(We>$.pending_buf_size-5&&(We=$.pending_buf_size-5);;){if($.lookahead<=1){if(k($),0===$.lookahead&&tt===Ke)return 1;if(0===$.lookahead)break}$.strstart+=$.lookahead,$.lookahead=0;var Ne=$.block_start+We;if((0===$.strstart||$.strstart>=Ne)&&($.lookahead=$.strstart-Ne,$.strstart=Ne,m($,!1),0===$.strm.avail_out)||$.strstart-$.block_start>=$.w_size-P&&(m($,!1),0===$.strm.avail_out))return 1}return $.insert=0,4===tt?(m($,!0),0===$.strm.avail_out?3:4):($.strstart>$.block_start&&m($,!1),1)}),new ve(4,4,8,4,ee),new ve(4,5,16,8,ee),new ve(4,6,32,32,ee),new ve(4,4,16,16,ge),new ve(8,16,32,32,ge),new ve(8,16,128,128,ge),new ve(8,32,128,256,ge),new ve(32,128,258,1024,ge),new ve(32,258,258,4096,ge)],be.deflateInit=function($,tt){return ct($,tt,re,15,8,0)},be.deflateInit2=ct,be.deflateReset=Xe,be.deflateResetKeep=De,be.deflateSetHeader=function($,tt){return $&&$.state?2!==$.state.wrap?Qe:($.state.gzhead=tt,Re):Qe},be.deflate=function($,tt){var We,Ne,Fe,ht;if(!$||!$.state||5<tt||tt<0)return $?H($,Qe):Qe;if(Ne=$.state,!$.output||!$.input&&0!==$.avail_in||666===Ne.status&&4!==tt)return H($,0===$.avail_out?-5:Qe);if(Ne.strm=$,We=Ne.last_flush,Ne.last_flush=tt,Ne.status===w)if(2===Ne.wrap)$.adler=0,I(Ne,31),I(Ne,139),I(Ne,8),Ne.gzhead?(I(Ne,(Ne.gzhead.text?1:0)+(Ne.gzhead.hcrc?2:0)+(Ne.gzhead.extra?4:0)+(Ne.gzhead.name?8:0)+(Ne.gzhead.comment?16:0)),I(Ne,255&Ne.gzhead.time),I(Ne,Ne.gzhead.time>>8&255),I(Ne,Ne.gzhead.time>>16&255),I(Ne,Ne.gzhead.time>>24&255),I(Ne,9===Ne.level?2:2<=Ne.strategy||Ne.level<2?4:0),I(Ne,255&Ne.gzhead.os),Ne.gzhead.extra&&Ne.gzhead.extra.length&&(I(Ne,255&Ne.gzhead.extra.length),I(Ne,Ne.gzhead.extra.length>>8&255)),Ne.gzhead.hcrc&&($.adler=Je($.adler,Ne.pending_buf,Ne.pending,0)),Ne.gzindex=0,Ne.status=69):(I(Ne,0),I(Ne,0),I(Ne,0),I(Ne,0),I(Ne,0),I(Ne,9===Ne.level?2:2<=Ne.strategy||Ne.level<2?4:0),I(Ne,3),Ne.status=b);else{var pt=re+(Ne.w_bits-8<<4)<<8;pt|=(2<=Ne.strategy||Ne.level<2?0:Ne.level<6?1:6===Ne.level?2:3)<<6,0!==Ne.strstart&&(pt|=32),pt+=31-pt%31,Ne.status=b,A(Ne,pt),0!==Ne.strstart&&(A(Ne,$.adler>>>16),A(Ne,65535&$.adler)),$.adler=1}if(69===Ne.status)if(Ne.gzhead.extra){for(Fe=Ne.pending;Ne.gzindex<(65535&Ne.gzhead.extra.length)&&(Ne.pending!==Ne.pending_buf_size||(Ne.gzhead.hcrc&&Ne.pending>Fe&&($.adler=Je($.adler,Ne.pending_buf,Ne.pending-Fe,Fe)),z($),Fe=Ne.pending,Ne.pending!==Ne.pending_buf_size));)I(Ne,255&Ne.gzhead.extra[Ne.gzindex]),Ne.gzindex++;Ne.gzhead.hcrc&&Ne.pending>Fe&&($.adler=Je($.adler,Ne.pending_buf,Ne.pending-Fe,Fe)),Ne.gzindex===Ne.gzhead.extra.length&&(Ne.gzindex=0,Ne.status=73)}else Ne.status=73;if(73===Ne.status)if(Ne.gzhead.name){Fe=Ne.pending;do{if(Ne.pending===Ne.pending_buf_size&&(Ne.gzhead.hcrc&&Ne.pending>Fe&&($.adler=Je($.adler,Ne.pending_buf,Ne.pending-Fe,Fe)),z($),Fe=Ne.pending,Ne.pending===Ne.pending_buf_size)){ht=1;break}ht=Ne.gzindex<Ne.gzhead.name.length?255&Ne.gzhead.name.charCodeAt(Ne.gzindex++):0,I(Ne,ht)}while(0!==ht);Ne.gzhead.hcrc&&Ne.pending>Fe&&($.adler=Je($.adler,Ne.pending_buf,Ne.pending-Fe,Fe)),0===ht&&(Ne.gzindex=0,Ne.status=91)}else Ne.status=91;if(91===Ne.status)if(Ne.gzhead.comment){Fe=Ne.pending;do{if(Ne.pending===Ne.pending_buf_size&&(Ne.gzhead.hcrc&&Ne.pending>Fe&&($.adler=Je($.adler,Ne.pending_buf,Ne.pending-Fe,Fe)),z($),Fe=Ne.pending,Ne.pending===Ne.pending_buf_size)){ht=1;break}ht=Ne.gzindex<Ne.gzhead.comment.length?255&Ne.gzhead.comment.charCodeAt(Ne.gzindex++):0,I(Ne,ht)}while(0!==ht);Ne.gzhead.hcrc&&Ne.pending>Fe&&($.adler=Je($.adler,Ne.pending_buf,Ne.pending-Fe,Fe)),0===ht&&(Ne.status=103)}else Ne.status=103;if(103===Ne.status&&(Ne.gzhead.hcrc?(Ne.pending+2>Ne.pending_buf_size&&z($),Ne.pending+2<=Ne.pending_buf_size&&(I(Ne,255&$.adler),I(Ne,$.adler>>8&255),$.adler=0,Ne.status=b)):Ne.status=b),0!==Ne.pending){if(z($),0===$.avail_out)return Ne.last_flush=-1,Re}else if(0===$.avail_in&&X(tt)<=X(We)&&4!==tt)return H($,-5);if(666===Ne.status&&0!==$.avail_in)return H($,-5);if(0!==$.avail_in||0!==Ne.lookahead||tt!==Ke&&666!==Ne.status){var dt=2===Ne.strategy?function(rt,_t){for(var Yt;;){if(0===rt.lookahead&&(k(rt),0===rt.lookahead)){if(_t===Ke)return 1;break}if(rt.match_length=0,Yt=Le._tr_tally(rt,0,rt.window[rt.strstart]),rt.lookahead--,rt.strstart++,Yt&&(m(rt,!1),0===rt.strm.avail_out))return 1}return rt.insert=0,4===_t?(m(rt,!0),0===rt.strm.avail_out?3:4):rt.last_lit&&(m(rt,!1),0===rt.strm.avail_out)?1:2}(Ne,tt):3===Ne.strategy?function(rt,_t){for(var Yt,kt,Tt,fn,ln=rt.window;;){if(rt.lookahead<=x){if(k(rt),rt.lookahead<=x&&_t===Ke)return 1;if(0===rt.lookahead)break}if(rt.match_length=0,rt.lookahead>=D&&0<rt.strstart&&(kt=ln[Tt=rt.strstart-1])===ln[++Tt]&&kt===ln[++Tt]&&kt===ln[++Tt]){fn=rt.strstart+x;do{}while(kt===ln[++Tt]&&kt===ln[++Tt]&&kt===ln[++Tt]&&kt===ln[++Tt]&&kt===ln[++Tt]&&kt===ln[++Tt]&&kt===ln[++Tt]&&kt===ln[++Tt]&&Tt<fn);rt.match_length=x-(fn-Tt),rt.match_length>rt.lookahead&&(rt.match_length=rt.lookahead)}if(rt.match_length>=D?(Yt=Le._tr_tally(rt,1,rt.match_length-D),rt.lookahead-=rt.match_length,rt.strstart+=rt.match_length,rt.match_length=0):(Yt=Le._tr_tally(rt,0,rt.window[rt.strstart]),rt.lookahead--,rt.strstart++),Yt&&(m(rt,!1),0===rt.strm.avail_out))return 1}return rt.insert=0,4===_t?(m(rt,!0),0===rt.strm.avail_out?3:4):rt.last_lit&&(m(rt,!1),0===rt.strm.avail_out)?1:2}(Ne,tt):v[Ne.level].func(Ne,tt);if(3!==dt&&4!==dt||(Ne.status=666),1===dt||3===dt)return 0===$.avail_out&&(Ne.last_flush=-1),Re;if(2===dt&&(1===tt?Le._tr_align(Ne):5!==tt&&(Le._tr_stored_block(Ne,0,0,!1),3===tt&&(ie(Ne.head),0===Ne.lookahead&&(Ne.strstart=0,Ne.block_start=0,Ne.insert=0))),z($),0===$.avail_out))return Ne.last_flush=-1,Re}return 4!==tt?Re:Ne.wrap<=0?1:(2===Ne.wrap?(I(Ne,255&$.adler),I(Ne,$.adler>>8&255),I(Ne,$.adler>>16&255),I(Ne,$.adler>>24&255),I(Ne,255&$.total_in),I(Ne,$.total_in>>8&255),I(Ne,$.total_in>>16&255),I(Ne,$.total_in>>24&255)):(A(Ne,$.adler>>>16),A(Ne,65535&$.adler)),z($),0<Ne.wrap&&(Ne.wrap=-Ne.wrap),0!==Ne.pending?Re:1)},be.deflateEnd=function($){var tt;return $&&$.state?(tt=$.state.status)!==w&&69!==tt&&73!==tt&&91!==tt&&103!==tt&&tt!==b&&666!==tt?H($,Qe):($.state=null,tt===b?H($,-3):Re):Qe},be.deflateSetDictionary=function($,tt){var We,Ne,Fe,ht,pt,dt,rt,_t,Yt=tt.length;if(!$||!$.state||2===(ht=(We=$.state).wrap)||1===ht&&We.status!==w||We.lookahead)return Qe;for(1===ht&&($.adler=xe($.adler,tt,Yt,0)),We.wrap=0,Yt>=We.w_size&&(0===ht&&(ie(We.head),We.strstart=0,We.block_start=0,We.insert=0),_t=new V.Buf8(We.w_size),V.arraySet(_t,tt,Yt-We.w_size,We.w_size,0),tt=_t,Yt=We.w_size),pt=$.avail_in,dt=$.next_in,rt=$.input,$.avail_in=Yt,$.next_in=0,$.input=tt,k(We);We.lookahead>=D;){for(Ne=We.strstart,Fe=We.lookahead-(D-1);We.ins_h=(We.ins_h<<We.hash_shift^We.window[Ne+D-1])&We.hash_mask,We.prev[Ne&We.w_mask]=We.head[We.ins_h],We.head[We.ins_h]=Ne,Ne++,--Fe;);We.strstart=Ne,We.lookahead=D-1,k(We)}return We.strstart+=We.lookahead,We.block_start=We.strstart,We.insert=We.lookahead,We.lookahead=0,We.match_length=We.prev_length=D-1,We.match_available=0,$.next_in=dt,$.input=rt,$.avail_in=pt,We.wrap=ht,Re},be.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(xt,Te,be){"use strict";Te.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(xt,Te,be){"use strict";Te.exports=function(v,V){var Le,xe,Je,st,Ke,ot,Re,Qe,Ie,L,he,re,fe,de,pe,ce,K,G,D,x,P,w,b,g,C;g=v.input,Je=(xe=v.next_in)+(v.avail_in-5),C=v.output,Ke=(st=v.next_out)-(V-v.avail_out),ot=st+(v.avail_out-257),Re=(Le=v.state).dmax,Qe=Le.wsize,Ie=Le.whave,L=Le.wnext,he=Le.window,re=Le.hold,fe=Le.bits,de=Le.lencode,pe=Le.distcode,ce=(1<<Le.lenbits)-1,K=(1<<Le.distbits)-1;e:do{fe<15&&(re+=g[xe++]<<fe,re+=g[xe++]<<(fe+=8),fe+=8),G=de[re&ce];t:for(;;){if(re>>>=D=G>>>24,fe-=D,0==(D=G>>>16&255))C[st++]=65535&G;else{if(!(16&D)){if(!(64&D)){G=de[(65535&G)+(re&(1<<D)-1)];continue t}if(32&D){Le.mode=12;break e}v.msg="invalid literal/length code",Le.mode=30;break e}x=65535&G,(D&=15)&&(fe<D&&(re+=g[xe++]<<fe,fe+=8),x+=re&(1<<D)-1,re>>>=D,fe-=D),fe<15&&(re+=g[xe++]<<fe,re+=g[xe++]<<(fe+=8),fe+=8),G=pe[re&K];n:for(;;){if(re>>>=D=G>>>24,fe-=D,!(16&(D=G>>>16&255))){if(!(64&D)){G=pe[(65535&G)+(re&(1<<D)-1)];continue n}v.msg="invalid distance code",Le.mode=30;break e}if(P=65535&G,fe<(D&=15)&&(re+=g[xe++]<<fe,(fe+=8)<D&&(re+=g[xe++]<<fe,fe+=8)),Re<(P+=re&(1<<D)-1)){v.msg="invalid distance too far back",Le.mode=30;break e}if(re>>>=D,fe-=D,(D=st-Ke)<P){if(Ie<(D=P-D)&&Le.sane){v.msg="invalid distance too far back",Le.mode=30;break e}if(b=he,(w=0)===L){if(w+=Qe-D,D<x){for(x-=D;C[st++]=he[w++],--D;);w=st-P,b=C}}else if(L<D){if(w+=Qe+L-D,(D-=L)<x){for(x-=D;C[st++]=he[w++],--D;);if(w=0,L<x){for(x-=D=L;C[st++]=he[w++],--D;);w=st-P,b=C}}}else if(w+=L-D,D<x){for(x-=D;C[st++]=he[w++],--D;);w=st-P,b=C}for(;2<x;)C[st++]=b[w++],C[st++]=b[w++],C[st++]=b[w++],x-=3;x&&(C[st++]=b[w++],1<x&&(C[st++]=b[w++]))}else{for(w=st-P;C[st++]=C[w++],C[st++]=C[w++],C[st++]=C[w++],2<(x-=3););x&&(C[st++]=C[w++],1<x&&(C[st++]=C[w++]))}break}}break}}while(xe<Je&&st<ot);xe-=x=fe>>3,re&=(1<<(fe-=x<<3))-1,v.next_in=xe,v.next_out=st,v.avail_in=xe<Je?Je-xe+5:5-(xe-Je),v.avail_out=st<ot?ot-st+257:257-(st-ot),Le.hold=re,Le.bits=fe}},{}],49:[function(xt,Te,be){"use strict";var v=xt("../utils/common"),V=xt("./adler32"),Le=xt("./crc32"),xe=xt("./inffast"),Je=xt("./inftrees"),ot=0,Re=-2,Qe=1,Ie=852,L=592;function he(w){return(w>>>24&255)+(w>>>8&65280)+((65280&w)<<8)+((255&w)<<24)}function re(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new v.Buf16(320),this.work=new v.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function fe(w){var b;return w&&w.state?(w.total_in=w.total_out=(b=w.state).total=0,w.msg="",b.wrap&&(w.adler=1&b.wrap),b.mode=Qe,b.last=0,b.havedict=0,b.dmax=32768,b.head=null,b.hold=0,b.bits=0,b.lencode=b.lendyn=new v.Buf32(Ie),b.distcode=b.distdyn=new v.Buf32(L),b.sane=1,b.back=-1,ot):Re}function de(w){var b;return w&&w.state?((b=w.state).wsize=0,b.whave=0,b.wnext=0,fe(w)):Re}function pe(w,b){var g,C;return w&&w.state?(C=w.state,b<0?(g=0,b=-b):(g=1+(b>>4),b<48&&(b&=15)),b&&(b<8||15<b)?Re:(null!==C.window&&C.wbits!==b&&(C.window=null),C.wrap=g,C.wbits=b,de(w))):Re}function ce(w,b){var g,C;return w?(C=new re,(w.state=C).window=null,(g=pe(w,b))!==ot&&(w.state=null),g):Re}var K,G,D=!0;function x(w){if(D){var b;for(K=new v.Buf32(512),G=new v.Buf32(32),b=0;b<144;)w.lens[b++]=8;for(;b<256;)w.lens[b++]=9;for(;b<280;)w.lens[b++]=7;for(;b<288;)w.lens[b++]=8;for(Je(1,w.lens,0,288,K,0,w.work,{bits:9}),b=0;b<32;)w.lens[b++]=5;Je(2,w.lens,0,32,G,0,w.work,{bits:5}),D=!1}w.lencode=K,w.lenbits=9,w.distcode=G,w.distbits=5}function P(w,b,g,C){var N,O=w.state;return null===O.window&&(O.wsize=1<<O.wbits,O.wnext=0,O.whave=0,O.window=new v.Buf8(O.wsize)),C>=O.wsize?(v.arraySet(O.window,b,g-O.wsize,O.wsize,0),O.wnext=0,O.whave=O.wsize):(C<(N=O.wsize-O.wnext)&&(N=C),v.arraySet(O.window,b,g-C,N,O.wnext),(C-=N)?(v.arraySet(O.window,b,g-C,C,0),O.wnext=C,O.whave=O.wsize):(O.wnext+=N,O.wnext===O.wsize&&(O.wnext=0),O.whave<O.wsize&&(O.whave+=N))),0}be.inflateReset=de,be.inflateReset2=pe,be.inflateResetKeep=fe,be.inflateInit=function(w){return ce(w,15)},be.inflateInit2=ce,be.inflate=function(w,b){var g,C,N,O,H,X,ie,z,m,I,A,R,k,ee,ge,ve,Se,De,Xe,ct,$,tt,We,Ne,Fe=0,ht=new v.Buf8(4),pt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!w||!w.state||!w.output||!w.input&&0!==w.avail_in)return Re;12===(g=w.state).mode&&(g.mode=13),H=w.next_out,N=w.output,O=w.next_in,C=w.input,z=g.hold,m=g.bits,I=X=w.avail_in,A=ie=w.avail_out,tt=ot;e:for(;;)switch(g.mode){case Qe:if(0===g.wrap){g.mode=13;break}for(;m<16;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}if(2&g.wrap&&35615===z){ht[g.check=0]=255&z,ht[1]=z>>>8&255,g.check=Le(g.check,ht,2,0),m=z=0,g.mode=2;break}if(g.flags=0,g.head&&(g.head.done=!1),!(1&g.wrap)||(((255&z)<<8)+(z>>8))%31){w.msg="incorrect header check",g.mode=30;break}if(8!=(15&z)){w.msg="unknown compression method",g.mode=30;break}if(m-=4,$=8+(15&(z>>>=4)),0===g.wbits)g.wbits=$;else if($>g.wbits){w.msg="invalid window size",g.mode=30;break}g.dmax=1<<$,w.adler=g.check=1,g.mode=512&z?10:12,m=z=0;break;case 2:for(;m<16;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}if(g.flags=z,8!=(255&g.flags)){w.msg="unknown compression method",g.mode=30;break}if(57344&g.flags){w.msg="unknown header flags set",g.mode=30;break}g.head&&(g.head.text=z>>8&1),512&g.flags&&(ht[0]=255&z,ht[1]=z>>>8&255,g.check=Le(g.check,ht,2,0)),m=z=0,g.mode=3;case 3:for(;m<32;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}g.head&&(g.head.time=z),512&g.flags&&(ht[0]=255&z,ht[1]=z>>>8&255,ht[2]=z>>>16&255,ht[3]=z>>>24&255,g.check=Le(g.check,ht,4,0)),m=z=0,g.mode=4;case 4:for(;m<16;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}g.head&&(g.head.xflags=255&z,g.head.os=z>>8),512&g.flags&&(ht[0]=255&z,ht[1]=z>>>8&255,g.check=Le(g.check,ht,2,0)),m=z=0,g.mode=5;case 5:if(1024&g.flags){for(;m<16;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}g.length=z,g.head&&(g.head.extra_len=z),512&g.flags&&(ht[0]=255&z,ht[1]=z>>>8&255,g.check=Le(g.check,ht,2,0)),m=z=0}else g.head&&(g.head.extra=null);g.mode=6;case 6:if(1024&g.flags&&(X<(R=g.length)&&(R=X),R&&(g.head&&($=g.head.extra_len-g.length,g.head.extra||(g.head.extra=new Array(g.head.extra_len)),v.arraySet(g.head.extra,C,O,R,$)),512&g.flags&&(g.check=Le(g.check,C,R,O)),X-=R,O+=R,g.length-=R),g.length))break e;g.length=0,g.mode=7;case 7:if(2048&g.flags){if(0===X)break e;for(R=0;$=C[O+R++],g.head&&$&&g.length<65536&&(g.head.name+=String.fromCharCode($)),$&&R<X;);if(512&g.flags&&(g.check=Le(g.check,C,R,O)),X-=R,O+=R,$)break e}else g.head&&(g.head.name=null);g.length=0,g.mode=8;case 8:if(4096&g.flags){if(0===X)break e;for(R=0;$=C[O+R++],g.head&&$&&g.length<65536&&(g.head.comment+=String.fromCharCode($)),$&&R<X;);if(512&g.flags&&(g.check=Le(g.check,C,R,O)),X-=R,O+=R,$)break e}else g.head&&(g.head.comment=null);g.mode=9;case 9:if(512&g.flags){for(;m<16;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}if(z!==(65535&g.check)){w.msg="header crc mismatch",g.mode=30;break}m=z=0}g.head&&(g.head.hcrc=g.flags>>9&1,g.head.done=!0),w.adler=g.check=0,g.mode=12;break;case 10:for(;m<32;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}w.adler=g.check=he(z),m=z=0,g.mode=11;case 11:if(0===g.havedict)return w.next_out=H,w.avail_out=ie,w.next_in=O,w.avail_in=X,g.hold=z,g.bits=m,2;w.adler=g.check=1,g.mode=12;case 12:if(5===b||6===b)break e;case 13:if(g.last){z>>>=7&m,m-=7&m,g.mode=27;break}for(;m<3;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}switch(g.last=1&z,m-=1,3&(z>>>=1)){case 0:g.mode=14;break;case 1:if(x(g),g.mode=20,6!==b)break;z>>>=2,m-=2;break e;case 2:g.mode=17;break;case 3:w.msg="invalid block type",g.mode=30}z>>>=2,m-=2;break;case 14:for(z>>>=7&m,m-=7&m;m<32;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}if((65535&z)!=(z>>>16^65535)){w.msg="invalid stored block lengths",g.mode=30;break}if(g.length=65535&z,m=z=0,g.mode=15,6===b)break e;case 15:g.mode=16;case 16:if(R=g.length){if(X<R&&(R=X),ie<R&&(R=ie),0===R)break e;v.arraySet(N,C,O,R,H),X-=R,O+=R,ie-=R,H+=R,g.length-=R;break}g.mode=12;break;case 17:for(;m<14;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}if(g.nlen=257+(31&z),m-=5,g.ndist=1+(31&(z>>>=5)),m-=5,g.ncode=4+(15&(z>>>=5)),z>>>=4,m-=4,286<g.nlen||30<g.ndist){w.msg="too many length or distance symbols",g.mode=30;break}g.have=0,g.mode=18;case 18:for(;g.have<g.ncode;){for(;m<3;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}g.lens[pt[g.have++]]=7&z,z>>>=3,m-=3}for(;g.have<19;)g.lens[pt[g.have++]]=0;if(g.lencode=g.lendyn,g.lenbits=7,tt=Je(0,g.lens,0,19,g.lencode,0,g.work,We={bits:g.lenbits}),g.lenbits=We.bits,tt){w.msg="invalid code lengths set",g.mode=30;break}g.have=0,g.mode=19;case 19:for(;g.have<g.nlen+g.ndist;){for(;ve=(Fe=g.lencode[z&(1<<g.lenbits)-1])>>>16&255,Se=65535&Fe,!((ge=Fe>>>24)<=m);){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}if(Se<16)z>>>=ge,m-=ge,g.lens[g.have++]=Se;else{if(16===Se){for(Ne=ge+2;m<Ne;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}if(z>>>=ge,m-=ge,0===g.have){w.msg="invalid bit length repeat",g.mode=30;break}$=g.lens[g.have-1],R=3+(3&z),z>>>=2,m-=2}else if(17===Se){for(Ne=ge+3;m<Ne;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}m-=ge,$=0,R=3+(7&(z>>>=ge)),z>>>=3,m-=3}else{for(Ne=ge+7;m<Ne;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}m-=ge,$=0,R=11+(127&(z>>>=ge)),z>>>=7,m-=7}if(g.have+R>g.nlen+g.ndist){w.msg="invalid bit length repeat",g.mode=30;break}for(;R--;)g.lens[g.have++]=$}}if(30===g.mode)break;if(0===g.lens[256]){w.msg="invalid code -- missing end-of-block",g.mode=30;break}if(g.lenbits=9,tt=Je(1,g.lens,0,g.nlen,g.lencode,0,g.work,We={bits:g.lenbits}),g.lenbits=We.bits,tt){w.msg="invalid literal/lengths set",g.mode=30;break}if(g.distbits=6,g.distcode=g.distdyn,tt=Je(2,g.lens,g.nlen,g.ndist,g.distcode,0,g.work,We={bits:g.distbits}),g.distbits=We.bits,tt){w.msg="invalid distances set",g.mode=30;break}if(g.mode=20,6===b)break e;case 20:g.mode=21;case 21:if(6<=X&&258<=ie){w.next_out=H,w.avail_out=ie,w.next_in=O,w.avail_in=X,g.hold=z,g.bits=m,xe(w,A),H=w.next_out,N=w.output,ie=w.avail_out,O=w.next_in,C=w.input,X=w.avail_in,z=g.hold,m=g.bits,12===g.mode&&(g.back=-1);break}for(g.back=0;ve=(Fe=g.lencode[z&(1<<g.lenbits)-1])>>>16&255,Se=65535&Fe,!((ge=Fe>>>24)<=m);){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}if(ve&&!(240&ve)){for(De=ge,Xe=ve,ct=Se;ve=(Fe=g.lencode[ct+((z&(1<<De+Xe)-1)>>De)])>>>16&255,Se=65535&Fe,!(De+(ge=Fe>>>24)<=m);){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}z>>>=De,m-=De,g.back+=De}if(z>>>=ge,m-=ge,g.back+=ge,g.length=Se,0===ve){g.mode=26;break}if(32&ve){g.back=-1,g.mode=12;break}if(64&ve){w.msg="invalid literal/length code",g.mode=30;break}g.extra=15&ve,g.mode=22;case 22:if(g.extra){for(Ne=g.extra;m<Ne;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}g.length+=z&(1<<g.extra)-1,z>>>=g.extra,m-=g.extra,g.back+=g.extra}g.was=g.length,g.mode=23;case 23:for(;ve=(Fe=g.distcode[z&(1<<g.distbits)-1])>>>16&255,Se=65535&Fe,!((ge=Fe>>>24)<=m);){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}if(!(240&ve)){for(De=ge,Xe=ve,ct=Se;ve=(Fe=g.distcode[ct+((z&(1<<De+Xe)-1)>>De)])>>>16&255,Se=65535&Fe,!(De+(ge=Fe>>>24)<=m);){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}z>>>=De,m-=De,g.back+=De}if(z>>>=ge,m-=ge,g.back+=ge,64&ve){w.msg="invalid distance code",g.mode=30;break}g.offset=Se,g.extra=15&ve,g.mode=24;case 24:if(g.extra){for(Ne=g.extra;m<Ne;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}g.offset+=z&(1<<g.extra)-1,z>>>=g.extra,m-=g.extra,g.back+=g.extra}if(g.offset>g.dmax){w.msg="invalid distance too far back",g.mode=30;break}g.mode=25;case 25:if(0===ie)break e;if(g.offset>(R=A-ie)){if((R=g.offset-R)>g.whave&&g.sane){w.msg="invalid distance too far back",g.mode=30;break}k=R>g.wnext?g.wsize-(R-=g.wnext):g.wnext-R,R>g.length&&(R=g.length),ee=g.window}else ee=N,k=H-g.offset,R=g.length;for(ie<R&&(R=ie),ie-=R,g.length-=R;N[H++]=ee[k++],--R;);0===g.length&&(g.mode=21);break;case 26:if(0===ie)break e;N[H++]=g.length,ie--,g.mode=21;break;case 27:if(g.wrap){for(;m<32;){if(0===X)break e;X--,z|=C[O++]<<m,m+=8}if(w.total_out+=A-=ie,g.total+=A,A&&(w.adler=g.check=g.flags?Le(g.check,N,A,H-A):V(g.check,N,A,H-A)),A=ie,(g.flags?z:he(z))!==g.check){w.msg="incorrect data check",g.mode=30;break}m=z=0}g.mode=28;case 28:if(g.wrap&&g.flags){for(;m<32;){if(0===X)break e;X--,z+=C[O++]<<m,m+=8}if(z!==(4294967295&g.total)){w.msg="incorrect length check",g.mode=30;break}m=z=0}g.mode=29;case 29:tt=1;break e;case 30:tt=-3;break e;case 31:return-4;default:return Re}return w.next_out=H,w.avail_out=ie,w.next_in=O,w.avail_in=X,g.hold=z,g.bits=m,(g.wsize||A!==w.avail_out&&g.mode<30&&(g.mode<27||4!==b))&&P(w,w.output,w.next_out,A-w.avail_out)?(g.mode=31,-4):(A-=w.avail_out,w.total_in+=I-=w.avail_in,w.total_out+=A,g.total+=A,g.wrap&&A&&(w.adler=g.check=g.flags?Le(g.check,N,A,w.next_out-A):V(g.check,N,A,w.next_out-A)),w.data_type=g.bits+(g.last?64:0)+(12===g.mode?128:0)+(20===g.mode||15===g.mode?256:0),(0==I&&0===A||4===b)&&tt===ot&&(tt=-5),tt)},be.inflateEnd=function(w){if(!w||!w.state)return Re;var b=w.state;return b.window&&(b.window=null),w.state=null,ot},be.inflateGetHeader=function(w,b){var g;return w&&w.state&&2&(g=w.state).wrap?((g.head=b).done=!1,ot):Re},be.inflateSetDictionary=function(w,b){var g,C=b.length;return w&&w.state?0!==(g=w.state).wrap&&11!==g.mode?Re:11===g.mode&&V(1,b,C,0)!==g.check?-3:P(w,b,C,C)?(g.mode=31,-4):(g.havedict=1,ot):Re},be.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(xt,Te,be){"use strict";var v=xt("../utils/common"),V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Le=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Je=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Te.exports=function(st,Ke,ot,Re,Qe,Ie,L,he){var re,fe,de,pe,ce,K,G,D,x,P=he.bits,w=0,b=0,g=0,C=0,N=0,O=0,H=0,X=0,ie=0,z=0,m=null,I=0,A=new v.Buf16(16),R=new v.Buf16(16),k=null,ee=0;for(w=0;w<=15;w++)A[w]=0;for(b=0;b<Re;b++)A[Ke[ot+b]]++;for(N=P,C=15;1<=C&&0===A[C];C--);if(C<N&&(N=C),0===C)return Qe[Ie++]=20971520,Qe[Ie++]=20971520,he.bits=1,0;for(g=1;g<C&&0===A[g];g++);for(N<g&&(N=g),w=X=1;w<=15;w++)if(X<<=1,(X-=A[w])<0)return-1;if(0<X&&(0===st||1!==C))return-1;for(R[1]=0,w=1;w<15;w++)R[w+1]=R[w]+A[w];for(b=0;b<Re;b++)0!==Ke[ot+b]&&(L[R[Ke[ot+b]]++]=b);if(K=0===st?(m=k=L,19):1===st?(m=V,I-=257,k=Le,ee-=257,256):(m=xe,k=Je,-1),w=g,ce=Ie,H=b=z=0,de=-1,pe=(ie=1<<(O=N))-1,1===st&&852<ie||2===st&&592<ie)return 1;for(;;){for(G=w-H,x=L[b]<K?(D=0,L[b]):L[b]>K?(D=k[ee+L[b]],m[I+L[b]]):(D=96,0),re=1<<w-H,g=fe=1<<O;Qe[ce+(z>>H)+(fe-=re)]=G<<24|D<<16|x,0!==fe;);for(re=1<<w-1;z&re;)re>>=1;if(0!==re?(z&=re-1,z+=re):z=0,b++,0==--A[w]){if(w===C)break;w=Ke[ot+L[b]]}if(N<w&&(z&pe)!==de){for(0===H&&(H=N),ce+=g,X=1<<(O=w-H);O+H<C&&!((X-=A[O+H])<=0);)O++,X<<=1;if(ie+=1<<O,1===st&&852<ie||2===st&&592<ie)return 1;Qe[de=z&pe]=N<<24|O<<16|ce-Ie}}return 0!==z&&(Qe[ce+z]=w-H<<24|64<<16),he.bits=N,0}},{"../utils/common":41}],51:[function(xt,Te,be){"use strict";Te.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(xt,Te,be){"use strict";var v=xt("../utils/common");function xe(Fe){for(var ht=Fe.length;0<=--ht;)Fe[ht]=0}var L=15,he=16,K=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],G=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],x=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=new Array(576);xe(P);var w=new Array(60);xe(w);var b=new Array(512);xe(b);var g=new Array(256);xe(g);var C=new Array(29);xe(C);var N,O,H,X=new Array(30);function ie(Fe,ht,pt,dt,rt){this.static_tree=Fe,this.extra_bits=ht,this.extra_base=pt,this.elems=dt,this.max_length=rt,this.has_stree=Fe&&Fe.length}function z(Fe,ht){this.dyn_tree=Fe,this.max_code=0,this.stat_desc=ht}function m(Fe){return Fe<256?b[Fe]:b[256+(Fe>>>7)]}function I(Fe,ht){Fe.pending_buf[Fe.pending++]=255&ht,Fe.pending_buf[Fe.pending++]=ht>>>8&255}function A(Fe,ht,pt){Fe.bi_valid>he-pt?(Fe.bi_buf|=ht<<Fe.bi_valid&65535,I(Fe,Fe.bi_buf),Fe.bi_buf=ht>>he-Fe.bi_valid,Fe.bi_valid+=pt-he):(Fe.bi_buf|=ht<<Fe.bi_valid&65535,Fe.bi_valid+=pt)}function R(Fe,ht,pt){A(Fe,pt[2*ht],pt[2*ht+1])}function k(Fe,ht){for(var pt=0;pt|=1&Fe,Fe>>>=1,pt<<=1,0<--ht;);return pt>>>1}function ee(Fe,ht,pt){var dt,rt,_t=new Array(L+1),Yt=0;for(dt=1;dt<=L;dt++)_t[dt]=Yt=Yt+pt[dt-1]<<1;for(rt=0;rt<=ht;rt++){var kt=Fe[2*rt+1];0!==kt&&(Fe[2*rt]=k(_t[kt]++,kt))}}function ge(Fe){var ht;for(ht=0;ht<286;ht++)Fe.dyn_ltree[2*ht]=0;for(ht=0;ht<30;ht++)Fe.dyn_dtree[2*ht]=0;for(ht=0;ht<19;ht++)Fe.bl_tree[2*ht]=0;Fe.dyn_ltree[512]=1,Fe.opt_len=Fe.static_len=0,Fe.last_lit=Fe.matches=0}function ve(Fe){8<Fe.bi_valid?I(Fe,Fe.bi_buf):0<Fe.bi_valid&&(Fe.pending_buf[Fe.pending++]=Fe.bi_buf),Fe.bi_buf=0,Fe.bi_valid=0}function Se(Fe,ht,pt,dt){var rt=2*ht,_t=2*pt;return Fe[rt]<Fe[_t]||Fe[rt]===Fe[_t]&&dt[ht]<=dt[pt]}function De(Fe,ht,pt){for(var dt=Fe.heap[pt],rt=pt<<1;rt<=Fe.heap_len&&(rt<Fe.heap_len&&Se(ht,Fe.heap[rt+1],Fe.heap[rt],Fe.depth)&&rt++,!Se(ht,dt,Fe.heap[rt],Fe.depth));)Fe.heap[pt]=Fe.heap[rt],pt=rt,rt<<=1;Fe.heap[pt]=dt}function Xe(Fe,ht,pt){var dt,rt,_t,Yt,kt=0;if(0!==Fe.last_lit)for(;dt=Fe.pending_buf[Fe.d_buf+2*kt]<<8|Fe.pending_buf[Fe.d_buf+2*kt+1],rt=Fe.pending_buf[Fe.l_buf+kt],kt++,0===dt?R(Fe,rt,ht):(R(Fe,(_t=g[rt])+256+1,ht),0!==(Yt=K[_t])&&A(Fe,rt-=C[_t],Yt),R(Fe,_t=m(--dt),pt),0!==(Yt=G[_t])&&A(Fe,dt-=X[_t],Yt)),kt<Fe.last_lit;);R(Fe,256,ht)}function ct(Fe,ht){var pt,dt,rt,_t=ht.dyn_tree,Yt=ht.stat_desc.static_tree,kt=ht.stat_desc.has_stree,Tt=ht.stat_desc.elems,fn=-1;for(Fe.heap_len=0,Fe.heap_max=573,pt=0;pt<Tt;pt++)0!==_t[2*pt]?(Fe.heap[++Fe.heap_len]=fn=pt,Fe.depth[pt]=0):_t[2*pt+1]=0;for(;Fe.heap_len<2;)_t[2*(rt=Fe.heap[++Fe.heap_len]=fn<2?++fn:0)]=1,Fe.depth[rt]=0,Fe.opt_len--,kt&&(Fe.static_len-=Yt[2*rt+1]);for(ht.max_code=fn,pt=Fe.heap_len>>1;1<=pt;pt--)De(Fe,_t,pt);for(rt=Tt;pt=Fe.heap[1],Fe.heap[1]=Fe.heap[Fe.heap_len--],De(Fe,_t,1),dt=Fe.heap[1],Fe.heap[--Fe.heap_max]=pt,Fe.heap[--Fe.heap_max]=dt,_t[2*rt]=_t[2*pt]+_t[2*dt],Fe.depth[rt]=(Fe.depth[pt]>=Fe.depth[dt]?Fe.depth[pt]:Fe.depth[dt])+1,_t[2*pt+1]=_t[2*dt+1]=rt,Fe.heap[1]=rt++,De(Fe,_t,1),2<=Fe.heap_len;);Fe.heap[--Fe.heap_max]=Fe.heap[1],function(ln,mn){var jt,Sn,cn,gn,Cn,Ln,Zn=mn.dyn_tree,ui=mn.max_code,hi=mn.stat_desc.static_tree,qi=mn.stat_desc.has_stree,Mr=mn.stat_desc.extra_bits,Sr=mn.stat_desc.extra_base,ms=mn.stat_desc.max_length,fs=0;for(gn=0;gn<=L;gn++)ln.bl_count[gn]=0;for(Zn[2*ln.heap[ln.heap_max]+1]=0,jt=ln.heap_max+1;jt<573;jt++)ms<(gn=Zn[2*Zn[2*(Sn=ln.heap[jt])+1]+1]+1)&&(gn=ms,fs++),Zn[2*Sn+1]=gn,ui<Sn||(ln.bl_count[gn]++,Cn=0,Sr<=Sn&&(Cn=Mr[Sn-Sr]),ln.opt_len+=(Ln=Zn[2*Sn])*(gn+Cn),qi&&(ln.static_len+=Ln*(hi[2*Sn+1]+Cn)));if(0!==fs){do{for(gn=ms-1;0===ln.bl_count[gn];)gn--;ln.bl_count[gn]--,ln.bl_count[gn+1]+=2,ln.bl_count[ms]--,fs-=2}while(0<fs);for(gn=ms;0!==gn;gn--)for(Sn=ln.bl_count[gn];0!==Sn;)ui<(cn=ln.heap[--jt])||(Zn[2*cn+1]!==gn&&(ln.opt_len+=(gn-Zn[2*cn+1])*Zn[2*cn],Zn[2*cn+1]=gn),Sn--)}}(Fe,ht),ee(_t,fn,Fe.bl_count)}function $(Fe,ht,pt){var dt,rt,_t=-1,Yt=ht[1],kt=0,Tt=7,fn=4;for(0===Yt&&(Tt=138,fn=3),ht[2*(pt+1)+1]=65535,dt=0;dt<=pt;dt++)rt=Yt,Yt=ht[2*(dt+1)+1],++kt<Tt&&rt===Yt||(kt<fn?Fe.bl_tree[2*rt]+=kt:0!==rt?(rt!==_t&&Fe.bl_tree[2*rt]++,Fe.bl_tree[32]++):kt<=10?Fe.bl_tree[34]++:Fe.bl_tree[36]++,_t=rt,fn=(kt=0)===Yt?(Tt=138,3):rt===Yt?(Tt=6,3):(Tt=7,4))}function tt(Fe,ht,pt){var dt,rt,_t=-1,Yt=ht[1],kt=0,Tt=7,fn=4;for(0===Yt&&(Tt=138,fn=3),dt=0;dt<=pt;dt++)if(rt=Yt,Yt=ht[2*(dt+1)+1],!(++kt<Tt&&rt===Yt)){if(kt<fn)for(;R(Fe,rt,Fe.bl_tree),0!=--kt;);else 0!==rt?(rt!==_t&&(R(Fe,rt,Fe.bl_tree),kt--),R(Fe,16,Fe.bl_tree),A(Fe,kt-3,2)):kt<=10?(R(Fe,17,Fe.bl_tree),A(Fe,kt-3,3)):(R(Fe,18,Fe.bl_tree),A(Fe,kt-11,7));_t=rt,fn=(kt=0)===Yt?(Tt=138,3):rt===Yt?(Tt=6,3):(Tt=7,4)}}xe(X);var We=!1;function Ne(Fe,ht,pt,dt){var rt,_t,Yt;A(Fe,0+(dt?1:0),3),_t=ht,Yt=pt,ve(rt=Fe),I(rt,Yt),I(rt,~Yt),v.arraySet(rt.pending_buf,rt.window,_t,Yt,rt.pending),rt.pending+=Yt}be._tr_init=function(Fe){We||(function(){var ht,pt,dt,rt,_t,Yt=new Array(L+1);for(rt=dt=0;rt<28;rt++)for(C[rt]=dt,ht=0;ht<1<<K[rt];ht++)g[dt++]=rt;for(g[dt-1]=rt,rt=_t=0;rt<16;rt++)for(X[rt]=_t,ht=0;ht<1<<G[rt];ht++)b[_t++]=rt;for(_t>>=7;rt<30;rt++)for(X[rt]=_t<<7,ht=0;ht<1<<G[rt]-7;ht++)b[256+_t++]=rt;for(pt=0;pt<=L;pt++)Yt[pt]=0;for(ht=0;ht<=143;)P[2*ht+1]=8,ht++,Yt[8]++;for(;ht<=255;)P[2*ht+1]=9,ht++,Yt[9]++;for(;ht<=279;)P[2*ht+1]=7,ht++,Yt[7]++;for(;ht<=287;)P[2*ht+1]=8,ht++,Yt[8]++;for(ee(P,287,Yt),ht=0;ht<30;ht++)w[2*ht+1]=5,w[2*ht]=k(ht,5);N=new ie(P,K,257,286,L),O=new ie(w,G,0,30,L),H=new ie(new Array(0),D,0,19,7)}(),We=!0),Fe.l_desc=new z(Fe.dyn_ltree,N),Fe.d_desc=new z(Fe.dyn_dtree,O),Fe.bl_desc=new z(Fe.bl_tree,H),Fe.bi_buf=0,Fe.bi_valid=0,ge(Fe)},be._tr_stored_block=Ne,be._tr_flush_block=function(Fe,ht,pt,dt){var rt,_t,Yt=0;0<Fe.level?(2===Fe.strm.data_type&&(Fe.strm.data_type=function(kt){var Tt,fn=4093624447;for(Tt=0;Tt<=31;Tt++,fn>>>=1)if(1&fn&&0!==kt.dyn_ltree[2*Tt])return 0;if(0!==kt.dyn_ltree[18]||0!==kt.dyn_ltree[20]||0!==kt.dyn_ltree[26])return 1;for(Tt=32;Tt<256;Tt++)if(0!==kt.dyn_ltree[2*Tt])return 1;return 0}(Fe)),ct(Fe,Fe.l_desc),ct(Fe,Fe.d_desc),Yt=function(kt){var Tt;for($(kt,kt.dyn_ltree,kt.l_desc.max_code),$(kt,kt.dyn_dtree,kt.d_desc.max_code),ct(kt,kt.bl_desc),Tt=18;3<=Tt&&0===kt.bl_tree[2*x[Tt]+1];Tt--);return kt.opt_len+=3*(Tt+1)+5+5+4,Tt}(Fe),(_t=Fe.static_len+3+7>>>3)<=(rt=Fe.opt_len+3+7>>>3)&&(rt=_t)):rt=_t=pt+5,pt+4<=rt&&-1!==ht?Ne(Fe,ht,pt,dt):4===Fe.strategy||_t===rt?(A(Fe,2+(dt?1:0),3),Xe(Fe,P,w)):(A(Fe,4+(dt?1:0),3),function(kt,Tt,fn,ln){var mn;for(A(kt,Tt-257,5),A(kt,fn-1,5),A(kt,ln-4,4),mn=0;mn<ln;mn++)A(kt,kt.bl_tree[2*x[mn]+1],3);tt(kt,kt.dyn_ltree,Tt-1),tt(kt,kt.dyn_dtree,fn-1)}(Fe,Fe.l_desc.max_code+1,Fe.d_desc.max_code+1,Yt+1),Xe(Fe,Fe.dyn_ltree,Fe.dyn_dtree)),ge(Fe),dt&&ve(Fe)},be._tr_tally=function(Fe,ht,pt){return Fe.pending_buf[Fe.d_buf+2*Fe.last_lit]=ht>>>8&255,Fe.pending_buf[Fe.d_buf+2*Fe.last_lit+1]=255&ht,Fe.pending_buf[Fe.l_buf+Fe.last_lit]=255&pt,Fe.last_lit++,0===ht?Fe.dyn_ltree[2*pt]++:(Fe.matches++,ht--,Fe.dyn_ltree[2*(g[pt]+256+1)]++,Fe.dyn_dtree[2*m(ht)]++),Fe.last_lit===Fe.lit_bufsize-1},be._tr_align=function(Fe){var ht;A(Fe,2,3),R(Fe,256,P),16===(ht=Fe).bi_valid?(I(ht,ht.bi_buf),ht.bi_buf=0,ht.bi_valid=0):8<=ht.bi_valid&&(ht.pending_buf[ht.pending++]=255&ht.bi_buf,ht.bi_buf>>=8,ht.bi_valid-=8)}},{"../utils/common":41}],53:[function(xt,Te,be){"use strict";Te.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(xt,Te,be){(function(v){!function(V,Le){"use strict";if(!V.setImmediate){var xe,Je,st,Ke,ot=1,Re={},Qe=!1,Ie=V.document,L=Object.getPrototypeOf&&Object.getPrototypeOf(V);L=L&&L.setTimeout?L:V,xe="[object process]"==={}.toString.call(V.process)?function(de){process.nextTick(function(){re(de)})}:function(){if(V.postMessage&&!V.importScripts){var de=!0,pe=V.onmessage;return V.onmessage=function(){de=!1},V.postMessage("","*"),V.onmessage=pe,de}}()?(Ke="setImmediate$"+Math.random()+"$",V.addEventListener?V.addEventListener("message",fe,!1):V.attachEvent("onmessage",fe),function(de){V.postMessage(Ke+de,"*")}):V.MessageChannel?((st=new MessageChannel).port1.onmessage=function(de){re(de.data)},function(de){st.port2.postMessage(de)}):Ie&&"onreadystatechange"in Ie.createElement("script")?(Je=Ie.documentElement,function(de){var pe=Ie.createElement("script");pe.onreadystatechange=function(){re(de),pe.onreadystatechange=null,Je.removeChild(pe),pe=null},Je.appendChild(pe)}):function(de){setTimeout(re,0,de)},L.setImmediate=function(de){"function"!=typeof de&&(de=new Function(""+de));for(var pe=new Array(arguments.length-1),ce=0;ce<pe.length;ce++)pe[ce]=arguments[ce+1];return Re[ot]={callback:de,args:pe},xe(ot),ot++},L.clearImmediate=he}function he(de){delete Re[de]}function re(de){if(Qe)setTimeout(re,0,de);else{var pe=Re[de];if(pe){Qe=!0;try{!function(ce){var K=ce.callback,G=ce.args;switch(G.length){case 0:K();break;case 1:K(G[0]);break;case 2:K(G[0],G[1]);break;case 3:K(G[0],G[1],G[2]);break;default:K.apply(Le,G)}}(pe)}finally{he(de),Qe=!1}}}}function fe(de){de.source===V&&"string"==typeof de.data&&0===de.data.indexOf(Ke)&&re(+de.data.slice(Ke.length))}}(typeof self>"u"?void 0===v?this:v:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)},7390:(Gr,xt,Te)=>{const be=Te(3944),v=Te(4144),V=Te(210),Le=Te(7691);function xe(Je,st,Ke,ot,Re){const Qe=[].slice.call(arguments,1),Ie=Qe.length,L="function"==typeof Qe[Ie-1];if(!L&&!be())throw new Error("Callback required as last argument");if(!L){if(Ie<1)throw new Error("Too few arguments provided");return 1===Ie?(Ke=st,st=ot=void 0):2===Ie&&!st.getContext&&(ot=Ke,Ke=st,st=void 0),new Promise(function(he,re){try{const fe=v.create(Ke,ot);he(Je(fe,st,ot))}catch(fe){re(fe)}})}if(Ie<2)throw new Error("Too few arguments provided");2===Ie?(Re=Ke,Ke=st,st=ot=void 0):3===Ie&&(st.getContext&&typeof Re>"u"?(Re=ot,ot=void 0):(Re=ot,ot=Ke,Ke=st,st=void 0));try{const he=v.create(Ke,ot);Re(null,Je(he,st,ot))}catch(he){Re(he)}}xt.create=v.create,xt.toCanvas=xe.bind(null,V.render),xt.toDataURL=xe.bind(null,V.renderToDataURL),xt.toString=xe.bind(null,function(Je,st,Ke){return Le.render(Je,Ke)})},3944:Gr=>{Gr.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},6498:(Gr,xt,Te)=>{const be=Te(1541).getSymbolSize;xt.getRowColCoords=function(V){if(1===V)return[];const Le=Math.floor(V/7)+2,xe=be(V),Je=145===xe?26:2*Math.ceil((xe-13)/(2*Le-2)),st=[xe-7];for(let Ke=1;Ke<Le-1;Ke++)st[Ke]=st[Ke-1]-Je;return st.push(6),st.reverse()},xt.getPositions=function(V){const Le=[],xe=xt.getRowColCoords(V),Je=xe.length;for(let st=0;st<Je;st++)for(let Ke=0;Ke<Je;Ke++)0===st&&0===Ke||0===st&&Ke===Je-1||st===Je-1&&0===Ke||Le.push([xe[st],xe[Ke]]);return Le}},7686:(Gr,xt,Te)=>{const be=Te(6065),v=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function V(Le){this.mode=be.ALPHANUMERIC,this.data=Le}V.getBitsLength=function(xe){return 11*Math.floor(xe/2)+xe%2*6},V.prototype.getLength=function(){return this.data.length},V.prototype.getBitsLength=function(){return V.getBitsLength(this.data.length)},V.prototype.write=function(xe){let Je;for(Je=0;Je+2<=this.data.length;Je+=2){let st=45*v.indexOf(this.data[Je]);st+=v.indexOf(this.data[Je+1]),xe.put(st,11)}this.data.length%2&&xe.put(v.indexOf(this.data[Je]),6)},Gr.exports=V},8186:Gr=>{function xt(){this.buffer=[],this.length=0}xt.prototype={get:function(Te){const be=Math.floor(Te/8);return 1==(this.buffer[be]>>>7-Te%8&1)},put:function(Te,be){for(let v=0;v<be;v++)this.putBit(1==(Te>>>be-v-1&1))},getLengthInBits:function(){return this.length},putBit:function(Te){const be=Math.floor(this.length/8);this.buffer.length<=be&&this.buffer.push(0),Te&&(this.buffer[be]|=128>>>this.length%8),this.length++}},Gr.exports=xt},265:Gr=>{function xt(Te){if(!Te||Te<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=Te,this.data=new Uint8Array(Te*Te),this.reservedBit=new Uint8Array(Te*Te)}xt.prototype.set=function(Te,be,v,V){const Le=Te*this.size+be;this.data[Le]=v,V&&(this.reservedBit[Le]=!0)},xt.prototype.get=function(Te,be){return this.data[Te*this.size+be]},xt.prototype.xor=function(Te,be,v){this.data[Te*this.size+be]^=v},xt.prototype.isReserved=function(Te,be){return this.reservedBit[Te*this.size+be]},Gr.exports=xt},1821:(Gr,xt,Te)=>{const be=Te(6065);function v(V){this.mode=be.BYTE,this.data="string"==typeof V?(new TextEncoder).encode(V):new Uint8Array(V)}v.getBitsLength=function(Le){return 8*Le},v.prototype.getLength=function(){return this.data.length},v.prototype.getBitsLength=function(){return v.getBitsLength(this.data.length)},v.prototype.write=function(V){for(let Le=0,xe=this.data.length;Le<xe;Le++)V.put(this.data[Le],8)},Gr.exports=v},185:(Gr,xt,Te)=>{const be=Te(7940),v=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],V=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];xt.getBlocksCount=function(xe,Je){switch(Je){case be.L:return v[4*(xe-1)+0];case be.M:return v[4*(xe-1)+1];case be.Q:return v[4*(xe-1)+2];case be.H:return v[4*(xe-1)+3];default:return}},xt.getTotalCodewordsCount=function(xe,Je){switch(Je){case be.L:return V[4*(xe-1)+0];case be.M:return V[4*(xe-1)+1];case be.Q:return V[4*(xe-1)+2];case be.H:return V[4*(xe-1)+3];default:return}}},7940:(Gr,xt)=>{xt.L={bit:1},xt.M={bit:0},xt.Q={bit:3},xt.H={bit:2},xt.isValid=function(v){return v&&typeof v.bit<"u"&&v.bit>=0&&v.bit<4},xt.from=function(v,V){if(xt.isValid(v))return v;try{return function Te(be){if("string"!=typeof be)throw new Error("Param is not a string");switch(be.toLowerCase()){case"l":case"low":return xt.L;case"m":case"medium":return xt.M;case"q":case"quartile":return xt.Q;case"h":case"high":return xt.H;default:throw new Error("Unknown EC Level: "+be)}}(v)}catch{return V}}},4793:(Gr,xt,Te)=>{const be=Te(1541).getSymbolSize;xt.getPositions=function(Le){const xe=be(Le);return[[0,0],[xe-7,0],[0,xe-7]]}},5274:(Gr,xt,Te)=>{const be=Te(1541),Le=be.getBCHDigit(1335);xt.getEncodedBits=function(Je,st){const Ke=Je.bit<<3|st;let ot=Ke<<10;for(;be.getBCHDigit(ot)-Le>=0;)ot^=1335<<be.getBCHDigit(ot)-Le;return 21522^(Ke<<10|ot)}},9970:(Gr,xt)=>{const Te=new Uint8Array(512),be=new Uint8Array(256);(function(){let V=1;for(let Le=0;Le<255;Le++)Te[Le]=V,be[V]=Le,V<<=1,256&V&&(V^=285);for(let Le=255;Le<512;Le++)Te[Le]=Te[Le-255]})(),xt.log=function(V){if(V<1)throw new Error("log("+V+")");return be[V]},xt.exp=function(V){return Te[V]},xt.mul=function(V,Le){return 0===V||0===Le?0:Te[be[V]+be[Le]]}},7572:(Gr,xt,Te)=>{const be=Te(6065),v=Te(1541);function V(Le){this.mode=be.KANJI,this.data=Le}V.getBitsLength=function(xe){return 13*xe},V.prototype.getLength=function(){return this.data.length},V.prototype.getBitsLength=function(){return V.getBitsLength(this.data.length)},V.prototype.write=function(Le){let xe;for(xe=0;xe<this.data.length;xe++){let Je=v.toSJIS(this.data[xe]);if(Je>=33088&&Je<=40956)Je-=33088;else{if(!(Je>=57408&&Je<=60351))throw new Error("Invalid SJIS character: "+this.data[xe]+"\nMake sure your charset is UTF-8");Je-=49472}Je=192*(Je>>>8&255)+(255&Je),Le.put(Je,13)}},Gr.exports=V},757:(Gr,xt)=>{xt.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function be(v,V,Le){switch(v){case xt.Patterns.PATTERN000:return(V+Le)%2==0;case xt.Patterns.PATTERN001:return V%2==0;case xt.Patterns.PATTERN010:return Le%3==0;case xt.Patterns.PATTERN011:return(V+Le)%3==0;case xt.Patterns.PATTERN100:return(Math.floor(V/2)+Math.floor(Le/3))%2==0;case xt.Patterns.PATTERN101:return V*Le%2+V*Le%3==0;case xt.Patterns.PATTERN110:return(V*Le%2+V*Le%3)%2==0;case xt.Patterns.PATTERN111:return(V*Le%3+(V+Le)%2)%2==0;default:throw new Error("bad maskPattern:"+v)}}xt.isValid=function(V){return null!=V&&""!==V&&!isNaN(V)&&V>=0&&V<=7},xt.from=function(V){return xt.isValid(V)?parseInt(V,10):void 0},xt.getPenaltyN1=function(V){const Le=V.size;let xe=0,Je=0,st=0,Ke=null,ot=null;for(let Re=0;Re<Le;Re++){Je=st=0,Ke=ot=null;for(let Qe=0;Qe<Le;Qe++){let Ie=V.get(Re,Qe);Ie===Ke?Je++:(Je>=5&&(xe+=Je-5+3),Ke=Ie,Je=1),Ie=V.get(Qe,Re),Ie===ot?st++:(st>=5&&(xe+=st-5+3),ot=Ie,st=1)}Je>=5&&(xe+=Je-5+3),st>=5&&(xe+=st-5+3)}return xe},xt.getPenaltyN2=function(V){const Le=V.size;let xe=0;for(let Je=0;Je<Le-1;Je++)for(let st=0;st<Le-1;st++){const Ke=V.get(Je,st)+V.get(Je,st+1)+V.get(Je+1,st)+V.get(Je+1,st+1);(4===Ke||0===Ke)&&xe++}return 3*xe},xt.getPenaltyN3=function(V){const Le=V.size;let xe=0,Je=0,st=0;for(let Ke=0;Ke<Le;Ke++){Je=st=0;for(let ot=0;ot<Le;ot++)Je=Je<<1&2047|V.get(Ke,ot),ot>=10&&(1488===Je||93===Je)&&xe++,st=st<<1&2047|V.get(ot,Ke),ot>=10&&(1488===st||93===st)&&xe++}return 40*xe},xt.getPenaltyN4=function(V){let Le=0;const xe=V.data.length;for(let st=0;st<xe;st++)Le+=V.data[st];return 10*Math.abs(Math.ceil(100*Le/xe/5)-10)},xt.applyMask=function(V,Le){const xe=Le.size;for(let Je=0;Je<xe;Je++)for(let st=0;st<xe;st++)Le.isReserved(st,Je)||Le.xor(st,Je,be(V,st,Je))},xt.getBestMask=function(V,Le){const xe=Object.keys(xt.Patterns).length;let Je=0,st=1/0;for(let Ke=0;Ke<xe;Ke++){Le(Ke),xt.applyMask(Ke,V);const ot=xt.getPenaltyN1(V)+xt.getPenaltyN2(V)+xt.getPenaltyN3(V)+xt.getPenaltyN4(V);xt.applyMask(Ke,V),ot<st&&(st=ot,Je=Ke)}return Je}},6065:(Gr,xt,Te)=>{const be=Te(7621),v=Te(7219);xt.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},xt.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},xt.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},xt.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},xt.MIXED={bit:-1},xt.getCharCountIndicator=function(xe,Je){if(!xe.ccBits)throw new Error("Invalid mode: "+xe);if(!be.isValid(Je))throw new Error("Invalid version: "+Je);return Je>=1&&Je<10?xe.ccBits[0]:Je<27?xe.ccBits[1]:xe.ccBits[2]},xt.getBestModeForData=function(xe){return v.testNumeric(xe)?xt.NUMERIC:v.testAlphanumeric(xe)?xt.ALPHANUMERIC:v.testKanji(xe)?xt.KANJI:xt.BYTE},xt.toString=function(xe){if(xe&&xe.id)return xe.id;throw new Error("Invalid mode")},xt.isValid=function(xe){return xe&&xe.bit&&xe.ccBits},xt.from=function(xe,Je){if(xt.isValid(xe))return xe;try{return function V(Le){if("string"!=typeof Le)throw new Error("Param is not a string");switch(Le.toLowerCase()){case"numeric":return xt.NUMERIC;case"alphanumeric":return xt.ALPHANUMERIC;case"kanji":return xt.KANJI;case"byte":return xt.BYTE;default:throw new Error("Unknown mode: "+Le)}}(xe)}catch{return Je}}},4944:(Gr,xt,Te)=>{const be=Te(6065);function v(V){this.mode=be.NUMERIC,this.data=V.toString()}v.getBitsLength=function(Le){return 10*Math.floor(Le/3)+(Le%3?Le%3*3+1:0)},v.prototype.getLength=function(){return this.data.length},v.prototype.getBitsLength=function(){return v.getBitsLength(this.data.length)},v.prototype.write=function(Le){let xe,Je,st;for(xe=0;xe+3<=this.data.length;xe+=3)Je=this.data.substr(xe,3),st=parseInt(Je,10),Le.put(st,10);const Ke=this.data.length-xe;Ke>0&&(Je=this.data.substr(xe),st=parseInt(Je,10),Le.put(st,3*Ke+1))},Gr.exports=v},6660:(Gr,xt,Te)=>{const be=Te(9970);xt.mul=function(V,Le){const xe=new Uint8Array(V.length+Le.length-1);for(let Je=0;Je<V.length;Je++)for(let st=0;st<Le.length;st++)xe[Je+st]^=be.mul(V[Je],Le[st]);return xe},xt.mod=function(V,Le){let xe=new Uint8Array(V);for(;xe.length-Le.length>=0;){const Je=xe[0];for(let Ke=0;Ke<Le.length;Ke++)xe[Ke]^=be.mul(Le[Ke],Je);let st=0;for(;st<xe.length&&0===xe[st];)st++;xe=xe.slice(st)}return xe},xt.generateECPolynomial=function(V){let Le=new Uint8Array([1]);for(let xe=0;xe<V;xe++)Le=xt.mul(Le,new Uint8Array([1,be.exp(xe)]));return Le}},4144:(Gr,xt,Te)=>{const be=Te(1541),v=Te(7940),V=Te(8186),Le=Te(265),xe=Te(6498),Je=Te(4793),st=Te(757),Ke=Te(185),ot=Te(3749),Re=Te(6480),Qe=Te(5274),Ie=Te(6065),L=Te(1800);function pe(x,P,w){const b=x.size,g=Qe.getEncodedBits(P,w);let C,N;for(C=0;C<15;C++)N=1==(g>>C&1),x.set(C<6?C:C<8?C+1:b-15+C,8,N,!0),x.set(8,C<8?b-C-1:C<9?15-C-1+1:15-C-1,N,!0);x.set(b-8,8,1,!0)}function D(x,P,w,b){let g;if(Array.isArray(x))g=L.fromArray(x);else{if("string"!=typeof x)throw new Error("Invalid data");{let X=P;if(!X){const ie=L.rawSplit(x);X=Re.getBestVersionForData(ie,w)}g=L.fromString(x,X||40)}}const C=Re.getBestVersionForData(g,w);if(!C)throw new Error("The amount of data is too big to be stored in a QR Code");if(P){if(P<C)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+C+".\n")}else P=C;const N=function K(x,P,w){const b=new V;w.forEach(function(H){b.put(H.mode.bit,4),b.put(H.getLength(),Ie.getCharCountIndicator(H.mode,x)),H.write(b)});const N=8*(be.getSymbolTotalCodewords(x)-Ke.getTotalCodewordsCount(x,P));for(b.getLengthInBits()+4<=N&&b.put(0,4);b.getLengthInBits()%8!=0;)b.putBit(0);const O=(N-b.getLengthInBits())/8;for(let H=0;H<O;H++)b.put(H%2?17:236,8);return function G(x,P,w){const b=be.getSymbolTotalCodewords(P),C=b-Ke.getTotalCodewordsCount(P,w),N=Ke.getBlocksCount(P,w),H=N-b%N,X=Math.floor(b/N),ie=Math.floor(C/N),z=ie+1,m=X-ie,I=new ot(m);let A=0;const R=new Array(N),k=new Array(N);let ee=0;const ge=new Uint8Array(x.buffer);for(let ct=0;ct<N;ct++){const $=ct<H?ie:z;R[ct]=ge.slice(A,A+$),k[ct]=I.encode(R[ct]),A+=$,ee=Math.max(ee,$)}const ve=new Uint8Array(b);let De,Xe,Se=0;for(De=0;De<ee;De++)for(Xe=0;Xe<N;Xe++)De<R[Xe].length&&(ve[Se++]=R[Xe][De]);for(De=0;De<m;De++)for(Xe=0;Xe<N;Xe++)ve[Se++]=k[Xe][De];return ve}(b,x,P)}(P,w,g),O=be.getSymbolSize(P),H=new Le(O);return function he(x,P){const w=x.size,b=Je.getPositions(P);for(let g=0;g<b.length;g++){const C=b[g][0],N=b[g][1];for(let O=-1;O<=7;O++)if(!(C+O<=-1||w<=C+O))for(let H=-1;H<=7;H++)N+H<=-1||w<=N+H||x.set(C+O,N+H,O>=0&&O<=6&&(0===H||6===H)||H>=0&&H<=6&&(0===O||6===O)||O>=2&&O<=4&&H>=2&&H<=4,!0)}}(H,P),function re(x){const P=x.size;for(let w=8;w<P-8;w++){const b=w%2==0;x.set(w,6,b,!0),x.set(6,w,b,!0)}}(H),function fe(x,P){const w=xe.getPositions(P);for(let b=0;b<w.length;b++){const g=w[b][0],C=w[b][1];for(let N=-2;N<=2;N++)for(let O=-2;O<=2;O++)x.set(g+N,C+O,-2===N||2===N||-2===O||2===O||0===N&&0===O,!0)}}(H,P),pe(H,w,0),P>=7&&function de(x,P){const w=x.size,b=Re.getEncodedBits(P);let g,C,N;for(let O=0;O<18;O++)g=Math.floor(O/3),C=O%3+w-8-3,N=1==(b>>O&1),x.set(g,C,N,!0),x.set(C,g,N,!0)}(H,P),function ce(x,P){const w=x.size;let b=-1,g=w-1,C=7,N=0;for(let O=w-1;O>0;O-=2)for(6===O&&O--;;){for(let H=0;H<2;H++)if(!x.isReserved(g,O-H)){let X=!1;N<P.length&&(X=1==(P[N]>>>C&1)),x.set(g,O-H,X),C--,-1===C&&(N++,C=7)}if(g+=b,g<0||w<=g){g-=b,b=-b;break}}}(H,N),isNaN(b)&&(b=st.getBestMask(H,pe.bind(null,H,w))),st.applyMask(b,H),pe(H,w,b),{modules:H,version:P,errorCorrectionLevel:w,maskPattern:b,segments:g}}xt.create=function(P,w){if(typeof P>"u"||""===P)throw new Error("No input text");let g,C,b=v.M;return typeof w<"u"&&(b=v.from(w.errorCorrectionLevel,v.M),g=Re.from(w.version),C=st.from(w.maskPattern),w.toSJISFunc&&be.setToSJISFunction(w.toSJISFunc)),D(P,g,b,C)}},3749:(Gr,xt,Te)=>{const be=Te(6660);function v(V){this.genPoly=void 0,this.degree=V,this.degree&&this.initialize(this.degree)}v.prototype.initialize=function(Le){this.degree=Le,this.genPoly=be.generateECPolynomial(this.degree)},v.prototype.encode=function(Le){if(!this.genPoly)throw new Error("Encoder not initialized");const xe=new Uint8Array(Le.length+this.degree);xe.set(Le);const Je=be.mod(xe,this.genPoly),st=this.degree-Je.length;if(st>0){const Ke=new Uint8Array(this.degree);return Ke.set(Je,st),Ke}return Je},Gr.exports=v},7219:(Gr,xt)=>{let v="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";v=v.replace(/u/g,"\\u");const V="(?:(?![A-Z0-9 $%*+\\-./:]|"+v+")(?:.|[\r\n]))+";xt.KANJI=new RegExp(v,"g"),xt.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),xt.BYTE=new RegExp(V,"g"),xt.NUMERIC=new RegExp("[0-9]+","g"),xt.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const Le=new RegExp("^"+v+"$"),xe=new RegExp("^[0-9]+$"),Je=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");xt.testKanji=function(Ke){return Le.test(Ke)},xt.testNumeric=function(Ke){return xe.test(Ke)},xt.testAlphanumeric=function(Ke){return Je.test(Ke)}},1800:(Gr,xt,Te)=>{const be=Te(6065),v=Te(4944),V=Te(7686),Le=Te(1821),xe=Te(7572),Je=Te(7219),st=Te(1541),Ke=Te(3039);function ot(de){return unescape(encodeURIComponent(de)).length}function Re(de,pe,ce){const K=[];let G;for(;null!==(G=de.exec(ce));)K.push({data:G[0],index:G.index,mode:pe,length:G[0].length});return K}function Qe(de){const pe=Re(Je.NUMERIC,be.NUMERIC,de),ce=Re(Je.ALPHANUMERIC,be.ALPHANUMERIC,de);let K,G;return st.isKanjiModeEnabled()?(K=Re(Je.BYTE,be.BYTE,de),G=Re(Je.KANJI,be.KANJI,de)):(K=Re(Je.BYTE_KANJI,be.BYTE,de),G=[]),pe.concat(ce,K,G).sort(function(x,P){return x.index-P.index}).map(function(x){return{data:x.data,mode:x.mode,length:x.length}})}function Ie(de,pe){switch(pe){case be.NUMERIC:return v.getBitsLength(de);case be.ALPHANUMERIC:return V.getBitsLength(de);case be.KANJI:return xe.getBitsLength(de);case be.BYTE:return Le.getBitsLength(de)}}function fe(de,pe){let ce;const K=be.getBestModeForData(de);if(ce=be.from(pe,K),ce!==be.BYTE&&ce.bit<K.bit)throw new Error('"'+de+'" cannot be encoded with mode '+be.toString(ce)+".\n Suggested mode is: "+be.toString(K));switch(ce===be.KANJI&&!st.isKanjiModeEnabled()&&(ce=be.BYTE),ce){case be.NUMERIC:return new v(de);case be.ALPHANUMERIC:return new V(de);case be.KANJI:return new xe(de);case be.BYTE:return new Le(de)}}xt.fromArray=function(pe){return pe.reduce(function(ce,K){return"string"==typeof K?ce.push(fe(K,null)):K.data&&ce.push(fe(K.data,K.mode)),ce},[])},xt.fromString=function(pe,ce){const G=function he(de){const pe=[];for(let ce=0;ce<de.length;ce++){const K=de[ce];switch(K.mode){case be.NUMERIC:pe.push([K,{data:K.data,mode:be.ALPHANUMERIC,length:K.length},{data:K.data,mode:be.BYTE,length:K.length}]);break;case be.ALPHANUMERIC:pe.push([K,{data:K.data,mode:be.BYTE,length:K.length}]);break;case be.KANJI:pe.push([K,{data:K.data,mode:be.BYTE,length:ot(K.data)}]);break;case be.BYTE:pe.push([{data:K.data,mode:be.BYTE,length:ot(K.data)}])}}return pe}(Qe(pe,st.isKanjiModeEnabled())),D=function re(de,pe){const ce={},K={start:{}};let G=["start"];for(let D=0;D<de.length;D++){const x=de[D],P=[];for(let w=0;w<x.length;w++){const b=x[w],g=""+D+w;P.push(g),ce[g]={node:b,lastCount:0},K[g]={};for(let C=0;C<G.length;C++){const N=G[C];ce[N]&&ce[N].node.mode===b.mode?(K[N][g]=Ie(ce[N].lastCount+b.length,b.mode)-Ie(ce[N].lastCount,b.mode),ce[N].lastCount+=b.length):(ce[N]&&(ce[N].lastCount=b.length),K[N][g]=Ie(b.length,b.mode)+4+be.getCharCountIndicator(b.mode,pe))}}G=P}for(let D=0;D<G.length;D++)K[G[D]].end=0;return{map:K,table:ce}}(G,ce),x=Ke.find_path(D.map,"start","end"),P=[];for(let w=1;w<x.length-1;w++)P.push(D.table[x[w]].node);return xt.fromArray(function L(de){return de.reduce(function(pe,ce){const K=pe.length-1>=0?pe[pe.length-1]:null;return K&&K.mode===ce.mode?(pe[pe.length-1].data+=ce.data,pe):(pe.push(ce),pe)},[])}(P))},xt.rawSplit=function(pe){return xt.fromArray(Qe(pe,st.isKanjiModeEnabled()))}},1541:(Gr,xt)=>{let Te;const be=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];xt.getSymbolSize=function(V){if(!V)throw new Error('"version" cannot be null or undefined');if(V<1||V>40)throw new Error('"version" should be in range from 1 to 40');return 4*V+17},xt.getSymbolTotalCodewords=function(V){return be[V]},xt.getBCHDigit=function(v){let V=0;for(;0!==v;)V++,v>>>=1;return V},xt.setToSJISFunction=function(V){if("function"!=typeof V)throw new Error('"toSJISFunc" is not a valid function.');Te=V},xt.isKanjiModeEnabled=function(){return typeof Te<"u"},xt.toSJIS=function(V){return Te(V)}},7621:(Gr,xt)=>{xt.isValid=function(be){return!isNaN(be)&&be>=1&&be<=40}},6480:(Gr,xt,Te)=>{const be=Te(1541),v=Te(185),V=Te(7940),Le=Te(6065),xe=Te(7621),st=be.getBCHDigit(7973);function ot(Ie,L){return Le.getCharCountIndicator(Ie,L)+4}function Re(Ie,L){let he=0;return Ie.forEach(function(re){const fe=ot(re.mode,L);he+=fe+re.getBitsLength()}),he}xt.from=function(L,he){return xe.isValid(L)?parseInt(L,10):he},xt.getCapacity=function(L,he,re){if(!xe.isValid(L))throw new Error("Invalid QR Code version");typeof re>"u"&&(re=Le.BYTE);const pe=8*(be.getSymbolTotalCodewords(L)-v.getTotalCodewordsCount(L,he));if(re===Le.MIXED)return pe;const ce=pe-ot(re,L);switch(re){case Le.NUMERIC:return Math.floor(ce/10*3);case Le.ALPHANUMERIC:return Math.floor(ce/11*2);case Le.KANJI:return Math.floor(ce/13);default:return Math.floor(ce/8)}},xt.getBestVersionForData=function(L,he){let re;const fe=V.from(he,V.M);if(Array.isArray(L)){if(L.length>1)return function Qe(Ie,L){for(let he=1;he<=40;he++)if(Re(Ie,he)<=xt.getCapacity(he,L,Le.MIXED))return he}(L,fe);if(0===L.length)return 1;re=L[0]}else re=L;return function Ke(Ie,L,he){for(let re=1;re<=40;re++)if(L<=xt.getCapacity(re,he,Ie))return re}(re.mode,re.getLength(),fe)},xt.getEncodedBits=function(L){if(!xe.isValid(L)||L<7)throw new Error("Invalid QR Code version");let he=L<<12;for(;be.getBCHDigit(he)-st>=0;)he^=7973<<be.getBCHDigit(he)-st;return L<<12|he}},210:(Gr,xt,Te)=>{const be=Te(3281);xt.render=function(xe,Je,st){let Ke=st,ot=Je;typeof Ke>"u"&&(!Je||!Je.getContext)&&(Ke=Je,Je=void 0),Je||(ot=function V(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}()),Ke=be.getOptions(Ke);const Re=be.getImageWidth(xe.modules.size,Ke),Qe=ot.getContext("2d"),Ie=Qe.createImageData(Re,Re);return be.qrToImageData(Ie.data,xe,Ke),function v(Le,xe,Je){Le.clearRect(0,0,xe.width,xe.height),xe.style||(xe.style={}),xe.height=Je,xe.width=Je,xe.style.height=Je+"px",xe.style.width=Je+"px"}(Qe,ot,Re),Qe.putImageData(Ie,0,0),ot},xt.renderToDataURL=function(xe,Je,st){let Ke=st;return typeof Ke>"u"&&(!Je||!Je.getContext)&&(Ke=Je,Je=void 0),Ke||(Ke={}),xt.render(xe,Je,Ke).toDataURL(Ke.type||"image/png",(Ke.rendererOpts||{}).quality)}},7691:(Gr,xt,Te)=>{const be=Te(3281);function v(xe,Je){const st=xe.a/255,Ke=Je+'="'+xe.hex+'"';return st<1?Ke+" "+Je+'-opacity="'+st.toFixed(2).slice(1)+'"':Ke}function V(xe,Je,st){let Ke=xe+Je;return typeof st<"u"&&(Ke+=" "+st),Ke}xt.render=function(Je,st,Ke){const ot=be.getOptions(st),Re=Je.modules.size,Qe=Je.modules.data,Ie=Re+2*ot.margin,L=ot.color.light.a?"<path "+v(ot.color.light,"fill")+' d="M0 0h'+Ie+"v"+Ie+'H0z"/>':"",he="<path "+v(ot.color.dark,"stroke")+' d="'+function Le(xe,Je,st){let Ke="",ot=0,Re=!1,Qe=0;for(let Ie=0;Ie<xe.length;Ie++){const L=Math.floor(Ie%Je),he=Math.floor(Ie/Je);!L&&!Re&&(Re=!0),xe[Ie]?(Qe++,Ie>0&&L>0&&xe[Ie-1]||(Ke+=Re?V("M",L+st,.5+he+st):V("m",ot,0),ot=0,Re=!1),L+1<Je&&xe[Ie+1]||(Ke+=V("h",Qe),Qe=0)):ot++}return Ke}(Qe,Re,ot.margin)+'"/>',de='<svg xmlns="http://www.w3.org/2000/svg" '+(ot.width?'width="'+ot.width+'" height="'+ot.width+'" ':"")+'viewBox="0 0 '+Ie+" "+Ie+'" shape-rendering="crispEdges">'+L+he+"</svg>\n";return"function"==typeof Ke&&Ke(null,de),de}},3281:(Gr,xt)=>{function Te(be){if("number"==typeof be&&(be=be.toString()),"string"!=typeof be)throw new Error("Color should be defined as hex string");let v=be.slice().replace("#","").split("");if(v.length<3||5===v.length||v.length>8)throw new Error("Invalid hex color: "+be);(3===v.length||4===v.length)&&(v=Array.prototype.concat.apply([],v.map(function(Le){return[Le,Le]}))),6===v.length&&v.push("F","F");const V=parseInt(v.join(""),16);return{r:V>>24&255,g:V>>16&255,b:V>>8&255,a:255&V,hex:"#"+v.slice(0,6).join("")}}xt.getOptions=function(v){v||(v={}),v.color||(v.color={});const Le=v.width&&v.width>=21?v.width:void 0;return{width:Le,scale:Le?4:v.scale||4,margin:typeof v.margin>"u"||null===v.margin||v.margin<0?4:v.margin,color:{dark:Te(v.color.dark||"#000000ff"),light:Te(v.color.light||"#ffffffff")},type:v.type,rendererOpts:v.rendererOpts||{}}},xt.getScale=function(v,V){return V.width&&V.width>=v+2*V.margin?V.width/(v+2*V.margin):V.scale},xt.getImageWidth=function(v,V){const Le=xt.getScale(v,V);return Math.floor((v+2*V.margin)*Le)},xt.qrToImageData=function(v,V,Le){const xe=V.modules.size,Je=V.modules.data,st=xt.getScale(xe,Le),Ke=Math.floor((xe+2*Le.margin)*st),ot=Le.margin*st,Re=[Le.color.light,Le.color.dark];for(let Qe=0;Qe<Ke;Qe++)for(let Ie=0;Ie<Ke;Ie++){let L=4*(Qe*Ke+Ie),he=Le.color.light;Qe>=ot&&Ie>=ot&&Qe<Ke-ot&&Ie<Ke-ot&&(he=Re[Je[Math.floor((Qe-ot)/st)*xe+Math.floor((Ie-ot)/st)]?1:0]),v[L++]=he.r,v[L++]=he.g,v[L++]=he.b,v[L]=he.a}}},165:(Gr,xt,Te)=>{"use strict";Te.d(xt,{Mw:()=>Ie,NM:()=>L,Ru:()=>pe,Vm:()=>G,YF:()=>Qe,b8:()=>he,bk:()=>de,ic:()=>x,lf:()=>re,lg:()=>ot,md:()=>Ke,nC:()=>Re,xh:()=>st});var be=Te(5774),v=Te(3324),V=Te(4186),Le=Te(5460),xe=Te(2525),Je=Te(139);function st(P,w){if(!P||P.empty())return{x:0,y:0,width:0,height:0};if((0,V.isNodeJs)()&&"bbox"!==w||P.property("_batch_mode"))return{x:0,y:0,width:parseInt(P.attr("width")),height:parseInt(P.attr("height"))};const b=N=>{let O=P.style(N);return O&&(0,V.isStr)(O)?(O=parseFloat(O.replace("px","")),Number.isFinite(O)?Math.round(O):0):0};let g=P.node().getBoundingClientRect();"bbox"===w&&parseFloat(g.width)>0&&(g=P.node().getBBox());const C={x:0,y:0,width:parseInt(g.width),height:parseInt(g.height)};return void 0!==g.left?(C.x=parseInt(g.left),C.y=parseInt(g.top)):void 0!==g.x&&(C.x=parseInt(g.x),C.y=parseInt(g.y)),(void 0===w||"nopadding"===w)&&(C.width-=b("padding-left")+b("padding-right"),C.height-=b("padding-top")+b("padding-bottom")),C}function Ke(P,w){if(!w)return w;for(;!P.empty()&&!P.classed("root_canvas");){const b=P.attr("class");b&&(b.indexOf("root_frame")>=0||b.indexOf("__root_pad_")>=0)&&(w.x+=P.property("draw_x")||0,w.y+=P.property("draw_y")||0),P=(0,v.Lt)(P.node().parentNode)}return w}function ot(P,w,b){w||(w="6.4g");const g=(w=w.trim()).length;if(g<2)return b?[P.toFixed(4),"6.4f"]:P.toFixed(4);const C=w[g-1];let N,O=(w=w.slice(0,g-1)).indexOf(".");O=O<0?4:parseInt(w.slice(O+1)),(!Number.isInteger(O)||O<=0)&&(O=4);let H=!1;if("e"===C||"E"===C)N=!0;else if("Q"===C)N=!0,H=!0;else if("f"===C||"F"===C)N=!1;else if("W"===C)N=!1,H=!0;else{if("g"===C||"G"===C){const ie=ot(P,w+"Q",!0);let z=ot(P,w+"W",!0);return ie[0].length<z[0].length&&(z=ie),b?z:z[0]}N=!1,O=4}if(N){H&&O--,O<0&&(O=0);const ie=P.toExponential(O);return b?[ie,`5.${O}e`]:ie}let X=P.toFixed(O);if(H){0!==P&&0===Number(X)&&O>0&&(O=20,X=P.toFixed(O));let ie=0;for(;ie<X.length&&("0"===X[ie]||"-"===X[ie]||"."===X[ie]);)ie++;let z=X.length-ie-O;X.indexOf(".")>ie&&z--,0!==z&&(O-=z,O<0?O=0:O>20&&(O=20),X=P.toFixed(O))}return b?[X,"5."+O+"f"]:X}class Re{constructor(w){this.opt=(0,V.isStr)(w)?w.toUpperCase().trim():"",this.part=""}empty(){return 0===this.opt.length||0===this.opt.replace(/[ ;_,]/g,"").length}remain(){return this.opt}check(w,b){const g=this.opt.indexOf(w);if(g<0)return!1;if(this.opt=this.opt.slice(0,g)+this.opt.slice(g+w.length),this.part="",!b)return!0;let C=g;for(;C<this.opt.length&&" "!==this.opt[C]&&","!==this.opt[C]&&";"!==this.opt[C];)C++;if(C>g&&(this.part=this.opt.slice(g,C),this.opt=this.opt.slice(0,g)+this.opt.slice(C)),"color"!==b||(this.color=this.partAsInt(1)-1,this.color>=0))return!0;for(let N=0;N<8;++N)if((0,Je.oU)(N).toUpperCase()===this.part)return this.color=N,!0;return!1}partAsInt(w,b){let g=1;const C=this.part?this.part[this.part.length-1]:"";"K"===C?g=1e3:"M"===C?g=1e6:"G"===C&&(g=1e9);let N=this.part.replace(/^\D+/g,"");return N=N?parseInt(N,10):Number.NaN,Number.isInteger(N)?g*N+(w||0):b||0}partAsFloat(w,b){let g=this.part.replace(/^\D+/g,"");return g=g?parseFloat(g):Number.NaN,Number.isFinite(g)?g+(w||0):b||0}}class Qe{constructor(w){void 0!==w&&this.seed(w)}seed(w){(w=Math.abs(w))>1e8?w=Math.abs(1e8*Math.sin(w)):w<1&&(w*=1e8),this.m_w=Math.round(w),this.m_z=987654321}random(){if(void 0===this.m_z)return Math.random();this.m_z=36969*(65535&this.m_z)+(this.m_z>>16)&4294967295,this.m_w=18e3*(65535&this.m_w)+(this.m_w>>16)&4294967295;let w=(this.m_z<<16)+this.m_w&4294967295;return w/=4294967296,w+.5}}function Ie(P,w){w||(w={}),w.line?void 0===w.ndig&&(w.ndig=0):w.calc=!0;let b=P.length;if(b<3&&(w.line=!0),w.t=w.t??.2,void 0===w.ndig||w.height){w.maxy=P[0].gry,w.mindiff=100;for(let O=1;O<b;O++)w.maxy=Math.max(w.maxy,P[O].gry),w.mindiff=Math.min(w.mindiff,Math.abs(P[O].grx-P[O-1].grx),Math.abs(P[O].gry-P[O-1].gry));void 0===w.ndig&&(w.ndig=w.mindiff>20?0:w.mindiff>5?1:2)}const g=(O,H,X)=>{const ie=Math.sqrt((H.gry-O.gry)**2+(H.grx-O.grx)**2)*w.t,z=Math.atan2(H.dgry,H.dgrx),m=Math.atan2(X*(H.gry-O.gry),X*(H.grx-O.grx));O.dgrx=ie*Math.cos(2*m-z),O.dgry=ie*Math.sin(2*m-z)},C=O=>{if(!w.ndig||Math.round(O)===O)return O.toFixed(0);let H=O.toFixed(w.ndig),X=H.length-1;for(;"0"===H[X];)X--;return"."===H[X]&&X--,H=H.slice(0,X+1),"-0"===H?"0":H};if(w.calc){for(let O=1;O<b-1;O++)P[O].dgrx=(P[O+1].grx-P[O-1].grx)*w.t,P[O].dgry=(P[O+1].gry-P[O-1].gry)*w.t;b>2?(g(P[0],P[1],1),g(P[b-1],P[b-2],-1)):2===P.length&&(P[0].dgrx=(P[1].grx-P[0].grx)*w.t,P[0].dgry=(P[1].gry-P[0].gry)*w.t,P[1].dgrx=-P[0].dgrx,P[1].dgry=-P[0].dgry)}let N=`${w.cmd??"M"}${C(P[0].grx)},${C(P[0].gry)}`;if(w.line)if(b<1e4){let O=0,H=0,X=Math.round(P[0].grx),ie=Math.round(P[0].gry);const z=()=>{O&&(N+="h"+O,O=0),H&&(N+="v"+H,H=0)};for(let m=1;m<b;++m){const I=P[m],A=Math.round(I.grx)-X,R=Math.round(I.gry)-ie;A&&R?(z(),N+=`l${A},${R}`):!A&&R?((0===H||R<0!=H<0)&&z(),H+=R):A&&!R&&((0===O||A<0!=O<0)&&z(),O+=A),X+=A,ie+=R}z()}else{let O=Math.round(P[0].grx),H=Math.round(P[0].gry),X=H,ie=H,z=H;for(let m=1;m<b;++m){const I=P[m],A=Math.round(I.grx),R=Math.round(I.gry),k=A-O;if(0===k){X=Math.min(X,R),ie=Math.max(ie,R),z=R;continue}X!==ie&&(X!==H&&(N+="v"+(X-H)),N+="v"+(ie-X),ie!==z&&(N+="v"+(z-ie)),H=z);const ee=R-H;N+=ee?`l${k},${ee}`:`h${k}`,O=A,H=R,z=X=ie=R}X!==ie&&(X!==H&&(N+="v"+(X-H)),N+="v"+(ie-X),ie!==z&&(N+="v"+(z-ie)))}else{let O=1;w.qubic&&(b--,O++,N+=`Q${C(P[1].grx-P[1].dgrx)},${C(P[1].gry-P[1].dgry)},${C(P[1].grx)},${C(P[1].gry)}`),N+=`C${C(P[O-1].grx+P[O-1].dgrx)},${C(P[O-1].gry+P[O-1].dgry)},${C(P[O].grx-P[O].dgrx)},${C(P[O].gry-P[O].dgry)},${C(P[O].grx)},${C(P[O].gry)}`;for(let H=O+1;H<b;H++)N+=`S${C(P[H].grx-P[H].dgrx)},${C(P[H].gry-P[H].dgry)},${C(P[H].grx)},${C(P[H].gry)}`;w.qubic&&(N+=`Q${C(P[b].grx-P[b].dgrx)},${C(P[b].gry-P[b].dgry)},${C(P[b].grx)},${C(P[b].gry)}`)}return w.height&&(w.close=`L${C(P[P.length-1].grx)},${C(Math.max(w.maxy,w.height))}H${C(P[0].grx)}Z`),N}function L(P){return(P=P.replace(/url\(&quot;#(\w+)&quot;\)/g,"url(#$1)").replace(/ class="\w*"/g,"").replace(/ pad="\w*"/g,"").replace(/ title=""/g,"").replace(/<g objname="\w*" objtype="\w*"/g,"<g").replace(/<g transform="translate\(\d+,\d+\)"><\/g>/g,"").replace(/<g transform="translate\(\d+,\d+\)" style="display: none;"><\/g>/g,"").replace(/<g><\/g>/g,"")).replace(/<svg x="0" y="0" overflow="hidden" width="\d+" height="\d+" viewBox="0 0 \d+ \d+"><\/svg>/g,"")}class he{constructor(w){this.divid=null,w&&this.setDom(w)}setDom(w){void 0!==w&&(this.divid=w,delete this._selected_main)}getDom(){return this.divid}selectDom(w){if(!this.divid)return(0,v.Lt)(null);let b=this._selected_main;if(!b){if((0,V.isStr)(this.divid)){let O=this.divid;"#"!==O[0]&&(O="#"+O),b=(0,v.Lt)(O),b.empty()||(this.divid=b.node())}else b=(0,v.Lt)(this.divid);this._selected_main=b}if(!b||b.empty()||"origin"===w)return b;const g=b.property("use_enlarge"),N="simple"===(b.property("layout")||"simple")?"":b.property("layout_selector");return N&&(b=b.select(N)),!w&&!b.empty()&&g&&(b=(0,v.Lt)((0,V.getDocument)().getElementById("jsroot_enlarge_div"))),b}_accessTopPainter(w){const b=this.selectDom().node()?.firstChild;return b?(!0===w?b.painter=this:!1===w&&delete b.painter,b.painter):null}setTopPainter(){this._accessTopPainter(!0)}getTopPainter(){return this._accessTopPainter()}clearTopPainter(){this._accessTopPainter(!1)}cleanup(w){this.clearTopPainter();const b=this.selectDom("origin");!b.empty()&&!w&&b.html(""),this.divid=null,delete this._selected_main,(0,V.isFunc)(this._hpainter?.removePainter)&&this._hpainter.removePainter(this),delete this._hitemname,delete this._hdrawopt,delete this._hpainter}checkResize(){}testMainResize(w,b,g){const C=this.enlargeMain("state"),N=this.selectDom("origin"),O=this.selectDom();"on"!==C&&b?.width&&b?.height&&N.style("width",b.width+"px").style("height",b.height+"px");const X=st(N,!0),ie=N.attr("can_resize");let z=!1;"height"===ie&&g&&Math.abs(X.width*g-X.height)>.1*X.width&&(z=!0),(X.height<=5||X.width<=5)&&ie&&"false"!==ie&&(z=!0),z&&"on"!==C&&(X.width>5?(g=g||.66,N.style("height",Math.round(X.width*g)+"px")):"height"!==ie&&N.style("width","200px").style("height","100px"));const m=st(O),I=O.property("_jsroot_height"),A=O.property("_jsroot_width");return m.changed=!1,I&&A&&I>0&&A>0?(I!==m.height||A!==m.width)&&(m.changed=w>1||m.width/A<.99||m.width/A>1.01||m.height/I<.99||m.height/I>1.01):m.changed=!0,m.changed&&O.property("_jsroot_height",m.height).property("_jsroot_width",m.width),N.property("did_enlarge")&&(m.changed=!0,N.property("did_enlarge",!1)),m}enlargeMain(w,b){const g=this.selectDom(!0),C=this.selectDom("origin"),N=(0,V.getDocument)();if(g.empty()||!V.settings.CanEnlarge||!1===C.property("can_enlarge"))return!1;if(void 0===w||"verify"===w)return!0;const O=C.property("use_enlarge")?"on":"off";if("state"===w)return O;"toggle"===w&&(w="off"===O);let H=(0,v.Lt)(N.getElementById("jsroot_enlarge_div"));if(!0===w&&"on"!==O){if(!H.empty())return!1;H=(0,v.Lt)(N.body).append("div").attr("id","jsroot_enlarge_div").attr("style","position: fixed; margin: 0px; border: 0px; padding: 0px; left: 1px; top: 1px; bottom: 1px; right: 1px; background: white; opacity: 0.95; z-index: 100; overflow: hidden;");const X=st(g),ie=st(H);if((ie.width<=X.width||ie.height<=X.height)&&ie.width*ie.height<X.width*X.height)return b||console.log(`Enlarged area ${ie.width} x ${ie.height} smaller then original drawing ${X.width} x ${X.height}`),H.remove(),!1;for(;g.node().childNodes.length>0;)H.node().appendChild(g.node().firstChild);return C.property("use_enlarge",!0),C.property("did_enlarge",!0),!0}if(!1===w&&"off"!==O){for(;H.node()&&H.node().childNodes.length>0;)g.node().appendChild(H.node().firstChild);return H.remove(),C.property("use_enlarge",!1),C.property("did_enlarge",!0),!0}return!1}setItemName(w,b,g){(0,V.isStr)(w)?this._hitemname=w:delete this._hitemname,(0,V.isStr)(b)&&(this._hdrawopt=b),this._hpainter=g}getItemName(){return this._hitemname??null}getItemDrawOpt(){return this._hdrawopt??""}}function re(){return fe.apply(this,arguments)}function fe(){return(fe=(0,be.A)(function*(){return Te.e(398).then(Te.t.bind(Te,7398,19)).then(P=>(V.internals.nodejs_window||(V.internals.nodejs_window=new P.JSDOM("<!DOCTYPE html>hello").window,V.internals.nodejs_document=V.internals.nodejs_window.document,V.internals.nodejs_body=(0,v.Lt)(V.internals.nodejs_document).select("body")),{JSDOM:P.JSDOM,doc:V.internals.nodejs_document,body:V.internals.nodejs_body}))})).apply(this,arguments)}function de(P,w,b){(0,V.isObject)(P)||(b=w,w=P,P=null);const g=b?`translate(${w},${b})`:w?`translate(${w})`:null;return P?P.attr("transform",g):g}function pe(P,w){w?P.style("stroke","steelblue").style("fill-opacity","0.1"):P.style("stroke","#4572A7").style("fill","#4572A7").style("opacity","0")}function K(){return(K=(0,be.A)(function*(P,w){const b=(0,V.isNodeJs)();let g,C,N=!1;const O=b?Te.e(734).then(Te.bind(Te,2734)).then(I=>(g=I,Promise.all([Te.e(734),Te.e(937)]).then(Te.bind(Te,2937)))).then(I=>{C=I}):(0,V.loadScript)(V.source_dir+"scripts/jspdf.umd.min.js").then(()=>(0,V.loadScript)(V.source_dir+"scripts/svg2pdf.umd.min.js")).then(()=>{g=globalThis.jspdf,C=globalThis.svg2pdf}),H=[],X=[],ie=[],z=P.node.getAttribute("transform"),m={};return P.reset_tranform&&P.node.removeAttribute("transform"),O.then(()=>{if((0,v.Lt)(P.node).selectAll("g").each(function(){this.hasAttribute("font-family")&&"Courier New"===this.getAttribute("font-family")&&(this.setAttribute("font-family","courier"),P.can_modify||H.push(this))}),(0,v.Lt)(P.node).selectAll("text").each(function(){this.hasAttribute("dominant-baseline")?(this.setAttribute("dy",".2em"),this.removeAttribute("dominant-baseline"),P.can_modify||X.push(this)):P.can_modify&&b&&".4em"===this.getAttribute("dy")&&this.setAttribute("dy",".2em"),(0,xe.cp)(this)&&(N=!0,P.can_modify||ie.push(this))}),b){const R=V.internals.nodejs_document;R.oldFunc=R.createElementNS,globalThis.document=R,globalThis.CSSStyleSheet=V.internals.nodejs_window.CSSStyleSheet,globalThis.CSSStyleRule=V.internals.nodejs_window.CSSStyleRule,R.createElementNS=function(k,ee){const ge=R.oldFunc(k,ee);return ge.getBBox=function(){let ve=50,Se=10;if("text"===this.tagName){const De=(0,Le.dj)(this);ve=(0,xe.N7)(this.textContent,De),Se=De.size}return{x:0,y:0,width:ve,height:Se}},ge}}const I=new g.jsPDF({orientation:"landscape",unit:"px",format:[P.width+10,P.height+10]});(0,v.Lt)(P.node).selectAll("style").each(function(){const R=this.$fonthandler;if(!R||m[R.name]||"ttf"!==R.format)return;const k=R.name.toLowerCase().replace(/\s/g,"")+".ttf";I.addFileToVFS(k,R.base64),I.addFont(k,R.name,"normal","normal","symbol"===R.name?"StandardEncoding":"Identity-H"),m[R.name]=!0});let A=Promise.resolve(!0);return N&&!m.symbol&&((0,Le.Zq)("symbol")||(A=b?Te.e(926).then(Te.t.bind(Te,3926,19)).then(R=>{const k=R.readFileSync("../../fonts/symbol.ttf").toString("base64");console.log("reading symbol.ttf",k.length),(0,Le.uT)(25,"symbol","ttf",k)}):(0,V.httpRequest)(V.source_dir+"fonts/symbol.ttf","bin").then(R=>{const k=(0,V.btoa_func)(R);(0,Le.uT)(25,"symbol","ttf",k)})),A=A.then(()=>{const R=(0,Le.Zq)("symbol"),k=new Le.qg(1242,10);k.name="symbol",k.base64=R.base64,k.addCustomFontToSvg((0,v.Lt)(P.node)),I.addFileToVFS("symbol.ttf",R.base64),I.addFont("symbol.ttf","symbol","normal","normal","StandardEncoding")})),A.then(()=>C.svg2pdf(P.node,I,{x:5,y:5,width:P.width,height:P.height})).then(()=>{P.reset_tranform&&!P.can_modify&&z&&P.node.setAttribute("transform",z),H.forEach(k=>k.setAttribute("font-family","Courier New")),X.forEach(k=>{k.setAttribute("dominant-baseline","middle"),k.removeAttribute("dy")}),ie.forEach(k=>{k.innerHTML=k.$originalHTML});const R=I.output(w?"arraybuffer":"dataurlstring");return b&&(globalThis.document=void 0,globalThis.CSSStyleSheet=void 0,globalThis.CSSStyleRule=void 0,V.internals.nodejs_document.createElementNS=V.internals.nodejs_document.oldFunc,w)?Buffer.from(R):R})})})).apply(this,arguments)}function G(P,w,b){return D.apply(this,arguments)}function D(){return D=(0,be.A)(function*(P,w,b){if("svg"===w)return P;if("pdf"===w)return function ce(P,w){return K.apply(this,arguments)}(P,b);P=(P=encodeURIComponent('<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'+P)).replace(/%([0-9A-F]{2})/g,(N,O)=>{const H=String.fromCharCode("0x"+O);return"%"===H?"%25":H}),P=decodeURIComponent(P);const C="data:image/svg+xml;base64,"+(0,V.btoa_func)(P);return(0,V.isNodeJs)()?Te.e(511).then(Te.t.bind(Te,1511,19)).then(function(){var N=(0,be.A)(function*(O){return O.default.loadImage(C).then(H=>{const X=O.default.createCanvas(H.width,H.height);return X.getContext("2d").drawImage(H,0,0,H.width,H.height),b?X.toBuffer("image/"+w):w?X.toDataURL("image/"+w):X})});return function(O){return N.apply(this,arguments)}}()):new Promise(N=>{const O=document.createElement("img");O.onload=function(){const H=document.createElement("canvas");H.width=O.width,H.height=O.height,H.getContext("2d").drawImage(O,0,0),b&&w?H.toBlob(X=>X.arrayBuffer().then(N),"image/"+w):N(w?H.toDataURL("image/"+w):H)},O.onerror=function(H){console.log(`IMAGE ERROR ${H}`),N(null)},O.src=C})}),D.apply(this,arguments)}function x(P){let w="";if(V.settings.TimeZone&&(0,V.isStr)(V.settings.TimeZone))try{w=P.toLocaleString("en-GB",{timeZone:V.settings.TimeZone})}catch{w=""}return w||P.toLocaleString("en-GB")}},5460:(Gr,xt,Te)=>{"use strict";Te.d(xt,{Zq:()=>Re,dj:()=>Qe,qg:()=>Ke,uT:()=>ot});const be="Arial",v="Times New Roman",V="Courier New",Le="Verdana",xe="Symbol",Je="Wingdings",st=[null,{n:v,s:"italic",aw:.5314},{n:v,w:"bold",aw:.5809},{n:v,s:"italic",w:"bold",aw:.554},{n:be,aw:.5778},{n:be,s:"oblique",aw:.5783},{n:be,w:"bold",aw:.6034},{n:be,s:"oblique",w:"bold",aw:.603},{n:V,aw:.6003},{n:V,s:"oblique",aw:.6004},{n:V,w:"bold",aw:.6003},{n:V,s:"oblique",w:"bold",aw:.6005},{n:xe,aw:.5521},{n:v,aw:.5521},{n:Je,aw:.5664},{n:xe,s:"italic",aw:.5314},{n:Le,aw:.5664},{n:Le,s:"italic",aw:.5495},{n:Le,w:"bold",aw:.5748},{n:Le,s:"italic",w:"bold",aw:.5578}];class Ke{constructor(L,he,re){re&&he<1&&(he*=re,this.scaled=!0),this.size=Math.round(he||11),this.scale=re,this.func=this.setFont.bind(this);const fe=L&&Number.isInteger(L)?Math.floor(L/10):0,de=st[fe];de?this.setNameStyleWeight(de.n,de.s,de.w,de.aw,de.format,de.base64):this.setNameStyleWeight(be)}setNameStyleWeight(L,he,re,fe,de,pe){this.name=L,this.style=he||null,this.weight=re||null,this.aver_width=fe||(re?.58:.55),this.format=de,this.base64=pe,this.name===xe||this.name===Je?(this.isSymbol=this.name,this.name=v):this.isSymbol=""}setPainter(L){this.painter=L}addCustomFontToSvg(L){if(!this.base64||!this.name)return;const he="custom_font_"+this.name;let fe=L.selectChild(".canvas_defs");fe.empty()&&(fe=L.insert("svg:defs",":first-child").attr("class","canvas_defs")),fe.selectChild("."+he).empty()&&(console.log("Adding style entry for class",he),fe.append("style").attr("class",he).property("$fonthandler",this).text(`@font-face { font-family: "${this.name}"; font-weight: normal; font-style: normal; src: url(data:application/font-ttf;charset=utf-8;base64,${this.base64}); }`))}setFont(L){this.base64&&this.painter&&this.addCustomFontToSvg(this.painter.getCanvSvg()),L.attr("font-family",this.name).attr("font-size",this.size).attr("xml:space","preserve").attr("font-weight",this.weight||null).attr("font-style",this.style||null)}setSize(L){this.size=Math.round(L)}setColor(L){this.color=L}setAlign(L){this.align=L}setAngle(L){this.angle=L}roundAngle(L,he){this.angle=parseInt(this.angle||0),Number.isInteger(this.angle)||(this.angle=0),this.angle=Math.round(this.angle/L)*L+(he||0),this.angle<0?this.angle+=360:this.angle>=360&&(this.angle-=360)}clearFont(L){L.attr("font-family",null).attr("font-size",null).attr("xml:space",null).attr("font-weight",null).attr("font-style",null)}isMonospace(){const L=this.name.toLowerCase();return 0===L.indexOf("courier")||"monospace"===L||"monaco"===L}getFontHtml(){let L=Math.round(this.size)+"pt "+this.name;return this.weight&&(L+=" "+this.weight),this.style&&(L+=" "+this.style),L}getFontName(){return this.isSymbol||this.name||"none"}}function ot(Ie,L,he,re){Number.isInteger(Ie)?st[Ie]={n:L,format:he,base64:re}:console.error(`Wrong index ${Ie} for custom font`)}function Re(Ie){return st.find(L=>L?.n===Ie&&L?.base64)}function Qe(Ie){const L=Ie.getAttribute("font-size"),he=Ie.getAttribute("font-family"),re=L.indexOf("px"),fe=re>0?Number.parseInt(L.slice(0,re)):12;let de=Ie.getAttribute("font-style"),pe=Ie.getAttribute("font-weight"),ce=null,K="";"normal"===pe?pe="":"bold"===pe&&(K+="b"),"normal"===de?de="":"italic"===de?K+="i":"oblique"===de&&(K+="o"),"arial"===he?K+="Arial":"times"===he?K+="Times New Roman":"verdana"===he&&(K+="Verdana");for(let D=1;D<st.length;++D)if(K===st[D]){ce=10*D+2;break}const G=new Ke(ce,fe);return ce||G.setNameStyleWeight(he,de,pe),G}},2481:(Gr,xt,Te)=>{"use strict";Te.d(xt,{rb:()=>D,JW:()=>Ie,tP:()=>G,as:()=>L,OZ:()=>ce,m6:()=>he,Nn:()=>re,Z_:()=>w,ei:()=>x,UV:()=>P,Yu:()=>b,XR:()=>K,QD:()=>pe});var be=Te(5774),v=Te(3324),V=Te(4186),Le=Te(2525),xe=Te(165),Je=Te(7952),st=Te(139);class Ke{constructor(C){this.color="none",this.colorindx=0,this.pattern=0,this.used=!0,this.kind=C.kind||2,this.changed=!1,this.func=this.apply.bind(this),this.setArgs(C),this.changed=!1}setArgs(C){(0,V.isObject)(C.attr)&&(void 0===C.pattern&&void 0!==C.attr.fFillStyle&&(C.pattern=C.attr.fFillStyle),void 0===C.color&&void 0!==C.attr.fFillColor&&(C.color=C.attr.fFillColor));const N=this.changed;this.change(C.color,C.pattern,C.svg,C.color_as_svg,C.painter),this.changed=N}apply(C){this.used=!0,C.style("fill",this.getFillColor()),"opacity"in this&&C.style("opacity",this.opacity),"antialias"in this&&C.style("antialias",this.antialias)}getFillColor(){return this.pattern_url||this.color}getFillColorAlt(C){return this.color&&"none"!==this.color?this.color:C}empty(){const C=this.getFillColor();return!C||"none"===C}setUsed(C){this.used=C}hasColor(){return this.color&&"none"!==this.color}setSolidColor(C){delete this.pattern_url,this.color=C,this.pattern=1001}setOpacity(C){this.opacity=C}isSolid(C){return!(1001!==this.pattern||this.gradient||C&&C!==this.color)}verifyDirectChange(C){(0,V.isStr)(this.pattern)&&(this.pattern=parseInt(this.pattern)),Number.isInteger(this.pattern)||(this.pattern=0),this.change(this.color,this.pattern,C?C.getCanvSvg():null,!0,C)}change(C,N,O,H,X){if(delete this.pattern_url,delete this.gradient,this.changed=!0,void 0!==C&&Number.isInteger(parseInt(C))&&!H&&(this.colorindx=parseInt(C)),void 0!==N&&Number.isInteger(parseInt(N))&&(this.pattern=parseInt(N),delete this.opacity,delete this.antialias),1e3===this.pattern&&0===this.colorindx)return this.pattern_url="white",!0;if(1e3===this.pattern&&(this.pattern=1001),this.pattern<1001)return this.pattern_url="none",!0;if(this.isSolid()&&0===this.colorindx&&1===this.kind&&!H)return this.pattern_url="none",!0;let ie=this.colorindx;if(H?(this.color=C,"none"!==C&&(ie=(0,v.yW)(C).hex().slice(1))):this.color=X?X.getColor(ie):(0,st.oU)(ie),(0,V.isStr)(this.color)||((0,V.isObject)(this.color)&&(this.color?._typename===st.pX||this.color?._typename===st.ho)&&(this.gradient=this.color),this.color="none"),this.isSolid())return!0;if(!this.gradient){if(this.pattern>=4e3&&this.pattern<=4100)return this.opacity=(this.pattern-4e3)/100,!0;if(this.pattern<3e3||"none"===this.color)return!1}if(!O||O.empty())return!1;let z="",m="",I=null,A="",R="",k=2,ee=2;if(this.gradient)z=`grad_${this.gradient.fNumber}`;else{switch(z=`pat_${this.pattern}_${ie}`,this.pattern){case 3001:k=ee=2,A="M0,0h1v1h-1zM1,1h1v1h-1z";break;case 3002:k=4,ee=2,A="M1,0h1v1h-1zM3,1h1v1h-1z";break;case 3003:k=ee=4,A="M2,1h1v1h-1zM0,3h1v1h-1z";break;case 3004:k=ee=8,m="M8,0L0,8";break;case 3005:k=ee=8,m="M0,0L8,8";break;case 3006:k=ee=4,m="M1,0v4";break;case 3007:k=ee=4,m="M0,1h4";break;case 3008:k=ee=10,A="M0,3v-3h3ZM7,0h3v3ZM0,7v3h3ZM7,10h3v-3ZM5,2l3,3l-3,3l-3,-3Z",m="M0,3l5,5M3,10l5,-5M10,7l-5,-5M7,0l-5,5";break;case 3009:k=12,ee=12,m="M0,0A6,6,0,0,0,12,0M6,6A6,6,0,0,0,12,12M6,6A6,6,0,0,1,0,12",I="none";break;case 3010:k=ee=10,m="M0,2h10M0,7h10M2,0v2M7,2v5M2,7v3";break;case 3011:k=9,ee=18,m="M5,0v8M2,1l6,6M8,1l-6,6M9,9v8M6,10l3,3l-3,3M0,9v8M3,10l-3,3l3,3",I="none";break;case 3012:k=10,ee=20,m="M5,1A4,4,0,0,0,5,9A4,4,0,0,0,5,1M0,11A4,4,0,0,1,0,19M10,11A4,4,0,0,0,10,19",I="none";break;case 3013:k=ee=7,m="M0,0L7,7M7,0L0,7",I="none";break;case 3014:k=ee=16,m="M0,0h16v16h-16v-16M0,12h16M12,0v16M4,0v8M4,4h8M0,8h8M8,4v8",I="none";break;case 3015:k=6,ee=12,m="M2,1A2,2,0,0,0,2,5A2,2,0,0,0,2,1M0,7A2,2,0,0,1,0,11M6,7A2,2,0,0,0,6,11",I="none";break;case 3016:k=12,ee=7,m="M0,1A3,2,0,0,1,3,3A3,2,0,0,0,9,3A3,2,0,0,1,12,1",I="none";break;case 3017:k=ee=4,m="M3,1l-2,2";break;case 3018:k=ee=4,m="M1,1l2,2";break;case 3019:k=ee=12,m="M1,6A5,5,0,0,0,11,6A5,5,0,0,0,1,6h-1h1A5,5,0,0,1,6,11v1v-1A5,5,0,0,1,11,6h1h-1A5,5,0,0,1,6,1v-1v1A5,5,0,0,1,1,6",I="none";break;case 3020:k=7,ee=12,m="M1,0A2,3,0,0,0,3,3A2,3,0,0,1,3,9A2,3,0,0,0,1,12",I="none";break;case 3021:k=ee=8,m="M8,2h-2v4h-4v2M2,0v2h-2",I="none";break;case 3022:k=ee=8,m="M0,2h2v4h4v2M6,0v2h2",I="none";break;case 3023:k=ee=8,A="M4,0h4v4zM8,4v4h-4z",R="M4,0L0,4L4,8L8,4Z";break;case 3024:k=ee=16,A="M0,8v8h2v-8zM8,0v8h2v-8M4,14v2h12v-2z",R="M0,2h8v6h4v-6h4v12h-12v-6h-4z";break;case 3025:k=ee=18,A="M5,13v-8h8ZM18,0v18h-18l5,-5h8v-8Z";break;default:{if(this.pattern>3025&&this.pattern<3100){k=4,ee=2,A="M1,0h1v1h-1zM3,1h1v1h-1z";break}const ve=this.pattern%1e3,Se=ve%10,De=(ve-Se)%100/10,Xe=(ve-10*De-Se)/100;if(!Xe)break;const ct=De===Se||0===De||5===De||9===De||0===Se||5===Se||9===Se,$=X?.getPadPainter(),tt=$?Math.max($.getPadWidth(),$.getPadHeight()):600,We=Math.max(.1,V.gStyle.fHatchesSpacing*tt*.001),Ne=6*Math.max(1,Math.round(We)),Fe=Xe*Ne;z+=ct?`_hn${Math.round(100*We)}`:`_ho${Ne}`,k=ee=6*Fe;const dt=ct?(Yt,kt,Tt,fn)=>{if(0===Tt||90===Tt){const Zn=Math.round(ee/(Xe*We*3)),ui=ee/Zn;let hi=ui/2;for(;hi<ee;)m+=0===Tt?`M0,${Math.round(hi)}h${k}`:`M${Math.round(hi)},0v${ee}`,hi+=ui;return}const ln=Tt/180*Math.PI,mn=Xe*We*3/Math.cos(ln),jt=Math.tan(ln)*k,cn=jt/Math.round(jt/mn),gn=Math.floor(ee/cn);ee=Math.round(gn*cn);let Cn=gn*cn;for(;Math.abs(Cn-ee)<.1;)Cn-=cn;for(;Cn+jt>0;){let Ln=0,Zn=Cn,ui=k,hi=Cn+jt;Zn<-1e-5?(Ln=-Zn/jt*k,Zn=0):hi>ee&&(ui=(ee-Zn)/jt*k,hi=ee),fn&&(Ln=k-Ln,ui=k-ui),m+=`M${Math.round(Ln)},${Math.round(Zn)}L${Math.round(ui)},${Math.round(hi)}`,Cn-=cn}}:(Yt,kt)=>{const Tt=[];let jt,Sn,cn,fn=Fe,ln=0,mn=ee;for(Math.abs(Yt)<3&&(fn=Math.round(Fe/12*9)),0===Yt?(fn=Math.round(Fe/12*8),ln=fn/2):Yt>0?mn-=fn:ln=fn;ln<=mn;)jt=ln+Yt*fn,jt<0?(cn=Math.round(ln/(ln-jt)*k),Tt.push(0,ln,cn,0),Tt.push(k,ee-ln,k-cn,ee)):jt>ee?(cn=Math.round((ee-ln)/(jt-ln)*k),Tt.push(0,ln,cn,ee),Tt.push(k,ee-ln,k-cn,0)):Tt.push(0,ln,k,jt),ln+=fn;for(let gn=0;gn<Tt.length;gn+=4)kt?(Sn=Tt[gn+1],ln=Tt[gn],cn=Tt[gn+3],jt=Tt[gn+2]):(Sn=Tt[gn],ln=Tt[gn+1],cn=Tt[gn+2],jt=Tt[gn+3]),m+=`M${Sn},${ln}`,m+=jt===ln?"h"+(cn-Sn):cn===Sn?"v"+(jt-ln):`L${cn},${jt}`};let rt=!1,_t=!1;switch(De){case 0:rt=!0;break;case 1:dt(1,!1,10);break;case 2:dt(2,!1,20);break;case 3:dt(3,!1,30);break;case 4:dt(6,!1,45);break;case 6:dt(3,!0,60);break;case 7:dt(2,!0,70);break;case 8:dt(1,!0,80);break;case 9:_t=!0}switch(Se){case 0:rt=!0;break;case 1:dt(-1,!1,10,!0);break;case 2:dt(-2,!1,20,!0);break;case 3:dt(-3,!1,30,!0);break;case 4:dt(-6,!1,45,!0);break;case 6:dt(-3,!0,60,!0);break;case 7:dt(-2,!0,70,!0);break;case 8:dt(-1,!0,80,!0);break;case 9:_t=!0}rt&&dt(0,!1,0),_t&&dt(0,!0,90);break}}if(!A&&!m)return!1}this.pattern_url=`url(#${z})`,this.antialias=!1;let ge=O.selectChild(".canvas_defs");if(ge.empty()&&(ge=O.insert("svg:defs",":first-child").attr("class","canvas_defs")),ge.selectChild("."+z).empty())if(this.gradient){const ve=this.gradient._typename===st.pX,Se=ge.append(ve?"svg:linearGradient":"svg:radialGradient").attr("id",z).attr("class",z),De=Xe=>Xe===Math.round(Xe)?Xe.toFixed(0):Xe.toFixed(2);ve?Se.attr("x1",De(this.gradient.fStart.fX)).attr("y1",De(1-this.gradient.fStart.fY)).attr("x2",De(this.gradient.fEnd.fX)).attr("y2",De(1-this.gradient.fEnd.fY)):Se.attr("cx",De(this.gradient.fStart.fX)).attr("cy",De(1-this.gradient.fStart.fY)).attr("cr",De(this.gradient.fR1));for(let Xe=0;Xe<this.gradient.fColorPositions.length;++Xe){const ct=this.gradient.fColorPositions[Xe],$="#"+(0,st.nj)(this.gradient.fColors[4*Xe])+(0,st.nj)(this.gradient.fColors[4*Xe+1])+(0,st.nj)(this.gradient.fColors[4*Xe+2]);Se.append("svg:stop").attr("offset",`${Math.round(100*ct)}%`).attr("stop-color",$).attr("stop-opacity",`${Math.round(100*this.gradient.fColors[4*Xe+3])}%`)}}else{const ve=ge.append("svg:pattern").attr("id",z).attr("class",z).attr("patternUnits","userSpaceOnUse").attr("width",k).attr("height",ee);if(R){const Se=(0,v.Qh)(this.color);Se.r=Math.round((Se.r+255)/2),Se.g=Math.round((Se.g+255)/2),Se.b=Math.round((Se.b+255)/2),ve.append("svg:path").attr("d",R).style("fill",Se)}A&&ve.append("svg:path").attr("d",A).style("fill",this.color),m&&ve.append("svg:path").attr("d",m).style("stroke",this.color).style("stroke-width",V.gStyle.fHatchesLineWidth||1).style("fill",I)}return!0}createSample(C,N,O,H){H&&(C=(0,v.Lt)(C));const X=new Ke({svg:C,pattern:this.pattern,color:this.color,color_as_svg:!0});C.append("path").attr("d",`M0,0h${N}v${O}h${-N}z`).call(X.func)}saveToStyle(C,N){if(C){const O=this.colorindx??(0,st.vB)(this.color);O>=0&&(V.gStyle[C]=O)}N&&(V.gStyle[N]=this.pattern)}}var ot=Te(9248);class Re{constructor(C){this.used=!0,C._typename&&void 0!==C.fTextFont&&(C={attr:C}),this.setArgs(C)}setArgs(C){C.attr?(C.font=C.attr.fTextFont||C.attr_alt?.fTextFont||0,C.size=C.attr.fTextSize||C.attr_alt?.fTextSize||0,this.color_index=C.attr.fTextColor||C.attr_alt?.fTextColor||0,C.color=C.painter?.getColor(this.color_index)??(0,st.oU)(this.color_index),C.align=C.attr.fTextAlign||C.attr_alt?.fTextAlign||0,C.angle=C.attr.fTextAngle||C.attr_alt?.fTextAngle||0):"number"==typeof C.color&&(this.color_index=C.color,C.color=C.painter?.getColor(C.color)??(0,st.oU)(C.color)),this.font=C.font,this.size=C.size,this.color=C.color,this.align=C.align,this.angle=C.angle,this.can_rotate=C.can_rotate??!0,this.angle_used=!1,this.align_used=!1}empty(){return"none"===this.color}change(C,N,O,H,X){void 0!==C&&(this.font=C),void 0!==N&&(this.size=N),void 0!==O&&(this.color!==O&&delete this.color_index,this.color=O),void 0!==H&&(this.align=H),void 0!==X&&(this.angle=X),this.changed=!0}verifyDirectChange(){this.change(parseInt(this.font),parseFloat(this.size),this.color,parseInt(this.align),parseInt(this.angle))}createArg(C){return C||(C={}),this.align_used=!C.noalign&&!C.align,this.align_used&&(C.align=this.align),this.angle_used=!C.norotate&&this.can_rotate,this.angle_used&&this.angle&&(C.rotate=-this.angle),C.color=this.color||"black",C}getSize(C,N,O,H){return this.size>=1?Math.round(this.size):(C||(C=1e3),N||(N=C),O||(O=1),Math.round((this.size||H||0)*Math.min(C,N)*O))}getAltSize(C,N){return C||(C=this.size),Math.round(C>=1?C:C*N)}getGedFont(){return Math.floor(this.font/10)}setGedFont(C){const N=parseInt(C);return N>0&&N<17&&this.change(10*N+this.font%10),this.font}}var Qe=Te(5460);class Ie extends xe.b8{constructor(C,N,O){super(C),this.pad_name=C?this.selectCurrentPad():"",this.assignObject(N),(0,V.isStr)(O)&&(this.options={original:O})}assignObject(C){(0,V.isObject)(C)?this.draw_object=C:delete this.draw_object}setPadName(C){this.pad_name=(0,V.isStr)(C)?C:this.selectCurrentPad()}getPadName(){return this.pad_name||""}isBatchMode(){return!!(0,V.isBatchMode)()||(this.getCanvPainter()?.isBatchMode()??!1)}assignSnapId(C){this.snapid=C}cleanup(){this.removeG();let C=!0;if(this.isMainPainter()){const N=this.getPadPainter();(!N||!1===N.normal_canvas)&&(C=!1)}delete this.pad_name,delete this._main_painter,this.draw_object=null,delete this.snapid,delete this.fillatt,delete this.lineatt,delete this.markeratt,delete this.bins,delete this.root_colors,delete this.options,delete this.options_store,delete this.rstyle,delete this.csstype,super.cleanup(C)}getObject(){return this.draw_object}getObjectName(){return this.getObject()?.fName??""}getClassName(){return this.getObject()?._typename??""}matchObjectType(C){const N=this.getClassName();return!(!C||!N)&&((0,V.isStr)(C)?C===N:(0,V.isStr)(C._typename)?C._typename===N:N.match(C))}setItemName(C,N,O){if(super.setItemName(C,N,O),this.no_default_title||!C)return;const H=this.getCanvSvg();H.empty()?this.selectDom().attr("title",C):H.select("title").text(C);const X=this.getCanvPainter();X&&(X===this||this.isMainPainter()&&X===this.getPadPainter())&&X.drawItemNameOnCanvas(C)}storeDrawOpt(C){if(!this.options)return;C||(C="");const N=C.indexOf(";;");N>=0&&(C=C.slice(0,N)),this.options.original=C,this.options_store=Object.assign({},this.options)}getDrawOpt(C){if(!this.options)return"";if((0,V.isFunc)(this.options.asString)){let N=!1;const O=this.getPadPainter();if(!this.options_store||O?._interactively_changed)N=!0;else for(const H in this.options_store)this.options[H]!==this.options_store[H]&&"_"!==H[0]&&"$"!==H[0]&&H[0].toLowerCase()!==H[0]&&(N=!0);if(N&&(0,V.isFunc)(this.options.asString))return this.options.asString(this.isMainPainter(),C?null:O?.getRootPad())}return this.options.original||""}getSupportedDrawOptions(){const C=this.getPadPainter(),N=this.getClassName();return N&&(0,V.isFunc)(C?.getObjectDrawSettings)?C.getObjectDrawSettings(V.prROOT+N,"nosame")?.opts:[]}redrawObject(C,N){if(!this.updateObject(C,N))return!1;const O=(0,V.getDocument)(),H=O.body.style.cursor;document.body.style.cursor="wait";const X=this.redrawPad();return O.body.style.cursor=H,X}updateObject(C){return!!this.matchObjectType(C)&&(Object.assign(this.getObject(),C),!0)}getObjectHint(){const C=this.getItemName();return C?C.length>20?"..."+C.slice(C.length-17):C:this.getObjectName()||this.getClassName()||""}getColor(C){return this.root_colors||(this.root_colors=this.getCanvPainter()?.root_colors||(0,st.HG)()),this.root_colors[C]}addColor(C){this.root_colors||(this.root_colors=this.getCanvPainter()?.root_colors||(0,st.HG)());const N=this.root_colors.indexOf(C);return N>=0?N:(this.root_colors.push(C),this.root_colors.length-1)}isTooltipAllowed(){return(this.getCanvPainter()||this).tooltip_allowed}setTooltipAllowed(C){void 0===C&&(C=!0);const N=this.getCanvPainter()||this;N.tooltip_allowed="toggle"===C?!N.tooltip_allowed:C}checkResize(C){return this.getCanvPainter()?.checkCanvasResize(C)}removeG(){this.draw_g?.remove(),delete this.draw_g}getG(){return this.draw_g}createG(C){let N;if(C){const X=this.getFrameSvg();if(X.empty())return console.error("Not found frame to create g element inside"),X;(0,V.isStr)(C)||(C="main_layer"),N=X.selectChild("."+C)}else N=this.getLayerSvg("primitives_layer");this.draw_g&&this.draw_g.node().parentNode!==N.node()&&(console.log("g element changes its layer!!"),this.removeG()),this.draw_g?this.draw_g.selectAll("*").remove():(this.draw_g=N.append("svg:g"),C||N.selectChildren(".most_upper_primitives").raise());const O=this.getClassName(),H=this.getObjectName();return(H||O)&&this.draw_g.attr("objname",(H||"name").replace(/[^\w]/g,"_")).attr("objtype",(O||"type").replace(/[^\w]/g,"_")),this.draw_g.property("in_frame",!!C),this.draw_g}bringToFront(C){if(!this.draw_g||(this.draw_g.node().parentNode?.appendChild(this.draw_g.node()),!C||!this.snapid))return;const O=this.getPadPainter();O?.snapid&&this.getCanvPainter()?.sendWebsocket("POPOBJ:"+JSON.stringify([O.snapid.toString(),this.snapid.toString()]))}getCanvSvg(){return this.selectDom().select(".root_canvas")}getPadSvg(C){void 0===C&&(C=this.pad_name);let N=this.getCanvSvg();if(!C||N.empty())return N;const O=N.property("pad_painter");return O?.pads_cache&&O.pads_cache[C]?(0,v.Lt)(O.pads_cache[C]):(N=N.select(".primitives_layer .__root_pad_"+C),O&&(O.pads_cache||(O.pads_cache={}),O.pads_cache[C]=N.node()),N)}getUniqueId(C=!1){return!C&&void 0===this._unique_painter_id&&(this._unique_painter_id=V.internals.id_counter++),this._unique_painter_id}setSecondaryId(C,N){this._main_painter_id=C.getUniqueId(),this._secondary_id=N}isSecondary(C){return void 0!==this._main_painter_id&&(!(0,V.isObject)(C)||this._main_painter_id===C.getUniqueId(!0))}getSnapId(C){return this.snapid?this.snapid.toString()+(C?"#"+C:""):""}getLayerSvg(C,N){let O=this.getPadSvg(N);return O.empty()?O:(0===C.indexOf("prim#")&&(O=O.selectChild(".primitives_layer"),C=C.slice(5)),O.selectChild("."+C))}selectCurrentPad(C){const N=this.getCanvSvg();if(N.empty())return"";const O=N.property("current_pad");return void 0!==C&&N.property("current_pad",C),O}getPadPainter(C){const N=this.getPadSvg((0,V.isStr)(C)?C:void 0);return N.empty()?null:N.property("pad_painter")}getCanvPainter(){const C=this.getCanvSvg();return C.empty()?null:C.property("pad_painter")}getAxisToSvgFunc(C,N,O){const H={isndc:C,nornd:N},X=this.draw_g?.property("in_frame");if((X||O&&!C)&&(H.main=this.getFramePainter()),H.main?.grx&&H.main?.gry)H.x0=O&&!C?H.main.getFrameX():0,H.y0=O&&!C?H.main.getFrameY():0,N?(H.x=function(ie){return this.x0+this.main.grx(ie)},H.y=function(ie){return this.y0+this.main.gry(ie)}):(H.x=function(ie){return this.x0+Math.round(this.main.grx(ie))},H.y=function(ie){return this.y0+Math.round(this.main.gry(ie))});else if(X)console.error(`Problem to create functor for ${this.getClassName()}`),H.x=()=>0,H.y=()=>0;else{const ie=this.getPadPainter();C||(H.pad=ie?.getRootPad(!0)),H.padw=ie?.getPadWidth()??10,H.x=function(z){return this.pad&&(this.pad.fLogx&&(z=z>0?Math.log10(z):this.pad.fUxmin),z=(z-this.pad.fX1)/(this.pad.fX2-this.pad.fX1)),z*=this.padw,this.nornd?z:Math.round(z)},H.padh=ie?.getPadHeight()??10,H.y=function(z){return this.pad&&(this.pad.fLogy&&(z=z>0?Math.log10(z):this.pad.fUymin),z=(z-this.pad.fY1)/(this.pad.fY2-this.pad.fY1)),z=(1-z)*this.padh,this.nornd?z:Math.round(z)}}return H}axisToSvg(C,N,O,H){return this.getAxisToSvgFunc(O,H)[C](N)}svgToAxis(C,N,O){if(this.draw_g?.property("in_frame"))return this.getFramePainter()?.revertAxis(C,N)??0;const X=this.getPadPainter(),ie=O||!X?null:X.getRootPad(!0);let z=X?"y"===C?1-N/X.getPadHeight():N/X.getPadWidth():0;return ie&&("y"===C?(z=ie.fY1+z*(ie.fY2-ie.fY1),ie.fLogy&&(z=Math.pow(10,z))):(z=ie.fX1+z*(ie.fX2-ie.fX1),ie.fLogx&&(z=Math.pow(10,z)))),z}getFrameSvg(C){const N=this.getLayerSvg("primitives_layer",C);if(N.empty())return N;let O=N.node().firstChild;for(;O;){const H=(0,v.Lt)(O);if(H.classed("root_frame"))return H;O=O.nextSibling}return(0,v.Lt)(null)}getFramePainter(){return this.getPadPainter()?.getFramePainter()}getMainPainter(C){let N=this._main_painter;if(!N){const O=this.getPadPainter();N=O?O.getMainPainter():this.getTopPainter(),N||(N=null),C||(this._main_painter=N)}return N}isMainPainter(){return this===this.getMainPainter()}setAsMainPainter(C){const N=this.getPadPainter();N?N.setMainPainter(this,C):this.setTopPainter()}addToPadPrimitives(C){void 0!==C&&this.setPadName(C);const N=this.getPadPainter(C);return!(!N||N===this||(N.painters.indexOf(this)<0&&N.painters.push(this),!this.rstyle&&N.next_rstyle&&(this.rstyle=N.next_rstyle),0))}removeFromPadPrimitives(){const C=this.getPadPainter();if(!C||C===this)return!1;const N=C.painters.indexOf(this);return N>=0&&C.painters.splice(N,1),!0}createAttMarker(C){(0,V.isObject)(C)?void 0!==C.fMarkerColor&&void 0!==C.fMarkerStyle&&void 0!==C.fMarkerSize&&(C={attr:C,std:!1}):C={std:!0},void 0===C.std&&(C.std=!0),void 0===C.painter&&(C.painter=this);let N=C.std?this.markeratt:null;return N?(!N.changed||C.force)&&N.setArgs(C):N=new Je.e(C),C.std&&(this.markeratt=N),N}createAttLine(C){(0,V.isObject)(C)?void 0!==C.fLineColor&&void 0!==C.fLineStyle&&void 0!==C.fLineWidth&&(C={attr:C,std:!1}):C={std:!0},void 0===C.std&&(C.std=!0),void 0===C.painter&&(C.painter=this);let N=C.std?this.lineatt:null;return N?(!N.changed||C.force)&&N.setArgs(C):N=new ot.gx(C),C.std&&(this.lineatt=N),N}createAttText(C){(0,V.isObject)(C)?void 0!==C.fTextFont&&void 0!==C.fTextSize&&void 0!==C.fTextColor&&(C={attr:C,std:!1}):C={std:!0},void 0===C.std&&(C.std=!0),void 0===C.painter&&(C.painter=this);let N=C.std?this.textatt:null;return N?(!N.changed||C.force)&&N.setArgs(C):N=new Re(C),C.std&&(this.textatt=N),N}createAttFill(C){(0,V.isObject)(C)?C._typename&&void 0!==C.fFillColor&&void 0!==C.fFillStyle&&(C={attr:C,std:!1}):C={std:!0},void 0===C.std&&(C.std=!0);let N=C.std?this.fillatt:null;return C.svg||(C.svg=this.getCanvSvg()),void 0===C.painter&&(C.painter=this),N?(!N.changed||C.force)&&N.setArgs(C):N=new Ke(C),C.std&&(this.fillatt=N),N}forEachPainter(C,N){const O=this.getPadPainter();if(O)O.forEachPainterInPad(C,N);else{const H=this.getTopPainter();H&&"pads"!==N&&C(H)}}interactiveRedraw(C,N,O){var H=this;return(0,be.A)(function*(){let X,ie;return(0,V.isStr)(N)&&0!==N.indexOf("exec:")&&(X=N),"pad"===C?ie=H.redrawPad(X):!1!==C&&(ie=H.redraw(X)),(0,V.getPromise)(ie).then(()=>{const z=H.getCanvPainter();return(0,V.isFunc)(z?.producePadEvent)&&z.producePadEvent("redraw",H.getPadPainter(),H,null,O),(0,V.isFunc)(z?.processChanges)&&z.processChanges(N,H,O),H})})()}redrawPad(C){var N=this;return(0,be.A)(function*(){return N.getPadPainter()?.redrawPad(C)??!1})()}executeMenuCommand(C){return"Inspect"===C.fName&&this.showInspector()}submitCanvExec(C,N){if(!C||!(0,V.isStr)(C))return;const O=this.getCanvPainter();(0,V.isFunc)(O?.submitExec)&&O.submitExec(this,C,N)}deleteAttr(){delete this.lineatt,delete this.fillatt,delete this.markeratt}showInspector(){return!1}fillContextMenu(C){const N=this.getObjectName();let O=this.getClassName();const H=O.lastIndexOf("::");H>0&&(O=O.slice(H+2)),C.add(`header:${O&&N?`${O}:${N}`:O||N||"object"}`);const ie=C.size();return(0,V.isFunc)(this.fillContextMenuItems)&&this.fillContextMenuItems(C),C.size()>ie&&this.showInspector("check")&&C.add("Inspect",this.showInspector),C.addAttributesMenu(this),C.size()>ie}showObjectStatus(C,N,O,H){let X=this.getCanvPainter();if(X&&!(0,V.isFunc)(X.showCanvasStatus)&&(X=null),!X&&!(0,V.isFunc)(V.internals.showStatus)||"on"===this.enlargeMain("state"))return!1;if(void 0===C&&void 0===N){const ie=this.getObject();if(!ie)return;C=this.getItemName()||ie.fName,N=ie.fTitle||ie._typename,O=ie._typename}X?X.showCanvasStatus(C,N,O,H):V.internals.showStatus(C,N,O,H)}redraw(){}startTextDrawing(C,N,O,H){if(O||(O=this.draw_g),!O||O.empty())return;const X="font"===N?C:new Qe.qg(C,N);X.setPainter(this),O.call(X.func),O.property("draw_text_completed",!1).property("all_args",[]).property("text_font",X).property("text_factor",0).property("max_text_width",0).property("max_font_size",H).property("_fast_drawing",this.getPadPainter()?._fast_drawing??!1),O.property("_fast_drawing")&&O.property("_font_too_small",H&&H<5||X.size<4)}scaleTextDrawing(C,N){N||(N=this.draw_g),N&&!N.empty()&&C&&C>N.property("text_factor")&&N.property("text_factor",C)}_checkAllTextDrawing(C,N,O){let H=C.property("all_args"),X=0;if(H||(console.log("Text drawing is finished - why calling _checkAllTextDrawing?????"),H=[]),H.forEach(ee=>{ee.ready||X++}),X>0)return void((0,V.isFunc)(N)&&(C.node().textResolveFunc=N,C.node().try_optimize=O));C.property("all_args",null);const ie=C.property("text_factor"),z=C.property("text_font"),m=C.property("max_font_size");let I=z.size,A=!1,R=!0;ie>0&&(ie<.9||ie>1)&&(z.size=Math.max(1,Math.floor(z.size/ie))),m&&z.size>m&&(z.size=m),z.size!==I&&(C.call(z.func),I=z.size),H.forEach(ee=>{if(ee.mj_node&&ee.applyAttributesToMathJax){const ge=ee.mj_node.select("svg");ee.applyAttributesToMathJax(this,ee.mj_node,ge,ee,I,ie),delete ee.mj_node,R=!1}else ee.txt_g&&(R=!1)}),N||(N=C.node().textResolveFunc,O=C.node().try_optimize,delete C.node().textResolveFunc,delete C.node().try_optimize);const k=O&&R?[]:null;H.forEach(ee=>{let ge,ve,Se=1;if(ee.txt_node)ge=ee.txt_node,delete ee.txt_node,ve=!0,null!==k&&k.push(ge);else{if(!ee.txt_g)return;ge=ee.txt_g,delete ee.txt_g,ve=!1}ge.attr("visibility",null),A=!0,ee.width&&("middle"===ee.align[0]?ee.x+=ee.width/2:"end"===ee.align[0]&&(ee.x+=ee.width)),ee.height&&(0===ee.align[1].indexOf("bottom")?ee.y+=ee.height:"middle"===ee.align[1]&&(ee.y+=ee.height/2));let De=0,Xe=0;if(ve)(0,V.isNodeJs)()?ee.scale&&ie>0&&(ee.box.width*=1/ie,ee.box.height*=1/ie):!ee.plain&&!ee.fast&&(ee.box=(0,xe.xh)(ge,"bbox")),ee.plain?(ge.attr("text-anchor",ee.align[0]),"top"===ee.align[1]?ge.attr("dy",".8em"):"middle"===ee.align[1]&&((0,V.isNodeJs)()?ge.attr("dy",".4em"):ge.attr("dominant-baseline","middle"))):(ge.attr("text-anchor","start"),De=("middle"===ee.align[0]?-.5:"end"===ee.align[0]?-1:0)*ee.box.width,Xe=("top"===ee.align[1]?ee.top_shift||1:"middle"===ee.align[1]?ee.mid_shift||.5:0)*ee.box.height);else if(ee.text_rect){const We=ee.text_rect;Se=ie>0&&Math.abs(1-ie)>.01?1/ie:1,De=("middle"===ee.align[0]?-.5:"end"===ee.align[0]?-1:0)*We.width*Se,"top"===ee.align[1]?Xe=-We.y1*Se:"bottom"===ee.align[1]?Xe=-We.y2*Se:"middle"===ee.align[1]&&(Xe=-.5*(We.y1+We.y2)*Se)}else console.error("text rect not calcualted - please check code");ee.rotate||(ee.x+=De,ee.y+=Xe,De=Xe=0);let ct=(0,xe.bk)(Math.round(ee.x),Math.round(ee.y))||"";const $=(0,xe.bk)(Math.round(De),Math.round(Xe)),tt=We=>{ct&&(ct+=" "),ct+=We};ee.rotate&&tt(`rotate(${Math.round(ee.rotate)})`),1!==Se&&tt(`scale(${Se.toFixed(3)})`),$&&tt($),ct&&ge.attr("transform",ct)}),A||z.clearFont(C),null!==k&&k.length>1&&["fill","text-anchor"].forEach(ee=>{let ge=k[0].attr(ee);k.forEach(ve=>{const Se=ve.attr(ee);(!Se||Se!==ge)&&(ge=void 0)}),ge&&(C.attr(ee,ge),k.forEach(ve=>{ve.attr(ee,null)}))}),N&&N(this)}_postprocessDrawText(C,N){return C.box=(0,V.isNodeJs)()||V.settings.ApproxTextSize||C.fast?C.text_rect||{height:1.2*C.font_size,width:C.text.length*C.font_size*C.font.aver_width}:(0,xe.xh)(N,"bbox"),N.attr("visibility","hidden"),C.box.width>C.draw_g.property("max_text_width")&&C.draw_g.property("max_text_width",C.box.width),C.scale&&this.scaleTextDrawing(Math.max(1.05*C.box.width/C.width,C.box.height/C.height),C.draw_g),C.result_width=C.box.width,C.result_height=C.box.height,(0,V.isFunc)(C.post_process)&&C.post_process(this),C.box.width}drawText(C){if(C.text||(C.text=""),C.draw_g=C.draw_g||this.draw_g,!C.draw_g||C.draw_g.empty())return;const N=C.draw_g.property("text_font");C.font=N,N&&(N.color&&!C.color&&(C.color=N.color),N.align&&!C.align&&(C.align=N.align),N.angle&&!C.rotate&&(C.rotate=N.angle));let O=["start","middle"];if((0,V.isStr)(C.align)?(O=C.align.split(";"),1===O.length&&O.push("middle")):"number"==typeof C.align?(C.align/10>=3?O[0]="end":C.align/10>=2&&(O[0]="middle"),C.align%10==0?O[1]="bottom":C.align%10==1?O[1]="bottom-base":C.align%10==3&&(O[1]="top")):(0,V.isObject)(C.align)&&2===C.align.length&&(O=C.align),void 0===C.latex&&(C.latex=1),C.align=O,C.x=C.x||0,C.y=C.y||0,!1!==C.scale&&(C.scale=C.width&&C.height&&!C.font_size),C.width=C.width||0,C.height=C.height||0,C.draw_g.property("_fast_drawing"))if(C.scale){if(C.height<4)return 0}else if(C.font_size){if(C.font_size<4)return 0}else if(C.draw_g.property("_font_too_small"))return 0;C.draw_g.property("all_args").push(C),C.ready=!1;let H=2===C.latex;const X=V.constants.Latex;return 1===C.latex&&(H=V.settings.Latex===X.AlwaysMathJax||V.settings.Latex===X.MathJax&&C.text.match(/[#{\\]/g)||C.text.match(/[\\]/g)),!H||C.nomathjax?(C.txt_node=C.draw_g.append("svg:text"),C.color&&C.txt_node.attr("fill",C.color),C.font_size?C.txt_node.attr("font-size",C.font_size):C.font_size=N.size,C.plain=!C.latex||V.settings.Latex===X.Off||V.settings.Latex===X.Symbols,C.simple_latex=C.latex&&V.settings.Latex===X.Symbols,!C.plain||C.simple_latex||C.font&&C.font.isSymbol?(C.simple_latex||(0,Le.KA)(C.text)||C.plain?(C.simple_latex=!0,(0,Le.eN)(this,C.txt_node,C)):(C.txt_node.remove(),delete C.txt_node,C.txt_g=C.draw_g.append("svg:g"),(0,Le.Bm)(this,C.txt_g,C)),C.ready=!0,this._postprocessDrawText(C,C.txt_g||C.txt_node),C.draw_g.property("draw_text_completed")&&this._checkAllTextDrawing(C.draw_g),0):(C.plain=!0,C.txt_node.text(C.text),C.ready=!0,this._postprocessDrawText(C,C.txt_node))):(C.mj_node=C.draw_g.append("svg:g").attr("visibility","hidden"),(0,Le._o)(this,C.mj_node,C).then(()=>{C.ready=!0,C.draw_g.property("draw_text_completed")&&this._checkAllTextDrawing(C.draw_g)}),0)}finishTextDrawing(C,N){var O=this;return(0,be.A)(function*(){return C||(C=O.draw_g),!(!C||C.empty())&&(C.property("draw_text_completed",!0),new Promise(H=>{O._checkAllTextDrawing(C,H,N)}))})()}configureUserContextMenu(C){C&&(0,V.isFunc)(C)?this._userContextMenuFunc=C:delete this._userContextMenuFunc}fillObjectExecMenu(C,N){var O=this;return(0,be.A)(function*(){if((0,V.isFunc)(O._userContextMenuFunc))return O._userContextMenuFunc(C,N);const H=O.getCanvPainter();if(!O.snapid||!H||H?._readonly||!H?._websocket)return C;function X(m){const I=C.exec_painter||this,A=I.getCanvPainter(),R=C.exec_items[parseInt(m)];if(R?.fName){if("Show:Editor"===R.fExec)return void((0,V.isFunc)(A?.activateGed)&&A.activateGed(I));if((!(0,V.isFunc)(A?.executeObjectMethod)||!A.executeObjectMethod(I,R,R.$execid))&&(R.fClassName=I.getClassName(),(R.$execid.indexOf("#x")>0||R.$execid.indexOf("#y")>0||R.$execid.indexOf("#z")>0)&&(R.fClassName=V.clTAxis),!I.executeMenuCommand(R)&&R.$execid)){if(!R.fArgs)return A?.v7canvas?A.submitExec(I,R.fExec,N):I.submitCanvExec(R.fExec,R.$execid);C.showMethodArgsDialog(R).then(k=>{if(!k||I.executeMenuCommand(R,k))return;const ee=R.fExec.slice(0,R.fExec.length-1)+k+")";A?.v7canvas?A.submitExec(I,ee,N):A?.sendWebsocket(`OBJEXEC:${R.$execid}:${ee}`)})}}}const ie=(m,I,A,R)=>{if(!C._got_menu){if(C._got_menu=!0,R&&I!==R.fId&&console.error(`missmatch between request ${I} and reply ${R.fId} identifiers`),C.exec_items=R?.fItems,C.exec_items?.length){let k;m.size()>0&&m.add("separator");for(let ee=0;ee<C.exec_items.length;++ee){const ge=C.exec_items[ee];if(ge.$execid=R.fId,ge.$menu=C,ge.fClassName&&k&&k!==ge.fClassName&&(m.add("endsub:"),k=""),k!==ge.fClassName){k=ge.fClassName;const ve=k.lastIndexOf("::"),Se=ve>0?k.slice(ve+2):k;m.add("sub:"+Se.replace(/[<>]/g,"_"))}void 0===ge.fChecked||ge.fChecked<0?m.add(ge.fName,ee,X):m.addchk(ge.fChecked,ge.fName,ee,X)}k&&m.add("endsub:")}A(m)}},z=O.getSnapId(N);return C._got_menu=!1,C.painter&&(C.exec_painter=C.painter!==O?O:void 0),new Promise(m=>{let I=!1;function A(R){I||(I=!0,m(R))}setTimeout(()=>ie(C,z,A),2e3),H.submitMenuRequest(O,N,z).then(R=>ie(C,z,A,R))})})()}configureUserTooltipHandler(C,N){C&&(0,V.isFunc)(C)?(this._user_tooltip_handler=C,this._user_tooltip_timeout=N||100):(delete this._user_tooltip_handler,delete this._user_tooltip_timeout)}configureUserClickHandler(C){const N=this.getFramePainter();(0,V.isFunc)(N?.configureUserClickHandler)&&N.configureUserClickHandler(C)}configureUserDblclickHandler(C){const N=this.getFramePainter();(0,V.isFunc)(N?.configureUserDblclickHandler)&&N.configureUserDblclickHandler(C)}hasUserTooltip(){return(0,V.isFunc)(this._user_tooltip_handler)}provideUserTooltip(C){if(this.hasUserTooltip()){if(this._user_tooltip_timeout<=0)return this._user_tooltip_handler(C);if(this._user_tooltip_handle&&(clearTimeout(this._user_tooltip_handle),delete this._user_tooltip_handle),!C)return this._user_tooltip_handler(C);this._user_tooltip_handle=setTimeout(()=>{delete this._user_tooltip_handle,this._user_tooltip_handler&&this._user_tooltip_handler(C)},this._user_tooltip_timeout)}}provideSpecialDrawArea(C){var N=this;return(0,be.A)(function*(){return C===N._special_draw_area||N.getCanvPainter().toggleProjection(C).then(()=>(N._special_draw_area=C,!0))})()}drawInSpecialArea(C,N,O){var H=this;return(0,be.A)(function*(){const X=H.getCanvPainter();return!(!H._special_draw_area||!(0,V.isFunc)(X?.drawProjection))&&X.drawProjection(O||H._special_draw_area,C,N)})()}getToolTip(C){if(void 0===C?.clientX||void 0===C?.clientY)return null;const N=this.getFrameSvg();if(N.empty())return null;const O=N.selectChild(".main_layer");if(O.empty())return null;const H=(0,v.Wn)(C,O.node()),X={touch:!1,x:H[0],y:H[1]};if((0,V.isFunc)(this.extractToolTip))return this.extractToolTip(X);X.disabled=!0;const ie=(0,V.isFunc)(this.processTooltipEvent)?this.processTooltipEvent(X):null;return ie?.user_info||ie}}function L(g,C){const N=new xe.b8(g);return N.txt=C,N.redrawObject=function(O){return this.txt=O,this.drawText(),!0},N.drawText=(0,be.A)(function*(){let O=this.txt._typename===V.clTObjString?this.txt.fString:this.txt.value;(0,V.isStr)(O)||(O="<undefined>");const H=this.txt.mathjax||V.settings.Latex===V.constants.Latex.AlwaysMathJax;if(!H&&!("as_is"in this.txt)){const z=O.split("\n");O="";for(let m=0;m<z.length;++m)O+=`<pre style='margin:0'>${z[m]}</pre>`}const X=this.selectDom();let ie=X.select("div");return ie.empty()&&(ie=X.append("div").attr("style","max-width:100%;max-height:100%;overflow:auto")),ie.html(O),this.setTopPainter(),H&&(0,Le.s7)(X.node()),this}),N.drawText()}function he(g){return new Ie(g).getCanvPainter()}function re(g){return new Ie(g).getMainPainter(!0)}let de=null;function pe(g){g.active?(de?.getFramePainter()?.setFrameActive(!1),de=g.pp,de?.getFramePainter()?.setFrameActive(!0)):de===g.pp&&(de=null)}function ce(){return de}function K(g,C){!0===C?C={force:!0}:(0,V.isObject)(C)||(C=null);let N=!1;return new Ie(g).forEachPainter(O=>{!N&&(0,V.isFunc)(O.checkResize)&&(N=O.checkResize(C))}),N}function G(g){const C=new Ie(g),N=[];return C.forEachPainter(O=>{N.indexOf(O)<0&&N.push(O)}),N.forEach(O=>O.cleanup()),C.selectDom().html(""),N}const D={kDecimals:(0,V.BIT)(7),kTickPlus:(0,V.BIT)(9),kTickMinus:(0,V.BIT)(10),kAxisRange:(0,V.BIT)(11),kCenterTitle:(0,V.BIT)(12),kCenterLabels:(0,V.BIT)(14),kRotateTitle:(0,V.BIT)(15),kPalette:(0,V.BIT)(16),kNoExponent:(0,V.BIT)(17),kLabelsHori:(0,V.BIT)(18),kLabelsVert:(0,V.BIT)(19),kLabelsDown:(0,V.BIT)(20),kLabelsUp:(0,V.BIT)(21),kIsInteger:(0,V.BIT)(22),kMoreLogLabels:(0,V.BIT)(23),kOppositeTitle:(0,V.BIT)(32)},x="labels",P="normal",w="func",b="time"},9248:(Gr,xt,Te)=>{"use strict";Te.d(xt,{Ov:()=>Je,gx:()=>xe});var be=Te(3324),v=Te(4186),V=Te(139);const Le=["","","3,3","1,2","3,4,1,4","5,3,1,3","5,3,1,3,1,3,1,3","5,5","5,3,1,3,1,3","20,5","20,10,1,10","1,3"];class xe{constructor(Ke){this.func=this.apply.bind(this),this.used=!0,Ke._typename&&void 0!==Ke.fLineStyle&&(Ke={attr:Ke}),this.setArgs(Ke)}setArgs(Ke){Ke.attr?(this.color_index=Ke.attr.fLineColor,Ke.color=Ke.color0||(Ke.painter?.getColor(this.color_index)??(0,V.oU)(this.color_index)),void 0===Ke.width&&(Ke.width=Ke.attr.fLineWidth),void 0===Ke.style&&(Ke.style=Ke.attr.fLineStyle)):(0,v.isStr)(Ke.color)?"none"!==Ke.color&&!Ke.width&&(Ke.width=1):"number"==typeof Ke.color&&(this.color_index=Ke.color,Ke.color=Ke.painter?.getColor(Ke.color)??(0,V.oU)(Ke.color)),void 0===Ke.width&&(Ke.width=Ke.color&&"none"!==Ke.color?1:0),this.color=0===Ke.width?"none":Ke.color,this.width=Ke.width,this.style=Ke.style,this.pattern=Ke.pattern||Le[this.style]||null,Ke.can_excl&&(this.excl_side=this.excl_width=0,Math.abs(this.width)>99&&(this.excl_side=this.width<0?-1:1,this.excl_width=5*Math.floor(this.width/100),this.width=Math.abs(this.width%100))),!this.color&&this.width>0&&(this.color="lightgrey")}changeExcl(Ke,ot){void 0!==ot&&(this.excl_width=ot),void 0!==Ke&&(this.excl_side=Ke,0===this.excl_width&&0!==this.excl_side&&(this.excl_width=20)),this.changed=!0}empty(){return"none"===this.color}setUsed(Ke){this.used=Ke}setBorder(Ke,ot){this.rx=Ke,this.ry=ot,this.func=this.applyBorder.bind(this)}apply(Ke){this.used=!0,this.empty()?Ke.style("stroke",null).style("stroke-width",null).style("stroke-dasharray",null):Ke.style("stroke",this.color).style("stroke-width",this.width).style("stroke-dasharray",this.pattern)}applyBorder(Ke){this.used=!0,this.empty()?Ke.style("stroke",null).style("stroke-width",null).style("stroke-dasharray",null).attr("rx",null).attr("ry",null):Ke.style("stroke",this.color).style("stroke-width",this.width).style("stroke-dasharray",this.pattern).attr("rx",this.rx||null).attr("ry",this.ry||null)}change(Ke,ot,Re){void 0!==Ke&&(this.color!==Ke&&delete this.color_index,this.color=Ke),void 0!==ot&&(this.width=ot),void 0!==Re&&(this.style=Re,this.pattern=Le[this.style]||null),this.changed=!0}verifyDirectChange(){this.change(this.color,parseInt(this.width),parseInt(this.style))}createSample(Ke,ot,Re,Qe){Qe&&(Ke=(0,be.Lt)(Ke)),Ke.append("path").attr("d",`M0,${Re/2}h${ot}`).call(this.func)}saveToStyle(Ke,ot,Re){if(Ke){const Qe=void 0!==this.color_index?this.color_index:(0,V.vB)(this.color);Qe>=0&&(v.gStyle[Ke]=Qe)}ot&&(v.gStyle[ot]=this.width),Re&&(v.gStyle[Re]=this.style)}}function Je(st){return(st<0||st>=Le.length)&&(st=11),Le[st]}},7952:(Gr,xt,Te)=>{"use strict";Te.d(xt,{e:()=>xe});var be=Te(4186),v=Te(3324),V=Te(139);const Le=[0,1,2,3,4,5,106,107,104,1,1,1,1,1,1,1,1,1,1,1,104,125,126,132,4,25,26,27,28,130,30,3,32,127,128,35,36,37,38,137,40,140,42,142,44,144,46,146,148,149];class xe{constructor(st){this.x0=this.y0=0,this.color="black",this.style=1,this.size=8,this.scale=1,this.stroke=!0,this.fill=!0,this.marker="",this.ndig=0,this.used=!0,this.changed=!1,this.func=this.apply.bind(this),this.setArgs(st),this.changed=!1}setArgs(st){(0,be.isObject)(st)&&"number"==typeof st.fMarkerStyle&&(st={attr:st}),st.attr&&(void 0===st.color&&(st.color=st.painter?st.painter.getColor(st.attr.fMarkerColor):(0,V.oU)(st.attr.fMarkerColor)),(!st.style||st.style<0)&&(st.style=st.attr.fMarkerStyle),st.size||(st.size=st.attr.fMarkerSize)),this.color=st.color,this.style=st.style,this.size=st.size,this.refsize=st.refsize,this._configure()}setUsed(st){this.used=st}resetPos(){this.lastx=this.lasty=null}create(st,Ke){if(!this.optimized)return`M${(st+this.x0).toFixed(this.ndig)},${(Ke+this.y0).toFixed(this.ndig)}${this.marker}`;const ot=Math.round(st),Re=Math.round(Ke);let Qe=`M${ot},${Re}`;if(null!==this.lastx)if(ot===this.lastx&&Re===this.lasty)Qe="";else{const Ie=`m${ot-this.lastx},${Re-this.lasty}`;Ie.length<Qe.length&&(Qe=Ie)}return this.lastx=ot+1,this.lasty=Re,Qe+"h1"}getFullSize(){return this.scale*this.size}getMarkerLength(){return this.marker?this.marker.length:10}change(st,Ke,ot){this.changed=!0,void 0!==st&&(this.color=st),void 0!==Ke&&Ke>=0&&(this.style=Ke),void 0!==ot&&(this.size=ot),this._configure()}_configure(){if(this.x0=this.y0=0,1===this.style||777===this.style)return this.fill=!1,this.marker="h1",this.size=1,this.optimized=!0,this.resetPos(),!0;this.optimized=!1;const st=Le[this.style]??104,Ke=st%100;this.fill=st>=100,this.scale=this.refsize||8;const ot=this.getFullSize();this.ndig=ot>7?0:ot>2?1:2,30===Ke&&this.ndig++;let Re=ot.toFixed(this.ndig);const Qe=(ot/2).toFixed(this.ndig),Ie=(ot/3).toFixed(this.ndig),L=(ot/4).toFixed(this.ndig),he=(ot/8).toFixed(this.ndig),re=(3*ot/8).toFixed(this.ndig);switch(Ke){case 1:this.marker="h1";break;case 2:this.y0=-ot/2,this.marker=`v${Re}m-${Qe},-${Qe}h${Re}`;break;case 3:this.x0=this.y0=-ot/2,this.marker=`l${Re},${Re}m0,-${Re}l-${Re},${Re}m0,-${Qe}h${Re}m-${Qe},-${Qe}v${Re}`;break;case 4:this.x0=-parseFloat(Qe),Re=(2*parseFloat(Qe)).toFixed(this.ndig),this.marker=`a${Qe},${Qe},0,1,0,${Re},0a${Qe},${Qe},0,1,0,-${Re},0z`;break;case 5:this.x0=this.y0=-ot/2,this.marker=`l${Re},${Re}m0,-${Re}l-${Re},${Re}`;break;case 6:this.x0=-1,this.marker="a1,1,0,1,0,2,0a1,1,0,1,0,-2,0z";break;case 7:this.x0=-1.5,this.marker="a1.5,1.5,0,1,0,3,0a1.5,1.5,0,1,0,-3,0z";break;case 25:this.x0=this.y0=-ot/2,this.marker=`v${Re}h${Re}v-${Re}z`;break;case 26:this.y0=-ot/2,this.marker=`l-${Qe},${Re}h${Re}z`;break;case 27:default:this.y0=-ot/2,this.marker=`l${Ie},${Qe}l-${Ie},${Qe}l-${Ie},-${Qe}z`;break;case 28:this.x0=this.y0=ot/6,this.marker=`h${Ie}v-${Ie}h-${Ie}v-${Ie}h-${Ie}v${Ie}h-${Ie}v${Ie}h${Ie}v${Ie}h${Ie}z`;break;case 30:{this.y0=-ot/2;const fe=(5*ot/6).toFixed(this.ndig),de=(5*ot/8).toFixed(this.ndig);this.marker=`l${Ie},${Re}l-${fe},-${de}h${Re}l-${fe},${de}z`;break}case 32:this.y0=ot/2,this.marker=`l-${Qe},-${Re}h${Re}z`;break;case 35:this.x0=-ot/2,this.marker=`l${Qe},${Qe}l${Qe},-${Qe}l-${Qe},-${Qe}zh${Re}m-${Qe},-${Qe}v${Re}`;break;case 36:this.x0=this.y0=-ot/2,this.marker=`h${Re}v${Re}h-${Re}zl${Re},${Re}m0,-${Re}l-${Re},${Re}`;break;case 37:this.x0=-ot/2,this.marker=`h${Re}l-${L},-${Qe}l-${Qe},${Re}h${Qe}l-${Qe},-${Re}z`;break;case 38:this.x0=-ot/4,this.y0=-ot/2,this.marker=`h${Qe}l${L},${L}v${Qe}l-${L},${L}h-${Qe}l-${L},-${L}v-${Qe}zm${L},0v${Re}m-${Qe},-${Qe}h${Re}`;break;case 40:this.x0=-ot/4,this.y0=-ot/2,this.marker=`l${Qe},${Re}l${L},-${L}l-${Re},-${Qe}zm${Qe},0l-${Qe},${Re}l-${L},-${L}l${Re},-${Qe}z`;break;case 42:this.y0=-ot/2,this.marker=`l${he},${re}l${re},${he}l-${re},${he}l-${he},${re}l-${he},-${re}l-${re},-${he}l${re},-${he}z`;break;case 44:this.x0=-ot/4,this.y0=-ot/2,this.marker=`h${Qe}l-${he},${re}l${re},-${he}v${Qe}l-${re},-${he}l${he},${re}h-${Qe}l${he},-${re}l-${re},${he}v-${Qe}l${re},${he}z`;break;case 46:this.x0=-ot/4,this.y0=-ot/2,this.marker=`l${L},${L}l${L},-${L}l${L},${L}l-${L},${L}l${L},${L}l-${L},${L}l-${L},-${L}l-${L},${L}l-${L},-${L}l${L},-${L}l-${L},-${L}z`;break;case 48:this.x0=-ot/4,this.y0=-ot/2,this.marker=`l${L},${L}l-${L},${L}l-${L},-${L}zm${Qe},0l${L},${L}l-${L},${L}l-${L},-${L}zm0,${Qe}l${L},${L}l-${L},${L}l-${L},-${L}zm-${Qe},0l${L},${L}l-${L},${L}l-${L},-${L}z`;break;case 49:this.x0=-ot/6,this.y0=-ot/2,this.marker=`h${Ie}v${Ie}h-${Ie}zm${Ie},${Ie}h${Ie}v${Ie}h-${Ie}zm-${Ie},${Ie}h${Ie}v${Ie}h-${Ie}zm-${Ie},-${Ie}h${Ie}v${Ie}h-${Ie}z`}return!0}getStrokeColor(){return this.stroke?this.color:"none"}getFillColor(){return this.fill?this.color:"none"}empty(){return"none"===this.color||!this.fill&&!this.stroke}apply(st){this.used=!0,st.style("stroke",this.stroke?this.color:"none").style("fill",this.fill?this.color:"none")}verifyDirectChange(){this.change(this.color,parseInt(this.style),parseFloat(this.size))}createSample(st,Ke,ot,Re){Re&&(st=(0,v.Lt)(st)),this.resetPos(),st.append("path").attr("d",this.create(Ke/2,ot/2)).call(this.func)}}},2009:(Gr,xt,Te)=>{"use strict";Te.d(xt,{Bx:()=>Qe,DH:()=>N,DJ:()=>w,Fc:()=>P,G1:()=>x,KG:()=>b,LR:()=>re,Sc:()=>D,Te:()=>Re,Yw:()=>fe,_l:()=>C,ke:()=>L,mZ:()=>Ie,oE:()=>K,rv:()=>ce,yW:()=>pe});var be=Te(5774),v=Te(3324),V=Te(5225),Le=Te(541),xe=Te(4186),Je=Te(165),st=Te(7952),Ke=Te(9248);const Re=new function ot(){const O={0:{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},\u03bf:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"\xa6":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},\u03a4:{x_min:-.4375,x_max:777.453125,ha:839,o:"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},\u03a0:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},\u0390:{x_min:-111,x_max:339,ha:361,o:"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"\xb2":{x_min:0,x_max:442,ha:539,o:"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"\u2013":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},\u039a:{x_min:0,x_max:819.5625,ha:893,o:"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},\u0192:{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},\u03cc:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"\xbb":{x_min:-1,x_max:503,ha:601,o:"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"\xa9":{x_min:-3,x_max:1008,ha:1106,o:"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},\u03ce:{x_min:0,x_max:922,ha:1030,o:"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"\xab":{x_min:0,x_max:507.203125,ha:604,o:"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"\u2219":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},\u00ff:{x_min:0,x_max:47,ha:125,o:"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},w:{x_min:0,x_max:1009.71875,ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\":{x_min:-.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},\u00b5:{x_min:0,x_max:697.21875,ha:747,o:"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},\u0399:{x_min:42,x_max:181,ha:297,o:"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},\u038e:{x_min:0,x_max:1144.5,ha:1214,o:"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2019":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},\u039d:{x_min:0,x_max:801,ha:915,o:"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},\u03c2:{x_min:1,x_max:676.28125,ha:740,o:"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},\u03a8:{x_min:0,x_max:1006,ha:1094,o:"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},X:{x_min:-.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},\u03b9:{x_min:42,x_max:284,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},\u0386:{x_min:0,x_max:906.953125,ha:982,o:"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},\u03b5:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},\u0394:{x_min:0,x_max:952.78125,ha:1028,o:"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{x_min:0,x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"\u2030":{x_min:-3,x_max:1672,ha:1821,o:"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},a:{x_min:0,x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"\u2014":{x_min:0,x_max:941.671875,ha:1039,o:"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},\u03c1:{x_min:0,x_max:712,ha:797,o:"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"\xaf":{x_min:0,x_max:941.671875,ha:938,o:"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},\u0397:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},\u0391:{x_min:0,x_max:906.953125,ha:985,o:"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"\u2026":{x_min:0,x_max:614,ha:708,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},\u03bd:{x_min:0,x_max:675,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"\xb6":{x_min:0,x_max:566.671875,ha:678,o:"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},\u03b2:{x_min:0,x_max:660,ha:745,o:"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},\u039c:{x_min:0,x_max:954,ha:1068,o:"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},\u038c:{x_min:.109375,x_max:1120,ha:1217,o:"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},\u0389:{x_min:0,x_max:1158,ha:1275,o:"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2022":{x_min:0,x_max:663.890625,ha:775,o:"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"\xa5":{x_min:.1875,x_max:819.546875,ha:886,o:"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{x_min:0,x_max:318.0625,ha:415,o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},\u03b3:{x_min:.5,x_max:744.953125,ha:822,o:"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},\u03b1:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"\xad":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},\u03a7:{x_min:0,x_max:854.171875,ha:935,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"\u2020":{x_min:0,x_max:777,ha:835,o:"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"\xb0":{x_min:0,x_max:347,ha:444,o:"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},\u039e:{x_min:0,x_max:734.71875,ha:763,o:"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"\xa0":{x_min:0,x_max:0,ha:853},\u03ab:{x_min:.328125,x_max:819.515625,ha:889,o:"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"\u201d":{x_min:0,x_max:347,ha:454,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},\u038a:{x_min:0,x_max:499,ha:613,o:"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},i:{x_min:14,x_max:136,ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},\u0392:{x_min:0,x_max:778,ha:877,o:"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},\u03c5:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{x_min:0,x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},\u03c7:{x_min:8.328125,x_max:780.5625,ha:815,o:"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},\u03af:{x_min:42,x_max:326.71875,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},\u0396:{x_min:0,x_max:779.171875,ha:850,o:"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"\xa8":{x_min:-109,x_max:247,ha:232,o:"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\u2039":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\u201e":{x_min:0,x_max:364,ha:467,o:"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},\u03b4:{x_min:1,x_max:710,ha:810,o:"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},\u03ad:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},\u03c9:{x_min:0,x_max:922,ha:1031,o:"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"\xb4":{x_min:0,x_max:96,ha:251,o:"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\xb1":{x_min:11,x_max:781,ha:792,o:"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},\u03cb:{x_min:0,x_max:617,ha:725,o:"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"\xa7":{x_min:0,x_max:593,ha:690,o:"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},q:{x_min:0,x_max:683,ha:876,o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},\u03a9:{x_min:-.171875,x_max:969.5625,ha:1068,o:"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},\u03cd:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},z:{x_min:-.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"\u2122":{x_min:0,x_max:894,ha:1e3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},\u03ae:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},\u0398:{x_min:0,x_max:960,ha:1056,o:"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"\xae":{x_min:-3,x_max:1008,ha:1106,o:"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},\u0395:{x_min:0,x_max:736.21875,ha:778,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"\xb3":{x_min:0,x_max:450,ha:547,o:"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},\u03c3:{x_min:0,x_max:803.390625,ha:894,o:"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},\u03b6:{x_min:0,x_max:573,ha:642,o:"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},\u03b8:{x_min:0,x_max:674,ha:778,o:"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},\u039f:{x_min:0,x_max:958,ha:1054,o:"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},\u0393:{x_min:0,x_max:705.28125,ha:749,o:"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{x_min:0,x_max:0,ha:375},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},\u0388:{x_min:0,x_max:1078.21875,ha:1118,o:"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},\u038f:{x_min:.125,x_max:1136.546875,ha:1235,o:"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},\u03aa:{x_min:-110,x_max:246,ha:275,o:"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{x_min:23,x_max:768,ha:792,o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"\xbd":{x_min:0,x_max:1050,ha:1149,o:"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},\u03a1:{x_min:0,x_max:720,ha:783,o:"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},\u00aa:{x_min:0,x_max:350,ha:397,o:"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"\u0385":{x_min:0,x_max:450,ha:553,o:"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},\u03a6:{x_min:0,x_max:915,ha:997,o:"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"\u204b":{x_min:0,x_max:0,ha:694},j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},\u03a3:{x_min:0,x_max:756.953125,ha:819,o:"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"\u203a":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\xa3":{x_min:0,x_max:704.484375,ha:801,o:"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"\xac":{x_min:0,x_max:706,ha:803,o:"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},\u03bb:{x_min:0,x_max:750,ha:803,o:"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},\u03c4:{x_min:.28125,x_max:644.5,ha:703,o:"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},\u03be:{x_min:0,x_max:624.9375,ha:699,o:"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{x_min:-3,x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},\u039b:{x_min:0,x_max:862.5,ha:942,o:"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},\u03b0:{x_min:0,x_max:617,ha:725,o:"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"\xb7":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},\u03a5:{x_min:.328125,x_max:819.515625,ha:889,o:"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},\u03bc:{x_min:0,x_max:696.609375,ha:747,o:"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},\u03c6:{x_min:-2,x_max:878,ha:974,o:"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"\u201c":{x_min:1,x_max:348.21875,ha:454,o:"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},A:{x_min:.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"\u2018":{x_min:1,x_max:139.890625,ha:236,o:"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},\u03ca:{x_min:-70,x_max:283,ha:361,o:"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},\u03c0:{x_min:-.21875,x_max:773.21875,ha:857,o:"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},\u03ac:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"\xa4":{x_min:40.09375,x_max:728.796875,ha:825,o:"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},\u03ba:{x_min:0,x_max:632.328125,ha:679,o:"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"\u2021":{x_min:0,x_max:777,ha:835,o:"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},\u03c8:{x_min:0,x_max:808,ha:907,o:"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},\u03b7:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},H="normal",z="normal",m={yMin:-334,xMin:-111,yMax:1189,xMax:1672},A={postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) \u039cagenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"\u039cagenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:'Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r\n\r\nThe above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r\n\r\nThe Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r\n\r\nThis License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r\n\r\nThe Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r\n\r\nTHE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.',manufacturer_name:"\u039cagenta ltd",font_sub_family_name:"Regular"},k="Helvetiker";return new Le.KQ({ascender:1189,boundingBox:m,cssFontStyle:z,cssFontWeight:H,default:{glyphs:O,cssFontWeight:H,ascender:1189,underlinePosition:-100,cssFontStyle:z,boundingBox:m,resolution:1e3,original_font_information:A,descender:-334,familyName:k,lineHeight:1522,underlineThickness:50},descender:-334,familyName:k,glyphs:O,lineHeight:1522,original_font_information:A,resolution:1e3,underlinePosition:-100,underlineThickness:50})};function Qe(O,H){if((!H||!(0,xe.isObject)(H))&&(H={}),(0,xe.isStr)(O)&&("#"===O[0]&&9===O.length||O.indexOf("rgba")>=0)){const X=(0,v.yW)(O);H.color=new V.Q1f(X.r,X.g,X.b),H.opacity=X.opacity??1,H.transparent=H.opacity<1}else H.color=new V.Q1f(O);return H}function Ie(O,H,X){if(O){void 0!==X&&(globalThis.docuemnt=X);const R=new Le.w4;return R.setPrecision(H),R}const m={svg_attr:{},svg_style:{},path_attr:{},accPath:"",createElementNS(R,k){return"path"===k?{_wrapper:this,setAttribute(ee,ge){if("style"===ee&&ge){const ve=ge.indexOf(";stroke-opacity:1;stroke-width:1;stroke-linecap:round");ve>=0&&ve===ge.length-53&&(ge=ge.slice(0,ge.length-53));const Se=ge.indexOf(";fill-opacity:1");Se>=0&&Se===ge.length-15&&(ge=ge.slice(0,ge.length-15))}this._wrapper.path_attr[ee]=ge}}:"svg"!==k?(console.error(`not supported element for SVGRenderer ${k}`),null):{_wrapper:this,childNodes:[],style:this.svg_style,setAttribute(ee,ge){this._wrapper.svg_attr[ee]=ge},appendChild(ee){this._wrapper.accPath+=`<path style="${this._wrapper.path_attr.style}" d="${this._wrapper.path_attr.d}"/>`,this._wrapper.path_attr={}},removeChild(ee){this.childNodes=[]}}}};let I;(0,xe.isNodeJs)()&&(I=globalThis.document,globalThis.document=m);const A=new Le.w4;return(0,xe.isNodeJs)()&&(globalThis.document=I),A.doc_wrapper=m,A.originalRender=A.render,A.render=function(R,k){const ee=globalThis.document;(0,xe.isNodeJs)()&&(globalThis.document=this.doc_wrapper),this.originalRender(R,k),(0,xe.isNodeJs)()&&(globalThis.document=ee)},A.clearHTML=function(){this.doc_wrapper.accPath=""},A.makeOuterHTML=function(){const R=this.doc_wrapper;return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="${R.svg_attr.viewBox}" width="${R.svg_attr.width}" height="${R.svg_attr.height}"${R.svg_style.backgroundColor?` style="background:${R.svg_style.backgroundColor}"`:""}>${R.accPath}</svg>`},A.fillTargetSVG=function(R){if((0,xe.isNodeJs)()){const k=this.doc_wrapper;R.setAttribute("viewBox",k.svg_attr.viewBox),R.setAttribute("width",k.svg_attr.width),R.setAttribute("height",k.svg_attr.height),R.style.background=k.svg_style.backgroundColor||"",R.innerHTML=k.accPath}else{const k=this.domElement;for(R.setAttribute("viewBox",k.getAttribute("viewBox")),R.setAttribute("width",k.getAttribute("width")),R.setAttribute("height",k.getAttribute("height")),R.style.background=k.style.backgroundColor;k.firstChild;){const ee=k.firstChild;k.removeChild(ee),R.appendChild(ee)}}},A.setPrecision(H),A}function L(O,H){void 0===H&&(H=(0,xe.isBatchMode)()),O||(O=H?xe.settings.Render3DBatch:xe.settings.Render3D);const X=xe.constants.Render3D;return O===X.Default&&(O=H?X.WebGLImage:X.WebGL),H&&O===X.WebGL&&(O=X.WebGLImage),O}const he={access3dKind(O){const H=this.getPadSvg();if(H.empty())return-1;const X=H.property("can3d");return void 0!==O&&H.property("can3d",O),X??-1},getSizeFor3d(O){void 0===O&&(O=(O=L())!==xe.constants.Render3D.WebGL?xe.constants.Embed3D.EmbedSVG:xe.settings.Embed3D!==xe.constants.Embed3D.Default?xe.settings.Embed3D:xe.browser.isFirefox||xe.browser.chromeVersion>95?xe.constants.Embed3D.Embed:xe.constants.Embed3D.Overlay);const H=this.getPadSvg(),X="draw3d_"+(this.getPadName()||"canvas");if(H.empty()){const A=(0,Je.xh)(this.selectDom());return A.height<10&&A.width>10&&(A.height=Math.round(.66*A.width),this.selectDom().style("height",A.height+"px")),A.x=0,A.y=0,A.clname=X,A.can3d=-1,A}const ie=this.getFramePainter(),z=this.getPadPainter();let m;if(ie?.mode3d&&O>0)m=ie.getFrameRect();else{let A=O>0?H:this.getCanvSvg();m={x:0,y:0,width:A.property("draw_width"),height:A.property("draw_height")},Number.isNaN(m.width)||Number.isNaN(m.height)?(m.width=z.getPadWidth(),m.height=z.getPadHeight()):ie&&!ie.mode3d&&(A=this.getFrameSvg(),m.x=A.property("draw_x"),m.y=A.property("draw_y"))}m.clname=X,m.can3d=O;const I=z?.getPadRect();if(I){const A=Math.round(.07*m.width),R=Math.round(.05*m.height);m.x=Math.max(0,m.x-A),m.y=Math.max(0,m.y-R),m.width=Math.min(m.width+2*A,I.width-m.x),m.height=Math.min(m.height+2*R,I.height-m.y)}return 1===O&&(m=(0,Je.md)(this.getPadSvg(),m)),m},clear3dCanvas(){const O=this.access3dKind(null);if(O<0){const X=this.selectDom().node();let ie=X?.firstChild;return ie&&!ie.$jsroot&&(ie=ie.nextSibling),ie?.$jsroot&&(delete ie.painter,X.removeChild(ie)),O}const H=this.getSizeFor3d(O);if(0===H.can3d)(0,v.Lt)(this.getCanvSvg().node().nextSibling).remove(),this.getCanvSvg().style("display",null);else{if(this.getPadSvg().empty())return;this.apply3dSize(H).remove(),this.getFrameSvg().style("display",null)}return O},add3dCanvas(O,H,X){if(H&&!(O.can3d<-1)){if(-1===O.can3d){const ie=this.selectDom().node();return void(null!==ie&&(ie.appendChild(H),H.painter=this,H.$jsroot=!0))}if(O.can3d>0&&!X&&(O.can3d=xe.constants.Embed3D.EmbedSVG),this.access3dKind(O.can3d),0===O.can3d)this.getCanvSvg().style("display","none"),this.getCanvSvg().node().parentNode.appendChild(H);else{if(this.getPadSvg().empty())return;this.getFrameSvg().style("display","none"),this.apply3dSize(O).attr("title","").node().appendChild(H)}}},apply3dSize(O,H){if(O.can3d<0)return(0,v.Lt)(null);let X;if(O.can3d>1){if(X=this.getLayerSvg(O.clname),H)return X;const ie=this.getPadSvg();O.can3d===xe.constants.Embed3D.EmbedSVG?(X.empty()&&(X=ie.insert("g",".primitives_layer").attr("class",O.clname)),(0,Je.bk)(X,O.x,O.y)):(X.empty()&&(X=ie.insert("foreignObject",".primitives_layer").attr("class",O.clname)),X.attr("x",O.x).attr("y",O.y).attr("width",O.width).attr("height",O.height).attr("viewBox",`0 0 ${O.width} ${O.height}`).attr("preserveAspectRatio","xMidYMid"))}else{let ie=this.getCanvSvg().node().parentNode;if(X=(0,v.Lt)(ie).select("."+O.clname),H)return X;this.getCanvSvg().property("redraw_by_resize",!0),X.empty()&&(X=(0,v.Lt)(ie).append("div").attr("class",O.clname).style("user-select","none"));const z=ie.getBoundingClientRect(),m=(0,xe.getDocument)();for(;ie;){if(ie===m){ie=null;break}try{if("static"!==getComputedStyle(ie).position)break}catch{break}ie=ie.parentNode}const I=ie?.getBoundingClientRect()??{top:0,left:0},A=Math.round(z.left-I.left),R=Math.round(z.top-I.top);X.style("position","absolute").style("left",O.x+A+"px").style("top",O.y+R+"px").style("width",O.width+"px").style("height",O.height+"px")}return X}};function re(O){Object.assign(O,he)}function fe(O,H,X,ie){return de.apply(this,arguments)}function de(){return(de=(0,be.A)(function*(O,H,X,ie){const z=xe.constants.Render3D,m=(0,xe.getDocument)();let I;if(X=L(X),ie||(ie={antialias:!0,alpha:!0}),X===z.SVG){const A=Ie(!1,0,m);A.jsroot_dom=m.createElementNS("http://www.w3.org/2000/svg","svg"),I=Promise.resolve(A)}else if((0,xe.isNodeJs)())I=Te.e(511).then(Te.t.bind(Te,1511,19)).then(A=>(ie.canvas=A.default.createCanvas(O,H),ie.canvas.addEventListener=()=>{},ie.canvas.removeEventListener=()=>{},ie.canvas.style={},Te.e(254).then(Te.t.bind(Te,8254,19)))).then(A=>{const R=A.default(O,H,{preserveDrawingBuffer:!0});if(!R)throw Error("Fail to create headless-gl");ie.context=R,R.canvas=ie.canvas;const k=new V.JeP(ie);return k.jsroot_output=new V.nWS(O,H),k.setRenderTarget(k.jsroot_output),k.jsroot_dom=m.createElementNS("http://www.w3.org/2000/svg","image"),k});else if(X===z.WebGL)I=Promise.resolve(new V.JeP(ie));else{const A=new V.JeP(ie);A.jsroot_dom=m.createElementNS("http://www.w3.org/2000/svg","image"),I=Promise.resolve(A)}return I.then(A=>(A.jsroot_dom?A.jsroot_custom_dom=!0:A.jsroot_dom=A.domElement,A.jsroot_render3d=X,A.jsroot_image_format="png",A.originalSetSize=A.setSize,A.setSize=function(R,k,ee){this.jsroot_custom_dom&&(this.jsroot_dom.setAttribute("width",R),this.jsroot_dom.setAttribute("height",k)),this.originalSetSize(R,k,ee)},A.setSize(O,H),A))})).apply(this,arguments)}function pe(O){if(O)if((0,xe.isNodeJs)()){const H=(0,xe.isFunc)(O.getContext)?O.getContext():null,X=H?.getExtension("STACKGL_destroy_context");(0,xe.isFunc)(X?.destroy)&&X.destroy()}else xe.browser.isChrome&&(0,xe.isFunc)(O.forceContextLoss)&&O.forceContextLoss(),(0,xe.isFunc)(O.dispose)&&O.dispose()}function ce(O){(0,xe.isFunc)(O.clearHTML)&&O.clearHTML()}function K(O){const H=xe.constants.Render3D;if(O.jsroot_render3d!==H.WebGL)if(O.jsroot_render3d===H.SVG)O.fillTargetSVG(O.jsroot_dom);else if((0,xe.isNodeJs)()){const X=O.domElement,ie=X.getContext("2d"),z=new Uint8Array(4*X.width*X.height);O.readRenderTargetPixels(O.jsroot_output,0,0,X.width,X.height,z);let A,R,m=0,I=4*(X.height-1)*X.width;for(;m<I;){for(A=0;A<4*X.width;++A)R=z[m+A],z[m+A]=z[I+A],z[I+A]=R;m+=4*X.width,I-=4*X.width}const k=ie.createImageData(X.width,X.height);k.data.set(z),ie.putImageData(k,0,0);const ge=X.toDataURL("image/"+O.jsroot_image_format);O.jsroot_dom.setAttribute("href",ge)}else{const X=O.domElement.toDataURL("image/"+O.jsroot_image_format);O.jsroot_dom.setAttribute("href",X)}}class G{constructor(H,X){this.tt=null,this.cont=null,this.lastlbl="",this.parent=H||(0,xe.getDocument)().body,this.canvas=X,this.abspos=!H}checkParent(H){H&&this.parent!==H&&(this.hide(),this.parent=H)}extract_pos(H){if((0,xe.isObject)(H)&&void 0!==H.u&&void 0!==H.l)return H;const X={u:0,l:0};return this.abspos?(X.l=H.pageX,X.u=H.pageY):(X.l=H.offsetX,X.u=H.offsetY),X}pos(H){if(!this.tt)return;const X=this.extract_pos(H);if(!this.abspos){const ie=this.parent.getBoundingClientRect(),z=this.canvas.getBoundingClientRect();void 0!==ie.left&&void 0!==z.left&&(X.l+=z.left-ie.left),void 0!==ie.top&&void 0!==z.top&&(X.u+=z.top-ie.top),X.l+this.tt.offsetWidth+3>=this.parent.offsetWidth&&(X.l=this.parent.offsetWidth-this.tt.offsetWidth-3),X.u+this.tt.offsetHeight+15>=this.parent.offsetHeight&&(X.u=this.parent.offsetHeight-this.tt.offsetHeight-15);let m=this.parent;for(;m;){const I=getComputedStyle(m);if(!I||"static"!==I.position||!m.parentNode||1!==m.parentNode.nodeType)break;m=m.parentNode}if(m&&m!==this.parent){const I=m.getBoundingClientRect();X.l+=ie.left-I.left,X.u+=ie.top-I.top}}this.tt.style.top=`${X.u+15}px`,this.tt.style.left=`${X.l+3}px`}show(H){if(!H)return this.hide();if((0,xe.isObject)(H)&&(H.lines||H.line)){if(H.only_status)return this.hide();if(H.line)H=H.line;else{let X=H.lines[0];for(let ie=1;ie<H.lines.length;++ie)X+="<br/>"+H.lines[ie];H=X}}if(null===this.tt){const X=(0,xe.getDocument)();this.tt=X.createElement("div"),this.tt.setAttribute("style","opacity: 1; filter: alpha(opacity=1); position: absolute; display: block; overflow: hidden; z-index: 101;"),this.cont=X.createElement("div"),this.cont.setAttribute("style","display: block; padding: 2px 12px 3px 7px; margin-left: 5px; font-size: 11px; background: #777; color: #fff;"),this.tt.appendChild(this.cont),this.parent.appendChild(this.tt)}this.lastlbl!==H&&(this.cont.innerHTML=H,this.lastlbl=H,this.tt.style.width="auto")}hide(){null!==this.tt&&this.parent.removeChild(this.tt),this.tt=null,this.lastlbl=""}}function D(O,H,X,ie,z){const m=xe.settings.Zooming&&xe.settings.ZoomMouse,I=(0,xe.isFunc)(O.processMouseClick);let A=null;function R(ve){if(A){if(A.mouse_zoom_mesh)return ve.stopImmediatePropagation(),void ve.stopPropagation();if(!(void 0!==ve.button&&0!==ve.button||void 0!==ve.buttons&&1!==ve.buttons)){if(A.enable_zoom&&(A.mouse_zoom_mesh=A.detectZoomMesh(ve),A.mouse_zoom_mesh))return ve.stopImmediatePropagation(),void ve.stopPropagation();A.enable_select&&(A.mouse_select_pnt=A.getMousePos(ve,{}))}}}function k(ve){if(A){if(A.mouse_zoom_mesh&&A.mouse_zoom_mesh.point2&&A.painter.get3dZoomCoord){let Se=A.mouse_zoom_mesh.object.zoom,De=A.painter.get3dZoomCoord(A.mouse_zoom_mesh.point,Se),Xe=A.painter.get3dZoomCoord(A.mouse_zoom_mesh.point2,Se);De>Xe&&([De,Xe]=[Xe,De]),"z"===Se&&A.mouse_zoom_mesh.object.use_y_for_z&&(Se="y"),De<Xe&&A.painter.zoom(Se,De,Xe)&&(A.mouse_zoom_mesh=null)}if(A.enable_zoom&&A.removeZoomMesh(),A.enable_select&&A.mouse_select_pnt){const Se=A.getMousePos(ve,{}),De=Se.x===A.mouse_select_pnt.x&&Se.y===A.mouse_select_pnt.y;if(delete A.mouse_select_pnt,De){const Xe=A.getMouseIntersects(Se);A.painter.processMouseClick(Se,Xe,ve)}}}}function ge(ve){if(!A)return;if(function ee(ve){return!(!ve||void 0===ve.renderer)&&void 0!==ve.render_tmout}(A.painter)||A.mouse_zoom_mesh)return ve.preventDefault(),ve.stopPropagation(),void ve.stopImmediatePropagation();const Se=A.detectZoomMesh(ve);if(Se&&(ve.preventDefault(),ve.stopPropagation(),ve.stopImmediatePropagation(),(0,xe.isFunc)(A.painter?.analyzeMouseWheelEvent))){let De=Se.object.zoom,Xe=Se.point[De];const ct={name:De,ignore:!1};switch(De){case"x":Xe=(Xe+A.painter.size_x3d)/2/A.painter.size_x3d;break;case"y":Xe=(Xe+A.painter.size_y3d)/2/A.painter.size_y3d;break;case"z":Xe=Xe/2/A.painter.size_z3d}A.painter.analyzeMouseWheelEvent(ve,ct,Xe,!1),"z"===De&&Se.object.use_y_for_z&&(De="y"),A.painter.zoom(De,ct.min,ct.max)}}return xe.settings.Zooming&&xe.settings.ZoomWheel&&ie.domElement.addEventListener("wheel",ge),(m||I)&&(ie.domElement.addEventListener("pointerdown",R),ie.domElement.addEventListener("pointerup",k)),A=new Le.NU(H,ie.domElement),A.enableDamping=!1,A.dampingFactor=1,A.enableZoom=!0,A.enableKeys=xe.settings.HandleKeys,z&&(A.target.copy(z),A.target0.copy(z),A.update()),A.tooltip=new G(O.selectDom().node(),ie.domElement),A.painter=O,A.camera=H,A.scene=X,A.renderer=ie,A.raycaster=new V.tBo,A.raycaster.params.Line.threshold=10,A.raycaster.params.Points.threshold=5,A.mouse_zoom_mesh=null,A.block_ctxt=!1,A.block_mousemove=!1,A.cursor_changed=!1,A.control_changed=!1,A.control_active=!1,A.mouse_ctxt={x:0,y:0,on:!1},A.enable_zoom=m,A.enable_select=I,A.cleanup=function(){xe.settings.Zooming&&xe.settings.ZoomWheel&&this.domElement.removeEventListener("wheel",ge),(this.enable_zoom||this.enable_select)&&(this.domElement.removeEventListener("pointerdown",R),this.domElement.removeEventListener("pointerup",k)),this.domElement.removeEventListener("click",this.lstn_click),this.domElement.removeEventListener("dblclick",this.lstn_dblclick),this.domElement.removeEventListener("contextmenu",this.lstn_contextmenu),this.domElement.removeEventListener("mousemove",this.lstn_mousemove),this.domElement.removeEventListener("mouseleave",this.lstn_mouseleave),this.dispose(),this.tooltip.hide(),delete this.tooltip,delete this.painter,delete this.camera,delete this.scene,delete this.renderer,delete this.raycaster,delete this.mouse_zoom_mesh},A.HideTooltip=function(){this.tooltip.hide()},A.getMousePos=function(ve,Se){return Se.x="offsetX"in ve?ve.offsetX:ve.layerX,Se.y="offsetY"in ve?ve.offsetY:ve.layerY,Se.clientX=ve.clientX,Se.clientY=ve.clientY,Se},A.getOriginDirectionIntersects=function(ve,Se){this.raycaster.set(ve,Se);let De=this.raycaster.intersectObjects(this.scene.children,!0);return(0,xe.isFunc)(this.painter.filterIntersects)&&(De=this.painter.filterIntersects(De)),De},A.getMouseIntersects=function(ve){if(!this.renderer)return[];const Se=this.renderer instanceof Le.w4?this.renderer.domElement:this.renderer.getSize(new V.I9Y),De={x:ve.x/Se.width*2-1,y:-ve.y/Se.height*2+1};this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.raycaster.setFromCamera(De,this.camera);let Xe=this.raycaster.intersectObjects(this.scene.children,!0);return(0,xe.isFunc)(this.painter.filterIntersects)&&(Xe=this.painter.filterIntersects(Xe)),Xe},A.detectZoomMesh=function(ve){const Se=this.getMousePos(ve,{}),De=this.getMouseIntersects(Se);if(De)for(let Xe=0;Xe<De.length;++Xe)if(De[Xe].object.zoom&&!De[Xe].object.zoom_disabled)return De[Xe];return null},A.getInfoAtMousePosition=function(ve){const Se=this.getMouseIntersects(ve);let De=null,Xe=null;for(let ct=0;ct<Se.length;++ct)if(Se[ct].object.tooltip){De=Se[ct].object.tooltip(Se[ct]),Xe=Se[ct].object.painter;break}if(De&&Xe)return{obj:Xe.getObject(),name:Xe.getObject().fName,bin:De.bin,cont:De.value,binx:De.ix,biny:De.iy,binz:De.iz,grx:(De.x1+De.x2)/2,gry:(De.y1+De.y2)/2,grz:(De.z1+De.z2)/2}},A.processDblClick=function(ve){const Se=this.detectZoomMesh(ve);if(Se&&this.painter)return void this.painter.unzoom(Se.object.use_y_for_z?"y":Se.object.zoom);const De=this.painter?.getFramePainter();if((0,xe.isFunc)(De?._dblclick_handler)){const Xe=this.getInfoAtMousePosition(this.getMousePos(ve,{}));if(Xe)return void De._dblclick_handler(Xe)}this.reset()},A.changeEvent=function(){this.mouse_ctxt.on=!1,this.painter.render3D(0),this.control_changed=!0},A.startEvent=function(){this.control_active=!0,this.block_ctxt=!1,this.mouse_ctxt.on=!1,this.tooltip.hide()},A.endEvent=function(){this.control_active=!1,this.mouse_ctxt.on&&(this.mouse_ctxt.on=!1,this.contextMenu(this.mouse_ctxt,this.getMouseIntersects(this.mouse_ctxt))),this.control_changed=!1},A.mainProcessContextMenu=function(ve){ve.preventDefault(),this.getMousePos(ve,this.mouse_ctxt),this.control_active?this.mouse_ctxt.on=!0:this.block_ctxt?this.block_ctxt=!1:this.contextMenu(this.mouse_ctxt,this.getMouseIntersects(this.mouse_ctxt))},A.contextMenu=function(){},A.setTooltipEnabled=function(ve){this.block_mousemove=!ve,!1===ve&&(this.tooltip.hide(),this.removeZoomMesh())},A.removeZoomMesh=function(){this.mouse_zoom_mesh?.object.showSelection()&&this.painter.render3D(),this.mouse_zoom_mesh=null},A.mainProcessMouseMove=function(ve){if(this.painter&&(this.control_active&&ve.buttons&&2&ve.buttons&&(this.block_ctxt=!0),!this.control_active&&!this.block_mousemove&&(0,xe.isFunc)(this.processMouseMove))){if(this.mouse_zoom_mesh){const Se=this.detectZoomMesh(ve),De=Se?.object===this.mouse_zoom_mesh.object?Se.point:this.mouse_zoom_mesh.object.globalIntersect(this.raycaster);return De&&(this.mouse_zoom_mesh.point2=De),De&&this.painter.enable_highlight&&this.mouse_zoom_mesh.object.showSelection(this.mouse_zoom_mesh.point,De)&&this.painter.render3D(0),void this.tooltip.hide()}ve.preventDefault(),this.tmout_mouse=this.getMousePos(ve,{}),this.tmout_ttpos=this.tooltip?.extract_pos(ve),this.tmout_handle&&(clearTimeout(this.tmout_handle),delete this.tmout_handle),this.mouse_tmout?this.tmout_handle=setTimeout(()=>this.delayedProcessMouseMove(),this.mouse_tmout):this.delayedProcessMouseMove()}},A.delayedProcessMouseMove=function(){if(delete this.tmout_handle,!this.painter)return;const ve=this.tmout_mouse,Se=this.getMouseIntersects(ve),De=this.processMouseMove(Se);if(De){let Xe="",ct="",$="",tt="";ve&&($=ve.x.toFixed(0)+","+ve.y.toFixed(0)),(0,xe.isStr)(De)?tt=De:(Xe=De.name,ct=De.title,De.line?tt=De.line:De.lines&&(tt=De.lines.slice(1).join(" "),Xe=De.lines[0])),this.painter.showObjectStatus(Xe,ct,tt,$)}if(this.cursor_changed=!1,De&&this.painter?.isTooltipAllowed())this.tooltip.checkParent(this.painter.selectDom().node()),this.tooltip.show(De,ve),this.tooltip.pos(this.tmout_ttpos);else if(this.tooltip.hide(),Se)for(let Xe=0;Xe<Se.length;++Xe)Se[Xe].object.zoom&&!Se[Xe].object.zoom_disabled&&(this.cursor_changed=!0);(0,xe.getDocument)().body.style.cursor=this.cursor_changed?"pointer":"auto"},A.mainProcessMouseLeave=function(){this.painter&&(this.tmout_handle&&(clearTimeout(this.tmout_handle),delete this.tmout_handle),this.tooltip.hide(),(0,xe.isFunc)(this.processMouseLeave)&&this.processMouseLeave(),this.cursor_changed&&((0,xe.getDocument)().body.style.cursor="auto",this.cursor_changed=!1))},A.mainProcessDblClick=function(ve){this.single_click_tm&&(clearTimeout(this.single_click_tm),delete this.single_click_tm),this.processDblClick(ve)},A.processClick=function(ve,Se){if(delete this.single_click_tm,1===Se){const De=this.painter?.getFramePainter();if((0,xe.isFunc)(De?._click_handler)){const Xe=this.getInfoAtMousePosition(ve);if(Xe)return void De._click_handler(Xe)}}if(2===Se&&(0,xe.isFunc)(this.processSingleClick)){const De=this.getMouseIntersects(ve);this.processSingleClick(De)}},A.lstn_click=function(ve){if(2===ve.detail)return;this.single_click_tm&&(clearTimeout(this.single_click_tm),delete this.single_click_tm);let Se=0;(0,xe.isFunc)(this.painter?.getFramePainter()?._click_handler)?Se=1:this.processSingleClick&&this.painter?.options?.mouse_click&&(Se=2),Se&&(this.single_click_tm=setTimeout(this.processClick.bind(this,this.getMousePos(ve,{}),Se),300))}.bind(A),A.addEventListener("change",()=>A.changeEvent()),A.addEventListener("start",()=>A.startEvent()),A.addEventListener("end",()=>A.endEvent()),A.lstn_contextmenu=ve=>A.mainProcessContextMenu(ve),A.lstn_dblclick=ve=>A.mainProcessDblClick(ve),A.lstn_mousemove=ve=>A.mainProcessMouseMove(ve),A.lstn_mouseleave=()=>A.mainProcessMouseLeave(),ie.domElement.addEventListener("click",A.lstn_click),ie.domElement.addEventListener("dblclick",A.lstn_dblclick),ie.domElement.addEventListener("contextmenu",A.lstn_contextmenu),ie.domElement.addEventListener("mousemove",A.lstn_mousemove),ie.domElement.addEventListener("mouseleave",A.lstn_mouseleave),A}function x(O,H){if(O){if(O.children)for(let X=0;X<O.children.length;X++)x(O.children[X]);if(H)return void(O.children=[]);O.children=void 0,O.geometry&&(O.geometry.dispose(),O.geometry=void 0),O.material&&(O.material.map&&(O.material.map.dispose(),O.material.map=void 0),O.material.dispose(),O.material=void 0),delete O.painter,delete O.bins_index,delete O.tooltip,delete O.stack,delete O.drawn_highlight,O=void 0}}function P(O,H,X=void 0,ie=!1){const z=new V.LoY;if(z.setAttribute("position",O instanceof Float32Array?new V.THS(O,3):new V.qtW(O,3)),X&&z.setIndex(new V.THS(X,1)),H.isLineDashedMaterial){const m=new V.Pq0,I=new V.Pq0;let A=0,R=null;if(X){R=new Float32Array(X.length);for(let k=0;k<X.length;k+=2){const ee=X[k],ge=X[k+1];m.set(O[ee],O[ee+1],O[ee+2]),I.set(O[ge],O[ge+1],O[ge+2]),R[k]=A,A+=I.distanceTo(m),R[k+1]=A}}else{R=new Float32Array(O.length/3);for(let k=0;k<O.length;k+=6)m.set(O[k],O[k+1],O[k+2]),I.set(O[k+3],O[k+4],O[k+5]),R[k/3]=A,A+=I.distanceTo(m),R[k/3+1]=A}z.setAttribute("lineDistance",new V.THS(R,1))}return ie?z:new V.DXC(z,H)}const w={Vertices:[new V.Pq0(1,1,1),new V.Pq0(1,1,0),new V.Pq0(1,0,1),new V.Pq0(1,0,0),new V.Pq0(0,1,0),new V.Pq0(0,1,1),new V.Pq0(0,0,0),new V.Pq0(0,0,1)],Indexes:[0,2,1,2,3,1,4,6,5,6,7,5,4,5,1,5,0,1,7,6,2,6,3,2,5,7,0,7,2,0,1,3,4,3,6,4],Normals:[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],Segments:[0,2,2,7,7,5,5,0,1,3,3,6,6,4,4,1,1,0,3,2,6,7,4,5],MeshSegments:void 0};w.MeshSegments=function(){const O=new Int32Array(w.Segments.length);for(let H=0;H<O.length;++H)for(let X=0;X<w.Indexes.length;++X)if(w.Segments[H]===w.Indexes[X]){O[H]=X;break}return O}();class b{cleanup(){}extractIndex(){}setSelected(){}setHighlight(){}checkHighlightIndex(){}}class C{constructor(H,X=!0,ie=1){this.webgl=X,this.scale=ie||1,this.pos=new Float32Array(3*H),this.geom=new V.LoY,this.geom.setAttribute("position",new V.THS(this.pos,3)),this.indx=0}addPoint(H,X,ie){this.pos[this.indx]=H,this.pos[this.indx+1]=X,this.pos[this.indx+2]=ie,this.indx+=3}createPoints(H){(0,xe.isObject)(H)||(H={color:H}),H.color||(H.color="black");let X=1;H.style?1===H.style?X=.3:6===H.style?X=.5:7===H.style&&(X=.7):X=1.1;const ie=k=>{const ee={size:3*this.scale*X};k?(ee.map=k,ee.transparent=!0):ee.color=H.color||"black";const ge=new V.ONl(this.geom,new V.BH$(ee));return ge.nvertex=1,ge};if(1!==X){const k=ie();return this.noPromise?k:Promise.resolve(k)}const z=new st.e({style:H.style,color:H.color,size:7}),m=z.fill?1:7,I=`<svg width="64" height="64" xmlns="http://www.w3.org/2000/svg"><path d="${z.create(32,32)}" style="stroke: ${z.getStrokeColor()}; stroke-width: ${m}; fill: ${z.getFillColor()}"></path></svg>`,A="data:image/svg+xml;charset=utf8,"+((0,xe.isNodeJs)()?I:encodeURIComponent(I));let R;if((0,xe.isNodeJs)())R=Te.e(511).then(Te.t.bind(Te,1511,19)).then(k=>k.default.loadImage(A).then(ee=>{const ge=k.default.createCanvas(64,64);return ge.getContext("2d").drawImage(ee,0,0,64,64),new V.GOR(ge)}));else{if(this.noPromise)return ie((new V.Tap).load(A));R=new Promise((k,ee)=>{(new V.Tap).load(A,ve=>k(ve),void 0,()=>ee())})}return R.then(ie)}}function N(O,H,X=!1){if(!O||!H)return null;let ie,z,m;(0,xe.isStr)(H)||X?(ie=O.v7EvalColor(H+"color","black"),z=parseInt(O.v7EvalAttr(H+"style",0)),m=parseInt(O.v7EvalAttr(H+"width",1))):(ie=O.getColor(H.fLineColor),z=H.fLineStyle,m=H.fLineWidth);const I=z?(0,Ke.Ov)(z):"",A=I?I.split(","):[],R=A&&A.length>=2?new V.Fvt({color:ie,dashSize:parseInt(A[0]),gapSize:parseInt(A[1])}):new V.mrM({color:ie});return m&&m>1&&(R.linewidth=m),R}},139:(Gr,xt,Te)=>{"use strict";Te.d(xt,{$q:()=>xe,HG:()=>fe,LQ:()=>C,TZ:()=>ce,d_:()=>de,ho:()=>Le,jh:()=>g,nM:()=>x,nj:()=>L,np:()=>K,oU:()=>G,pX:()=>V,rE:()=>P,tA:()=>Je,uw:()=>pe,vB:()=>D});var be=Te(4186),v=Te(3324);const V="TLinearGradient",Le="TRadialGradient",xe=0,Je=1;function L(N,O=255){const H=Math.round(N*O).toString(16);return 1===H.length?"0"+H:H}let he=[];function fe(){return he}function de(N){if(N?._typename!==be.clTColor)return null;let O="#"+L(N.fRed)+L(N.fGreen)+L(N.fBlue);switch(void 0!==N.fAlpha&&1!==N.fAlpha&&(O+=L(N.fAlpha)),O){case"#ffffff":return"white";case"#000000":return"black";case"#ff0000":return"red";case"#00ff00":return"green";case"#0000ff":return"blue";case"#ffff00":return"yellow";case"#ff00ff":return"magenta";case"#00ffff":return"cyan"}return O}function pe(N){const O=[];N||(N=fe());for(let H=0;H<N.length;++H){if(!N[H])continue;const X=(0,v.yW)(N[H]);X.r=X.g=X.b=.299*X.r+.587*X.g+.114*X.b,O[H]=X.hex()}return O}function ce(N,O,H){if(!N){N=[];for(let ie=0;ie<he.length;++ie)N[ie]=he[ie]}if(!O)return N;let X=O;if(O._typename&&O.arr){X=[];for(let ie=0;ie<O.arr.length;++ie){const z=O.arr[ie];z?._typename!==V&&z?._typename!==Le?z?._typename===be.clTColor&&z.fNumber>=0&&z.fNumber<=1e4&&(X[z.fNumber]=de(z)):(X[z.fNumber]=z,z.toString=()=>"white")}}for(let ie=0;ie<X.length;++ie)X[ie]&&N[ie]!==X[ie]&&(N[ie]=X[ie]);return H?pe(N):N}function K(N){ce(he,N)}function G(N){return he[N]}function D(N){if(!N)return-1;for(let O=0;O<he.length;++O)if(he[O]===N)return O;return-1}function x(N,O){O||(O=he);const H=O.indexOf(N);return H>=0?H:(O.push(N),O.length-1)}class P{constructor(O,H){this.palette=H?pe(O):O}calcColorIndex(O,H){const X=this.palette.length,ie=Math.floor((O+.99)*X/(H-1));return ie>X-1?X-1:ie}getColor(O){return this.palette[O]}getLength(){return this.palette.length}calcColor(O,H){return this.getColor(this.calcColorIndex(O,H))}}function w(N){const O=(I,A,R)=>(R<0&&(R+=1),R>1&&(R-=1),R<.16666666666666666?I+6*(A-I)*R:R<.5?A:R<.6666666666666666?I+(A-I)*(.6666666666666666-R)*6:I),H=(I,A,R)=>{const k=A<.5?A*(1+R):A+R-A*R,ee=2*A-k,ge=O(ee,k,I+1/3),ve=O(ee,k,I),Se=O(ee,k,I-1/3);return"#"+L(ge)+L(ve)+L(Se)},m=[];for(let I=0;I<50;++I)m.push(H((280-5.6*(I+1))/360,.5,1));return new P(m,N)}function g(N,O){if((N=N||be.settings.Palette)>0&&N<10)return function b(){const N=[];for(let O=0;O<50;++O){const H=L((O+2)/60);N.push("#"+H+H+H)}return new P(N)}();if(N<51)return w(O);N>113&&(N=57);const H=[0,.125,.25,.375,.5,.625,.75,.875,1];let X;switch(N){case 51:X=[[0,9,13,17,24,32,27,25,29],[0,0,0,2,37,74,113,160,221],[28,42,59,78,98,129,154,184,221]];break;case 52:X=[[0,32,64,96,128,160,192,224,255],[0,32,64,96,128,160,192,224,255],[0,32,64,96,128,160,192,224,255]];break;case 53:X=[[0,45,99,156,212,230,237,234,242],[0,0,0,45,101,168,238,238,243],[0,1,1,3,9,8,11,95,230]];break;case 54:X=[[0,22,44,68,93,124,160,192,237],[0,16,41,67,93,125,162,194,241],[97,100,99,99,93,68,44,26,74]];break;case 55:X=[[0,5,15,35,102,196,208,199,110],[0,48,124,192,206,226,97,16,0],[99,142,198,201,90,22,13,8,2]];break;case 56:X=[[242,234,237,230,212,156,99,45,0],[243,238,238,168,101,45,0,0,0],[230,95,11,8,9,3,1,1,0]];break;case 57:X=[[53.091,15.096,19.89,5.916,45.951,135.1755,208.743,253.878,248.982],[42.432,91.7745,128.5455,163.6845,183.039,191.046,186.864,200.481,250.716],[134.9715,221.442,213.8175,201.807,163.8375,118.881,89.2245,50.184,13.7445]];break;case 58:X=[[0,24,2,54,176,236,202,194,255],[0,29,92,129,117,120,176,236,255],[0,68,80,34,57,172,252,245,255]];break;case 59:X=[[13,23,25,63,76,104,137,161,206],[95,67,37,21,0,12,35,52,79],[4,3,2,6,11,22,49,98,208]];break;case 60:X=[[0,61,89,122,143,160,185,204,231],[0,0,0,0,14,37,72,132,235],[0,140,224,144,4,5,6,9,13]];break;case 61:X=[[14,7,2,0,5,11,55,131,229],[105,56,26,1,42,74,131,171,229],[2,21,35,60,92,113,160,185,229]];break;case 62:X=[[0,0,0,70,148,231,235,237,244],[0,0,0,0,0,69,67,216,244],[0,102,228,231,177,124,137,20,244]];break;case 63:X=[[50,56,63,68,93,121,165,192,241],[66,81,91,96,111,128,155,189,241],[97,91,75,65,77,103,143,167,217]];break;case 64:X=[[145,166,167,156,131,114,101,112,132],[158,178,179,181,163,154,144,152,159],[190,199,201,192,176,169,160,166,190]];break;case 65:X=[[93,91,99,108,130,125,132,155,174],[126,124,128,129,131,121,119,153,173],[103,94,87,85,80,85,107,120,146]];break;case 66:X=[[24,40,69,90,104,114,120,132,103],[29,52,94,127,150,162,159,151,101],[29,52,96,132,162,181,184,186,131]];break;case 67:X=[[46,38,61,92,113,121,132,150,191],[46,36,40,69,110,135,131,92,34],[46,80,74,70,81,105,165,211,225]];break;case 68:X=[[0,4,12,30,52,101,142,190,237],[0,40,86,121,140,172,187,213,240],[0,9,14,18,21,23,27,35,101]];break;case 69:X=[[198,206,206,211,198,181,161,171,244],[103,133,150,172,178,174,163,175,244],[49,54,55,66,91,130,184,224,244]];break;case 70:X=[[243,243,240,240,241,239,186,151,129],[0,46,99,149,194,220,183,166,147],[6,8,36,91,169,235,246,240,233]];break;case 71:X=[[22,19,19,25,35,53,88,139,210],[0,32,69,108,135,159,183,198,215],[77,96,110,116,110,100,90,78,70]];break;case 72:X=[[68,116,165,182,189,180,145,111,71],[37,82,135,178,204,225,221,202,147],[16,55,105,147,196,226,232,224,178]];break;case 73:X=[[61,99,136,181,213,225,198,136,24],[149,140,96,83,132,178,190,135,22],[214,203,168,135,110,100,111,113,22]];break;case 74:X=[[76,120,156,183,197,180,162,154,140],[34,35,42,69,102,137,164,188,197],[64,69,78,105,142,177,205,217,198]];break;case 75:X=[[37,102,157,188,196,214,223,235,251],[37,29,25,37,67,91,132,185,251],[37,32,33,45,66,98,137,187,251]];break;case 76:X=[[79,100,119,137,153,172,192,205,250],[63,79,93,103,115,135,167,196,250],[51,59,66,61,62,70,110,160,250]];break;case 77:X=[[43,44,50,66,125,172,178,155,157],[63,63,85,101,138,163,122,51,39],[121,101,58,44,47,55,57,44,43]];break;case 78:X=[[0,41,62,79,90,87,99,140,228],[0,57,81,93,85,70,71,125,228],[95,91,91,82,60,43,44,112,228]];break;case 79:X=[[49,59,72,88,114,141,176,205,222],[78,72,66,57,59,75,106,142,173],[78,55,46,40,39,39,40,41,47]];break;case 80:X=[[243,222,201,185,165,158,166,187,219],[94,108,132,135,125,96,68,51,61],[7,9,12,19,45,89,118,146,118]];break;case 81:X=[[19,44,74,105,137,166,194,206,220],[19,28,40,55,82,110,159,181,220],[19,42,68,96,129,157,188,203,220]];break;case 82:X=[[33,44,70,99,140,165,199,211,216],[38,50,76,105,140,165,191,189,167],[55,67,97,124,140,166,163,129,52]];break;case 83:X=[[0,33,73,124,136,152,159,171,223],[0,43,92,124,134,126,121,144,223],[0,43,68,76,73,64,72,114,223]];break;case 84:X=[[5,18,45,124,193,223,205,128,49],[48,134,207,230,193,113,28,0,7],[6,15,41,121,193,226,208,130,49]];break;case 85:X=[[180,106,104,135,164,188,189,165,144],[72,126,154,184,198,207,205,190,179],[41,120,158,188,194,181,145,100,62]];break;case 86:X=[[57,72,94,117,136,154,174,192,215],[0,33,68,109,140,171,192,196,209],[116,137,173,201,200,201,203,190,187]];break;case 87:X=[[31,71,123,160,210,222,214,199,183],[40,117,171,211,231,220,190,132,65],[234,214,228,222,210,160,105,60,34]];break;case 88:X=[[123,108,109,126,154,172,188,196,218],[184,138,130,133,154,175,188,196,218],[208,130,109,99,110,122,150,171,218]];break;case 89:X=[[105,106,122,143,159,172,176,181,207],[252,197,194,187,174,162,153,136,125],[146,133,144,155,163,167,166,162,174]];break;case 90:X=[[171,141,145,152,154,159,163,158,177],[236,143,100,63,53,55,44,31,6],[59,48,46,44,42,54,82,112,179]];break;case 91:X=[[180,190,209,223,204,228,205,152,91],[93,125,147,172,181,224,233,198,158],[236,218,160,133,114,132,162,220,218]];break;case 92:X=[[225,183,162,135,115,111,119,145,211],[205,177,166,135,124,117,117,132,172],[186,165,155,135,126,130,150,178,226]];break;case 93:X=[[39,43,59,63,80,116,153,177,223],[39,43,59,74,91,114,139,165,223],[39,50,59,70,85,115,151,176,223]];break;case 94:X=[[0,38,60,76,84,89,101,128,204],[0,10,15,23,35,57,83,123,199],[0,11,22,40,63,86,97,94,85]];break;case 95:X=[[94,112,141,165,167,140,91,49,27],[27,46,88,135,166,161,135,97,58],[42,52,81,106,139,158,155,137,116]];break;case 96:X=[[30,49,79,117,135,151,146,138,147],[63,60,72,90,94,94,68,46,16],[18,28,41,56,62,63,50,36,21]];break;case 97:X=[[0,30,63,101,143,152,169,187,230],[0,14,28,42,58,61,67,74,91],[39,26,21,18,15,14,14,13,13]];break;case 98:X=[[149,140,164,179,182,181,131,87,61],[62,70,107,136,144,138,117,87,74],[40,38,45,49,49,49,38,32,34]];break;case 99:X=[[99,112,148,165,179,182,183,183,208],[39,40,57,79,104,127,148,161,198],[15,16,18,33,51,79,103,129,177]];break;case 100:X=[[99,116,154,174,200,196,201,201,230],[0,0,8,32,58,83,119,136,173],[5,6,7,9,9,14,17,19,24]];break;case 101:X=[[82,106,126,141,155,163,142,107,66],[62,44,69,107,135,152,149,132,119],[39,25,31,60,73,68,49,72,188]];break;case 102:X=[[18,29,44,72,116,158,184,208,221],[27,46,71,105,146,177,189,190,183],[39,55,80,108,130,133,124,100,76]];break;case 103:X=[[0,48,119,173,212,224,228,228,245],[0,13,30,47,79,127,167,205,245],[0,68,75,43,16,22,55,128,245]];break;case 104:X=[[34,70,129,187,225,226,216,193,179],[48,91,147,194,226,229,196,110,12],[234,212,216,224,206,110,53,40,29]];break;case 105:X=[[30,55,103,147,174,203,188,151,105],[0,65,138,182,187,175,121,53,9],[191,202,212,208,171,140,97,57,30]];break;case 106:X=[[112,97,113,125,138,159,178,188,225],[16,17,24,37,56,81,110,136,189],[38,35,46,59,78,103,130,152,201]];break;case 107:X=[[18,72,5,23,29,201,200,98,29],[0,0,43,167,211,117,0,0,0],[51,203,177,26,10,9,8,3,0]];break;case 108:X=[[19,42,64,88,118,147,175,187,205],[19,55,89,125,154,169,161,129,70],[19,32,47,70,100,128,145,130,75]];break;case 109:X=[[33,31,42,68,86,111,141,172,227],[255,175,145,106,88,55,15,0,0],[255,205,202,203,208,205,203,206,231]];break;case 110:X=[[0,25,50,79,110,145,181,201,254],[0,16,30,46,63,82,101,124,179],[0,12,21,29,39,49,61,74,103]];break;case 111:X=[[0,13,30,44,72,120,156,200,247],[0,36,84,117,141,153,151,158,247],[0,94,100,82,56,66,76,131,247]];break;case 112:X=[[26,51,43,33,28,35,74,144,246],[9,24,55,87,118,150,180,200,222],[30,96,112,114,112,101,72,35,0]];break;case 113:X=[[0,5,65,97,124,156,189,224,255],[32,54,77,100,123,148,175,203,234],[77,110,107,111,120,119,111,94,70]];break;default:return w()}const z=X[0],m=X[1],I=X[2],A=[];for(let R=1;R<H.length;R++){const k=Math.round(Math.floor(255*H[R])-Math.floor(255*H[R-1]));for(let ee=0;ee<k;ee++){const ge="#"+L(z[R-1]+ee*(z[R]-z[R-1])/k,1)+L(m[R-1]+ee*(m[R]-m[R-1])/k,1)+L(I[R-1]+ee*(I[R]-I[R-1])/k,1);A.push(ge)}}return new P(A,O)}function C(N){const O=[],H=N.split(";");for(let X=0;X<H.length;++X){const ie=H[X];let z=ie.indexOf(":");if(z>0){O[parseInt(ie.slice(0,z))]=(0,v.yW)(`rgb(${ie.slice(z+1)})`).formatHex();continue}if(z=ie.indexOf("="),z>0){O[parseInt(ie.slice(0,z))]=(0,v.yW)(`rgba(${ie.slice(z+1)})`).formatHex8();continue}if(z=ie.indexOf("#"),z<0)continue;const m=parseInt(ie.slice(0,z)),I=JSON.parse(ie.slice(z+1)),A={_typename:10===I[0]?V:Le,fNumber:m,fType:I[0]};let R=1;A.fCoordinateMode=Math.round(I[R++]);const k=Math.round(I[R++]);A.fColorPositions=I.slice(R,R+k),R+=k,A.fColors=I.slice(R,R+4*k),R+=4*k,A.fStart={fX:I[R++],fY:I[R++]},A.fEnd={fX:I[R++],fY:I[R++]},A._typename===Le&&R<I.length&&(A.fR1=I[R++],A.fR2=I[R++]),O[m]=A}return O}!function re(){const N=["white","black","red","green","blue","yellow","magenta","cyan","#59d454","#5954d9","white"];N[110]="white",[{n:11,s:"c1b7ad4d4d4d6666668080809a9a9ab3b3b3cdcdcde6e6e6f3f3f3cdc8accdc8acc3c0a9bbb6a4b3a697b8a49cae9a8d9c8f83886657b1cfc885c3a48aa9a1839f8daebdc87b8f9a768a926983976e7b857d9ad280809caca6c0d4cf88dfbb88bd9f83c89a7dc08378cf5f61ac8f94a6787b946971d45a549300ff7b00ff6300ff4b00ff3300ff1b00ff0300ff0014ff002cff0044ff005cff0074ff008cff00a4ff00bcff00d4ff00ecff00fffd00ffe500ffcd00ffb500ff9d00ff8500ff6d00ff5500ff3d00ff2600ff0e0aff0022ff003aff0052ff006aff0082ff009aff00b1ff00c9ff00e1ff00f9ff00ffef00ffd700ffbf00ffa700ff8f00ff7700ff6000ff4800ff3000ff1800ff0000"},{n:201,s:"5c5c5c7b7b7bb8b8b8d7d7d78a0f0fb81414ec4848f176760f8a0f14b81448ec4876f1760f0f8a1414b84848ec7676f18a8a0fb8b814ecec48f1f1768a0f8ab814b8ec48ecf176f10f8a8a14b8b848ecec76f1f1"},{n:390,s:"ffffcdffff9acdcd9affff66cdcd669a9a66ffff33cdcd339a9a33666633ffff00cdcd009a9a00666600333300"},{n:406,s:"cdffcd9aff9a9acd9a66ff6666cd66669a6633ff3333cd33339a3333663300ff0000cd00009a00006600003300"},{n:422,s:"cdffff9affff9acdcd66ffff66cdcd669a9a33ffff33cdcd339a9a33666600ffff00cdcd009a9a006666003333"},{n:590,s:"cdcdff9a9aff9a9acd6666ff6666cd66669a3333ff3333cd33339a3333660000ff0000cd00009a000066000033"},{n:606,s:"ffcdffff9affcd9acdff66ffcd66cd9a669aff33ffcd33cd9a339a663366ff00ffcd00cd9a009a660066330033"},{n:622,s:"ffcdcdff9a9acd9a9aff6666cd66669a6666ff3333cd33339a3333663333ff0000cd00009a0000660000330000"},{n:791,s:"ffcd9acd9a669a66339a6600cd9a33ffcd66ff9a00ffcd33cd9a00ffcd00ff9a33cd66006633009a3300cd6633ff9a66ff6600ff6633cd3300ff33009aff3366cd00336600339a0066cd339aff6666ff0066ff3333cd0033ff00cdff9a9acd66669a33669a009acd33cdff669aff00cdff339acd00cdff009affcd66cd9a339a66009a6633cd9a66ffcd00ff6633ffcd00cd9a00ffcd33ff9a00cd66006633009a3333cd6666ff9a00ff9a33ff6600cd3300ff339acdff669acd33669a00339a3366cd669aff0066ff3366ff0033cd0033ff339aff0066cd00336600669a339acd66cdff009aff33cdff009acd00cdffcd9aff9a66cd66339a66009a9a33cdcd66ff9a00ffcd33ff9a00cdcd00ff9a33ff6600cd33006633009a6633cd9a66ff6600ff6633ff3300cd3300ffff339acd00666600339a0033cd3366ff669aff0066ff3366cd0033ff0033ff9acdcd669a9a33669a0066cd339aff66cdff009acd009aff33cdff009a"},{n:920,s:"cdcdcd9a9a9a666666333333"}].forEach(H=>{const X=H.s;for(let ie=0;ie<X.length;ie+=6)N[H.n+ie/6]="#"+X.slice(ie,ie+6)}),he=N}()},9489:(Gr,xt,Te)=>{"use strict";Te.d(xt,{Dx:()=>V,YI:()=>Le,rr:()=>xe});var be=Te(4186),v=Te(1085);function V(Je,st){Je.$math=v;let Ke=Je.fTitle,ot=!1,Re="[";if("gaus"===Ke&&(Ke="gaus(0)"),(0,be.isStr)(Je.fFormula?.fFormula)&&(0===Je.fFormula.fFormula.indexOf("[](double*x,double*p)")?(ot=!0,Re="p[",Ke=Je.fFormula.fFormula.slice(21)):(Ke=Je.fFormula.fFormula,Re="[p"),Je.fFormula.fClingParameters&&Je.fFormula.fParams&&Je.fFormula.fParams.forEach(Qe=>{const Ie=new RegExp(`(\\[${Qe.first}\\])`,"g"),L=Je.fFormula.fClingParameters[Qe.second];Ke=Ke.replace(Ie,L<0?`(${L})`:L)})),!Ke)return!st||Je.fSave?.length>2;if(Je.formulas?.forEach(Qe=>{Ke=Ke.replaceAll(Qe.fName,Qe.fTitle)}),Ke=Ke.replace(/\b(TMath::SinH)\b/g,"Math.sinh").replace(/\b(TMath::CosH)\b/g,"Math.cosh").replace(/\b(TMath::TanH)\b/g,"Math.tanh").replace(/\b(TMath::ASinH)\b/g,"Math.asinh").replace(/\b(TMath::ACosH)\b/g,"Math.acosh").replace(/\b(TMath::ATanH)\b/g,"Math.atanh").replace(/\b(TMath::ASin)\b/g,"Math.asin").replace(/\b(TMath::ACos)\b/g,"Math.acos").replace(/\b(TMath::Atan)\b/g,"Math.atan").replace(/\b(TMath::ATan2)\b/g,"Math.atan2").replace(/\b(sin|SIN|TMath::Sin)\b/g,"Math.sin").replace(/\b(cos|COS|TMath::Cos)\b/g,"Math.cos").replace(/\b(tan|TAN|TMath::Tan)\b/g,"Math.tan").replace(/\b(exp|EXP|TMath::Exp)\b/g,"Math.exp").replace(/\b(log|LOG|TMath::Log)\b/g,"Math.log").replace(/\b(log10|LOG10|TMath::Log10)\b/g,"Math.log10").replace(/\b(pow|POW|TMath::Power)\b/g,"Math.pow").replace(/\b(pi|PI)\b/g,"Math.PI").replace(/\b(abs|ABS|TMath::Abs)\b/g,"Math.abs").replace(/\bsqrt\(/g,"Math.sqrt(").replace(/\bxygaus\(/g,"this.$math.gausxy(this, x, y, ").replace(/\bgaus\(/g,"this.$math.gaus(this, x, ").replace(/\bgausn\(/g,"this.$math.gausn(this, x, ").replace(/\bexpo\(/g,"this.$math.expo(this, x, ").replace(/\blandau\(/g,"this.$math.landau(this, x, ").replace(/\blandaun\(/g,"this.$math.landaun(this, x, ").replace(/\b(TMath::|ROOT::Math::)/g,"this.$math."),Ke.match(/^pol[0-9]$/)&&parseInt(Ke[3])===Je.fNpar-1){Ke="[0]";for(let Qe=1;Qe<Je.fNpar;++Qe)Ke+=` + [${Qe}] * `+(1===Qe?"x":`Math.pow(x,${Qe})`)}if(Ke.match(/^chebyshev[0-9]$/)&&parseInt(Ke[9])===Je.fNpar-1){Ke=`this.$math.ChebyshevN(${Je.fNpar-1}, x, `;for(let Qe=0;Qe<Je.fNpar;++Qe)Ke+=(0===Qe?"[":", ")+`[${Qe}]`;Ke+="])"}for(let Qe=0;Qe<Je.fNpar;++Qe)Ke=Ke.replaceAll(Re+Qe+"]",`(${Je.GetParValue(Qe)})`);for(let Qe=2;Qe<10;++Qe)Ke=Ke.replaceAll(`x^${Qe}`,`Math.pow(x,${Qe})`);return ot?(Ke=Ke.replace(/x\[0\]/g,"x"),Je._typename===be.clTF3?(Ke=Ke.replace(/x\[1\]/g,"y"),Ke=Ke.replace(/x\[2\]/g,"z"),Je.evalPar=new Function("x","y","z",Ke).bind(Je)):Je._typename===be.clTF2?(Ke=Ke.replace(/x\[1\]/g,"y"),Je.evalPar=new Function("x","y",Ke).bind(Je)):Je.evalPar=new Function("x",Ke).bind(Je)):Je.evalPar=Je._typename===be.clTF3?new Function("x","y","z","return "+Ke).bind(Je):Je._typename===be.clTF2?new Function("x","y","return "+Ke).bind(Je):new Function("x","return "+Ke).bind(Je),!0}function Le(Je,st){const Ke=Je.fSave.length-3,ot=Je.fSave[Ke+1],Re=Je.fSave[Ke+2],Qe=(Re-ot)/Ke;if(st<ot)return Je.fSave[0];if(st>Re)return Je.fSave[Ke];const Ie=Math.min(Ke-1,Math.floor((st-ot)/Qe));let L=ot+Ie*Qe,he=L+Qe,re=Je.fSave[Ie],fe=Je.fSave[Ie+1];return!Number.isFinite(re)&&Ie<Ke-1?(L+=Qe,he+=Qe,re=fe,fe=Je.fSave[Ie+2]):!Number.isFinite(fe)&&Ie>0&&(he-=Qe,L-=Qe,fe=re,re=Je.fSave[Ie-1]),(he*re-L*fe+st*(fe-re))/Qe}function xe(Je,st,Ke=void 0){let ot=0,Re=!1;if(!Je)return 0;if(!Ke&&!Je.evalPar)try{V(Je)||(Re=!0)}catch{Re=!0}if(Je.evalPar&&!Re)try{return ot=Je.evalPar(st),ot}catch{ot=0}const Qe=Je.fSave.length-3;return Qe<2||Je.fSave[Qe+1]===Je.fSave[Qe+2]?0:Le(Je,st)}},2525:(Gr,xt,Te)=>{"use strict";Te.d(xt,{Bm:()=>G,KA:()=>ce,N7:()=>Re,_o:()=>X,cp:()=>fe,eN:()=>pe,s7:()=>z,xV:()=>st});var be=Te(5774),v=Te(4186),V=Te(165),Le=Te(5460);const xe={"#alpha":"\u03b1","#beta":"\u03b2","#chi":"\u03c7","#delta":"\u03b4","#varepsilon":"\u03b5","#phi":"\u03c6","#gamma":"\u03b3","#eta":"\u03b7","#iota":"\u03b9","#varphi":"\u03c6","#kappa":"\u03ba","#lambda":"\u03bb","#mu":"\u03bc","#nu":"\u03bd","#omicron":"\u03bf","#pi":"\u03c0","#theta":"\u03b8","#rho":"\u03c1","#sigma":"\u03c3","#tau":"\u03c4","#upsilon":"\u03c5","#varomega":"\u03d6","#omega":"\u03c9","#xi":"\u03be","#psi":"\u03c8","#zeta":"\u03b6","#Alpha":"\u0391","#Beta":"\u0392","#Chi":"\u03a7","#Delta":"\u0394","#Epsilon":"\u0395","#Phi":"\u03a6","#Gamma":"\u0393","#Eta":"\u0397","#Iota":"\u0399","#vartheta":"\u03d1","#Kappa":"\u039a","#Lambda":"\u039b","#Mu":"\u039c","#Nu":"\u039d","#Omicron":"\u039f","#Pi":"\u03a0","#Theta":"\u0398","#Rho":"\u03a1","#Sigma":"\u03a3","#Tau":"\u03a4","#Upsilon":"\u03a5","#varsigma":"\u03c2","#Omega":"\u03a9","#Xi":"\u039e","#Psi":"\u03a8","#Zeta":"\u0396","#varUpsilon":"\u03d2","#epsilon":"\u03b5","#leq":"\u2264","#/":"\u2044","#infty":"\u221e","#voidb":"\u0192","#club":"\u2663","#diamond":"\u2666","#heart":"\u2665","#spade":"\u2660","#leftrightarrow":"\u2194","#leftarrow":"\u2190","#uparrow":"\u2191","#rightarrow":"\u2192","#downarrow":"\u2193","#circ":"\u2e30","#pm":"\xb1","#doublequote":"\u2033","#geq":"\u2265","#times":"\xd7","#propto":"\u221d","#partial":"\u2202","#bullet":"\u2022","#divide":"\xf7","#neq":"\u2260","#equiv":"\u2261","#approx":"\u2248","#3dots":"\u2026","#cbar":"|","#topbar":"\xaf","#downleftarrow":"\u21b5","#aleph":"\u2135","#Jgothic":"\u2111","#Rgothic":"\u211c","#voidn":"\u2118","#otimes":"\u2297","#oplus":"\u2295","#oslash":"\u2205","#cap":"\u2229","#cup":"\u222a","#supset":"\u2283","#supseteq":"\u2287","#notsubset":"\u2284","#subset":"\u2282","#subseteq":"\u2286","#in":"\u2208","#notin":"\u2209","#angle":"\u2220","#nabla":"\u2207","#oright":"\xae","#ocopyright":"\xa9","#trademark":"\u2122","#prod":"\u220f","#surd":"\u221a","#upoint":"\u2027","#corner":"\xac","#wedge":"\u2227","#vee":"\u2228","#Leftrightarrow":"\u21d4","#Leftarrow":"\u21d0","#Uparrow":"\u21d1","#Rightarrow":"\u21d2","#Downarrow":"\u21d3","#void2":"","#LT":"<","#void1":"\xae","#copyright":"\xa9","#void3":"\u2122","#sum":"\u2211","#arctop":"\u239b","#lbar":"\u23a2","#arcbottom":"\u239d","#void4":"","#void8":"\u23a2","#bottombar":"\u230a","#arcbar":"\u23a7","#ltbar":"\u23a8","#AA":"\u212b","#aa":"\xe5","#void06":"","#GT":">","#int":"\u222b","#forall":"\u2200","#exists":"\u2203","#koppa":"\u03df","#sampi":"\u03e1","#stigma":"\u03db","#san":"\u03fb","#sho":"\u03f8","#varcoppa":"\u03d9","#digamma":"\u03dd","#Digamma":"\u03dc","#Koppa":"\u03de","#varKoppa":"\u03d8","#Sampi":"\u03e0","#Stigma":"\u03da","#San":"\u03fa","#Sho":"\u03f7","#vec":"","#dot":"\u22c5","#hat":"\xb7","#ddot":"","#acute":"","#grave":"","#check":"\u2713","#tilde":"\u02dc","#slash":"\u2044","#hbar":"\u0127","#box":"\u25fd","#Box":"\u2610","#parallel":"\u2225","#perp":"\u22a5","#odot":"\u2299","#left":"","#right":"","{}":"","#mp":"\u2213","#P":"\xb6","#sqrt":"\u221a","#bar":"","#overline":"","#underline":"","#strike":""},Je=new RegExp(Object.keys(xe).sort((I,A)=>I.length<A.length?1:I.length>A.length?-1:0).join("|"),"g"),st=I=>{for(;I.length>2&&"{"===I[0]&&"}"===I[I.length-1];)I=I.slice(1,I.length-1);return I.replace(Je,A=>xe[A]).replace(/\{\}/g,"")},Ke=[453,535,661,973,955,1448,1242,324,593,596,778,1011,431,570,468,492,947,885,947,947,947,947,947,947,947,947,511,495,980,1010,987,893,1624,1185,1147,1193,1216,1080,1028,1270,1274,531,910,1177,1004,1521,1252,1276,1111,1276,1164,1056,1073,1215,1159,1596,1150,1124,1065,540,591,540,837,874,572,929,972,879,973,901,569,967,973,453,458,903,453,1477,973,970,972,976,638,846,548,973,870,1285,884,864,835,656,430,656,1069],ot={945:1002,946:996,967:917,948:953,949:834,966:1149,947:847,951:989,953:516,954:951,955:913,956:1003,957:862,959:967,960:1070,952:954,961:973,963:1017,964:797,965:944,982:1354,969:1359,958:803,968:1232,950:825,913:1194,914:1153,935:1162,916:1178,917:1086,934:1358,915:1016,919:1275,921:539,977:995,922:1189,923:1170,924:1523,925:1253,927:1281,928:1281,920:1285,929:1102,931:1041,932:1069,933:1135,962:848,937:1279,926:1092,936:1334,918:1067,978:1154,8730:986,8804:940,8260:476,8734:1453,402:811,9827:1170,9830:931,9829:1067,9824:965,8596:1768,8592:1761,8593:895,8594:1761,8595:895,710:695,177:955,8243:680,8805:947,215:995,8733:1124,8706:916,8226:626,247:977,8800:969,8801:1031,8776:976,8230:1552,175:883,8629:1454,8501:1095,8465:1002,8476:1490,8472:1493,8855:1417,8853:1417,8709:1205,8745:1276,8746:1404,8839:1426,8835:1426,8836:1426,8838:1426,8834:1426,8747:480,8712:1426,8713:1426,8736:1608,8711:1551,174:1339,169:1339,8482:1469,8719:1364,729:522,172:1033,8743:1383,8744:1383,8660:1768,8656:1496,8657:1447,8658:1496,8659:1447,8721:1182,9115:882,9144:1e3,9117:882,8970:749,9127:1322,9128:1322,8491:1150,229:929,8704:1397,8707:1170,8901:524,183:519,10003:1477,732:692,295:984,9725:1780,9744:1581,8741:737,8869:1390,8857:1421};function Re(I,A,R){const k=I.length,ee=(R||A.size)*A.aver_width;if(A.isMonospace())return k*ee;let ge=0;for(let ve=0;ve<k;++ve){const Se=I.charCodeAt(ve);ge+=Se>=32&&Se<127?Ke[Se-32]:ot[Se]||1e3}return ge/1e3*ee}const Qe=[{name:"#it{"},{name:"#bf{"},{name:"#underline{",deco:"underline"},{name:"#overline{",deco:"overline"},{name:"#strike{",deco:"line-through"},{name:"#kern[",arg:"float"},{name:"#lower[",arg:"float"},{name:"#scale[",arg:"float"},{name:"#color[",arg:"int"},{name:"#font[",arg:"int"},{name:"_{",low_up:"low"},{name:"^{",low_up:"up"},{name:"#bar{",deco:"overline"},{name:"#hat{",accent:"\u02c6",hasw:!0},{name:"#check{",accent:"\u02c7",hasw:!0},{name:"#acute{",accent:"\u02ca"},{name:"#grave{",accent:"\u02cb"},{name:"#dot{",accent:"\u02d9"},{name:"#ddot{",accent:"\u02ba",hasw:!0},{name:"#tilde{",accent:"\u02dc",hasw:!0},{name:"#slash{",accent:"\u2215"},{name:"#vec{",accent:"\u02ed",hasw:!0},{name:"#frac{",twolines:"line"},{name:"#splitline{",twolines:!0},{name:"#sqrt[",arg:"int",sqrt:!0},{name:"#sqrt{",sqrt:!0},{name:"#sum",special:"\u2211",w:.8,h:.9},{name:"#int",special:"\u222b",w:.3,h:1},{name:"#left[",right:"#right]",braces:"[]"},{name:"#left(",right:"#right)",braces:"()"},{name:"#left{",right:"#right}",braces:"{}"},{name:"#left|",right:"#right|",braces:"||"},{name:"#[]{",braces:"[]"},{name:"#(){",braces:"()"},{name:"#{}{",braces:"{}"},{name:"#||{",braces:"||"}],Ie=[0,8704,0,8707,0,0,8717,0,0,8727,0,0,8722,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8773,913,914,935,916,917,934,915,919,921,977,922,923,924,925,927,928,920,929,931,932,933,962,937,926,936,918,0,8756,0,8869,0,0,945,946,967,948,949,966,947,951,953,981,954,955,956,957,959,960,952,961,963,964,965,982,969,958,968,950,0,402,0,8764,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,978,8242,8804,8260,8734,0,9827,9830,9829,9824,8596,8592,8593,8594,8595,0,0,8243,8805,0,8733,8706,8729,0,8800,8801,8776,8230,0,0,8629,8501,8465,8476,8472,8855,8853,8709,8745,8746,8835,8839,8836,8834,8838,8712,8713,8736,8711,0,0,8482,8719,8730,8901,0,8743,8744,8660,8656,8657,8658,8659,9674,9001,0,0,8482,8721,0,0,0,0,0,0,0,0,0,0,8364,9002,8747,8992,0,8993],L=[128393,9986,9985,128083,128365,128366,128367,128383,9990,128386,128387,128234,128235,128236,128237,128193,128194,128196,128463,128464,128452,8987,128430,128432,128434,128435,128436,128427,128428,9991,9997,128398,9996,128076,128077,128078,9756,9758,9757,9759,128400,9786,128528,9785,128163,9760,127987,127985,9992,9788,128167,10052,128326,10014,128328,10016,10017,9770,9775,2384,9784,9800,9801,9802,9803,9804,9805,9806,9807,9808,9809,9810,9811,128624,128629,9679,128318,9632,9633,128912,10065,10066,11047,10731,9670,10070,11045,8999,11193,8984,127989,127990,128630,128631,0,9450,9312,9313,9314,9315,9316,9317,9318,9319,9320,9321,9471,10102,10103,10104,10105,10106,10107,10108,10109,10110,10111,128610,128608,128609,128611,128606,128604,128605,128607,183,8226,9642,9898,128902,128904,9673,9678,128319,9642,9723,128962,10022,9733,10038,10036,10041,10037,11216,8982,10209,8977,11217,10026,10032,128336,128337,128338,128339,128340,128341,128342,128343,128344,128345,128346,128347,11184,11185,11186,11187,11188,11189,11190,11191,128618,128619,128597,128596,128599,128598,128592,128593,128594,128595,9003,8998,11160,11162,11161,11163,11144,11146,11145,11147,129128,129130,129129,129131,129132,129133,129135,129134,129144,129146,129145,129147,129148,129149,129151,129150,8678,8680,8679,8681,11012,8691,11008,11009,11011,11010,129196,129197,128502,10004,128503,128505],he={};function re(I){if(!he[945]){let A=0;for(const R in xe){const k=xe[R];if(1===k.length){let ee=0;if(A<54)ee=97+A,A>25&&(ee-=58),52===A&&(ee=161),53===A&&(ee=206);else{const ve=A-54;switch(ee=163+ve,ve){case 75:ee=197;break;case 76:ee=229;break;case 80:ee=34;break;case 81:ee=36}}const ge=k.charCodeAt(0);ge>128&&(he[ge]=ee)}if(++A>136)break}}return he[I]??I}function fe(I){if(1!==I.childNodes.length)return!1;const A=I.textContent;if(!A)return!1;let R="",k=-1;for(let ee=0;ee<A.length;ee++){const ge=A.charCodeAt(ee),ve=re(ge);ge!==ve&&(R+=A.slice(k+1,ee)+'<tspan font-family="symbol" font-style="normal" font-weight="normal">'+String.fromCharCode(ve)+"</tspan>",k=ee)}return!(k<0||(k<A.length-1&&(R+=A.slice(k+1,A.length)),I.$originalHTML=I.innerHTML,I.innerHTML=R,0))}function de(I,A){const R="Wingdings"===A?L:Ie;let k="";for(let ee=0;ee<I.length;++ee){const ge=I.charCodeAt(ee);k+=String.fromCodePoint((ge>32?R[ge-33]:0)||ge)}return k}function pe(I,A,R){R.plain=!0,R.simple_latex&&(R.text=st(R.text)),A.text(R.font&&R.font.isSymbol?de(R.text,R.font.isSymbol):R.text)}function ce(I){return!I||I.indexOf("#")<0&&I.indexOf("{")<0}function K(I,A,R,k){let ee=0;const ge=()=>(k.g||(k.g=I.append("svg:g")),k.g),ve=Ne=>{k.x+=Math.round(Ne)},Se=(Ne,Fe,ht,pt)=>{k.rect?(k.rect.x1=Math.min(k.rect.x1,Ne),k.rect.y1=Math.min(k.rect.y1,Fe),k.rect.x2=Math.max(k.rect.x2,ht),k.rect.y2=Math.max(k.rect.y2,pt)):k.rect={x1:Ne,y1:Fe,x2:ht,y2:pt},k.rect.last_y1=Fe,k.rect.width=k.rect.x2-k.rect.x1,k.rect.height=k.rect.y2-k.rect.y1,k.parent||(A.text_rect=k.rect)},De=Ne=>{Se(k.x,k.y,k.x+Ne*k.fsize*.4,k.y),ve(Ne*k.fsize*.4)},Xe=(Ne,Fe,ht,pt)=>{Fe=Math.round(Fe),ht=Math.round(ht),(0,V.bk)(Ne.g,Fe,ht),Ne.rect.x1+=Fe,Ne.rect.x2+=Fe,Ne.rect.y1+=ht,Ne.rect.y2+=ht,pt?Se(k.x+Ne.rect.x1,k.y+Ne.rect.y1,k.x+Ne.rect.x2,k.y+Ne.rect.y2):Se(Ne.rect.x1,Ne.rect.y1,Ne.rect.x2,Ne.rect.y2)},ct=()=>{const Ne=ge();return 1!==ee||R||k.x||k.y?(0,V.bk)(Ne.append("svg:g"),k.x,k.y):Ne},$=(Ne,Fe,ht)=>{let pt=0,dt=1,rt=!1;Fe||(Fe="{"),ht||(ht="}");const _t=kt=>pt+kt.length<=R.length&&R.slice(pt,pt+kt.length)===kt;if(Ne){if(!_t(Fe))return console.log(`not starting with ${Fe} in ${R}`),-1;R=R.slice(Fe.length)}for(;0!==dt&&pt<R.length;)_t(Fe)?(dt++,pt+=Fe.length):_t(ht)?(dt--,pt+=ht.length,0===dt&&"string"==typeof Ne&&_t(Ne+Fe)&&(dt++,pt+=Fe.length+Ne.length,Ne=!0,rt=!0)):pt++;if(0!==dt)return console.log(`mismatch with open ${Fe} and closing ${ht} in ${R}`),-1;let Yt=R.slice(0,pt-ht.length);return rt&&(Yt=Fe+Yt+ht),R=R.slice(pt),Yt},tt=(Ne,Fe,ht)=>Ne.append("svg:path").style("stroke",ht?"none":k.color||A.color).style("stroke-width",ht?null:Math.max(1,Math.round(k.fsize*(k.font.weight?.1:.07)))).style("fill",ht?k.color||A.color:"none").attr("d",Fe??null),We=Ne=>({lvl:k.lvl+1,x:0,y:0,fsize:k.fsize*(Ne||1),color:k.color,font:k.font,parent:k,painter:k.painter});for(;R;){let Ne=R.length,Fe=null;for(let dt=0;dt<Qe.length;++dt){const rt=R.indexOf(Qe[dt].name);rt>=0&&rt<Ne&&(Ne=rt,Fe=Qe[dt])}if(Ne>0){const dt=Ne===R.length&&0===ee&&!Fe;ee++;let rt=st(R.slice(0,Ne)),_t=0,Yt=0;for(;_t<rt.length&&" "===rt[_t];)_t++;for(_t>0&&(De(_t),rt=rt.slice(_t));Yt<rt.length&&" "===rt[rt.length-1-Yt];)Yt++;if(Yt>0&&(rt=rt.slice(0,rt.length-Yt)),rt||dt){const Tt=(k.g||(dt?I:ge())).append("svg:text");dt&&!k.g&&(k.g=Tt),k.ufont&&(k.font.setPainter(A.painter),k.font.setFont(k.g)),void 0!==k.bold&&k.g.attr("font-weight",k.bold?"bold":"normal"),void 0!==k.italic&&k.g.attr("font-style",k.italic?"italic":"normal"),Tt.attr("fill",k.color||A.color||null),k.fisze!==k.font.size&&Tt.attr("font-size",Math.round(k.fsize)),Tt.text(k.font&&k.font.isSymbol?de(rt,k.font.isSymbol):rt);const fn=(0,v.isNodeJs)()||v.settings.ApproxTextSize||A.fast?{height:1.2*k.fsize,width:Re(rt,k.font,k.fsize)}:(0,V.xh)(Tt,"nopadding");k.x&&Tt.attr("x",k.x),k.y&&Tt.attr("y",k.y);const ln=1===rt.length&&!k.font.isMonospace()&&"lfij".indexOf(rt)>=0?.1*k.fsize:0;Se(k.x,k.y-.8*fn.height,k.x+fn.width,k.y+.2*fn.height),dt?k.deco?(Tt.attr("text-decoration",k.deco),delete k.deco):k.xgap=ln:(ve(fn.width+ln),De(Yt),k.xgap=0)}else De(Yt)}if(!Fe)return!0;if(R=R.slice(Ne+Fe.name.length),ee++,Fe.accent){const dt=$();if(-1===dt)return!1;const rt=ct(),_t=We(),Yt=1!==dt.length?1:dt>="a"&&dt<="z"&&"tdbfhkli".indexOf(dt)<0?.75:.9;K(rt,A,dt,_t);const kt=.6*k.fsize,Tt=Math.round(_t.rect.y1*Yt),fn=Math.round(.1*k.fsize),ln=2*fn,mn=`a${fn},${fn},0,0,1,${ln},0a${fn},${fn},0,0,1,${-ln},0z`;let jt=0,Sn=_t.rect.width;Fe.hasw&&Sn<kt&&(Sn=kt,jt=(kt-_t.rect.width)/2);const cn=Math.round(.5*Sn),gn=Math.round(.3*Sn),Cn=cn-gn,Ln=cn+gn;switch(Sn=2*cn,Xe(_t,jt,0,!0),Fe.name){case"#check{":tt(rt,`M${Cn},${Tt-ln}L${cn},${Tt}L${Ln},${Tt-ln}`);break;case"#acute{":tt(rt,`M${cn},${Tt}l${ln},${-ln}`);break;case"#grave{":tt(rt,`M${cn},${Tt}l${-ln},${-ln}`);break;case"#dot{":tt(rt,`M${cn-fn},${Tt}${mn}`,!0);break;case"#ddot{":tt(rt,`M${cn-3*fn},${Tt}${mn} M${cn+fn},${Tt}${mn}`,!0);break;case"#tilde{":tt(rt,`M${Cn},${Tt} a${gn},${ln},0,0,1,${gn},0 a${gn},${ln},0,0,0,${gn},0`);break;case"#slash{":tt(rt,`M${Sn},${Tt}L0,${Math.round(_t.rect.y2)}`);break;case"#vec{":tt(rt,`M${Cn},${Tt}H${Ln}M${Ln-ln},${Tt-ln}l${ln},${ln}l${-ln},${ln}`);break;default:tt(rt,`M${Cn},${Tt}L${cn},${Tt-ln}L${Ln},${Tt}`)}ve(_t.rect.width+(_t.xgap??0));continue}if(Fe.twolines){k.twolines=!0;const dt=$(),rt=$(!0);if(-1===dt||-1===rt)return!1;const _t=ct(),Yt=k.parent&&k.parent.twolines?.7:1,kt=We(Yt);K(_t,A,dt,kt);const Tt="line"===Fe.twolines?tt(_t):null,fn=We(Yt);K(_t,A,rt,fn);const ln=Math.max(kt.rect.width,fn.rect.width),mn=kt.rect.width-fn.rect.width,jt=.35*-k.fsize;Xe(kt,mn<0?-mn/2:0,jt-kt.rect.y2,!0),Xe(fn,mn>0?mn/2:0,jt-fn.rect.y1,!0),Tt&&Tt.attr("d",`M0,${Math.round(jt)}h${Math.round(ln-.1*k.fsize)}`),ve(ln),delete k.twolines;continue}const ht=dt=>{const rt={};if(dt&&(R="{"+R,rt[dt]=$("low"===dt?"_":"^"),-1===rt[dt]))return!1;for(;R;)if("_"===R[0]){if(R=R.slice(1),rt.low=rt.low?-1:$("_"),-1===rt.low)return console.log(`error with ${Fe.name} low limit`),!1}else{if("^"!==R[0])break;if(R=R.slice(1),rt.up=rt.up?-1:$("^"),-1===rt.up)return console.log(`error with ${Fe.name} upper limit ${R}`),!1}return rt};if(Fe.low_up){const dt=ht(Fe.low_up);if(!dt)return!1;const rt=k.x,_t=.03*k.fsize,Yt=.25*k.fsize;let kt,Tt,fn=0,ln=0,mn=-k.fsize;dt.up&&(kt=We(.6),K(ge(),A,dt.up,kt)),dt.low&&(Tt=We(.6),K(ge(),A,dt.low,Tt)),kt&&(Tt||(mn=Math.min(mn,k.rect.last_y1)),Xe(kt,rt+_t,mn-kt.rect.y1-.1*k.fsize),fn=kt.rect.width),Tt&&(Xe(Tt,rt+_t,Yt-Tt.rect.y2+.1*k.fsize),ln=Tt.rect.width),ve(_t+Math.max(fn,ln));continue}if(Fe.special){const dt=ht()||{},rt=ct(),_t=tt(rt),Yt=Math.round(1.7*k.fsize),kt=Math.round(k.fsize),Tt=Math.round(.1*Yt);let fn,ln;if("#sum"===Fe.name?(fn=ln=kt/2,_t.attr("d",`M${kt},${Math.round(-.75*Yt)}h${-kt}l${Math.round(.4*kt)},${Math.round(.3*Yt)}l${Math.round(-.4*kt)},${Math.round(.7*Yt)}h${kt}`)):(fn=3*Tt,ln=Tt,_t.attr("d",`M0,${Math.round(.25*Yt-Tt)}a${Tt},${Tt},0,0,0,${2*Tt},0v${2*Tt-Yt}a${Tt},${Tt},0,1,1,${2*Tt},0`)),Se(k.x,k.y-.6*Yt,k.x+kt,k.y+.4*Yt),dt.low){const mn=We(.6);K(rt,A,dt.low,mn),Xe(mn,ln-mn.rect.width/2,.25*Yt-mn.rect.y1,!0)}if(dt.up){const mn=We(.6);K(rt,A,dt.up,mn),Xe(mn,fn-mn.rect.width/2,-.75*Yt-mn.rect.y2,!0)}ve(kt);continue}if(Fe.braces){const dt=Fe.right,_t=$(!1,dt?Fe.name:"{",dt),Yt=ct(),kt=We(),Tt=tt(Yt);K(Yt,A,_t,kt);const fn=tt(Yt),ln=Math.max(2,Math.round(.2*k.fsize)),mn=kt.rect,jt=Math.round(mn.y2-mn.y1),Sn=Math.round(mn.y1),cn=Math.round(mn.width);switch(Fe.braces){case"||":Tt.attr("d",`M${ln},${Sn}v${jt}`),fn.attr("d",`M${3*ln+cn},${Sn}v${jt}`);break;case"[]":Tt.attr("d",`M${2*ln},${Sn}h${-ln}v${jt}h${ln}`),fn.attr("d",`M${2*ln+cn},${Sn}h${ln}v${jt}h${-ln}`);break;case"{}":Tt.attr("d",`M${2*ln},${Sn}a${ln},${ln},0,0,0,${-ln},${ln}v${jt/2-2*ln}a${ln},${ln},0,0,1,${-ln},${ln}a${ln},${ln},0,0,1,${ln},${ln}v${jt/2-2*ln}a${ln},${ln},0,0,0,${ln},${ln}`),fn.attr("d",`M${2*ln+cn},${Sn}a${ln},${ln},0,0,1,${ln},${ln}v${jt/2-2*ln}a${ln},${ln},0,0,0,${ln},${ln}a${ln},${ln},0,0,0,${-ln},${ln}v${jt/2-2*ln}a${ln},${ln},0,0,1,${-ln},${ln}`);break;default:Tt.attr("d",`M${ln},${Sn}a${4*jt},${4*jt},0,0,0,0,${jt}`),fn.attr("d",`M${3*ln+cn},${Sn}a${4*jt},${4*jt},0,0,1,0,${jt}`)}Xe(kt,2*ln,0,!0),Se(k.x,k.y+mn.y1,k.x+4*ln+mn.width,k.y+mn.y2),ve(4*ln+mn.width);continue}if(Fe.deco){const dt=$(),rt=ct(),_t=We();_t.deco=Fe.deco,K(rt,A,dt,_t);const Yt=_t.rect;if(_t.deco){const kt=tt(rt),Tt=Math.round(Yt.width);switch(_t.deco){case"underline":kt.attr("d",`M0,${Math.round(Yt.y2)}h${Tt}`);break;case"overline":kt.attr("d",`M0,${Math.round(Yt.y1)}h${Tt}`);break;case"line-through":kt.attr("d",`M0,${Math.round(.45*Yt.y1+.55*Yt.y2)}h${Tt}`)}}Xe(_t,0,0,!0),ve(Yt.width);continue}if("#bf{"===Fe.name||"#it{"===Fe.name){const dt=$();if(-1===dt)return!1;const rt=We();"#bf{"===Fe.name?rt.bold=!rt.bold:rt.italic=!rt.italic,K(ge(),A,dt,rt),Xe(rt,k.x,k.y),ve(rt.rect.width);continue}let pt=0;if(Fe.arg){const dt=R.indexOf("]{");if(dt<0)return console.log("missing argument for ",Fe.name),!1;if(pt=R.slice(0,dt),"int"===Fe.arg){if(pt=parseInt(pt),!Number.isInteger(pt))return console.log("wrong int argument",R.slice(0,dt)),!1}else if("float"===Fe.arg&&(pt=parseFloat(pt),!Number.isFinite(pt)))return console.log("wrong float argument",R.slice(0,dt)),!1;R=R.slice(dt+2)}if("#kern["!==Fe.name&&"#lower["!==Fe.name)if("#color["!==Fe.name&&"#scale["!==Fe.name&&"#font["!==Fe.name){if(Fe.sqrt){const dt=$();if(-1===dt)return!1;const rt=ct(),_t=We();let Yt;Fe.arg&&(Yt=We(.7),K(rt,A,pt.toString(),Yt));const kt=tt(rt);K(rt,A,dt,_t);const Tt=_t.rect,fn=Math.round(Tt.height),ln=Math.round(.1*Tt.height),mn=Math.round(Tt.width),jt=Math.round((Tt.y1+Tt.y2)/2),Sn=Math.round(.2*k.fsize),cn=Math.round(Tt.y2);Yt&&Xe(Yt,0,jt-.3*Yt.fsize,!0),kt.attr("d",`M0,${jt}h${ln}l${ln},${cn-jt-Sn}l${ln},${-fn+Sn}h${Math.round(.2*fn+mn)}v${ln}`),Xe(_t,.4*fn,0,!0),Se(k.x,k.y+Tt.y1-.1*k.fsize,k.x+mn+.6*fn,k.y+Tt.y2),ve(mn+.6*fn)}}else{const dt=$();if(-1===dt)return!1;const rt=We();"#color["===Fe.name?rt.color=k.painter.getColor(pt):"#font["===Fe.name?(rt.font=new Le.qg(pt),rt.ufont=!0):rt.fsize*=pt,K(ge(),A,dt,rt),Xe(rt,k.x,k.y),ve(rt.rect.width)}else{const dt=$();if(-1===dt)return!1;const rt=We();K(ge(),A,dt,rt);let _t=0,Yt=0;"kern["===Fe.name?_t=pt:Yt=pt,Xe(rt,k.x+_t*rt.rect.width,k.y+Yt*rt.rect.height),ve(rt.rect.width*(_t>0?1+pt:1))}}return!0}function G(I,A,R){return K(A,R,R.text,{lvl:0,g:A,x:0,y:0,dx:0,dy:-.1,fsize:R.font_size,font:R.font,parent:null,painter:I})}let D;function x(){return P.apply(this,arguments)}function P(){return(P=(0,be.A)(function*(){const I=void 0!==D;if(!I&&typeof globalThis.MathJax<"u")return globalThis.MathJax;I||(D=[]);const A=new Promise(ee=>{D?D.push(ee):ee(globalThis.MathJax)});if(I)return A;const R={scale:1,minScale:.5,mtextInheritFont:!1,merrorInheritFont:!0,mathmlSpacing:!1,skipAttributes:{},exFactor:.5,displayAlign:"center",displayIndent:"0",fontCache:"local",localID:null,internalSpeechTitles:!0,titleID:0};if(!(0,v.isNodeJs)()){window.MathJax={options:{enableMenu:!1},loader:{load:["[tex]/color","[tex]/upgreek","[tex]/mathtools","[tex]/physics"]},tex:{packages:{"[+]":["color","upgreek","mathtools","physics"]}},svg:R,startup:{ready(){MathJax.startup.defaultReady();const ge=D;D=void 0,ge.forEach(ve=>ve(globalThis.MathJax))}}};let ee="../mathjax/3.2.0";return v.browser.webwindow&&v.source_dir.indexOf("https://root.cern/js")<0&&v.source_dir.indexOf("https://jsroot.gsi.de")<0&&(ee="mathjax"),(0,v.loadScript)(v.source_dir+ee+"/es5/tex-svg.js").catch(()=>(0,v.loadScript)("https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-svg.js")).then(()=>A)}let k;return(0,V.lf)().then(ee=>(k=ee.JSDOM,Te.e(598).then(Te.t.bind(Te,3598,19)))).then(ee=>(ee.init({loader:{load:["input/tex","output/svg","[tex]/color","[tex]/upgreek","[tex]/mathtools","[tex]/physics"]},tex:{packages:{"[+]":["color","upgreek","mathtools","physics"]}},svg:R,config:{JSDOM:k},startup:{typeset:!1,ready(){const ge=MathJax;ge.startup.registerConstructor("jsdomAdaptor",()=>new ge._.adaptors.HTMLAdaptor.HTMLAdaptor((new ge.config.config.JSDOM).window)),ge.startup.useAdaptor("jsdomAdaptor",!0),ge.startup.defaultReady();const ve=D;D=void 0,ve.forEach(Se=>Se(ge))}}}),A))})).apply(this,arguments)}const w={"#LT":"\\langle","#GT":"\\rangle","#club":"\\clubsuit","#spade":"\\spadesuit","#heart":"\\heartsuit","#diamond":"\\diamondsuit","#voidn":"\\wp","#voidb":"f","#copyright":"(c)","#ocopyright":"(c)","#trademark":"TM","#void3":"TM","#oright":"R","#void1":"R","#3dots":"\\ldots","#lbar":"\\mid","#void8":"\\mid","#divide":"\\div","#Jgothic":"\\Im","#Rgothic":"\\Re","#doublequote":'"',"#plus":"+","#minus":"-","#/":"/","#upoint":".","#aa":"\\mathring{a}","#AA":"\\mathring{A}","#omicron":"o","#Alpha":"A","#Beta":"B","#Epsilon":"E","#Zeta":"Z","#Eta":"H","#Iota":"I","#Kappa":"K","#Mu":"M","#Nu":"N","#Omicron":"O","#Rho":"P","#Tau":"T","#Chi":"X","#varomega":"\\varpi","#corner":"?","#ltbar":"?","#bottombar":"?","#notsubset":"?","#arcbottom":"?","#cbar":"?","#arctop":"?","#topbar":"?","#arcbar":"?","#downleftarrow":"?","#splitline":"\\genfrac{}{}{0pt}{}","#it":"\\textit","#bf":"\\textbf","#frac":"\\frac","#left{":"\\lbrace","#right}":"\\rbrace","#left\\[":"\\lbrack","#right\\]":"\\rbrack","#\\[\\]{":"\\lbrack"," } ":"\\rbrack","#\\[":"\\lbrack","#\\]":"\\rbrack","#{":"\\lbrace","#}":"\\rbrace"," ":"\\;"},b={upDelta:"Updelta",upGamma:"Upgamma",upLambda:"Uplambda",upOmega:"Upomega",upPhi:"Upphi",upPi:"Uppi",upPsi:"Uppsi",upSigma:"Upsigma",upTheta:"Uptheta",upUpsilon:"Upupsilon",upXi:"Upxi",notcong:"ncong",notgeq:"ngeq",notgr:"ngtr",notless:"nless",notleq:"nleq",notsucc:"nsucc",notprec:"nprec",notsubseteq:"nsubseteq",notsupseteq:"nsupseteq",openclubsuit:"clubsuit",openspadesuit:"spadesuit",dasharrow:"dashrightarrow",comp:"circ",iiintop:"iiint",iintop:"iint",ointop:"oint"},g={Digamma:988,upDigamma:988,digamma:989,updigamma:989,Koppa:990,koppa:991,upkoppa:991,upKoppa:990,VarKoppa:984,upVarKoppa:984,varkoppa:985,upvarkoppa:985,varkappa:954,upvarkappa:954,varbeta:976,upvarbeta:976,Sampi:992,upSampi:992,sampi:993,upsampi:993,Stigma:986,upStigma:986,stigma:987,upstigma:987,San:1018,upSan:1018,san:1019,upsan:1019,Sho:1015,upSho:1015,sho:1016,upsho:1016,P:182,aa:176,bulletdashcirc:8887,circdashbullet:8886,downuparrows:8693,updownarrows:8645,dashdownarrow:8675,dashuparrow:8673,complement:8705,dbar:396,ddddot:8943,dddot:8943,ddots:8945,defineequal:8797,defineeq:8797,downdownharpoons:10597,downupharpoons:10607,updownharpoons:10606,upupharpoons:10595,hateq:8793,ldbrack:10214,rdbrack:10215,leadsfrom:8604,leftsquigarrow:8668,lightning:9735,napprox:8777,nasymp:8813,nequiv:8802,nsimeq:8772,nsubseteq:8840,nsubset:8836,notapprox:8777,notasymp:8813,notequiv:8802,notni:8716,notsimeq:8772,notsubseteq:8840,notsubset:8836,notsupseteq:8841,notsupset:8837,nsupset:8837,setdif:8726,simarrow:10610,t:8256,u:711,v:711,undercurvearrowright:10555,updbar:396,wwbar:8213,awointop:8754,awoint:8755,barintop:10780,barint:10779,cwintop:8753,cwint:8753,cwointop:8755,cwoint:8754,oiiintop:8752,oiiint:8752,oiintop:8751,oiint:8751,slashintop:10767,slashint:10767},C=['"',"'","`","=","~"];function H(I,A,R,k,ee,ge){let ve=parseInt(R.attr("width")),Se=parseInt(R.attr("height"));if(Number.isInteger(Se)&&Number.isInteger(ve))ge>0&&(ve/=ge,Se/=ge,R.attr("width",Math.round(ve)).attr("height",Math.round(Se)));else{const tt=(0,V.xh)(A,"bbox");ve=tt.width||ve||100,Se=tt.height||Se||10}ge>0&&k.valign&&(k.valign=k.valign/ge),null===k.valign&&(k.valign=(ee-Se)/2);const De={x:1,y:1};let Xe="x",ct="y";180===k.rotate?De.x=De.y=-1:(270===k.rotate||90===k.rotate)&&(De.x=270===k.rotate?-1:1,De.y=-De.x,Xe="y",ct="x"),"middle"===k.align[0]?k[Xe]+=De.x*(k.width-ve)/2:"end"===k.align[0]&&(k[Xe]+=De.x*(k.width-ve)),"middle"===k.align[1]?k[ct]+=De.y*(k.height-Se)/2:"bottom"===k.align[1]?k[ct]+=De.y*(k.height-Se):"bottom-base"===k.align[1]&&(k[ct]+=De.y*(k.height-Se-k.valign));let $=(0,V.bk)(k.x,k.y)||"";k.rotate&&($&&($+=" "),$+=`rotate(${k.rotate})`),A.attr("transform",$||null).attr("visibility",null)}function X(I,A,R){return ie.apply(this,arguments)}function ie(){return(ie=(0,be.A)(function*(I,A,R){const k=function N(I,A,R,k){if(2!==A){for(const ve in w)I=I.replace(new RegExp(ve,"g"),w[ve]);for(const ve in xe)ve.length>2&&(I=I.replace(new RegExp(ve,"g"),"\\"+ve.slice(1)));let ee="",ge=!0;for(;I;){let ve=I.indexOf("#color[");if(ve<0&&ge){ee=I;break}if(ge=!1,0!==ve&&(ee+=ve<0?I:I.slice(0,ve),ve<0))break;if(ve=(I=I.slice(ve+7)).indexOf("]{"),ve<=0)break;const Se=parseInt(I.slice(0,ve));if(!Number.isInteger(Se))break;const De=k.getColor(Se);let Xe=1;for(I=I.slice(ve+2),ve=-1;Xe&&++ve<I.length;)"{"===I[ve]?Xe++:"}"===I[ve]&&Xe--;if(0!==Xe)break;const ct=I.slice(0,ve);I=I.slice(ve+1),ct&&(ee+=`\\color{${De}}{${ct}}`)}I=ee}else{"\\^"===I&&(I="\\unicode{0x5E}"),"\\vec"===I&&(I="\\unicode{0x2192}"),I=I.replace(/\\\./g,"\\unicode{0x2E}").replace(/\\\^/g,"\\hat");for(const ee in g)I=I.replace(new RegExp(`\\\\\\b${ee}\\b`,"g"),`\\unicode{0x${g[ee].toString(16)}}`);C.forEach(ee=>{I=I.replace(new RegExp(`(\\\\${ee})`,"g"),`\\unicode{0x${ee.charCodeAt(0).toString(16)}}`)});for(const ee in b)I=I.replace(new RegExp(`\\\\\\b${ee}\\b`,"g"),`\\${b[ee]}`)}return(0,v.isStr)(R)?`\\color{${R}}{${I}}`:I}(R.text,R.latex,R.color,I),ee={em:R.font.size,ex:R.font.size/2,family:R.font.name,scale:1,containerWidth:-1,lineWidth:1e5};return x().then(ge=>ge.tex2svgPromise(k,ee)).then(ge=>{const ve=ge.querySelector("svg");return A.append(()=>ve),function O(I,A,R,k){const ee=De=>{if(!De||!(0,v.isStr)(De)||De.length<3)return null;const Xe=De.indexOf("ex");return Xe<0||Xe!==De.length-2?null:(De=parseFloat(De.slice(0,Xe)),Number.isFinite(De)?De*k.font.size*.5:null)};let ge=ee(R.getAttribute("width")),ve=ee(R.getAttribute("height")),Se=R.getAttribute("style");if(Se&&Se.length>18&&0===Se.indexOf("vertical-align:")){const De=Se.indexOf("ex;");Se=De>0&&De===Se.length-3?ee(Se.slice(16,Se.length-1)):null}else Se=null;if(ge=!ge||ge<=.5?1:Math.round(ge),ve=!ve||ve<=.5?1:Math.round(ve),R.setAttribute("width",ge),R.setAttribute("height",ve),R.removeAttribute("style"),!(0,v.isNodeJs)()){const De=(0,V.xh)(A,"bbox");ge=1.05*De.width,ve=1.05*De.height}k.valign=Se,k.scale&&I.scaleTextDrawing(Math.max(ge/k.width,ve/k.height),k.draw_g)}(I,A,ve,R),R.applyAttributesToMathJax=H,!0})})).apply(this,arguments)}function z(I){return m.apply(this,arguments)}function m(){return(m=(0,be.A)(function*(I){return x().then(A=>A.typesetPromise(I?[I]:void 0))})).apply(this,arguments)}},1085:(Gr,xt,Te)=>{"use strict";Te.r(xt),Te.d(xt,{Beta:()=>Cn,BetaDist:()=>Sr,BetaDistI:()=>ms,BetaIncomplete:()=>ve,BreitWigner:()=>gn,Chebyshev0:()=>dn,Chebyshev1:()=>vn,Chebyshev10:()=>Y,Chebyshev2:()=>Fn,Chebyshev3:()=>ai,Chebyshev4:()=>$n,Chebyshev5:()=>kn,Chebyshev6:()=>Rn,Chebyshev7:()=>ei,Chebyshev8:()=>Yi,Chebyshev9:()=>Ue,ChebyshevN:()=>Zt,FDist:()=>ln,FDistI:()=>jt,Gamma:()=>G,GammaDist:()=>Ln,Gaus:()=>cn,InvPi:()=>An,Landau:()=>N,LaplaceDist:()=>Zn,LaplaceDistI:()=>ui,LogNormal:()=>Mr,Pi:()=>qt,PiOver2:()=>Jt,PiOver4:()=>tn,Polynomial1eval:()=>Re,Polynomialeval:()=>ot,Prob:()=>Sn,Sq:()=>lt,Student:()=>hi,StudentI:()=>qi,TwoPi:()=>at,beta:()=>z,beta_cdf_c:()=>De,beta_pdf:()=>ie,beta_quantile:()=>Se,breitwigner_cdf:()=>We,breitwigner_cdf_c:()=>tt,cauchy_cdf:()=>Fe,cauchy_cdf_c:()=>Ne,cauchy_pdf:()=>ht,chisquared_cdf:()=>Xe,chisquared_cdf_c:()=>m,chisquared_pdf:()=>fn,crystalball_cdf:()=>Nt,crystalball_cdf_c:()=>Qt,crystalball_function:()=>gt,crystalball_pdf:()=>Et,erf:()=>he,erfc:()=>L,expo:()=>me,exponential_cdf:()=>Tt,exponential_cdf_c:()=>kt,fdistribution_cdf:()=>jt,fdistribution_cdf_c:()=>mn,fdistribution_pdf:()=>ln,gamma:()=>G,gamma_pdf:()=>dt,gamma_quantile:()=>$,gamma_quantile_c:()=>ct,gaus:()=>fs,gausn:()=>wt,gaussian_cdf:()=>pe,gaussian_cdf_c:()=>de,gaussian_pdf:()=>pt,gausxy:()=>W,getTEfficiencyBoundaryFunc:()=>it,igam:()=>b,igamc:()=>w,igami:()=>g,inc_beta:()=>ge,inc_gamma:()=>H,inc_gamma_c:()=>O,incbet:()=>k,incbi:()=>ee,landau:()=>_e,landau_pdf:()=>C,landaun:()=>Be,lgam:()=>Qe,lgamma:()=>X,lognormal_cdf:()=>fe,lognormal_cdf_c:()=>re,lognormal_pdf:()=>ce,ndtri:()=>D,normal_cdf:()=>pe,normal_cdf_c:()=>de,normal_pdf:()=>K,normal_quantile:()=>x,normal_quantile_c:()=>P,pseries:()=>R,stirf:()=>Ie,tdistribution_cdf:()=>_t,tdistribution_cdf_c:()=>rt,tdistribution_pdf:()=>Yt,tgamma:()=>G});const be=11102230246251565e-32,v=-708.3964185322641,V=709.782712893384,Le=108.11685576785767,xe=4503599627370496,Je=2220446049250313e-31,st=1.4142135623730951,Ke=3.141592653589793;function ot(ze,$e,ut){if(!ut)return $e[0];let bt=$e[0];for(let Ot=1;Ot<=ut;++Ot)bt=bt*ze+$e[Ot];return bt}function Re(ze,$e,ut){if(!ut)return $e[0];let bt=ze+$e[0];for(let Ot=1;Ot<ut;++Ot)bt=bt*ze+$e[Ot];return bt}function Qe(ze){let $e,ut,bt,Ot,_n;const In=[-1378.2515256912086,-38801.631513463784,-331612.9927388712,-1162370.974927623,-1721737.0082083966,-853555.6642457654],Xn=[-351.81570143652345,-17064.210665188115,-220528.59055385445,-1139334.4436798252,-2532523.0717758294,-2018891.4143353277];if(ze>=Number.MAX_VALUE||ze==Number.POSITIVE_INFINITY)return Number.POSITIVE_INFINITY;if(ze<-34)return ut=-ze,Ot=Qe(ut),$e=Math.floor(ut),$e===ut||(_n=ut-$e,_n>.5&&($e+=1,_n=$e-ut),_n=ut*Math.sin(Math.PI*_n),_n<1e-300)?Number.POSITIVE_INFINITY:(_n=Math.log(Math.PI)-Math.log(_n)-Ot,_n);if(ze<13){for(_n=1,$e=0,bt=ze;bt>=3;)$e-=1,bt=ze+$e,_n*=bt;for(;bt<2;){if(bt<1e-300)return Number.POSITIVE_INFINITY;_n/=bt,$e+=1,bt=ze+$e}return _n<0&&(_n=-_n),2===bt?Math.log(_n):($e-=2,$e=(ze+=$e)*ot(ze,In,5)/Re(ze,Xn,6),Math.log(_n)+$e)}return ze>2556348e299?Number.POSITIVE_INFINITY:(ut=(ze-.5)*Math.log(ze)-ze+.9189385332046728,ze>1e8||($e=1/(ze*ze),ut+=ze>=1e3?((.0007936507936507937*$e-.002777777777777778)*$e+.08333333333333333)/ze:ot($e,[.0008116141674705085,-.0005950619042843014,.0007936503404577169,-.002777777777300997,.08333333333333319],4)/ze),ut)}function Ie(ze){let $e,ut,bt;const _n=Math.sqrt(2*Math.PI);return ut=1/ze,ut=1+ut*ot(ut,[.0007873113957930937,-.00022954996161337813,-.0026813261780578124,.0034722222160545866,.08333333333334822],4),$e=Math.exp(ze),ze>Le?(bt=Math.pow(ze,.5*ze-.25),$e=bt*(bt/$e)):$e=Math.pow(ze,ze-.5)/$e,$e=_n*$e*ut,$e}function L(ze){let _n,en,rn,Tn,In;return rn=ze<0?-ze:ze,rn<1?1-he(ze):(In=-ze*ze,In<-V||(In=Math.exp(In),rn<8?(_n=ot(rn,[2.461969814735305e-10,.5641895648310689,7.463210564422699,48.63719709856814,196.5208329560771,526.4451949954773,934.5285271719576,1027.5518868951572,557.5353353693994],8),en=Re(rn,[13.228195115474499,86.70721408859897,354.9377788878199,975.7085017432055,1823.9091668790973,2246.3376081871097,1656.6630919416134,557.5353408177277],8)):(_n=ot(rn,[.5641895835477551,1.275366707599781,5.019050422511805,6.160210979930536,7.4097426995044895,2.9788666537210022],5),en=Re(rn,[2.2605286322011726,9.396035249380015,12.048953980809666,17.08144507475659,9.608968090632859,3.369076451000815],6)),Tn=In*_n/en,ze<0&&(Tn=2-Tn),0==Tn)?ze<0?2:0:Tn)}function he(ze){if(Math.abs(ze)>1)return 1-L(ze);const bt=ze*ze;return ze*ot(bt,[9.604973739870516,90.02601972038427,2232.005345946843,7003.325141128051,55592.30130103949],4)/Re(bt,[33.56171416475031,521.3579497801527,4594.323829709801,22629.000061389095,49267.39426086359],5)}function re(ze,$e,ut,bt){void 0===bt&&(bt=0);const Ot=(Math.log(ze-bt)-$e)/(ut*st);return Ot>1?.5*L(Ot):.5*(1-he(Ot))}function fe(ze,$e,ut,bt=0){const Ot=(Math.log(ze-bt)-$e)/(ut*st);return Ot<-1?.5*L(-Ot):.5*(1+he(Ot))}function de(ze,$e,ut=0){const bt=(ze-ut)/($e*st);return bt>1?.5*L(bt):.5*(1-he(bt))}function pe(ze,$e,ut=0){const bt=(ze-ut)/($e*st);return bt<-1?.5*L(-bt):.5*(1+he(bt))}function ce(ze,$e,ut,bt=0){if(ze-bt<=0)return 0;const Ot=(Math.log(ze-bt)-$e)/ut;return 1/((ze-bt)*Math.abs(ut)*Math.sqrt(2*Ke))*Math.exp(-Ot*Ot/2)}function K(ze,$e=1,ut=0){const bt=(ze-ut)/$e;return 1/(Math.sqrt(2*Ke)*Math.abs($e))*Math.exp(-bt*bt/2)}function G(ze){let $e,ut,bt,Ot,_n=1;if(ze>=Number.MAX_VALUE)return ze;if(ut=Math.abs(ze),ut>33){if(ze<0){if($e=Math.floor(ut),$e==ut)return Number.POSITIVE_INFINITY;if(Ot=Math.round($e),1&Ot||(_n=-1),bt=ut-$e,bt>.5&&($e+=1,bt=ut-$e),bt=ut*Math.sin(Math.PI*bt),0==bt)return _n>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;bt=Math.abs(bt),bt=Math.PI/(bt*Ie(ut))}else bt=Ie(ze);return _n*bt}for(bt=1;ze>=3;)bt*=ze-=1;let en=!1;for(;ze<0&&!en;)ze>-1e-9?en=!0:(bt/=ze,ze+=1);for(;ze<2&&!en;)ze<1e-9?en=!0:(bt/=ze,ze+=1);return en?0==ze?Number.POSITIVE_INFINITY:bt/((1+.5772156649015329*ze)*ze):2==ze?bt:($e=ot(ze-=2,[.00016011952247675185,.0011913514700658638,.010421379756176158,.04763678004571372,.20744822764843598,.4942148268014971,1],6),ut=ot(ze,[-23158187332412014e-21,.0005396055804933034,-.004456419138517973,.011813978522206043,.035823639860549865,-.23459179571824335,.0714304917030273,1],7),bt*$e/ut)}function D(ze){if(ze<=0)return Number.NEGATIVE_INFINITY;if(ze>=1)return Number.POSITIVE_INFINITY;const Tn=.1353352832366127;let Ri,Wi,Ti,In=1,Xn=ze;if(Xn>1-Tn&&(Xn=1-Xn,In=0),Xn>Tn)return Xn-=.5,Wi=Xn*Xn,Ri=Xn+Xn*(Wi*ot(Wi,[-59.96335010141079,98.00107541859997,-56.67628574690703,13.931260938727968,-1.2391658386738125],4)/Re(Wi,[1.9544885833814176,4.676279128988815,86.36024213908905,-225.46268785411937,200.26021238006066,-82.03722561683334,15.90562251262117,-1.1833162112133],8)),Ri*=2.5066282746310007,Ri;Ri=Math.sqrt(-2*Math.log(Xn));const Tr=Ri-Math.log(Ri)/Ri,Qr=1/Ri;return Ti=Ri<8?Qr*ot(Qr,[4.0554489230596245,31.525109459989388,57.16281922464213,44.08050738932008,14.684956192885803,2.1866330685079025,-.1402560791713545,-.03504246268278482,-.0008574567851546854],8)/Re(Qr,[15.779988325646675,45.39076351288792,41.3172038254672,15.04253856929075,2.504649462083094,-.14218292285478779,-.03808064076915783,-.0009332594808954574],8):Qr*ot(Qr,[3.2377489177694603,6.915228890689842,3.9388102529247444,1.3330346081580755,.20148538954917908,.012371663481782003,.00030158155350823543,26580697468673755e-22,6.239745391849833e-9],8)/Re(Qr,[6.02427039364742,3.6798356385616087,1.3770209948908132,.21623699359449663,.013420400608854318,.00032801446468212774,28924786474538068e-22,6.790194080099813e-9],8),Ri=Tr-Ti,0!=In&&(Ri=-Ri),Ri}function x(ze,$e){return $e*D(ze)}function P(ze,$e){return-$e*D(ze)}function w(ze,$e){if(ze<=0)return 0;if($e<=0)return 1;if($e<1||$e<ze)return 1-b(ze,$e);let ut=ze*Math.log($e)-$e-Qe(ze);if(ut<-V)return 0;ut=Math.exp(ut);let Ri,Wi,Ti,Tr,Qr,bt=1-ze,Ot=$e+bt+1,_n=0,en=1,rn=$e,Tn=$e+1,In=Ot*$e,Xn=Tn/In;do{_n+=1,bt+=1,Ot+=2,Ri=bt*_n,Tr=Tn*Ot-en*Ri,Qr=In*Ot-rn*Ri,Qr?(Wi=Tr/Qr,Ti=Math.abs((Xn-Wi)/Wi),Xn=Wi):Ti=1,en=Tn,Tn=Tr,rn=In,In=Qr,Math.abs(Tr)>xe&&(en*=Je,Tn*=Je,rn*=Je,In*=Je)}while(Ti>be);return Xn*ut}function b(ze,$e){if(ze<=0)return 1;if($e<=0)return 0;if($e>1&&$e>ze)return 1-w(ze,$e);let ut=ze*Math.log($e)-$e-Qe(ze);if(ut<-V)return 0;ut=Math.exp(ut);let bt=ze,Ot=1,_n=1;do{bt+=1,Ot*=$e/bt,_n+=Ot}while(Ot/_n>be);return _n*ut/ze}function g(ze,$e){if(ze<=0)return console.error(`igami : Wrong domain for parameter a = ${ze} (must be > 0)`),0;if($e<=0)return Number.POSITIVE_INFINITY;if($e>=1)return 0;const ut=Number.MAX_VALUE,bt=5*be;let en,In,Xn,Ri,Wi,Ti,Ot=ut,_n=0,rn=0,Tn=1;for(Xn=1/(9*ze),In=1-Xn-D($e)*Math.sqrt(Xn),en=ze*In*In*In,Ri=Qe(ze),Wi=0;Wi<10&&!(en>Ot||en<_n||(In=w(ze,en),In<rn||In>Tn)||(In<$e?(Ot=en,rn=In):(_n=en,Tn=In),Xn=(ze-1)*Math.log(en)-en-Ri,Xn<-V));++Wi){if(Xn=-Math.exp(Xn),Xn=(In-$e)/Xn,Math.abs(Xn/en)<be)return en;en-=Xn}if(Xn=.0625,Ot==ut)for(en<=0&&(en=1);Ot==ut;){if(en*=1+Xn,In=w(ze,en),In<$e){Ot=en,rn=In;break}Xn+=Xn}for(Xn=.5,Ti=0,Wi=0;Wi<400&&(en=_n+Xn*(Ot-_n),In=w(ze,en),Ri=(Ot-_n)/(_n+Ot),!(Math.abs(Ri)<bt||(Ri=(In-$e)/$e,Math.abs(Ri)<bt)||en<=0));++Wi)In>=$e?(_n=en,Tn=In,Ti<0?(Ti=0,Xn=.5):Xn=Ti>1?.5*Xn+.5:($e-rn)/(Tn-rn),Ti+=1):(Ot=en,rn=In,Ti>0?(Ti=0,Xn=.5):Ti<-1?Xn*=.5:Xn=($e-rn)/(Tn-rn),Ti-=1);return en}function C(ze,$e,ut=0){if($e<=0)return 0;const bt=(ze-ut)/$e;let Ot,_n,en,rn;const Tn=[.4259894875,-.124976255,.039842437,-.006298287635,.001511162253],In=[1,-.3388260629,.09594393323,-.01608042283,.003778942063],Xn=[.1788541609,.1173957403,.01488850518,-.001394989411,.0001283617211],Ri=[1,.7428795082,.3153932961,.06694219548,.008790609714],Wi=[.1788544503,.09359161662,.006325387654,6611667319e-14,-2031049101e-15],Ti=[1,.6097809921,.2560616665,.04746722384,.006957301675],Tr=[.9874054407,118.6723273,849.279436,-743.7792444,427.0262186],Qr=[1,106.8615961,337.6496214,2016.712389,1597.063511],yo=[1.003675074,167.5702434,4789.711289,21217.86767,-22324.9491],Go=[1,156.9424537,3745.310488,9834.698876,66924.28357],_s=[1.000827619,664.9143136,62972.92665,475554.6998,-5743609.109],Ls=[1,651.4101098,56974.73333,165917.4725,-2815759.939],pn=[.04166666667,-.01996527778,.02709538966],Hn=[-1.84556867,-4.284640743];if(bt<-5.5){if(Ot=Math.exp(bt+1),Ot<1e-10)return 0;_n=Math.exp(-1/Ot),en=Math.sqrt(Ot),rn=_n/en*.3989422803*(1+(pn[0]+(pn[1]+pn[2]*Ot)*Ot)*Ot)}else bt<-1?(Ot=Math.exp(-bt-1),rn=Math.exp(-Ot)*Math.sqrt(Ot)*(Tn[0]+(Tn[1]+(Tn[2]+(Tn[3]+Tn[4]*bt)*bt)*bt)*bt)/(In[0]+(In[1]+(In[2]+(In[3]+In[4]*bt)*bt)*bt)*bt)):bt<1?rn=(Xn[0]+(Xn[1]+(Xn[2]+(Xn[3]+Xn[4]*bt)*bt)*bt)*bt)/(Ri[0]+(Ri[1]+(Ri[2]+(Ri[3]+Ri[4]*bt)*bt)*bt)*bt):bt<5?rn=(Wi[0]+(Wi[1]+(Wi[2]+(Wi[3]+Wi[4]*bt)*bt)*bt)*bt)/(Ti[0]+(Ti[1]+(Ti[2]+(Ti[3]+Ti[4]*bt)*bt)*bt)*bt):bt<12?(Ot=1/bt,rn=Ot*Ot*(Tr[0]+(Tr[1]+(Tr[2]+(Tr[3]+Tr[4]*Ot)*Ot)*Ot)*Ot)/(Qr[0]+(Qr[1]+(Qr[2]+(Qr[3]+Qr[4]*Ot)*Ot)*Ot)*Ot)):bt<50?(Ot=1/bt,rn=Ot*Ot*(yo[0]+(yo[1]+(yo[2]+(yo[3]+yo[4]*Ot)*Ot)*Ot)*Ot)/(Go[0]+(Go[1]+(Go[2]+(Go[3]+Go[4]*Ot)*Ot)*Ot)*Ot)):bt<300?(Ot=1/bt,rn=Ot*Ot*(_s[0]+(_s[1]+(_s[2]+(_s[3]+_s[4]*Ot)*Ot)*Ot)*Ot)/(Ls[0]+(Ls[1]+(Ls[2]+(Ls[3]+Ls[4]*Ot)*Ot)*Ot)*Ot)):(Ot=1/(bt-bt*Math.log(bt)/(bt+1)),rn=Ot*Ot*(1+(Hn[0]+Hn[1]*Ot)*Ot));return rn/$e}function N(ze,$e,ut,bt){if(ut<=0)return 0;const Ot=C((ze-$e)/ut,1,0);return bt?Ot/ut:Ot}function O(ze,$e){return w(ze,$e)}function H(ze,$e){return b(ze,$e)}function X(ze){return Qe(ze)}function ie(ze,$e,ut){if(ze<0||ze>1)return 0;if(0==ze){if($e<1)return Number.POSITIVE_INFINITY;if($e>1)return 0;if(1==$e)return ut}if(1==ze){if(ut<1)return Number.POSITIVE_INFINITY;if(ut>1)return 0;if(1==ut)return $e}return Math.exp(X($e+ut)-X($e)-X(ut)+Math.log(ze)*($e-1)+Math.log1p(-ze)*(ut-1))}function z(ze,$e){return Math.exp(X(ze)+X($e)-X(ze+$e))}function m(ze,$e,ut=0){return O(.5*$e,.5*(ze-ut))}function R(ze,$e,ut){let bt,Ot,_n,en,rn;const Tn=1/ze;_n=(1-$e)*ut,en=_n/(ze+1);const In=en;Ot=_n,rn=2,bt=0;const Xn=be*Tn;for(;Math.abs(en)>Xn;)_n=(rn-$e)*ut/rn,Ot*=_n,en=Ot/(ze+rn),bt+=en,rn+=1;return bt+=In,bt+=Tn,_n=ze*Math.log(ut),ze+$e<Le&&Math.abs(_n)<V?(Ot=G(ze+$e)/(G(ze)*G($e)),bt=bt*Ot*Math.pow(ut,ze)):(Ot=Qe(ze+$e)-Qe(ze)-Qe($e)+_n+Math.log(bt),bt=Ot<v?0:Math.exp(Ot)),bt}function k(ze,$e,ut){let bt,Ot,_n,en,rn,Tn,In,Xn;return ze<=0||$e<=0||ut<=0?0:ut>=1?1:(Xn=0,Tn=1-ut,ut>ze/(ze+$e)?(Xn=1,bt=$e,Ot=ze,rn=ut,en=Tn):(bt=ze,Ot=$e,rn=Tn,en=ut),1==Xn&&Ot*en<=1&&en<=.95?_n=R(bt,Ot,en):(In=en*(bt+Ot-2)-(bt-1),Tn=In<0?function I(ze,$e,ut){let bt,Ot,_n,en,rn,Tn,In,Xn,Ri,Wi,Ti,Tr,Qr,yo,Go,_s,Ls,pn,Hn;const Vt=3*be;Xn=ze,Ri=ze+$e,Wi=ze,Ti=ze+1,Tr=1,Qr=$e-1,yo=Ti,Go=ze+2,en=0,In=1,_n=1,Tn=1,pn=1,_s=1,Hn=0;do{if(bt=-ut*Xn*Ri/(Wi*Ti),Ot=_n+en*bt,rn=Tn+In*bt,en=_n,_n=Ot,In=Tn,Tn=rn,bt=ut*Tr*Qr/(yo*Go),Ot=_n+en*bt,rn=Tn+In*bt,en=_n,_n=Ot,In=Tn,Tn=rn,0!=rn&&(_s=Ot/rn),0!=_s?(Ls=Math.abs((pn-_s)/_s),pn=_s):Ls=1,Ls<Vt)break;Xn+=1,Ri+=1,Wi+=2,Ti+=2,Tr+=1,Qr-=1,yo+=2,Go+=2,Math.abs(rn)+Math.abs(Ot)>xe&&(en*=Je,_n*=Je,In*=Je,Tn*=Je),(Math.abs(rn)<Je||Math.abs(Ot)<Je)&&(en*=xe,_n*=xe,In*=xe,Tn*=xe)}while(++Hn<300);return pn}(bt,Ot,en):function A(ze,$e,ut){const bt=ut/(1-ut),Ot=3*be;let _n,en,rn,Tn,In,Xn,Ri,Wi,Ti,Tr,Qr,yo,Go,_s,Ls,pn,Hn,Vt,Gi;Wi=ze,Ti=$e-1,Tr=ze,Qr=ze+1,yo=1,Go=ze+$e,_s=ze+1,Ls=ze+2,Tn=0,Ri=1,rn=1,Xn=1,Vt=1,pn=1,Gi=0;do{if(_n=-bt*Wi*Ti/(Tr*Qr),en=rn+Tn*_n,In=Xn+Ri*_n,Tn=rn,rn=en,Ri=Xn,Xn=In,_n=bt*yo*Go/(_s*Ls),en=rn+Tn*_n,In=Xn+Ri*_n,Tn=rn,rn=en,Ri=Xn,Xn=In,0!=In&&(pn=en/In),0!=pn?(Hn=Math.abs((Vt-pn)/pn),Vt=pn):Hn=1,Hn<Ot)break;Wi+=1,Ti-=1,Tr+=2,Qr+=2,yo+=1,Go+=1,_s+=2,Ls+=2,Math.abs(In)+Math.abs(en)>xe&&(Tn*=Je,rn*=Je,Ri*=Je,Xn*=Je),(Math.abs(In)<Je||Math.abs(en)<Je)&&(Tn*=xe,rn*=xe,Ri*=xe,Xn*=xe)}while(++Gi<300);return Vt}(bt,Ot,en)/rn,In=bt*Math.log(en),_n=Ot*Math.log(rn),bt+Ot<Le&&Math.abs(In)<V&&Math.abs(_n)<V?(_n=Math.pow(rn,Ot),_n*=Math.pow(en,bt),_n/=bt,_n*=Tn,_n*=G(bt+Ot)/(G(bt)*G(Ot))):(In+=_n+Qe(bt+Ot)-Qe(bt)-Qe(Ot),In+=Math.log(Tn/bt),_n=In<v?0:Math.exp(In))),1==Xn&&(_n=_n<=be?1-be:1-_n),_n)}function ee(ze,$e,ut){let bt,Ot,_n,en,rn,Tn,In,Xn,Ri,Wi,Ti,Tr,Qr,yo,Go,_s,Ls,pn,Hn,Vt=!0;if(ze<=0||$e<=0)return 0;const Gi=()=>(Ls&&(Tn=Tn<=be?1-be:1-Tn),Tn);if(_s=0,ut<=0)return 0;if(ut>=1)return 1;if(In=0,Qr=0,Xn=1,yo=1,Hn=0,ze<=1||$e<=1)Tr=1e-6,Ls=0,bt=ze,Ot=$e,_n=ut,Tn=bt/(bt+Ot),rn=k(bt,Ot,Tn);else{if(Tr=1e-4,Wi=-D(ut),ut>.5?(Ls=1,bt=$e,Ot=ze,_n=1-ut,Wi=-Wi):(Ls=0,bt=ze,Ot=$e,_n=ut),Ri=(Wi*Wi-3)/6,Tn=2/(1/(2*bt-1)+1/(2*Ot-1)),en=Wi*Math.sqrt(Tn+Ri)/Tn-(1/(2*Ot-1)-1/(2*bt-1))*(Ri+5/6-2/(3*Tn)),en*=2,en<v)return Tn=0,Gi();Tn=bt/(bt+Ot*Math.exp(en)),rn=k(bt,Ot,Tn),Wi=(rn-_n)/_n,Math.abs(Wi)<.2&&(Vt=!1)}let Nn=1e3;for(;Nn-- >0;){if(Vt){for(pn=0,Ti=.5,_s=0;_s<100;_s++){if(0!=_s){if(Tn=In+Ti*(Xn-In),1==Tn&&(Tn=1-be),0==Tn&&(Ti=.5,Tn=In+Ti*(Xn-In),0==Tn))return Gi();if(rn=k(bt,Ot,Tn),Wi=(Xn-In)/(Xn+In),Math.abs(Wi)<Tr||(Wi=(rn-_n)/_n,Math.abs(Wi)<Tr))break}if(rn<_n){if(In=Tn,Qr=rn,pn<0?(pn=0,Ti=.5):Ti=pn>3?1-(1-Ti)*(1-Ti):pn>1?.5*Ti+.5:(_n-rn)/(yo-Qr),pn+=1,In>.75){1==Ls?(Ls=0,bt=ze,Ot=$e,_n=ut):(Ls=1,bt=$e,Ot=ze,_n=1-ut),Tn=1-Tn,rn=k(bt,Ot,Tn),In=0,Qr=0,Xn=1,yo=1;continue}}else{if(Xn=Tn,1==Ls&&Xn<be)return Tn=0,Gi();yo=rn,pn>0?(pn=0,Ti=.5):pn<-3?Ti*=Ti:pn<-1?Ti*=.5:Ti=(rn-_n)/(yo-Qr),pn-=1}}if(In>=1)return Tn=1-be,Gi();if(Tn<=0)return Tn=0,Gi();break}if(Vt=!0,Hn)return Gi();for(Hn=1,Ri=Qe(bt+Ot)-Qe(bt)-Qe(Ot),_s=0;_s<8&&(0!=_s&&(rn=k(bt,Ot,Tn)),rn<Qr?(Tn=In,rn=Qr):rn>yo?(Tn=Xn,rn=yo):rn<_n?(In=Tn,Qr=rn):(Xn=Tn,yo=rn),1!=Tn&&0!=Tn);_s++){if(en=(bt-1)*Math.log(Tn)+(Ot-1)*Math.log(1-Tn)+Ri,en<v)return Gi();if(en>V||(en=Math.exp(en),en=(rn-_n)/en,Go=Tn-en,Go<=In&&(rn=(Tn-In)/(Xn-In),Go=In+.5*rn*(Tn-In),Go<=0))||Go>=Xn&&(rn=(Xn-Tn)/(Xn-In),Go=Xn-.5*rn*(Xn-Tn),Go>=1))break;if(Tn=Go,Math.abs(en/Tn)<128*be)return Gi()}Tr=256*be}return Gi()}function ge(ze,$e,ut){return k($e,ut,ze)}const ve=ge;function Se(ze,$e,ut){return ee($e,ut,ze)}function De(ze,$e,ut){return ge(1-ze,ut,$e)}function Xe(ze,$e,ut=0){return H(.5*$e,.5*(ze-ut))}function ct(ze,$e,ut){return ut*g($e,ze)}function $(ze,$e,ut){return ut*g($e,1-ze)}function tt(ze,$e,ut=0){return.5-Math.atan(2*(ze-ut)/$e)/Ke}function We(ze,$e,ut=0){return.5+Math.atan(2*(ze-ut)/$e)/Ke}function Ne(ze,$e,ut=0){return.5-Math.atan((ze-ut)/$e)/Ke}function Fe(ze,$e,ut=0){return.5+Math.atan((ze-ut)/$e)/Ke}function ht(ze,$e=1,ut=0){return $e/(Ke*((ze-ut)*(ze-ut)+$e*$e))}function pt(ze,$e=1,ut=0){const bt=(ze-ut)/$e;return 1/(Math.sqrt(2*Ke)*Math.abs($e))*Math.exp(-bt*bt/2)}function dt(ze,$e,ut,bt=0){return ze-bt<0?0:ze-bt==0?1==$e?1/ut:0:1==$e?Math.exp(-(ze-bt)/ut)/ut:Math.exp(($e-1)*Math.log((ze-bt)/ut)-(ze-bt)/ut-X($e))/ut}function rt(ze,$e,ut=0){const bt=ze-ut,Ot=bt>0?1:-1;return.5-.5*ge(bt*bt/($e+bt*bt),.5,.5*$e)*Ot}function _t(ze,$e,ut=0){const bt=ze-ut,Ot=bt>0?1:-1;return.5+.5*ge(bt*bt/($e+bt*bt),.5,.5*$e)*Ot}function Yt(ze,$e,ut=0){return Math.exp(X(($e+1)/2)-X($e/2))/Math.sqrt(Ke*$e)*Math.pow(1+(ze-ut)*(ze-ut)/$e,-($e+1)/2)}function kt(ze,$e,ut=0){return ze-ut<0?1:Math.exp(-$e*(ze-ut))}function Tt(ze,$e,ut=0){return ze-ut<0?0:-Math.expm1(-$e*(ze-ut))}function fn(ze,$e,ut=0){return ze-ut<0?0:ze==ut&&0==$e/2-1?.5:Math.exp(($e/2-1)*Math.log((ze-ut)/2)-(ze-ut)/2-X($e/2))/2}function ln(ze,$e,ut,bt=0){return $e<0||ut<0?Number.NaN:ze-bt<0?0:Math.exp($e/2*Math.log($e)+ut/2*Math.log(ut)+X(($e+ut)/2)-X($e/2)-X(ut/2)+($e/2-1)*Math.log(ze-bt)-($e+ut)/2*Math.log(ut+$e*(ze-bt)))}function mn(ze,$e,ut,bt=0){return $e<0||ut<0?Number.NaN:ut/(ut+$e*(ze-bt))>.9&&$e>1&&ut>1?1-jt(ze,$e,ut,bt):ge(ut/(ut+$e*(ze-bt)),.5*ut,.5*$e)}function jt(ze,$e,ut,bt=0){if($e<0||ut<0)return Number.NaN;const Ot=$e*(ze-bt)/(ut+$e*(ze-bt));return Ot>.9&&$e>1&&ut>1?1-mn(ze,$e,ut,bt):ge(Ot,.5*$e,.5*ut)}function Sn(ze,$e){return $e<=0?0:ze<=0?ze<0?0:1:m(ze,$e,0)}function cn(ze,$e,ut,bt){if(!ut)return 1e30;const Ot=(ze-$e)/ut;if(Ot<-39||Ot>39)return 0;const _n=Math.exp(-.5*Ot*Ot);return bt?_n/(2.5066282746310002*ut):_n}function gn(ze,$e,ut){return ut/((ze-$e)*(ze-$e)+ut*ut/4)/2/Math.PI}function Cn(ze,$e){return Math.exp(X(ze)+X($e)-X(ze+$e))}function Ln(ze,$e,ut=0,bt=1){return ze<ut||$e<=0||bt<=0?0:dt(ze,$e,bt,ut)}function Zn(ze,$e=0,ut=1){return Math.exp(-Math.abs((ze-$e)/ut))/(2*ut)}function ui(ze,$e=0,ut=1){return ze<=$e?.5*Math.exp(-Math.abs((ze-$e)/ut)):1-.5*Math.exp(-Math.abs((ze-$e)/ut))}function hi(ze,$e){if($e<1)return 0;const ut=$e,bt=.5*ut,Ot=bt+.5,_n=Math.sqrt(ut*Math.PI)*G(bt)*Math.pow(1+ze*ze/ut,Ot);return G(Ot)/_n}function qi(ze,$e){const ut=$e;return ze>0?1-.5*ve(ut/(ut+ze*ze),.5*ut,.5):.5*ve(ut/(ut+ze*ze),.5*ut,.5)}function Mr(ze,$e,ut=0,bt=1){return ze<ut||$e<=0||bt<=0?0:ce(ze,Math.log(bt),$e,ut)}function Sr(ze,$e,ut){if(ze<0||ze>1||$e<=0||ut<=0)return 0;const bt=Cn($e,ut);return Math.pow(ze,$e-1)*Math.pow(1-ze,ut-1)/bt}function ms(ze,$e,ut){return ze<0||ze>1||$e<=0||ut<=0?0:ve(ze,$e,ut)}function fs(ze,$e,ut){return ze.GetParValue(ut+0)*Math.exp(-.5*Math.pow(($e-ze.GetParValue(ut+1))/ze.GetParValue(ut+2),2))}function wt(ze,$e,ut){return fs(ze,$e,ut)/(Math.sqrt(2*Math.PI)*ze.GetParValue(ut+2))}function W(ze,$e,ut,bt){return ze.GetParValue(bt+0)*Math.exp(-.5*Math.pow(($e-ze.GetParValue(bt+1))/ze.GetParValue(bt+2),2))*Math.exp(-.5*Math.pow((ut-ze.GetParValue(bt+3))/ze.GetParValue(bt+4),2))}function me(ze,$e,ut){return Math.exp(ze.GetParValue(ut+0)+ze.GetParValue(ut+1)*$e)}function _e(ze,$e,ut){return N($e,ze.GetParValue(ut+1),ze.GetParValue(ut+2),!1)}function Be(ze,$e,ut){return N($e,ze.GetParValue(ut+1),ze.GetParValue(ut+2),!0)}function gt(ze,$e,ut,bt,Ot=0){if(bt<0)return 0;let _n=(ze-Ot)/bt;$e<0&&(_n=-_n);const en=Math.abs($e);if(_n>-en)return Math.exp(-.5*_n*_n);const rn=ut/en;return Math.exp(-.5*en*en)*Math.pow(rn/(rn-en-_n),ut)}function Et(ze,$e,ut,bt,Ot=0){if(bt<0)return 0;if(ut<=1)return Number.NaN;const _n=Math.abs($e);return 1/(bt*(ut/_n*1/(ut-1)*Math.exp(-$e*$e/2)+Math.sqrt(Ke/2)*(1+he(_n/Math.sqrt(2)))))*gt(ze,$e,ut,bt,Ot)}function Mt(ze,$e,ut,bt,Ot=0){if(0==bt||0==$e)return 0;const _n=1==ut,en=Math.abs($e);let rn=(ze-Ot)/bt,Tn=0,In=0;$e<0&&(rn=-rn);const Xn=Math.sqrt(Ke/2),Ri=Math.sqrt(2*Ke),Wi=1/Math.sqrt(2);if(rn<=-en){const Ti=Math.pow(ut/en,ut)*Math.exp(-.5*$e*$e),Tr=ut/en-en;In=_n?-Ti*Math.log(ut/en)+Ti*Math.log(Tr-rn):ut/en*(1/(ut-1))*Math.exp(-$e*$e/2)-Ti/(ut-1)*Math.pow(Tr-rn,1-ut),Tn=Xn*(1+he(en*Wi))}else Tn=de(rn,1),Tn*=Ri,In=0;return bt*(Tn+In)}function Nt(ze,$e,ut,bt,Ot=0){if(ut<=1)return Number.NaN;const _n=Math.abs($e),Tn=bt*(ut/_n*1/(ut-1)*Math.exp(-$e*$e/2)+Math.sqrt(Ke/2)*(1+he(_n/Math.sqrt(2)))),In=Mt(ze,$e,ut,bt,Ot);return $e>0?1-In/Tn:In/Tn}function Qt(ze,$e,ut,bt,Ot=0){if(ut<=1)return Number.NaN;const _n=Math.abs($e),Tn=bt*(ut/_n*1/(ut-1)*Math.exp(-$e*$e/2)+Math.sqrt(Ke/2)*(1+he(_n/Math.sqrt(2)))),In=Mt(ze,$e,ut,bt,Ot);return $e>0?In/Tn:1-In/Tn}function Zt(ze,$e,ut){let bt=0,Ot=0;const _n=2*$e;for(let en=ze;en>=1;en--){const rn=bt;bt=_n*bt-Ot+ut[en],Ot=rn}return $e*bt-Ot+ut[0]}function dn(ze,$e){return $e}function vn(ze,$e,ut){return $e+ut*ze}function Fn(ze,$e,ut,bt){return $e+ut*ze+bt*(2*ze*ze-1)}function ai(ze,...$e){return Zt(3,ze,$e)}function $n(ze,...$e){return Zt(4,ze,$e)}function kn(ze,...$e){return Zt(5,ze,$e)}function Rn(ze,...$e){return Zt(6,ze,$e)}function ei(ze,...$e){return Zt(7,ze,$e)}function Yi(ze,...$e){return Zt(8,ze,$e)}function Ue(ze,...$e){return Zt(9,ze,$e)}function Y(ze,...$e){return Zt(10,ze,$e)}function E(ze,$e,ut,bt){const Ot=(1-ut)/2;return bt?$e==ze?1:Se(1-Ot,$e+1,ze-$e):0==$e?0:Se(Ot,$e,ze-$e+1)}function J(ze,$e,ut,bt){if(0==ze)return bt?1:0;const _n=$e/ze,rn=x(1-(1-ut)/2,Math.sqrt(_n*(1-_n)/ze));return bt?_n+rn>1?1:_n+rn:_n-rn<0?0:_n-rn}function Ae(ze,$e,ut,bt){if(0==ze)return bt?1:0;const _n=$e/ze,en=x(1-(1-ut)/2,1),rn=($e+.5*en*en)/(ze+en*en),Tn=en/(ze+en*en)*Math.sqrt(ze*_n*(1-_n)+en*en/4);return bt?rn+Tn>1?1:rn+Tn:rn-Tn<0?0:rn-Tn}function Ce(ze,$e,ut,bt){const _n=x(1-(1-ut)/2,1),en=($e+.5*_n*_n)/(ze+_n*_n),rn=_n*Math.sqrt(en*(1-en)/(ze+_n*_n));return bt?en+rn>1?1:en+rn:en-rn<0?0:en-rn}function He(ze,$e,ut,bt){const en=(1-ut)/2;let Tn=0,In=1,Xn=0;if($e>0&&$e<1){const Ri=He(ze,0,ut,bt);return Xn=(He(ze,1,ut,bt)-Ri)*$e+Ri,Xn}for(;Math.abs(In-Tn)>1e-9;){Xn=(Tn+In)/2;let Ri=.5*ie(Xn,$e+1,ze-$e+1)/(ze+1);$e-1>=0&&(Ri+=De(Xn,$e,ze-$e+1)),Ri>(bt?en:1-en)?Tn=Xn:In=Xn}return Xn}function nt(ze,$e,ut,bt,Ot,_n){const en=$e+Ot,rn=ze-$e+_n;return bt?en>0&&rn>0?Se((1+ut)/2,en,rn):1:en>0&&rn>0?Se((1-ut)/2,en,rn):0}function it(ze,$e){if($e)return nt;switch(ze){case 0:return E;case 1:return J;case 2:return Ae;case 3:return Ce;case 4:return console.log("Feldman-Cousins interval kFFC not supported; using kFCP"),E;case 8:return He}return console.log(`Not recognized stat option ${ze}, using kFCP`),E}function lt(ze){return ze*ze}function qt(){return Math.PI}function at(){return 2*Math.PI}function Jt(){return Math.PI/2}function tn(){return Math.PI/4}function An(){return 1/Math.PI}},4186:(Gr,xt,Te)=>{"use strict";Te.r(xt),Te.d(xt,{BIT:()=>w,_ensureJSROOT:()=>_s,addMethods:()=>C,atob_func:()=>L,browser:()=>re,btoa_func:()=>he,clTAnnotation:()=>fs,clTAttCanvas:()=>Zt,clTAttFill:()=>Ne,clTAttLine:()=>We,clTAttMarker:()=>Fe,clTAttText:()=>ht,clTAxis:()=>Fn,clTBox:()=>me,clTCanvas:()=>Nt,clTClonesArray:()=>tt,clTColor:()=>wt,clTCutG:()=>_t,clTDiamond:()=>Ln,clTF1:()=>E,clTF2:()=>J,clTF3:()=>Ae,clTFile:()=>Se,clTFrame:()=>Qt,clTGaxis:()=>dn,clTGeoNode:()=>lt,clTGeoNodeMatrix:()=>qt,clTGeoVolume:()=>it,clTGraph:()=>dt,clTGraph2DAsymmErrors:()=>kt,clTGraph2DErrors:()=>Yt,clTGraphPolar:()=>Tt,clTGraphPolargram:()=>fn,clTGraphTime:()=>ln,clTH1:()=>$n,clTH1D:()=>Rn,clTH1I:()=>kn,clTH2:()=>ei,clTH2F:()=>Ue,clTH2I:()=>Yi,clTH3:()=>Y,clTHStack:()=>pt,clTHashList:()=>Xe,clTImagePalette:()=>qi,clTKey:()=>ve,clTLatex:()=>Sr,clTLegend:()=>Zn,clTLegendEntry:()=>ui,clTLine:()=>W,clTList:()=>De,clTMap:()=>ct,clTMathText:()=>ms,clTMultiGraph:()=>rt,clTNamed:()=>k,clTObjArray:()=>$,clTObjString:()=>ge,clTObject:()=>R,clTPad:()=>Mt,clTPaletteAxis:()=>hi,clTPave:()=>mn,clTPaveClass:()=>Cn,clTPaveLabel:()=>gn,clTPaveStats:()=>Sn,clTPaveText:()=>jt,clTPavesText:()=>cn,clTPolyLine:()=>_e,clTPolyLine3D:()=>Be,clTPolyMarker3D:()=>gt,clTProfile:()=>Ce,clTProfile2D:()=>He,clTProfile3D:()=>nt,clTString:()=>ee,clTStyle:()=>ai,clTText:()=>Mr,clone:()=>b,constants:()=>de,create:()=>$e,createHistogram:()=>ut,createHttpRequest:()=>z,createTGraph:()=>_n,createTHStack:()=>en,createTMultiGraph:()=>rn,createTPolyLine:()=>Ot,decodeUrl:()=>X,findFunction:()=>ie,gStyle:()=>ce,getDocument:()=>K,getMethods:()=>In,getPromise:()=>Go,httpRequest:()=>m,injectCode:()=>G,internals:()=>Je,isArrayProto:()=>fe,isBatchMode:()=>Re,isFunc:()=>Ti,isNodeJs:()=>Ie,isObject:()=>Wi,isPromise:()=>Qr,isRootCollection:()=>Ri,isStr:()=>Tr,kInspect:()=>An,kNoStats:()=>tn,kNoZoom:()=>Jt,kTitle:()=>ze,loadScript:()=>x,nsREX:()=>at,parse:()=>N,parseMulti:()=>O,postponePromise:()=>yo,prROOT:()=>A,registerMethods:()=>Xn,setBatchMode:()=>Qe,setHistogramTitle:()=>bt,settings:()=>pe,source_dir:()=>Ke,toJSON:()=>H,version:()=>Le,version_date:()=>V,version_id:()=>v});var be=Te(5774);const v="7.7.3",V="23/08/2024",Le=v+" "+V,xe=!!("object"==typeof process&&Wi(process.versions)&&process.versions.node&&process.versions.v8),Je={id_counter:1},st="file:///Users/emoyse/LocalDocuments/phoenix/node_modules/jsroot/modules/core.mjs";let Ke="";if(st&&Tr(st)){const pn=st.indexOf("modules/core.mjs");pn>=0?(Ke=st.slice(0,pn),xe||console.log(`Set jsroot source_dir to ${Ke}, ${Le}`)):(xe||console.log(`jsroot bundle, ${Le}`),Je.ignore_v6=!0)}let ot=xe;function Re(){return ot}function Qe(pn){ot=!!pn}function Ie(){return xe}const L=Ie()?pn=>Buffer.from(pn,"base64").toString("latin1"):globalThis?.atob,he=Ie()?pn=>Buffer.from(pn,"latin1").toString("base64"):globalThis?.btoa,re={isFirefox:!0,isSafari:!1,isChrome:!1,isWin:!1,touches:!1,screenWidth:1200};function fe(pn){if(pn.length<14||0!==pn.indexOf("[object "))return 0;const Hn=pn.indexOf("Array]");return Hn<0||Hn!==pn.length-6?0:14===pn.length?1:2}typeof document<"u"&&typeof window<"u"&&typeof navigator<"u"&&(navigator.userAgentData?.brands?.forEach(pn=>{"HeadlessChrome"===pn.brand?(re.isChromeHeadless=!0,re.chromeVersion=parseInt(pn.version)):"Chromium"===pn.brand&&(re.isChrome=!0,re.chromeVersion=parseInt(pn.version))}),re.chromeVersion?(re.isFirefox=!1,re.isWin="Windows"===navigator.userAgentData.platform):(re.isFirefox=navigator.userAgent.indexOf("Firefox")>=0,re.isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,re.isChrome=!!window.chrome,re.isChromeHeadless=navigator.userAgent.indexOf("HeadlessChrome")>=0,re.chromeVersion=re.isChrome||re.isChromeHeadless?parseInt(navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/)[1]):0,re.isWin=navigator.userAgent.indexOf("Windows")>=0),re.touches="ontouchend"in document,re.screenWidth=window.screen?.width??1200);const de={Render3D:{Default:0,WebGL:1,WebGLImage:2,SVG:3,fromString(pn){return"webgl"===pn||"gl"===pn?this.WebGL:"img"===pn?this.WebGLImage:"svg"===pn?this.SVG:this.Default}},Embed3D:{NoEmbed:-1,Default:0,Overlay:1,Embed:2,EmbedSVG:3,fromString(pn){return"embed"===pn?this.Embed:"overlay"===pn?this.Overlay:this.Default}},Latex:{Off:0,Symbols:1,Normal:2,MathJax:3,AlwaysMathJax:4,fromString(pn){if(!pn||!Tr(pn))return this.Normal;switch(pn){case"off":return this.Off;case"symbols":return this.Symbols;case"normal":case"latex":case"exp":case"experimental":return this.Normal;case"MathJax":case"mathjax":case"math":return this.MathJax;case"AlwaysMathJax":case"alwaysmath":case"alwaysmathjax":return this.AlwaysMathJax}const Hn=parseInt(pn);return Number.isInteger(Hn)&&Hn>=this.Off&&Hn<=this.AlwaysMathJax?Hn:this.Normal}}},pe={Render3D:de.Render3D.Default,Render3DBatch:de.Render3D.Default,Embed3D:de.Embed3D.Default,Tooltip:!xe,TooltipAnimation:500,ContextMenu:!xe,Zooming:!xe,ZoomMouse:!xe,ZoomWheel:!xe,ZoomTouch:!xe,MoveResize:!re.touches&&!xe,HandleKeys:!xe,DragAndDrop:!xe,DragGraphs:!0,ProgressBox:!xe,ToolBar:!xe&&"popup",ToolBarSide:"left",ToolBarVert:!1,CanEnlarge:!0,CanAdjustFrame:!1,ApproxTextSize:!1,OptimizeDraw:1,AutoStat:!0,FrameNDC:{},SmallPad:{width:150,height:100},Palette:57,Latex:de.Latex.Normal,GeoGradPerSegm:6,GeoCompressComp:!0,IgnoreUrlOptions:!1,HierarchyLimit:250,DislpayKind:"simple",BrowserWidth:250,XValuesFormat:void 0,YValuesFormat:void 0,ZValuesFormat:void 0,HandleWrongHttpResponse:!1,UseStamp:!0,MaxRanges:200,WithCredentials:!1,SkipStreamerInfos:!1,OnlyLastCycle:!1,DarkMode:!1,PreferSavedPoints:!1,AxisTiltAngle:25,StripAxisLabels:!0,FuncAsCurve:!1,TimeZone:"",NewTabUrl:"",NewTabUrlPars:"",NewTabUrlExportSettings:!1},ce={fName:"Modern",fOptLogx:0,fOptLogy:0,fOptLogz:0,fOptDate:0,fOptFile:0,fDateX:.01,fDateY:.01,fOptTitle:1,fCanvasColor:0,fPadColor:0,fPadBottomMargin:.1,fPadTopMargin:.1,fPadLeftMargin:.1,fPadRightMargin:.1,fPadGridX:!1,fPadGridY:!1,fPadTickX:0,fPadTickY:0,fPadBorderSize:2,fPadBorderMode:0,fCanvasBorderSize:2,fCanvasBorderMode:0,fStatColor:0,fStatStyle:1e3,fStatTextColor:1,fStatFontSize:0,fStatFont:42,fStatBorderSize:1,fStatFormat:"6.4g",fStatX:.98,fStatY:.935,fStatW:.2,fStatH:.16,fTitleAlign:23,fTitleColor:0,fTitleTextColor:1,fTitleBorderSize:0,fTitleFont:42,fTitleFontSize:.05,fTitleStyle:0,fTitleX:.5,fTitleY:.995,fTitleW:0,fTitleH:0,fFitFormat:"5.4g",fOptStat:1111,fOptFit:0,fNumberContours:20,fGridColor:0,fGridStyle:3,fGridWidth:1,fFrameFillColor:0,fFrameFillStyle:1001,fFrameLineColor:1,fFrameLineWidth:1,fFrameLineStyle:1,fFrameBorderSize:1,fFrameBorderMode:0,fEndErrorSize:2,fErrorX:.5,fHistMinimumZero:!1,fHistTopMargin:.05,fHistFillColor:0,fHistFillStyle:1001,fHistLineColor:602,fHistLineStyle:1,fHistLineWidth:1,fPaintTextFormat:"g",fTimeOffset:788918400,fLegendBorderSize:1,fLegendFont:42,fLegendTextSize:0,fLegendFillColor:0,fHatchesLineWidth:1,fHatchesSpacing:1,fCandleWhiskerRange:1,fCandleBoxRange:.5,fCandleScaled:!1,fViolinScaled:!0,fOrthoCamera:!1,fXAxisExpXOffset:0,fXAxisExpYOffset:0,fYAxisExpXOffset:0,fYAxisExpYOffset:0,fAxisMaxDigits:5,fStripDecimals:!0,fBarWidth:1};function K(){return xe?Je.nodejs_document:typeof document<"u"?document:"object"==typeof window?window.document:void 0}function G(pn){return D.apply(this,arguments)}function D(){return(D=(0,be.A)(function*(pn){if(xe){let Hn,Vt;return Te.e(36).then(Te.t.bind(Te,9036,19)).then(Gi=>(Hn=Gi.tmpNameSync()+".js",Te.e(424).then(Te.t.bind(Te,9424,19)))).then(Gi=>(Vt=Gi,Vt.writeFileSync(Hn,pn),import("file://"+Hn))).finally(()=>Vt.unlinkSync(Hn))}if(typeof document<"u"){const Hn=document.getElementsByTagName("script");for(let Gi=0;Gi<Hn.length;++Gi)if(Hn[Gi].innerHTML===pn)return!0;return(pn.indexOf("JSROOT.require")>=0?_s():Promise.resolve(!0)).then(()=>{const Gi=document.createElement("script");return Gi.setAttribute("type","text/javascript"),Gi.innerHTML=pn,document.head.appendChild(Gi),yo(!0,10)})}return!1})).apply(this,arguments)}function x(pn){return P.apply(this,arguments)}function P(){return(P=(0,be.A)(function*(pn){if(!pn)return!0;if(Tr(pn)&&pn.indexOf(";")>=0&&(pn=pn.split(";")),!Tr(pn)){const Nn=pn,zn=()=>!Nn.length||x(Nn.shift()).then(zn,zn);return zn()}0===pn.indexOf("$$$")&&(0===(pn=pn.slice(3)).indexOf("style/")&&pn.indexOf(".css")<0&&(pn+=".css"),pn=Ke+pn);const Hn=pn.indexOf(".css")>0;if(xe)return Hn?null:0===pn.indexOf("http:")||0===pn.indexOf("https:")?m(pn,"text").then(Nn=>G(Nn)):0===pn.indexOf("./")?Te.e(424).then(Te.t.bind(Te,9424,19)).then(Nn=>G(Nn.readFileSync(pn))):import(pn);const Vt=Nn=>{if(Nn===pn)return!0;const zn=Nn.indexOf(pn);return zn>0&&zn+pn.length===Nn.length&&"/"===Nn[zn-1]};if(Hn){const Nn=document.getElementsByTagName("link");for(let zn=0;zn<Nn.length;++zn)if(Nn[zn].href&&"text/css"===Nn[zn].type&&"stylesheet"===Nn[zn].rel&&Vt(Nn[zn].href))return!0}else{const Nn=document.getElementsByTagName("script");for(let zn=0;zn<Nn.length;++zn)if(Vt(Nn[zn].src))return!0}let Gi;return Hn?(Gi=document.createElement("link"),Gi.setAttribute("rel","stylesheet"),Gi.setAttribute("type","text/css"),Gi.setAttribute("href",pn)):(Gi=document.createElement("script"),Gi.setAttribute("type","text/javascript"),Gi.setAttribute("src",pn)),new Promise((Nn,zn)=>{Gi.onload=()=>Nn(!0),Gi.onerror=()=>{Gi.remove(),zn(Error(`Fail to load ${pn}`))},document.head.appendChild(Gi)})})).apply(this,arguments)}function w(pn){return 1<<pn}function b(pn,Hn,Vt){if(!pn)return null;if(Hn){const zn=Hn.obj.indexOf(pn);if(zn>=0)return Hn.clones[zn]}else Hn={obj:[],clones:[],nofunc:Vt};const Gi=fe(Object.prototype.toString.apply(pn));if(1===Gi){const zn=[];Hn.obj.push(pn),Hn.clones.push(zn);for(let dr=0;dr<pn.length;++dr)zn.push(Wi(pn[dr])?b(pn[dr],Hn):pn[dr]);return zn}if(2===Gi){const zn=[];Hn.obj.push(pn),Hn.clones.push(zn);for(let dr=0;dr<pn.length;++dr)zn.push(pn[dr]);return zn}const Nn={};Hn.obj.push(pn),Hn.clones.push(Nn);for(const zn in pn)Wi(pn[zn])?Nn[zn]=b(pn[zn],Hn):(!Hn.nofunc||!Ti(pn[zn]))&&(Nn[zn]=pn[zn]);return Nn}const g=Object.assign;function C(pn,Hn){g(pn,In(Hn||pn._typename,pn))}function N(pn){if(!pn)return null;const Hn=Tr(pn)?JSON.parse(pn):pn,Vt=[];let Gi;const Nn=zn=>{if(null==zn)return;if(Tr(zn)){if(Gi||zn.length<6||0!==zn.indexOf("$ref:"))return;const jr=parseInt(zn.slice(5));return!Number.isInteger(jr)||jr<0||jr>=Vt.length?void 0:(Gi=!1,Vt[jr])}if("object"!=typeof zn)return;if(fe(Object.prototype.toString.apply(zn))>0){for(let jr=0;jr<zn.length;++jr){const bs=Nn(zn[jr]);void 0!==bs&&(zn[jr]=bs)}return}const tr=Object.keys(zn),ws=tr.length;if(!1!==Gi&&1===ws&&"$ref"===tr[0]){const jr=parseInt(zn.$ref);return!Number.isInteger(jr)||jr<0||jr>=Vt.length?void 0:(Gi=!0,Vt[jr])}if(!1!==Gi&&ws>1&&"$arr"===tr[0]&&"len"===tr[1]){let jr;switch(zn.$arr){case"Int8":jr=new Int8Array(zn.len);break;case"Uint8":jr=new Uint8Array(zn.len);break;case"Int16":jr=new Int16Array(zn.len);break;case"Uint16":jr=new Uint16Array(zn.len);break;case"Int32":jr=new Int32Array(zn.len);break;case"Uint32":jr=new Uint32Array(zn.len);break;case"Float32":jr=new Float32Array(zn.len);break;case"Int64":case"Uint64":case"Float64":jr=new Float64Array(zn.len);break;default:jr=new Array(zn.len)}if(jr.fill("Bool"!==zn.$arr&&0),void 0!==zn.b){const bs=L(zn.b);if(!jr.buffer)throw new Error("base64 coding supported only for native arrays with binary data");{const ks=new DataView(jr.buffer,zn.o||0),Zo=Math.min(bs.length,ks.byteLength);for(let Va=0;Va<Zo;++Va)ks.setUint8(Va,bs.charCodeAt(Va))}}else{let bs=2,ks=0;for(;bs<ws;){if("p"===tr[bs][0]&&(ks=zn[tr[bs++]]),"v"!==tr[bs][0])throw new Error(`Unexpected member ${tr[bs]} in array decoding`);const Zo=zn[tr[bs++]];if("object"==typeof Zo)for(let Va=0;Va<Zo.length;++Va)jr[ks++]=Zo[Va];else if(jr[ks++]=Zo,bs<ws&&"n"===tr[bs][0]){let Va=zn[tr[bs++]];for(;--Va;)jr[ks++]=Zo}}}return jr}if(!1!==Gi&&3===ws&&"$pair"===tr[0]&&"first"===tr[1]&&"second"===tr[2]){Gi=!0;const jr=Nn(zn.first),bs=Nn(zn.second);return void 0!==jr&&(zn.first=jr),void 0!==bs&&(zn.second=bs),zn._typename=zn.$pair,void delete zn.$pair}if(!(Vt.indexOf(zn)>=0)){Vt.push(zn),zn._typename&&C(zn);for(let jr=0;jr<ws;++jr){const bs=tr[jr],ks=Nn(zn[bs]);void 0!==ks&&(zn[bs]=ks)}}};return Nn(Hn),Hn}function O(pn){if(!pn)return null;const Hn=JSON.parse(pn);if(Hn?.length)for(let Vt=0;Vt<Hn.length;++Vt)Hn[Vt]=N(Hn[Vt]);return Hn}function H(pn,Hn){if(!Wi(pn))return"";const Vt=[],Gi=zn=>{if(Ti(zn))return;if(null==zn||!Wi(zn))return zn;if(fe(Object.prototype.toString.apply(zn))>0){const bs=new Array(zn.length);for(let ks=0;ks<zn.length;++ks)bs[ks]=Gi(zn[ks]);return bs}const dr=Vt.indexOf(zn);if(dr>=0)return{$ref:dr};const tr=Object.keys(zn),ws=tr.length,jr={};if(3===ws&&"$pair"===tr[0]&&"first"===tr[1]&&"second"===tr[2])return jr.$pair=zn.$pair,jr.first=Gi(zn.first),jr.second=Gi(zn.second),jr;Vt.push(zn);for(let bs=0;bs<ws;++bs){const ks=tr[bs];ks&&"$"!==ks[0]&&(jr[ks]=Gi(zn[ks]))}return jr},Nn=Gi(pn);return JSON.stringify(Nn,null,Hn)}function X(pn){const Hn={opts:{},has(Gi){return void 0!==this.opts[Gi]},get(Gi,Nn){const zn=this.opts[Gi];return void 0!==zn?zn:Nn}};if(!pn||!Tr(pn)){if(pe.IgnoreUrlOptions||typeof document>"u")return Hn;pn=document.URL}Hn.url=pn;const Vt=pn.indexOf("?");if(Vt<0)return Hn;for(pn=decodeURI(pn.slice(Vt+1));pn;){let Gi=0,Nn=0,zn=-1,dr=-1;for(;Gi<pn.length&&(0!==Nn||"&"!==pn[Gi]&&"#"!==pn[Gi]);){switch(pn[Gi]){case"'":Nn>=0&&(Nn=(Nn+1)%2),dr<0&&(dr=Gi);break;case'"':Nn<=0&&(Nn=(Nn-1)%2),dr<0&&(dr=Gi);break;case"=":dr<0&&zn<0&&(zn=Gi)}Gi++}if(zn<0&&dr<0)Hn.opts[pn.slice(0,Gi)]="";else if(zn>0){let tr=pn.slice(zn+1,Gi);("'"===tr[0]||'"'===tr[0])&&tr[0]===tr[tr.length-1]&&(tr=tr.slice(1,tr.length-1)),Hn.opts[pn.slice(0,zn)]=tr}if(Gi>=pn.length||"#"===pn[Gi])break;pn=pn.slice(Gi+1)}return Hn}function ie(pn){if(Ti(pn))return pn;if(!Tr(pn))return null;const Hn=pn.split(".");let Vt=globalThis;for(let Gi=0;Vt&&Gi<Hn.length;++Gi)Vt=Vt[Hn[Gi]];return Ti(Vt)?Vt:null}function z(pn,Hn,Vt,Gi,Nn){function zn(tr){tr.http_callback=Ti(Vt)?Vt.bind(tr):()=>{},tr.error_callback=Ti(Gi)?Gi.bind(tr):function(ks){console.warn(ks.message),this.http_callback(null)}.bind(tr),Hn||(Hn="buf");let ws="GET",jr=!0;const bs=Hn.indexOf(";sync");switch(bs>0&&(Hn=Hn.slice(0,bs),jr=!1),Hn){case"head":ws="HEAD";break;case"posttext":ws="POST",Hn="text";break;case"postbuf":ws="POST",Hn="buf";break;case"post":case"multi":ws="POST"}return tr.kind=Hn,pe.WithCredentials&&(tr.withCredentials=!0),pe.HandleWrongHttpResponse&&"GET"===ws&&Ti(tr.addEventListener)&&tr.addEventListener("progress",function(ks){ks.lengthComputable&&this.expected_size&&ks.loaded>this.expected_size&&(this.did_abort=!0,this.abort(),this.error_callback(Error(`Server sends more bytes ${ks.loaded} than expected ${this.expected_size}. Abort I/O operation`),598))}.bind(tr)),tr.onreadystatechange=function(){if(!this.did_abort){if(2===this.readyState&&this.expected_size){const ks=parseInt(this.getResponseHeader("Content-Length"));if(Number.isInteger(ks)&&ks>this.expected_size&&!pe.HandleWrongHttpResponse)return this.did_abort=!0,this.abort(),this.error_callback(Error(`Server response size ${ks} larger than expected ${this.expected_size}. Abort I/O operation`),599)}if(4===this.readyState){if(200!==this.status&&206!==this.status&&!re.qt5&&(0!==this.status||0!==pn.indexOf("file://")&&0!==pn.indexOf("blob:")))return this.error_callback(Error(`Fail to load url ${pn}`),this.status);if(this.nodejs_checkzip&&"gzip"===this.getResponseHeader("content-encoding"))return Te.e(578).then(Te.t.bind(Te,7578,19)).then(ks=>{const Zo=ks.unzipSync(Buffer.from(this.response)),Va=JSON.parse(Zo);return this.http_callback(N(Va))});switch(this.kind){case"xml":return this.http_callback(this.responseXML);case"text":return this.http_callback(this.responseText);case"object":return this.http_callback(N(this.responseText));case"multi":return this.http_callback(O(this.responseText));case"head":return this.http_callback(this)}if(void 0===this.responseType)return this.http_callback(this.responseText);if("bin"===this.kind&&"byteLength"in this.response){const ks=new Uint8Array(this.response);let Zo="";for(let Va=0;Va<ks.length;++Va)Zo+=String.fromCharCode(ks[Va]);return this.http_callback(Zo)}this.http_callback(this.response)}}},tr.open(ws,pn,jr),("bin"===Hn||"buf"===Hn)&&(tr.responseType="arraybuffer"),xe&&"GET"===ws&&"object"===Hn&&pn.indexOf(".json.gz")>0&&(tr.nodejs_checkzip=!0,tr.responseType="arraybuffer"),tr}if(Ie()){if(!Nn)throw Error("Not allowed to create http requests in node.js without promise");return Te.e(149).then(Te.t.bind(Te,9149,19)).then(tr=>zn(new tr.default))}const dr=zn(new XMLHttpRequest);return Nn?Promise.resolve(dr):dr}function m(pn,Hn,Vt){return I.apply(this,arguments)}function I(){return(I=(0,be.A)(function*(pn,Hn,Vt){return new Promise((Gi,Nn)=>{z(pn,Hn,Gi,Nn,!0).then(zn=>zn.send(Vt||null))})})).apply(this,arguments)}const A="ROOT.",R="TObject",k="TNamed",ee="TString",ge="TObjString",ve="TKey",Se="TFile",De="TList",Xe="THashList",ct="TMap",$="TObjArray",tt="TClonesArray",We="TAttLine",Ne="TAttFill",Fe="TAttMarker",ht="TAttText",pt="THStack",dt="TGraph",rt="TMultiGraph",_t="TCutG",Yt="TGraph2DErrors",kt="TGraph2DAsymmErrors",Tt="TGraphPolar",fn="TGraphPolargram",ln="TGraphTime",mn="TPave",jt="TPaveText",Sn="TPaveStats",cn="TPavesText",gn="TPaveLabel",Cn="TPaveClass",Ln="TDiamond",Zn="TLegend",ui="TLegendEntry",hi="TPaletteAxis",qi="TImagePalette",Mr="TText",Sr="TLatex",ms="TMathText",fs="TAnnotation",wt="TColor",W="TLine",me="TBox",_e="TPolyLine",Be="TPolyLine3D",gt="TPolyMarker3D",Et="TAttPad",Mt="TPad",Nt="TCanvas",Qt="TFrame",Zt="TAttCanvas",dn="TGaxis",vn="TAttAxis",Fn="TAxis",ai="TStyle",$n="TH1",kn="TH1I",Rn="TH1D",ei="TH2",Yi="TH2I",Ue="TH2F",Y="TH3",E="TF1",J="TF2",Ae="TF3",Ce="TProfile",He="TProfile2D",nt="TProfile3D",it="TGeoVolume",lt="TGeoNode",qt="TGeoNodeMatrix",at="ROOT::Experimental::",Jt=-1111,tn=w(9),An="inspect",ze="title";function $e(pn,Hn){const Vt=Hn||{};switch(pn){case R:g(Vt,{fUniqueID:0,fBits:0});break;case k:g(Vt,{fUniqueID:0,fBits:0,fName:"",fTitle:""});break;case De:case Xe:g(Vt,{name:pn,arr:[],opt:[]});break;case vn:g(Vt,{fNdivisions:510,fAxisColor:1,fLabelColor:1,fLabelFont:42,fLabelOffset:.005,fLabelSize:.035,fTickLength:.03,fTitleOffset:1,fTitleSize:.035,fTitleColor:1,fTitleFont:42});break;case Fn:$e(k,Vt),$e(vn,Vt),g(Vt,{fNbins:1,fXmin:0,fXmax:1,fXbins:[],fFirst:0,fLast:0,fBits2:0,fTimeDisplay:!1,fTimeFormat:"",fLabels:null,fModLabs:null});break;case We:g(Vt,{fLineColor:1,fLineStyle:1,fLineWidth:1});break;case Ne:g(Vt,{fFillColor:0,fFillStyle:0});break;case Fe:g(Vt,{fMarkerColor:1,fMarkerStyle:1,fMarkerSize:1});break;case W:$e(R,Vt),$e(We,Vt),g(Vt,{fX1:0,fX2:1,fY1:0,fY2:1});break;case me:$e(R,Vt),$e(We,Vt),$e(Ne,Vt),g(Vt,{fX1:0,fX2:1,fY1:0,fY2:1});break;case mn:$e(me,Vt),g(Vt,{fX1NDC:0,fY1NDC:0,fX2NDC:1,fY2NDC:1,fBorderSize:0,fInit:1,fShadowColor:1,fCornerRadius:0,fOption:"brNDC",fName:""});break;case ht:g(Vt,{fTextAngle:0,fTextSize:0,fTextAlign:22,fTextColor:1,fTextFont:42});break;case jt:$e(mn,Vt),$e(ht,Vt),g(Vt,{fLabel:"",fLongest:27,fMargin:.05,fLines:$e(De)});break;case Sn:$e(jt,Vt),g(Vt,{fFillColor:ce.fStatColor,fFillStyle:ce.fStatStyle,fTextFont:ce.fStatFont,fTextSize:ce.fStatFontSize,fTextColor:ce.fStatTextColor,fBorderSize:ce.fStatBorderSize,fOptFit:0,fOptStat:0,fFitFormat:"",fStatFormat:"",fParent:null});break;case Zn:$e(mn,Vt),$e(ht,Vt),g(Vt,{fColumnSeparation:0,fEntrySeparation:.1,fMargin:.25,fNColumns:1,fPrimitives:$e(De),fName:mn,fBorderSize:ce.fLegendBorderSize,fTextFont:ce.fLegendFont,fTextSize:ce.fLegendTextSize,fFillColor:ce.fLegendFillColor});break;case hi:$e(mn,Vt),g(Vt,{fAxis:$e(dn),fH:null,fName:mn});break;case ui:$e(R,Vt),$e(ht,Vt),$e(We,Vt),$e(Ne,Vt),$e(Fe,Vt),g(Vt,{fLabel:"",fObject:null,fOption:"",fTextAlign:0,fTextColor:0,fTextFont:0});break;case Mr:$e(k,Vt),$e(ht,Vt),g(Vt,{fLimitFactorSize:3,fOriginSize:.04});break;case Sr:$e(Mr,Vt),$e(We,Vt),g(Vt,{fX:0,fY:0});break;case ge:$e(R,Vt),g(Vt,{fString:""});break;case $n:$e(k,Vt),$e(We,Vt),$e(Ne,Vt),$e(Fe,Vt),g(Vt,{fBits:8,fNcells:0,fXaxis:$e(Fn),fYaxis:$e(Fn),fZaxis:$e(Fn),fFillColor:ce.fHistFillColor,fFillStyle:ce.fHistFillStyle,fLineColor:ce.fHistLineColor,fLineStyle:ce.fHistLineStyle,fLineWidth:ce.fHistLineWidth,fBarOffset:0,fBarWidth:1e3,fEntries:0,fTsumw:0,fTsumw2:0,fTsumwx:0,fTsumwx2:0,fMaximum:Jt,fMinimum:Jt,fNormFactor:0,fContour:[],fSumw2:[],fOption:"",fFunctions:$e(De),fBufferSize:0,fBuffer:[],fBinStatErrOpt:0,fStatOverflows:2});break;case kn:case Rn:case"TH1L64":case"TH1F":case"TH1S":case"TH1C":$e($n,Vt),Vt.fArray=[];break;case ei:$e($n,Vt),g(Vt,{fScalefactor:1,fTsumwy:0,fTsumwy2:0,fTsumwxy:0});break;case Yi:case"TH2L64":case Ue:case"TH2D":case"TH2S":case"TH2C":$e(ei,Vt),Vt.fArray=[];break;case Y:$e($n,Vt),g(Vt,{fTsumwy:0,fTsumwy2:0,fTsumwz:0,fTsumwz2:0,fTsumwxy:0,fTsumwxz:0,fTsumwyz:0});break;case"TH3I":case"TH3L64":case"TH3F":case"TH3D":case"TH3S":case"TH3C":$e(Y,Vt),Vt.fArray=[];break;case pt:$e(k,Vt),g(Vt,{fHists:$e(De),fHistogram:null,fMaximum:Jt,fMinimum:Jt});break;case dt:$e(k,Vt),$e(We,Vt),$e(Ne,Vt),$e(Fe,Vt),g(Vt,{fFunctions:$e(De),fHistogram:null,fMaxSize:0,fMaximum:Jt,fMinimum:Jt,fNpoints:0,fX:[],fY:[]});break;case"TGraphAsymmErrors":$e(dt,Vt),g(Vt,{fEXlow:[],fEXhigh:[],fEYlow:[],fEYhigh:[]});break;case rt:$e(k,Vt),g(Vt,{fFunctions:$e(De),fGraphs:$e(De),fHistogram:null,fMaximum:Jt,fMinimum:Jt});break;case fn:$e(k,Vt),$e(ht,Vt),$e(We,Vt),g(Vt,{fRadian:!0,fDegree:!1,fGrad:!1,fPolarLabelColor:1,fRadialLabelColor:1,fAxisAngle:0,fPolarOffset:.04,fPolarTextSize:.04,fRadialOffset:.025,fRadialTextSize:.035,fRwrmin:0,fRwrmax:1,fRwtmin:0,fRwtmax:2*Math.PI,fTickpolarSize:.02,fPolarLabelFont:62,fRadialLabelFont:62,fCutRadial:0,fNdivRad:508,fNdivPol:508});break;case _e:$e(R,Vt),$e(We,Vt),$e(Ne,Vt),g(Vt,{fLastPoint:-1,fN:0,fOption:"",fX:null,fY:null});break;case dn:$e(W,Vt),$e(ht,Vt),g(Vt,{fChopt:"",fFunctionName:"",fGridLength:0,fLabelColor:1,fLabelFont:42,fLabelOffset:.005,fLabelSize:.035,fName:"",fNdiv:12,fTickSize:.02,fTimeFormat:"",fTitle:"",fTitleOffset:1,fTitleSize:.035,fWmax:100,fWmin:0});break;case Et:g(Vt,{fLeftMargin:ce.fPadLeftMargin,fRightMargin:ce.fPadRightMargin,fBottomMargin:ce.fPadBottomMargin,fTopMargin:ce.fPadTopMargin,fXfile:2,fYfile:2,fAfile:1,fXstat:.99,fYstat:.99,fAstat:2,fFrameFillColor:ce.fFrameFillColor,fFrameFillStyle:ce.fFrameFillStyle,fFrameLineColor:ce.fFrameLineColor,fFrameLineWidth:ce.fFrameLineWidth,fFrameLineStyle:ce.fFrameLineStyle,fFrameBorderSize:ce.fFrameBorderSize,fFrameBorderMode:ce.fFrameBorderMode});break;case Mt:$e(R,Vt),$e(We,Vt),$e(Ne,Vt),$e(Et,Vt),g(Vt,{fFillColor:ce.fPadColor,fFillStyle:1001,fX1:0,fY1:0,fX2:1,fY2:1,fXtoAbsPixelk:1,fXtoPixelk:1,fXtoPixel:1,fYtoAbsPixelk:1,fYtoPixelk:1,fYtoPixel:1,fUtoAbsPixelk:1,fUtoPixelk:1,fUtoPixel:1,fVtoAbsPixelk:1,fVtoPixelk:1,fVtoPixel:1,fAbsPixeltoXk:1,fPixeltoXk:1,fPixeltoX:1,fAbsPixeltoYk:1,fPixeltoYk:1,fPixeltoY:1,fXlowNDC:0,fYlowNDC:0,fXUpNDC:0,fYUpNDC:0,fWNDC:1,fHNDC:1,fAbsXlowNDC:0,fAbsYlowNDC:0,fAbsWNDC:1,fAbsHNDC:1,fUxmin:0,fUymin:0,fUxmax:0,fUymax:0,fTheta:30,fPhi:30,fAspectRatio:0,fNumber:0,fLogx:ce.fOptLogx,fLogy:ce.fOptLogy,fLogz:ce.fOptLogz,fTickx:ce.fPadTickX,fTicky:ce.fPadTickY,fPadPaint:0,fCrosshair:0,fCrosshairPos:0,fBorderSize:ce.fPadBorderSize,fBorderMode:ce.fPadBorderMode,fModified:!1,fGridx:ce.fPadGridX,fGridy:ce.fPadGridY,fAbsCoord:!1,fEditable:!0,fFixedAspectRatio:!1,fPrimitives:$e(De),fExecs:null,fName:"pad",fTitle:"canvas"});break;case Zt:g(Vt,{fXBetween:2,fYBetween:2,fTitleFromTop:1.2,fXdate:.2,fYdate:.3,fAdate:1});break;case Nt:$e(Mt,Vt),g(Vt,{fFillColor:ce.fCanvasColor,fFillStyle:1001,fNumPaletteColor:0,fNextPaletteColor:0,fDISPLAY:"$DISPLAY",fDoubleBuffer:0,fRetained:!0,fXsizeUser:0,fYsizeUser:0,fXsizeReal:20,fYsizeReal:10,fWindowTopX:0,fWindowTopY:0,fWindowWidth:0,fWindowHeight:0,fBorderSize:ce.fCanvasBorderSize,fBorderMode:ce.fCanvasBorderMode,fCw:500,fCh:300,fCatt:$e(Zt),kMoveOpaque:!0,kResizeOpaque:!0,fHighLightColor:5,fBatch:!0,kShowEventStatus:!1,kAutoExec:!0,kMenuBar:!0});break;case it:$e(k,Vt),$e(We,Vt),$e(Ne,Vt),g(Vt,{fGeoAtt:0,fFinder:null,fMedium:null,fNodes:null,fNtotal:0,fNumber:0,fRefCount:0,fShape:null,fVoxels:null});break;case lt:$e(k,Vt),g(Vt,{fGeoAtt:0,fMother:null,fNovlp:0,fNumber:0,fOverlaps:null,fVolume:null});break;case qt:$e(lt,Vt),g(Vt,{fMatrix:null});break;case"TGeoTrack":$e(R,Vt),$e(We,Vt),$e(Fe,Vt),g(Vt,{fGeoAtt:0,fNpoints:0,fPoints:[]});break;case Be:$e(R,Vt),$e(We,Vt),g(Vt,{fLastPoint:-1,fN:0,fOption:"",fP:[]});break;case gt:$e(R,Vt),$e(Fe,Vt),g(Vt,{fLastPoint:-1,fN:0,fName:"",fOption:"",fP:[]})}return Vt._typename=pn,C(Vt,pn),Vt}function ut(pn,Hn,Vt,Gi){const Nn=$e(pn);if(!Nn.fXaxis||!Nn.fYaxis||!Nn.fZaxis)return null;switch(Nn.fName="hist",Nn.fTitle="title",Hn&&g(Nn.fXaxis,{fNbins:Hn,fXmin:0,fXmax:Hn}),Vt&&g(Nn.fYaxis,{fNbins:Vt,fXmin:0,fXmax:Vt}),Gi&&g(Nn.fZaxis,{fNbins:Gi,fXmin:0,fXmax:Gi}),parseInt(pn[2])){case 1:Hn&&(Nn.fNcells=Hn+2);break;case 2:Hn&&Vt&&(Nn.fNcells=(Hn+2)*(Vt+2));break;case 3:Hn&&Vt&&Gi&&(Nn.fNcells=(Hn+2)*(Vt+2)*(Gi+2))}if(Nn.fNcells>0){switch(pn[3]){case"C":Nn.fArray=new Int8Array(Nn.fNcells);break;case"S":Nn.fArray=new Int16Array(Nn.fNcells);break;case"I":Nn.fArray=new Int32Array(Nn.fNcells);break;case"F":Nn.fArray=new Float32Array(Nn.fNcells);break;case"L":case"D":Nn.fArray=new Float64Array(Nn.fNcells);break;default:Nn.fArray=new Array(Nn.fNcells)}Nn.fArray.fill(0)}return Nn}function bt(pn,Hn){if(pn)if(Hn.indexOf(";")<0)pn.fTitle=Hn;else{const Vt=Hn.split(";");pn.fTitle=Vt[0],Vt.length>1&&(pn.fXaxis.fTitle=Vt[1]),Vt.length>2&&(pn.fYaxis.fTitle=Vt[2]),Vt.length>3&&(pn.fZaxis.fTitle=Vt[3])}}function Ot(pn,Hn){const Vt=$e(_e);return pn&&(Vt.fN=pn,Hn?(Vt.fX=new Int32Array(pn),Vt.fY=new Int32Array(pn)):(Vt.fX=new Float32Array(pn),Vt.fY=new Float32Array(pn))),Vt}function _n(pn,Hn,Vt){const Gi=g($e(dt),{fBits:1032,fName:"graph",fTitle:"title"});if(pn>0){Gi.fMaxSize=Gi.fNpoints=pn;const Nn=Wi(Hn)&&Hn.length===pn,zn=Wi(Vt)&&Vt.length===pn;for(let dr=0;dr<pn;++dr)Gi.fX.push(Nn?Hn[dr]:dr/pn),Gi.fY.push(zn?Vt[dr]:dr/pn)}return Gi}function en(){const pn=$e(pt);for(let Hn=0;Hn<arguments.length;++Hn)pn.fHists.Add(arguments[Hn],"");return pn}function rn(){const pn=$e(rt);for(let Hn=0;Hn<arguments.length;++Hn)pn.fGraphs.Add(arguments[Hn],"");return pn}const Tn={};function In(pn,Hn){let Vt=Tn[pn];const Gi=void 0!==Vt;return Gi||(Vt={}),(pn===R||pn===k||void 0!==Hn?.fBits)&&typeof Vt.TestBit>"u"&&(Vt.TestBit=function(Nn){return!!(this.fBits&Nn)},Vt.InvertBit=function(Nn){this.fBits=this.fBits^16777215&Nn}),Gi||((pn===De||pn===Xe)&&(Vt.Clear=function(){this.arr=[],this.opt=[]},Vt.Add=function(Nn,zn){this.arr.push(Nn),this.opt.push(Tr(zn)?zn:"")},Vt.AddFirst=function(Nn,zn){this.arr.unshift(Nn),this.opt.unshift(Tr(zn)?zn:"")},Vt.RemoveAt=function(Nn){this.arr.splice(Nn,1),this.opt.splice(Nn,1)}),(pn===jt||pn===Sn)&&(Vt.AddText=function(Nn){const zn=$e(Sr);zn.fTitle=Nn,zn.fTextAlign=0,zn.fTextColor=0,zn.fTextFont=0,zn.fTextSize=0,this.fLines.Add(zn)},Vt.Clear=function(){this.fLines.Clear()}),(0===pn.indexOf(E)||pn===J)&&(Vt.addFormula=function(Nn){Nn&&(void 0===this.formulas&&(this.formulas=[]),this.formulas.push(Nn))},Vt.GetParName=function(Nn){if(this.fParams?.fParNames)return this.fParams.fParNames[Nn];if(this.fFormula?.fParams)for(let zn=0,dr=this.fFormula.fParams;zn<dr.length;++zn)if(dr[zn].second===Nn)return dr[zn].first;return this.fNames&&this.fNames[Nn]?this.fNames[Nn]:`p${Nn}`},Vt.GetParValue=function(Nn){return this.fParams?.fParameters?this.fParams.fParameters[Nn]:this.fFormula?.fClingParameters?this.fFormula.fClingParameters[Nn]:this.fParams?this.fParams[Nn]:void 0},Vt.GetParError=function(Nn){return this.fParErrors?this.fParErrors[Nn]:void 0},Vt.GetNumPars=function(){return this.fNpar}),(0===pn.indexOf(dt)||pn===_t)&&pn!==fn&&pn!==ln&&(Vt.IsInside=function(Nn,zn){const dr=this.fX,tr=this.fY;let ws=0,jr=this.fNpoints-1,bs=!1;for(;ws<this.fNpoints;++ws)(tr[ws]<zn&&tr[jr]>=zn||tr[jr]<zn&&tr[ws]>=zn)&&dr[ws]+(zn-tr[ws])/(tr[jr]-tr[ws])*(dr[jr]-dr[ws])<Nn&&(bs=!bs),jr=ws;return bs}),(0===pn.indexOf($n)||0===pn.indexOf(ei)||0===pn.indexOf(Y))&&(Vt.getBinError=function(Nn){return Nn>=this.fNcells&&(Nn=this.fNcells-1),Nn<0&&(Nn=0),Nn<this.fSumw2.length?Math.sqrt(this.fSumw2[Nn]):Math.sqrt(Math.abs(this.fArray[Nn]))},Vt.setBinContent=function(Nn,zn){this.fEntries++,this.fTsumw=0,Nn>=0&&Nn<this.fArray.length&&(this.fArray[Nn]=zn)}),0===pn.indexOf($n)&&(Vt.getBin=function(Nn){return Nn},Vt.getBinContent=function(Nn){return this.fArray[Nn]},Vt.Fill=function(Nn,zn){const dr=this.fXaxis,tr=Math.max(0,1+Math.min(dr.fNbins,Math.floor((Nn-dr.fXmin)/(dr.fXmax-dr.fXmin)*dr.fNbins)));this.fArray[tr]+=zn??1,this.fEntries++}),0===pn.indexOf(ei)&&(Vt.getBin=function(Nn,zn){return Nn+(this.fXaxis.fNbins+2)*zn},Vt.getBinContent=function(Nn,zn){return this.fArray[this.getBin(Nn,zn)]},Vt.Fill=function(Nn,zn,dr){const tr=this.fXaxis,ws=this.fYaxis,jr=Math.max(0,1+Math.min(tr.fNbins,Math.floor((Nn-tr.fXmin)/(tr.fXmax-tr.fXmin)*tr.fNbins))),bs=Math.max(0,1+Math.min(ws.fNbins,Math.floor((zn-ws.fXmin)/(ws.fXmax-ws.fXmin)*ws.fNbins)));this.fArray[jr+(tr.fNbins+2)*bs]+=dr??1,this.fEntries++}),0===pn.indexOf(Y)&&(Vt.getBin=function(Nn,zn,dr){return Nn+(this.fXaxis.fNbins+2)*(zn+(this.fYaxis.fNbins+2)*dr)},Vt.getBinContent=function(Nn,zn,dr){return this.fArray[this.getBin(Nn,zn,dr)]},Vt.Fill=function(Nn,zn,dr,tr){const ws=this.fXaxis,jr=this.fYaxis,bs=this.fZaxis,ks=Math.max(0,1+Math.min(ws.fNbins,Math.floor((Nn-ws.fXmin)/(ws.fXmax-ws.fXmin)*ws.fNbins))),Zo=Math.max(0,1+Math.min(jr.fNbins,Math.floor((zn-jr.fXmin)/(jr.fXmax-jr.fXmin)*jr.fNbins))),Va=Math.max(0,1+Math.min(bs.fNbins,Math.floor((dr-bs.fXmin)/(bs.fXmax-bs.fXmin)*bs.fNbins)));this.fArray[ks+(ws.fNbins+2)*(Zo+(jr.fNbins+2)*Va)]+=tr??1,this.fEntries++}),(pn===Mt||pn===Nt)&&(Vt.Divide=function(Nn,zn,dr=.01,tr=.01){if(!zn){const ks=Nn;if(ks<2)return this;(Nn=zn=Math.round(Math.sqrt(ks)))*zn<ks&&(Nn+=1)}if(Nn*zn<2)return 0;this.fPrimitives.Clear();const ws=1/zn,jr=1/Nn;let bs=0;for(let ks=0;ks<zn;ks++){const Zo=1-ks*ws-tr;let Va=Zo-ws+2*tr;if(Va<0&&(Va=0),!(Va>Zo))for(let Th=0;Th<Nn;Th++){const Vu=Th*jr+dr,cd=Vu+jr-2*dr;if(Vu>cd)continue;bs++;const Da=$e(Mt);Da.fName=Da.fTitle=`${this.fName}_${bs}`,Da.fNumber=bs,this._typename!==Nt?(Da.fAbsWNDC=(cd-Vu)*this.fAbsWNDC,Da.fAbsHNDC=(Zo-Va)*this.fAbsHNDC,Da.fAbsXlowNDC=this.fAbsXlowNDC+Vu*this.fAbsWNDC,Da.fAbsYlowNDC=this.fAbsYlowNDC+Va*this.fAbsWNDC):(Da.fAbsWNDC=cd-Vu,Da.fAbsHNDC=Zo-Va,Da.fAbsXlowNDC=Vu,Da.fAbsYlowNDC=Va),this.fPrimitives.Add(Da)}}return Nn*zn},Vt.GetPad=function(Nn){return this.fPrimitives.arr.find(zn=>zn._typename===Mt&&zn.fNumber===Nn)}),0===pn.indexOf(Ce)&&(pn===nt?(Vt.getBin=function(Nn,zn,dr){return Nn+(this.fXaxis.fNbins+2)*(zn+(this.fYaxis.fNbins+2)*dr)},Vt.getBinContent=function(Nn,zn,dr){const tr=this.getBin(Nn,zn,dr);return tr<0||tr>=this.fNcells||this.fBinEntries[tr]<1e-300?0:this.fArray?this.fArray[tr]/this.fBinEntries[tr]:0},Vt.getBinEntries=function(Nn,zn,dr){const tr=this.getBin(Nn,zn,dr);return tr<0||tr>=this.fNcells?0:this.fBinEntries[tr]}):pn===He?(Vt.getBin=function(Nn,zn){return Nn+(this.fXaxis.fNbins+2)*zn},Vt.getBinContent=function(Nn,zn){const dr=this.getBin(Nn,zn);return dr<0||dr>=this.fNcells||this.fBinEntries[dr]<1e-300||!this.fArray?0:this.fArray[dr]/this.fBinEntries[dr]},Vt.getBinEntries=function(Nn,zn){const dr=this.getBin(Nn,zn);return dr<0||dr>=this.fNcells?0:this.fBinEntries[dr]}):(Vt.getBin=function(Nn){return Nn},Vt.getBinContent=function(Nn){return Nn<0||Nn>=this.fNcells||this.fBinEntries[Nn]<1e-300||!this.fArray?0:this.fArray[Nn]/this.fBinEntries[Nn]}),Vt.getBinEffectiveEntries=function(Nn){if(Nn<0||Nn>=this.fNcells)return 0;const zn=this.fBinEntries[Nn];if(!this.fBinSumw2||this.fBinSumw2.length!==this.fNcells)return zn;const dr=this.fBinSumw2[Nn];return dr>0?zn*zn/dr:0},Vt.getBinError=function(Nn){if(Nn<0||Nn>=this.fNcells)return 0;const zn=this.fArray[Nn],dr=this.fBinEntries[Nn],tr=this.fSumw2[Nn],ws=this.getBinEffectiveEntries(Nn);if(dr<1e-300)return 0;if(3===this.fErrorMode)return 1/Math.sqrt(dr);const ks=Math.sqrt(Math.abs(tr/dr-(zn/dr)**2));return 2===this.fErrorMode?0!==ks?ks/Math.sqrt(ws):1/Math.sqrt(12*ws):1===this.fErrorMode?ks:ks/Math.sqrt(ws)}),pn===Fn&&(Vt.GetBinLowEdge=function(Nn){return this.fNbins<=0?0:this.fXbins.length>0&&Nn>0&&Nn<=this.fNbins?this.fXbins[Nn-1]:this.fXmin+(Nn-1)*(this.fXmax-this.fXmin)/this.fNbins},Vt.GetBinCenter=function(Nn){return this.fNbins<=0?0:this.fXbins.length>0&&Nn>0&&Nn<this.fNbins?(this.fXbins[Nn-1]+this.fXbins[Nn])/2:this.fXmin+(Nn-.5)*(this.fXmax-this.fXmin)/this.fNbins}),0===pn.indexOf("ROOT::Math::LorentzVector")&&(Vt.Px=Vt.X=function(){return this.fCoordinates.Px()},Vt.Py=Vt.Y=function(){return this.fCoordinates.Py()},Vt.Pz=Vt.Z=function(){return this.fCoordinates.Pz()},Vt.E=Vt.T=function(){return this.fCoordinates.E()},Vt.M2=function(){return this.fCoordinates.M2()},Vt.M=function(){return this.fCoordinates.M()},Vt.R=Vt.P=function(){return this.fCoordinates.R()},Vt.P2=function(){return this.P()*this.P()},Vt.Pt=Vt.pt=function(){return Math.sqrt(this.P2())},Vt.Phi=Vt.phi=function(){return Math.atan2(this.fCoordinates.Py(),this.fCoordinates.Px())},Vt.Eta=Vt.eta=function(){return Math.atanh(this.Pz()/this.P())}),0===pn.indexOf("ROOT::Math::PxPyPzE4D")&&(Vt.Px=Vt.X=function(){return this.fX},Vt.Py=Vt.Y=function(){return this.fY},Vt.Pz=Vt.Z=function(){return this.fZ},Vt.E=Vt.T=function(){return this.fT},Vt.P2=function(){return this.fX**2+this.fY**2+this.fZ**2},Vt.R=Vt.P=function(){return Math.sqrt(this.P2())},Vt.Mag2=Vt.M2=function(){return this.fT**2-this.fX**2-this.fY**2-this.fZ**2},Vt.Mag=Vt.M=function(){return this.M2()>=0?Math.sqrt(this.M2()):-Math.sqrt(-this.M2())},Vt.Perp2=Vt.Pt2=function(){return this.fX**2+this.fY**2},Vt.Pt=Vt.pt=function(){return Math.sqrt(this.P2())},Vt.Phi=Vt.phi=function(){return Math.atan2(this.fY,this.fX)},Vt.Eta=Vt.eta=function(){return Math.atanh(this.Pz/this.P())}),Tn[pn]=Vt),Vt}function Xn(pn,Hn){Tn[pn]=Hn}function Ri(pn,Hn){if(Wi(pn)){if(pn.$kind===De||pn.$kind===$)return!0;Hn||(Hn=pn._typename)}return Hn===De||Hn===Xe||Hn===ct||Hn===$||Hn===tt}function Wi(pn){return pn&&"object"==typeof pn}function Ti(pn){return"function"==typeof pn}function Tr(pn){return"string"==typeof pn}function Qr(pn){return Wi(pn)&&Ti(pn.then)}function yo(pn,Hn){return new Promise(Vt=>{setTimeout(()=>{const Gi=Ti(pn)?pn():pn;Vt(Gi)},Hn)})}function Go(pn){return Qr(pn)?pn:Promise.resolve(pn)}function _s(){return Ls.apply(this,arguments)}function Ls(){return(Ls=(0,be.A)(function*(){return(globalThis.JSROOT?Promise.resolve(!0):x(Ke+"scripts/JSRoot.core.js")).then(()=>{if(globalThis.JSROOT?._complete_loading)return globalThis.JSROOT._complete_loading()}).then(()=>globalThis.JSROOT)})).apply(this,arguments)}ce.fXaxis=$e(vn),ce.fYaxis=$e(vn),ce.fZaxis=$e(vn)},3324:(Gr,xt,Te)=>{"use strict";function v(_,q,ye){_.prototype=q.prototype=ye,ye.constructor=_}function V(_,q){var ye=Object.create(_.prototype);for(var we in q)ye[we]=q[we];return ye}function Le(){}Te.d(xt,{$E:()=>gu,DC:()=>h_,D_:()=>Lp,F6:()=>qt,JL:()=>Lv,JQ:()=>Nt,Lt:()=>hd,Qh:()=>b,Wn:()=>Rm,ZE:()=>i_,aL:()=>d_,aX:()=>gf,m4:()=>Bl,w7:()=>Gy,yW:()=>D});var Je=1/.7,st="\\s*([+-]?\\d+)\\s*",Ke="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ot="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Re=/^#([0-9a-f]{3,8})$/,Qe=new RegExp(`^rgb\\(${st},${st},${st}\\)$`),Ie=new RegExp(`^rgb\\(${ot},${ot},${ot}\\)$`),L=new RegExp(`^rgba\\(${st},${st},${st},${Ke}\\)$`),he=new RegExp(`^rgba\\(${ot},${ot},${ot},${Ke}\\)$`),re=new RegExp(`^hsl\\(${Ke},${ot},${ot}\\)$`),fe=new RegExp(`^hsla\\(${Ke},${ot},${ot},${Ke}\\)$`),de={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function pe(){return this.rgb().formatHex()}function G(){return this.rgb().formatRgb()}function D(_){var q,ye;return _=(_+"").trim().toLowerCase(),(q=Re.exec(_))?(ye=q[1].length,q=parseInt(q[1],16),6===ye?x(q):3===ye?new g(q>>8&15|q>>4&240,q>>4&15|240&q,(15&q)<<4|15&q,1):8===ye?P(q>>24&255,q>>16&255,q>>8&255,(255&q)/255):4===ye?P(q>>12&15|q>>8&240,q>>8&15|q>>4&240,q>>4&15|240&q,((15&q)<<4|15&q)/255):null):(q=Qe.exec(_))?new g(q[1],q[2],q[3],1):(q=Ie.exec(_))?new g(255*q[1]/100,255*q[2]/100,255*q[3]/100,1):(q=L.exec(_))?P(q[1],q[2],q[3],q[4]):(q=he.exec(_))?P(255*q[1]/100,255*q[2]/100,255*q[3]/100,q[4]):(q=re.exec(_))?z(q[1],q[2]/100,q[3]/100,1):(q=fe.exec(_))?z(q[1],q[2]/100,q[3]/100,q[4]):de.hasOwnProperty(_)?x(de[_]):"transparent"===_?new g(NaN,NaN,NaN,0):null}function x(_){return new g(_>>16&255,_>>8&255,255&_,1)}function P(_,q,ye,we){return we<=0&&(_=q=ye=NaN),new g(_,q,ye,we)}function w(_){return _ instanceof Le||(_=D(_)),_?new g((_=_.rgb()).r,_.g,_.b,_.opacity):new g}function b(_,q,ye,we){return 1===arguments.length?w(_):new g(_,q,ye,we??1)}function g(_,q,ye,we){this.r=+_,this.g=+q,this.b=+ye,this.opacity=+we}function C(){return`#${ie(this.r)}${ie(this.g)}${ie(this.b)}`}function O(){const _=H(this.opacity);return`${1===_?"rgb(":"rgba("}${X(this.r)}, ${X(this.g)}, ${X(this.b)}${1===_?")":`, ${_})`}`}function H(_){return isNaN(_)?1:Math.max(0,Math.min(1,_))}function X(_){return Math.max(0,Math.min(255,Math.round(_)||0))}function ie(_){return((_=X(_))<16?"0":"")+_.toString(16)}function z(_,q,ye,we){return we<=0?_=q=ye=NaN:ye<=0||ye>=1?_=q=NaN:q<=0&&(_=NaN),new A(_,q,ye,we)}function m(_){if(_ instanceof A)return new A(_.h,_.s,_.l,_.opacity);if(_ instanceof Le||(_=D(_)),!_)return new A;if(_ instanceof A)return _;var q=(_=_.rgb()).r/255,ye=_.g/255,we=_.b/255,Ze=Math.min(q,ye,we),mt=Math.max(q,ye,we),yt=NaN,It=mt-Ze,$t=(mt+Ze)/2;return It?(yt=q===mt?(ye-we)/It+6*(ye<we):ye===mt?(we-q)/It+2:(q-ye)/It+4,It/=$t<.5?mt+Ze:2-mt-Ze,yt*=60):It=$t>0&&$t<1?0:yt,new A(yt,It,$t,_.opacity)}function A(_,q,ye,we){this.h=+_,this.s=+q,this.l=+ye,this.opacity=+we}function R(_){return(_=(_||0)%360)<0?_+360:_}function k(_){return Math.max(0,Math.min(1,_||0))}function ee(_,q,ye){return 255*(_<60?q+(ye-q)*_/60:_<180?ye:_<240?q+(ye-q)*(240-_)/60:q)}v(Le,D,{copy(_){return Object.assign(new this.constructor,this,_)},displayable(){return this.rgb().displayable()},hex:pe,formatHex:pe,formatHex8:function ce(){return this.rgb().formatHex8()},formatHsl:function K(){return m(this).formatHsl()},formatRgb:G,toString:G}),v(g,b,V(Le,{brighter(_){return _=null==_?Je:Math.pow(Je,_),new g(this.r*_,this.g*_,this.b*_,this.opacity)},darker(_){return _=null==_?.7:Math.pow(.7,_),new g(this.r*_,this.g*_,this.b*_,this.opacity)},rgb(){return this},clamp(){return new g(X(this.r),X(this.g),X(this.b),H(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:C,formatHex:C,formatHex8:function N(){return`#${ie(this.r)}${ie(this.g)}${ie(this.b)}${ie(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:O,toString:O})),v(A,function I(_,q,ye,we){return 1===arguments.length?m(_):new A(_,q,ye,we??1)},V(Le,{brighter(_){return _=null==_?Je:Math.pow(Je,_),new A(this.h,this.s,this.l*_,this.opacity)},darker(_){return _=null==_?.7:Math.pow(.7,_),new A(this.h,this.s,this.l*_,this.opacity)},rgb(){var _=this.h%360+360*(this.h<0),q=isNaN(_)||isNaN(this.s)?0:this.s,ye=this.l,we=ye+(ye<.5?ye:1-ye)*q,Ze=2*ye-we;return new g(ee(_>=240?_-240:_+120,Ze,we),ee(_,Ze,we),ee(_<120?_+240:_-120,Ze,we),this.opacity)},clamp(){return new A(R(this.h),k(this.s),k(this.l),H(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const _=H(this.opacity);return`${1===_?"hsl(":"hsla("}${R(this.h)}, ${100*k(this.s)}%, ${100*k(this.l)}%${1===_?")":`, ${_})`}`}}));const ge=Math.PI/180,ve=180/Math.PI,De=.96422,Xe=1,ct=.82521,$=4/29,tt=6/29,We=3*tt*tt,Ne=tt*tt*tt;function Fe(_){if(_ instanceof dt)return new dt(_.l,_.a,_.b,_.opacity);if(_ instanceof mn)return jt(_);_ instanceof g||(_=w(_));var mt,yt,q=kt(_.r),ye=kt(_.g),we=kt(_.b),Ze=rt((.2225045*q+.7168786*ye+.0606169*we)/Xe);return q===ye&&ye===we?mt=yt=Ze:(mt=rt((.4360747*q+.3850649*ye+.1430804*we)/De),yt=rt((.0139322*q+.0971045*ye+.7141733*we)/ct)),new dt(116*Ze-16,500*(mt-Ze),200*(Ze-yt),_.opacity)}function dt(_,q,ye,we){this.l=+_,this.a=+q,this.b=+ye,this.opacity=+we}function rt(_){return _>Ne?Math.pow(_,1/3):_/We+$}function _t(_){return _>tt?_*_*_:We*(_-$)}function Yt(_){return 255*(_<=.0031308?12.92*_:1.055*Math.pow(_,1/2.4)-.055)}function kt(_){return(_/=255)<=.04045?_/12.92:Math.pow((_+.055)/1.055,2.4)}function mn(_,q,ye,we){this.h=+_,this.c=+q,this.l=+ye,this.opacity=+we}function jt(_){if(isNaN(_.h))return new dt(_.l,0,0,_.opacity);var q=_.h*ge;return new dt(_.l,Math.cos(q)*_.c,Math.sin(q)*_.c,_.opacity)}v(dt,function pt(_,q,ye,we){return 1===arguments.length?Fe(_):new dt(_,q,ye,we??1)},V(Le,{brighter(_){return new dt(this.l+18*(_??1),this.a,this.b,this.opacity)},darker(_){return new dt(this.l-18*(_??1),this.a,this.b,this.opacity)},rgb(){var _=(this.l+16)/116,q=isNaN(this.a)?_:_+this.a/500,ye=isNaN(this.b)?_:_-this.b/200;return new g(Yt(3.1338561*(q=De*_t(q))-1.6168667*(_=Xe*_t(_))-.4906146*(ye=ct*_t(ye))),Yt(-.9787684*q+1.9161415*_+.033454*ye),Yt(.0719453*q-.2289914*_+1.4052427*ye),this.opacity)}})),v(mn,function ln(_,q,ye,we){return 1===arguments.length?function Tt(_){if(_ instanceof mn)return new mn(_.h,_.c,_.l,_.opacity);if(_ instanceof dt||(_=Fe(_)),0===_.a&&0===_.b)return new mn(NaN,0<_.l&&_.l<100?0:NaN,_.l,_.opacity);var q=Math.atan2(_.b,_.a)*ve;return new mn(q<0?q+360:q,Math.sqrt(_.a*_.a+_.b*_.b),_.l,_.opacity)}(_):new mn(_,q,ye,we??1)},V(Le,{brighter(_){return new mn(this.h,this.c,this.l+18*(_??1),this.opacity)},darker(_){return new mn(this.h,this.c,this.l-18*(_??1),this.opacity)},rgb(){return jt(this).rgb()}}));var cn=1.78277,gn=-.29227,Cn=-.90649,Ln=1.97294,Zn=Ln*Cn,ui=Ln*cn,hi=cn*gn- -.14861*Cn;function Sr(_,q,ye,we){this.h=+_,this.s=+q,this.l=+ye,this.opacity=+we}v(Sr,function Mr(_,q,ye,we){return 1===arguments.length?function qi(_){if(_ instanceof Sr)return new Sr(_.h,_.s,_.l,_.opacity);_ instanceof g||(_=w(_));var ye=_.g/255,we=_.b/255,Ze=(hi*we+Zn*(_.r/255)-ui*ye)/(hi+Zn-ui),mt=we-Ze,yt=(Ln*(ye-Ze)-gn*mt)/Cn,It=Math.sqrt(yt*yt+mt*mt)/(Ln*Ze*(1-Ze)),$t=It?Math.atan2(yt,mt)*ve-120:NaN;return new Sr($t<0?$t+360:$t,It,Ze,_.opacity)}(_):new Sr(_,q,ye,we??1)},V(Le,{brighter(_){return _=null==_?Je:Math.pow(Je,_),new Sr(this.h,this.s,this.l*_,this.opacity)},darker(_){return _=null==_?.7:Math.pow(.7,_),new Sr(this.h,this.s,this.l*_,this.opacity)},rgb(){var _=isNaN(this.h)?0:(this.h+120)*ge,q=+this.l,ye=isNaN(this.s)?0:this.s*q*(1-q),we=Math.cos(_),Ze=Math.sin(_);return new g(255*(q+ye*(-.14861*we+cn*Ze)),255*(q+ye*(gn*we+Cn*Ze)),255*(q+ye*(Ln*we)),this.opacity)}}));var ms=Math.abs,fs=Math.cos,wt=Math.sin,W=Math.PI,me=W/2,_e=2*W,Be=Math.max,gt=1e-12;function Et(_,q){return Array.from({length:q-_},(ye,we)=>_+we)}function Nt(){return function dn(_,q){var ye=0,we=null,Ze=null,mt=null;function yt(It){var gr,$t=It.length,Xt=new Array($t),an=Et(0,$t),Qn=new Array($t*$t),Gn=new Array($t),yi=0;It=Float64Array.from({length:$t*$t},q?(Ji,ar)=>It[ar%$t][ar/$t|0]:(Ji,ar)=>It[ar/$t|0][ar%$t]);for(let Ji=0;Ji<$t;++Ji){let ar=0;for(let ls=0;ls<$t;++ls)ar+=It[Ji*$t+ls]+_*It[ls*$t+Ji];yi+=Xt[Ji]=ar}gr=(yi=Be(0,_e-ye*$t)/yi)?ye:_e/$t;{let Ji=0;we&&an.sort((ar,ls)=>we(Xt[ar],Xt[ls]));for(const ar of an){const ls=Ji;if(_){const Io=Et(1+~$t,$t).filter(xr=>xr<0?It[~xr*$t+ar]:It[ar*$t+xr]);Ze&&Io.sort((xr,Ui)=>Ze(xr<0?-It[~xr*$t+ar]:It[ar*$t+xr],Ui<0?-It[~Ui*$t+ar]:It[ar*$t+Ui]));for(const xr of Io)xr<0?(Qn[~xr*$t+ar]||(Qn[~xr*$t+ar]={source:null,target:null})).target={index:ar,startAngle:Ji,endAngle:Ji+=It[~xr*$t+ar]*yi,value:It[~xr*$t+ar]}:(Qn[ar*$t+xr]||(Qn[ar*$t+xr]={source:null,target:null})).source={index:ar,startAngle:Ji,endAngle:Ji+=It[ar*$t+xr]*yi,value:It[ar*$t+xr]};Gn[ar]={index:ar,startAngle:ls,endAngle:Ji,value:Xt[ar]}}else{const Io=Et(0,$t).filter(xr=>It[ar*$t+xr]||It[xr*$t+ar]);Ze&&Io.sort((xr,Ui)=>Ze(It[ar*$t+xr],It[ar*$t+Ui]));for(const xr of Io){let Ui;if(ar<xr?(Ui=Qn[ar*$t+xr]||(Qn[ar*$t+xr]={source:null,target:null}),Ui.source={index:ar,startAngle:Ji,endAngle:Ji+=It[ar*$t+xr]*yi,value:It[ar*$t+xr]}):(Ui=Qn[xr*$t+ar]||(Qn[xr*$t+ar]={source:null,target:null}),Ui.target={index:ar,startAngle:Ji,endAngle:Ji+=It[ar*$t+xr]*yi,value:It[ar*$t+xr]},ar===xr&&(Ui.source=Ui.target)),Ui.source&&Ui.target&&Ui.source.value<Ui.target.value){const zs=Ui.source;Ui.source=Ui.target,Ui.target=zs}}Gn[ar]={index:ar,startAngle:ls,endAngle:Ji,value:Xt[ar]}}Ji+=gr}}return(Qn=Object.values(Qn)).groups=Gn,mt?Qn.sort(mt):Qn}return yt.padAngle=function(It){return arguments.length?(ye=Be(0,It),yt):ye},yt.sortGroups=function(It){return arguments.length?(we=It,yt):we},yt.sortSubgroups=function(It){return arguments.length?(Ze=It,yt):Ze},yt.sortChords=function(It){return arguments.length?(null==It?mt=null:(mt=function Mt(_){return function(q,ye){return _(q.source.value+q.target.value,ye.source.value+ye.target.value)}}(It))._=It,yt):mt&&mt._},yt}(!1,!1)}const vn=Math.PI,Fn=2*vn,ai=1e-6,$n=Fn-ai;function kn(_){this._+=_[0];for(let q=1,ye=_.length;q<ye;++q)this._+=arguments[q]+_[q]}class ei{constructor(q){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==q?kn:function Rn(_){let q=Math.floor(_);if(!(q>=0))throw new Error(`invalid digits: ${_}`);if(q>15)return kn;const ye=10**q;return function(we){this._+=we[0];for(let Ze=1,mt=we.length;Ze<mt;++Ze)this._+=Math.round(arguments[Ze]*ye)/ye+we[Ze]}}(q)}moveTo(q,ye){this._append`M${this._x0=this._x1=+q},${this._y0=this._y1=+ye}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(q,ye){this._append`L${this._x1=+q},${this._y1=+ye}`}quadraticCurveTo(q,ye,we,Ze){this._append`Q${+q},${+ye},${this._x1=+we},${this._y1=+Ze}`}bezierCurveTo(q,ye,we,Ze,mt,yt){this._append`C${+q},${+ye},${+we},${+Ze},${this._x1=+mt},${this._y1=+yt}`}arcTo(q,ye,we,Ze,mt){if(q=+q,ye=+ye,we=+we,Ze=+Ze,(mt=+mt)<0)throw new Error(`negative radius: ${mt}`);let yt=this._x1,It=this._y1,$t=we-q,Xt=Ze-ye,an=yt-q,Qn=It-ye,Gn=an*an+Qn*Qn;if(null===this._x1)this._append`M${this._x1=q},${this._y1=ye}`;else if(Gn>ai)if(Math.abs(Qn*$t-Xt*an)>ai&&mt){let yi=we-yt,gr=Ze-It,Ji=$t*$t+Xt*Xt,ar=yi*yi+gr*gr,ls=Math.sqrt(Ji),Io=Math.sqrt(Gn),xr=mt*Math.tan((vn-Math.acos((Ji+Gn-ar)/(2*ls*Io)))/2),Ui=xr/Io,zs=xr/ls;Math.abs(Ui-1)>ai&&this._append`L${q+Ui*an},${ye+Ui*Qn}`,this._append`A${mt},${mt},0,0,${+(Qn*yi>an*gr)},${this._x1=q+zs*$t},${this._y1=ye+zs*Xt}`}else this._append`L${this._x1=q},${this._y1=ye}`}arc(q,ye,we,Ze,mt,yt){if(q=+q,ye=+ye,yt=!!yt,(we=+we)<0)throw new Error(`negative radius: ${we}`);let It=we*Math.cos(Ze),$t=we*Math.sin(Ze),Xt=q+It,an=ye+$t,Qn=1^yt,Gn=yt?Ze-mt:mt-Ze;null===this._x1?this._append`M${Xt},${an}`:(Math.abs(this._x1-Xt)>ai||Math.abs(this._y1-an)>ai)&&this._append`L${Xt},${an}`,we&&(Gn<0&&(Gn=Gn%Fn+Fn),Gn>$n?this._append`A${we},${we},0,1,${Qn},${q-It},${ye-$t}A${we},${we},0,1,${Qn},${this._x1=Xt},${this._y1=an}`:Gn>ai&&this._append`A${we},${we},0,${+(Gn>=vn)},${Qn},${this._x1=q+we*Math.cos(mt)},${this._y1=ye+we*Math.sin(mt)}`)}rect(q,ye,we,Ze){this._append`M${this._x0=this._x1=+q},${this._y0=this._y1=+ye}h${we=+we}v${+Ze}h${-we}Z`}toString(){return this._}}function Yi(){return new ei}Yi.prototype=ei.prototype;var Ue=Array.prototype.slice;function Y(_){return function(){return _}}function E(_){return _.source}function J(_){return _.target}function Ae(_){return _.radius}function Ce(_){return _.startAngle}function He(_){return _.endAngle}function nt(){return 0}function qt(){return function lt(_){var q=E,ye=J,we=Ae,Ze=Ae,mt=Ce,yt=He,It=nt,$t=null;function Xt(){var an,Qn=q.apply(this,arguments),Gn=ye.apply(this,arguments),yi=It.apply(this,arguments)/2,gr=Ue.call(arguments),Ji=+we.apply(this,(gr[0]=Qn,gr)),ar=mt.apply(this,gr)-me,ls=yt.apply(this,gr)-me,Io=+Ze.apply(this,(gr[0]=Gn,gr)),xr=mt.apply(this,gr)-me,Ui=yt.apply(this,gr)-me;if($t||($t=an=Yi()),yi>gt&&(ms(ls-ar)>2*yi+gt?ls>ar?(ar+=yi,ls-=yi):(ar-=yi,ls+=yi):ar=ls=(ar+ls)/2,ms(Ui-xr)>2*yi+gt?Ui>xr?(xr+=yi,Ui-=yi):(xr-=yi,Ui+=yi):xr=Ui=(xr+Ui)/2),$t.moveTo(Ji*fs(ar),Ji*wt(ar)),$t.arc(0,0,Ji,ar,ls),ar!==xr||ls!==Ui)if(_){var ss=Io-+_.apply(this,arguments),Uo=(xr+Ui)/2;$t.quadraticCurveTo(0,0,ss*fs(xr),ss*wt(xr)),$t.lineTo(Io*fs(Uo),Io*wt(Uo)),$t.lineTo(ss*fs(Ui),ss*wt(Ui))}else $t.quadraticCurveTo(0,0,Io*fs(xr),Io*wt(xr)),$t.arc(0,0,Io,xr,Ui);if($t.quadraticCurveTo(0,0,Ji*fs(ar),Ji*wt(ar)),$t.closePath(),an)return $t=null,an+""||null}return _&&(Xt.headRadius=function(an){return arguments.length?(_="function"==typeof an?an:Y(+an),Xt):_}),Xt.radius=function(an){return arguments.length?(we=Ze="function"==typeof an?an:Y(+an),Xt):we},Xt.sourceRadius=function(an){return arguments.length?(we="function"==typeof an?an:Y(+an),Xt):we},Xt.targetRadius=function(an){return arguments.length?(Ze="function"==typeof an?an:Y(+an),Xt):Ze},Xt.startAngle=function(an){return arguments.length?(mt="function"==typeof an?an:Y(+an),Xt):mt},Xt.endAngle=function(an){return arguments.length?(yt="function"==typeof an?an:Y(+an),Xt):yt},Xt.padAngle=function(an){return arguments.length?(It="function"==typeof an?an:Y(+an),Xt):It},Xt.source=function(an){return arguments.length?(q=an,Xt):q},Xt.target=function(an){return arguments.length?(ye=an,Xt):ye},Xt.context=function(an){return arguments.length?($t=an??null,Xt):$t},Xt}()}var Jt={value:()=>{}};function tn(){for(var we,_=0,q=arguments.length,ye={};_<q;++_){if(!(we=arguments[_]+"")||we in ye||/[\s.]/.test(we))throw new Error("illegal type: "+we);ye[we]=[]}return new An(ye)}function An(_){this._=_}function $e(_,q){for(var Ze,ye=0,we=_.length;ye<we;++ye)if((Ze=_[ye]).name===q)return Ze.value}function ut(_,q,ye){for(var we=0,Ze=_.length;we<Ze;++we)if(_[we].name===q){_[we]=Jt,_=_.slice(0,we).concat(_.slice(we+1));break}return null!=ye&&_.push({name:q,value:ye}),_}An.prototype=tn.prototype={constructor:An,on:function(_,q){var Ze,ye=this._,we=function ze(_,q){return _.trim().split(/^|\s+/).map(function(ye){var we="",Ze=ye.indexOf(".");if(Ze>=0&&(we=ye.slice(Ze+1),ye=ye.slice(0,Ze)),ye&&!q.hasOwnProperty(ye))throw new Error("unknown type: "+ye);return{type:ye,name:we}})}(_+"",ye),mt=-1,yt=we.length;if(!(arguments.length<2)){if(null!=q&&"function"!=typeof q)throw new Error("invalid callback: "+q);for(;++mt<yt;)if(Ze=(_=we[mt]).type)ye[Ze]=ut(ye[Ze],_.name,q);else if(null==q)for(Ze in ye)ye[Ze]=ut(ye[Ze],_.name,null);return this}for(;++mt<yt;)if((Ze=(_=we[mt]).type)&&(Ze=$e(ye[Ze],_.name)))return Ze},copy:function(){var _={},q=this._;for(var ye in q)_[ye]=q[ye].slice();return new An(_)},call:function(_,q){if((Ze=arguments.length-2)>0)for(var Ze,mt,ye=new Array(Ze),we=0;we<Ze;++we)ye[we]=arguments[we+2];if(!this._.hasOwnProperty(_))throw new Error("unknown type: "+_);for(we=0,Ze=(mt=this._[_]).length;we<Ze;++we)mt[we].value.apply(q,ye)},apply:function(_,q,ye){if(!this._.hasOwnProperty(_))throw new Error("unknown type: "+_);for(var we=this._[_],Ze=0,mt=we.length;Ze<mt;++Ze)we[Ze].value.apply(q,ye)}};var bt="http://www.w3.org/1999/xhtml",Ot={svg:"http://www.w3.org/2000/svg",xhtml:bt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function _n(_){var q=_+="",ye=q.indexOf(":");return ye>=0&&"xmlns"!==(q=_.slice(0,ye))&&(_=_.slice(ye+1)),Ot.hasOwnProperty(q)?{space:Ot[q],local:_}:_}function en(_){return function(){var q=this.ownerDocument,ye=this.namespaceURI;return ye===bt&&q.documentElement.namespaceURI===bt?q.createElement(_):q.createElementNS(ye,_)}}function rn(_){return function(){return this.ownerDocument.createElementNS(_.space,_.local)}}function Tn(_){var q=_n(_);return(q.local?rn:en)(q)}function In(){}function Xn(_){return null==_?In:function(){return this.querySelector(_)}}function Ti(){return[]}function Tr(_){return null==_?Ti:function(){return this.querySelectorAll(_)}}function Go(_){return function(){return this.matches(_)}}function _s(_){return function(q){return q.matches(_)}}var Ls=Array.prototype.find;function Hn(){return this.firstElementChild}var Gi=Array.prototype.filter;function Nn(){return Array.from(this.children)}function ws(_){return new Array(_.length)}function bs(_,q){this.ownerDocument=_.ownerDocument,this.namespaceURI=_.namespaceURI,this._next=null,this._parent=_,this.__data__=q}function Zo(_,q,ye,we,Ze,mt){for(var It,yt=0,$t=q.length,Xt=mt.length;yt<Xt;++yt)(It=q[yt])?(It.__data__=mt[yt],we[yt]=It):ye[yt]=new bs(_,mt[yt]);for(;yt<$t;++yt)(It=q[yt])&&(Ze[yt]=It)}function Va(_,q,ye,we,Ze,mt,yt){var It,$t,yi,Xt=new Map,an=q.length,Qn=mt.length,Gn=new Array(an);for(It=0;It<an;++It)($t=q[It])&&(Gn[It]=yi=yt.call($t,$t.__data__,It,q)+"",Xt.has(yi)?Ze[It]=$t:Xt.set(yi,$t));for(It=0;It<Qn;++It)yi=yt.call(_,mt[It],It,mt)+"",($t=Xt.get(yi))?(we[It]=$t,$t.__data__=mt[It],Xt.delete(yi)):ye[It]=new bs(_,mt[It]);for(It=0;It<an;++It)($t=q[It])&&Xt.get(Gn[It])===$t&&(Ze[It]=$t)}function Th(_){return _.__data__}function cd(_){return"object"==typeof _&&"length"in _?_:Array.from(_)}function Yc(_,q){return _<q?-1:_>q?1:_>=q?0:NaN}function No(_){return function(){this.removeAttribute(_)}}function nf(_){return function(){this.removeAttributeNS(_.space,_.local)}}function Yf(_,q){return function(){this.setAttribute(_,q)}}function Fp(_,q){return function(){this.setAttributeNS(_.space,_.local,q)}}function _y(_,q){return function(){var ye=q.apply(this,arguments);null==ye?this.removeAttribute(_):this.setAttribute(_,ye)}}function AM(_,q){return function(){var ye=q.apply(this,arguments);null==ye?this.removeAttributeNS(_.space,_.local):this.setAttributeNS(_.space,_.local,ye)}}function qg(_){return _.ownerDocument&&_.ownerDocument.defaultView||_.document&&_||_.defaultView}function q0(_){return function(){this.style.removeProperty(_)}}function Ux(_,q,ye){return function(){this.style.setProperty(_,q,ye)}}function gM(_,q,ye){return function(){var we=q.apply(this,arguments);null==we?this.style.removeProperty(_):this.style.setProperty(_,we,ye)}}function rf(_,q){return _.style.getPropertyValue(q)||qg(_).getComputedStyle(_,null).getPropertyValue(q)}function yy(_){return function(){delete this[_]}}function zx(_,q){return function(){this[_]=q}}function _M(_,q){return function(){var ye=q.apply(this,arguments);null==ye?delete this[_]:this[_]=ye}}function Q0(_){return _.trim().split(/^|\s+/)}function j0(_){return _.classList||new by(_)}function by(_){this._node=_,this._names=Q0(_.getAttribute("class")||"")}function xy(_,q){for(var ye=j0(_),we=-1,Ze=q.length;++we<Ze;)ye.add(q[we])}function PA(_,q){for(var ye=j0(_),we=-1,Ze=q.length;++we<Ze;)ye.remove(q[we])}function yv(_){return function(){xy(this,_)}}function Hx(_){return function(){PA(this,_)}}function vv(_,q){return function(){(q.apply(this,arguments)?xy:PA)(this,_)}}function Op(){this.textContent=""}function Gx(_){return function(){this.textContent=_}}function yM(_){return function(){var q=_.apply(this,arguments);this.textContent=q??""}}function vM(){this.innerHTML=""}function Qx(_){return function(){this.innerHTML=_}}function bM(_){return function(){var q=_.apply(this,arguments);this.innerHTML=q??""}}function Wx(){this.nextSibling&&this.parentNode.appendChild(this)}function W0(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Zf(){return null}function Gc(){var _=this.parentNode;_&&_.removeChild(this)}function sf(){var _=this.cloneNode(!1),q=this.parentNode;return q?q.insertBefore(_,this.nextSibling):_}function ju(){var _=this.cloneNode(!0),q=this.parentNode;return q?q.insertBefore(_,this.nextSibling):_}function Cy(_){return function(){var q=this.__on;if(q){for(var mt,ye=0,we=-1,Ze=q.length;ye<Ze;++ye)mt=q[ye],_.type&&mt.type!==_.type||mt.name!==_.name?q[++we]=mt:this.removeEventListener(mt.type,mt.listener,mt.options);++we?q.length=we:delete this.__on}}}function cc(_,q,ye){return function(){var Ze,we=this.__on,mt=function Sd(_){return function(q){_.call(this,q,this.__data__)}}(q);if(we)for(var yt=0,It=we.length;yt<It;++yt)if((Ze=we[yt]).type===_.type&&Ze.name===_.name)return this.removeEventListener(Ze.type,Ze.listener,Ze.options),this.addEventListener(Ze.type,Ze.listener=mt,Ze.options=ye),void(Ze.value=q);this.addEventListener(_.type,mt,ye),Ze={type:_.type,name:_.name,value:q,listener:mt,options:ye},we?we.push(Ze):this.__on=[Ze]}}function af(_,q,ye){var we=qg(_),Ze=we.CustomEvent;"function"==typeof Ze?Ze=new Ze(q,ye):(Ze=we.document.createEvent("Event"),ye?(Ze.initEvent(q,ye.bubbles,ye.cancelable),Ze.detail=ye.detail):Ze.initEvent(q,!1,!1)),_.dispatchEvent(Ze)}function RA(_,q){return function(){return af(this,_,q)}}function rl(_,q){return function(){return af(this,_,q.apply(this,arguments))}}bs.prototype={constructor:bs,appendChild:function(_){return this._parent.insertBefore(_,this._next)},insertBefore:function(_,q){return this._parent.insertBefore(_,q)},querySelector:function(_){return this._parent.querySelector(_)},querySelectorAll:function(_){return this._parent.querySelectorAll(_)}},by.prototype={add:function(_){this._names.indexOf(_)<0&&(this._names.push(_),this._node.setAttribute("class",this._names.join(" ")))},remove:function(_){var q=this._names.indexOf(_);q>=0&&(this._names.splice(q,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(_){return this._names.indexOf(_)>=0}};var ep=[null];function qc(_,q){this._groups=_,this._parents=q}function lf(){return new qc([[document.documentElement]],ep)}function hd(_){return"string"==typeof _?new qc([[document.querySelector(_)]],[document.documentElement]):new qc([[_]],ep)}qc.prototype=lf.prototype={constructor:qc,select:function Ri(_){"function"!=typeof _&&(_=Xn(_));for(var q=this._groups,ye=q.length,we=new Array(ye),Ze=0;Ze<ye;++Ze)for(var $t,Xt,mt=q[Ze],yt=mt.length,It=we[Ze]=new Array(yt),an=0;an<yt;++an)($t=mt[an])&&(Xt=_.call($t,$t.__data__,an,mt))&&("__data__"in $t&&(Xt.__data__=$t.__data__),It[an]=Xt);return new qc(we,this._parents)},selectAll:function yo(_){_="function"==typeof _?function Qr(_){return function(){return function Wi(_){return null==_?[]:Array.isArray(_)?_:Array.from(_)}(_.apply(this,arguments))}}(_):Tr(_);for(var q=this._groups,ye=q.length,we=[],Ze=[],mt=0;mt<ye;++mt)for(var $t,yt=q[mt],It=yt.length,Xt=0;Xt<It;++Xt)($t=yt[Xt])&&(we.push(_.call($t,$t.__data__,Xt,yt)),Ze.push($t));return new qc(we,Ze)},selectChild:function Vt(_){return this.select(null==_?Hn:function pn(_){return function(){return Ls.call(this.children,_)}}("function"==typeof _?_:_s(_)))},selectChildren:function dr(_){return this.selectAll(null==_?Nn:function zn(_){return function(){return Gi.call(this.children,_)}}("function"==typeof _?_:_s(_)))},filter:function tr(_){"function"!=typeof _&&(_=Go(_));for(var q=this._groups,ye=q.length,we=new Array(ye),Ze=0;Ze<ye;++Ze)for(var $t,mt=q[Ze],yt=mt.length,It=we[Ze]=[],Xt=0;Xt<yt;++Xt)($t=mt[Xt])&&_.call($t,$t.__data__,Xt,mt)&&It.push($t);return new qc(we,this._parents)},data:function Vu(_,q){if(!arguments.length)return Array.from(this,Th);var ye=q?Va:Zo,we=this._parents,Ze=this._groups;"function"!=typeof _&&(_=function ks(_){return function(){return _}}(_));for(var mt=Ze.length,yt=new Array(mt),It=new Array(mt),$t=new Array(mt),Xt=0;Xt<mt;++Xt){var an=we[Xt],Qn=Ze[Xt],Gn=Qn.length,yi=cd(_.call(an,an&&an.__data__,Xt,we)),gr=yi.length,Ji=It[Xt]=new Array(gr),ar=yt[Xt]=new Array(gr);ye(an,Qn,Ji,ar,$t[Xt]=new Array(Gn),yi,q);for(var Ui,zs,Io=0,xr=0;Io<gr;++Io)if(Ui=Ji[Io]){for(Io>=xr&&(xr=Io+1);!(zs=ar[xr])&&++xr<gr;);Ui._next=zs||null}}return(yt=new qc(yt,we))._enter=It,yt._exit=$t,yt},enter:function jr(){return new qc(this._enter||this._groups.map(ws),this._parents)},exit:function Da(){return new qc(this._exit||this._groups.map(ws),this._parents)},join:function Aa(_,q,ye){var we=this.enter(),Ze=this,mt=this.exit();return"function"==typeof _?(we=_(we))&&(we=we.selection()):we=we.append(_+""),null!=q&&(Ze=q(Ze))&&(Ze=Ze.selection()),null==ye?mt.remove():ye(mt),we&&Ze?we.merge(Ze).order():Ze},merge:function Gu(_){for(var q=_.selection?_.selection():_,ye=this._groups,we=q._groups,Ze=ye.length,yt=Math.min(Ze,we.length),It=new Array(Ze),$t=0;$t<yt;++$t)for(var yi,Xt=ye[$t],an=we[$t],Qn=Xt.length,Gn=It[$t]=new Array(Qn),gr=0;gr<Qn;++gr)(yi=Xt[gr]||an[gr])&&(Gn[gr]=yi);for(;$t<Ze;++$t)It[$t]=ye[$t];return new qc(It,this._parents)},selection:function My(){return this},order:function bc(){for(var _=this._groups,q=-1,ye=_.length;++q<ye;)for(var yt,we=_[q],Ze=we.length-1,mt=we[Ze];--Ze>=0;)(yt=we[Ze])&&(mt&&4^yt.compareDocumentPosition(mt)&&mt.parentNode.insertBefore(yt,mt),mt=yt);return this},sort:function lc(_){function q(Qn,Gn){return Qn&&Gn?_(Qn.__data__,Gn.__data__):!Qn-!Gn}_||(_=Yc);for(var ye=this._groups,we=ye.length,Ze=new Array(we),mt=0;mt<we;++mt){for(var Xt,yt=ye[mt],It=yt.length,$t=Ze[mt]=new Array(It),an=0;an<It;++an)(Xt=yt[an])&&($t[an]=Xt);$t.sort(q)}return new qc(Ze,this._parents).order()},call:function Xa(){var _=arguments[0];return arguments[0]=this,_.apply(null,arguments),this},nodes:function fh(){return Array.from(this)},node:function qu(){for(var _=this._groups,q=0,ye=_.length;q<ye;++q)for(var we=_[q],Ze=0,mt=we.length;Ze<mt;++Ze){var yt=we[Ze];if(yt)return yt}return null},size:function ph(){let _=0;for(const q of this)++_;return _},empty:function Md(){return!this.node()},each:function Ga(_){for(var q=this._groups,ye=0,we=q.length;ye<we;++ye)for(var It,Ze=q[ye],mt=0,yt=Ze.length;mt<yt;++mt)(It=Ze[mt])&&_.call(It,It.__data__,mt,Ze);return this},attr:function G0(_,q){var ye=_n(_);if(arguments.length<2){var we=this.node();return ye.local?we.getAttributeNS(ye.space,ye.local):we.getAttribute(ye)}return this.each((null==q?ye.local?nf:No:"function"==typeof q?ye.local?AM:_y:ye.local?Fp:Yf)(ye,q))},style:function Kf(_,q,ye){return arguments.length>1?this.each((null==q?q0:"function"==typeof q?gM:Ux)(_,q,ye??"")):rf(this.node(),_)},property:function vy(_,q){return arguments.length>1?this.each((null==q?yy:"function"==typeof q?_M:zx)(_,q)):this.node()[_]},classed:function Vx(_,q){var ye=Q0(_+"");if(arguments.length<2){for(var we=j0(this.node()),Ze=-1,mt=ye.length;++Ze<mt;)if(!we.contains(ye[Ze]))return!1;return!0}return this.each(("function"==typeof q?vv:q?yv:Hx)(ye,q))},text:function qx(_){return arguments.length?this.each(null==_?Op:("function"==typeof _?yM:Gx)(_)):this.node().textContent},html:function jx(_){return arguments.length?this.each(null==_?vM:("function"==typeof _?bM:Qx)(_)):this.node().innerHTML},raise:function wy(){return this.each(Wx)},lower:function Ed(){return this.each(W0)},append:function Qu(_){var q="function"==typeof _?_:Tn(_);return this.select(function(){return this.appendChild(q.apply(this,arguments))})},insert:function Ca(_,q){var ye="function"==typeof _?_:Tn(_),we=null==q?Zf:"function"==typeof q?q:Xn(q);return this.select(function(){return this.insertBefore(ye.apply(this,arguments),we.apply(this,arguments)||null)})},remove:function Qg(){return this.each(Gc)},clone:function Ul(_){return this.select(_?ju:sf)},datum:function Yl(_){return arguments.length?this.property("__data__",_):this.node().__data__},on:function $0(_,q,ye){var Ze,yt,we=function xc(_){return _.trim().split(/^|\s+/).map(function(q){var ye="",we=q.indexOf(".");return we>=0&&(ye=q.slice(we+1),q=q.slice(0,we)),{type:q,name:ye}})}(_+""),mt=we.length;if(!(arguments.length<2)){for(It=q?cc:Cy,Ze=0;Ze<mt;++Ze)this.each(It(we[Ze],q,ye));return this}var It=this.node().__on;if(It)for(var an,$t=0,Xt=It.length;$t<Xt;++$t)for(Ze=0,an=It[$t];Ze<mt;++Ze)if((yt=we[Ze]).type===an.type&&yt.name===an.name)return an.value},dispatch:function xi(_,q){return this.each(("function"==typeof q?rl:RA)(_,q))},[Symbol.iterator]:function*Jf(){for(var _=this._groups,q=0,ye=_.length;q<ye;++q)for(var yt,we=_[q],Ze=0,mt=we.length;Ze<mt;++Ze)(yt=we[Ze])&&(yield yt)}};var Kc=0;function Jo(){this._="@"+(++Kc).toString(36)}function co(_){let q;for(;q=_.sourceEvent;)_=q;return _}function Rm(_,q){if(_=co(_),void 0===q&&(q=_.currentTarget),q){var ye=q.ownerSVGElement||q;if(ye.createSVGPoint){var we=ye.createSVGPoint();return we.x=_.clientX,we.y=_.clientY,[(we=we.matrixTransform(q.getScreenCTM().inverse())).x,we.y]}if(q.getBoundingClientRect){var Ze=q.getBoundingClientRect();return[_.clientX-Ze.left-q.clientLeft,_.clientY-Ze.top-q.clientTop]}}return[_.pageX,_.pageY]}function Lp(_,q){return _.target&&(_=co(_),void 0===q&&(q=_.currentTarget),_=_.touches||[_]),Array.from(_,ye=>Rm(ye,q))}Jo.prototype=function Hh(){return new Jo}.prototype={constructor:Jo,get:function(_){for(var q=this._;!(q in _);)if(!(_=_.parentNode))return;return _[q]},set:function(_,q){return _[this._]=q},remove:function(_){return this._ in _&&delete _[this._]},toString:function(){return this._}};const Cs={passive:!1},km={capture:!0,passive:!1};function Np(_){_.stopImmediatePropagation()}function qo(_){_.preventDefault(),_.stopImmediatePropagation()}var cf=_=>()=>_;function jg(_,{sourceEvent:q,subject:ye,target:we,identifier:Ze,active:mt,x:yt,y:It,dx:$t,dy:Xt,dispatch:an}){Object.defineProperties(this,{type:{value:_,enumerable:!0,configurable:!0},sourceEvent:{value:q,enumerable:!0,configurable:!0},subject:{value:ye,enumerable:!0,configurable:!0},target:{value:we,enumerable:!0,configurable:!0},identifier:{value:Ze,enumerable:!0,configurable:!0},active:{value:mt,enumerable:!0,configurable:!0},x:{value:yt,enumerable:!0,configurable:!0},y:{value:It,enumerable:!0,configurable:!0},dx:{value:$t,enumerable:!0,configurable:!0},dy:{value:Xt,enumerable:!0,configurable:!0},_:{value:an}})}function Ey(_){return!_.ctrlKey&&!_.button}function Ma(){return this.parentNode}function Us(_,q){return q??{x:_.x,y:_.y}}function tp(){return navigator.maxTouchPoints||"ontouchstart"in this}function gu(){var It,$t,Xt,an,_=Ey,q=Ma,ye=Us,we=tp,Ze={},mt=tn("start","drag","end"),yt=0,Qn=0;function Gn(Ui){Ui.on("mousedown.drag",yi).filter(we).on("touchstart.drag",ar).on("touchmove.drag",ls,Cs).on("touchend.drag touchcancel.drag",Io).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function yi(Ui,zs){if(!an&&_.call(this,Ui,zs)){var ss=xr(this,q.call(this,Ui,zs),Ui,zs,"mouse");ss&&(hd(Ui.view).on("mousemove.drag",gr,km).on("mouseup.drag",Ji,km),function Fm(_){var q=_.document.documentElement,ye=hd(_).on("dragstart.drag",qo,km);"onselectstart"in q?ye.on("selectstart.drag",qo,km):(q.__noselect=q.style.MozUserSelect,q.style.MozUserSelect="none")}(Ui.view),Np(Ui),Xt=!1,It=Ui.clientX,$t=Ui.clientY,ss("start",Ui))}}function gr(Ui){if(qo(Ui),!Xt){var zs=Ui.clientX-It,ss=Ui.clientY-$t;Xt=zs*zs+ss*ss>Qn}Ze.mouse("drag",Ui)}function Ji(Ui){hd(Ui.view).on("mousemove.drag mouseup.drag",null),function zl(_,q){var ye=_.document.documentElement,we=hd(_).on("dragstart.drag",null);q&&(we.on("click.drag",qo,km),setTimeout(function(){we.on("click.drag",null)},0)),"onselectstart"in ye?we.on("selectstart.drag",null):(ye.style.MozUserSelect=ye.__noselect,delete ye.__noselect)}(Ui.view,Xt),qo(Ui),Ze.mouse("end",Ui)}function ar(Ui,zs){if(_.call(this,Ui,zs)){var fc,pc,ss=Ui.changedTouches,Uo=q.call(this,Ui,zs),xl=ss.length;for(fc=0;fc<xl;++fc)(pc=xr(this,Uo,Ui,zs,ss[fc].identifier,ss[fc]))&&(Np(Ui),pc("start",Ui,ss[fc]))}}function ls(Ui){var Uo,xl,zs=Ui.changedTouches,ss=zs.length;for(Uo=0;Uo<ss;++Uo)(xl=Ze[zs[Uo].identifier])&&(qo(Ui),xl("drag",Ui,zs[Uo]))}function Io(Ui){var Uo,xl,zs=Ui.changedTouches,ss=zs.length;for(an&&clearTimeout(an),an=setTimeout(function(){an=null},500),Uo=0;Uo<ss;++Uo)(xl=Ze[zs[Uo].identifier])&&(Np(Ui),xl("end",Ui,zs[Uo]))}function xr(Ui,zs,ss,Uo,xl,fc){var ic,Ws,ea,pc=mt.copy(),Dr=Rm(fc||ss,zs);if(null!=(ea=ye.call(Ui,new jg("beforestart",{sourceEvent:ss,target:Gn,identifier:xl,active:yt,x:Dr[0],y:Dr[1],dx:0,dy:0,dispatch:pc}),Uo)))return ic=ea.x-Dr[0]||0,Ws=ea.y-Dr[1]||0,function Su(Ju,Ah,tu){var bp,mc=Dr;switch(Ju){case"start":Ze[xl]=Su,bp=yt++;break;case"end":delete Ze[xl],--yt;case"drag":Dr=Rm(tu||Ah,zs),bp=yt}pc.call(Ju,Ui,new jg(Ju,{sourceEvent:Ah,subject:ea,target:Gn,identifier:xl,active:bp,x:Dr[0]+ic,y:Dr[1]+Ws,dx:Dr[0]-mc[0],dy:Dr[1]-mc[1],dispatch:pc}),Uo)}}return Gn.filter=function(Ui){return arguments.length?(_="function"==typeof Ui?Ui:cf(!!Ui),Gn):_},Gn.container=function(Ui){return arguments.length?(q="function"==typeof Ui?Ui:cf(Ui),Gn):q},Gn.subject=function(Ui){return arguments.length?(ye="function"==typeof Ui?Ui:cf(Ui),Gn):ye},Gn.touchable=function(Ui){return arguments.length?(we="function"==typeof Ui?Ui:cf(!!Ui),Gn):we},Gn.on=function(){var Ui=mt.on.apply(mt,arguments);return Ui===mt?Gn:Ui},Gn.clickDistance=function(Ui){return arguments.length?(Qn=(Ui=+Ui)*Ui,Gn):Math.sqrt(Qn)},Gn}function Ia(_,q){return null==_||null==q?NaN:_<q?-1:_>q?1:_>=q?0:NaN}function hf(_,q){return null==_||null==q?NaN:q<_?-1:q>_?1:q>=_?0:NaN}function Wg(_){let q,ye,we;function Ze(It,$t,Xt=0,an=It.length){if(Xt<an){if(0!==q($t,$t))return an;do{const Qn=Xt+an>>>1;ye(It[Qn],$t)<0?Xt=Qn+1:an=Qn}while(Xt<an)}return Xt}return 2!==_.length?(q=Ia,ye=(It,$t)=>Ia(_(It),$t),we=(It,$t)=>_(It)-$t):(q=_===Ia||_===hf?_:Vh,ye=_,we=_),{left:Ze,center:function yt(It,$t,Xt=0,an=It.length){const Qn=Ze(It,$t,Xt,an-1);return Qn>Xt&&we(It[Qn-1],$t)>-we(It[Qn],$t)?Qn-1:Qn},right:function mt(It,$t,Xt=0,an=It.length){if(Xt<an){if(0!==q($t,$t))return an;do{const Qn=Xt+an>>>1;ye(It[Qn],$t)<=0?Xt=Qn+1:an=Qn}while(Xt<an)}return Xt}}}function Vh(){return 0}jg.prototype.on=function(){var _=this._.on.apply(this._,arguments);return _===this._?this:_};const Y0=Wg(Ia).right;Wg(function X0(_){return null===_?NaN:+_});var Om=Y0;Map;const Sy=Math.sqrt(50),io=Math.sqrt(10),Dh=Math.sqrt(2);function $i(_,q,ye){const we=(q-_)/Math.max(0,ye),Ze=Math.floor(Math.log10(we)),mt=we/Math.pow(10,Ze),yt=mt>=Sy?10:mt>=io?5:mt>=Dh?2:1;let It,$t,Xt;return Ze<0?(Xt=Math.pow(10,-Ze)/yt,It=Math.round(_*Xt),$t=Math.round(q*Xt),It/Xt<_&&++It,$t/Xt>q&&--$t,Xt=-Xt):(Xt=Math.pow(10,Ze)*yt,It=Math.round(_/Xt),$t=Math.round(q/Xt),It*Xt<_&&++It,$t*Xt>q&&--$t),$t<It&&.5<=ye&&ye<2?$i(_,q,2*ye):[It,$t,Xt]}function Mn(_,q,ye){if(!((ye=+ye)>0))return[];if((_=+_)==(q=+q))return[_];const we=q<_,[Ze,mt,yt]=we?$i(q,_,ye):$i(_,q,ye);if(!(mt>=Ze))return[];const It=mt-Ze+1,$t=new Array(It);if(we)if(yt<0)for(let Xt=0;Xt<It;++Xt)$t[Xt]=(mt-Xt)/-yt;else for(let Xt=0;Xt<It;++Xt)$t[Xt]=(mt-Xt)*yt;else if(yt<0)for(let Xt=0;Xt<It;++Xt)$t[Xt]=(Ze+Xt)/-yt;else for(let Xt=0;Xt<It;++Xt)$t[Xt]=(Ze+Xt)*yt;return $t}function oa(_,q,ye){return $i(_=+_,q=+q,ye=+ye)[2]}function zp(_,q,ye){ye=+ye;const we=(q=+q)<(_=+_),Ze=we?oa(q,_,ye):oa(_,q,ye);return(we?-1:1)*(Ze<0?1/-Ze:Ze)}function Rc(_,q){switch(arguments.length){case 0:break;case 1:this.range(_);break;default:this.range(q).domain(_)}return this}Symbol("implicit");var Gp=_=>()=>_;function Qc(_,q){var ye=q-_;return ye?function Xx(_,q){return function(ye){return _+ye*q}}(_,ye):Gp(isNaN(_)?q:_)}var rp=function _(q){var ye=function Ty(_){return 1==(_=+_)?Qc:function(q,ye){return ye-q?function $g(_,q,ye){return _=Math.pow(_,ye),q=Math.pow(q,ye)-_,ye=1/ye,function(we){return Math.pow(_+we*q,ye)}}(q,ye,_):Gp(isNaN(q)?ye:q)}}(q);function we(Ze,mt){var yt=ye((Ze=b(Ze)).r,(mt=b(mt)).r),It=ye(Ze.g,mt.g),$t=ye(Ze.b,mt.b),Xt=Qc(Ze.opacity,mt.opacity);return function(an){return Ze.r=yt(an),Ze.g=It(an),Ze.b=$t(an),Ze.opacity=Xt(an),Ze+""}}return we.gamma=_,we}(1);function FA(_,q){q||(q=[]);var Ze,ye=_?Math.min(q.length,_.length):0,we=q.slice();return function(mt){for(Ze=0;Ze<ye;++Ze)we[Ze]=_[Ze]*(1-mt)+q[Ze]*mt;return we}}function Dd(_,q){var yt,ye=q?q.length:0,we=_?Math.min(ye,_.length):0,Ze=new Array(we),mt=new Array(ye);for(yt=0;yt<we;++yt)Ze[yt]=yu(_[yt],q[yt]);for(;yt<ye;++yt)mt[yt]=q[yt];return function(It){for(yt=0;yt<we;++yt)mt[yt]=Ze[yt](It);return mt}}function sp(_,q){var ye=new Date;return _=+_,q=+q,function(we){return ye.setTime(_*(1-we)+q*we),ye}}function Kl(_,q){return _=+_,q=+q,function(ye){return _*(1-ye)+q*ye}}function ff(_,q){var Ze,ye={},we={};for(Ze in(null===_||"object"!=typeof _)&&(_={}),(null===q||"object"!=typeof q)&&(q={}),q)Ze in _?ye[Ze]=yu(_[Ze],q[Ze]):we[Ze]=q[Ze];return function(mt){for(Ze in ye)we[Ze]=ye[Ze](mt);return we}}var mo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,uo=new RegExp(mo.source,"g");function Iy(_,q){var we,Ze,mt,ye=mo.lastIndex=uo.lastIndex=0,yt=-1,It=[],$t=[];for(_+="",q+="";(we=mo.exec(_))&&(Ze=uo.exec(q));)(mt=Ze.index)>ye&&(mt=q.slice(ye,mt),It[yt]?It[yt]+=mt:It[++yt]=mt),(we=we[0])===(Ze=Ze[0])?It[yt]?It[yt]+=Ze:It[++yt]=Ze:(It[++yt]=null,$t.push({i:yt,x:Kl(we,Ze)})),ye=uo.lastIndex;return ye<q.length&&(mt=q.slice(ye),It[yt]?It[yt]+=mt:It[++yt]=mt),It.length<2?$t[0]?function Dy(_){return function(q){return _(q)+""}}($t[0].x):function $o(_){return function(){return _}}(q):(q=$t.length,function(Xt){for(var Qn,an=0;an<q;++an)It[(Qn=$t[an]).i]=Qn.x(Xt);return It.join("")})}function yu(_,q){var we,ye=typeof q;return null==q||"boolean"===ye?Gp(q):("number"===ye?Kl:"string"===ye?(we=D(q))?(q=we,rp):Iy:q instanceof D?rp:q instanceof Date?sp:function K0(_){return ArrayBuffer.isView(_)&&!(_ instanceof DataView)}(q)?FA:Array.isArray(q)?Dd:"function"!=typeof q.valueOf&&"function"!=typeof q.toString||isNaN(q)?ff:Kl)(_,q)}function Um(_,q){return _=+_,q=+q,function(ye){return Math.round(_*(1-ye)+q*ye)}}var Zc,qh=180/Math.PI,zm={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Xo(_,q,ye,we,Ze,mt){var yt,It,$t;return(yt=Math.sqrt(_*_+q*q))&&(_/=yt,q/=yt),($t=_*ye+q*we)&&(ye-=_*$t,we-=q*$t),(It=Math.sqrt(ye*ye+we*we))&&(ye/=It,we/=It,$t/=It),_*we<q*ye&&(_=-_,q=-q,$t=-$t,yt=-yt),{translateX:Ze,translateY:mt,rotate:Math.atan2(q,_)*qh,skewX:Math.atan($t)*qh,scaleX:yt,scaleY:It}}function op(_,q,ye,we){function Ze(Xt){return Xt.length?Xt.pop()+" ":""}return function(Xt,an){var Qn=[],Gn=[];return Xt=_(Xt),an=_(an),function mt(Xt,an,Qn,Gn,yi,gr){if(Xt!==Qn||an!==Gn){var Ji=yi.push("translate(",null,q,null,ye);gr.push({i:Ji-4,x:Kl(Xt,Qn)},{i:Ji-2,x:Kl(an,Gn)})}else(Qn||Gn)&&yi.push("translate("+Qn+q+Gn+ye)}(Xt.translateX,Xt.translateY,an.translateX,an.translateY,Qn,Gn),function yt(Xt,an,Qn,Gn){Xt!==an?(Xt-an>180?an+=360:an-Xt>180&&(Xt+=360),Gn.push({i:Qn.push(Ze(Qn)+"rotate(",null,we)-2,x:Kl(Xt,an)})):an&&Qn.push(Ze(Qn)+"rotate("+an+we)}(Xt.rotate,an.rotate,Qn,Gn),function It(Xt,an,Qn,Gn){Xt!==an?Gn.push({i:Qn.push(Ze(Qn)+"skewX(",null,we)-2,x:Kl(Xt,an)}):an&&Qn.push(Ze(Qn)+"skewX("+an+we)}(Xt.skewX,an.skewX,Qn,Gn),function $t(Xt,an,Qn,Gn,yi,gr){if(Xt!==Qn||an!==Gn){var Ji=yi.push(Ze(yi)+"scale(",null,",",null,")");gr.push({i:Ji-4,x:Kl(Xt,Qn)},{i:Ji-2,x:Kl(an,Gn)})}else(1!==Qn||1!==Gn)&&yi.push(Ze(yi)+"scale("+Qn+","+Gn+")")}(Xt.scaleX,Xt.scaleY,an.scaleX,an.scaleY,Qn,Gn),Xt=an=null,function(yi){for(var ar,gr=-1,Ji=Gn.length;++gr<Ji;)Qn[(ar=Gn[gr]).i]=ar.x(yi);return Qn.join("")}}}var xM=op(function By(_){const q=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(_+"");return q.isIdentity?zm:Xo(q.a,q.b,q.c,q.d,q.e,q.f)},"px, ","px)","deg)"),wM=op(function sl(_){return null!=_&&(Zc||(Zc=document.createElementNS("http://www.w3.org/2000/svg","g")),Zc.setAttribute("transform",_),_=Zc.transform.baseVal.consolidate())?Xo((_=_.matrix).a,_.b,_.c,_.d,_.e,_.f):zm},", ",")",")");function tl(_){return+_}var xv=[0,1];function Qh(_){return _}function Py(_,q){return(q-=_=+_)?function(ye){return(ye-_)/q}:function pf(_){return function(){return _}}(isNaN(q)?NaN:.5)}function qp(_,q,ye){var we=_[0],Ze=_[1],mt=q[0],yt=q[1];return Ze<we?(we=Py(Ze,we),mt=ye(yt,mt)):(we=Py(we,Ze),mt=ye(mt,yt)),function(It){return mt(we(It))}}function Yx(_,q,ye){var we=Math.min(_.length,q.length)-1,Ze=new Array(we),mt=new Array(we),yt=-1;for(_[we]<_[0]&&(_=_.slice().reverse(),q=q.slice().reverse());++yt<we;)Ze[yt]=Py(_[yt],_[yt+1]),mt[yt]=ye(q[yt],q[yt+1]);return function(It){var $t=Om(_,It,1,we)-1;return mt[$t](Ze[$t](It))}}function vu(_,q){return q.domain(_.domain()).range(_.range()).interpolate(_.interpolate()).clamp(_.clamp()).unknown(_.unknown())}function Z0(){var we,Ze,mt,It,$t,Xt,_=xv,q=xv,ye=yu,yt=Qh;function an(){var Gn=Math.min(_.length,q.length);return yt!==Qh&&(yt=function wv(_,q){var ye;return _>q&&(ye=_,_=q,q=ye),function(we){return Math.max(_,Math.min(q,we))}}(_[0],_[Gn-1])),It=Gn>2?Yx:qp,$t=Xt=null,Qn}function Qn(Gn){return null==Gn||isNaN(Gn=+Gn)?mt:($t||($t=It(_.map(we),q,ye)))(we(yt(Gn)))}return Qn.invert=function(Gn){return yt(Ze((Xt||(Xt=It(q,_.map(we),Kl)))(Gn)))},Qn.domain=function(Gn){return arguments.length?(_=Array.from(Gn,tl),an()):_.slice()},Qn.range=function(Gn){return arguments.length?(q=Array.from(Gn),an()):q.slice()},Qn.rangeRound=function(Gn){return q=Array.from(Gn),ye=Um,an()},Qn.clamp=function(Gn){return arguments.length?(yt=!!Gn||Qh,an()):yt!==Qh},Qn.interpolate=function(Gn){return arguments.length?(ye=Gn,an()):ye},Qn.unknown=function(Gn){return arguments.length?(mt=Gn,Qn):mt},function(Gn,yi){return we=Gn,Ze=yi,an()}}function Wn(){return Z0()(Qh,Qh)}function oi(_,q){if((ye=(_=q?_.toExponential(q-1):_.toExponential()).indexOf("e"))<0)return null;var ye,we=_.slice(0,ye);return[we.length>1?we[0]+we.slice(2):we,+_.slice(ye+1)]}function kc(_){return(_=oi(Math.abs(_)))?_[1]:NaN}var xu,Ry=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function bu(_){if(!(q=Ry.exec(_)))throw new Error("invalid format: "+_);var q;return new dd({fill:q[1],align:q[2],sign:q[3],symbol:q[4],zero:q[5],width:q[6],comma:q[7],precision:q[8]&&q[8].slice(1),trim:q[9],type:q[10]})}function dd(_){this.fill=void 0===_.fill?" ":_.fill+"",this.align=void 0===_.align?">":_.align+"",this.sign=void 0===_.sign?"-":_.sign+"",this.symbol=void 0===_.symbol?"":_.symbol+"",this.zero=!!_.zero,this.width=void 0===_.width?void 0:+_.width,this.comma=!!_.comma,this.precision=void 0===_.precision?void 0:+_.precision,this.trim=!!_.trim,this.type=void 0===_.type?"":_.type+""}function Hm(_,q){var ye=oi(_,q);if(!ye)return _+"";var we=ye[0],Ze=ye[1];return Ze<0?"0."+new Array(-Ze).join("0")+we:we.length>Ze+1?we.slice(0,Ze+1)+"."+we.slice(Ze+1):we+new Array(Ze-we.length+2).join("0")}bu.prototype=dd.prototype,dd.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var e_={"%":(_,q)=>(100*_).toFixed(q),b:_=>Math.round(_).toString(2),c:_=>_+"",d:function J0(_){return Math.abs(_=Math.round(_))>=1e21?_.toLocaleString("en").replace(/,/g,""):_.toString(10)},e:(_,q)=>_.toExponential(q),f:(_,q)=>_.toFixed(q),g:(_,q)=>_.toPrecision(q),o:_=>Math.round(_).toString(8),p:(_,q)=>Hm(100*_,q),r:Hm,s:function Cv(_,q){var ye=oi(_,q);if(!ye)return _+"";var we=ye[0],Ze=ye[1],mt=Ze-(xu=3*Math.max(-8,Math.min(8,Math.floor(Ze/3))))+1,yt=we.length;return mt===yt?we:mt>yt?we+new Array(mt-yt+1).join("0"):mt>0?we.slice(0,mt)+"."+we.slice(mt):"0."+new Array(1-mt).join("0")+oi(_,Math.max(0,q+mt-1))[0]},X:_=>Math.round(_).toString(16).toUpperCase(),x:_=>Math.round(_).toString(16)};function mf(_){return _}var Qp,Al,Vl,t_=Array.prototype.map,Ih=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function jh(_){var q=_.domain;return _.ticks=function(ye){var we=q();return Mn(we[0],we[we.length-1],ye??10)},_.tickFormat=function(ye,we){var Ze=q();return function gl(_,q,ye,we){var mt,Ze=zp(_,q,ye);switch((we=bu(we??",f")).type){case"s":var yt=Math.max(Math.abs(_),Math.abs(q));return null==we.precision&&!isNaN(mt=function Yg(_,q){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(kc(q)/3)))-kc(Math.abs(_)))}(Ze,yt))&&(we.precision=mt),Vl(we,yt);case"":case"e":case"g":case"p":case"r":null==we.precision&&!isNaN(mt=function NA(_,q){return _=Math.abs(_),q=Math.abs(q)-_,Math.max(0,kc(q)-kc(_))+1}(Ze,Math.max(Math.abs(_),Math.abs(q))))&&(we.precision=mt-("e"===we.type));break;case"f":case"%":null==we.precision&&!isNaN(mt=function fd(_){return Math.max(0,-kc(Math.abs(_)))}(Ze))&&(we.precision=mt-2*("%"===we.type))}return Al(we)}(Ze[0],Ze[Ze.length-1],ye??10,we)},_.nice=function(ye){null==ye&&(ye=10);var $t,Xt,we=q(),Ze=0,mt=we.length-1,yt=we[Ze],It=we[mt],an=10;for(It<yt&&(Xt=yt,yt=It,It=Xt,Xt=Ze,Ze=mt,mt=Xt);an-- >0;){if((Xt=oa(yt,It,ye))===$t)return we[Ze]=yt,we[mt]=It,q(we);if(Xt>0)yt=Math.floor(yt/Xt)*Xt,It=Math.ceil(It/Xt)*Xt;else{if(!(Xt<0))break;yt=Math.ceil(yt*Xt)/Xt,It=Math.floor(It*Xt)/Xt}$t=Xt}return _},_}function Bl(){var _=Wn();return _.copy=function(){return vu(_,Bl())},Rc.apply(_,arguments),jh(_)}function Af(_,q){var yt,ye=0,we=(_=_.slice()).length-1,Ze=_[ye],mt=_[we];return mt<Ze&&(yt=ye,ye=we,we=yt,yt=Ze,Ze=mt,mt=yt),_[ye]=q.floor(Ze),_[we]=q.ceil(mt),_}function Bh(_){return Math.log(_)}function Ba(_){return Math.exp(_)}function _l(_){return-Math.log(-_)}function is(_){return-Math.exp(-_)}function Jc(_){return isFinite(_)?+("1e"+_):_<0?0:_}function Zl(_){return(q,ye)=>-_(-q,ye)}function i_(){const _=function Id(_){const q=_(Bh,Ba),ye=q.domain;let Ze,mt,we=10;function yt(){return Ze=function jp(_){return _===Math.E?Math.log:10===_&&Math.log10||2===_&&Math.log2||(_=Math.log(_),q=>Math.log(q)/_)}(we),mt=function Kg(_){return 10===_?Jc:_===Math.E?Math.exp:q=>Math.pow(_,q)}(we),ye()[0]<0?(Ze=Zl(Ze),mt=Zl(mt),_(_l,is)):_(Bh,Ba),q}return q.base=function(It){return arguments.length?(we=+It,yt()):we},q.domain=function(It){return arguments.length?(ye(It),yt()):ye()},q.ticks=It=>{const $t=ye();let Xt=$t[0],an=$t[$t.length-1];const Qn=an<Xt;Qn&&([Xt,an]=[an,Xt]);let gr,Ji,Gn=Ze(Xt),yi=Ze(an);const ar=null==It?10:+It;let ls=[];if(!(we%1)&&yi-Gn<ar){if(Gn=Math.floor(Gn),yi=Math.ceil(yi),Xt>0){for(;Gn<=yi;++Gn)for(gr=1;gr<we;++gr)if(Ji=Gn<0?gr/mt(-Gn):gr*mt(Gn),!(Ji<Xt)){if(Ji>an)break;ls.push(Ji)}}else for(;Gn<=yi;++Gn)for(gr=we-1;gr>=1;--gr)if(Ji=Gn>0?gr/mt(-Gn):gr*mt(Gn),!(Ji<Xt)){if(Ji>an)break;ls.push(Ji)}2*ls.length<ar&&(ls=Mn(Xt,an,ar))}else ls=Mn(Gn,yi,Math.min(yi-Gn,ar)).map(mt);return Qn?ls.reverse():ls},q.tickFormat=(It,$t)=>{if(null==It&&(It=10),null==$t&&($t=10===we?"s":","),"function"!=typeof $t&&(!(we%1)&&null==($t=bu($t)).precision&&($t.trim=!0),$t=Al($t)),It===1/0)return $t;const Xt=Math.max(1,we*It/q.ticks().length);return an=>{let Qn=an/mt(Math.round(Ze(an)));return Qn*we<we-.5&&(Qn*=we),Qn<=Xt?$t(an):""}},q.nice=()=>ye(Af(ye(),{floor:It=>mt(Math.floor(Ze(It))),ceil:It=>mt(Math.ceil(Ze(It)))})),q}(Z0()).domain([1,10]);return _.copy=()=>vu(_,i_()).base(_.base()),Rc.apply(_,arguments),_}function jc(_){return function(q){return Math.sign(q)*Math.log1p(Math.abs(q/_))}}function Wh(_){return function(q){return Math.sign(q)*Math.expm1(Math.abs(q))*_}}function gf(){var _=function Gm(_){var q=1,ye=_(jc(q),Wh(q));return ye.constant=function(we){return arguments.length?_(jc(q=+we),Wh(q)):q},jh(ye)}(Z0());return _.copy=function(){return vu(_,gf()).constant(_.constant())},Rc.apply(_,arguments)}!function n_(_){Qp=function Vm(_){var q=void 0===_.grouping||void 0===_.thousands?mf:function OA(_,q){return function(ye,we){for(var Ze=ye.length,mt=[],yt=0,It=_[0],$t=0;Ze>0&&It>0&&($t+It+1>we&&(It=Math.max(1,we-$t)),mt.push(ye.substring(Ze-=It,Ze+It)),!(($t+=It+1)>we));)It=_[yt=(yt+1)%_.length];return mt.reverse().join(q)}}(t_.call(_.grouping,Number),_.thousands+""),ye=void 0===_.currency?"":_.currency[0]+"",we=void 0===_.currency?"":_.currency[1]+"",Ze=void 0===_.decimal?".":_.decimal+"",mt=void 0===_.numerals?mf:function LA(_){return function(q){return q.replace(/[0-9]/g,function(ye){return _[+ye]})}}(t_.call(_.numerals,String)),yt=void 0===_.percent?"%":_.percent+"",It=void 0===_.minus?"\u2212":_.minus+"",$t=void 0===_.nan?"NaN":_.nan+"";function Xt(Qn){var Gn=(Qn=bu(Qn)).fill,yi=Qn.align,gr=Qn.sign,Ji=Qn.symbol,ar=Qn.zero,ls=Qn.width,Io=Qn.comma,xr=Qn.precision,Ui=Qn.trim,zs=Qn.type;"n"===zs?(Io=!0,zs="g"):e_[zs]||(void 0===xr&&(xr=12),Ui=!0,zs="g"),(ar||"0"===Gn&&"="===yi)&&(ar=!0,Gn="0",yi="=");var ss="$"===Ji?ye:"#"===Ji&&/[boxX]/.test(zs)?"0"+zs.toLowerCase():"",Uo="$"===Ji?we:/[%p]/.test(zs)?yt:"",xl=e_[zs],fc=/[defgprs%]/.test(zs);function pc(Dr){var ea,Su,Ju,ic=ss,Ws=Uo;if("c"===zs)Ws=xl(Dr)+Ws,Dr="";else{var Ah=(Dr=+Dr)<0||1/Dr<0;if(Dr=isNaN(Dr)?$t:xl(Math.abs(Dr),xr),Ui&&(Dr=function Xg(_){e:for(var Ze,q=_.length,ye=1,we=-1;ye<q;++ye)switch(_[ye]){case".":we=Ze=ye;break;case"0":0===we&&(we=ye),Ze=ye;break;default:if(!+_[ye])break e;we>0&&(we=0)}return we>0?_.slice(0,we)+_.slice(Ze+1):_}(Dr)),Ah&&0==+Dr&&"+"!==gr&&(Ah=!1),ic=(Ah?"("===gr?gr:It:"-"===gr||"("===gr?"":gr)+ic,Ws=("s"===zs?Ih[8+xu/3]:"")+Ws+(Ah&&"("===gr?")":""),fc)for(ea=-1,Su=Dr.length;++ea<Su;)if(48>(Ju=Dr.charCodeAt(ea))||Ju>57){Ws=(46===Ju?Ze+Dr.slice(ea+1):Dr.slice(ea))+Ws,Dr=Dr.slice(0,ea);break}}Io&&!ar&&(Dr=q(Dr,1/0));var tu=ic.length+Dr.length+Ws.length,mc=tu<ls?new Array(ls-tu+1).join(Gn):"";switch(Io&&ar&&(Dr=q(mc+Dr,mc.length?ls-Ws.length:1/0),mc=""),yi){case"<":Dr=ic+Dr+Ws+mc;break;case"=":Dr=ic+mc+Dr+Ws;break;case"^":Dr=mc.slice(0,tu=mc.length>>1)+ic+Dr+Ws+mc.slice(tu);break;default:Dr=mc+ic+Dr+Ws}return mt(Dr)}return xr=void 0===xr?6:/[gprs]/.test(zs)?Math.max(1,Math.min(21,xr)):Math.max(0,Math.min(20,xr)),pc.toString=function(){return Qn+""},pc}return{format:Xt,formatPrefix:function an(Qn,Gn){var yi=Xt(((Qn=bu(Qn)).type="f",Qn)),gr=3*Math.max(-8,Math.min(8,Math.floor(kc(Gn)/3))),Ji=Math.pow(10,-gr),ar=Ih[8+gr/3];return function(ls){return yi(Ji*ls)+ar}}}}(_),Al=Qp.format,Vl=Qp.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});const zA=new Date,Wm=new Date;function hc(_,q,ye,we){function Ze(mt){return _(mt=0===arguments.length?new Date:new Date(+mt)),mt}return Ze.floor=mt=>(_(mt=new Date(+mt)),mt),Ze.ceil=mt=>(_(mt=new Date(mt-1)),q(mt,1),_(mt),mt),Ze.round=mt=>{const yt=Ze(mt),It=Ze.ceil(mt);return mt-yt<It-mt?yt:It},Ze.offset=(mt,yt)=>(q(mt=new Date(+mt),null==yt?1:Math.floor(yt)),mt),Ze.range=(mt,yt,It)=>{const $t=[];if(mt=Ze.ceil(mt),It=null==It?1:Math.floor(It),!(mt<yt&&It>0))return $t;let Xt;do{$t.push(Xt=new Date(+mt)),q(mt,It),_(mt)}while(Xt<mt&&mt<yt);return $t},Ze.filter=mt=>hc(yt=>{if(yt>=yt)for(;_(yt),!mt(yt);)yt.setTime(yt-1)},(yt,It)=>{if(yt>=yt)if(It<0)for(;++It<=0;)for(;q(yt,-1),!mt(yt););else for(;--It>=0;)for(;q(yt,1),!mt(yt););}),ye&&(Ze.count=(mt,yt)=>(zA.setTime(+mt),Wm.setTime(+yt),_(zA),_(Wm),Math.floor(ye(zA,Wm))),Ze.every=mt=>(mt=Math.floor(mt),isFinite(mt)&&mt>0?mt>1?Ze.filter(we?yt=>we(yt)%mt==0:yt=>Ze.count(0,yt)%mt==0):Ze:null)),Ze}const Ph=hc(()=>{},(_,q)=>{_.setTime(+_+q)},(_,q)=>q-_);Ph.every=_=>(_=Math.floor(_),isFinite(_)&&_>0?_>1?hc(q=>{q.setTime(Math.floor(q/_)*_)},(q,ye)=>{q.setTime(+q+ye*_)},(q,ye)=>(ye-q)/_):Ph:null);const $h=1e3,wr=6e4,Rh=60*wr,$u=24*Rh,ua=7*$u,ap=30*$u,mr=365*$u,yl=hc(_=>{_.setTime(_-_.getMilliseconds())},(_,q)=>{_.setTime(+_+q*$h)},(_,q)=>(q-_)/$h,_=>_.getUTCSeconds()),Ro=hc(_=>{_.setTime(_-_.getMilliseconds()-_.getSeconds()*$h)},(_,q)=>{_.setTime(+_+q*wr)},(_,q)=>(q-_)/wr,_=>_.getMinutes()),vl=hc(_=>{_.setUTCSeconds(0,0)},(_,q)=>{_.setTime(+_+q*wr)},(_,q)=>(q-_)/wr,_=>_.getUTCMinutes()),Gl=hc(_=>{_.setTime(_-_.getMilliseconds()-_.getSeconds()*$h-_.getMinutes()*wr)},(_,q)=>{_.setTime(+_+q*Rh)},(_,q)=>(q-_)/Rh,_=>_.getHours()),Xh=hc(_=>{_.setUTCMinutes(0,0,0)},(_,q)=>{_.setTime(+_+q*Rh)},(_,q)=>(q-_)/Rh,_=>_.getUTCHours()),ql=hc(_=>_.setHours(0,0,0,0),(_,q)=>_.setDate(_.getDate()+q),(_,q)=>(q-_-(q.getTimezoneOffset()-_.getTimezoneOffset())*wr)/$u,_=>_.getDate()-1),$p=hc(_=>{_.setUTCHours(0,0,0,0)},(_,q)=>{_.setUTCDate(_.getUTCDate()+q)},(_,q)=>(q-_)/$u,_=>_.getUTCDate()-1),$m=hc(_=>{_.setUTCHours(0,0,0,0)},(_,q)=>{_.setUTCDate(_.getUTCDate()+q)},(_,q)=>(q-_)/$u,_=>Math.floor(_/$u));function wu(_){return hc(q=>{q.setDate(q.getDate()-(q.getDay()+7-_)%7),q.setHours(0,0,0,0)},(q,ye)=>{q.setDate(q.getDate()+7*ye)},(q,ye)=>(ye-q-(ye.getTimezoneOffset()-q.getTimezoneOffset())*wr)/ua)}const lp=wu(0),cp=wu(1),Cu=(wu(2),wu(3),wu(4));function Xm(_){return hc(q=>{q.setUTCDate(q.getUTCDate()-(q.getUTCDay()+7-_)%7),q.setUTCHours(0,0,0,0)},(q,ye)=>{q.setUTCDate(q.getUTCDate()+7*ye)},(q,ye)=>(ye-q)/ua)}wu(5),wu(6);const eh=Xm(0),Ym=Xm(1),Xp=(Xm(2),Xm(3),Xm(4)),HA=(Xm(5),Xm(6),hc(_=>{_.setDate(1),_.setHours(0,0,0,0)},(_,q)=>{_.setMonth(_.getMonth()+q)},(_,q)=>q.getMonth()-_.getMonth()+12*(q.getFullYear()-_.getFullYear()),_=>_.getMonth())),Km=hc(_=>{_.setUTCDate(1),_.setUTCHours(0,0,0,0)},(_,q)=>{_.setUTCMonth(_.getUTCMonth()+q)},(_,q)=>q.getUTCMonth()-_.getUTCMonth()+12*(q.getUTCFullYear()-_.getUTCFullYear()),_=>_.getUTCMonth()),yf=hc(_=>{_.setMonth(0,1),_.setHours(0,0,0,0)},(_,q)=>{_.setFullYear(_.getFullYear()+q)},(_,q)=>q.getFullYear()-_.getFullYear(),_=>_.getFullYear());yf.every=_=>isFinite(_=Math.floor(_))&&_>0?hc(q=>{q.setFullYear(Math.floor(q.getFullYear()/_)*_),q.setMonth(0,1),q.setHours(0,0,0,0)},(q,ye)=>{q.setFullYear(q.getFullYear()+ye*_)}):null;const md=hc(_=>{_.setUTCMonth(0,1),_.setUTCHours(0,0,0,0)},(_,q)=>{_.setUTCFullYear(_.getUTCFullYear()+q)},(_,q)=>q.getUTCFullYear()-_.getUTCFullYear(),_=>_.getUTCFullYear());function Zm(_,q,ye,we,Ze,mt){const yt=[[yl,1,$h],[yl,5,5e3],[yl,15,15e3],[yl,30,3e4],[mt,1,wr],[mt,5,5*wr],[mt,15,15*wr],[mt,30,30*wr],[Ze,1,Rh],[Ze,3,3*Rh],[Ze,6,6*Rh],[Ze,12,12*Rh],[we,1,$u],[we,2,2*$u],[ye,1,ua],[q,1,ap],[q,3,3*ap],[_,1,mr]];function $t(Xt,an,Qn){const Gn=Math.abs(an-Xt)/Qn,yi=Wg(([,,ar])=>ar).right(yt,Gn);if(yi===yt.length)return _.every(zp(Xt/mr,an/mr,Qn));if(0===yi)return Ph.every(Math.max(zp(Xt,an,Qn),1));const[gr,Ji]=yt[Gn/yt[yi-1][2]<yt[yi][2]/Gn?yi-1:yi];return gr.every(Ji)}return[function It(Xt,an,Qn){const Gn=an<Xt;Gn&&([Xt,an]=[an,Xt]);const yi=Qn&&"function"==typeof Qn.range?Qn:$t(Xt,an,Qn),gr=yi?yi.range(Xt,+an+1):[];return Gn?gr.reverse():gr},$t]}md.every=_=>isFinite(_=Math.floor(_))&&_>0?hc(q=>{q.setUTCFullYear(Math.floor(q.getUTCFullYear()/_)*_),q.setUTCMonth(0,1),q.setUTCHours(0,0,0,0)},(q,ye)=>{q.setUTCFullYear(q.getUTCFullYear()+ye*_)}):null;const[th,hp]=Zm(md,Km,eh,$m,Xh,vl),[Jg,nh]=Zm(yf,HA,lp,ql,Gl,Ro);function Kp(_){if(0<=_.y&&_.y<100){var q=new Date(-1,_.m,_.d,_.H,_.M,_.S,_.L);return q.setFullYear(_.y),q}return new Date(_.y,_.m,_.d,_.H,_.M,_.S,_.L)}function e0(_){if(0<=_.y&&_.y<100){var q=new Date(Date.UTC(-1,_.m,_.d,_.H,_.M,_.S,_.L));return q.setUTCFullYear(_.y),q}return new Date(Date.UTC(_.y,_.m,_.d,_.H,_.M,_.S,_.L))}function kd(_,q,ye){return{y:_,m:q,d:ye,H:0,M:0,S:0,L:0}}var iA,h_,d_,Pv,t0={"-":"",_:" ",0:"0"},Wc=/^\s*\d+/,s_=/^%/,Fd=/[\\^$*+?|[\]().{}]/g;function Na(_,q,ye){var we=_<0?"-":"",Ze=(we?-_:_)+"",mt=Ze.length;return we+(mt<ye?new Array(ye-mt+1).join(q)+Ze:Ze)}function o_(_){return _.replace(Fd,"\\$&")}function Od(_){return new RegExp("^(?:"+_.map(o_).join("|")+")","i")}function VA(_){return new Map(_.map((q,ye)=>[q.toLowerCase(),ye]))}function Ev(_,q,ye){var we=Wc.exec(q.slice(ye,ye+1));return we?(_.w=+we[0],ye+we[0].length):-1}function Mc(_,q,ye){var we=Wc.exec(q.slice(ye,ye+1));return we?(_.u=+we[0],ye+we[0].length):-1}function a_(_,q,ye){var we=Wc.exec(q.slice(ye,ye+2));return we?(_.U=+we[0],ye+we[0].length):-1}function Uy(_,q,ye){var we=Wc.exec(q.slice(ye,ye+2));return we?(_.V=+we[0],ye+we[0].length):-1}function Jm(_,q,ye){var we=Wc.exec(q.slice(ye,ye+2));return we?(_.W=+we[0],ye+we[0].length):-1}function n0(_,q,ye){var we=Wc.exec(q.slice(ye,ye+4));return we?(_.y=+we[0],ye+we[0].length):-1}function zy(_,q,ye){var we=Wc.exec(q.slice(ye,ye+2));return we?(_.y=+we[0]+(+we[0]>68?1900:2e3),ye+we[0].length):-1}function Sv(_,q,ye){var we=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(q.slice(ye,ye+6));return we?(_.Z=we[1]?0:-(we[2]+(we[3]||"00")),ye+we[0].length):-1}function Tv(_,q,ye){var we=Wc.exec(q.slice(ye,ye+1));return we?(_.q=3*we[0]-3,ye+we[0].length):-1}function Dv(_,q,ye){var we=Wc.exec(q.slice(ye,ye+2));return we?(_.m=we[0]-1,ye+we[0].length):-1}function GA(_,q,ye){var we=Wc.exec(q.slice(ye,ye+2));return we?(_.d=+we[0],ye+we[0].length):-1}function eA(_,q,ye){var we=Wc.exec(q.slice(ye,ye+3));return we?(_.m=0,_.d=+we[0],ye+we[0].length):-1}function qA(_,q,ye){var we=Wc.exec(q.slice(ye,ye+2));return we?(_.H=+we[0],ye+we[0].length):-1}function Ml(_,q,ye){var we=Wc.exec(q.slice(ye,ye+2));return we?(_.M=+we[0],ye+we[0].length):-1}function vr(_,q,ye){var we=Wc.exec(q.slice(ye,ye+2));return we?(_.S=+we[0],ye+we[0].length):-1}function Ys(_,q,ye){var we=Wc.exec(q.slice(ye,ye+3));return we?(_.L=+we[0],ye+we[0].length):-1}function uc(_,q,ye){var we=Wc.exec(q.slice(ye,ye+6));return we?(_.L=Math.floor(we[0]/1e3),ye+we[0].length):-1}function Xu(_,q,ye){var we=s_.exec(q.slice(ye,ye+1));return we?ye+we[0].length:-1}function ih(_,q,ye){var we=Wc.exec(q.slice(ye));return we?(_.Q=+we[0],ye+we[0].length):-1}function $c(_,q,ye){var we=Wc.exec(q.slice(ye));return we?(_.s=+we[0],ye+we[0].length):-1}function up(_,q){return Na(_.getDate(),q,2)}function hl(_,q){return Na(_.getHours(),q,2)}function Ec(_,q){return Na(_.getHours()%12||12,q,2)}function Ld(_,q){return Na(1+ql.count(yf(_),_),q,3)}function _o(_,q){return Na(_.getMilliseconds(),q,3)}function Nd(_,q){return _o(_,q)+"000"}function r0(_,q){return Na(_.getMonth()+1,q,2)}function vf(_,q){return Na(_.getMinutes(),q,2)}function Pl(_,q){return Na(_.getSeconds(),q,2)}function Zp(_){var q=_.getDay();return 0===q?7:q}function tA(_,q){return Na(lp.count(yf(_)-1,_),q,2)}function Ud(_){var q=_.getDay();return q>=4||0===q?Cu(_):Cu.ceil(_)}function Jp(_,q){return _=Ud(_),Na(Cu.count(yf(_),_)+(4===yf(_).getDay()),q,2)}function s0(_){return _.getDay()}function bf(_,q){return Na(cp.count(yf(_)-1,_),q,2)}function QA(_,q){return Na(_.getFullYear()%100,q,2)}function Yh(_,q){return Na((_=Ud(_)).getFullYear()%100,q,2)}function Fs(_,q){return Na(_.getFullYear()%1e4,q,4)}function o0(_,q){var ye=_.getDay();return Na((_=ye>=4||0===ye?Cu(_):Cu.ceil(_)).getFullYear()%1e4,q,4)}function jA(_){var q=_.getTimezoneOffset();return(q>0?"-":(q*=-1,"+"))+Na(q/60|0,"0",2)+Na(q%60,"0",2)}function Kh(_,q){return Na(_.getUTCDate(),q,2)}function em(_,q){return Na(_.getUTCHours(),q,2)}function tm(_,q){return Na(_.getUTCHours()%12||12,q,2)}function ec(_,q){return Na(1+$p.count(md(_),_),q,3)}function WA(_,q){return Na(_.getUTCMilliseconds(),q,3)}function Sc(_,q){return WA(_,q)+"000"}function rh(_,q){return Na(_.getUTCMonth()+1,q,2)}function l_(_,q){return Na(_.getUTCMinutes(),q,2)}function nm(_,q){return Na(_.getUTCSeconds(),q,2)}function xf(_){var q=_.getUTCDay();return 0===q?7:q}function Yu(_,q){return Na(eh.count(md(_)-1,_),q,2)}function bl(_){var q=_.getUTCDay();return q>=4||0===q?Xp(_):Xp.ceil(_)}function dp(_,q){return _=bl(_),Na(Xp.count(md(_),_)+(4===md(_).getUTCDay()),q,2)}function nA(_){return _.getUTCDay()}function zd(_,q){return Na(Ym.count(md(_)-1,_),q,2)}function wf(_,q){return Na(_.getUTCFullYear()%100,q,2)}function $A(_,q){return Na((_=bl(_)).getUTCFullYear()%100,q,2)}function Ad(_,q){return Na(_.getUTCFullYear()%1e4,q,4)}function Iv(_,q){var ye=_.getUTCDay();return Na((_=ye>=4||0===ye?Xp(_):Xp.ceil(_)).getUTCFullYear()%1e4,q,4)}function Bv(){return"+0000"}function Hy(){return"%"}function c_(_){return+_}function XA(_){return Math.floor(+_/1e3)}!function Kx(_){iA=function Ny(_){var q=_.dateTime,ye=_.date,we=_.time,Ze=_.periods,mt=_.days,yt=_.shortDays,It=_.months,$t=_.shortMonths,Xt=Od(Ze),an=VA(Ze),Qn=Od(mt),Gn=VA(mt),yi=Od(yt),gr=VA(yt),Ji=Od(It),ar=VA(It),ls=Od($t),Io=VA($t),xr={a:function Ah(Ps){return yt[Ps.getDay()]},A:function tu(Ps){return mt[Ps.getDay()]},b:function mc(Ps){return $t[Ps.getMonth()]},B:function bp(Ps){return It[Ps.getMonth()]},c:null,d:up,e:up,f:Nd,g:Yh,G:o0,H:hl,I:Ec,j:Ld,L:_o,m:r0,M:vf,p:function f0(Ps){return Ze[+(Ps.getHours()>=12)]},q:function ed(Ps){return 1+~~(Ps.getMonth()/3)},Q:c_,s:XA,S:Pl,u:Zp,U:tA,V:Jp,w:s0,W:bf,x:null,X:null,y:QA,Y:Fs,Z:jA,"%":Hy},Ui={a:function t1(Ps){return yt[Ps.getUTCDay()]},A:function p0(Ps){return mt[Ps.getUTCDay()]},b:function os(Ps){return $t[Ps.getUTCMonth()]},B:function lA(Ps){return It[Ps.getUTCMonth()]},c:null,d:Kh,e:Kh,f:Sc,g:$A,G:Iv,H:em,I:tm,j:ec,L:WA,m:rh,M:l_,p:function m0(Ps){return Ze[+(Ps.getUTCHours()>=12)]},q:function A0(Ps){return 1+~~(Ps.getUTCMonth()/3)},Q:c_,s:XA,S:nm,u:xf,U:Yu,V:dp,w:nA,W:zd,x:null,X:null,y:wf,Y:Ad,Z:Bv,"%":Hy},zs={a:function pc(Ps,la,_a){var Ir=yi.exec(la.slice(_a));return Ir?(Ps.w=gr.get(Ir[0].toLowerCase()),_a+Ir[0].length):-1},A:function Dr(Ps,la,_a){var Ir=Qn.exec(la.slice(_a));return Ir?(Ps.w=Gn.get(Ir[0].toLowerCase()),_a+Ir[0].length):-1},b:function ic(Ps,la,_a){var Ir=ls.exec(la.slice(_a));return Ir?(Ps.m=Io.get(Ir[0].toLowerCase()),_a+Ir[0].length):-1},B:function Ws(Ps,la,_a){var Ir=Ji.exec(la.slice(_a));return Ir?(Ps.m=ar.get(Ir[0].toLowerCase()),_a+Ir[0].length):-1},c:function ea(Ps,la,_a){return xl(Ps,q,la,_a)},d:GA,e:GA,f:uc,g:zy,G:n0,H:qA,I:qA,j:eA,L:Ys,m:Dv,M:Ml,p:function fc(Ps,la,_a){var Ir=Xt.exec(la.slice(_a));return Ir?(Ps.p=an.get(Ir[0].toLowerCase()),_a+Ir[0].length):-1},q:Tv,Q:ih,s:$c,S:vr,u:Mc,U:a_,V:Uy,w:Ev,W:Jm,x:function Su(Ps,la,_a){return xl(Ps,ye,la,_a)},X:function Ju(Ps,la,_a){return xl(Ps,we,la,_a)},y:zy,Y:n0,Z:Sv,"%":Xu};function ss(Ps,la){return function(_a){var _d,ag,n1,Ir=[],ns=-1,wl=0,nu=Ps.length;for(_a instanceof Date||(_a=new Date(+_a));++ns<nu;)37===Ps.charCodeAt(ns)&&(Ir.push(Ps.slice(wl,ns)),null!=(ag=t0[_d=Ps.charAt(++ns)])?_d=Ps.charAt(++ns):ag="e"===_d?" ":"0",(n1=la[_d])&&(_d=n1(_a,ag)),Ir.push(_d),wl=ns+1);return Ir.push(Ps.slice(wl,ns)),Ir.join("")}}function Uo(Ps,la){return function(_a){var wl,nu,Ir=kd(1900,void 0,1);if(xl(Ir,Ps,_a+="",0)!=_a.length)return null;if("Q"in Ir)return new Date(Ir.Q);if("s"in Ir)return new Date(1e3*Ir.s+("L"in Ir?Ir.L:0));if(la&&!("Z"in Ir)&&(Ir.Z=0),"p"in Ir&&(Ir.H=Ir.H%12+12*Ir.p),void 0===Ir.m&&(Ir.m="q"in Ir?Ir.q:0),"V"in Ir){if(Ir.V<1||Ir.V>53)return null;"w"in Ir||(Ir.w=1),"Z"in Ir?(nu=(wl=e0(kd(Ir.y,0,1))).getUTCDay(),wl=nu>4||0===nu?Ym.ceil(wl):Ym(wl),wl=$p.offset(wl,7*(Ir.V-1)),Ir.y=wl.getUTCFullYear(),Ir.m=wl.getUTCMonth(),Ir.d=wl.getUTCDate()+(Ir.w+6)%7):(nu=(wl=Kp(kd(Ir.y,0,1))).getDay(),wl=nu>4||0===nu?cp.ceil(wl):cp(wl),wl=ql.offset(wl,7*(Ir.V-1)),Ir.y=wl.getFullYear(),Ir.m=wl.getMonth(),Ir.d=wl.getDate()+(Ir.w+6)%7)}else("W"in Ir||"U"in Ir)&&("w"in Ir||(Ir.w="u"in Ir?Ir.u%7:"W"in Ir?1:0),nu="Z"in Ir?e0(kd(Ir.y,0,1)).getUTCDay():Kp(kd(Ir.y,0,1)).getDay(),Ir.m=0,Ir.d="W"in Ir?(Ir.w+6)%7+7*Ir.W-(nu+5)%7:Ir.w+7*Ir.U-(nu+6)%7);return"Z"in Ir?(Ir.H+=Ir.Z/100|0,Ir.M+=Ir.Z%100,e0(Ir)):Kp(Ir)}}function xl(Ps,la,_a,Ir){for(var _d,ag,ns=0,wl=la.length,nu=_a.length;ns<wl;){if(Ir>=nu)return-1;if(37===(_d=la.charCodeAt(ns++))){if(_d=la.charAt(ns++),!(ag=zs[_d in t0?la.charAt(ns++):_d])||(Ir=ag(Ps,_a,Ir))<0)return-1}else if(_d!=_a.charCodeAt(Ir++))return-1}return Ir}return xr.x=ss(ye,xr),xr.X=ss(we,xr),xr.c=ss(q,xr),Ui.x=ss(ye,Ui),Ui.X=ss(we,Ui),Ui.c=ss(q,Ui),{format:function(Ps){var la=ss(Ps+="",xr);return la.toString=function(){return Ps},la},parse:function(Ps){var la=Uo(Ps+="",!1);return la.toString=function(){return Ps},la},utcFormat:function(Ps){var la=ss(Ps+="",Ui);return la.toString=function(){return Ps},la},utcParse:function(Ps){var la=Uo(Ps+="",!0);return la.toString=function(){return Ps},la}}}(_),h_=iA.format,d_=iA.utcFormat,Pv=iA.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Rv="%Y-%m-%dT%H:%M:%S.%LZ";function kv(_){return new Date(_)}function p_(_){return _ instanceof Date?+_:+new Date(+_)}function dc(_,q,ye,we,Ze,mt,yt,It,$t,Xt){var an=Wn(),Qn=an.invert,Gn=an.domain,yi=Xt(".%L"),gr=Xt(":%S"),Ji=Xt("%I:%M"),ar=Xt("%I %p"),ls=Xt("%a %d"),Io=Xt("%b %d"),xr=Xt("%B"),Ui=Xt("%Y");function zs(ss){return($t(ss)<ss?yi:It(ss)<ss?gr:yt(ss)<ss?Ji:mt(ss)<ss?ar:we(ss)<ss?Ze(ss)<ss?ls:Io:ye(ss)<ss?xr:Ui)(ss)}return an.invert=function(ss){return new Date(Qn(ss))},an.domain=function(ss){return arguments.length?Gn(Array.from(ss,p_)):Gn().map(kv)},an.ticks=function(ss){var Uo=Gn();return _(Uo[0],Uo[Uo.length-1],ss??10)},an.tickFormat=function(ss,Uo){return null==Uo?zs:Xt(Uo)},an.nice=function(ss){var Uo=Gn();return(!ss||"function"!=typeof ss.range)&&(ss=q(Uo[0],Uo[Uo.length-1],ss??10)),ss?Gn(Af(Uo,ss)):an},an.copy=function(){return vu(an,dc(_,q,ye,we,Ze,mt,yt,It,$t,Xt))},an}function Gy(){return Rc.apply(dc(Jg,nh,yf,HA,lp,ql,Gl,Ro,yl,h_).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function tc(_){return function(){return _}}Date.prototype.toISOString||d_(Rv),+new Date("2000-01-01T00:00:00.000Z")||Pv(Rv);const im=Math.abs,Js=Math.atan2,nl=Math.cos,YA=Math.max,Wy=Math.min,Ql=Math.sin,rA=Math.sqrt,sh=1e-12,KA=Math.PI,sA=KA/2,g_=2*KA;function ZA(_){return _>=1?sA:_<=-1?-sA:Math.asin(_)}function Mf(_){return _.innerRadius}function Br(_){return _.outerRadius}function zr(_){return _.startAngle}function Mu(_){return _.endAngle}function JA(_){return _&&_.padAngle}function l0(_,q,ye,we,Ze,mt,yt){var It=_-ye,$t=q-we,Xt=(yt?mt:-mt)/rA(It*It+$t*$t),an=Xt*$t,Qn=-Xt*It,Gn=_+an,yi=q+Qn,gr=ye+an,Ji=we+Qn,ar=(Gn+gr)/2,ls=(yi+Ji)/2,Io=gr-Gn,xr=Ji-yi,Ui=Io*Io+xr*xr,zs=Ze-mt,ss=Gn*Ji-gr*yi,Uo=(xr<0?-1:1)*rA(YA(0,zs*zs*Ui-ss*ss)),xl=(ss*xr-Io*Uo)/Ui,fc=(-ss*Io-xr*Uo)/Ui,pc=(ss*xr+Io*Uo)/Ui,Dr=(-ss*Io+xr*Uo)/Ui,ic=xl-ar,Ws=fc-ls,ea=pc-ar,Su=Dr-ls;return ic*ic+Ws*Ws>ea*ea+Su*Su&&(xl=pc,fc=Dr),{cx:xl,cy:fc,x01:-an,y01:-Qn,x11:xl*(Ze/zs-1),y11:fc*(Ze/zs-1)}}function Lv(){var _=Mf,q=Br,ye=tc(0),we=null,Ze=zr,mt=Mu,yt=JA,It=null,$t=function $y(_){let q=3;return _.digits=function(ye){if(!arguments.length)return q;if(null==ye)q=null;else{const we=Math.floor(ye);if(!(we>=0))throw new RangeError(`invalid digits: ${ye}`);q=we}return _},()=>new ei(q)}(Xt);function Xt(){var an,Qn,Gn=+_.apply(this,arguments),yi=+q.apply(this,arguments),gr=Ze.apply(this,arguments)-sA,Ji=mt.apply(this,arguments)-sA,ar=im(Ji-gr),ls=Ji>gr;if(It||(It=an=$t()),yi<Gn&&(Qn=yi,yi=Gn,Gn=Qn),yi>sh)if(ar>g_-sh)It.moveTo(yi*nl(gr),yi*Ql(gr)),It.arc(0,0,yi,gr,Ji,!ls),Gn>sh&&(It.moveTo(Gn*nl(Ji),Gn*Ql(Ji)),It.arc(0,0,Gn,Ji,gr,ls));else{var Ws,ea,Io=gr,xr=Ji,Ui=gr,zs=Ji,ss=ar,Uo=ar,xl=yt.apply(this,arguments)/2,fc=xl>sh&&(we?+we.apply(this,arguments):rA(Gn*Gn+yi*yi)),pc=Wy(im(yi-Gn)/2,+ye.apply(this,arguments)),Dr=pc,ic=pc;if(fc>sh){var Su=ZA(fc/Gn*Ql(xl)),Ju=ZA(fc/yi*Ql(xl));(ss-=2*Su)>sh?(Ui+=Su*=ls?1:-1,zs-=Su):(ss=0,Ui=zs=(gr+Ji)/2),(Uo-=2*Ju)>sh?(Io+=Ju*=ls?1:-1,xr-=Ju):(Uo=0,Io=xr=(gr+Ji)/2)}var Ah=yi*nl(Io),tu=yi*Ql(Io),mc=Gn*nl(zs),bp=Gn*Ql(zs);if(pc>sh){var os,f0=yi*nl(xr),ed=yi*Ql(xr),t1=Gn*nl(Ui),p0=Gn*Ql(Ui);if(ar<KA)if(os=function rm(_,q,ye,we,Ze,mt,yt,It){var $t=ye-_,Xt=we-q,an=yt-Ze,Qn=It-mt,Gn=Qn*$t-an*Xt;if(!(Gn*Gn<sh))return[_+(Gn=(an*(q-mt)-Qn*(_-Ze))/Gn)*$t,q+Gn*Xt]}(Ah,tu,t1,p0,f0,ed,mc,bp)){var lA=Ah-os[0],m0=tu-os[1],A0=f0-os[0],Ps=ed-os[1],la=1/Ql(function __(_){return _>1?0:_<-1?KA:Math.acos(_)}((lA*A0+m0*Ps)/(rA(lA*lA+m0*m0)*rA(A0*A0+Ps*Ps)))/2),_a=rA(os[0]*os[0]+os[1]*os[1]);Dr=Wy(pc,(Gn-_a)/(la-1)),ic=Wy(pc,(yi-_a)/(la+1))}else Dr=ic=0}Uo>sh?ic>sh?(Ws=l0(t1,p0,Ah,tu,yi,ic,ls),ea=l0(f0,ed,mc,bp,yi,ic,ls),It.moveTo(Ws.cx+Ws.x01,Ws.cy+Ws.y01),ic<pc?It.arc(Ws.cx,Ws.cy,ic,Js(Ws.y01,Ws.x01),Js(ea.y01,ea.x01),!ls):(It.arc(Ws.cx,Ws.cy,ic,Js(Ws.y01,Ws.x01),Js(Ws.y11,Ws.x11),!ls),It.arc(0,0,yi,Js(Ws.cy+Ws.y11,Ws.cx+Ws.x11),Js(ea.cy+ea.y11,ea.cx+ea.x11),!ls),It.arc(ea.cx,ea.cy,ic,Js(ea.y11,ea.x11),Js(ea.y01,ea.x01),!ls))):(It.moveTo(Ah,tu),It.arc(0,0,yi,Io,xr,!ls)):It.moveTo(Ah,tu),Gn>sh&&ss>sh?Dr>sh?(Ws=l0(mc,bp,f0,ed,Gn,-Dr,ls),ea=l0(Ah,tu,t1,p0,Gn,-Dr,ls),It.lineTo(Ws.cx+Ws.x01,Ws.cy+Ws.y01),Dr<pc?It.arc(Ws.cx,Ws.cy,Dr,Js(Ws.y01,Ws.x01),Js(ea.y01,ea.x01),!ls):(It.arc(Ws.cx,Ws.cy,Dr,Js(Ws.y01,Ws.x01),Js(Ws.y11,Ws.x11),!ls),It.arc(0,0,Gn,Js(Ws.cy+Ws.y11,Ws.cx+Ws.x11),Js(ea.cy+ea.y11,ea.cx+ea.x11),ls),It.arc(ea.cx,ea.cy,Dr,Js(ea.y11,ea.x11),Js(ea.y01,ea.x01),!ls))):It.arc(0,0,Gn,zs,Ui,ls):It.lineTo(mc,bp)}else It.moveTo(0,0);if(It.closePath(),an)return It=null,an+""||null}return Xt.centroid=function(){var an=(+_.apply(this,arguments)+ +q.apply(this,arguments))/2,Qn=(+Ze.apply(this,arguments)+ +mt.apply(this,arguments))/2-KA/2;return[nl(Qn)*an,Ql(Qn)*an]},Xt.innerRadius=function(an){return arguments.length?(_="function"==typeof an?an:tc(+an),Xt):_},Xt.outerRadius=function(an){return arguments.length?(q="function"==typeof an?an:tc(+an),Xt):q},Xt.cornerRadius=function(an){return arguments.length?(ye="function"==typeof an?an:tc(+an),Xt):ye},Xt.padRadius=function(an){return arguments.length?(we=null==an?null:"function"==typeof an?an:tc(+an),Xt):we},Xt.startAngle=function(an){return arguments.length?(Ze="function"==typeof an?an:tc(+an),Xt):Ze},Xt.endAngle=function(an){return arguments.length?(mt="function"==typeof an?an:tc(+an),Xt):mt},Xt.padAngle=function(an){return arguments.length?(yt="function"==typeof an?an:tc(+an),Xt):yt},Xt.context=function(an){return arguments.length?(It=an??null,Xt):It},Xt}var Sf,Ku,oA=0,Ef=0,nc=0,y_=1e3,eg=0,Hd=0,gi=0,fo="object"==typeof performance&&performance.now?performance:Date,pi="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(_){setTimeout(_,17)};function fi(){return Hd||(pi(qa),Hd=fo.now()+gi)}function qa(){Hd=0}function tg(){this._call=this._time=this._next=null}function sm(_,q,ye){var we=new tg;return we.restart(_,q,ye),we}function Vd(){Hd=(eg=fo.now())+gi,oA=Ef=0;try{!function Zh(){fi(),++oA;for(var q,_=Sf;_;)(q=Hd-_._time)>=0&&_._call.call(void 0,q),_=_._next;--oA}()}finally{oA=0,function pp(){for(var _,ye,q=Sf,we=1/0;q;)q._call?(we>q._time&&(we=q._time),_=q,q=q._next):(ye=q._next,q._next=null,q=_?_._next=ye:Sf=ye);Ku=_,h0(we)}(),Hd=0}}function c0(){var _=fo.now(),q=_-eg;q>y_&&(gi-=q,eg=_)}function h0(_){oA||(Ef&&(Ef=clearTimeout(Ef)),_-Hd>24?(_<1/0&&(Ef=setTimeout(Vd,_-fo.now()-gi)),nc&&(nc=clearInterval(nc))):(nc||(eg=fo.now(),nc=setInterval(c0,y_)),oA=1,pi(Vd)))}function Xy(_,q,ye){var we=new tg;return we.restart(Ze=>{we.stop(),_(Ze+q)},q=null==q?0:+q,ye),we}tg.prototype=sm.prototype={constructor:tg,restart:function(_,q,ye){if("function"!=typeof _)throw new TypeError("callback is not a function");ye=(null==ye?fi():+ye)+(null==q?0:+q),!this._next&&Ku!==this&&(Ku?Ku._next=this:Sf=this,Ku=this),this._call=_,this._time=ye,h0()},stop:function(){this._call&&(this._call=null,this._time=1/0,h0())}};var u0=tn("start","end","cancel","interrupt"),d0=[],ng=0,aA=3;function mp(_,q,ye,we,Ze,mt){var yt=_.__transition;if(yt){if(ye in yt)return}else _.__transition={};!function oe(_,q,ye){var Ze,we=_.__transition;function yt(Xt){var an,Qn,Gn,yi;if(1!==ye.state)return $t();for(an in we)if((yi=we[an]).name===ye.name){if(yi.state===aA)return Xy(yt);4===yi.state?(yi.state=6,yi.timer.stop(),yi.on.call("interrupt",_,_.__data__,yi.index,yi.group),delete we[an]):+an<q&&(yi.state=6,yi.timer.stop(),yi.on.call("cancel",_,_.__data__,yi.index,yi.group),delete we[an])}if(Xy(function(){ye.state===aA&&(ye.state=4,ye.timer.restart(It,ye.delay,ye.time),It(Xt))}),ye.state=2,ye.on.call("start",_,_.__data__,ye.index,ye.group),2===ye.state){for(ye.state=aA,Ze=new Array(Gn=ye.tween.length),an=0,Qn=-1;an<Gn;++an)(yi=ye.tween[an].value.call(_,_.__data__,ye.index,ye.group))&&(Ze[++Qn]=yi);Ze.length=Qn+1}}function It(Xt){for(var an=Xt<ye.duration?ye.ease.call(null,Xt/ye.duration):(ye.timer.restart($t),ye.state=5,1),Qn=-1,Gn=Ze.length;++Qn<Gn;)Ze[Qn].call(_,an);5===ye.state&&(ye.on.call("end",_,_.__data__,ye.index,ye.group),$t())}function $t(){for(var Xt in ye.state=6,ye.timer.stop(),delete we[q],we)return;delete _.__transition}we[q]=ye,ye.timer=sm(function mt(Xt){ye.state=1,ye.timer.restart(yt,ye.delay,ye.time),ye.delay<=Xt&&yt(Xt-ye.delay)},0,ye.time)}(_,ye,{name:q,index:we,group:Ze,on:u0,tween:d0,time:mt.time,delay:mt.delay,duration:mt.duration,ease:mt.ease,timer:null,state:ng})}function te(_,q){var ye=ae(_,q);if(ye.state>ng)throw new Error("too late; already scheduled");return ye}function Z(_,q){var ye=ae(_,q);if(ye.state>aA)throw new Error("too late; already running");return ye}function ae(_,q){var ye=_.__transition;if(!ye||!(ye=ye[q]))throw new Error("transition not found");return ye}function Pt(_,q){var ye,we;return function(){var Ze=Z(this,_),mt=Ze.tween;if(mt!==ye)for(var yt=0,It=(we=ye=mt).length;yt<It;++yt)if(we[yt].name===q){(we=we.slice()).splice(yt,1);break}Ze.tween=we}}function on(_,q,ye){var we,Ze;if("function"!=typeof ye)throw new Error;return function(){var mt=Z(this,_),yt=mt.tween;if(yt!==we){Ze=(we=yt).slice();for(var It={name:q,value:ye},$t=0,Xt=Ze.length;$t<Xt;++$t)if(Ze[$t].name===q){Ze[$t]=It;break}$t===Xt&&Ze.push(It)}mt.tween=Ze}}function Vn(_,q,ye){var we=_._id;return _.each(function(){var Ze=Z(this,we);(Ze.value||(Ze.value={}))[q]=ye.apply(this,arguments)}),function(Ze){return ae(Ze,we).value[q]}}function Kn(_,q){var ye;return("number"==typeof q?Kl:q instanceof D?rp:(ye=D(q))?(q=ye,rp):Iy)(_,q)}function li(_){return function(){this.removeAttribute(_)}}function Ni(_){return function(){this.removeAttributeNS(_.space,_.local)}}function us(_,q,ye){var we,mt,Ze=ye+"";return function(){var yt=this.getAttribute(_);return yt===Ze?null:yt===we?mt:mt=q(we=yt,ye)}}function Pr(_,q,ye){var we,mt,Ze=ye+"";return function(){var yt=this.getAttributeNS(_.space,_.local);return yt===Ze?null:yt===we?mt:mt=q(we=yt,ye)}}function Cr(_,q,ye){var we,Ze,mt;return function(){var yt,$t,It=ye(this);return null==It?void this.removeAttribute(_):(yt=this.getAttribute(_))===($t=It+"")?null:yt===we&&$t===Ze?mt:(Ze=$t,mt=q(we=yt,It))}}function Co(_,q,ye){var we,Ze,mt;return function(){var yt,$t,It=ye(this);return null==It?void this.removeAttributeNS(_.space,_.local):(yt=this.getAttributeNS(_.space,_.local))===($t=It+"")?null:yt===we&&$t===Ze?mt:(Ze=$t,mt=q(we=yt,It))}}function vo(_,q){var ye,we;function Ze(){var mt=q.apply(this,arguments);return mt!==we&&(ye=(we=mt)&&function Ua(_,q){return function(ye){this.setAttributeNS(_.space,_.local,q.call(this,ye))}}(_,mt)),ye}return Ze._value=q,Ze}function Mo(_,q){var ye,we;function Ze(){var mt=q.apply(this,arguments);return mt!==we&&(ye=(we=mt)&&function Fr(_,q){return function(ye){this.setAttribute(_,q.call(this,ye))}}(_,mt)),ye}return Ze._value=q,Ze}function ga(_,q){return function(){te(this,_).delay=+q.apply(this,arguments)}}function aa(_,q){return q=+q,function(){te(this,_).delay=q}}function El(_,q){return function(){Z(this,_).duration=+q.apply(this,arguments)}}function Ea(_,q){return q=+q,function(){Z(this,_).duration=q}}var rg=lf.prototype.constructor;function Yy(_){return function(){this.style.removeProperty(_)}}var Jy=0;function Gd(_,q,ye,we){this._groups=_,this._parents=q,this._name=ye,this._id=we}function zv(){return++Jy}var vp=lf.prototype;Gd.prototype=function PM(_){return lf().transition(_)}.prototype={constructor:Gd,select:function om(_){var q=this._name,ye=this._id;"function"!=typeof _&&(_=Xn(_));for(var we=this._groups,Ze=we.length,mt=new Array(Ze),yt=0;yt<Ze;++yt)for(var an,Qn,It=we[yt],$t=It.length,Xt=mt[yt]=new Array($t),Gn=0;Gn<$t;++Gn)(an=It[Gn])&&(Qn=_.call(an,an.__data__,Gn,It))&&("__data__"in an&&(Qn.__data__=an.__data__),Xt[Gn]=Qn,mp(Xt[Gn],q,ye,Gn,Xt,ae(an,ye)));return new Gd(mt,this._parents,q,ye)},selectAll:function _p(_){var q=this._name,ye=this._id;"function"!=typeof _&&(_=Tr(_));for(var we=this._groups,Ze=we.length,mt=[],yt=[],It=0;It<Ze;++It)for(var an,$t=we[It],Xt=$t.length,Qn=0;Qn<Xt;++Qn)if(an=$t[Qn]){for(var yi,Gn=_.call(an,an.__data__,Qn,$t),gr=ae(an,ye),Ji=0,ar=Gn.length;Ji<ar;++Ji)(yi=Gn[Ji])&&mp(yi,q,ye,Ji,Gn,gr);mt.push(Gn),yt.push(an)}return new Gd(mt,yt,q,ye)},selectChild:vp.selectChild,selectChildren:vp.selectChildren,filter:function Jh(_){"function"!=typeof _&&(_=Go(_));for(var q=this._groups,ye=q.length,we=new Array(ye),Ze=0;Ze<ye;++Ze)for(var $t,mt=q[Ze],yt=mt.length,It=we[Ze]=[],Xt=0;Xt<yt;++Xt)($t=mt[Xt])&&_.call($t,$t.__data__,Xt,mt)&&It.push($t);return new Gd(we,this._parents,this._name,this._id)},merge:function Zu(_){if(_._id!==this._id)throw new Error;for(var q=this._groups,ye=_._groups,we=q.length,mt=Math.min(we,ye.length),yt=new Array(we),It=0;It<mt;++It)for(var Gn,$t=q[It],Xt=ye[It],an=$t.length,Qn=yt[It]=new Array(an),yi=0;yi<an;++yi)(Gn=$t[yi]||Xt[yi])&&(Qn[yi]=Gn);for(;It<we;++It)yt[It]=q[It];return new Gd(yt,this._parents,this._name,this._id)},selection:function am(){return new rg(this._groups,this._parents)},transition:function Uv(){for(var _=this._name,q=this._id,ye=zv(),we=this._groups,Ze=we.length,mt=0;mt<Ze;++mt)for(var $t,yt=we[mt],It=yt.length,Xt=0;Xt<It;++Xt)if($t=yt[Xt]){var an=ae($t,q);mp($t,_,ye,Xt,yt,{time:an.time+an.delay+an.duration,delay:0,duration:an.duration,ease:an.ease})}return new Gd(we,this._parents,_,ye)},call:vp.call,nodes:vp.nodes,node:vp.node,size:vp.size,empty:vp.empty,each:vp.each,on:function Df(_,q){var ye=this._id;return arguments.length<2?ae(this.node(),ye).on.on(_):this.each(function Ap(_,q,ye){var we,Ze,mt=function eu(_){return(_+"").trim().split(/^|\s+/).every(function(q){var ye=q.indexOf(".");return ye>=0&&(q=q.slice(0,ye)),!q||"start"===q})}(q)?te:Z;return function(){var yt=mt(this,_),It=yt.on;It!==we&&(Ze=(we=It).copy()).on(q,ye),yt.on=Ze}}(ye,_,q))},attr:function kr(_,q){var ye=_n(_),we="transform"===ye?wM:Kn;return this.attrTween(_,"function"==typeof q?(ye.local?Co:Cr)(ye,we,Vn(this,"attr."+_,q)):null==q?(ye.local?Ni:li)(ye):(ye.local?Pr:us)(ye,we,q))},attrTween:function as(_,q){var ye="attr."+_;if(arguments.length<2)return(ye=this.tween(ye))&&ye._value;if(null==q)return this.tween(ye,null);if("function"!=typeof q)throw new Error;var we=_n(_);return this.tween(ye,(we.local?vo:Mo)(we,q))},style:function DM(_,q,ye){var we="transform"==(_+="")?xM:Kn;return null==q?this.styleTween(_,function sg(_,q){var ye,we,Ze;return function(){var mt=rf(this,_),yt=(this.style.removeProperty(_),rf(this,_));return mt===yt?null:mt===ye&&yt===we?Ze:Ze=q(ye=mt,we=yt)}}(_,we)).on("end.style."+_,Yy(_)):"function"==typeof q?this.styleTween(_,function TM(_,q,ye){var we,Ze,mt;return function(){var yt=rf(this,_),It=ye(this),$t=It+"";return null==It&&(this.style.removeProperty(_),$t=It=rf(this,_)),yt===$t?null:yt===we&&$t===Ze?mt:(Ze=$t,mt=q(we=yt,It))}}(_,we,Vn(this,"style."+_,q))).each(function b_(_,q){var ye,we,Ze,It,mt="style."+q,yt="end."+mt;return function(){var $t=Z(this,_),Xt=$t.on,an=null==$t.value[mt]?It||(It=Yy(q)):void 0;(Xt!==ye||Ze!==an)&&(we=(ye=Xt).copy()).on(yt,Ze=an),$t.on=we}}(this._id,_)):this.styleTween(_,function v_(_,q,ye){var we,mt,Ze=ye+"";return function(){var yt=rf(this,_);return yt===Ze?null:yt===we?mt:mt=q(we=yt,ye)}}(_,we,q),ye).on("end.style."+_,null)},styleTween:function JT(_,q,ye){var we="style."+(_+="");if(arguments.length<2)return(we=this.tween(we))&&we._value;if(null==q)return this.tween(we,null);if("function"!=typeof q)throw new Error;return this.tween(we,function Ky(_,q,ye){var we,Ze;function mt(){var yt=q.apply(this,arguments);return yt!==Ze&&(we=(Ze=yt)&&function Nv(_,q,ye){return function(we){this.style.setProperty(_,q.call(this,we),ye)}}(_,yt,ye)),we}return mt._value=q,mt}(_,q,ye??""))},text:function IM(_){return this.tween("text","function"==typeof _?function tw(_){return function(){var q=_(this);this.textContent=q??""}}(Vn(this,"text",_)):function ew(_){return function(){this.textContent=_}}(null==_?"":_+""))},textTween:function Zy(_){var q="text";if(arguments.length<1)return(q=this.tween(q))&&q._value;if(null==_)return this.tween(q,null);if("function"!=typeof _)throw new Error;return this.tween(q,function BM(_){var q,ye;function we(){var Ze=_.apply(this,arguments);return Ze!==ye&&(q=(ye=Ze)&&function yp(_){return function(q){this.textContent=_.call(this,q)}}(Ze)),q}return we._value=_,we}(_))},remove:function If(){return this.on("end.remove",function gp(_){return function(){var q=this.parentNode;for(var ye in this.__transition)if(+ye!==_)return;q&&q.removeChild(this)}}(this._id))},tween:function sn(_,q){var ye=this._id;if(_+="",arguments.length<2){for(var yt,we=ae(this.node(),ye).tween,Ze=0,mt=we.length;Ze<mt;++Ze)if((yt=we[Ze]).name===_)return yt.value;return null}return this.each((null==q?Pt:on)(ye,_,q))},delay:function Ks(_){var q=this._id;return arguments.length?this.each(("function"==typeof _?ga:aa)(q,_)):ae(this.node(),q).delay},duration:function Ra(_){var q=this._id;return arguments.length?this.each(("function"==typeof _?El:Ea)(q,_)):ae(this.node(),q).duration},ease:function Fc(_){var q=this._id;return arguments.length?this.each(function ka(_,q){if("function"!=typeof q)throw new Error;return function(){Z(this,_).ease=q}}(q,_)):ae(this.node(),q).ease},easeVarying:function kh(_){if("function"!=typeof _)throw new Error;return this.each(function Tf(_,q){return function(){var ye=q.apply(this,arguments);if("function"!=typeof ye)throw new Error;Z(this,_).ease=ye}}(this._id,_))},end:function nw(){var _,q,ye=this,we=ye._id,Ze=ye.size();return new Promise(function(mt,yt){var It={value:yt},$t={value:function(){0==--Ze&&mt()}};ye.each(function(){var Xt=Z(this,we),an=Xt.on;an!==_&&((q=(_=an).copy())._.cancel.push(It),q._.interrupt.push(It),q._.end.push($t)),Xt.on=q}),0===Ze&&mt()})},[Symbol.iterator]:vp[Symbol.iterator]};var rw={time:null,delay:0,duration:250,ease:function iw(_){return((_*=2)<=1?_*_*_:(_-=2)*_*_+2)/2}};function RM(_,q){for(var ye;!(ye=_.__transition)||!(ye=ye[q]);)if(!(_=_.parentNode))throw new Error(`transition ${q} not found`);return ye}lf.prototype.interrupt=function ft(_){return this.each(function(){!function qe(_,q){var we,Ze,yt,ye=_.__transition,mt=!0;if(ye){for(yt in q=null==q?null:q+"",ye)(we=ye[yt]).name===q?(Ze=we.state>2&&we.state<5,we.state=6,we.timer.stop(),we.on.call(Ze?"interrupt":"cancel",_,_.__data__,we.index,we.group),delete ye[yt]):mt=!1;mt&&delete _.__transition}}(this,_)})},lf.prototype.transition=function e1(_){var q,ye;_ instanceof Gd?(q=_._id,_=_._name):(q=zv(),(ye=rw).time=fi(),_=null==_?null:_+"");for(var we=this._groups,Ze=we.length,mt=0;mt<Ze;++mt)for(var $t,yt=we[mt],It=yt.length,Xt=0;Xt<It;++Xt)($t=yt[Xt])&&mp($t,_,q,Xt,yt,ye||RM($t,q));return new Gd(we,this._parents,_,q)}},8521:(Gr,xt,Te)=>{"use strict";Te.d(xt,{$2:()=>ie,AI:()=>m,Xv:()=>O,hd:()=>N,iO:()=>H,uA:()=>C});var be=Te(5774),V=(Te(3324),Te(4186)),Le=Te(9907),xe=Te(6119),Je=Te(165),st=Te(2481),Ke=Te(9788);function ot(){return Re.apply(this,arguments)}function Re(){return(Re=(0,be.A)(function*(){return Te.e(803).then(Te.bind(Te,6803))})).apply(this,arguments)}function Qe(){return Ie.apply(this,arguments)}function Ie(){return(Ie=(0,be.A)(function*(){return Promise.resolve().then(Te.bind(Te,2725))})).apply(this,arguments)}function L(){return he.apply(this,arguments)}function he(){return(he=(0,be.A)(function*(){return Promise.all([Te.e(825),Te.e(76),Te.e(840)]).then(Te.bind(Te,6840))})).apply(this,arguments)}function re(){return fe.apply(this,arguments)}function fe(){return(fe=(0,be.A)(function*(){return Promise.resolve().then(Te.bind(Te,4493))})).apply(this,arguments)}function de(){return pe.apply(this,arguments)}function pe(){return(pe=(0,be.A)(function*(){return Promise.resolve().then(Te.bind(Te,3402)).then($=>{const tt=N(V.prROOT+"TGeoVolumeAssembly");return tt&&(tt.icon="img_geoassembly"),$})})).apply(this,arguments)}const ce="TGraph2D",K="TH2Poly",G="TEllipse",D="TSpline3",x="TTree",P="TCanvasWebSnapshot",w="fPrimitives",b="fFunctions",g={lst:[{name:V.clTCanvas,icon:"img_canvas",class:()=>Qe().then($=>$.TCanvasPainter),opt:";grid;gridx;gridy;tick;tickx;ticky;log;logx;logy;logz",expand_item:w,noappend:!0},{name:V.clTPad,icon:"img_canvas",func:Ke.jg.draw,opt:";grid;gridx;gridy;tick;tickx;ticky;log;logx;logy;logz",expand_item:w,noappend:!0},{name:"TSlider",icon:"img_canvas",func:Ke.jg.draw},{name:Ke.cw,icon:"img_canvas",func:Ke.jg.draw},{name:V.clTFrame,icon:"img_frame",draw:()=>Qe().then($=>$.drawTFrame)},{name:V.clTPave,icon:"img_pavetext",class:()=>Promise.resolve().then(Te.bind(Te,6673)).then($=>$.TPavePainter)},{name:V.clTPaveText,sameas:V.clTPave},{name:V.clTPavesText,sameas:V.clTPave},{name:V.clTPaveStats,sameas:V.clTPave},{name:V.clTPaveLabel,sameas:V.clTPave},{name:V.clTPaveClass,sameas:V.clTPave},{name:V.clTDiamond,sameas:V.clTPave},{name:V.clTLegend,icon:"img_pavelabel",sameas:V.clTPave},{name:V.clTPaletteAxis,icon:"img_colz",sameas:V.clTPave},{name:V.clTLatex,icon:"img_text",draw:()=>ot().then($=>$.drawText),direct:!0},{name:V.clTMathText,sameas:V.clTLatex},{name:V.clTText,sameas:V.clTLatex},{name:V.clTAnnotation,sameas:V.clTLatex},{name:/^TH1/,icon:"img_histo1d",class:()=>Promise.resolve().then(Te.bind(Te,3752)).then($=>$.TH1Painter),opt:";hist;P;P0;E;E1;E2;E3;E4;E1X0;L;LF2;C;B;B1;A;TEXT;LEGO;same",ctrl:"l",expand_item:b,for_derived:!0},{name:V.clTProfile,icon:"img_profile",class:()=>Promise.resolve().then(Te.bind(Te,3752)).then($=>$.TH1Painter),opt:";E0;E1;E2;p;AH;hist",expand_item:b},{name:K,icon:"img_histo2d",class:()=>Promise.resolve().then(Te.bind(Te,4862)).then($=>$.TH2Painter),opt:";COL;COL0;COLZ;LCOL;LCOL0;LCOLZ;LEGO;TEXT;same",expand_item:"fBins",theonly:!0},{name:"TProfile2Poly",sameas:K},{name:"TH2PolyBin",icon:"img_histo2d",draw_field:"fPoly",draw_field_opt:"L"},{name:/^TH2/,icon:"img_histo2d",class:()=>Promise.resolve().then(Te.bind(Te,4862)).then($=>$.TH2Painter),dflt:"col",opt:";COL;COLZ;COL0;COL1;COL0Z;COL1Z;COLA;BOX;BOX1;PROJ;PROJX1;PROJX2;PROJX3;PROJY1;PROJY2;PROJY3;SCAT;TEXT;TEXTE;TEXTE0;CANDLE;CANDLE1;CANDLE2;CANDLE3;CANDLE4;CANDLE5;CANDLE6;CANDLEY1;CANDLEY2;CANDLEY3;CANDLEY4;CANDLEY5;CANDLEY6;VIOLIN;VIOLIN1;VIOLIN2;VIOLINY1;VIOLINY2;CONT;CONT1;CONT2;CONT3;CONT4;ARR;SURF;SURF1;SURF2;SURF4;SURF6;E;A;LEGO;LEGO0;LEGO1;LEGO2;LEGO3;LEGO4;same",ctrl:"lego",expand_item:b,for_derived:!0},{name:V.clTProfile2D,sameas:V.clTH2},{name:/^TH3/,icon:"img_histo3d",class:()=>Promise.resolve().then(Te.bind(Te,5074)).then($=>$.TH3Painter),opt:";SCAT;BOX;BOX2;BOX3;GLBOX1;GLBOX2;GLCOL",expand_item:b,for_derived:!0},{name:V.clTProfile3D,sameas:V.clTH3},{name:V.clTHStack,icon:"img_histo1d",class:()=>Te.e(895).then(Te.bind(Te,895)).then($=>$.THStackPainter),expand_item:"fHists",opt:"NOSTACK;HIST;E;PFC;PLC"},{name:V.clTPolyMarker3D,icon:"img_histo3d",draw:()=>Promise.all([Te.e(76),Te.e(400)]).then(Te.bind(Te,8019)).then($=>$.drawPolyMarker3D),direct:!0,frame:"3d"},{name:V.clTPolyLine3D,icon:"img_graph",draw:()=>Promise.all([Te.e(76),Te.e(400)]).then(Te.bind(Te,8019)).then($=>$.drawPolyLine3D),direct:!0,frame:"3d"},{name:"TGraphStruct"},{name:"TGraphNode"},{name:"TGraphEdge"},{name:V.clTGraphTime,icon:"img_graph",class:()=>Te.e(662).then(Te.bind(Te,5662)).then($=>$.TGraphTimePainter),opt:"once;repeat;first",theonly:!0},{name:ce,icon:"img_graph",class:()=>Te.e(829).then(Te.bind(Te,8829)).then($=>$.TGraph2DPainter),opt:";P;PCOL",theonly:!0},{name:V.clTGraph2DErrors,sameas:ce,opt:";P;PCOL;ERR",theonly:!0},{name:V.clTGraph2DAsymmErrors,sameas:ce,opt:";P;PCOL;ERR",theonly:!0},{name:V.clTGraphPolargram,icon:"img_graph",class:()=>Te.e(265).then(Te.bind(Te,7265)).then($=>$.TGraphPolargramPainter),theonly:!0},{name:V.clTGraphPolar,icon:"img_graph",class:()=>Te.e(265).then(Te.bind(Te,7265)).then($=>$.TGraphPolarPainter),opt:";F;L;P;PE",theonly:!0},{name:/^TGraph/,icon:"img_graph",class:()=>Te.e(825).then(Te.bind(Te,825)).then($=>$.TGraphPainter),opt:";L;P"},{name:"TEfficiency",icon:"img_graph",class:()=>Promise.all([Te.e(825),Te.e(76),Te.e(306)]).then(Te.bind(Te,6306)).then($=>$.TEfficiencyPainter),opt:";AP"},{name:V.clTCutG,sameas:V.clTGraph},{name:/^RooHist/,sameas:V.clTGraph},{name:/^RooCurve/,sameas:V.clTGraph},{name:"TScatter",icon:"img_graph",class:()=>Promise.all([Te.e(825),Te.e(843)]).then(Te.bind(Te,1843)).then($=>$.TScatterPainter),opt:";A"},{name:"RooPlot",icon:"img_canvas",func:function Xe($,tt){return ct.apply(this,arguments)}},{name:"TRatioPlot",icon:"img_mgraph",class:()=>Promise.all([Te.e(76),Te.e(805)]).then(Te.bind(Te,8805)).then($=>$.TRatioPlotPainter),opt:""},{name:V.clTMultiGraph,icon:"img_mgraph",class:()=>Promise.all([Te.e(825),Te.e(76),Te.e(352)]).then(Te.bind(Te,4352)).then($=>$.TMultiGraphPainter),opt:";l;p;3d",expand_item:"fGraphs"},{name:Le.R0,icon:"img_question",draw:()=>re().then($=>$.drawStreamerInfo)},{name:"TWebPainting",icon:"img_graph",class:()=>Te.e(427).then(Te.bind(Te,9427)).then($=>$.TWebPaintingPainter)},{name:P,icon:"img_canvas",draw:()=>Qe().then($=>$.drawTPadSnapshot)},{name:"TPadWebSnapshot",sameas:P},{name:"kind:Text",icon:"img_text",func:st.as},{name:V.clTObjString,icon:"img_text",func:st.as},{name:V.clTF1,icon:"img_tf1",class:()=>Te.e(76).then(Te.bind(Te,9754)).then($=>$.TF1Painter),opt:";L;C;FC;FL"},{name:V.clTF2,icon:"img_tf2",class:()=>Promise.all([Te.e(76),Te.e(191)]).then(Te.bind(Te,191)).then($=>$.TF2Painter),opt:";BOX;ARR;SURF;SURF1;SURF2;SURF4;SURF6;LEGO;LEGO0;LEGO1;LEGO2;LEGO3;LEGO4;same"},{name:V.clTF3,icon:"img_histo3d",class:()=>Promise.all([Te.e(76),Te.e(168)]).then(Te.bind(Te,7168)).then($=>$.TF3Painter),opt:";SURF"},{name:D,icon:"img_tf1",class:()=>Te.e(484).then(Te.bind(Te,8484)).then($=>$.TSplinePainter)},{name:"TSpline5",sameas:D},{name:G,icon:"img_graph",draw:()=>ot().then($=>$.drawEllipse),direct:!0},{name:"TArc",sameas:G},{name:"TCrown",sameas:G},{name:"TPie",icon:"img_graph",draw:()=>ot().then($=>$.drawPie),direct:!0},{name:"TPieSlice",icon:"img_graph",dummy:!0},{name:"TExec",icon:"img_graph",dummy:!0},{name:V.clTLine,icon:"img_graph",class:()=>Te.e(76).then(Te.bind(Te,4755)).then($=>$.TLinePainter)},{name:"TArrow",icon:"img_graph",class:()=>Promise.all([Te.e(76),Te.e(448)]).then(Te.bind(Te,5448)).then($=>$.TArrowPainter)},{name:V.clTPolyLine,icon:"img_graph",draw:()=>ot().then($=>$.drawPolyLine),direct:!0},{name:"TCurlyLine",sameas:V.clTPolyLine},{name:"TCurlyArc",sameas:V.clTPolyLine},{name:"TParallelCoord",icon:"img_graph",dummy:!0},{name:V.clTGaxis,icon:"img_graph",class:()=>Te.e(289).then(Te.bind(Te,2289)).then($=>$.TGaxisPainter)},{name:V.clTBox,icon:"img_graph",draw:()=>ot().then($=>$.drawBox),direct:!0},{name:"TWbox",sameas:V.clTBox},{name:"TSliderBox",sameas:V.clTBox},{name:"TMarker",icon:"img_graph",draw:()=>ot().then($=>$.drawMarker),direct:!0},{name:"TPolyMarker",icon:"img_graph",draw:()=>ot().then($=>$.drawPolyMarker),direct:!0},{name:"TASImage",icon:"img_mgraph",class:()=>Te.e(356).then(Te.bind(Te,5356)).then($=>$.TASImagePainter),opt:";z"},{name:"TJSImage",icon:"img_mgraph",draw:()=>ot().then($=>$.drawJSImage),opt:";scale;center"},{name:V.clTGeoVolume,icon:"img_histo3d",class:()=>de().then($=>$.TGeoPainter),get_expand:()=>de().then($=>$.expandGeoObject),opt:";more;all;count;projx;projz;wire;no_screen;dflt",ctrl:"dflt"},{name:"TEveGeoShapeExtract",sameas:V.clTGeoVolume,opt:";more;all;count;projx;projz;wire;dflt"},{name:V.nsREX+"REveGeoShapeExtract",sameas:V.clTGeoVolume,opt:";more;all;count;projx;projz;wire;dflt"},{name:"TGeoOverlap",sameas:V.clTGeoVolume,opt:";more;all;count;projx;projz;wire;dflt",dflt:"dflt",ctrl:"expand"},{name:"TGeoManager",sameas:V.clTGeoVolume,opt:";more;all;count;projx;projz;wire;tracks;no_screen;dflt",dflt:"expand",ctrl:"dflt",noappend:!0,exapnd_after_draw:!0},{name:"TGeoVolumeAssembly",sameas:V.clTGeoVolume,opt:";more;all;count"},{name:/^TGeo/,class:()=>de().then($=>$.TGeoPainter),get_expand:()=>de().then($=>$.expandGeoObject),opt:";more;all;axis;compa;count;projx;projz;wire;no_screen;dflt",dflt:"dflt",ctrl:"expand"},{name:"TAxis3D",icon:"img_graph",draw:()=>de().then($=>$.drawAxis3D),direct:!0},{name:"kind:Command",icon:"img_execute",execute:!0},{name:"TFolder",icon:"img_folder",icon2:"img_folderopen",noinspect:!0,get_expand:()=>re().then($=>$.folderHierarchy)},{name:"TTask",icon:"img_task",get_expand:()=>re().then($=>$.taskHierarchy),for_derived:!0},{name:x,icon:"img_tree",get_expand:()=>Promise.resolve().then(Te.bind(Te,6119)).then($=>$.treeHierarchy),draw:()=>L().then($=>$.drawTree),dflt:"expand",opt:"player;testio",shift:V.kInspect},{name:"TNtuple",sameas:x},{name:"TNtupleD",sameas:x},{name:xe.clTBranchFunc,icon:"img_leaf_method",draw:()=>L().then($=>$.drawTree),opt:";dump",noinspect:!0},{name:/^TBranch/,icon:"img_branch",draw:()=>L().then($=>$.drawTree),dflt:"expand",opt:";dump",ctrl:"dump",shift:V.kInspect,ignore_online:!0,always_draw:!0},{name:/^TLeaf/,icon:"img_leaf",noexpand:!0,draw:()=>L().then($=>$.drawTree),opt:";dump",ctrl:"dump",ignore_online:!0,always_draw:!0},{name:V.clTList,icon:"img_list",draw:()=>re().then($=>$.drawList),get_expand:()=>re().then($=>$.listHierarchy),dflt:"expand"},{name:V.clTHashList,sameas:V.clTList},{name:V.clTObjArray,sameas:V.clTList},{name:V.clTClonesArray,sameas:V.clTList},{name:V.clTMap,sameas:V.clTList},{name:V.clTColor,icon:"img_color"},{name:V.clTFile,icon:"img_file",noinspect:!0},{name:"TMemFile",icon:"img_file",noinspect:!0},{name:V.clTStyle,icon:"img_question",noexpand:!0},{name:"Session",icon:"img_globe"},{name:"kind:TopFolder",icon:"img_base"},{name:"kind:Folder",icon:"img_folder",icon2:"img_folderopen",noinspect:!0},{name:V.nsREX+"RCanvas",icon:"img_canvas",class:()=>Se().then($=>$.RCanvasPainter),opt:"",expand_item:w},{name:V.nsREX+"RCanvasDisplayItem",icon:"img_canvas",draw:()=>Se().then($=>$.drawRPadSnapshot),opt:"",expand_item:w},{name:V.nsREX+"RHist1Drawable",icon:"img_histo1d",class:()=>Se("rh1").then($=>$.RH1Painter),opt:""},{name:V.nsREX+"RHist2Drawable",icon:"img_histo2d",class:()=>Se("rh2").then($=>$.RH2Painter),opt:""},{name:V.nsREX+"RHist3Drawable",icon:"img_histo3d",class:()=>Se("rh3").then($=>$.RH3Painter),opt:""},{name:V.nsREX+"RHistDisplayItem",icon:"img_histo1d",draw:()=>Se("rh3").then($=>$.drawHistDisplayItem),opt:""},{name:V.nsREX+"RText",icon:"img_text",draw:()=>Se("more").then($=>$.drawText),opt:"",direct:"v7",csstype:"text"},{name:V.nsREX+"RFrameTitle",icon:"img_text",draw:()=>Se().then($=>$.drawRFrameTitle),opt:"",direct:"v7",csstype:"title"},{name:V.nsREX+"RPaletteDrawable",icon:"img_text",class:()=>Se("more").then($=>$.RPalettePainter),opt:""},{name:V.nsREX+"RDisplayHistStat",icon:"img_pavetext",class:()=>Se("pave").then($=>$.RHistStatsPainter),opt:""},{name:V.nsREX+"RLine",icon:"img_graph",draw:()=>Se("more").then($=>$.drawLine),opt:"",direct:"v7",csstype:"line"},{name:V.nsREX+"RBox",icon:"img_graph",draw:()=>Se("more").then($=>$.drawBox),opt:"",direct:"v7",csstype:"box"},{name:V.nsREX+"RMarker",icon:"img_graph",draw:()=>Se("more").then($=>$.drawMarker),opt:"",direct:"v7",csstype:"marker"},{name:V.nsREX+"RPave",icon:"img_pavetext",class:()=>Se("pave").then($=>$.RPavePainter),opt:""},{name:V.nsREX+"RLegend",icon:"img_graph",class:()=>Se("pave").then($=>$.RLegendPainter),opt:""},{name:V.nsREX+"RPaveText",icon:"img_pavetext",class:()=>Se("pave").then($=>$.RPaveTextPainter),opt:""},{name:V.nsREX+"RFrame",icon:"img_frame",draw:()=>Se().then($=>$.drawRFrame),opt:""},{name:V.nsREX+"RFont",icon:"img_text",draw:()=>Se().then($=>$.drawRFont),opt:"",direct:"v7",csstype:"font"},{name:V.nsREX+"RAxisDrawable",icon:"img_frame",draw:()=>Se().then($=>$.drawRAxis),opt:""}],cache:{}};function C($){return g.lst.push($),$}function N($,tt){if(!(0,V.isStr)($))return null;""===tt&&(tt=null);let We=null;if(null===tt&&$ in g.cache)return g.cache[$];const Ne=0===$.indexOf(V.prROOT)?$.slice(5):`kind:${$}`;let Fe=0;for(let ht=0;ht<g.lst.length;++ht){const pt=g.lst[ht];if((0,V.isStr)(pt.name)){if(pt.name!==Ne)continue}else if(!Ne.match(pt.name))continue;if(pt.sameas){const dt=N(V.prROOT+pt.sameas,tt);if(dt){for(const rt in dt)void 0===pt[rt]&&(pt[rt]=dt[rt]);delete pt.sameas}return pt}if(null==tt)return $ in g.cache||(g.cache[$]=pt),pt;if((0,V.isStr)(tt)){if(We||(We=pt),"::expand"===tt){if("expand"in pt||"expand_item"in pt)return pt}else if("opt"in pt){const dt=pt.opt.split(";");for(let rt=0;rt<dt.length;++rt)dt[rt]=dt[rt].toLowerCase();if(dt.indexOf(tt.toLowerCase())>=0)return pt}}else if(tt===Fe)return pt;++Fe}return We}function O($){return(0,V.isStr)($)&&($=N($)),!!(0,V.isObject)($)&&($.func||$.class||$.draw||$.draw_field)}function H($,tt){const We={opts:null,inspect:!1,expand:!1,draw:!1,handle:null};if(!(0,V.isStr)($))return We;let Ne=!1,Fe=!1,ht=!1;(0,V.isStr)(tt)||(tt="");for(let pt=0;pt<1e3;++pt){const dt=N($,pt);if(!(dt&&(We.handle||(We.handle=dt),dt.noinspect&&(Fe=!0),dt.noappend&&(We.noappend=!0),(dt.expand||dt.get_expand||dt.expand_item||dt.can_expand)&&(ht=!0),dt.func||dt.class||dt.draw)))break;if(Ne=!0,!("opt"in dt))continue;const rt=dt.opt.split(";");for(let _t=0;_t<rt.length;++_t)rt[_t]=rt[_t].toLowerCase(),!(0===rt[_t].indexOf("same")&&(We.has_same=!0,tt.indexOf("nosame")>=0))&&(null===We.opts&&(We.opts=[]),We.opts.indexOf(rt[_t])<0&&We.opts.push(rt[_t]));if(dt.theonly)break}return tt.indexOf("noinspect")>=0&&(Fe=!0),Ne&&null===We.opts&&(We.opts=[""]),!Ne&&0===$.indexOf(V.prROOT)&&!Fe&&(We.opts=[]),!Fe&&We.opts&&We.opts.push(V.kInspect),We.inspect=!Fe,We.expand=ht,We.draw=!!We.opts,We}function ie($,tt,We){return z.apply(this,arguments)}function z(){return(z=(0,be.A)(function*($,tt,We){if(!(0,V.isObject)(tt))return Promise.reject(Error("not an object in draw call"));if((0,V.isStr)(We)&&0===We.indexOf(V.kInspect))return re().then(dt=>dt.drawInspector($,tt,We));let Ne,Fe,pt;if("_typename"in tt)Fe="type "+tt._typename,Ne=N(V.prROOT+tt._typename,We);else{if(!("_kind"in tt))return re().then(dt=>dt.drawInspector($,tt,We));Fe="kind "+tt._kind,Ne=N(tt._kind,We)}if(!Ne)return Promise.reject(Error(`Object of ${Fe} cannot be shown with draw`));if(Ne.dummy)return null;if(Ne.draw_field&&tt[Ne.draw_field])return ie($,tt[Ne.draw_field],We||Ne.draw_field_opt);if(!O(Ne)){if(We&&We.indexOf("same")>=0){const dt=(0,st.Nn)($);if((0,V.isFunc)(dt?.performDrop))return dt.performDrop(tt,"",null,We)}return Promise.reject(Error(`Function not specified to draw object ${Fe}`))}function ht(){let dt,rt;return"v7"===Ne.direct?dt=Te.e(919).then(Te.bind(Te,7919)).then(_t=>(rt=new _t.RObjectPainter($,tt,We,Ne.csstype),rt.redraw=Ne.func,_t.ensureRCanvas(rt,Ne.frame||!1))).then(()=>rt.redraw()):Ne.direct?(rt=new st.JW($,tt,We),rt.redraw=Ne.func,dt=Qe().then(_t=>_t.ensureTCanvas(rt,Ne.frame||!1)).then(()=>rt.redraw())):dt=(0,V.getPromise)(Ne.func($,tt,We)),dt.then(_t=>{if(rt||(rt=_t),!1===rt)return null;if(!rt)throw Error(`Fail to draw object ${Fe}`);return(0,V.isObject)(rt)&&!rt.options&&(rt.options={original:We||""}),rt})}if((0,V.isFunc)(Ne.func))return ht();if((0,V.isFunc)(Ne.class))pt=Ne.class().then(dt=>{Ne.func=dt.draw});else if((0,V.isFunc)(Ne.draw))pt=Ne.draw().then(dt=>{Ne.func=dt});else{if(!Ne.func||!(0,V.isStr)(Ne.func))return Promise.reject(Error(`Draw function or class not specified to draw ${Fe}`));if(!Ne.prereq&&!Ne.script)return Promise.reject(Error(`Prerequicities to load ${Ne.func} are not specified`));pt=(V.internals.ignore_v6?Promise.resolve(!0):(0,V._ensureJSROOT)().then(rt=>(Ne.prereq?rt.require(Ne.prereq):Promise.resolve(!0)).then(()=>{if(Ne.script)return(0,V.loadScript)(Ne.script)}).then(()=>rt._complete_loading()))).then(()=>{const rt=(0,V.findFunction)(Ne.func);if(!(0,V.isFunc)(rt))return Promise.reject(Error(`Fail to find function ${Ne.func} after loading ${Ne.prereq||Ne.script}`));Ne.func=rt})}return pt.then(()=>ht())})).apply(this,arguments)}function m($,tt,We){return I.apply(this,arguments)}function I(){return(I=(0,be.A)(function*($,tt,We){if(!(0,V.isObject)(tt))return Promise.reject(Error("not an object in redraw"));const Ne=(0,st.m6)($);let Fe,pt,ht=null;if(tt._typename&&(Fe=N(V.prROOT+tt._typename)),Fe?.draw_field&&tt[Fe.draw_field]&&(tt=tt[Fe.draw_field]),Ne)if(Ne.matchObjectType(tt._typename))pt=Ne.redrawObject(tt,We),pt&&(ht=Ne);else for(let dt=0;dt<Ne.painters.length;++dt){const rt=Ne.painters[dt];if(rt.matchObjectType(tt._typename)&&(pt=rt.redrawObject(tt,We),pt)){ht=rt;break}}else{const dt=new Je.b8($).getTopPainter();(0,V.isFunc)(dt?.redrawObject)&&(pt=dt.redrawObject(tt,We),pt&&(ht=dt))}return ht?(0,V.getPromise)(pt).then(()=>ht):((0,st.tP)($),ie($,tt,We))})).apply(this,arguments)}function ve($){$.prototype.drawObject=(...tt)=>ie(...tt).catch(We=>(console.log(`Error ${We?.message??We}  at ${We?.stack??"uncknown place"}`),null)),$.prototype.getObjectDrawSettings=H}function Se($){return De.apply(this,arguments)}function De(){return(De=(0,be.A)(function*($){return Te.e(919).then(Te.bind(Te,7919)).then(tt=>{switch(ve(tt.RPadPainter),$){case"more":return Promise.all([Te.e(919),Te.e(270)]).then(Te.bind(Te,8270));case"pave":return Promise.all([Te.e(919),Te.e(19)]).then(Te.bind(Te,3019));case"rh1":return Promise.all([Te.e(919),Te.e(815),Te.e(294)]).then(Te.bind(Te,7294));case"rh2":return Promise.all([Te.e(919),Te.e(815),Te.e(681)]).then(Te.bind(Te,9681));case"rh3":return Promise.all([Te.e(919),Te.e(815),Te.e(681),Te.e(294),Te.e(156)]).then(Te.bind(Te,8156))}return tt})})).apply(this,arguments)}function ct(){return ct=(0,be.A)(function*($,tt){return ie($,tt._hist,"hist").then(function(){var We=(0,be.A)(function*(Ne){const Fe=[];for(let ht=0;ht<tt._items.arr.length;++ht)Fe.push(ie($,tt._items.arr[ht],tt._items.opt[ht]));return Promise.all(Fe).then(()=>Ne)});return function(Ne){return We.apply(this,arguments)}}())}),ct.apply(this,arguments)}V.internals.addDrawFunc=C,ve(Ke.jg),V.internals.addStreamerInfosForPainter=function A($){if(!$)return;const tt=[V.clTObject,V.clTNamed,V.clTString,"TCollection",V.clTAttLine,V.clTAttFill,V.clTAttMarker,V.clTAttText];function We(Ne,Fe){const ht=Ne.fElements?.arr[0];if("BASE"!==ht?.fTypeName||Fe>4||tt.indexOf(ht.fName)>=0)return null;let pt=N(V.prROOT+ht.fName);if(pt&&!pt.for_derived&&(pt=null),null===pt)for(let dt=0;dt<$.arr.length;++dt)if($.arr[dt].fName===ht.fName){pt=We($.arr[dt],Fe+1);break}return pt?.for_derived?pt:null}$.arr.forEach(Ne=>{if(null!==N(V.prROOT+Ne.fName))return;const Fe=We(Ne,0);if(Fe){const ht=Object.assign({},Fe);delete ht.for_derived,ht.name=Ne.fName,C(ht)}})}},3402:(Gr,xt,Te)=>{"use strict";Te.r(xt),Te.d(xt,{ClonedNodes:()=>X.De,GeoDrawingControl:()=>pt,TGeoPainter:()=>cn,build:()=>fs,createGeoPainter:()=>Ln,drawAxis3D:()=>ms,drawDummy3DGeom:()=>Mr,expandGeoObject:()=>$,produceRenderOrder:()=>X.Pz});var be=Te(5774),v=Te(4186),V=Te(5225),Le=Te(541),xe=Te(9606);class Je{constructor(W,me,_e,Be,gt="div"){this.parent=W,this.object=me,this.property=_e,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(Be),this.$name=document.createElement("div"),this.$name.classList.add("name"),Je.nextNameID=Je.nextNameID||0,this.$name.id="lil-gui-name-"+ ++Je.nextNameID,this.$widget=document.createElement(gt),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",Et=>Et.stopPropagation()),this.domElement.addEventListener("keyup",Et=>Et.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(_e)}name(W){return this._name=W,this.$name.innerHTML=W,this}onChange(W){return this._onChange=W,this}_callOnChange(){this.parent._callOnChange(this),void 0!==this._onChange&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(W){return this._onFinishChange=W,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),void 0!==this._onFinishChange&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(W=!0){return this.disable(!W)}disable(W=!0){return W===this._disabled||(this._disabled=W,this.domElement.classList.toggle("disabled",W),this.$disable.toggleAttribute("disabled",W)),this}show(W=!0){return this._hidden=!W,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(W){const me=this.parent.add(this.object,this.property,W);return me.name(this._name),this.destroy(),me}min(W){return this}max(W){return this}step(W){return this}decimals(W){return this}listen(W=!0){return this._listening=W,void 0!==this._listenCallbackID&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const W=this.save();W!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=W}getValue(){return this.object[this.property]}setValue(W){return this.object[this.property]=W,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(W){return this.setValue(W),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class st extends Je{constructor(W,me,_e){super(W,me,_e,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function Ke(wt){let W,me;return(W=wt.match(/(#|0x)?([a-f0-9]{6})/i))?me=W[2]:(W=wt.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?me=parseInt(W[1]).toString(16).padStart(2,0)+parseInt(W[2]).toString(16).padStart(2,0)+parseInt(W[3]).toString(16).padStart(2,0):(W=wt.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(me=W[1]+W[1]+W[2]+W[2]+W[3]+W[3]),!!me&&"#"+me}const Re={isPrimitive:!0,match:wt=>"number"==typeof wt,fromHexString:wt=>parseInt(wt.substring(1),16),toHexString:wt=>"#"+wt.toString(16).padStart(6,0)},L=[{isPrimitive:!0,match:wt=>"string"==typeof wt,fromHexString:Ke,toHexString:Ke},Re,{isPrimitive:!1,match:wt=>Array.isArray(wt),fromHexString(wt,W,me=1){const _e=Re.fromHexString(wt);W[0]=(_e>>16&255)/255*me,W[1]=(_e>>8&255)/255*me,W[2]=(255&_e)/255*me},toHexString:([wt,W,me],_e=1)=>Re.toHexString(wt*(_e=255/_e)<<16^W*_e<<8^me*_e)},{isPrimitive:!1,match:wt=>Object(wt)===wt,fromHexString(wt,W,me=1){const _e=Re.fromHexString(wt);W.r=(_e>>16&255)/255*me,W.g=(_e>>8&255)/255*me,W.b=(255&_e)/255*me},toHexString:({r:wt,g:W,b:me},_e=1)=>Re.toHexString(wt*(_e=255/_e)<<16^W*_e<<8^me*_e)}];class re extends Je{constructor(W,me,_e,Be){super(W,me,_e,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=function he(wt){return L.find(W=>W.match(wt))}(this.initialValue),this._rgbScale=Be,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const gt=Ke(this.$text.value);gt&&this._setValueFromHexString(gt)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(W){if(this._format.isPrimitive){const me=this._format.fromHexString(W);this.setValue(me)}else this._format.fromHexString(W,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(W){return this._setValueFromHexString(W),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class fe extends Je{constructor(W,me,_e){super(W,me,_e,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",Be=>{Be.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class de extends Je{constructor(W,me,_e,Be,gt,Et){super(W,me,_e,"number"),this._initInput(),this.min(Be),this.max(gt);const Mt=void 0!==Et;this.step(Mt?Et:this._getImplicitStep(),Mt),this.updateDisplay()}decimals(W){return this._decimals=W,this.updateDisplay(),this}min(W){return this._min=W,this._onUpdateMinMax(),this}max(W){return this._max=W,this._onUpdateMinMax(),this}step(W,me=!0){return this._step=W,this._stepExplicit=me,this}updateDisplay(){const W=this.getValue();if(this._hasSlider){let me=(W-this._min)/(this._max-this._min);me=Math.max(0,Math.min(me,1)),this.$fill.style.width=100*me+"%"}return this._inputFocused||(this.$input.value=void 0===this._decimals?W:W.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const _e=ei=>{const Yi=parseFloat(this.$input.value);isNaN(Yi)||(this._snapClampSetValue(Yi+ei),this.$input.value=this.getValue())};let Mt,Nt,Qt,Zt,dn,Et=!1;const ai=ei=>{if(Et){const Yi=ei.clientX-Mt;Math.abs(ei.clientY-Nt)>5?(ei.preventDefault(),this.$input.blur(),Et=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(Yi)>5&&$n()}Et||(dn-=(ei.clientY-Qt)*this._step*this._arrowKeyMultiplier(ei),Zt+dn>this._max?dn=this._max-Zt:Zt+dn<this._min&&(dn=this._min-Zt),this._snapClampSetValue(Zt+dn)),Qt=ei.clientY},$n=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",ai),window.removeEventListener("mouseup",$n)};this.$input.addEventListener("input",()=>{let ei=parseFloat(this.$input.value);isNaN(ei)||(this._stepExplicit&&(ei=this._snap(ei)),this.setValue(this._clamp(ei)))}),this.$input.addEventListener("keydown",ei=>{"Enter"===ei.key&&this.$input.blur(),"ArrowUp"===ei.code&&(ei.preventDefault(),_e(this._step*this._arrowKeyMultiplier(ei))),"ArrowDown"===ei.code&&(ei.preventDefault(),_e(this._step*this._arrowKeyMultiplier(ei)*-1))}),this.$input.addEventListener("wheel",ei=>{this._inputFocused&&(ei.preventDefault(),_e(this._step*this._normalizeMouseWheel(ei)))},{passive:!1}),this.$input.addEventListener("mousedown",ei=>{Mt=ei.clientX,Nt=Qt=ei.clientY,Et=!0,Zt=this.getValue(),dn=0,window.addEventListener("mousemove",ai),window.addEventListener("mouseup",$n)}),this.$input.addEventListener("focus",()=>{this._inputFocused=!0}),this.$input.addEventListener("blur",()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()})}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const me=Rn=>{const ei=this.$slider.getBoundingClientRect();let Yi=((Rn,ei,Yi,Ue)=>(Rn-ei)/(Yi-ei)*(this._max-Ue)+Ue)(Rn,ei.left,ei.right,this._min);this._snapClampSetValue(Yi)},Be=Rn=>{me(Rn.clientX)},gt=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",Be),window.removeEventListener("mouseup",gt)};let Mt,Nt,Et=!1;const Qt=Rn=>{Rn.preventDefault(),this._setDraggingStyle(!0),me(Rn.touches[0].clientX),Et=!1},dn=Rn=>{if(Et){const Yi=Rn.touches[0].clientY-Nt;Math.abs(Rn.touches[0].clientX-Mt)>Math.abs(Yi)?Qt(Rn):(window.removeEventListener("touchmove",dn),window.removeEventListener("touchend",vn))}else Rn.preventDefault(),me(Rn.touches[0].clientX)},vn=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",dn),window.removeEventListener("touchend",vn)},Fn=this._callOnFinishChange.bind(this);let $n;this.$slider.addEventListener("mousedown",Rn=>{this._setDraggingStyle(!0),me(Rn.clientX),window.addEventListener("mousemove",Be),window.addEventListener("mouseup",gt)}),this.$slider.addEventListener("touchstart",Rn=>{Rn.touches.length>1||(this._hasScrollBar?(Mt=Rn.touches[0].clientX,Nt=Rn.touches[0].clientY,Et=!0):Qt(Rn),window.addEventListener("touchmove",dn,{passive:!1}),window.addEventListener("touchend",vn))},{passive:!1}),this.$slider.addEventListener("wheel",Rn=>{if(Math.abs(Rn.deltaX)<Math.abs(Rn.deltaY)&&this._hasScrollBar)return;Rn.preventDefault();const Yi=this._normalizeMouseWheel(Rn)*this._step;this._snapClampSetValue(this.getValue()+Yi),this.$input.value=this.getValue(),clearTimeout($n),$n=setTimeout(Fn,400)},{passive:!1})}_setDraggingStyle(W,me="horizontal"){this.$slider&&this.$slider.classList.toggle("active",W),document.body.classList.toggle("lil-gui-dragging",W),document.body.classList.toggle(`lil-gui-${me}`,W)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(W){let{deltaX:me,deltaY:_e}=W;return Math.floor(W.deltaY)!==W.deltaY&&W.wheelDelta&&(me=0,_e=-W.wheelDelta/120,_e*=this._stepExplicit?1:10),me+-_e}_arrowKeyMultiplier(W){let me=this._stepExplicit?1:10;return W.shiftKey?me*=10:W.altKey&&(me/=10),me}_snap(W){const me=Math.round(W/this._step)*this._step;return parseFloat(me.toPrecision(15))}_clamp(W){return W<this._min&&(W=this._min),W>this._max&&(W=this._max),W}_snapClampSetValue(W){this.setValue(this._clamp(this._snap(W)))}get _hasScrollBar(){const W=this.parent.root.$children;return W.scrollHeight>W.clientHeight}get _hasMin(){return void 0!==this._min}get _hasMax(){return void 0!==this._max}}class pe extends Je{constructor(W,me,_e,Be){super(W,me,_e,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(Be)?Be:Object.values(Be),this._names=Array.isArray(Be)?Be:Object.keys(Be),this._names.forEach(gt=>{const Et=document.createElement("option");Et.innerHTML=gt,this.$select.appendChild(Et)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const W=this.getValue(),me=this._values.indexOf(W);return this.$select.selectedIndex=me,this.$display.innerHTML=-1===me?W:this._names[me],this}}class ce extends Je{constructor(W,me,_e){super(W,me,_e,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",Be=>{"Enter"===Be.code&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let D=!1;class x{constructor({parent:W,autoPlace:me=void 0===W,container:_e,width:Be,title:gt="Controls",closeFolders:Et=!1,injectStyles:Mt=!0,touchStyles:Nt=!0}={}){if(this.parent=W,this.root=W?W.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",Qt=>{("Enter"===Qt.code||"Space"===Qt.code)&&(Qt.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(gt),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),Nt&&this.domElement.classList.add("allow-touch-styles"),!D&&Mt&&(function G(wt){const W=document.createElement("style");W.innerHTML=wt;const me=document.querySelector("head link[rel=stylesheet], head style");me?document.head.insertBefore(W,me):document.head.appendChild(W)}('.lil-gui {\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  line-height: 1;\n  font-weight: normal;\n  font-style: normal;\n  text-align: left;\n  background-color: var(--background-color);\n  color: var(--text-color);\n  user-select: none;\n  -webkit-user-select: none;\n  touch-action: manipulation;\n  --background-color: #1f1f1f;\n  --text-color: #ebebeb;\n  --title-background-color: #111111;\n  --title-text-color: #ebebeb;\n  --widget-color: #424242;\n  --hover-color: #4f4f4f;\n  --focus-color: #595959;\n  --number-color: #2cc9ff;\n  --string-color: #a2db3c;\n  --font-size: 11px;\n  --input-font-size: 11px;\n  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;\n  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;\n  --padding: 4px;\n  --spacing: 4px;\n  --widget-height: 20px;\n  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);\n  --name-width: 45%;\n  --slider-knob-width: 2px;\n  --slider-input-width: 27%;\n  --color-input-width: 27%;\n  --slider-input-min-width: 45px;\n  --color-input-min-width: 45px;\n  --folder-indent: 7px;\n  --widget-padding: 0 0 0 3px;\n  --widget-border-radius: 2px;\n  --checkbox-size: calc(0.75 * var(--widget-height));\n  --scrollbar-width: 5px;\n}\n.lil-gui, .lil-gui * {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.lil-gui.root {\n  width: var(--width, 245px);\n  display: flex;\n  flex-direction: column;\n}\n.lil-gui.root > .title {\n  background: var(--title-background-color);\n  color: var(--title-text-color);\n}\n.lil-gui.root > .children {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.lil-gui.root > .children::-webkit-scrollbar {\n  width: var(--scrollbar-width);\n  height: var(--scrollbar-width);\n  background: var(--background-color);\n}\n.lil-gui.root > .children::-webkit-scrollbar-thumb {\n  border-radius: var(--scrollbar-width);\n  background: var(--focus-color);\n}\n@media (pointer: coarse) {\n  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {\n    --widget-height: 28px;\n    --padding: 6px;\n    --spacing: 6px;\n    --font-size: 13px;\n    --input-font-size: 16px;\n    --folder-indent: 10px;\n    --scrollbar-width: 7px;\n    --slider-input-min-width: 50px;\n    --color-input-min-width: 65px;\n  }\n}\n.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {\n  --widget-height: 28px;\n  --padding: 6px;\n  --spacing: 6px;\n  --font-size: 13px;\n  --input-font-size: 16px;\n  --folder-indent: 10px;\n  --scrollbar-width: 7px;\n  --slider-input-min-width: 50px;\n  --color-input-min-width: 65px;\n}\n.lil-gui.autoPlace {\n  max-height: 100%;\n  position: fixed;\n  top: 0;\n  right: 15px;\n  z-index: 1001;\n}\n\n.lil-gui .controller {\n  display: flex;\n  align-items: center;\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n}\n.lil-gui .controller.disabled {\n  opacity: 0.5;\n}\n.lil-gui .controller.disabled, .lil-gui .controller.disabled * {\n  pointer-events: none !important;\n}\n.lil-gui .controller > .name {\n  min-width: var(--name-width);\n  flex-shrink: 0;\n  white-space: pre;\n  padding-right: var(--spacing);\n  line-height: var(--widget-height);\n}\n.lil-gui .controller .widget {\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  min-height: var(--widget-height);\n}\n.lil-gui .controller.string input {\n  color: var(--string-color);\n}\n.lil-gui .controller.boolean .widget {\n  cursor: pointer;\n}\n.lil-gui .controller.color .display {\n  width: 100%;\n  height: var(--widget-height);\n  border-radius: var(--widget-border-radius);\n  position: relative;\n}\n@media (hover: hover) {\n  .lil-gui .controller.color .display:hover:before {\n    content: " ";\n    display: block;\n    position: absolute;\n    border-radius: var(--widget-border-radius);\n    border: 1px solid #fff9;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n}\n.lil-gui .controller.color input[type=color] {\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n}\n.lil-gui .controller.color input[type=text] {\n  margin-left: var(--spacing);\n  font-family: var(--font-family-mono);\n  min-width: var(--color-input-min-width);\n  width: var(--color-input-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.option select {\n  opacity: 0;\n  position: absolute;\n  width: 100%;\n  max-width: 100%;\n}\n.lil-gui .controller.option .display {\n  position: relative;\n  pointer-events: none;\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  line-height: var(--widget-height);\n  max-width: 100%;\n  overflow: hidden;\n  word-break: break-all;\n  padding-left: 0.55em;\n  padding-right: 1.75em;\n  background: var(--widget-color);\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .display.focus {\n    background: var(--focus-color);\n  }\n}\n.lil-gui .controller.option .display.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.option .display:after {\n  font-family: "lil-gui";\n  content: "\u2195";\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  padding-right: 0.375em;\n}\n.lil-gui .controller.option .widget,\n.lil-gui .controller.option select {\n  cursor: pointer;\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .widget:hover .display {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number input {\n  color: var(--number-color);\n}\n.lil-gui .controller.number.hasSlider input {\n  margin-left: var(--spacing);\n  width: var(--slider-input-width);\n  min-width: var(--slider-input-min-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.number .slider {\n  width: 100%;\n  height: var(--widget-height);\n  background-color: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  padding-right: var(--slider-knob-width);\n  overflow: hidden;\n  cursor: ew-resize;\n  touch-action: pan-y;\n}\n@media (hover: hover) {\n  .lil-gui .controller.number .slider:hover {\n    background-color: var(--hover-color);\n  }\n}\n.lil-gui .controller.number .slider.active {\n  background-color: var(--focus-color);\n}\n.lil-gui .controller.number .slider.active .fill {\n  opacity: 0.95;\n}\n.lil-gui .controller.number .fill {\n  height: 100%;\n  border-right: var(--slider-knob-width) solid var(--number-color);\n  box-sizing: content-box;\n}\n\n.lil-gui-dragging .lil-gui {\n  --hover-color: var(--widget-color);\n}\n.lil-gui-dragging * {\n  cursor: ew-resize !important;\n}\n\n.lil-gui-dragging.lil-gui-vertical * {\n  cursor: ns-resize !important;\n}\n\n.lil-gui .title {\n  height: var(--title-height);\n  line-height: calc(var(--title-height) - 4px);\n  font-weight: 600;\n  padding: 0 var(--padding);\n  -webkit-tap-highlight-color: transparent;\n  cursor: pointer;\n  outline: none;\n  text-decoration-skip: objects;\n}\n.lil-gui .title:before {\n  font-family: "lil-gui";\n  content: "\u25be";\n  padding-right: 2px;\n  display: inline-block;\n}\n.lil-gui .title:active {\n  background: var(--title-background-color);\n  opacity: 0.75;\n}\n@media (hover: hover) {\n  body:not(.lil-gui-dragging) .lil-gui .title:hover {\n    background: var(--title-background-color);\n    opacity: 0.85;\n  }\n  .lil-gui .title:focus {\n    text-decoration: underline var(--focus-color);\n  }\n}\n.lil-gui.root > .title:focus {\n  text-decoration: none !important;\n}\n.lil-gui.closed > .title:before {\n  content: "\u25b8";\n}\n.lil-gui.closed > .children {\n  transform: translateY(-7px);\n  opacity: 0;\n}\n.lil-gui.closed:not(.transition) > .children {\n  display: none;\n}\n.lil-gui.transition > .children {\n  transition-duration: 300ms;\n  transition-property: height, opacity, transform;\n  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);\n  overflow: hidden;\n  pointer-events: none;\n}\n.lil-gui .children:empty:before {\n  content: "Empty";\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n  display: block;\n  height: var(--widget-height);\n  font-style: italic;\n  line-height: var(--widget-height);\n  opacity: 0.5;\n}\n.lil-gui.root > .children > .lil-gui > .title {\n  border: 0 solid var(--widget-color);\n  border-width: 1px 0;\n  transition: border-color 300ms;\n}\n.lil-gui.root > .children > .lil-gui.closed > .title {\n  border-bottom-color: transparent;\n}\n.lil-gui + .controller {\n  border-top: 1px solid var(--widget-color);\n  margin-top: 0;\n  padding-top: var(--spacing);\n}\n.lil-gui .lil-gui .lil-gui > .title {\n  border: none;\n}\n.lil-gui .lil-gui .lil-gui > .children {\n  border: none;\n  margin-left: var(--folder-indent);\n  border-left: 2px solid var(--widget-color);\n}\n.lil-gui .lil-gui .controller {\n  border: none;\n}\n\n.lil-gui input {\n  -webkit-tap-highlight-color: transparent;\n  border: 0;\n  outline: none;\n  font-family: var(--font-family);\n  font-size: var(--input-font-size);\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  background: var(--widget-color);\n  color: var(--text-color);\n  width: 100%;\n}\n@media (hover: hover) {\n  .lil-gui input:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui input:active {\n    background: var(--focus-color);\n  }\n}\n.lil-gui input:disabled {\n  opacity: 1;\n}\n.lil-gui input[type=text],\n.lil-gui input[type=number] {\n  padding: var(--widget-padding);\n}\n.lil-gui input[type=text]:focus,\n.lil-gui input[type=number]:focus {\n  background: var(--focus-color);\n}\n.lil-gui input::-webkit-outer-spin-button,\n.lil-gui input::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n.lil-gui input[type=number] {\n  -moz-appearance: textfield;\n}\n.lil-gui input[type=checkbox] {\n  appearance: none;\n  -webkit-appearance: none;\n  height: var(--checkbox-size);\n  width: var(--checkbox-size);\n  border-radius: var(--widget-border-radius);\n  text-align: center;\n  cursor: pointer;\n}\n.lil-gui input[type=checkbox]:checked:before {\n  font-family: "lil-gui";\n  content: "\u2713";\n  font-size: var(--checkbox-size);\n  line-height: var(--checkbox-size);\n}\n@media (hover: hover) {\n  .lil-gui input[type=checkbox]:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button {\n  -webkit-tap-highlight-color: transparent;\n  outline: none;\n  cursor: pointer;\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  color: var(--text-color);\n  width: 100%;\n  height: var(--widget-height);\n  text-transform: none;\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  border: 1px solid var(--widget-color);\n  text-align: center;\n  line-height: calc(var(--widget-height) - 4px);\n}\n@media (hover: hover) {\n  .lil-gui button:hover {\n    background: var(--hover-color);\n    border-color: var(--hover-color);\n  }\n  .lil-gui button:focus {\n    border-color: var(--focus-color);\n  }\n}\n.lil-gui button:active {\n  background: var(--focus-color);\n}\n\n@font-face {\n  font-family: "lil-gui";\n  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");\n}'),D=!0),_e?_e.appendChild(this.domElement):me&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),Be&&this.domElement.style.setProperty("--width",Be+"px"),this._closeFolders=Et}add(W,me,_e,Be,gt){if(Object(_e)===_e)return new pe(this,W,me,_e);const Et=W[me];switch(typeof Et){case"number":return new de(this,W,me,_e,Be,gt);case"boolean":return new st(this,W,me);case"string":return new ce(this,W,me);case"function":return new fe(this,W,me)}console.error("gui.add failed\n\tproperty:",me,"\n\tobject:",W,"\n\tvalue:",Et)}addColor(W,me,_e=1){return new re(this,W,me,_e)}addFolder(W){const me=new x({parent:this,title:W});return this.root._closeFolders&&me.close(),me}load(W,me=!0){return W.controllers&&this.controllers.forEach(_e=>{_e instanceof fe||_e._name in W.controllers&&_e.load(W.controllers[_e._name])}),me&&W.folders&&this.folders.forEach(_e=>{_e._title in W.folders&&_e.load(W.folders[_e._title])}),this}save(W=!0){const me={controllers:{},folders:{}};return this.controllers.forEach(_e=>{if(!(_e instanceof fe)){if(_e._name in me.controllers)throw new Error(`Cannot save GUI with duplicate property "${_e._name}"`);me.controllers[_e._name]=_e.save()}}),W&&this.folders.forEach(_e=>{if(_e._title in me.folders)throw new Error(`Cannot save GUI with duplicate folder "${_e._title}"`);me.folders[_e._title]=_e.save()}),me}open(W=!0){return this._setClosed(!W),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(W){this._closed!==W&&(this._closed=W,this._callOnOpenClose(this))}show(W=!0){return this._hidden=!W,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(W=!0){return this._setClosed(!W),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{this.$children.style.height=this.$children.clientHeight+"px",this.domElement.classList.add("transition");const _e=gt=>{gt.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",_e))};this.$children.addEventListener("transitionend",_e);const Be=W?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!W),requestAnimationFrame(()=>{this.$children.style.height=Be+"px"})}),this}title(W){return this._title=W,this.$title.innerHTML=W,this}reset(W=!0){return(W?this.controllersRecursive():this.controllers).forEach(_e=>_e.reset()),this}onChange(W){return this._onChange=W,this}_callOnChange(W){this.parent&&this.parent._callOnChange(W),void 0!==this._onChange&&this._onChange.call(this,{object:W.object,property:W.property,value:W.getValue(),controller:W})}onFinishChange(W){return this._onFinishChange=W,this}_callOnFinishChange(W){this.parent&&this.parent._callOnFinishChange(W),void 0!==this._onFinishChange&&this._onFinishChange.call(this,{object:W.object,property:W.property,value:W.getValue(),controller:W})}onOpenClose(W){return this._onOpenClose=W,this}_callOnOpenClose(W){this.parent&&this.parent._callOnOpenClose(W),void 0!==this._onOpenClose&&this._onOpenClose.call(this,W)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(W=>W.destroy())}controllersRecursive(){let W=Array.from(this.controllers);return this.folders.forEach(me=>{W=W.concat(me.controllersRecursive())}),W}foldersRecursive(){let W=Array.from(this.folders);return this.folders.forEach(me=>{W=W.concat(me.foldersRecursive())}),W}}var w=Te(2009),b=Te(139),g=Te(165),C=Te(2481),N=Te(9646),O=Te(6856),H=Te(2725),X=Te(5320);const m="TGeoManager",I="TEveGeoShapeExtract",A="TGeoOverlap",R="TGeoVolumeAssembly",k="TEveTrack",ee="TEvePointSet",ge=`${v.nsREX}REveGeoShapeExtract`;let Se=0;function De(wt,W,me){void 0===W&&(W=1),me||(Se=0,me="");const _e=(0,v.create)(v.clTGeoVolume);if((0,X.bg)(_e,X.Wv.kVisThis,!0),(0,X.bg)(_e,X.Wv.kVisDaughters,!0),me&&wt._typename!==X.HO||W<=0)return _e.fName=me,_e.fLineColor=Se++%8+2,_e.fShape=wt,_e;me&&(me+="/"),_e.$geoh=!0,_e.fName="";const Be=(0,v.create)(v.clTGeoNodeMatrix);(0,X.bg)(Be,X.Wv.kVisThis,!0),(0,X.bg)(Be,X.Wv.kVisDaughters,!0),Be.fName="Left",Be.fMatrix=wt.fNode.fLeftMat,Be.fVolume=De(wt.fNode.fLeft,W-1,me+"Left");const gt=(0,v.create)(v.clTGeoNodeMatrix);return(0,X.bg)(gt,X.Wv.kVisThis,!0),(0,X.bg)(gt,X.Wv.kVisDaughters,!0),gt.fName="Right",gt.fMatrix=wt.fNode.fRightMat,gt.fVolume=De(wt.fNode.fRight,W-1,me+"Right"),_e.fNodes=(0,v.create)(v.clTList),_e.fNodes.Add(Be),_e.fNodes.Add(gt),me||(Se=0),_e}function Xe(wt){const W=wt?.getFramePainter();if(wt?.mode3d&&(0,v.isFunc)(W?.create3DScene)&&W?.renderer){let me=1,_e=1,Be=1,gt=0,Et=0,Mt=0;return W.scale_xmax>W.scale_xmin&&(me=2*W.size_x3d/(W.scale_xmax-W.scale_xmin),gt=(W.scale_xmax+W.scale_xmin)/2*me),W.scale_ymax>W.scale_ymin&&(_e=2*W.size_y3d/(W.scale_ymax-W.scale_ymin),Et=(W.scale_ymax+W.scale_ymin)/2*_e),W.scale_zmax>W.scale_zmin&&(Be=2*W.size_z3d/(W.scale_zmax-W.scale_zmin),Mt=(W.scale_zmax+W.scale_zmin)/2*Be-W.size_z3d),{webgl:W.webgl,scene:W.scene,scene_width:W.scene_width,scene_height:W.scene_height,toplevel:W.toplevel,renderer:W.renderer,camera:W.camera,scale_x:me,scale_y:_e,scale_z:Be,offset_x:gt,offset_y:Et,offset_z:Mt}}}function ct(wt,W,me,_e){if(!W?.arr?.length)return;const Be={_name:me,_kind:v.prROOT+v.clTList,_title:_e,_more:!0,_geoobj:W,_parent:wt,_get:gt=>Promise.resolve(gt._geoobj||null),_expand(gt,Et){if(Et.fVolume&&(Et=Et.fVolume.fNodes),!Et.arr)return!1;gt._childs=[],(0,X.$T)(null,Et.arr);for(const Mt in Et.arr)qi(gt,Et.arr[Mt]);return!0}};wt._childs||(wt._childs=[]),wt._childs.push(Be)}function $(wt,W){if(Cn(),!wt||!W)return!1;const me=0===W._typename.indexOf(v.clTGeoNode),_e=0===W._typename.indexOf(v.clTGeoVolume),Be=W._typename===m,gt=W._typename===I||W._typename===ge,Et=W._typename===A;if(!(me||_e||Be||gt||Et))return!1;if(wt._childs)return!0;if(Be)return ct(wt,W.fMaterials,"Materials","list of materials"),ct(wt,W.fMedia,"Media","list of media"),ct(wt,W.fTracks,"Tracks","list of tracks"),ct(wt,W.fOverlaps,"Overlaps","list of detected overlaps"),qi(wt,W.fMasterVolume),!0;if(Et)return qi(wt,W.fVolume1),qi(wt,W.fVolume2),qi(wt,W.fMarker,"Marker"),!0;let Mt,Nt,Qt;if(gt?(Nt=W.fElements?.arr,Qt=W.fShape):(Mt=me?W.fVolume:W,Nt=Mt?.fNodes?.arr,Qt=Mt?.fShape),!Nt&&Qt?._typename===X.HO&&Qt?.fNode)return wt._childs||(qi(wt,Qt.fNode.fLeft,"Left"),qi(wt,Qt.fNode.fRight,"Right")),!0;if(!Nt)return!1;(0,X.$T)(W,Nt);for(let Zt=0;Zt<Nt.length;++Zt)qi(wt,Nt[Zt]);return!0}function tt(wt,W){for(;wt;){if(wt._painter?._camera)return W&&(0,v.isFunc)(wt._painter[W])&&wt._painter[W](),wt;wt=wt._parent}return null}function We(wt){if(wt._typename===I||wt._typename===ge)return wt.fRnrSelf?" geovis_this":"";const W=!(0,X.zL)(wt,X.Wv.kVisNone)&&(0,X.zL)(wt,X.Wv.kVisThis);let me=(0,X.zL)(wt,X.Wv.kVisDaughters);return me&&!wt.fNodes?.arr?.length&&(me=!1),W&&me?" geovis_all":W?" geovis_this":me?" geovis_daughters":""}function Ne(wt,W){!wt||!W||W.forEachItem(me=>{(wt===me._volume||wt===me._geoobj)&&(me._icon=me._icon.split(" ")[0]+We(wt),W.updateTreeNode(me))})}function Fe(wt){const W=wt?.object;return W?W.stack?W.stack:W.stacks&&void 0!==wt.instanceId&&wt.instanceId<W.stacks.length?W.stacks[wt.instanceId]:void 0:null}class ht{constructor(W,me,_e){this.bright=me,this.buttons=_e,this.element=W.append("div").attr("style","float: left; box-sizing: border-box; position: relative; bottom: 23px; vertical-align: middle; padding-left: 5px")}createButtons(){const W=[];this.buttons.forEach(me=>{const _e=me.name;if(!_e)throw new Error("must provide button name in button config");if(-1!==W.indexOf(_e))throw new Error(`button name ${_e} is taken`);W.push(_e);const Be=me.title||me.name;if(!(0,v.isFunc)(me.click))throw new Error("must provide button click() function in button config");xe.IK.createSVG(this.element,xe.IK[me.icon],16,Be,this.bright).on("click",me.click).style("position","relative").style("padding","3px 1px")})}changeBrightness(W){this.bright!==W&&(this.element.selectAll("*").remove(),this.bright=W,this.createButtons())}cleanup(){this.element?.remove(),delete this.element}}class pt extends w.KG{constructor(W,me){super(),this.mesh=W?.material?W:null,this.bloom=me}setHighlight(W,me){return this.drawSpecial(W,me)}drawSpecial(W,me){const _e=this.mesh;if(_e?.material){if(_e.isInstancedMesh){if(_e._highlight_mesh&&(_e.remove(_e._highlight_mesh),delete _e._highlight_mesh),W&&void 0!==me){const Be=new V.eaF(_e.geometry,_e.material.clone());this.bloom?(Be.layers.enable(1),Be.material.emissive=new V.Q1f(65280)):(Be.material.color=new V.Q1f(W),Be.material.opacity=1);const gt=new V.kn4;_e.getMatrixAt(me,gt),Be.applyMatrix4(gt),_e.add(Be),Be.jsroot_special=!0,_e._highlight_mesh=Be}return!0}if(W)return _e.origin||(_e.origin={color:_e.material.color,emissive:_e.material.emissive,opacity:_e.material.opacity,width:_e.material.linewidth,size:_e.material.size}),this.bloom?(_e.layers.enable(1),_e.material.emissive=new V.Q1f(65280)):(_e.material.color=new V.Q1f(W),_e.material.opacity=1),_e.hightlightWidthScale&&!v.browser.isWin&&(_e.material.linewidth=_e.origin.width*_e.hightlightWidthScale),_e.highlightScale&&(_e.material.size=_e.origin.size*_e.highlightScale),!0;if(_e.origin)return this.bloom?(_e.material.emissive=_e.origin.emissive,_e.layers.enable(0)):(_e.material.color=_e.origin.color,_e.material.opacity=_e.origin.opacity),_e.hightlightWidthScale&&(_e.material.linewidth=_e.origin.width),_e.highlightScale&&(_e.material.size=_e.origin.size),!0}}}class cn extends C.JW{constructor(W,me){let _e;me?._typename===m&&(_e=me,me=me.fMasterVolume),me?._typename&&0===me._typename.indexOf(v.clTGeoVolume)&&(me={_typename:v.clTGeoNode,fVolume:me,fName:me.fName,$geoh:me.$geoh,_proxy:!0}),super(W,me),Xe(this.getMainPainter())&&(this.superimpose=!0),_e&&(this.geo_manager=_e),this.no_default_title=!0,this.mode3d=!0,this.drawing_stage=0,this.drawing_log="Init",this.ctrl={clipIntersect:!0,clipVisualize:!1,clip:[{name:"x",enabled:!1,value:0,min:-100,max:100,step:1},{name:"y",enabled:!1,value:0,min:-100,max:100,step:1},{name:"z",enabled:!1,value:0,min:-100,max:100,step:1}],_highlight:0,highlight:0,highlight_bloom:0,highlight_scene:0,highlight_color:"#00ff00",bloom_strength:1.5,more:1,maxfaces:0,vislevel:void 0,maxnodes:void 0,dflt_colors:!1,info:{num_meshes:0,num_faces:0,num_shapes:0},depthTest:!0,depthMethod:"dflt",select_in_view:!1,update_browser:!0,use_fog:!1,light:{kind:"points",top:!1,bottom:!1,left:!1,right:!1,front:!1,specular:!0,power:1},lightKindItems:[{name:"AmbientLight",value:"ambient"},{name:"DirectionalLight",value:"points"},{name:"HemisphereLight",value:"hemisphere"},{name:"Ambient + Point",value:"mix"}],trans_radial:0,trans_z:0,scale:new V.Pq0(1,1,1),zoom:1,rotatey:0,rotatez:0,depthMethodItems:[{name:"Default",value:"dflt"},{name:"Raytraicing",value:"ray"},{name:"Boundary box",value:"box"},{name:"Mesh size",value:"size"},{name:"Central point",value:"pnt"}],cameraKindItems:[{name:"Perspective",value:"perspective"},{name:"Perspective (Floor XOZ)",value:"perspXOZ"},{name:"Perspective (Floor YOZ)",value:"perspYOZ"},{name:"Perspective (Floor XOY)",value:"perspXOY"},{name:"Orthographic (XOY)",value:"orthoXOY"},{name:"Orthographic (XOZ)",value:"orthoXOZ"},{name:"Orthographic (ZOY)",value:"orthoZOY"},{name:"Orthographic (ZOX)",value:"orthoZOX"},{name:"Orthographic (XnOY)",value:"orthoXNOY"},{name:"Orthographic (XnOZ)",value:"orthoXNOZ"},{name:"Orthographic (ZnOY)",value:"orthoZNOY"},{name:"Orthographic (ZnOX)",value:"orthoZNOX"}],cameraOverlayItems:[{name:"None",value:"none"},{name:"Bar",value:"bar"},{name:"Axis",value:"axis"},{name:"Grid",value:"grid"},{name:"Grid background",value:"gridb"},{name:"Grid foreground",value:"gridf"}],camera_kind:"perspective",camera_overlay:"gridb",rotate:!1,background:v.settings.DarkMode?"#000000":"#ffffff",can_rotate:!0,_axis:0,instancing:0,_count:!1,wireframe:!1,transparency:0,flatShading:!1,roughness:.5,metalness:.5,shininess:0,reflectivity:.5,material_kind:"lambert",materialKinds:[{name:"MeshLambertMaterial",value:"lambert",emissive:!0,props:[{name:"flatShading"}]},{name:"MeshBasicMaterial",value:"basic"},{name:"MeshStandardMaterial",value:"standard",emissive:!0,props:[{name:"flatShading"},{name:"roughness",min:0,max:1,step:.001},{name:"metalness",min:0,max:1,step:.001}]},{name:"MeshPhysicalMaterial",value:"physical",emissive:!0,props:[{name:"flatShading"},{name:"roughness",min:0,max:1,step:.001},{name:"metalness",min:0,max:1,step:.001},{name:"reflectivity",min:0,max:1,step:.001}]},{name:"MeshPhongMaterial",value:"phong",emissive:!0,props:[{name:"flatShading"},{name:"shininess",min:0,max:100,step:.1}]},{name:"MeshNormalMaterial",value:"normal",props:[{name:"flatShading"}]},{name:"MeshDepthMaterial",value:"depth"},{name:"MeshMatcapMaterial",value:"matcap"},{name:"MeshToonMaterial",value:"toon"}],getMaterialCfg:function(){let Be;return this.materialKinds.forEach(gt=>{gt.value===this.material_kind&&(Be=gt)}),Be}},this.cleanup(!0)}changeDarkMode(W){("#000000"===this.ctrl.background||"#ffffff"===this.ctrl.background)&&this.changedBackground(W??v.settings.DarkMode?"#000000":"#ffffff")}changeStage(W,me){if(this.drawing_stage=W,!me)switch(W){case 0:me="Building done";break;case 1:me="collect visibles";break;case 2:me="worker collect visibles";break;case 3:me="Analyse visibles";break;case 4:me="collect shapes for building";break;case 5:me="Start build shapes";break;case 6:me="Worker build shapes";break;case 7:me="Build shapes";break;case 8:me="Build ready";break;case 9:me="Wait for main painter";break;case 10:me="Build projection";break;default:me=`stage ${W}`}this.drawing_log=me}isStage(W){return W===this.drawing_stage}isBatchMode(){return(0,v.isBatchMode)()||this.batch_mode}createToolbar(){if(this._toolbar||!this._webgl||this.ctrl.notoolbar||this.isBatchMode())return;const W=[{name:"toImage",title:"Save as PNG",icon:"camera",click:()=>this.createSnapshot()},{name:"control",title:"Toggle control UI",icon:"rect",click:()=>this.showControlGui("toggle")},{name:"enlarge",title:"Enlarge geometry drawing",icon:"circle",click:()=>this.toggleEnlarge()}];navigator.getVRDisplays&&(W.push({name:"entervr",title:"Enter VR (It requires a VR Headset connected)",icon:"vrgoggles",click:()=>this.toggleVRMode()}),this.initVRMode()),v.settings.ContextMenu&&W.push({name:"menu",title:"Show context menu",icon:"question",click:_e=>{_e.preventDefault(),_e.stopPropagation(),!(0,N.IV)()&&(0,N.ES)(_e,this).then(Be=>{Be.painter.fillContextMenu(Be),Be.show()})}});const me=new V.Q1f(this.ctrl.background);this._toolbar=new ht(this.selectDom(),me.r+me.g+me.b<1,W),this._toolbar.createButtons()}initVRMode(){this._dolly=new V.YJl,this._scene.add(this._dolly),this._standingMatrix=new V.kn4,this._raycasterEnd=new V.Pq0,this._raycasterOrigin=new V.Pq0,navigator.getVRDisplays().then(W=>{const me=W[0];me&&(this._renderer.vr.setDevice(me),this._vrDisplay=me,me.stageParameters&&this._standingMatrix.fromArray(me.stageParameters.sittingToStandingTransform),this.initVRControllersGeometry())})}initVRControllersGeometry(){const W=new V.Gu$(.025,18,36),me=new V.V9B({color:"grey",vertexColors:!1}),_e=new V.V9B({color:"fuchsia",vertexColors:!1}),Be=new V.iNn(.001,.001,2),gt=new V.eaF(Be,_e),Et=new V.eaF(Be,_e),Mt=new V.eaF(W,me),Nt=new V.eaF(W,me);this._controllersMeshes=[],this._controllersMeshes.push(Mt),this._controllersMeshes.push(Nt),gt.position.z-=1,Et.position.z-=1,Mt.add(gt),Nt.add(Et),this._dolly.add(Mt),this._dolly.add(Nt),Mt.visible=!1,Nt.visible=!1}updateVRControllersList(){const W=navigator.getGamepads&&navigator.getGamepads();if(!this.vrControllers||W.length!==this.vrControllers.length){this._controllersMeshes.forEach(me=>{me.visible=!1}),this._vrControllers=[];for(let me=0;me<W.length;++me)!W[me]||!W[me].pose||(this._vrControllers.push({gamepad:W[me],mesh:this._controllersMeshes[me]}),this._controllersMeshes[me].visible=!0)}}processVRControllerIntersections(){let W=[];for(let me=0;me<this._vrControllers.length;++me){const _e=this._vrControllers[me].mesh,Be=_e.localToWorld(this._raycasterEnd.set(0,0,-1)),gt=_e.localToWorld(this._raycasterOrigin.set(0,0,0));Be.sub(gt).normalize(),W=W.concat(this._controls.getOriginDirectionIntersects(gt,Be))}W=W.filter((me,_e)=>W.indexOf(me)===_e),this._controls.processMouseMove(W)}updateVRControllers(){this.updateVRControllersList();for(let W=0;W<this._vrControllers.length;++W){const me=this._vrControllers[W],_e=me.gamepad.pose.orientation,Be=me.gamepad.pose.position,gt=me.mesh;_e&&gt.quaternion.fromArray(_e),Be&&gt.position.fromArray(Be),gt.updateMatrix(),gt.applyMatrix4(this._standingMatrix),gt.matrixWorldNeedsUpdate=!0}this.processVRControllerIntersections()}toggleVRMode(){if(this._vrDisplay){if(this._vrDisplay.isPresenting)return void this.exitVRMode();this._previousCameraPosition=this._camera.position.clone(),this._previousCameraRotation=this._camera.rotation.clone(),this._vrDisplay.requestPresent([{source:this._renderer.domElement}]).then(()=>{this._previousCameraNear=this._camera.near,this._dolly.position.set(this._camera.position.x/4,-this._camera.position.y/8,-this._camera.position.z/4),this._camera.position.set(0,0,0),this._dolly.add(this._camera),this._camera.near=.1,this._camera.updateProjectionMatrix(),this._renderer.vr.enabled=!0,this._renderer.setAnimationLoop(()=>{this.updateVRControllers(),this.render3D(0)})}),this._renderer.vr.enabled=!0,window.addEventListener("keydown",W=>{"Escape"===W.code&&this.exitVRMode()})}}exitVRMode(){this._vrDisplay.isPresenting&&(this._renderer.vr.enabled=!1,this._dolly.remove(this._camera),this._scene.add(this._camera),this._camera.position.copy(this._previousCameraPosition),this._previousCameraPosition=void 0,this._camera.rotation.copy(this._previousCameraRotation),this._previousCameraRotation=void 0,this._camera.near=this._previousCameraNear,this._camera.updateProjectionMatrix(),this._vrDisplay.exitPresent())}getGeometry(){return this.getObject()}modifyVisisbility(W,me){if(0!==(0,X.Dh)(this.getGeometry()))return;if(!W)return(0,X.bg)(this.getGeometry().fVolume,X.Wv.kVisThis,"+"===me);let _e,Be=!1;W.indexOf("*")<0?(_e=new RegExp("^"+W+"$"),Be=!0):(_e=new RegExp("^"+W.split("*").join(".*")+"$"),Be=!1),this.findNodeWithVolume(_e,gt=>((0,X.N_)(gt.node.fVolume,"+"!==me),Be?gt:null))}decodeOptions(W){(0,v.isStr)(W)||(W=""),this.superimpose&&0===W.indexOf("same")&&(W=W.slice(4));const me=this.ctrl,_e=W.indexOf("macro:");if(_e>=0){let Et=W.indexOf(";",_e+6);Et<0&&(Et=W.length),me.script_name=W.slice(_e+6,Et),W=W.slice(0,_e)+W.slice(Et+1),console.log(`script ${me.script_name} rest ${W}`)}for(;;){const Et=W.indexOf("+"),Mt=W.indexOf("-");if(Et<0&&Mt<0)break;let Nt=Et,Qt="+";(Nt<0||Mt>=0&&Mt<Et)&&(Nt=Mt,Qt="-");let Zt=Nt+1;const dn=/[,; .]/;for(;Zt<W.length&&!dn.test(W[Zt])&&"+"!==W[Zt]&&"-"!==W[Zt];)Zt++;const vn=W.substring(Nt+1,Zt);W=W.slice(0,Nt)+W.slice(Zt),this.modifyVisisbility(vn,Qt)}const Be=new g.nC(W);Be.check("MAIN")&&(me.is_main=!0),Be.check("TRACKS")&&(me.tracks=!0),Be.check("SHOWTOP")&&(me.showtop=!0),Be.check("NO_SCREEN")&&(me.no_screen=!0),Be.check("NOINSTANCING")&&(me.instancing=-1),Be.check("INSTANCING")&&(me.instancing=1),Be.check("ORTHO_CAMERA")&&(me.camera_kind="orthoXOY",me.can_rotate=0),Be.check("ORTHO",!0)&&(me.camera_kind="ortho"+Be.part,me.can_rotate=0),Be.check("OVERLAY",!0)&&(me.camera_overlay=Be.part.toLowerCase()),Be.check("CAN_ROTATE")&&(me.can_rotate=!0),Be.check("PERSPECTIVE")&&(me.camera_kind="perspective",me.can_rotate=!0),Be.check("PERSP",!0)&&(me.camera_kind="persp"+Be.part,me.can_rotate=!0),Be.check("MOUSE_CLICK")&&(me.mouse_click=!0),(Be.check("DEPTHRAY")||Be.check("DRAY"))&&(me.depthMethod="ray"),(Be.check("DEPTHBOX")||Be.check("DBOX"))&&(me.depthMethod="box"),(Be.check("DEPTHPNT")||Be.check("DPNT"))&&(me.depthMethod="pnt"),(Be.check("DEPTHSIZE")||Be.check("DSIZE"))&&(me.depthMethod="size"),(Be.check("DEPTHDFLT")||Be.check("DDFLT"))&&(me.depthMethod="dflt"),Be.check("ZOOM",!0)&&(me.zoom=Be.partAsFloat(0,100)/100),Be.check("ROTY",!0)&&(me.rotatey=Be.partAsFloat()),Be.check("ROTZ",!0)&&(me.rotatez=Be.partAsFloat()),Be.check("PHONG")&&(me.material_kind="phong"),Be.check("LAMBERT")&&(me.material_kind="lambert"),Be.check("MATCAP")&&(me.material_kind="matcap"),Be.check("TOON")&&(me.material_kind="toon"),Be.check("AMBIENT")&&(me.light.kind="ambient");const gt=()=>{let Et=1;return"N"===Be.part[0]&&(Et=-1,Be.part=Be.part.slice(1)),Et*Be.partAsFloat()};if(Be.check("CAMX",!0)&&(me.camx=gt()),Be.check("CAMY",!0)&&(me.camy=gt()),Be.check("CAMZ",!0)&&(me.camz=gt()),Be.check("CAMLX",!0)&&(me.camlx=gt()),Be.check("CAMLY",!0)&&(me.camly=gt()),Be.check("CAMLZ",!0)&&(me.camlz=gt()),Be.check("BLACK")&&(me.background="#000000"),Be.check("WHITE")&&(me.background="#FFFFFF"),Be.check("BKGR_",!0)){let Et=null;if(Be.partAsInt(1)>0)Et=(0,b.oU)(Be.partAsInt());else for(let Mt=0;Mt<8;++Mt)(0,b.oU)(Mt).toUpperCase()===Be.part&&(Et=(0,b.oU)(Mt));Et&&(me.background="#"+new V.Q1f(Et).getHexString())}Be.check("R3D_",!0)&&(me.Render3D=v.constants.Render3D.fromString(Be.part.toLowerCase())),Be.check("MORE",!0)&&(me.more=Be.partAsInt(0,2)??2),Be.check("ALL")&&(me.more=100,me.vislevel=99),Be.check("VISLVL",!0)&&(me.vislevel=Be.partAsInt()),Be.check("MAXNODES",!0)&&(me.maxnodes=Be.partAsInt()),Be.check("MAXFACES",!0)&&(me.maxfaces=Be.partAsInt()),(Be.check("CONTROLS")||Be.check("CTRL"))&&(me.show_controls=!0),Be.check("CLIPXYZ")&&(me.clip[0].enabled=me.clip[1].enabled=me.clip[2].enabled=!0),Be.check("CLIPX")&&(me.clip[0].enabled=!0),Be.check("CLIPY")&&(me.clip[1].enabled=!0),Be.check("CLIPZ")&&(me.clip[2].enabled=!0),Be.check("CLIP")&&(me.clip[0].enabled=me.clip[1].enabled=me.clip[2].enabled=!0),Be.check("PROJX",!0)&&(me.project="x",Be.partAsInt(1)>0&&(me.projectPos=Be.partAsInt()),me.can_rotate=0),Be.check("PROJY",!0)&&(me.project="y",Be.partAsInt(1)>0&&(me.projectPos=Be.partAsInt()),me.can_rotate=0),Be.check("PROJZ",!0)&&(me.project="z",Be.partAsInt(1)>0&&(me.projectPos=Be.partAsInt()),me.can_rotate=0),(Be.check("DFLT_COLORS")||Be.check("DFLT"))&&(me.dflt_colors=!0),Be.check("SSAO"),Be.check("NOBLOOM")&&(me.highlight_bloom=!1),Be.check("BLOOM")&&(me.highlight_bloom=!0),Be.check("OUTLINE")&&(me.outline=!0),Be.check("NOWORKER")&&(me.use_worker=-1),Be.check("WORKER")&&(me.use_worker=1),Be.check("NOFOG")&&(me.use_fog=!1),Be.check("FOG")&&(me.use_fog=!0),(Be.check("NOHIGHLIGHT")||Be.check("NOHIGH"))&&(me.highlight_scene=me.highlight=!1),Be.check("HIGHLIGHT")&&(me.highlight_scene=me.highlight=!0),Be.check("HSCENEONLY")&&(me.highlight_scene=!0,me.highlight=!1),Be.check("NOHSCENE")&&(me.highlight_scene=!1),Be.check("HSCENE")&&(me.highlight_scene=!0),(Be.check("WIREFRAME")||Be.check("WIRE"))&&(me.wireframe=!0),Be.check("ROTATE")&&(me.rotate=!0),(Be.check("INVX")||Be.check("INVERTX"))&&(me.scale.x=-1),(Be.check("INVY")||Be.check("INVERTY"))&&(me.scale.y=-1),(Be.check("INVZ")||Be.check("INVERTZ"))&&(me.scale.z=-1),Be.check("COUNT")&&(me._count=!0),Be.check("TRANSP",!0)&&(me.transparency=Be.partAsInt(0,100)/100),Be.check("OPACITY",!0)&&(me.transparency=1-Be.partAsInt(0,100)/100),(Be.check("AXISCENTER")||Be.check("AXISC")||Be.check("AC"))&&(me._axis=2),(Be.check("AXIS")||Be.check("A"))&&(me._axis=1),Be.check("TRR",!0)&&(me.trans_radial=Be.partAsInt()/100),Be.check("TRZ",!0)&&(me.trans_z=Be.partAsInt()/100),Be.check("W")&&(me.wireframe=!0),Be.check("Y")&&(me._yup=!0),Be.check("Z")&&(me._yup=!1),void 0===me._yup&&(me._yup=this.getCanvSvg().empty()),this.options=me}activateInBrowser(W,me){(0,v.isStr)(W)&&(W=[W]),this._hpainter&&(this._hpainter.activateItems(W,me),this.ctrl.update_browser||setTimeout(()=>this._hpainter.activateItems([]),2e3))}testMatrixes(){let W=0,me=0,_e=0;const Be={domatrix:!0,func:()=>{let Mt=this.getmatrix();const Nt=this.copyStack(),Qt=this._clones.createObject3D(Nt.stack,this._toplevel,"mesh");if(!Qt)return!0;me++;const Zt=Qt.matrixWorld;if(Zt.equals(Mt))return!0;if(Zt.determinant()>0&&Mt.determinant()<-.9){const vn=new V.Pq0(1,1,-1);if(Mt=Mt.clone().scale(vn),Zt.equals(Mt))return!0}let dn=0;for(let vn=0;vn<16;++vn)dn=Math.max(dn,Math.abs(Zt.elements[vn]-Mt.elements[vn]));return _e=Math.max(dn,_e),dn<1e-4||(console.log(`${this._clones.resolveStack(Nt.stack).name} maxdiff ${dn} determ ${Zt.determinant()} ${Mt.determinant()}`),W++,!1)}},gt=(new Date).getTime();this._clones.scanVisible(Be);const Et=(new Date).getTime();console.log(`Compare matrixes total ${me} errors ${W} takes ${Et-gt} maxdiff ${_e}`)}fillContextMenu(W){W.add("header: Draw options"),W.addchk(this.ctrl.update_browser,"Browser update",()=>{this.ctrl.update_browser=!this.ctrl.update_browser,this.ctrl.update_browser||this.activateInBrowser([])}),W.addchk(this.ctrl.show_controls,"Show Controls",()=>this.showControlGui("toggle")),W.add("sub:Show axes",()=>this.setAxesDraw("toggle")),W.addchk(0===this.ctrl._axis,"off",0,me=>this.setAxesDraw(parseInt(me))),W.addchk(1===this.ctrl._axis,"side",1,me=>this.setAxesDraw(parseInt(me))),W.addchk(2===this.ctrl._axis,"center",2,me=>this.setAxesDraw(parseInt(me))),W.add("endsub:"),this.geo_manager&&W.addchk(this.ctrl.showtop,"Show top volume",()=>this.setShowTop(!this.ctrl.showtop)),W.addchk(this.ctrl.wireframe,"Wire frame",()=>this.toggleWireFrame()),this.getCanvPainter()||W.addchk(this.isTooltipAllowed(),"Show tooltips",()=>this.setTooltipAllowed("toggle")),W.add("sub:Highlight"),W.addchk(!this.ctrl.highlight,"Off",()=>{this.ctrl.highlight=!1,this.changedHighlight()}),W.addchk(this.ctrl.highlight&&!this.ctrl.highlight_bloom,"Normal",()=>{this.ctrl.highlight=!0,this.ctrl.highlight_bloom=!1,this.changedHighlight()}),W.addchk(this.ctrl.highlight&&this.ctrl.highlight_bloom,"Bloom",()=>{this.ctrl.highlight=!0,this.ctrl.highlight_bloom=!0,this.changedHighlight()}),W.add("separator"),W.addchk(this.ctrl.highlight_scene,"Scene",me=>{this.ctrl.highlight_scene=me,this.changedHighlight()}),W.add("endsub:"),W.add("sub:Camera"),W.add("Reset position",()=>this.focusCamera()),this.ctrl.project||W.addchk(this.ctrl.rotate,"Autorotate",()=>this.setAutoRotate(!this.ctrl.rotate)),this._geom_viewer||(W.addchk(this.canRotateCamera(),"Can rotate",()=>this.changeCanRotate(!this.ctrl.can_rotate)),W.add("Get position",()=>W.info("Position (as url)","&opt="+this.produceCameraUrl())),this.isOrthoCamera()||W.add("Absolute position",()=>{const me=this.produceCameraUrl(!0),_e=me.indexOf("camlx");W.info("Position (as url)","&opt="+(_e<0?me:me.slice(0,_e)+"\n"+me.slice(_e)))}),W.add("sub:Kind"),this.ctrl.cameraKindItems.forEach(me=>W.addchk(this.ctrl.camera_kind===me.value,me.name,me.value,_e=>{this.ctrl.camera_kind=_e,this.changeCamera()})),W.add("endsub:"),this.isOrthoCamera()&&(W.add("sub:Overlay"),this.ctrl.cameraOverlayItems.forEach(me=>W.addchk(this.ctrl.camera_overlay===me.value,me.name,me.value,_e=>{this.ctrl.camera_overlay=_e,this.changeCamera()})),W.add("endsub:"))),W.add("endsub:"),W.addchk(this.ctrl.select_in_view,"Select in view",()=>{this.ctrl.select_in_view=!this.ctrl.select_in_view,this.ctrl.select_in_view&&this.startDrawGeometry()})}changedGlobalTransparency(W){const me=(0,v.isFunc)(W)?W:null;(me||void 0===W)&&(W=this.ctrl.transparency),this._toplevel?.traverse(_e=>{if(void 0===_e?.material?.inherentOpacity)return;const Be=me?me(_e):void 0;_e.material.opacity=void 0!==Be?1-Be:Math.min(1-(W||0),_e.material.inherentOpacity),_e.material.depthWrite=1===_e.material.opacity,_e.material.transparent=_e.material.opacity<1}),this.render3D()}changedMaterial(){this._toplevel?.traverse(W=>{void 0!==W.material?.inherentArgs&&(W.material=(0,X.Cc)(this.ctrl,W.material.inherentArgs))}),this.render3D(-1)}changeMaterialProperty(W){const me=this.ctrl[W];if(void 0===me)return console.error("No property ",W);this._toplevel?.traverse(_e=>{void 0!==_e.material?.inherentArgs&&void 0!==_e.material[W]&&(_e.material[W]=me,_e.material.needsUpdate=!0)}),this.render3D()}resetTransformation(){this.changedTransformation("reset")}changedTransformation(W){if(!this._toplevel)return;const me=this.ctrl,_e=new V.kn4,Be=new V.Pq0;"reset"===W&&(me.trans_z=me.trans_radial=0),this._toplevel.traverse(gt=>{if(void 0!==gt.stack){const Et=gt.parent;if("reset"===W)return Et.matrix0&&(Et.matrix.copy(Et.matrix0),Et.matrix.decompose(Et.position,Et.quaternion,Et.scale),Et.matrixWorldNeedsUpdate=!0),delete Et.matrix0,delete Et.vect0,delete Et.vect1,void delete Et.minvert;if(void 0===Et.vect0){Et.matrix0=Et.matrix.clone(),Et.minvert=(new V.kn4).copy(Et.matrixWorld).invert();const Mt=(0,X.UX)(gt,null,!0);Et.vect0=new V.Pq0((Mt.max.x+Mt.min.x)/2,(Mt.max.y+Mt.min.y)/2,(gt._flippedMesh?-1:1)*(Mt.max.z+Mt.min.z)/2).applyMatrix4(Et.matrixWorld),Et.vect1=new V.Pq0(0,0,0).applyMatrix4(Et.minvert)}Be.set(me.trans_radial*Et.vect0.x,me.trans_radial*Et.vect0.y,me.trans_z*Et.vect0.z).applyMatrix4(Et.minvert).sub(Et.vect1),Et.matrix.multiplyMatrices(Et.matrix0,_e.makeTranslation(Be.x,Be.y,Be.z)),Et.matrix.decompose(Et.position,Et.quaternion,Et.scale),Et.matrixWorldNeedsUpdate=!0}else if(void 0!==gt.stacks){if(gt.instanceMatrix.needsUpdate=!0,"reset"===W)return gt.trans?.forEach((Mt,Nt)=>{gt.setMatrixAt(Nt,Mt.matrix0)}),void delete gt.trans;if(void 0===gt.trans){gt.trans=new Array(gt.count),gt.geometry.computeBoundingBox();for(let Mt=0;Mt<gt.count;Mt++){const Nt={matrix0:new V.kn4,minvert:new V.kn4};gt.trans[Mt]=Nt,gt.getMatrixAt(Mt,Nt.matrix0),Nt.minvert.copy(Nt.matrix0).invert();const Qt=(new V.NRn).copy(gt.geometry.boundingBox).applyMatrix4(Nt.matrix0);Nt.vect0=new V.Pq0((Qt.max.x+Qt.min.x)/2,(Qt.max.y+Qt.min.y)/2,(Qt.max.z+Qt.min.z)/2),Nt.vect1=new V.Pq0(0,0,0).applyMatrix4(Nt.minvert)}}const Et=new V.kn4;gt.trans?.forEach((Mt,Nt)=>{Be.set(me.trans_radial*Mt.vect0.x,me.trans_radial*Mt.vect0.y,me.trans_z*Mt.vect0.z).applyMatrix4(Mt.minvert).sub(Mt.vect1),Et.multiplyMatrices(Mt.matrix0,_e.makeTranslation(Be.x,Be.y,Be.z)),gt.setMatrixAt(Nt,Et)})}}),this._toplevel.updateMatrixWorld(),"norender"!==W&&this.drawAxesAndOverlay()}changedAutoRotate(){this.autorotate(2.5)}changedAxes(){(0,v.isStr)(this.ctrl._axis)&&(this.ctrl._axis=parseInt(this.ctrl._axis)),this.drawAxesAndOverlay()}changedBackground(W){if(void 0!==W&&(this.ctrl.background=W),this._scene.background=new V.Q1f(this.ctrl.background),this._renderer.setClearColor(this._scene.background,1),this.render3D(0),this._toolbar){const me=new V.Q1f(this.ctrl.background);this._toolbar.changeBrightness(me.r+me.g+me.b<1)}}showControlGui(W){if(!this.ctrl)return;if("toggle"===W?W=!this._gui:void 0===W&&(W=this.ctrl.show_controls),this.ctrl.show_controls=W,this._gui)return void(W||(this._gui.destroy(),delete this._gui));if(!W||!this._renderer)return;const me=this.selectDom();"static"===me.style("position")&&me.style("position","relative"),this._gui=new x({container:me.node(),closeFolders:!0,width:Math.min(300,this._scene_width/2),title:"Settings"});const _e=this._gui.domElement;_e.style.position="absolute",_e.style.top=0,_e.style.right=0,this._gui.painter=this;const Be=$n=>{const kn={};return $n.forEach(Rn=>{kn[Rn.name]=Rn.value}),kn};if(!this.ctrl.project){const $n=this._gui.addFolder("Selection");this.ctrl.maxnodes||(this.ctrl.maxnodes=this._clones?.getMaxVisNodes()??1e4),this.ctrl.vislevel||(this.ctrl.vislevel=this._clones?.getVisLevel()??3),this.ctrl.maxfaces||(this.ctrl.maxfaces=2e5*this.ctrl.more),this.ctrl.more=1,$n.add(this.ctrl,"vislevel",1,99,1).name("Visibility level").listen().onChange(()=>this.startRedraw(500)),$n.add(this.ctrl,"maxnodes",0,5e5,1e3).name("Visible nodes").listen().onChange(()=>this.startRedraw(500)),$n.add(this.ctrl,"maxfaces",0,5e6,1e5).name("Max faces").listen().onChange(()=>this.startRedraw(500))}if(this.ctrl.project){const $n=this.getGeomBoundingBox(this.getProjectionSource(),.01),kn=this.ctrl.project;void 0===this.ctrl.projectPos&&(this.ctrl.projectPos=($n.min[kn]+$n.max[kn])/2),this._gui.add(this.ctrl,"projectPos",$n.min[kn],$n.max[kn]).name(kn.toUpperCase()+" projection").onChange(()=>this.startDrawGeometry())}else{const $n=this._gui.addFolder("Clipping");for(let kn=0;kn<3;++kn){const Rn=this.ctrl.clip[kn],ei=Rn.name.toUpperCase();$n.add(Rn,"enabled").name("Enable "+ei).listen().onChange(()=>this.changedClipping(-1)),$n.add(Rn,"value",Rn.min,Rn.max,Rn.step).name(ei+" position").listen().onChange(()=>this.changedClipping(kn))}$n.add(this.ctrl,"clipIntersect").name("Clip intersection").onChange(()=>this.changedClipping(-1)),$n.add(this.ctrl,"clipVisualize").name("Visualize").onChange(()=>this.changedClipping(-1))}const gt=this._gui.addFolder("Scene");gt.add(this.ctrl.light,"kind",Be(this.ctrl.lightKindItems)).name("Light").listen().onChange(()=>{Et.show("mix"===this.ctrl.light.kind||"points"===this.ctrl.light.kind),this.changedLight()}),this.ctrl.light._pnts=this.ctrl.light.specular?0:this.ctrl.light.front?1:2;const Et=gt.add(this.ctrl.light,"_pnts",{specular:0,front:1,box:2}).name("Positions").show("mix"===this.ctrl.light.kind||"points"===this.ctrl.light.kind).onChange($n=>{this.ctrl.light.specular=0===$n,this.ctrl.light.front=1===$n,this.ctrl.light.top=this.ctrl.light.bottom=this.ctrl.light.left=this.ctrl.light.right=2===$n,this.changedLight()});gt.add(this.ctrl.light,"power",0,10,.01).name("Power").listen().onChange(()=>this.changedLight()),gt.add(this.ctrl,"use_fog").name("Fog").listen().onChange(()=>this.changedUseFog());const Mt=this._gui.addFolder("Appearance");this.ctrl._highlight=this.ctrl.highlight?this.ctrl.highlight_bloom?2:1:0,Mt.add(this.ctrl,"_highlight",{none:0,normal:1,bloom:2}).name("Highlight Selection").listen().onChange(()=>{this.changedHighlight(this.ctrl._highlight),Qt.show(2===this.ctrl._highlight),Nt.show(1===this.ctrl._highlight)});const Nt=Mt.addColor(this.ctrl,"highlight_color").name("Hightlight color").show(1===this.ctrl._highlight),Qt=Mt.add(this.ctrl,"bloom_strength",0,3).name("Bloom strength").listen().onChange(()=>this.changedHighlight()).show(2===this.ctrl._highlight);Mt.addColor(this.ctrl,"background").name("Background").onChange($n=>this.changedBackground($n)),Mt.add(this.ctrl,"_axis",{none:0,side:1,center:2}).name("Axes").onChange(()=>this.changedAxes()),this.ctrl.project||Mt.add(this.ctrl,"rotate").name("Autorotate").listen().onChange(()=>this.changedAutoRotate());const Zt=this._gui.addFolder("Material");let dn=[];const vn=()=>{dn.forEach(kn=>kn.destroy()),dn=[];const $n=this.ctrl.getMaterialCfg()?.props;$n&&$n.forEach(kn=>{const Rn=Zt.add(this.ctrl,kn.name,kn.min,kn.max,kn.step).onChange(()=>{this.changeMaterialProperty(kn.name)});dn.push(Rn)})};Zt.add(this.ctrl,"material_kind",Be(this.ctrl.materialKinds)).name("Kind").listen().onChange(()=>{vn(),this.ensureBloom(!1),this.changedMaterial(),this.changedHighlight()}),Zt.add(this.ctrl,"transparency",0,1,.001).name("Transparency").listen().onChange($n=>this.changedGlobalTransparency($n)),Zt.add(this.ctrl,"wireframe").name("Wireframe").listen().onChange(()=>this.changedWireFrame()),Zt.add(this,"showMaterialDocu").name("Docu from threejs.org"),vn();const Fn=this._gui.addFolder("Camera");Fn.add(this.ctrl,"camera_kind",Be(this.ctrl.cameraKindItems)).name("Kind").listen().onChange(()=>{ai.show(0===this.ctrl.camera_kind.indexOf("ortho")),this.changeCamera()}),Fn.add(this.ctrl,"can_rotate").name("Can rotate").listen().onChange(()=>this.changeCanRotate()),Fn.add(this,"focusCamera").name("Reset position");const ai=Fn.add(this.ctrl,"camera_overlay",Be(this.ctrl.cameraOverlayItems)).name("Overlay").listen().onChange(()=>this.changeCamera()).show(0===this.ctrl.camera_kind.indexOf("ortho"));if(this._webgl){const $n=this._gui.addFolder("Advanced");$n.add(this.ctrl,"depthTest").name("Depth test").listen().onChange(()=>this.changedDepthTest()),$n.add(this.ctrl,"depthMethod",Be(this.ctrl.depthMethodItems)).name("Rendering order").onChange(kn=>this.changedDepthMethod(kn)),$n.add(this,"resetAdvanced").name("Reset")}if(!this.ctrl.project){const $n=this._gui.addFolder("Transform");$n.add(this.ctrl,"trans_z",0,3,.01).name("Z axis").listen().onChange(()=>this.changedTransformation()),$n.add(this.ctrl,"trans_radial",0,3,.01).name("Radial").listen().onChange(()=>this.changedTransformation()),$n.add(this,"resetTransformation").name("Reset"),(this.ctrl.trans_z||this.ctrl.trans_radial)&&$n.open()}}showMaterialDocu(){const W=this.ctrl.getMaterialCfg();W?.name&&typeof window<"u"&&window.open("https://threejs.org/docs/index.html#api/en/materials/"+W.name,"_blank")}changedHighlight(W){void 0!==W&&(this.ctrl.highlight=0!==W,this.ctrl.highlight&&(this.ctrl.highlight_bloom=2===W)),this.ensureBloom(),this.ctrl.highlight||this.highlightMesh(null),this._slave_painters?.forEach(me=>{me.ctrl.highlight=this.ctrl.highlight,me.ctrl.highlight_bloom=this.ctrl.highlight_bloom,me.ctrl.bloom_strength=this.ctrl.bloom_strength,me.changedHighlight()})}changeCanRotate(W){void 0!==W&&(this.ctrl.can_rotate=W),this._controls&&(this._controls.enableRotate=this.ctrl.can_rotate)}changedUseFog(){this._scene.fog=this.ctrl.use_fog?this._fog:null,this.render3D()}changeCamera(){this._controls&&(this._controls.cleanup(),delete this._controls),this.ensureBloom(!1),this.createCamera(),this.createSpecialEffects(),this.adjustCameraPosition(!0),this.addOrbitControls(),this.render3D()}ensureBloom(W){if(void 0===W&&(0===this.ctrl.highlight_bloom&&(this.ctrl.highlight_bloom=this._webgl),W=this.ctrl.highlight_bloom&&this.ctrl.getMaterialCfg()?.emissive),W&&!this._bloomComposer){this._camera.layers.enable(1),this._bloomComposer=new Le.s0(this._renderer),this._bloomComposer.addPass(new Le.AH(this._scene,this._camera));const me=new Le.Cg(new V.I9Y(this._scene_width,this._scene_height),1.5,.4,.85);me.threshold=0,me.radius=0,me.renderToScreen=!0,this._bloomComposer.addPass(me),this._renderer.autoClear=!1}else!W&&this._bloomComposer&&(this._bloomComposer.dispose(),delete this._bloomComposer,this._renderer&&(this._renderer.autoClear=!0),this._camera?.layers.disable(1),this._camera?.layers.set(0));this._bloomComposer?.passes&&(this._bloomComposer.passes[1].strength=this.ctrl.bloom_strength)}orbitContext(W,me){(0,N.ES)(W,this).then(_e=>{let Be=0,gt=0,Et=0;if(me)for(let Mt=0;Mt<me.length;++Mt)Fe(me[Mt])&&gt++,me[Mt].geo_name&&Be++;if(gt+Be===0)this.fillContextMenu(_e);else{const Mt=gt+Be>1;Mt&&_e.add("header:"+(Be>0?"Items":"Nodes"));for(let Nt=0;Nt<me.length;++Nt){const Qt=me[Nt].object,Zt=Fe(me[Nt]);let dn,vn,Fn;if(Qt.geo_name)vn=Qt.geo_name,0===vn.indexOf("<prnt>")&&(vn=(this.getItemName()||"top")+vn.slice(6)),dn=vn.slice(vn.lastIndexOf("/")+1),dn||(dn=vn),Fn=dn;else{if(!Zt)continue;dn=this._clones.getStackName(Zt),vn=this.getStackFullName(Zt),Fn=this.getItemName(),0===dn.indexOf("Nodes/")?Fn=dn.slice(6):dn?Fn=dn:Fn||(Fn="header")}if(Et++,_e.add((Mt?"sub:":"header:")+Fn,vn,$n=>this.activateInBrowser([$n],!0)),_e.add("Browse",vn,$n=>this.activateInBrowser([$n],!0)),this._hpainter&&_e.add("Inspect",vn,$n=>this._hpainter.display($n,v.kInspect)),(0,v.isFunc)(this.hidePhysicalNode))_e.add("Hide",vn,$n=>this.hidePhysicalNode([$n])),Et>1&&_e.add("Hide all before",Nt,$n=>{const kn=[];for(let Rn=0;Rn<$n;++Rn){const ei=Fe(me[Rn]);ei&&kn.push(this.getStackFullName(ei))}this.hidePhysicalNode(kn)});else if(Qt.geo_name){_e.add("Hide",Nt,$n=>{const kn=me[$n].object;kn.visible=!1,kn.geo_object&&(kn.geo_object.$hidden_via_menu=!0),_e.painter.render3D()},"Hide this physical node"),Mt&&_e.add("endsub:");continue}const ai=this.accessObjectWireFrame(Qt);void 0!==ai&&_e.addchk(ai,"Wireframe",Nt,$n=>{const kn=me[$n].object.material;kn.wireframe=!kn.wireframe,this.render3D()},"Toggle wireframe mode for the node"),Et>1&&_e.add("Manifest",Nt,$n=>{this._last_manifest&&(this._last_manifest.wireframe=!this._last_manifest.wireframe),this._last_hidden&&this._last_hidden.forEach(kn=>{kn.visible=!0}),this._last_hidden=[];for(let kn=0;kn<$n;++kn)this._last_hidden.push(me[kn].object);this._last_hidden.forEach(kn=>{kn.visible=!1}),this._last_manifest=me[$n].object.material,this._last_manifest.wireframe=!this._last_manifest.wireframe,this.render3D()},"Manifest selected node"),_e.add("Focus",Nt,$n=>{this.focusCamera(me[$n].object)}),this._geom_viewer||(_e.add("Hide",Nt,$n=>{const kn=this._clones.resolveStack(me[$n].object.stack);kn.obj&&kn.node.kind===X.k$&&kn.obj.fVolume?((0,X.bg)(kn.obj.fVolume,X.Wv.kVisThis,!1),Ne(kn.obj.fVolume,this._hpainter)):kn.obj&&kn.node.kind===X.NN&&(kn.obj.fRnrSelf=!1,Ne(kn.obj,this._hpainter)),this.testGeomChanges()},"Hide all logical nodes of that kind"),_e.add("Hide only this",Nt,$n=>{this._clones.setPhysNodeVisibility(Fe(me[$n]),!1),this.testGeomChanges()},"Hide only this physical node"),Nt>1&&_e.add("Hide all before",Nt,$n=>{for(let kn=0;kn<$n;++kn)this._clones.setPhysNodeVisibility(Fe(me[kn]),!1);this.testGeomChanges()},"Hide all physical nodes before that")),Mt&&_e.add("endsub:")}}_e.show()})}filterIntersects(W){if(!W?.length)return W;for(let _e=0;_e<W.length;++_e)W[_e].object.geo_highlight&&(W[_e].object=W[_e].object.geo_highlight);for(let _e=W.length-1;_e>=0;--_e){const Be=W[_e].object;let gt=Be.visible&&(Fe(W[_e])||void 0!==Be.geo_name);gt&&Be.material&&void 0!==Be.material.opacity&&(gt=Be.material.opacity>=.1),Be.jsroot_special&&(gt=!1);for(let Et=0;Et<_e&&gt;++Et)W[Et].object===Be&&(gt=!1);gt||W.splice(_e,1)}const me=this.ctrl.clip;if(me[0].enabled||me[1].enabled||me[2].enabled){const _e=[];for(let Be=0;Be<W.length;++Be){const gt=W[Be].point,Et="Points"===W[Be].object.type;let Mt=!0;me[0].enabled&&this._clipPlanes[0].normal.dot(gt)>this._clipPlanes[0].constant^Et&&(Mt=!1),me[1].enabled&&this._clipPlanes[1].normal.dot(gt)>this._clipPlanes[1].constant^Et&&(Mt=!1),me[2].enabled&&this._clipPlanes[2].normal.dot(gt)>this._clipPlanes[2].constant&&(Mt=!1),Mt||_e.push(W[Be])}W=_e}return W}testCameraPositionChange(){if(!this.ctrl.select_in_view||this._draw_all_nodes)return;const W=(0,X.d4)(this._camera);(0,X.P1)(W).CheckBox(this.getGeomBoundingBox())||this.startDrawGeometry()}resolveStack(W){return this._clones&&W?this._clones.resolveStack(W):null}getStackFullName(W){const me=this.getItemName(),_e=this.resolveStack(W);return _e&&_e.name?me?me+"/"+_e.name:_e.name:me}addHighlightHandler(W){(0,v.isFunc)(W?.highlightMesh)&&(this._highlight_handlers||(this._highlight_handlers=[]),this._highlight_handlers.push(W))}highlightMesh(W,me,_e,Be,gt,Et){if(_e){W=W?[W]:[];const Zt=this.getExtrasContainer();Zt&&Zt.traverse(dn=>{dn.geo_object===_e&&W.indexOf(dn)<0&&W.push(dn)})}else gt&&this._toplevel?(W=[],this._toplevel.traverse(Zt=>{Zt instanceof V.eaF&&(0,X.xq)(Zt.stack,gt)&&W.push(Zt)})):W=W?[W]:[];if(W.length||(W=null),W&&(W[0].geo_object?this.ctrl.highlight_scene||(W=null):this.ctrl.highlight||(W=null)),!Et){W&&(_e||(_e=W[0].geo_object),gt||(gt=W[0].stack));const Zt=this._highlight_handlers||(this._main_painter?this._main_painter._slave_painters.concat([this._main_painter]):this._slave_painters);for(let dn=0;dn<Zt?.length;++dn)Zt[dn]!==this&&Zt[dn].highlightMesh(null,me,_e,Be,gt,!0)}const Mt=this._selected_mesh;if(!Mt&&!W)return!1;const Nt=Zt=>Zt.get_ctrl?Zt.get_ctrl():new pt(Zt,this.ctrl.highlight_bloom&&this._bloomComposer);let Qt=!1;if(Mt&&W&&Mt.length===W.length){Qt=!0;for(let Zt=0;Zt<Mt.length&&Qt;++Zt)(Mt[Zt]!==W[Zt]||Nt(Mt[Zt]).checkHighlightIndex(Be))&&(Qt=!1)}if(Qt)return!!Mt;if(Mt)for(let Zt=0;Zt<Mt.length;++Zt)Nt(Mt[Zt]).setHighlight();if(this._selected_mesh=W,W)for(let Zt=0;Zt<W.length;++Zt)Nt(W[Zt]).setHighlight(me||new V.Q1f(this.ctrl.highlight_color),Be);return this.render3D(0),!!W}processMouseClick(W,me,_e){if(!me.length)return;const Be=me[0].object;if(!Be.get_ctrl)return;const gt=Be.get_ctrl(),Et=gt.extractIndex(me[0]);gt.evnt=_e,gt.setSelected("blue",Et)&&this.render3D(),gt.evnt=null}setMouseTmout(W){this.ctrl&&(this.ctrl.mouse_tmout=W),this._controls&&(this._controls.mouse_tmout=W)}setDepthMethod(W){this.ctrl&&(this.ctrl.depthMethod=W)}canRotateCamera(){return!(!1===this.ctrl.can_rotate||!this.ctrl.can_rotate&&(this.isOrthoCamera()||this.ctrl.project))}addOrbitControls(){this._controls||!this._webgl||this.isBatchMode()||this.superimpose||(0,v.isNodeJs)()||(this.getCanvPainter()||this.setTooltipAllowed(v.settings.Tooltip),this._controls=(0,w.Sc)(this,this._camera,this._scene,this._renderer,this._lookat),this._controls.mouse_tmout=this.ctrl.mouse_tmout,this.canRotateCamera()||(this._controls.enableRotate=!1),this._controls.contextMenu=this.orbitContext.bind(this),this._controls.processMouseMove=W=>{if(!this.ctrl||!this._controls)return;let Et,Mt,Nt,me=null,_e=null,Be=null,gt=[];for(let Zt=0;Zt<W.length;++Zt){const dn=W[Zt].object,vn=Fe(W[Zt]);if(!dn||!dn.visible)continue;let Fn=null;dn.geo_object?Fn=dn.geo_name:vn&&(Fn=this.getStackFullName(vn)),Fn&&(0===Fn.indexOf("<prnt>")&&(Fn=this.getItemName()+Fn.slice(6)),gt.push(Fn),me||(me=dn,_e=Fn,Et=dn.geo_object,dn.get_ctrl&&(Mt=dn.get_ctrl().extractIndex(W[Zt]),void 0!==Mt&&(0,v.isStr)(_e)&&(_e+=" indx:"+JSON.stringify(Mt))),Nt=vn,Nt&&(Be=this.resolveStack(Nt),dn.stacks&&(Mt=W[Zt].instanceId))))}if(this.highlightMesh(me,void 0,Et,Mt),this.ctrl.update_browser&&(this.ctrl.highlight&&_e&&(gt=[_e]),this.activateInBrowser(gt)),!Be?.obj)return _e;const Qt=(0,X.V)(Be.obj);return Qt.unshift(_e),{name:Be.obj.fName,title:Be.obj.fTitle||Be.obj._typename,lines:Qt}},this._controls.processMouseLeave=function(){this.processMouseMove([])},this._controls.processDblClick=()=>{!this.ctrl||!this._controls||(this._last_manifest?(this._last_manifest.wireframe=!this._last_manifest.wireframe,this._last_hidden&&this._last_hidden.forEach(W=>{W.visible=!0}),delete this._last_hidden,delete this._last_manifest):this.adjustCameraPosition(!0),this.render3D())})}nextDrawAction(){if(!this._clones||this.isStage(0))return!1;if(this.isStage(1)){if(this._geom_viewer)return this._draw_all_nodes=!1,this.changeStage(3),!0;if(this.ctrl.use_worker>0){if(!this._worker)return this.startWorker(),1;if(!this._worker_ready)return 1}let W=this._first_drawing?this._clones.countVisibles():0,me=null,_e=null;W||(W=this._clones.markVisibles(!1,!1,!!this.geo_manager&&!this.ctrl.showtop)),this.ctrl.select_in_view&&!this._first_drawing&&(me=(0,X.d4)(this._camera),_e=(0,X.P1)(me),_e.CheckBox(this.getGeomBoundingBox())&&(me=null,_e=null)),this._current_face_limit=this.ctrl.maxfaces,me&&(this._current_face_limit*=1.25);let Be=!this.isBatchMode()&&v.browser.isChrome&&(W>1e4||me&&this._clones.scanVisible()>1e5);if(Be&&0===v.source_dir.indexOf("file://")&&(console.log("disable worker for jsroot from file system"),Be=!1),Be&&!this._worker&&this.ctrl.use_worker>=0&&this.startWorker(),!Be||!this._worker_ready){const Et=this._clones.collectVisibles(this._current_face_limit,_e);return this._new_draw_nodes=Et.lst,this._draw_all_nodes=Et.complete,this.changeStage(3),!0}const gt={collect:this._current_face_limit,flags:this._clones.getVisibleFlags(),matrix:me?me.elements:null,vislevel:this._clones.getVisLevel(),maxvisnodes:this._clones.getMaxVisNodes()};return this.submitToWorker(gt),this.changeStage(2),2}if(this.isStage(2))return 2;if(this.isStage(3)){if(this._new_append_nodes)this._new_draw_nodes=this._draw_nodes.concat(this._new_append_nodes),delete this._new_append_nodes;else if(this._draw_nodes){let W;W=this._geom_viewer?this._draw_nodes:this._clones.mergeVisibles(this._new_draw_nodes,this._draw_nodes);for(let me=0;me<W.length;++me)this._clones.createObject3D(W[me].stack,this._toplevel,"delete_mesh");W.length>0&&(this.drawing_log=`Delete ${W.length} nodes`)}return this._draw_nodes=this._new_draw_nodes,delete this._new_draw_nodes,this.changeStage(4),!0}if(this.isStage(4)){const W=this._clones.collectShapes(this._draw_nodes);return this._build_shapes=this._clones.mergeShapesLists(this._build_shapes,W),this.changeStage(5),!0}if(this.isStage(5)){if(this.canSubmitToWorker()){const W={limit:this._current_face_limit,shapes:[]};let me=0;for(let _e=0;_e<this._build_shapes.length;++_e){let Be=null;const gt=this._build_shapes[_e];gt.ready||gt.geom?Be={id:gt.id,ready:!0,nfaces:(0,X.Wz)(gt.geom),refcnt:gt.refcnt}:(Be=(0,v.clone)(gt,null,!0),me++),W.shapes.push(Be)}if(me>0)return this.submitToWorker(W),this.changeStage(6),2}this.changeStage(7)}if(this.isStage(6))return 2;if(this.isStage(7)||this.isStage(8)){if(this.isStage(7)){const gt=this._clones.buildShapes(this._build_shapes,this._current_face_limit,500);if(!gt.done)return this.ctrl.info.num_shapes=gt.shapes,this.drawing_log=`Creating: ${gt.shapes} / ${this._build_shapes.length} shapes,  ${gt.faces} faces`,!0;this.ctrl.info.num_shapes=this._build_shapes.length,this.changeStage(8)}const W=(new Date).getTime(),me=this.ctrl.project?this._full_geom:this._toplevel;let _e=!1,Be=!0;if(this.ctrl.project||(_e=this._clones.createInstancedMeshes(this.ctrl,me,this._draw_nodes,this._build_shapes,(0,b.HG)())),!_e)for(let gt=0;gt<this._draw_nodes.length;++gt){const Et=this._draw_nodes[gt];if(!Et.done&&(this.createEntryMesh(Et,Et.server_shape||this._build_shapes[Et.shapeid],me),(new Date).getTime()-W>500)){Be=!1;break}}return Be?this.ctrl.project?(this.changeStage(10),!0):(this.changeStage(0),!1):(this.isStage(7)||(this.drawing_log=`Building meshes ${this.ctrl.info.num_meshes} / ${this.ctrl.info.num_faces}`),!0)}if(this.isStage(9)){if(!this._main_painter)return this.changeStage(0,"Lost main painter"),!1;if(!this._main_painter._drawing_ready)return 1;this.changeStage(10)}return this.isStage(10)?(this.doProjection(),this.changeStage(0),!1):(console.error(`never come here, stage ${this.drawing_stage}`),!1)}createEntryMesh(W,me,_e){return this._splitColors&&W.stack&&(0===W.stack[0]?W.custom_color="green":1===W.stack[0]&&(W.custom_color="blue")),this._clones.createEntryMesh(this.ctrl,_e,W,me,(0,b.HG)()),!0}appendMoreNodes(W,me){if(!this.isStage(0)&&!me)return void(this._provided_more_nodes=W);if(this._more_nodes)for(let Be=0;Be<this._more_nodes.length;++Be){const gt=this._more_nodes[Be],Et=this._clones.createObject3D(gt.stack,this._toplevel,"delete_mesh");(0,w.G1)(Et),(0,X.qU)(gt.server_shape),delete gt.server_shape}if(delete this._more_nodes,!W)return;const _e=[];for(let Be=0;Be<W.length;++Be){const gt=W[Be],Et=gt.server_shape;Et?.ready&&this.createEntryMesh(gt,Et,this._toplevel)&&_e.push(gt)}_e.length>0&&(this._more_nodes=_e),me||this.render3D()}getProjectionSource(){return this._clones_owner?this._full_geom:this._main_painter?this._main_painter._drawing_ready?this._main_painter._toplevel:(console.warn("MAIN PAINTER NOT READY WHEN DO PROJECTION"),null):(console.warn("MAIN PAINTER DISAPPER"),null)}extendCustomBoundingBox(W){if(!W)return;this._customBoundingBox||(this._customBoundingBox=(new V.NRn).makeEmpty());const me=this._customBoundingBox.clone();this._customBoundingBox.union(W),this._customBoundingBox.equals(me)||(this._adjust_camera_with_render=!0)}getGeomBoundingBox(W,me){const _e=new V.NRn,Be=!this._clones;return void 0===W&&(W=this._toplevel),_e.makeEmpty(),this._customBoundingBox&&W===this._toplevel?(_e.union(this._customBoundingBox),_e):W?(W.traverse(gt=>{(Be||gt.stack&&gt instanceof V.eaF||gt.main_track&&gt instanceof V.DXC||gt.stacks&&gt instanceof V.ZLX)&&(0,X.UX)(gt,_e)}),"original"===me?(_e.translate(new V.Pq0(-W.position.x,-W.position.y,-W.position.z)),_e.min.multiply(new V.Pq0(1/W.scale.x,1/W.scale.y,1/W.scale.z)),_e.max.multiply(new V.Pq0(1/W.scale.x,1/W.scale.y,1/W.scale.z))):void 0!==me&&_e.expandByVector(_e.getSize(new V.Pq0).multiplyScalar(me)),_e):(_e.min.x=_e.min.y=_e.min.z=-1,_e.max.x=_e.max.y=_e.max.z=1,_e)}doProjection(){const W=this.getProjectionSource();if(!W)return!1;if((0,w.G1)(this._toplevel,!0),void 0===this.ctrl.projectPos){const me=this.getGeomBoundingBox(W),_e=me.min[this.ctrl.project],Be=me.max[this.ctrl.project];let gt=(_e+Be)/2;_e<0&&Be>0&&Math.abs(gt)<.2*Math.max(-_e,Be)&&(gt=0),this.ctrl.projectPos=gt}return W.traverse(me=>{if(!(me instanceof V.eaF&&me.stack))return;const _e=(0,X.qr)(me.geometry,me.parent.absMatrix||me.parent.matrixWorld,this.ctrl.project,this.ctrl.projectPos,me._flippedMesh);if(!_e)return;const Be=new V.eaF(_e,me.material.clone());this._toplevel.add(Be),Be.stack=me.stack}),!0}changedLight(W){if(!this._camera)return;const me=!W;W||(W=this.getGeomBoundingBox());const _e=W.max.x-W.min.x,Be=W.max.y-W.min.y,gt=W.max.z-W.min.z,Et=[],Mt=.5*(this.ctrl.light.power??1);if(this._camera._lights!==this.ctrl.light.kind)switch((0,w.G1)(this._camera,!0),this._camera._lights=this.ctrl.light.kind,this._camera._lights){case"ambient":this._camera.add(new V.$p8(15724527,Mt));break;case"hemisphere":this._camera.add(new V.dth(16777147,526368,Mt));break;case"mix":this._camera.add(new V.$p8(15724527,Mt));default:for(let Nt=0;Nt<6;++Nt){const Qt=new V.ZyN(15724527,Mt);this._camera.add(Qt),Qt._id=Nt}}for(let Nt=0;Nt<this._camera.children.length;++Nt){const Qt=this._camera.children[Nt];let Zt=!1;if(Qt.isAmbientLight||Qt.isHemisphereLight)Qt.intensity=Mt;else if(Qt.isDirectionalLight){switch(Qt._id){case 0:Qt.position.set(_e/5,Be/5,gt/5),Zt=this.ctrl.light.specular;break;case 1:Qt.position.set(0,0,gt/2),Zt=this.ctrl.light.front;break;case 2:Qt.position.set(0,2*Be,0),Zt=this.ctrl.light.top;break;case 3:Qt.position.set(0,-2*Be,0),Zt=this.ctrl.light.bottom;break;case 4:Qt.position.set(-2*_e,0,0),Zt=this.ctrl.light.left;break;case 5:Qt.position.set(2*_e,0,0),Zt=this.ctrl.light.right}Qt.power=Zt?Mt*Math.PI*4:0,Zt&&Et.push(Qt)}}Et.forEach(Nt=>{Nt.power=4*Mt*Math.PI/Et.length}),me&&this.render3D()}isOrthoCamera(){return 0===this.ctrl.camera_kind.indexOf("ortho")}createCamera(){this._camera&&(this._scene.remove(this._camera),(0,w.G1)(this._camera),delete this._camera),this.isOrthoCamera()?this._camera=new V.qUd(-this._scene_width/2,this._scene_width/2,this._scene_height/2,-this._scene_height/2,1,1e4):(this._camera=new V.ubm(25,this._scene_width/this._scene_height,1,1e4),this._camera.up=this.ctrl._yup?new V.Pq0(0,1,0):new V.Pq0(0,0,1));const W=new V.ZyN(15724527,.1);W.position.set(10,10,10),this._camera.add(W),this._scene.add(this._camera)}createSpecialEffects(){this._webgl&&this.ctrl.outline&&(0,v.isFunc)(this.createOutline)&&(this._effectComposer=new Le.s0(this._renderer),this._effectComposer.addPass(new Le.AH(this._scene,this._camera)),this.createOutline(this._scene_width,this._scene_height)),this.ensureBloom()}createScene(W,me,_e){var Be=this;return(0,be.A)(function*(){if(Be.superimpose){const gt=Xe(Be.getMainPainter());return gt?.renderer&&(Be._scene=gt.scene,Be._scene_width=gt.scene_width,Be._scene_height=gt.scene_height,Be._renderer=gt.renderer,Be._webgl=Be._renderer.jsroot_render3d===v.constants.Render3D.WebGL,Be._toplevel=new V.B69,Be._scene.add(Be._toplevel),(gt.scale_x||gt.scale_y||gt.scale_z)&&Be._toplevel.scale.set(gt.scale_x,gt.scale_y,gt.scale_z),(gt.offset_x||gt.offset_y||gt.offset_z)&&Be._toplevel.position.set(gt.offset_x,gt.offset_y,gt.offset_z),Be._toplevel.updateMatrix(),Be._toplevel.updateMatrixWorld(),Be._camera=gt.camera),Be._renderer?.jsroot_dom}return Be._scene=new V.Z58,Be._fog=new V.jUj(16777215,1,1e4),Be._scene.fog=Be.ctrl.use_fog?Be._fog:null,Be._scene.overrideMaterial=new V.G_z({color:7340287,vertexColors:!1,transparent:!0,opacity:.2,depthTest:!1}),Be._scene_width=W,Be._scene_height=me,Be.createCamera(),Be._selected_mesh=null,Be._overall_size=10,Be._toplevel=new V.B69,Be._scene.add(Be._toplevel),Be._scene.background=new V.Q1f(Be.ctrl.background),(0,w.Yw)(W,me,_e,{antialias:!0,logarithmicDepthBuffer:!1,preserveDrawingBuffer:!0}).then(gt=>{if(Be._renderer=gt,Be.batch_format&&(gt.jsroot_image_format=Be.batch_format),Be._webgl=Be._renderer.jsroot_render3d===v.constants.Render3D.WebGL,Be._renderer.setPixelRatio&&!(0,v.isNodeJs)()&&Be._renderer.setPixelRatio(window.devicePixelRatio),Be._renderer.setSize(W,me,!Be._fit_main_area),Be._renderer.localClippingEnabled=!0,Be._renderer.setClearColor(Be._scene.background,1),Be._fit_main_area&&Be._webgl){Be._renderer.domElement.style.width="100%",Be._renderer.domElement.style.height="100%";const Et=Be.selectDom();"static"===Et.style("position")&&Et.style("position","relative")}if(Be._animating=!1,Be.ctrl.doubleside=!1,Be.createSpecialEffects(),Be._fit_main_area&&!Be._webgl){const Mt=(0,v.getDocument)().createElementNS("http://www.w3.org/2000/svg","svg");return Mt.setAttribute("width",W),Mt.setAttribute("height",me),Mt.appendChild(Be._renderer.jsroot_dom),Mt}return Be._renderer.jsroot_dom})})()}startDrawGeometry(W){W||this.isStage(0)?(this._clones_owner&&this._clones&&this._clones.setDefaultColors(this.ctrl.dflt_colors),this._startm=(new Date).getTime(),this._last_render_tm=this._startm,this._last_render_meshes=0,this.changeStage(1),this._drawing_ready=!1,this.ctrl.info.num_meshes=0,this.ctrl.info.num_faces=0,this.ctrl.info.num_shapes=0,this._selected_mesh=null,this.ctrl.project&&(this._clones_owner?this._full_geom?this.changeStage(10):this._full_geom=new V.B69:this.changeStage(9)),delete this._last_manifest,delete this._last_hidden,delete this._draw_nodes_again,this.continueDraw()):this._draw_nodes_again=!0}resetAdvanced(){this.ctrl.depthTest=!0,this.ctrl.clipIntersect=!0,this.ctrl.depthMethod="ray",this.changedDepthMethod("norender"),this.changedDepthTest()}getOverallSize(W){if(!this._overall_size||W||this._customBoundingBox){const me=this.getGeomBoundingBox();if(!Number.isFinite(me.min.x))return 1e3;this._overall_size=2*Math.max(me.max.x-me.min.x,me.max.y-me.min.y,me.max.z-me.min.z)}return this._overall_size}createSnapshot(W){if(!this._renderer)return;this.render3D(0);const me=this._renderer.domElement.toDataURL("image/png");if("asis"===W)return me;me.replace("image/png","image/octet-stream");const _e=(0,v.getDocument)(),Be=_e.createElement("a");(0,v.isStr)(Be.download)&&(_e.body.appendChild(Be),Be.download=W||"geometry.png",Be.href=me,Be.click(),_e.body.removeChild(Be))}produceCameraUrl(W){if(!this._camera)return"";if(this._camera.isOrthographicCamera){const Zt=Math.round(100*this._camera.zoom);return this.ctrl.camera_kind+(100===Zt?"":`,zoom=${Zt}`)}let me="";if("perspective"!==this.ctrl.camera_kind&&(me=this.ctrl.camera_kind+","),!0===W){const Zt=this._camera?.position,dn=this._controls?.target;if(!Zt||!dn)return"";const vn=ai=>{let $n="";return ai<0&&($n="n",ai=-ai),$n+ai.toFixed(0)};let Fn=`${me}camx${vn(Zt.x)},camy${vn(Zt.y)},camz${vn(Zt.z)}`;return(dn.x||dn.y||dn.z)&&(Fn+=`,camlx${vn(dn.x)},camly${vn(dn.y)},camlz${vn(dn.z)}`),Fn}if(!this._lookat||!this._camera0pos)return"";const _e=(new V.Pq0).add(this._camera0pos).sub(this._lookat),Be=(new V.Pq0).add(this._camera.position).sub(this._lookat),gt=Math.min(1e4,Math.max(1,this.ctrl.zoom*Be.length()/_e.length()*100));_e.normalize(),Be.normalize();const Et=new V.PTz,Mt=new V.O9p;Et.setFromUnitVectors(_e,Be),Mt.setFromQuaternion(Et,"YZX");let Nt=Mt.y/Math.PI*180,Qt=Mt.z/Math.PI*180;return Nt<0&&(Nt+=360),Qt<0&&(Qt+=360),`${me}roty${Nt.toFixed(0)},rotz${Qt.toFixed(0)},zoom${gt.toFixed(0)}`}calculateZoom(){if(this._camera0pos&&this._camera&&this._lookat){const W=(new V.Pq0).add(this._camera0pos).sub(this._lookat);return(new V.Pq0).add(this._camera.position).sub(this._lookat).length()/W.length()}return 0}adjustCameraPosition(W,me){if(!this._toplevel||this.superimpose)return;const _e=!0===W,Be="first"===W||_e,gt="only_set"===W,Et=this.getGeomBoundingBox();if(!Number.isFinite(Et.min.x))return void console.log("FAILS to get geometry bounding box");const Mt=Et.max.x-Et.min.x,Nt=Et.max.y-Et.min.y,Qt=Et.max.z-Et.min.z,Zt=(Et.max.x+Et.min.x)/2,dn=(Et.max.y+Et.min.y)/2,vn=(Et.max.z+Et.min.z)/2,Fn=this.ctrl._axis||"bar"===this.ctrl.camera_overlay?.2:.1;if(this._scene_size&&!_e){const Rn=this._scene_size,ei=(Ue,Y,E)=>(E||(E=Math.abs((Ue+Y)/2)),E<=1e-20||Math.abs(Y-Ue)/E>.01);if(!(ei(Mt,Rn.sizex)||ei(Nt,Rn.sizey)||ei(Qt,Rn.sizez)||ei(Zt,Rn.midx,Rn.sizex)||ei(dn,Rn.midy,Rn.sizey)||ei(vn,Rn.midz,Rn.sizez)))return void(this.ctrl.select_in_view&&this.startDrawGeometry())}if(this._scene_size={sizex:Mt,sizey:Nt,sizez:Qt,midx:Zt,midy:dn,midz:vn},this._overall_size=2*Math.max(Mt,Nt,Qt),this._camera.near=this._overall_size/350,this._camera.far=100*this._overall_size,this._fog.near=.5*this._overall_size,this._fog.far=5*this._overall_size,Be)for(let Rn=0;Rn<3;++Rn){const ei=this.ctrl.clip[Rn];ei.min=Et.min[ei.name],ei.max=Et.max[ei.name];const Yi=ei.max-ei.min;ei.max+=.01*Yi,ei.min-=.01*Yi,ei.step=Yi>100?.1:Yi>1?.001:void 0,ei.value?ei.value<ei.min?ei.value=ei.min:ei.value>ei.max&&(ei.value=ei.max):ei.value=(ei.min+ei.max)/2}let ai=2*this.ctrl.zoom;const $n=Math.max(Mt,Nt,Qt),kn=this.ctrl.camera_kind.indexOf("N")>0?-1:1;if(this._lookat=new V.Pq0(Zt,dn,vn),this._camera0pos=new V.Pq0(-2*$n,0,0),this._camera.updateMatrixWorld(),this._camera.updateProjectionMatrix(),(this.ctrl.rotatey||this.ctrl.rotatez)&&this.ctrl.can_rotate){const Rn=this.calculateZoom();me&&Rn&&(ai=2*Rn);const ei=new V.O9p(0,this.ctrl.rotatey/180*Math.PI,this.ctrl.rotatez/180*Math.PI,"YZX");this._camera.position.set(-ai*$n,0,0),this._camera.position.applyEuler(ei),this._camera.position.add(new V.Pq0(Zt,dn,vn)),me&&Rn&&(ai*=Rn/this.calculateZoom(),this._camera.position.set(-ai*$n,0,0),this._camera.position.applyEuler(ei),this._camera.position.add(new V.Pq0(Zt,dn,vn)))}else if(void 0!==this.ctrl.camx&&void 0!==this.ctrl.camy&&void 0!==this.ctrl.camz)this._camera.position.set(this.ctrl.camx,this.ctrl.camy,this.ctrl.camz),this._lookat.set(this.ctrl.camlx||0,this.ctrl.camly||0,this.ctrl.camlz||0),this.ctrl.camx=this.ctrl.camy=this.ctrl.camz=this.ctrl.camlx=this.ctrl.camly=this.ctrl.camlz=void 0;else if("orthoXOY"===this.ctrl.camera_kind||"orthoXNOY"===this.ctrl.camera_kind)this._camera.up.set(0,1,0),this._camera.position.set(kn<0?2*Zt:0,0,vn+kn*Qt*2),this._lookat.set(kn<0?2*Zt:0,0,vn),this._camera.left=Et.min.x-Fn*Mt,this._camera.right=Et.max.x+Fn*Mt,this._camera.top=Et.max.y+Fn*Nt,this._camera.bottom=Et.min.y-Fn*Nt,me||(this._camera.zoom=this.ctrl.zoom||1),this._camera.orthoSign=kn,this._camera.orthoZ=[vn,Qt/2];else if("orthoXOZ"===this.ctrl.camera_kind||"orthoXNOZ"===this.ctrl.camera_kind)this._camera.up.set(0,0,1),this._camera.position.set(kn<0?2*Zt:0,dn-kn*Nt*2,0),this._lookat.set(kn<0?2*Zt:0,dn,0),this._camera.left=Et.min.x-Fn*Mt,this._camera.right=Et.max.x+Fn*Mt,this._camera.top=Et.max.z+Fn*Qt,this._camera.bottom=Et.min.z-Fn*Qt,me||(this._camera.zoom=this.ctrl.zoom||1),this._camera.orthoIndicies=[0,2,1],this._camera.orthoRotation=Rn=>Rn.rotateX(Math.PI/2),this._camera.orthoSign=kn,this._camera.orthoZ=[dn,-Nt/2];else if("orthoZOY"===this.ctrl.camera_kind||"orthoZNOY"===this.ctrl.camera_kind)this._camera.up.set(0,1,0),this._camera.position.set(Zt-kn*Mt*2,0,kn<0?2*vn:0),this._lookat.set(Zt,0,kn<0?2*vn:0),this._camera.left=Et.min.z-Fn*Qt,this._camera.right=Et.max.z+Fn*Qt,this._camera.top=Et.max.y+Fn*Nt,this._camera.bottom=Et.min.y-Fn*Nt,me||(this._camera.zoom=this.ctrl.zoom||1),this._camera.orthoIndicies=[2,1,0],this._camera.orthoRotation=Rn=>Rn.rotateY(-Math.PI/2),this._camera.orthoSign=kn,this._camera.orthoZ=[Zt,-Mt/2];else if("orthoZOX"===this.ctrl.camera_kind||"orthoZNOX"===this.ctrl.camera_kind)this._camera.up.set(1,0,0),this._camera.position.set(0,dn-kn*Nt*2,kn>0?2*vn:0),this._lookat.set(0,dn,kn>0?2*vn:0),this._camera.left=Et.min.z-Fn*Qt,this._camera.right=Et.max.z+Fn*Qt,this._camera.top=Et.max.x+Fn*Mt,this._camera.bottom=Et.min.x-Fn*Mt,me||(this._camera.zoom=this.ctrl.zoom||1),this._camera.orthoIndicies=[2,0,1],this._camera.orthoRotation=Rn=>Rn.rotateX(Math.PI/2).rotateY(Math.PI/2),this._camera.orthoSign=kn,this._camera.orthoZ=[dn,-Nt/2];else if(this.ctrl.project)switch(this.ctrl.project){case"x":this._camera.position.set(1.5*ai*Math.max(Nt,Qt),0,0);break;case"y":this._camera.position.set(0,1.5*ai*Math.max(Mt,Qt),0);break;case"z":this._camera.position.set(0,0,1.5*ai*Math.max(Mt,Nt))}else"perspXOZ"===this.ctrl.camera_kind?(this._camera.up.set(0,1,0),this._camera.position.set(Zt-3*$n,dn,vn)):"perspYOZ"===this.ctrl.camera_kind?(this._camera.up.set(1,0,0),this._camera.position.set(Zt,dn-3*$n,vn)):"perspXOY"===this.ctrl.camera_kind?(this._camera.up.set(0,0,1),this._camera.position.set(Zt-3*$n,dn,vn)):this.ctrl._yup?(this._camera.up.set(0,1,0),this._camera.position.set(Zt-ai*Math.max(Mt,Qt),dn+ai*Nt,vn-ai*Math.max(Mt,Qt))):(this._camera.up.set(0,0,1),this._camera.position.set(Zt-ai*Math.max(Mt,Nt),dn-ai*Math.max(Mt,Nt),vn+ai*Qt));if(this._camera.isOrthographicCamera&&this.isOrthoCamera()&&this._scene_width&&this._scene_height){const Rn=this._scene_width/this._scene_height,ei=this._camera.right-this._camera.left,Yi=this._camera.top-this._camera.bottom;if(Rn>ei/Yi){const Ue=(this._camera.right+this._camera.left)/2;this._camera.left=Ue-Yi*Rn/2,this._camera.right=Ue+Yi*Rn/2}else{const Ue=(this._camera.top+this._camera.bottom)/2;this._camera.top=Ue+ei/Rn/2,this._camera.bottom=Ue-ei/Rn/2}}this._camera.lookAt(this._lookat),this._camera.updateProjectionMatrix(),this.changedLight(Et),this._controls&&(this._controls.target.copy(this._lookat),gt||this._controls.update()),this.ctrl.select_in_view&&!gt&&this.startDrawGeometry()}setCameraPosition(W,me,_e){if(!this.ctrl)return;this.ctrl.rotatey=W||0,this.ctrl.rotatez=me||0;let Be=!1;_e&&Number.isFinite(_e)?this.ctrl.zoom=_e:Be=!0,this.adjustCameraPosition(!1,Be)}setCameraPositionAndLook(W,me,_e,Be,gt,Et){this.ctrl&&(this.ctrl.camx=W,this.ctrl.camy=me,this.ctrl.camz=_e,this.ctrl.camlx=Be,this.ctrl.camly=gt,this.ctrl.camlz=Et,this.adjustCameraPosition(!1))}focusOnItem(W){if(!W||!this._clones)return;const me=this._clones.findStackByName(W);me&&this.focusCamera(this._clones.resolveStack(me,!0),!1)}focusCamera(W,me){if(this.ctrl.project||this.isOrthoCamera())return this.adjustCameraPosition(!0),this.render3D();let _e=new V.NRn;if(void 0===W)_e=this.getGeomBoundingBox();else if(W instanceof V.eaF)_e.setFromObject(W);else{const ei=(new V.Pq0).setFromMatrixPosition(W.matrix),Yi=W.node,Ue=new V.Pq0(Yi.fDX,Yi.fDY,Yi.fDZ).multiplyScalar(.5);_e.min=ei.clone().sub(Ue),_e.max=ei.clone().add(Ue)}const Be=_e.max.x-_e.min.x,gt=_e.max.y-_e.min.y,Et=_e.max.z-_e.min.z,Mt=(_e.max.x+_e.min.x)/2,Nt=(_e.max.y+_e.min.y)/2,Qt=(_e.max.z+_e.min.z)/2;let Zt,dn=50,vn=0;Zt=this.ctrl._yup?new V.Pq0(Mt-2*Math.max(Be,Et),Nt+2*gt,Qt-2*Math.max(Be,Et)):new V.Pq0(Mt-2*Math.max(Be,gt),Nt-2*Math.max(Be,gt),Qt+2*Et);const Fn=new V.Pq0(Mt,Nt,Qt),ai=this._controls.target,$n=Zt.sub(this._camera.position).divideScalar(dn),kn=Fn.sub(ai).divideScalar(dn);if(me=me&&this._webgl){for(let ei=0;ei<3;++ei){const Yi=this.ctrl.clip[ei];Yi.enabled||(Yi.value=Yi.min,Yi.enabled=!0),Yi.inc=((Yi.min+Yi.max)/2-Yi.value)/dn}this.updateClipping()}this._animating=!0;const Rn=()=>{if(void 0===this._animating)return;this._animating?requestAnimationFrame(Rn):this._geom_viewer||this.startDrawGeometry();const ei=1-Math.cos(2*Math.PI*vn/dn);this._camera.position.add($n.clone().multiplyScalar(ei)),ai.add(kn.clone().multiplyScalar(ei)),this._lookat=ai,this._camera.lookAt(this._lookat),this._camera.updateProjectionMatrix();const Yi=(new Date).getTime();if(me){for(let Y=0;Y<3;++Y)this.ctrl.clip[Y].value+=this.ctrl.clip[Y].inc*ei;this.updateClipping()}else this.render3D(0);const Ue=(new Date).getTime();0===vn&&Ue-Yi>200&&(dn=20),vn++,this._animating=vn<dn};Rn()}autorotate(W){const me=void 0===W?2:W;let _e=new Date;const Be=()=>{if(!this._renderer||!this.ctrl)return;const gt=new Date;this.ctrl.rotate&&requestAnimationFrame(Be),this._controls&&(this._controls.autoRotate=this.ctrl.rotate,this._controls.autoRotateSpeed=me*(gt.getTime()-_e.getTime())/16.6666,this._controls.update()),_e=new Date,this.render3D(0)};this._webgl&&Be()}completeScene(){}drawCount(W,me){var _e=this;return(0,be.A)(function*(){const Be=vn=>(_e.isBatchMode()?"anytime":vn.toString())+" ms",gt=["Unique nodes: "+_e._clones.nodes.length,"Unique visible: "+W,"Time to clone: "+Be(me)];_e._clones.scanVisible();let Et=0;const Mt={clones:_e._clones,cnt:[],func(vn){return void 0===this.cnt[this.last]?this.cnt[this.last]=1:this.cnt[this.last]++,Et+=(0,X._b)(this.clones.getNodeShape(vn.id)),!0}};let Nt=(new Date).getTime(),Qt=_e._clones.scanVisible(Mt),Zt=(new Date).getTime();gt.push(`Total visible nodes: ${Qt}`,`Total shapes: ${Et}`);for(let vn=0;vn<Mt.cnt.length;++vn)void 0!==Mt.cnt[vn]&&gt.push(`  lvl${vn}: ${Mt.cnt[vn]}`);gt.push(`Time to scan: ${Be(Zt-Nt)}`,"","Check timing for matrix calculations ...");const dn=_e.selectDom().style("overflow","auto");return _e.isBatchMode()?dn.property("_json_object_",gt):gt.forEach(vn=>dn.append("p").text(vn)),(0,v.postponePromise)(()=>{Mt.domatrix=!0,Nt=(new Date).getTime(),Qt=_e._clones.scanVisible(Mt),Zt=(new Date).getTime();const vn=`Time to scan with matrix: ${Be(Zt-Nt)}`;return _e.isBatchMode()?gt.push(vn):dn.append("p").text(vn),_e},100)})()}performDrop(W,me,_e,Be){var gt=this;return(0,be.A)(function*(){if("TTree"===W?.$kind){let Et="extract_geo_tracks";Be&&Be.indexOf("$")>0&&(Et=Be.slice(0,Be.indexOf("$")),Be=Be.slice(Be.indexOf("$")+1));const Mt=(0,v.findFunction)(Et);return Mt?Mt(W,Be).then(Nt=>Nt?gt.drawExtras(Nt,"",!1).then(()=>(gt.updateClipping(!0),gt.render3D(100))):gt):Promise.reject(Error(`Function ${Et} not found`))}return gt.drawExtras(W,me).then(Et=>Et?(_e&&(_e._painter=gt),gt.render3D(100)):gt)})()}mouseOverHierarchy(W,me,_e){if(!this.ctrl)return;const Be=_e._obj;!Be||Be._typename!==k&&Be._typename!==ee&&Be._typename!==v.clTPolyMarker3D||this.highlightMesh(null,65280,W?Be:null)}clearExtras(){this.getExtrasContainer("delete"),delete this._extraObjects,this.render3D()}addExtra(W,me){return void 0===this._extraObjects&&(this._extraObjects=(0,v.create)(v.clTList)),!(this._extraObjects.arr.indexOf(W)>=0||(this._extraObjects.Add(W,me),delete W.$hidden_via_menu,0))}extraObjectVisible(W,me,_e){if(!this._extraObjects)return;const Be=W.itemFullName(me);let gt=this._extraObjects.opt.indexOf(Be);if(gt<0&&me._obj&&(gt=this._extraObjects.arr.indexOf(me._obj),gt>=0&&(this._extraObjects.opt[gt]=Be)),gt<0)return;const Et=this._extraObjects.arr[gt];let Mt=!!Et.$hidden_via_menu;if(_e){Et.$hidden_via_menu=Mt,Mt=!Mt;let Nt=null;this._toplevel.traverse(Qt=>{Qt.geo_object===Et&&(Nt=Qt)}),Nt?(Nt.visible=Mt,this.render3D()):Mt&&this.drawExtras(Et,"",!1).then(()=>{this.updateClipping(!0),this.render3D()})}return Mt}drawExtras(W,me,_e,Be){var gt=this;return(0,be.A)(function*(){if(!W?._typename||!_e&&W.$hidden_via_menu)return!1;let Et=!1;void 0===_e?(_e=!0,Et=!0):Be&&(Et=!0);let Mt=!1;if(W._typename===v.clTList||W._typename===v.clTObjArray){if(!W.arr)return!1;const Nt=[];for(let Qt=0;Qt<W.arr.length;++Qt){let dn=W.opt?W.opt[Qt]:"";dn||(dn=(me||"<prnt>")+`/[${Qt}]`),Nt.push(gt.drawExtras(W.arr[Qt],dn,_e))}Mt=Promise.all(Nt).then(Qt=>Qt.indexOf(!0)>=0)}else"Mesh"===W._typename?(gt.addToExtrasContainer(W),Mt=Promise.resolve(!0)):"TGeoTrack"===W._typename?(!_e||gt.addExtra(W,me))&&(Mt=gt.drawGeoTrack(W,me)):W._typename===v.clTPolyLine3D?(!_e||gt.addExtra(W,me))&&(Mt=gt.drawPolyLine(W,me)):W._typename===k||W._typename===`${v.nsREX}REveTrack`?(!_e||gt.addExtra(W,me))&&(Mt=gt.drawEveTrack(W,me)):W._typename===ee||W._typename===`${v.nsREX}REvePointSet`||W._typename===v.clTPolyMarker3D?(!_e||gt.addExtra(W,me))&&(Mt=gt.drawHit(W,me)):(W._typename===I||W._typename===ge)&&(!_e||gt.addExtra(W,me))&&(Mt=gt.drawExtraShape(W,me));return(0,v.getPromise)(Mt).then(Nt=>{if(!Nt||!Et)return Nt;gt.updateClipping(!0);const Qt=gt.render3D(100,!!Be&&"nopromise");return Be?gt:Qt})})()}getExtrasContainer(W,me){if(!this._toplevel)return null;me||(me="tracks");let _e=null;const Be=[];for(let gt=0;gt<this._toplevel.children.length;++gt){const Et=this._toplevel.children[gt];if(Et._extras){if("collect"===W){Be.push(Et);continue}if(Et._extras===me){_e=Et;break}}}if("collect"===W){for(let gt=0;gt<Be.length;++gt)this._toplevel.remove(Be[gt]);return Be}return"delete"===W?(_e&&this._toplevel.remove(_e),(0,w.G1)(_e),null):("get"!==W&&!_e&&(_e=new V.B69,_e._extras=me,this._toplevel.add(_e)),_e)}addToExtrasContainer(W,me){const _e=this.getExtrasContainer("",me);_e?_e.add(W):(console.warn("Fail to add object to extras"),(0,w.G1)(W))}drawGeoTrack(W,me){if(!W?.fNpoints)return!1;const _e=v.browser.isWin?1:W.fLineWidth||1,Be=(0,b.oU)(W.fLineColor)||"#ff00ff",gt=Math.round(W.fNpoints/4),Et=new Float32Array(6*(gt-1)),Mt=this.ctrl.projectPos,Nt="x"===this.ctrl.project,Qt="y"===this.ctrl.project,Zt="z"===this.ctrl.project;for(let Fn=0,ai=0;Fn<gt-1;++Fn,ai+=6)Et[ai]=Nt?Mt:W.fPoints[4*Fn],Et[ai+1]=Qt?Mt:W.fPoints[4*Fn+1],Et[ai+2]=Zt?Mt:W.fPoints[4*Fn+2],Et[ai+3]=Nt?Mt:W.fPoints[4*Fn+4],Et[ai+4]=Qt?Mt:W.fPoints[4*Fn+5],Et[ai+5]=Zt?Mt:W.fPoints[4*Fn+6];const dn=new V.mrM({color:Be,linewidth:_e}),vn=(0,w.Fc)(Et,dn);return vn.defaultOrder=vn.renderOrder=1e6,vn.geo_name=me,vn.geo_object=W,vn.hightlightWidthScale=2,0===me?.indexOf("<prnt>/Tracks")&&(vn.main_track=!0),this.addToExtrasContainer(vn),!0}drawPolyLine(W,me){if(!W)return!1;const _e=v.browser.isWin?1:W.fLineWidth||1,Be=(0,b.oU)(W.fLineColor)||"#ff00ff",gt=W.fN,Et=W.fP,Mt=new Float32Array(6*(gt-1)),Nt=this.ctrl.projectPos,Qt="x"===this.ctrl.project,Zt="y"===this.ctrl.project,dn="z"===this.ctrl.project;for(let ai=0,$n=0;ai<gt-1;++ai,$n+=6)Mt[$n]=Qt?Nt:Et[3*ai],Mt[$n+1]=Zt?Nt:Et[3*ai+1],Mt[$n+2]=dn?Nt:Et[3*ai+2],Mt[$n+3]=Qt?Nt:Et[3*ai+3],Mt[$n+4]=Zt?Nt:Et[3*ai+4],Mt[$n+5]=dn?Nt:Et[3*ai+5];const vn=new V.mrM({color:Be,linewidth:_e}),Fn=(0,w.Fc)(Mt,vn);return Fn.defaultOrder=Fn.renderOrder=1e6,Fn.geo_name=me,Fn.geo_object=W,Fn.hightlightWidthScale=2,this.addToExtrasContainer(Fn),!0}drawEveTrack(W,me){if(!W||W.fN<=0)return!1;const _e=v.browser.isWin?1:W.fLineWidth||1,Be=(0,b.oU)(W.fLineColor)||"#ff00ff",gt=new Float32Array(6*(W.fN-1)),Et=this.ctrl.projectPos,Mt="x"===this.ctrl.project,Nt="y"===this.ctrl.project,Qt="z"===this.ctrl.project;for(let vn=0,Fn=0;vn<W.fN-1;++vn,Fn+=6)gt[Fn]=Mt?Et:W.fP[3*vn],gt[Fn+1]=Nt?Et:W.fP[3*vn+1],gt[Fn+2]=Qt?Et:W.fP[3*vn+2],gt[Fn+3]=Mt?Et:W.fP[3*vn+3],gt[Fn+4]=Nt?Et:W.fP[3*vn+4],gt[Fn+5]=Qt?Et:W.fP[3*vn+5];const Zt=new V.mrM({color:Be,linewidth:_e}),dn=(0,w.Fc)(gt,Zt);return dn.defaultOrder=dn.renderOrder=1e6,dn.geo_name=me,dn.geo_object=W,dn.hightlightWidthScale=2,this.addToExtrasContainer(dn),!0}drawHit(W,me){var _e=this;return(0,be.A)(function*(){if(!W||!W.fN||W.fN<0)return!1;const Be=W.fN,gt=_e.ctrl.projectPos,Et="x"===_e.ctrl.project,Mt="y"===_e.ctrl.project,Nt="z"===_e.ctrl.project,Qt=Math.max(W.fMarkerSize*_e.getOverallSize()*(_e._dummy?.015:.005),.2),Zt=new w._l(Be,_e._webgl,Qt);for(let dn=0;dn<Be;dn++)Zt.addPoint(Et?gt:W.fP[3*dn],Mt?gt:W.fP[3*dn+1],Nt?gt:W.fP[3*dn+2]);return Zt.createPoints({color:(0,b.oU)(W.fMarkerColor)||"#0000ff",style:W.fMarkerStyle}).then(dn=>(dn.defaultOrder=dn.renderOrder=1e6,dn.highlightScale=2,dn.geo_name=me,dn.geo_object=W,_e.addToExtrasContainer(dn),!0))})()}drawExtraShape(W,me){const _e=fs(W);return!!_e&&(_e.geo_name=me,_e.geo_object=W,this.addToExtrasContainer(_e),!0)}findNodeWithVolume(W,me,_e,Be,gt){let Et=!1,Mt=null;if(_e)Be&&(Be+="/"),Be+=_e.fName;else{if(!(_e=this.getGeometry())&&0!==(0,X.Dh)(_e))return null;Be=this.geo_manager?_e.fName:"",Et=!0,gt=[]}if(!_e.fVolume||_e.fVolume._searched)return null;if(W.test(_e.fVolume.fName)&&(Mt=me({node:_e,item:Be}),Mt))return Mt;if(_e.fVolume._searched=!0,gt.push(_e.fVolume),_e.fVolume.fNodes)for(let Nt=0,Qt=_e.fVolume.fNodes.arr.length;Nt<Qt&&(Mt=this.findNodeWithVolume(W,me,_e.fVolume.fNodes.arr[Nt],Be,gt),!Mt);++Nt);if(Et)for(let Nt=0,Qt=gt.length;Nt<Qt;++Nt)delete gt[Nt]._searched;return Mt}loadMacro(W){var me=this;return(0,be.A)(function*(){const _e={obj:me.getGeometry(),prefix:""};if(me.geo_manager&&(_e.prefix=_e.obj.fName),!W||W.length<3||0!==(0,X.Dh)(_e.obj))return _e;const Be={GetVolume:gt=>{const Et=new RegExp("^"+gt+"$"),Mt=me.findNodeWithVolume(Et,Nt=>Nt);return Mt||console.log(`Did not found ${gt} volume`),{found:Mt,fVolume:Mt?.node?.fVolume,InvisibleAll(Nt){(0,X.N_)(this.fVolume,Nt)},Draw(){!this.found||!this.fVolume||(_e.obj=this.found.node,_e.prefix=this.found.item,console.log(`Select volume for drawing ${this.fVolume.fName} ${_e.prefix}`))},SetTransparency(Nt){this.fVolume?.fMedium?.fMaterial&&(this.fVolume.fMedium.fMaterial.fFillStyle=3e3+Nt)},SetLineColor(Nt){this.fVolume&&(this.fVolume.fLineColor=Nt)}}},DefaultColors:()=>{me.ctrl.dflt_colors=!0},SetMaxVisNodes:gt=>{me.ctrl.maxnodes||(me.ctrl.maxnodes=parseInt(gt)||0)},SetVisLevel:gt=>{me.ctrl.vislevel||(me.ctrl.vislevel=parseInt(gt)||0)}};return(0,xe.Rh)(`Loading macro ${W}`),(0,v.httpRequest)(W,"text").then(gt=>{const Et=gt.split("\n");let Mt=0;for(;Mt<Et.length;){let Nt=Et[Mt++].trim();if(!(0===Nt.indexOf("//")||Nt.indexOf("gGeoManager")<0||(Nt=Nt.replace("->GetVolume",".GetVolume"),Nt=Nt.replace("->InvisibleAll",".InvisibleAll"),Nt=Nt.replace("->SetMaxVisNodes",".SetMaxVisNodes"),Nt=Nt.replace("->DefaultColors",".DefaultColors"),Nt=Nt.replace("->Draw",".Draw"),Nt=Nt.replace("->SetTransparency",".SetTransparency"),Nt=Nt.replace("->SetLineColor",".SetLineColor"),Nt=Nt.replace("->SetVisLevel",".SetVisLevel"),Nt.indexOf("->")>=0)))try{new Function("gGeoManager",Nt)(Be)}catch{console.error(`Problem by processing ${Nt}`)}}return _e}).catch(()=>(console.error(`Fail to load ${W}`),_e))})()}assignClones(W){this._clones_owner=!0,this._clones=W}extractRawShapes(W,me){let _e=null,Be=0;me&&(_e=W.numnodes>1e6?{length:W.numnodes}:new Array(W.numnodes)),W.nodes.forEach(Et=>{Et=X.De.formatServerElement(Et),_e?_e[Et.id]=Et:this._clones.updateNode(Et)}),me&&(this._clones_owner=!0,this._clones=new X.De(null,_e),this._clones.name_prefix=this._clones.getNodeName(0),this._clones.setConfig(this.ctrl),this._clones.maxdepth=20);let gt=0;W.cfg&&(gt=W.cfg.nsegm),gt&&(Be=(0,X.QL)("GradPerSegm"),(0,X.QL)("GradPerSegm",360/Math.max(gt,6)));for(let Et=0;Et<W.visibles.length;++Et){const Mt=W.visibles[Et],Nt=Mt.ri;Nt&&(Mt.server_shape=Nt.server_shape=(0,X.uz)(Nt,gt))}return Be&&(0,X.QL)("GradPerSegm",Be),!0}prepareObjectDraw(W,me){var _e=this;return(0,be.A)(function*(){if(_e.did_cleanup)return null;if("__geom_viewer_append__"===me)_e._new_append_nodes=W,_e.ctrl.use_worker=0,_e._geom_viewer=!0;else if("__geom_viewer_selection__"===me&&_e._clones)_e._new_draw_nodes=W,_e.ctrl.use_worker=0,_e._geom_viewer=!0;else if(_e._main_painter)_e._clones_owner=!1,_e._clones=_e._main_painter._clones,console.log(`Reuse clones ${_e._clones.nodes.length} from main painter`);else if(W){_e._start_drawing_time=(new Date).getTime(),_e._clones_owner=!0,_e._clones=new X.De(W);let gt=_e.ctrl.vislevel,Et=_e.ctrl.maxnodes;_e.geo_manager&&(!gt&&_e.geo_manager.fVisLevel&&(gt=_e.geo_manager.fVisLevel),Et||(Et=_e.geo_manager.fMaxVisNodes)),_e._clones.setVisLevel(gt),_e._clones.setMaxVisNodes(Et,_e.ctrl.more),_e._clones.setConfig(_e.ctrl),_e._clones.name_prefix=me;const Mt=!!_e.geo_manager&&!_e.ctrl.showtop;let Nt=_e.ctrl.no_screen?0:_e._clones.markVisibles(!0,!1,Mt);Nt=Nt<=0?_e._clones.markVisibles(!1,!1,Mt):_e._clones.markVisibles(!0,!0,Mt),_e._clones.produceIdShifts();const Qt=(new Date).getTime()-_e._start_drawing_time;if(_e._scene||console.log(`Creating clones ${_e._clones.nodes.length} takes ${Qt} ms uniquevis ${Nt}`),_e.ctrl._count)return _e.drawCount(Nt,Qt)}else _e._clones_owner=!1,_e._clones=null;let Be=Promise.resolve(!0);if(!_e._scene){_e._first_drawing=!0;const gt=_e.getPadPainter();if(_e._on_pad=!!gt,_e._on_pad){let Et,Mt,Nt;Be=(0,H.ensureTCanvas)(_e,"3d").then(()=>(gt.fillatt?.color&&(_e.ctrl.background=gt.fillatt.color),Nt=_e.getFramePainter(),_e.batch_mode=gt.isBatchMode(),Mt=(0,w.ke)(void 0,_e.batch_mode),(0,w.LR)(Nt),Nt.mode3d=!0,Et=Nt.getSizeFor3d(void 0,Mt),_e._fit_main_area=-1===Et.can3d,_e.createScene(Et.width,Et.height,Mt).then(Qt=>Nt.add3dCanvas(Et,Qt,Mt===v.constants.Render3D.WebGL))))}else{const Et=_e.selectDom("origin");_e.batch_mode=(0,v.isBatchMode)()||!Et.empty()&&Et.property("_batch_mode"),_e.batch_format=Et.property("_batch_format");const Mt=(0,w.ke)(_e.options.Render3D,_e.batch_mode);_e.ctrl.use_worker>0&&!_e.batch_mode&&_e.startWorker(),(0,w.LR)(_e);const Nt=_e.getSizeFor3d(void 0,Mt);_e._fit_main_area=-1===Nt.can3d,Be=_e.createScene(Nt.width,Nt.height,Mt).then(Qt=>_e.add3dCanvas(Nt,Qt,_e._webgl))}}return Be.then(()=>(_e._first_drawing&&!_e.ctrl.maxfaces&&(_e.ctrl.maxfaces=2e5*_e.ctrl.more),_e.setAsMainPainter(),_e.createToolbar(),_e._clones?new Promise(gt=>{_e._resolveFunc=gt,_e.showDrawInfo("Drawing geometry"),_e.startDrawGeometry(!0)}):_e.completeDraw()))})()}showDrawInfo(W){if(this.isBatchMode()||!this._first_drawing||!this._start_drawing_time)return;const me=this._renderer.domElement.parentNode;if(!me)return;let _e=me.querySelector(".geo_info");if(W){const Be=.001*((new Date).getTime()-this._start_drawing_time);_e||(_e=(0,v.getDocument)().createElement("p"),_e.setAttribute("class","geo_info"),_e.setAttribute("style","position: absolute; text-align: center; vertical-align: middle; top: 45%; left: 40%; color: red; font-size: 150%;"),me.append(_e)),_e.innerHTML=`${W}, ${Be.toFixed(1)}s`}else _e?.remove()}continueDraw(){if(this.isStage(0))return;const W=(new Date).getTime(),me=this._first_drawing?1e3:200;let _e=W;for(;;){const gt=this.nextDrawAction();if(!gt)break;if(_e=(new Date).getTime(),_e-this._startm>1e5){this.changeStage(0,"Abort build after 100s");break}if(!(!0===gt&&_e-W<me)&&(_e-W>me||1===gt||2===gt))return(0,xe.Rh)(this.drawing_log),this.showDrawInfo(this.drawing_log),this._first_drawing&&this._webgl&&this._num_meshes-this._last_render_meshes>100&&_e-this._last_render_tm>2.5*me&&(this.adjustCameraPosition(),this.render3D(-1),this._last_render_meshes=this.ctrl.info.num_meshes),void(2!==gt&&setTimeout(()=>this.continueDraw(),1===gt?100:1))}const Be=_e-this._startm;if((this._first_drawing||this._full_redrawing)&&console.log(`Create tm = ${Be} meshes ${this.ctrl.info.num_meshes} faces ${this.ctrl.info.num_faces}`),Be>300)return(0,xe.Rh)("Rendering geometry"),this.showDrawInfo("Rendering"),setTimeout(()=>this.completeDraw(!0),10);this.completeDraw(!0)}testCameraPosition(W){this._camera.updateMatrixWorld(),this.drawOverlay();const me=this._camera.position.clone();if(!(!W&&this._last_camera_position&&this._last_camera_position.distanceTo(me)<1e-4*(this._overall_size||1e3))){if(this._last_camera_position=me,this.ctrl._axis){const _e=(this._controls?.target||this._lookat).clone().sub(this._camera.position).normalize();this.getExtrasContainer("get","axis")?.traverse(Be=>{(0,v.isFunc)(Be._axis_flip)&&Be._axis_flip(_e)})}this.ctrl.project||(0,X.Pz)(this._toplevel,me,this.ctrl.depthMethod,this._clones)}}render3D(W,me){if(!this._renderer)return this.did_cleanup?console.warn("try to render after cleanup"):console.warn("renderer object not exists - check code"),this;const _e=void 0!==W&&W>0&&"nopromise"!==me;if(void 0===W&&(W=5),W>0&&this._webgl)return this.isBatchMode()&&(W=1),_e?new Promise(Et=>{this._render_resolveFuncs||(this._render_resolveFuncs=[]),this._render_resolveFuncs.push(Et),this.render_tmout||(this.render_tmout=setTimeout(()=>this.render3D(0),W))}):(this.render_tmout||(this.render_tmout=setTimeout(()=>this.render3D(0),W)),this);this.render_tmout&&(clearTimeout(this.render_tmout),delete this.render_tmout),(0,w.rv)(this._renderer);const Be=new Date;this._adjust_camera_with_render&&(this.adjustCameraPosition("only_set"),delete this._adjust_camera_with_render),this.testCameraPosition(-1===W),this._webgl&&this._effectComposer&&this._effectComposer.passes.length>0?this._effectComposer.render():this._webgl&&this._bloomComposer&&this._bloomComposer.passes.length>0?(this._renderer.clear(),this._camera.layers.set(1),this._bloomComposer.render(),this._renderer.clearDepth(),this._camera.layers.set(0),this._renderer.render(this._scene,this._camera)):this._renderer.render(this._scene,this._camera);const gt=new Date;if(this.last_render_tm=gt.getTime(),0===this.first_render_tm&&!0===me&&(this.first_render_tm=gt.getTime()-Be.getTime(),this.first_render_tm>500&&console.log(`three.js r${V.sPf}, first render tm = ${this.first_render_tm}`)),(0,w.oE)(this._renderer),this._render_resolveFuncs){const Et=this._render_resolveFuncs;delete this._render_resolveFuncs,Et.forEach(Mt=>Mt(this))}}startWorker(){this._worker||(this._worker_ready=!1,this._worker_jobs=0,this._worker=new Worker(v.source_dir+"scripts/geoworker.js"),this._worker.onmessage=W=>{if((0,v.isObject)(W.data)){if("log"in W.data)return console.log(`geo: ${W.data.log}`);if("progress"in W.data)return(0,xe.Rh)(W.data.progress);W.data.tm3=(new Date).getTime(),"init"in W.data?(this._worker_ready=!0,console.log("Worker ready: "+(W.data.tm3-W.data.tm0))):this.processWorkerReply(W.data)}},this._worker.postMessage({init:!0,browser:v.browser,tm0:(new Date).getTime(),vislevel:this._clones.getVisLevel(),maxvisnodes:this._clones.getMaxVisNodes(),clones:this._clones.nodes,sortmap:this._clones.sortmap}))}canSubmitToWorker(W){return!!this._worker&&this._worker_ready&&(0===this._worker_jobs||W)}submitToWorker(W){if(!this._worker)return!1;this._worker_jobs++,W.tm0=(new Date).getTime(),this._worker.postMessage(W)}processWorkerReply(W){if(this._worker_jobs--,"collect"in W)return this._new_draw_nodes=W.new_nodes,this._draw_all_nodes=W.complete,this.changeStage(3),this.continueDraw();if("shapes"in W){for(let me=0;me<W.shapes.length;++me){const _e=W.shapes[me],Be=this._build_shapes[me];_e.buf_pos&&_e.buf_norm&&(0===_e.buf_pos.length?Be.geom=null:_e.buf_pos.length!==_e.buf_norm.length?(console.error(`item.buf_pos.length ${_e.buf_pos.length} !== item.buf_norm.length ${_e.buf_norm.length}`),Be.geom=null):(Be.geom=new V.LoY,Be.geom.setAttribute("position",new V.THS(_e.buf_pos,3)),Be.geom.setAttribute("normal",new V.THS(_e.buf_norm,3))),Be.ready=!0,Be.nfaces=_e.nfaces)}return W.tm4=(new Date).getTime(),this.changeStage(7),this.continueDraw()}}testGeomChanges(){if(this._main_painter)return console.warn("Get testGeomChanges call for slave painter"),this._main_painter.testGeomChanges();this.startDrawGeometry();for(let W=0;W<this._slave_painters.length;++W)this._slave_painters[W].startDrawGeometry()}drawAxesAndOverlay(W){const me=this.drawAxes(),_e=this.drawOverlay();return me||_e?this.changedDepthMethod(W?"norender":void 0):W?null:this.render3D()}drawOverlay(){if(this.getExtrasContainer("delete","overlay"),!this.isOrthoCamera()||"none"===this.ctrl.camera_overlay)return!1;const W=.5/this._camera.zoom,me=(this._camera.left+this._camera.right)/2,_e=(this._camera.bottom+this._camera.top)/2,Be=me-(this._camera.right-this._camera.left)*W,gt=me+(this._camera.right-this._camera.left)*W,Et=_e-(this._camera.top-this._camera.bottom)*W,Mt=_e+(this._camera.top-this._camera.bottom)*W,Nt=.02*(Mt-Et),Qt=.015*(Mt-Et),Zt=.001*(Mt-Et),dn=Be+5*Qt,vn=gt-5*Qt,Fn=Et+3*Qt,ai=Mt-3*Qt,$n=new O.TB(null,(0,v.create)(v.clTAxis));$n.configureAxis("xaxis",dn,vn,dn,vn,!1,[dn,vn],{log:0,reverse:!1});const kn=new O.TB(null,(0,v.create)(v.clTAxis));kn.configureAxis("yaxis",Fn,ai,Fn,ai,!1,[Fn,ai],{log:0,reverse:!1});const Rn=this._camera.orthoIndicies??[0,1,2];let ei,Yi,Ue=0,Y=0;this._camera.orthoZ&&(Y=Ue=this._camera.orthoZ[0]);const E=(He,nt,it)=>{ei[Yi+Rn[0]]=He,ei[Yi+Rn[1]]=nt,ei[Yi+Rn[2]]=it??Y,Yi+=3},J=(He,nt)=>{const it=new Le._l(He,{font:w.Te,size:nt,height:0,curveSegments:5});return it.computeBoundingBox(),it._width=it.boundingBox.max.x-it.boundingBox.min.x,it._height=it.boundingBox.max.y-it.boundingBox.min.y,it.translate(-it._width/2,-it._height/2,0),this._camera.orthoSign<0&&it.rotateY(Math.PI),(0,v.isFunc)(this._camera.orthoRotation)&&this._camera.orthoRotation(it),it},Ae=(He,nt,it,lt,qt)=>{const at=[0,0,0];at[Rn[0]]=it,at[Rn[1]]=lt,at[Rn[2]]=qt??Y;const Jt=new V.eaF(He,nt);return Jt.translateX(at[0]).translateY(at[1]).translateZ(at[2]),Jt};if("bar"===this.ctrl.camera_overlay){const He=this.getExtrasContainer("create","overlay");let nt=.15*Be+.85*gt,it=.05*Be+.95*gt;const lt=.9*Mt+.1*Et,qt=.86*Mt+.14*Et,at=$n.createTicks();at.major?.length>1&&(nt=at.major[at.major.length-2],it=at.major[at.major.length-1]),ei=new Float32Array(18),Yi=0,E(nt,lt,Ue),E(nt,qt,Ue),E(nt,(lt+qt)/2,Ue),E(it,(lt+qt)/2,Ue),E(it,lt,Ue),E(it,qt,Ue);const Jt=new V.mrM({color:"green"}),tn=new V.V9B({color:"green",vertexColors:!1});He.add((0,w.Fc)(ei,Jt));const An=J($n.format(it-nt,!0),Math.abs(qt-lt));return He.add(Ae(An,tn,(it+nt)/2,(lt+qt)/2+.8*An._height,Ue)),!0}const Ce=0===this.ctrl.camera_overlay.indexOf("grid");if(Ce&&this._camera.orthoZ&&("gridf"===this.ctrl.camera_overlay?Y+=this._camera.orthoSign*this._camera.orthoZ[1]:"gridb"===this.ctrl.camera_overlay&&(Y-=this._camera.orthoSign*this._camera.orthoZ[1])),"axis"===this.ctrl.camera_overlay||Ce){const He=this.getExtrasContainer("create","overlay"),nt=new V.mrM({color:new V.Q1f("black")}),it=Ce?new V.mrM({color:new V.Q1f(12303291)}):null,lt=Ce?new V.Fvt({color:new V.Q1f(14540253),dashSize:Zt,gapSize:Zt}):null,qt=new V.V9B({color:"black",vertexColors:!1}),at=$n.createTicks();for(;at.next();){const tn=at.tick,An=1===at.kind?1:.6;if(Ce&&(ei=new Float32Array(6),Yi=0,E(tn,Mt-An*Nt-Zt),E(tn,Et+An*Nt+Zt),He.add((0,w.Fc)(ei,1===at.kind?it:lt))),ei=new Float32Array(12),Yi=0,E(tn,Mt),E(tn,Mt-An*Nt),E(tn,Et),E(tn,Et+An*Nt),He.add((0,w.Fc)(ei,nt)),1!==at.kind)continue;const ze=J($n.format(tn,!0),Qt);He.add(Ae(ze,qt,tn,Mt-Nt-Qt/2-ze._height/2)),He.add(Ae(ze,qt,tn,Et+Nt+Qt/2+ze._height/2))}const Jt=kn.createTicks();for(;Jt.next();){const tn=Jt.tick,An=1===Jt.kind?1:.6;if(Ce&&(ei=new Float32Array(6),Yi=0,E(Be+An*Nt+Zt,tn),E(gt-An*Nt-Zt,tn),He.add((0,w.Fc)(ei,1===Jt.kind?it:lt))),ei=new Float32Array(12),Yi=0,E(Be,tn),E(Be+An*Nt,tn),E(gt,tn),E(gt-An*Nt,tn),He.add((0,w.Fc)(ei,nt)),1!==Jt.kind)continue;const ze=J(kn.format(tn,!0),Qt);He.add(Ae(ze,qt,Be+Nt+Qt/2+ze._width/2,tn)),He.add(Ae(ze,qt,gt-Nt-Qt/2-ze._width/2,tn))}return!0}return!1}drawAxes(){if(this.getExtrasContainer("delete","axis"),!this.ctrl._axis)return!1;const W=this.getGeomBoundingBox(this._toplevel,this.superimpose?"original":void 0),me=this.getExtrasContainer("create","axis"),_e=.02*Math.max(W.max.x-W.min.x,W.max.y-W.min.y,W.max.z-W.min.z),Be=[0,0,0],gt=["x","y","z"],Et=["X","Y","Z"],Mt=["red","green","blue"],Nt=this.isOrthoCamera(),Qt=this.ctrl.camera_kind??"perspective";if(2===this.ctrl._axis)for(let Zt=0;Zt<3;++Zt){const dn=gt[Zt];W.min[dn]<=0&&W.max[dn]>=0||(Be[Zt]=(W.min[dn]+W.max[dn])/2)}for(let Zt=0;Zt<3;++Zt){let Ue=function(J,Ae){J._other_side=!1,J._axis_norm=Ae??new V.Pq0(1,0,0),J._axis_flip=function(Ce){const He=Ce.dot(this._axis_norm)<0;this._other_side!==He&&(this._other_side=He,this.rotateY(Math.PI))}},Y=function(J,Ae=-1){J._last_angle=Ae,J._axis_flip=function(Ce){let He=0;switch(this._axis_name){case"x":He=-Math.atan2(Ce.y,Ce.z);break;case"y":He=-Math.atan2(Ce.z,Ce.x);break;default:He=Math.atan2(Ce.y,Ce.x)}He=Math.round(He/Math.PI*2+2)%4,this._last_angle!==He&&(this.rotateX((He-this._last_angle)*Math.PI/2),this._last_angle=He)}};if(Nt&&Qt.indexOf(Et[Zt])<0)continue;const dn=new Float32Array(6),vn=Mt[Zt],Fn=gt[Zt],ai=J=>{if(!J)return"0";const Ae=Math.log10(Math.abs(J));if(Ae<0){if(Ae>-1)return J.toFixed(2);if(Ae>-2)return J.toFixed(3)}else{if(Ae<2)return J.toFixed(1);if(Ae<4)return J.toFixed(0)}return J.toExponential(2)},$n=ai(W.max[Fn])+" "+Et[Zt];switch(dn[0]=W.min.x,dn[1]=W.min.y,dn[2]=W.min.z,dn[3]=W.min.x,dn[4]=W.min.y,dn[5]=W.min.z,Zt){case 0:dn[3]=W.max.x;break;case 1:dn[4]=W.max.y;break;case 2:dn[5]=W.max.z}if(2===this.ctrl._axis)for(let J=0;J<6;++J)J%3!==Zt&&(dn[J]=Be[J%3]);const kn=new V.mrM({color:vn});let Rn=(0,w.Fc)(dn,kn);Rn._no_clip=!0,me.add(Rn);const ei=new V.V9B({color:vn,vertexColors:!1});if(0===Be[Zt]&&Be[Zt]>=W.min[Fn]&&Be[Zt]<=W.max[Fn]&&(2!==this.ctrl._axis||0===Zt)){const J=Nt?new V.tcD(.25*_e):new V.Gu$(.25*_e);Rn=new V.eaF(J,ei),Rn.translateX(0===Zt?Be[0]:dn[0]),Rn.translateY(1===Zt?Be[1]:dn[1]),Rn.translateZ(2===Zt?Be[2]:dn[2]),Rn._no_clip=!0,me.add(Rn)}let Yi=new Le._l($n,{font:w.Te,size:_e,height:0,curveSegments:5});Rn=new V.eaF(Yi,ei),Rn._no_clip=!0;let E=(new V.NRn).setFromObject(Rn);if(Yi.translate(.5*-E.max.x,-E.max.y/2,0),Rn.translateX(dn[3]),Rn.translateY(dn[4]),Rn.translateZ(dn[5]),Rn._axis_name=Fn,0===Zt)Nt&&Qt.indexOf("OX")>0?Y(Rn,0):(Nt?Qt.indexOf("OY")>0:this.ctrl._yup)?Ue(Rn,new V.Pq0(0,0,-1)):(Ue(Rn,new V.Pq0(0,1,0)),Rn.rotateX(Math.PI/2)),Rn.translateX(.5*_e+.5*E.max.x);else if(1===Zt)(Nt?Qt.indexOf("OY")>0:this.ctrl._yup)?(Y(Rn,2),Rn.rotateX(-Math.PI/2),Rn.rotateY(-Math.PI/2),Rn.translateX(.5*_e+.5*E.max.x)):(Ue(Rn),Rn.rotateX(Math.PI/2),Rn.rotateY(-Math.PI/2),Rn.translateX(.5*-E.max.x-.5*_e));else if(2===Zt){if(Nt?Qt.indexOf("OZ")<0:this.ctrl._yup){const J=Nt&&(Qt.indexOf("ZOX")>0||Qt.indexOf("ZNOX")>0);Ue(Rn,J?new V.Pq0(0,-1,0):void 0),Rn.rotateY(-Math.PI/2),J&&Rn.rotateX(-Math.PI/2)}else Y(Rn),Rn.rotateX(Math.PI/2),Rn.rotateZ(Math.PI/2);Rn.translateX(.5*_e+.5*E.max.x)}if(me.add(Rn),Yi=new Le._l(ai(W.min[Fn]),{font:w.Te,size:_e,height:0,curveSegments:5}),Rn=new V.eaF(Yi,ei),Rn._no_clip=!0,E=(new V.NRn).setFromObject(Rn),Yi.translate(.5*-E.max.x,-E.max.y/2,0),Rn._axis_name=Fn,Rn.translateX(dn[0]),Rn.translateY(dn[1]),Rn.translateZ(dn[2]),0===Zt)Nt&&Qt.indexOf("OX")>0?Y(Rn,0):(Nt?Qt.indexOf("OY")>0:this.ctrl._yup)?Ue(Rn,new V.Pq0(0,0,-1)):(Ue(Rn,new V.Pq0(0,1,0)),Rn.rotateX(Math.PI/2)),Rn.translateX(.5*-_e-.5*E.max.x);else if(1===Zt)(Nt?Qt.indexOf("OY")>0:this.ctrl._yup)?(Y(Rn,2),Rn.rotateX(-Math.PI/2),Rn.rotateY(-Math.PI/2),Rn.translateX(.5*-E.max.x-.5*_e)):(Ue(Rn),Rn.rotateX(Math.PI/2),Rn.rotateY(-Math.PI/2),Rn.translateX(.5*E.max.x+.5*_e));else if(2===Zt){if(Nt?Qt.indexOf("OZ")<0:this.ctrl._yup){const J=Nt&&(Qt.indexOf("ZOX")>0||Qt.indexOf("ZNOX")>0);Ue(Rn,J?new V.Pq0(0,-1,0):void 0),Rn.rotateY(-Math.PI/2),J&&Rn.rotateX(-Math.PI/2)}else Y(Rn),Rn.rotateX(Math.PI/2),Rn.rotateZ(Math.PI/2);Rn.translateX(.5*-E.max.x-.5*_e)}me.add(Rn)}return!0}setAxesDraw(W){return this.ctrl._axis="toggle"===W?this.ctrl._axis?0:1:"number"==typeof W?W:W?1:0,this.drawAxesAndOverlay()}setAutoRotate(W){this.ctrl.project||(void 0!==W&&(this.ctrl.rotate=W),this.autorotate(2.5))}toggleWireFrame(){this.ctrl.wireframe=!this.ctrl.wireframe,this.changedWireFrame()}setWireFrame(W){this.ctrl.wireframe=!!W,this.changedWireFrame()}setShowTop(W){this.ctrl.showtop=!!W,this.redrawObject("same")}changedClipping(W=-1){(W<0||this.ctrl.clip[W]?.enabled)&&this.updateClipping(!1,!0)}changedDepthTest(){if(!this._toplevel)return;const W=this.ctrl.depthTest;this._toplevel.traverse(me=>{me instanceof V.eaF&&(me.material.depthTest=W)}),this.render3D(0)}changedDepthMethod(W){if(delete this._last_camera_position,"norender"!==W)return this.render3D()}updateClipping(W,me){if(this._renderer?.jsroot_render3d===v.constants.Render3D.SVG)return;this._clipPlanes||(this._clipPlanes=[new V.Zcv(new V.Pq0(1,0,0),0),new V.Zcv(new V.Pq0(0,this.ctrl._yup?-1:1,0),0),new V.Zcv(new V.Pq0(0,0,this.ctrl._yup?1:-1),0)]);const _e=this.ctrl.clip,Be=[-1*_e[0].value,_e[1].value,(this.ctrl._yup?-1:1)*_e[2].value],gt=this.getExtrasContainer(this.ctrl.clipVisualize?"":"delete","clipping");let Et=[],Mt=!1,Nt=this.ctrl.clipIntersect?16:0;for(let vn=0;vn<3;++vn)if(_e[vn].enabled&&(Nt+=2<<vn),this._clipPlanes[vn].constant!==Be[vn]&&(_e[vn].enabled&&(Mt=!0),this._clipPlanes[vn].constant=Be[vn]),_e[vn].enabled&&Et.push(this._clipPlanes[vn]),gt&&_e[vn].enabled){const Fn=new V.ZM4(this._clipPlanes[vn],_e[vn].max-_e[vn].min);Fn._no_clip=!0,gt.add(Fn)}0===Et.length&&(Et=null),this._clipCfg!==Nt&&(Mt=!0),this._clipCfg=Nt;const Qt=!!Et,Zt=this.ctrl.clipIntersect,dn=Qt?V.$EB:V.hB5;return(me||Mt)&&this._scene.traverse(vn=>{!vn._no_clip&&void 0!==vn.material?.clippingPlanes&&(vn.material.clippingPlanes!==Et&&(vn.material.clipIntersection=Zt,vn.material.clippingPlanes=Et,vn.material.needsUpdate=!0),void 0!==vn.material.emissive&&vn.material.side!==dn&&(vn.material.side=dn,vn.material.needsUpdate=!0))}),this.ctrl.doubleside=Qt,W||this.render3D(0),Mt}setCompleteHandler(W){this._complete_handler=W}completeDraw(W){var me=this;return(0,be.A)(function*(){let _e=!1,Be=!1,gt=!0;if(!me.ctrl)return console.warn("ctrl object does not exist in completeDraw - something went wrong"),me;let Et=Promise.resolve(!0);return me._clones?(me._first_drawing||me._full_redrawing)&&me.ctrl.tracks&&me.geo_manager&&(Et=me.drawExtras(me.geo_manager.fTracks,"<prnt>/Tracks")):(gt=!1,me.getExtrasContainer("delete"),Et=me.drawExtras((me._main_painter?me._main_painter._extraObjects:null)||me._extraObjects,"",!1)),Et.then(()=>{if(me._full_redrawing&&(me.adjustCameraPosition("first"),me._full_redrawing=!1,Be=!0,me.changedDepthMethod("norender")),me._first_drawing&&(me.adjustCameraPosition("first"),me.showDrawInfo(),me._first_drawing=!1,_e=!0,Be=!0),_e&&me.completeScene(),Be&&(me.ctrl.trans_radial||me.ctrl.trans_z)&&me.changedTransformation("norender"),Be)return me.drawAxesAndOverlay(!0)}).then(()=>{if(me._scene.overrideMaterial=null,void 0!==me._provided_more_nodes&&(me.appendMoreNodes(me._provided_more_nodes,!0),delete me._provided_more_nodes),gt)return me.getExtrasContainer("delete"),me.drawExtras(me._main_painter?._extraObjects||me._extraObjects,"",!1)}).then(()=>(me.updateClipping(!0),me.render3D(0,!0),W&&(0,xe.Rh)(),me.addOrbitControls(),_e&&!me.isBatchMode()&&(0===me.ctrl.highlight&&(me.ctrl.highlight=me.first_render_tm<1e3),0===me.ctrl.highlight_scene&&(me.ctrl.highlight_scene=me.ctrl.highlight),me._webgl&&me.ctrl.rotate&&!me.ctrl.project&&me.autorotate(2.5),me._webgl&&me.ctrl.show_controls&&me.showControlGui(!0)),me.setAsMainPainter(),(0,v.isFunc)(me._resolveFunc)&&(me._resolveFunc(me),delete me._resolveFunc),(0,v.isFunc)(me._complete_handler)&&me._complete_handler(me),me._draw_nodes_again?me.startDrawGeometry():me._drawing_ready=!0,me))})()}isDrawingReady(){return this._drawing_ready||!1}removeDrawnNode(W){if(!this._draw_nodes)return;const me=[];for(let _e=0;_e<this._draw_nodes.length;++_e){const Be=this._draw_nodes[_e];Be.nodeid===W||this._clones.isIdInStack(W,Be.stack)?this._clones.createObject3D(Be.stack,this._toplevel,"delete_mesh"):me.push(Be)}me.length<this._draw_nodes.length&&(this._draw_nodes=me,this.render3D())}cleanup(W){if(!W){let me=0;if(!this.superimpose){if(this.clearTopPainter(),this._on_pad){const Be=this.getFramePainter();Be?.mode3d&&(Be.clear3dCanvas(),Be.mode3d=!1)}else me=this.clear3dCanvas();(0,w.G1)(this._scene)}this._toolbar?.cleanup(),(0,w.G1)(this._full_geom),this._controls?.cleanup(),this._context_menu&&this._renderer.domElement.removeEventListener("contextmenu",this._context_menu,!1),this._gui?.destroy(),this._worker?.terminate(),delete this._animating;const _e=this.getGeometry();if(_e&&this.ctrl.is_main&&(_e.$geo_painter===this?delete _e.$geo_painter:_e.fVolume?.$geo_painter===this&&delete _e.fVolume.$geo_painter),this._main_painter?._slave_painters){const Be=this._main_painter._slave_painters.indexOf(this);Be>=0&&this._main_painter._slave_painters.splice(Be,1)}for(let Be=0;Be<this._slave_painters?.length;++Be){const gt=this._slave_painters[Be];gt?._main_painter===this&&(gt._main_painter=null)}delete this.geo_manager,delete this._highlight_handlers,super.cleanup(),delete this.ctrl,delete this.options,this.did_cleanup=!0,me<0&&this.selectDom().html("")}if(this._slave_painters)for(const me in this._slave_painters){const _e=this._slave_painters[me];_e._main_painter=null,_e._clones===this._clones&&(_e._clones=null)}this._main_painter=null,this._slave_painters=[],this._render_resolveFuncs&&(this._render_resolveFuncs.forEach(me=>me(this)),delete this._render_resolveFuncs),this.superimpose||(0,w.yW)(this._renderer),this.ensureBloom(!1),delete this._effectComposer,delete this._scene,delete this._scene_size,this._scene_width=0,this._scene_height=0,this._renderer=null,this._toplevel=null,delete this._full_geom,delete this._fog,delete this._camera,delete this._camera0pos,delete this._lookat,delete this._selected_mesh,this._clones&&this._clones_owner&&this._clones.cleanup(this._draw_nodes,this._build_shapes),delete this._clones,delete this._clones_owner,delete this._draw_nodes,delete this._drawing_ready,delete this._build_shapes,delete this._new_draw_nodes,delete this._new_append_nodes,delete this._last_camera_position,this.first_render_tm=0,this.last_render_tm=0,this.changeStage(0,"cleanup"),delete this.drawing_log,delete this._gui,delete this._controls,delete this._context_menu,delete this._toolbar,delete this._worker}performResize(W,me){return!(this._scene_width===W&&this._scene_height===me||W<10||me<10||(this._scene_width=W,this._scene_height=me,this._camera&&this._renderer&&(this._camera.isPerspectiveCamera?this._camera.aspect=this._scene_width/this._scene_height:this._camera.isOrthographicCamera&&this.adjustCameraPosition(!0,!0),this._camera.updateProjectionMatrix(),this._renderer.setSize(this._scene_width,this._scene_height,!this._fit_main_area),this._effectComposer?.setSize(this._scene_width,this._scene_height),this._bloomComposer?.setSize(this._scene_width,this._scene_height),this.isStage(0)&&this.render3D()),0))}checkResize(W){const me=this.getCanvPainter();if(me&&!me.checkCanvasResize(W))return!1;const _e=this.getSizeFor3d();return this.performResize(_e.width,_e.height)}toggleEnlarge(){this.enlargeMain("toggle")&&this.checkResize()}accessObjectWireFrame(W,me){if(W?.material)return void 0!==me&&W.stack&&(W.material.wireframe=me),W.material.wireframe}changedWireFrame(){this._scene?.traverse(W=>this.accessObjectWireFrame(W,this.ctrl.wireframe)),this.render3D()}updateObject(W){if("same"===W||!W?._typename)return!1;if(W===this.getObject())return!0;let me;return W._typename===m&&(me=W,W=W.fMasterVolume),0===W._typename.indexOf(v.clTGeoVolume)&&(W={_typename:v.clTGeoNode,fVolume:W,fName:W.fName,$geoh:W.$geoh,_proxy:!0}),this.geo_manager&&me?(this.geo_manager=me,this.assignObject(W),this._did_update=!0,!0):!!this.matchObjectType(W._typename)&&(this.assignObject(W),this._did_update=!0,!0)}clearDrawings(){this._clones&&this._clones_owner&&this._clones.cleanup(this._draw_nodes,this._build_shapes),delete this._clones,delete this._clones_owner,delete this._draw_nodes,delete this._drawing_ready,delete this._build_shapes,delete this._extraObjects,delete this._clipCfg,(0,w.G1)(this._toplevel,!0),this._full_redrawing=!0}redraw(){if(this.superimpose){const _e=Xe(this.getMainPainter());_e&&(this._toplevel.scale.set(_e.scale_x??1,_e.scale_y??1,_e.scale_z??1),this._toplevel.position.set(_e.offset_x??0,_e.offset_y??0,_e.offset_z??0),this._toplevel.updateMatrix(),this._toplevel.updateMatrixWorld())}if(this._did_update)return this.startRedraw();const W=this._on_pad?this.getFramePainter():null;if(!W)return Promise.resolve(!1);const me=W.getSizeFor3d(W.access3dKind());return W.apply3dSize(me),this.performResize(me.width,me.height)}redrawObject(W,me){return!!this.updateObject(W,me)&&this.startRedraw()}startRedraw(W){if(W)return this._redraw_timer&&clearTimeout(this._redraw_timer),void(this._redraw_timer=setTimeout(()=>this.startRedraw(),W));delete this._redraw_timer,delete this._did_update,this.clearDrawings();const me=this.getGeometry();return this.prepareObjectDraw(me,this.geo_manager?me.fName:"")}static draw(W,me,_e){return(0,be.A)(function*(){if(!me)return null;let Be=null,gt=null,Et="",Mt=!1;if("fShapeBits"in me&&"fShapeId"in me?(Be=me,me=null):me._typename===R||me._typename===v.clTGeoVolume?Be=me.fShape:me._typename===I||me._typename===ge?(Be=me.fShape,Mt=!0):me._typename===m?Be=me.fMasterVolume.fShape:me._typename===A?(gt=me.fMarker,Et="<prnt>/Marker",me=function ve(wt){const W=(0,v.create)(v.clTGeoVolume);(0,X.bg)(W,X.Wv.kVisDaughters,!0),W.$geoh=!0,W.fName="";const me=(0,v.create)(v.clTGeoNodeMatrix);me.fName=wt.fVolume1.fName||"Overlap1",me.fMatrix=wt.fMatrix1,me.fVolume=wt.fVolume1;const _e=(0,v.create)(v.clTGeoNodeMatrix);return _e.fName=wt.fVolume2.fName||"Overlap2",_e.fMatrix=wt.fMatrix2,_e.fVolume=wt.fVolume2,W.fNodes=(0,v.create)(v.clTList),W.fNodes.Add(me),W.fNodes.Add(_e),W}(me),_e||(_e="wire")):"fVolume"in me?me.fVolume&&(Be=me.fVolume.fShape):me=null,(0,v.isStr)(_e)&&0===_e.indexOf("comp")&&Be&&Be._typename===X.HO&&Be.fNode){let Qt=1;"x"===(_e=_e.slice(4))[0]&&(Qt=999,_e=_e.slice(1)+"_vislvl999"),me=De(Be,Qt)}if(!me&&Be&&(me=Object.assign((0,v.create)(v.clTNamed),{_typename:I,fTrans:null,fShape:Be,fRGBA:[0,1,0,1],fElements:null,fRnrSelf:!0})),!me)return null;const Nt=Ln(W,me,_e);return Nt.ctrl.is_main&&!me.$geo_painter&&(me.$geo_painter=Nt),!Nt.ctrl.is_main&&Nt.ctrl.project&&me.$geo_painter&&(Nt._main_painter=me.$geo_painter,Nt._main_painter._slave_painters.push(Nt)),Mt&&(!Nt.ctrl.vislevel||Nt.ctrl.vislevel<9)&&(Nt.ctrl.vislevel=9),gt&&(Nt._splitColors=!0,Nt.addExtra(gt,Et)),Nt.loadMacro(Nt.ctrl.script_name).then(Qt=>Nt.prepareObjectDraw(Qt.obj,Qt.prefix))})()}}let gn=!1;function Cn(){function wt(W,me){return`.jsroot .img_${W} { display: inline-block; height: 16px; width: 16px; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQ${me}'); }`}!gn&&(0,v.isFunc)(v.internals.addDrawFunc)&&(gn=!0,v.internals.addDrawFunc({name:ee,icon_get:hi,icon_click:ui}),v.internals.addDrawFunc({name:k,icon_get:hi,icon_click:ui})),(0,xe.fz)(`\n${wt("geoarb8","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB1SURBVBjTdY6rEYAwEETTy6lzK8/Fo+Jj18dTAjUgaQGfGiggtRDE8RtY93Zu514If2nzk2ux9c5TZkwXbiWTUavzws69oBfpYBrMT4r0Jhsw+QfRgQSw+CaKRsKsnV+SaF8MN49RBSgPUxO85PMl5n4tfGUH2gghs2uPAeQAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geocombi","CAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAAlUlEQVQoz5VQMQ4CMQyzEUNnBqT7Bo+4nZUH8gj+welWJsQDkHoCEYakTXMHSFiq2jqu4xRAEl2A7w4myWzpzCSZRZ658ldKu1hPnFsequBIc/hcLli3l52MAIANtpWrDsv8waGTW6BPuFtsdZArXyFuj33TQpazGEQF38phipnLgItxRcAoOeNpzv4PTXnC42fb//AGI5YqfQAU8dkAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geocone","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACRSURBVBjTdY+xDcNACEVvEm/ggo6Olva37IB0C3iEzJABvAHFTXBDeJRwthMnUvylk44vPjxK+afeokX0flQhJO7L4pafSOMxzaxIKc/Tc7SIjNLyieyZSjBzc4DqMZI0HTMonWPBNlogOLeuewbg9c0hOiIqH7DKmTCuFykjHe4XOzQ58XVMGxzt575tKzd6AX9yMkcWyPlsAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geogtra","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACCSURBVBjTVc+hDQMxDAVQD1FyqCQk0MwsCwQEG3+eCW6B0FvheDboFMGepTlVitPP/Cz5y0S/mNkw8pySU9INJDDH4vM4Usm5OrQXasXtkA+tQF+zxfcDY8EVwgNeiwmA37TEccK5oLOwQtuCj7BM2Fq7iGrxVqJbSsH+GzXs+798AThwKMh3/6jDAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geomedium","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABVQTFRFAAAAAAAAMDAww8PDWKj/////gICAG0/C4AAAAAF0Uk5TAEDm2GYAAAABYktHRAX4b+nHAAAACXBIWXMAAABIAAAASABGyWs+AAAAXElEQVQI102MwRGAMAgEuQ6IDwvQCjQdhAl/H7ED038JHhkd3dcOLAgESFARaAqnEB3yrj6QSEym1RbbOKinN+8q2Esui1GaX7VXSi4RUbxHRbER8X6O5Pg/fLgBBzMN8HfXD3AAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geopara","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABtSURBVBjTY2DADq5MT7+CzD9kaKjp+QhJYIWqublhMbKAgpOnZxWSQJdsVJTndCSBKoWoAM/VSALpqlEBAYeQBKJAAsi2BGgCBZDdEWUYFZCOLFBlGOWJ7AyGFeaotjIccopageK3R12PGHABACTYHWd0tGw6AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("georotation","CAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAAiklEQVQoz2NgYGBgYGDg+A/BmIAFIvyDEbs0AwMTAwHACLPiB5QVBTdpGSOSCZjScDcgc4z+32BgYGBgEGIQw3QDLkdCTZD8/xJFeBfDVxQT/j9n/MeIrMCNIRBJwX8GRuzGM/yHKMAljeILNFOuMTyEisEUMKIqucrwB2oyIhyQpH8y/MZrLWkAAHFzIHIc0Q5yAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geotranslation","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABESURBVBjTY2DgYGAAYzjgAAIQgSLAgSwAAcrWUUCAJBAVhSpgBAQumALGCJPAAsriHIS0IAQ4UAU4cGphQBWwZSAOAADGJBKdZk/rHQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geotrd2","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABsSURBVBjTbY+xDcAwCARZx6UraiaAmpoRvIIb75PWI2QITxIiRQKk0CCO/xcA/NZ9LRs7RkJEYg3QxczUwoGsXiMAoe8lAelqRWFNKpiNXZLAalRDd0f3TMgeMckABKsCDmu+442RddeHz9cf9jUkW8smGn8AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geovolume","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAB5QTFRFAAAAMDAw///Ay8uc/7+Q/4BgmJh4gIDgAAD/////CZb2ugAAAAF0Uk5TAEDm2GYAAAABYktHRAnx2aXsAAAACXBIWXMAAABIAAAASABGyWs+AAAAR0lEQVQI12NggAEBIBAEQgYGQUYQAyIGIhgwAZMSGCgwMJuEKimFOhswsKWAGG4JDGxJIBk1EEO9o6NIDVkEpgauC24ODAAASQ8Pkj/retYAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geoassembly","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAA9QTFRFAAAAMDAw/wAAAAD/////jEo0BQAAAAF0Uk5TAEDm2GYAAAABYktHRASPaNlRAAAACXBIWXMAAABIAAAASABGyWs+AAAAOklEQVQI12NggAFGRgEgEBRgEBSAMhgYGQQEgAR+oARGDIwCIAYjUL0A2DQQg9nY2ABVBKoGrgsDAADxzgNboMz8zQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geocomposite","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABuSURBVBjTY2AgF2hqgQCCr+0V4O7hFmgCF7CJyKysKkmxhfGNLaw9SppqAi2gfMuY5Agrl+ZaC6iAUXRJZX6Ic0klTMA5urapPFY5NRcmYKFqWl8S5RobBRNg0PbNT3a1dDGH8RlM3LysTRjIBwAG6xrzJt11BAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geoctub","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACESURBVBjTdc+xDcMwDARA7cKKHTuWX37LHaw+vQbQAJomA7j2DB7FhCMFCZB8pxPwJEv5kQcZW+3HencRBekak4aaMQIi8YJdAQ1CMeE0UBkuaLMETklQ9Alhka0JzzXWqLVBuQYPpWcVuBbZjZafNRYcDk9o/b07bvhINz+/zxu1/M0FSRcmAk/HaIcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geohype","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACKSURBVBjTbU+rFQQhDKQSDDISEYuMREfHx6eHKMpYuf5qoIQt5bgDblfcuJk3nySEhSvceDV3c/ejT66lspopE9pXyIlkCrHMBACpu1DClekQAREi/loviCnF/NhRwJLaQ6hVhPjB8bOCsjlnNnNl0FWJVWxAqGzHONRHpu5Ml+nQ+8GzNW9n+Is3eg80Nk0iiwoAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geomixture","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAACFQTFRFAAAAAAAAKysrVVUA//8B//8AgICAqqpV398gv79A////VYJtlwAAAAF0Uk5TAEDm2GYAAAABYktHRApo0PRWAAAACXBIWXMAAABIAAAASABGyWs+AAAAXklEQVQI12NgwASCQsJCgoZAhoADq1tKIJAhEpDGxpYIZKgxsLElgBhibAkOCY4gKTaGkPRGIEPUIYEBrEaAIY0tDawmgYWNgREkkjCVjRWkWCUhLY0FJCIIBljsBgCZTAykgaRiRwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geopcon","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACJSURBVBjTdc+hGcQwCIZhhjl/rkgWiECj8XgGyAbZoD5LdIRMkEnKkV575n75Pp8AgLU54dmh6mauelyAL2Qzxfe2sklioq6FacFAcRFXYhwJHdU5rDD2hEYB/CmoJVRMiIJqgtENuoqA8ltAlYAqRH4d1tGkwzTqN2gA7Nv+fUwkgZ/3mg34txM+szzATJS1HQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geosphere","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACFSURBVBjTdY+xEcQwCAQp5QNFjpQ5vZACFBFTADFFfKYCXINzlUAJruXll2ekxDAEt9zcANFbXb2mqm56dxsymAH0yccAJaeNi0h5QGyfxGJmivMPjj0nmLsbRmyFCss3rlbpcUjfS8wLUNRcJyCF6uqg2IvYCnoKC7f1kSbA6riTz7evfwj3Ml+H3KBqAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geotrap","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB5SURBVBjTbY+hFYAwDETZB1OJi4yNPp0JqjtAZ2AELL5DdABmIS2PtLxHXH7u7l2W5W+uHMHpGiCHLYR1yw4SCZMIXBOJWVSjK7QDDAu4g8OBmAKK4sAEDdR3rw8YmcUcrEijKKhl7lN1IQPn9ExlgU6/WEyc75+5AYK0KY5oHBDfAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geotubeseg","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACBSURBVBjTdc+hEcQwDARA12P6QFBQ9LDwcXEVkA7SQTr4BlJBakgpsWdsh/wfux3NSCrlV86Mlrxmz1pBWq3bAHwETohxABVmDZADQp1BE+wDNnGywzHgmHDOreJNTDH3Xn3CVX0dpu2MHcIFBkYp/gKsQ8SCQ72V+36/+2aWf3kAQfgshnpXF0wAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geoxtru","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABcSURBVBjTY2AgEmhpeZV56vmWwQW00QUYwAJlSAI6XmVqukh8PT1bT03PchhXX09Pr9wQIQDiJ+ZowgWAXD3bck+QQDlCQTkDQgCoxA/ERBKwhbDglgA1lDMQDwCc/Rvq8nYsWgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geobbox","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB/SURBVBjTVc+hEYAwDAXQLlNRF1tVGxn9NRswQiSSCdgDyQBM0FlIIb2WuL77uf6E8E0N02wKYRwDciTKREVvB04GuZSyOMCABRB1WGzF3uDNQTvs/RcDtJXT4fSEXA5XoiQt0ttVSm8Co2psIOvoimjAOqBmFtH5wEP2373TPIvTK1nrpULXAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geoconeseg","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB4SURBVBjTdc6hEcAgDAXQbFNZXHQkFlkd/30myAIMwAws0gmYpVzvoFyv/S5P/B+izzQ387ZA2pkDnvsU1SQLVIFrOM4JFmEaYp2gCQbmPEGODhJ8jt7Am47hwgrzInGAifa/elUZnQLY00iU30BZAV+BWi2VfnIBv1osbHH8jX0AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${wt("geoeltu","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACGSURBVBjTdY+hFYUwDEU7xq9CIXC4uNjY6KczQXeoYgVMR2ABRmCGjvIp/6dgiEruueedvBDuOR57LQnKyc8CJmKO+N8bieIUPtmBWjIIx8XDBHYCipsnql1g2D0UP2OoDqwBncf+RdZmzFMHizRjog7KZYzawd4Ay93lEAPWR7WAvNbwMl/XwSxBV8qCjgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geomaterial","CAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAAbElEQVQoz62QMRbAIAhDP319Xon7j54qHSyCtaMZFCUkRjgDIdRU9yZUCfg8ut5aAHdcxtoNurmgA3ABNKIR9KimhSukPe2qxcCYC0pfFXx/aFWo7i42KKItOpopqvvnLzJmtlZTS7EfGAfwAM4EQbLIGV0sAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geoparab","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB/SURBVBjTbY+xDYAwDAQ9UAp3X7p0m9o9dUZgA9oMwAjpMwMzMAnYBAQSX9mn9+tN9KOtzsWsLOvYCziUGNX3nnCLJRzKPgeYrhPW7FJNLUB3YJazYKQKTnBaxgXRzNmJcrt7XCHQp9kEB1wfELEir/KGj4Foh8A+/zW1nf51AFabKZuWK+mNAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geopgon","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABwSURBVBjTY2AgDlwAAzh3sX1sPRDEeuwDc+8V2dsHgQQ8LCzq74HkLSzs7Yva2tLt7S3sN4MNiDUGKQmysCi6BzWkzcI+PdY+aDPCljZlj1iFOUjW1tvHLjYuQhJIt5/DcAFZYLH9YnSn7iPST9gAACbsJth21haFAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geotorus","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACGSURBVBjTjY+hFcMwDEQ9SkFggXGIoejhw+LiGkBDlHoAr+AhgjNL5byChuXeE7gvPelUyjOds/f5Zw0ggfj5KVCPMBWeyx+SbQ1XUriAC2XfpWWxjQQEZasRtRHiCUAj3qN4JaolUJppzh4q7dUTdHFXW/tH9OuswWm3nI7tc08+/eGLl758ey9KpKrNOQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("geotrd1","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB/SURBVBjTbc6xDQMhDAVQ9qH6lUtal65/zQ5IDMAMmYAZrmKGm4FJzlEQQUo+bvwkG4fwm9lbodV7w40Y4WGfSxQiXiJlQfZOjWRb8Ioi3tKuBQMCo7+9N72BzPsfAuoTdUP9QN8wgOQwvsfWmHzpeT5BKydMNW0nhJGvGf7mAc5WKO9e5N2dAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${wt("geotube","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACGSURBVBjTRc+tEcAwCAXgLFNbWeSzSDQazw5doWNUZIOM0BEyS/NHy10E30HyklKvWnJ+0le3sJoKn3X2z7GRuvG++YRyMMDt0IIKUXMzxbnugJi5m9K1gNnGBOUFElAWGMaKIKI4xoQggl00gT+A9hXWgDwnfqgsHRAx2m+8bfjfdyrx5AtsSjpwu+M2RgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${wt("evepoints","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABJQTFRF////n4mJcEdKRDMzcEdH////lLE/CwAAAAF0Uk5TAEDm2GYAAAABYktHRACIBR1IAAAACXBIWXMAAABIAAAASABGyWs+AAAAI0lEQVQI12NgIAowIpgKEJIZLiAgAKWZGQzQ9UGlWIizBQgAN4IAvGtVrTcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTYtMDktMDJUMTU6MDQ6MzgrMDI6MDDPyc7hAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE2LTA5LTAyVDE1OjA0OjM4KzAyOjAwvpR2XQAAAABJRU5ErkJggg==")}\n${wt("evetrack","CAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAAqElEQVQoz32RMQrCQBBFf4IgSMB0IpGkMpVHCFh7BbHIGTyVhU0K8QYewEKsbVJZaCUiPAsXV8Puzhaz7H8zs5+JUDjikLilQr5zpCRl5xMXZNScQE5gSMGaz70jjUAJcw5c3UBMTsUe+9Kzf065SbropeLXimWfDIgoab/tOyPGzOhz53+oSWcSGh7UdB2ZNKXBZdgAuUdEKJYmrEILyVgG6pE2tEHgDfe42rbjYzSHAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE2LTA5LTAyVDE1OjA0OjQ3KzAyOjAwM0S3EQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNi0wOS0wMlQxNTowNDo0NyswMjowMEIZD60AAAAASUVORK5CYII=")}\n.jsroot .geovis_this { background-color: lightgreen; }\n.jsroot .geovis_daughters { background-color: lightblue; }\n.jsroot .geovis_all { background-color: yellow; }`)}function Ln(wt,W,me){Cn(),(0,X.QL)("GradPerSegm",v.settings.GeoGradPerSegm),(0,X.QL)("CompressComp",v.settings.GeoCompressComp);const _e=new cn(wt,W);return _e.decodeOptions(me),_e}function Zn(wt,W,me){if(!W._geoobj)return!1;const _e=W._geoobj,Be=W._volume,gt=_e._typename===I||_e._typename===ge;if(!Be&&!gt)return!1;wt.add("separator");const Et=(dn,vn,Fn)=>{if(vn||(vn={visible:0,hidden:0}),Fn||(void 0!==vn.assign?dn.fRnrSelf=vn.assign:dn.fRnrSelf?vn.vis++:vn.hidden++),dn.fElements)for(let ai=0;ai<dn.fElements.arr.length;++ai)Et(dn.fElements.arr[ai],vn,!1);return vn},Mt=dn=>{"self"===dn?(_e.fRnrSelf=!_e.fRnrSelf,W._icon=W._icon.split(" ")[0]+We(_e),me.updateTreeNode(W)):(Et(_e,{assign:"true"===dn},!0),me.forEachItem(vn=>{vn._geoobj&&vn._icon&&(vn._icon=W._icon.split(" ")[0]+We(vn._geoobj),me.updateTreeNode(vn))},W)),tt(W,"testGeomChanges")},Nt=dn=>{(0,X.ZE)(Be,dn);const vn=W._icon.split(" ")[0]+We(Be);me.forEachItem(Fn=>{W._volume===Fn._volume&&(Fn._icon=vn,me.updateTreeNode(Fn))}),me.updateTreeNode(W),tt(W,"testGeomChanges")},Qt=tt(W),Zt=Qt?me.itemFullName(W,Qt):"";if(0===W._geoobj._typename.indexOf(v.clTGeoNode)&&Qt&&wt.add("Focus",()=>{Qt&&(0,v.isFunc)(Qt._painter?.focusOnItem)&&Qt._painter.focusOnItem(Zt)}),gt){wt.addchk(_e.fRnrSelf,"Visible","self",Mt);const dn=Et(_e,void 0,!0);dn.hidden+dn.visible>0&&wt.addchk(0===dn.hidden,"Daughters",0!==dn.hidden?"true":"false",Mt)}else{const dn=Qt?._painter?._clones?.findStackByName(Zt),vn=dn?Qt._painter._clones.getPhysNodeVisibility(dn):null,Fn=(0,X.zL)(Be,X.Wv.kVisThis);if(wt.addchk((0,X.zL)(Be,X.Wv.kVisNone),"Invisible",X.Wv.kVisNone,Nt),dn){const ai=$n=>{Qt._painter._clones.setPhysNodeVisibility(dn,"off"!==$n&&$n),tt(W,"testGeomChanges")};wt.add("sub:Physical vis","Physical node visibility - only for this instance"),wt.addchk(vn?.visible,"on","on",ai,"Enable visibility of phys node"),wt.addchk(vn&&!vn.visible,"off","off",ai,"Disable visibility of physical node"),wt.add("reset","clear",ai,"Reset custom visibility of physical node"),wt.add("reset all","clearall",ai,"Reset all custom settings for all nodes"),wt.add("endsub:")}wt.addchk(Fn,"Logical vis",X.Wv.kVisThis,Nt,"Logical node visibility - all instances"),wt.addchk((0,X.zL)(Be,X.Wv.kVisDaughters),"Daughters",X.Wv.kVisDaughters,Nt,"Logical node daugthers visibility")}return!0}function ui(wt,W){return wt._volume?((0,X.ZE)(wt._volume,wt._more&&wt._volume.fNodes?.arr?.length?X.Wv.kVisDaughters:X.Wv.kVisThis),Ne(wt._volume,W),tt(wt,"testGeomChanges"),!1):!wt._geoobj||wt._geoobj._typename!==I&&wt._geoobj._typename!==ge?void 0!==tt(wt)?._painter?.extraObjectVisible(W,wt,!0):(wt._geoobj.fRnrSelf=!wt._geoobj.fRnrSelf,Ne(wt._geoobj,W),tt(wt,"testGeomChanges"),!1)}function hi(wt,W){let me="";switch(wt._kind){case v.prROOT+k:me="img_evetrack";break;case v.prROOT+ee:case v.prROOT+v.clTPolyMarker3D:me="img_evepoints"}return me&&tt(wt)?._painter?.extraObjectVisible(W,wt)&&(me+=" geovis_this"),me}function qi(wt,W,me){const _e={_kind:v.prROOT+W._typename,_name:me||(0,X.Hs)(W),_title:W.fTitle,_parent:wt,_geoobj:W,_get:Nt=>(Nt._geoobj&&(Nt._geoobj.$geoh=!0),Promise.resolve(Nt._geoobj))};let Be,gt,Et,Mt=!1;return"TGeoMaterial"===W._typename?_e._icon="img_geomaterial":"TGeoMedium"===W._typename?_e._icon="img_geomedium":"TGeoMixture"===W._typename?_e._icon="img_geomixture":0===W._typename.indexOf(v.clTGeoNode)&&W.fVolume?(_e._title="node:"+W._typename,W.fTitle&&(_e._title+=" "+W.fTitle),Be=W.fVolume):0===W._typename.indexOf(v.clTGeoVolume)?Be=W:W._typename===I||W._typename===ge?(Mt=!0,gt=W.fShape,Et=W.fElements?W.fElements.arr:null):void 0!==W.fShapeBits&&void 0!==W.fShapeId&&(gt=W),Be&&(gt=Be.fShape,Et=Be.fNodes?Be.fNodes.arr:null),(Be||gt||Et)&&(Be&&(_e._volume=Be),Et?(_e._more=!0,_e._expand=$):gt&&gt._typename===X.HO&&gt.fNode&&(_e._more=!0,_e._shape=gt,_e._expand=function(Nt){return qi(Nt,Nt._shape.fNode.fLeft,"Left"),qi(Nt,Nt._shape.fNode.fRight,"Right"),!0}),!_e._title&&W._typename!==v.clTGeoVolume&&(_e._title=W._typename),gt?(""===_e._title&&(_e._title=gt._typename),_e._icon=(0,X.fD)(gt)):_e._icon=_e._more?"img_geocombi":"img_geobbox",Be?_e._icon+=We(Be):Mt&&(_e._icon+=We(W)),_e._menu=Zn,_e._icon_click=ui),wt._childs||(wt._childs=[]),_e._name||((0,v.isStr)(wt._name)?(_e._name=wt._name,_e._name.lastIndexOf("s")===_e._name.length-1&&(_e._name=_e._name.slice(0,_e._name.length-1)),_e._name+="_"+wt._childs.length):_e._name="item_"+wt._childs.length),wt._childs.push(_e),_e}function Mr(wt){return Sr.apply(this,arguments)}function Sr(){return(Sr=(0,be.A)(function*(wt){const W=(0,v.create)(v.clTNamed);W._typename=X.Ce,W.fDX=1e-10,W.fDY=1e-10,W.fDZ=1e-10,W.fShapeId=1,W.fShapeBits=0,W.fOrigin=[0,0,0];const me=Object.assign((0,v.create)(v.clTNamed),{_typename:I,fTrans:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],fShape:W,fRGBA:[0,0,0,0],fElements:null,fRnrSelf:!1}),_e=wt.getPadPainter(),Be=_e?.pad?.fFillColor&&_e?.pad?.fFillStyle>1e3?"bkgr_"+_e.pad.fFillColor:"";return cn.draw(wt.getDom(),me,Be).then(gt=>(gt._dummy=!0,gt))})).apply(this,arguments)}function ms(){const wt=this.getMainPainter();if((0,v.isFunc)(wt?.setAxesDraw))return wt.setAxesDraw(!0);console.error("no geometry painter found to toggle TAxis3D drawing")}function fs(wt,W){if(!wt)return null;W||(W={}),W.numfaces||(W.numfaces=1e5),W.numnodes||(W.numnodes=1e3),W.frustum||(W.frustum=null),W.res_mesh=W.res_faces=0,void 0===W.instancing&&(W.instancing=-1),W.info={num_meshes:0,num_faces:0};let me=null,_e=null;if(wt.visibles&&wt.nodes&&wt.numnodes){const Mt=wt.numnodes>1e6?{length:wt.numnodes}:new Array(wt.numnodes);wt.nodes.forEach(Qt=>{Mt[Qt.id]=X.De.formatServerElement(Qt)}),me=new X.De(null,Mt),me.name_prefix=me.getNodeName(0),me.maxdepth=20;const Nt=wt.cfg?.nsegm||30;for(let Qt=0;Qt<wt.visibles.length;++Qt){const Zt=wt.visibles[Qt],dn=Zt.ri;dn&&(Zt.server_shape=dn.server_shape=(0,X.uz)(dn,Nt))}_e=wt.visibles}else{let Mt=null,Nt=!1;if("fShapeBits"in wt&&"fShapeId"in wt?(Mt=wt,wt=null):wt._typename===R||wt._typename===v.clTGeoVolume||wt._typename===I||wt._typename===ge?Mt=wt.fShape:wt._typename===m?(Nt=!W.showtop,Mt=(wt=wt.fMasterVolume).fShape):wt.fVolume?Mt=wt.fVolume.fShape:wt=null,W.composite&&Mt&&Mt._typename===X.HO&&Mt.fNode&&(wt=De(Mt)),!wt&&Mt&&(wt=Object.assign((0,v.create)(v.clTNamed),{_typename:I,fTrans:null,fShape:Mt,fRGBA:[0,1,0,1],fElements:null,fRnrSelf:!0})),!wt)return null;0===wt._typename.indexOf(v.clTGeoVolume)&&(wt={_typename:v.clTGeoNode,fVolume:wt,fName:wt.fName,$geoh:wt.$geoh,_proxy:!0}),me=new X.De(wt),me.setVisLevel(W.vislevel),me.setMaxVisNodes(W.numnodes),W.dflt_colors&&me.setDefaultColors(!0),(W.no_screen?0:me.markVisibles(!0))<=0?me.markVisibles(!1,!1,Nt):me.markVisibles(!0,!0,Nt),me.produceIdShifts(),_e=me.collectVisibles(W.numfaces,W.frustum).lst}W.material_kind||(W.material_kind="lambert"),void 0===W.set_names&&(W.set_names=!0),me.setConfig(W);const Be=me.collectShapes(_e);me.buildShapes(Be,W.numfaces);const gt=new V.B69;gt.clones=me;const Et=(0,b.HG)();if(me.createInstancedMeshes(W,gt,_e,Be,Et))return gt;for(let Mt=0;Mt<_e.length;++Mt){const Nt=_e[Mt];if(Nt.done)continue;const Qt=Nt.server_shape||Be[Nt.shapeid];if(!Qt.ready){console.warn("shape marked as not ready when it should");break}me.createEntryMesh(W,gt,Nt,Qt,Et)}return gt}},5320:(Gr,xt,Te)=>{"use strict";Te.d(xt,{De:()=>Fn,$T:()=>pt,Ce:()=>K,HO:()=>ge,qU:()=>Rn,Wz:()=>wt,_b:()=>Fe,P1:()=>Qt,Cc:()=>Zt,d4:()=>Nt,uz:()=>Et,Wv:()=>ce,QL:()=>re,UX:()=>kn,Dh:()=>Ne,Hs:()=>ht,fD:()=>Yi,xq:()=>vn,NN:()=>de,k$:()=>fe,Pz:()=>ei,qr:()=>me,V:()=>Mt,bg:()=>Xe,N_:()=>$,zL:()=>De,ZE:()=>ct});var be=Te(5225),v=Te(4186);const V=1e-5;class Ke{constructor(Y,E,J,Ae,Ce,He){this.x=Y,this.y=E,this.z=J,this.nx=Ae,this.ny=Ce,this.nz=He}setnormal(Y,E,J){this.nx=Y,this.ny=E,this.nz=J}clone(){return new Ke(this.x,this.y,this.z,this.nx,this.ny,this.nz)}add(Y){return this.x+=Y.x,this.y+=Y.y,this.z+=Y.z,this}subtract(Y){return this.x-=Y.x,this.y-=Y.y,this.z-=Y.z,this}cross3(Y,E,J){const Ae=this.x,Ce=this.y,He=this.z;return this.x=Ce*J-He*E,this.y=He*Y-Ae*J,this.z=Ae*E-Ce*Y,this}normalize(){const Y=Math.sqrt(this.x**2+this.y**2+this.z**2);return this.x/=Y,this.y/=Y,this.z/=Y,this}dot(Y){return this.x*Y.x+this.y*Y.y+this.z*Y.z}diff(Y){const Ce=this.x**2+this.y**2+this.z**2;return((this.x-Y.x)**2+(this.y-Y.y)**2+(this.z-Y.z)**2)/(Ce>0?Ce:1e-10)}interpolate(Y,E){const J=1-E;return new Ke(this.x*J+Y.x*E,this.y*J+Y.y*E,this.z*J+Y.z*E,this.nx*J+Y.nx*E,this.ny*J+Y.ny*E,this.nz*J+Y.nz*E)}applyMatrix4(Y){let E=this.x,J=this.y,Ae=this.z;const Ce=Y.elements;return this.x=Ce[0]*E+Ce[4]*J+Ce[8]*Ae+Ce[12],this.y=Ce[1]*E+Ce[5]*J+Ce[9]*Ae+Ce[13],this.z=Ce[2]*E+Ce[6]*J+Ce[10]*Ae+Ce[14],E=this.nx,J=this.ny,Ae=this.nz,this.nx=Ce[0]*E+Ce[4]*J+Ce[8]*Ae,this.ny=Ce[1]*E+Ce[5]*J+Ce[9]*Ae,this.nz=Ce[2]*E+Ce[6]*J+Ce[10]*Ae,this}}class ot{constructor(Y,E,J){this.vertices=Y||[],this.nsign=1,E?this.copyProperties(E,J):this.vertices.length>0&&this.calculateProperties()}copyProperties(Y,E){return this.normal=Y.normal,this.w=Y.w,this.nsign=Y.nsign,E&&void 0!==Y.id&&(this.id=Y.id,this.parent=Y),this}calculateProperties(Y){if(this.normal&&!Y)return;const E=this.vertices[0],J=this.vertices[1],Ae=this.vertices[2];return this.nsign=1,this.normal=new Ke(J.x-E.x,J.y-E.y,J.z-E.z,0,0,0).cross3(Ae.x-E.x,Ae.y-E.y,Ae.z-E.z).normalize(),this.w=this.normal.dot(E),this}clone(){const Y=this.vertices.length,E=[];for(let J=0;J<Y;++J)E.push(this.vertices[J].clone());return new ot(E,this)}flip(){return this.nsign*=-1,this.vertices.reverse(),this}classifyVertex(Y){const E=this.nsign*(this.normal.dot(Y)-this.w);return E<-V?2:E>V?1:0}classifySide(Y){let E=0,J=0;const Ae=Y.vertices.length;for(let Ce=0;Ce<Ae;++Ce){const He=this.classifyVertex(Y.vertices[Ce]);1===He?++E:2===He&&++J}return E>0&&0===J?1:0===E&&J>0?2:0===E&&0===J?0:3}splitPolygon(Y,E,J,Ae,Ce){const He=this.classifySide(Y);if(0===He)(this.nsign*Y.nsign*this.normal.dot(Y.normal)>0?E:J).push(Y);else if(1===He)Ae.push(Y);else if(2===He)Ce.push(Y);else{const nt=Y.vertices.length,it=this.normal.x,lt=this.normal.y,qt=this.normal.z,at=[],Jt=[];let tn,An,ze,$e,ut,bt,Ot,_n;for(tn=0;tn<nt;++tn)An=(tn+1)%nt,ut=Y.vertices[tn],bt=Y.vertices[An],ze=this.classifyVertex(ut),$e=this.classifyVertex(bt),2!==ze&&at.push(ut),1!==ze&&Jt.push(ut),3==(ze|$e)&&(Ot=(this.w-(it*ut.x+lt*ut.y+qt*ut.z))/(it*(bt.x-ut.x)+lt*(bt.y-ut.y)+qt*(bt.z-ut.z)),_n=ut.interpolate(bt,Ot),at.push(_n),Jt.push(_n));at.length>=3&&Ae.push(new ot(at,Y,!0)),Jt.length>=3&&Ce.push(new ot(Jt,Y,!0))}}}class Re{constructor(Y,E){if(this.polygons=[],this.front=this.back=void 0,!Y)return;this.divider=Y[0].clone();const J=Y.length,Ae=[],Ce=[];for(let He=0;He<J;++He)void 0!==E&&(Y[He].id=E++,delete Y[He].parent),0===He?this.polygons.push(Y[0]):this.divider.splitPolygon(Y[He],this.polygons,this.polygons,Ae,Ce);void 0!==E&&(this.maxnodeid=E),Ae.length>0&&(this.front=new Re(Ae)),Ce.length>0&&(this.back=new Re(Ce))}build(Y){const E=Y.length,J=[],Ae=[];let Ce=0;this.divider||(this.divider=Y[0].clone(),this.polygons.push(Y[0]),Ce=1);for(let He=Ce;He<E;++He)this.divider.splitPolygon(Y[He],this.polygons,this.polygons,J,Ae);J.length>0&&(this.front||(this.front=new Re),this.front.build(J)),Ae.length>0&&(this.back||(this.back=new Re),this.back.build(Ae))}collectPolygons(Y){void 0===Y&&(Y=[]);const E=this.polygons.length;for(let J=0;J<E;++J)Y.push(this.polygons[J]);return this.front?.collectPolygons(Y),this.back?.collectPolygons(Y),Y}numPolygons(){return this.polygons.length+(this.front?.numPolygons()||0)+(this.back?.numPolygons()||0)}clone(){const Y=new Re;return Y.divider=this.divider?.clone(),Y.polygons=this.polygons.map(E=>E.clone()),Y.front=this.front?.clone(),Y.back=this.back?.clone(),Y}invert(){const Y=this.polygons.length;for(let J=0;J<Y;++J)this.polygons[J].flip();this.divider.flip(),this.front&&this.front.invert(),this.back&&this.back.invert();const E=this.front;return this.front=this.back,this.back=E,this}clipPolygons(Y){if(!this.divider)return Y.slice();const E=Y.length;let J=[],Ae=[];for(let Ce=0;Ce<E;++Ce)this.divider.splitPolygon(Y[Ce],J,Ae,J,Ae);return this.front&&(J=this.front.clipPolygons(J)),Ae=this.back?this.back.clipPolygons(Ae):[],J.concat(Ae)}clipTo(Y){this.polygons=Y.clipPolygons(this.polygons),this.front&&this.front.clipTo(Y),this.back&&this.back.clipTo(Y)}}function Qe(Ue){const Y=Ue.length;let E,J,Ae=0;for(E=0;E<Y;++E)Ae+=9*(Ue[E].vertices.length-2);const Ce=new Float32Array(Ae),He=new Float32Array(Ae);let it,nt=0;function lt(at){Ce[nt]=at.x,Ce[nt+1]=at.y,Ce[nt+2]=at.z,He[nt]=it.nsign*at.nx,He[nt+1]=it.nsign*at.ny,He[nt+2]=it.nsign*at.nz,nt+=3}for(E=0;E<Y;++E)for(it=Ue[E],J=2;J<it.vertices.length;++J)lt(it.vertices[0]),lt(it.vertices[J-1]),lt(it.vertices[J]);const qt=new be.LoY;return qt.setAttribute("position",new be.THS(Ce,3)),qt.setAttribute("normal",new be.THS(He,3)),qt}class Ie{constructor(Y,E,J,Ae){if(!(Y instanceof be.eaF)){if(Y instanceof Re)return this.tree=Y,this.matrix=null,this;if(Y instanceof be.LoY){const Jt=Y.getAttribute("position").array,tn=Y.getAttribute("normal").array,An=[];let ze,$e,ut,bt;for(let Ot=0;Ot<Jt.length;Ot+=9)ze=new ot,$e=new Ke(Jt[Ot],Jt[Ot+1],Jt[Ot+2],tn[Ot],tn[Ot+1],tn[Ot+2]),E&&$e.applyMatrix4(E),ut=new Ke(Jt[Ot+3],Jt[Ot+4],Jt[Ot+5],tn[Ot+3],tn[Ot+4],tn[Ot+5]),E&&ut.applyMatrix4(E),bt=new Ke(Jt[Ot+6],Jt[Ot+7],Jt[Ot+8],tn[Ot+6],tn[Ot+7],tn[Ot+8]),E&&bt.applyMatrix4(E),Ae?ze.vertices.push($e,bt,ut):ze.vertices.push($e,ut,bt),ze.calculateProperties(!0),An.push(ze);return this.tree=new Re(An,J),void 0!==J&&(this.maxid=this.tree.maxnodeid),this}if(Y.polygons&&Y.polygons[0]instanceof ot){const Jt=Y.polygons;for(let tn=0;tn<Jt.length;++tn){const An=Jt[tn];if(E){const ze=[];for(let $e=0;$e<An.vertices.length;++$e)ze.push(An.vertices[$e].clone().applyMatrix4(E));An.vertices=ze}An.calculateProperties(E)}return this.tree=new Re(Jt,J),void 0!==J&&(this.maxid=this.tree.maxnodeid),this}throw Error("ThreeBSP: Given geometry is unsupported")}Y.updateMatrix(),E=this.matrix=Y.matrix.clone();const Ce=[],He=(Y=Y.geometry).faces.length;let nt,it,lt,qt,at;for(let Jt=0;Jt<He;++Jt)nt=Y.faces[Jt],qt=nt.normal,it=new ot,at=nt.vertexNormals&&3===nt.vertexNormals.length,lt=Y.vertices[nt.a],at&&(qt=nt.vertexNormals[0]),lt=new Ke(lt.x,lt.y,lt.z,qt.x,qt.y,qt.z),E&&lt.applyMatrix4(E),it.vertices.push(lt),lt=Y.vertices[nt.b],at&&(qt=nt.vertexNormals[1]),lt=new Ke(lt.x,lt.y,lt.z,qt.x,qt.y,qt.z),E&&lt.applyMatrix4(E),it.vertices.push(lt),lt=Y.vertices[nt.c],at&&(qt=nt.vertexNormals[2]),lt=new Ke(lt.x,lt.y,lt.z,qt.x,qt.y,qt.z),E&&lt.applyMatrix4(E),it.vertices.push(lt),it.calculateProperties(!0),Ce.push(it);this.tree=new Re(Ce,J),void 0!==J&&(this.maxid=this.tree.maxnodeid)}subtract(Y){let E=this.tree.clone();const J=Y.tree.clone();return E.invert(),E.clipTo(J),J.clipTo(E),J.invert(),J.clipTo(E),J.invert(),E.build(J.collectPolygons()),E.invert(),E=new Ie(E),E.matrix=this.matrix,E}union(Y){let E=this.tree.clone();const J=Y.tree.clone();return E.clipTo(J),J.clipTo(E),J.invert(),J.clipTo(E),J.invert(),E.build(J.collectPolygons()),E=new Ie(E),E.matrix=this.matrix,E}intersect(Y){let E=this.tree.clone();const J=Y.tree.clone();return E.invert(),J.clipTo(E),J.invert(),E.clipTo(J),J.clipTo(E),E.build(J.collectPolygons()),E.invert(),E=new Ie(E),E.matrix=this.matrix,E}tryToCompress(Y){if(void 0===this.maxid)return;const E=[];let J,Ae,He,it,lt,qt,at,Jt,Ce=0,nt=Y.length;for(He=0;He<nt;++He)it=Y[He],void 0!==it.id&&(void 0===E[it.id]&&(E[it.id]=[]),E[it.id].push(it));for(He=0;He<E.length;++He)if(J=E[He],void 0!==J)for(nt=J.length,Ae=nt>1;Ae;)for(Ae=!1,at=0;at<nt-1;++at)if(lt=J[at],lt?.parent)for(Jt=at+1;Jt<nt;++Jt)if(qt=J[Jt],qt&&lt.parent===qt.parent&&lt.nsign===qt.nsign){lt.nsign!==lt.parent.nsign&&lt.parent.flip(),Ce++,J[at]=lt.parent,J[Jt]=null,lt.parent.vertices.length<3&&console.log("something wrong with parent"),Ae=!0;break}if(Ce>0)for(Y.splice(0,Y.length),He=0;He<E.length;++He)if(J=E[He],void 0!==J)for(at=0,nt=J.length;at<nt;++at)J[at]&&Y.push(J[at])}direct_subtract(Y){const E=this.tree,J=Y.tree;return E.invert(),E.clipTo(J),J.clipTo(E),J.invert(),J.clipTo(E),J.invert(),E.build(J.collectPolygons()),E.invert(),this}direct_union(Y){const E=this.tree,J=Y.tree;return E.clipTo(J),J.clipTo(E),J.invert(),J.clipTo(E),J.invert(),E.build(J.collectPolygons()),this}direct_intersect(Y){const E=this.tree,J=Y.tree;return E.invert(),J.clipTo(E),J.invert(),E.clipTo(J),J.clipTo(E),E.build(J.collectPolygons()),E.invert(),this}cut_from_plane(Y){const E=this.tree,J=Y.tree;return E.invert(),J.clipTo(E),this}scale(Y,E,J){const Ae=this.tree.collectPolygons();for(let Ce=0;Ce<Ae.length;++Ce){const He=Ae[Ce];for(let nt=0;nt<He.vertices.length;++nt){const it=He.vertices[nt];it.x*=Y,it.y*=E,it.z*=J}He.calculateProperties(!0)}}toPolygons(){const Y=this.tree.collectPolygons();this.tryToCompress(Y);for(let E=0;E<Y.length;++E)delete Y[E].id,delete Y[E].parent;return Y}toBufferGeometry(){return Qe(this.toPolygons())}toMesh(Y){const E=this.toBufferGeometry(),J=new be.eaF(E,Y);return this.matrix&&(J.position.setFromMatrixPosition(this.matrix),J.rotation.setFromRotationMatrix(this.matrix)),J}}const he={GradPerSegm:6,CompressComp:!0};function re(Ue,Y){if(void 0===Y)return he[Ue];he[Ue]=Y}const fe=0,de=1,ce={kVisOverride:(0,v.BIT)(0),kVisNone:(0,v.BIT)(1),kVisThis:(0,v.BIT)(2),kVisDaughters:(0,v.BIT)(3),kVisOneLevel:(0,v.BIT)(4),kVisStreamed:(0,v.BIT)(5),kVisTouched:(0,v.BIT)(6),kVisOnScreen:(0,v.BIT)(7),kVisContainers:(0,v.BIT)(12),kVisOnly:(0,v.BIT)(13),kVisBranch:(0,v.BIT)(14),kVisRaytrace:(0,v.BIT)(15)},K="TGeoBBox",G="TGeoArb8",D="TGeoCone",x="TGeoConeSeg",P="TGeoTube",w="TGeoTubeSeg",b="TGeoCtub",g="TGeoTrd1",C="TGeoTrd2",N="TGeoPara",O="TGeoParaboloid",H="TGeoPcon",X="TGeoPgon",ie="TGeoShapeAssembly",z="TGeoSphere",m="TGeoTorus",I="TGeoXtru",A="TGeoTrap",R="TGeoGtra",k="TGeoEltu",ee="TGeoHype",ge="TGeoCompositeShape",ve="TGeoHalfSpace",Se="TGeoScaledShape";function De(Ue,Y){const E=Ue.fGeoAtt;return void 0!==E&&!!(E&Y)}function Xe(Ue,Y,E){void 0!==Ue.fGeoAtt&&(Ue.fGeoAtt=E?Ue.fGeoAtt|Y:Ue.fGeoAtt&~Y)}function ct(Ue,Y){void 0!==Ue.fGeoAtt&&(Ue.fGeoAtt=Ue.fGeoAtt^16777215&Y)}function $(Ue,Y){if(void 0===Y&&(Y=!0),Xe(Ue,ce.kVisThis,!Y),Ue.fNodes)for(let E=0;E<Ue.fNodes.arr.length;++E)Xe(Ue.fNodes.arr[E].fVolume,ce.kVisThis,!Y)}const tt={};function We(Ue){void 0===tt[Ue]&&(tt[Ue]=!0,console.warn(Ue))}function Ne(Ue){return(0,v.isObject)(Ue)?"fShape"in Ue&&"fTrans"in Ue?de:fe:-1}function Fe(Ue){return Ue?Ue._typename!==ge?1:Fe(Ue.fNode.fLeft)+Fe(Ue.fNode.fRight):0}function ht(Ue){return Ue?.fName?Ue.fName+(Ue.$geo_suffix||""):""}function pt(Ue,Y){if(Ue){if(Ue.$geo_checked)return;Ue.$geo_checked=!0}const E=[],J=[];for(let Ae=0;Ae<Y.length;++Ae){const Ce=Y[Ae];if(Ce?.fName){if(!Ce.$geo_suffix){const He=E.indexOf(Ce.fName);if(He>=0){let nt=J[He]||1;for(;E.indexOf(Ce.fName+"#"+nt)>=0;)++nt;Ce.$geo_suffix="#"+nt,J[He]=nt+1}}E.push(ht(Ce))}}}function dt(Ue,Y,E,J,Ae,Ce,He,nt,it){const lt=new be.Pq0(Ue,Y,E),qt=new be.Pq0(J,Ae,Ce),at=new be.Pq0(He,nt,it),Jt=new be.Pq0,tn=new be.Pq0;return Jt.subVectors(at,qt),tn.subVectors(lt,qt),Jt.cross(tn),Jt}class rt{constructor(Y){this.nfaces=Y,this.indx=0,this.pos=new Float32Array(9*Y),this.norm=new Float32Array(9*Y)}addFace3(Y,E,J,Ae,Ce,He,nt,it,lt){const qt=this.indx,at=this.pos;at[qt]=Y,at[qt+1]=E,at[qt+2]=J,at[qt+3]=Ae,at[qt+4]=Ce,at[qt+5]=He,at[qt+6]=nt,at[qt+7]=it,at[qt+8]=lt,this.last4=!1,this.indx=qt+9}startPolygon(){}stopPolygon(){}addFace4(Y,E,J,Ae,Ce,He,nt,it,lt,qt,at,Jt,tn){let An=this.indx;const ze=this.pos;1!==tn&&(ze[An]=Y,ze[An+1]=E,ze[An+2]=J,ze[An+3]=Ae,ze[An+4]=Ce,ze[An+5]=He,ze[An+6]=nt,ze[An+7]=it,ze[An+8]=lt,An+=9),2!==tn&&(ze[An]=Y,ze[An+1]=E,ze[An+2]=J,ze[An+3]=nt,ze[An+4]=it,ze[An+5]=lt,ze[An+6]=qt,ze[An+7]=at,ze[An+8]=Jt,An+=9),this.last4=An!==this.indx+9,this.indx=An}setNormal4(Y,E,J,Ae,Ce,He,nt,it,lt,qt,at,Jt,tn){if(this.last4&&tn)return console.error("missmatch between addFace4 and setNormal4 calls");let An=this.indx-(this.last4?18:9);const ze=this.norm;1!==tn&&(ze[An]=Y,ze[An+1]=E,ze[An+2]=J,ze[An+3]=Ae,ze[An+4]=Ce,ze[An+5]=He,ze[An+6]=nt,ze[An+7]=it,ze[An+8]=lt,An+=9),2!==tn&&(ze[An]=Y,ze[An+1]=E,ze[An+2]=J,ze[An+3]=nt,ze[An+4]=it,ze[An+5]=lt,ze[An+6]=qt,ze[An+7]=at,ze[An+8]=Jt)}recalcZ(Y){const E=this.pos,J=this.indx;let Ae=J-(this.last4?18:9);for(;Ae<J;)E[Ae+2]=Y(E[Ae],E[Ae+1],E[Ae+2]),Ae+=3}calcNormal(){this.cb||(this.pA=new be.Pq0,this.pB=new be.Pq0,this.pC=new be.Pq0,this.cb=new be.Pq0,this.ab=new be.Pq0),this.pA.fromArray(this.pos,this.indx-9),this.pB.fromArray(this.pos,this.indx-6),this.pC.fromArray(this.pos,this.indx-3),this.cb.subVectors(this.pC,this.pB),this.ab.subVectors(this.pA,this.pB),this.cb.cross(this.ab),this.setNormal(this.cb.x,this.cb.y,this.cb.z)}setNormal(Y,E,J){let Ae=this.indx-9;const Ce=this.norm;Ce[Ae]=Ce[Ae+3]=Ce[Ae+6]=Y,Ce[Ae+1]=Ce[Ae+4]=Ce[Ae+7]=E,Ce[Ae+2]=Ce[Ae+5]=Ce[Ae+8]=J,this.last4&&(Ae-=9,Ce[Ae]=Ce[Ae+3]=Ce[Ae+6]=Y,Ce[Ae+1]=Ce[Ae+4]=Ce[Ae+7]=E,Ce[Ae+2]=Ce[Ae+5]=Ce[Ae+8]=J)}setNormal_12_34(Y,E,J,Ae,Ce,He,nt){void 0===nt&&(nt=0);let it=this.indx-(nt>0?9:18);const lt=this.norm;1!==nt&&(lt[it]=Y,lt[it+1]=E,lt[it+2]=J,lt[it+3]=Y,lt[it+4]=E,lt[it+5]=J,lt[it+6]=Ae,lt[it+7]=Ce,lt[it+8]=He,it+=9),2!==nt&&(lt[it]=Y,lt[it+1]=E,lt[it+2]=J,lt[it+3]=Ae,lt[it+4]=Ce,lt[it+5]=He,lt[it+6]=Ae,lt[it+7]=Ce,lt[it+8]=He)}create(){this.nfaces!==this.indx/9&&console.error(`Mismatch with created ${this.nfaces} and filled ${this.indx/9} number of faces`);const Y=new be.LoY;return Y.setAttribute("position",new be.THS(this.pos,3)),Y.setAttribute("normal",new be.THS(this.norm,3)),Y}}class _t{constructor(){this.polygons=[]}startPolygon(Y){this.multi=1,this.mnormal=Y}stopPolygon(){this.multi&&(this.multi=0,console.error("Polygon should be already closed at this moment"))}addFace3(Y,E,J,Ae,Ce,He,nt,it,lt){this.addFace4(Y,E,J,Ae,Ce,He,nt,it,lt,nt,it,lt,2)}addFace4(Y,E,J,Ae,Ce,He,nt,it,lt,qt,at,Jt,tn){if(void 0===tn&&(tn=0),this.v1=new Ke(Y,E,J,0,0,0),this.v2=1===tn?null:new Ke(Ae,Ce,He,0,0,0),this.v3=new Ke(nt,it,lt,0,0,0),this.v4=2===tn?null:new Ke(qt,at,Jt,0,0,0),this.reduce=tn,this.multi){let ze;return 2!==tn&&console.error("polygon not supported for not-reduced faces"),1==this.multi++?(ze=new ot,ze.vertices.push(this.mnormal?this.v2:this.v3),this.polygons.push(ze)):(ze=this.polygons[this.polygons.length-1],(this.mnormal?this.v2:this.v3).diff(this.mnormal?ze.vertices[ze.vertices.length-1]:ze.vertices[0])>1e-12&&console.error("vertex missmatch when building polygon")),void((this.mnormal?this.v3:this.v2).diff(this.mnormal?ze.vertices[0]:ze.vertices[ze.vertices.length-1])<1e-12?this.multi=0:this.mnormal?ze.vertices.push(this.v3):ze.vertices.unshift(this.v2))}const An=new ot;switch(tn){case 0:An.vertices.push(this.v1,this.v2,this.v3,this.v4);break;case 1:An.vertices.push(this.v1,this.v3,this.v4);break;case 2:An.vertices.push(this.v1,this.v2,this.v3)}this.polygons.push(An)}setNormal4(Y,E,J,Ae,Ce,He,nt,it,lt,qt,at,Jt){this.v1.setnormal(Y,E,J),this.v2&&this.v2.setnormal(Ae,Ce,He),this.v3.setnormal(nt,it,lt),this.v4&&this.v4.setnormal(qt,at,Jt)}setNormal_12_34(Y,E,J,Ae,Ce,He){this.v1.setnormal(Y,E,J),this.v2&&this.v2.setnormal(Y,E,J),this.v3.setnormal(Ae,Ce,He),this.v4&&this.v4.setnormal(Ae,Ce,He)}calcNormal(){this.cb||(this.pA=new be.Pq0,this.pB=new be.Pq0,this.pC=new be.Pq0,this.cb=new be.Pq0,this.ab=new be.Pq0),this.pA.set(this.v1.x,this.v1.y,this.v1.z),1!==this.reduce?(this.pB.set(this.v2.x,this.v2.y,this.v2.z),this.pC.set(this.v3.x,this.v3.y,this.v3.z)):(this.pB.set(this.v3.x,this.v3.y,this.v3.z),this.pC.set(this.v4.x,this.v4.y,this.v4.z)),this.cb.subVectors(this.pC,this.pB),this.ab.subVectors(this.pA,this.pB),this.cb.cross(this.ab),this.setNormal(this.cb.x,this.cb.y,this.cb.z)}setNormal(Y,E,J){this.v1.setnormal(Y,E,J),this.v2&&this.v2.setnormal(Y,E,J),this.v3.setnormal(Y,E,J),this.v4&&this.v4.setnormal(Y,E,J)}recalcZ(Y){this.v1.z=Y(this.v1.x,this.v1.y,this.v1.z),this.v2&&(this.v2.z=Y(this.v2.x,this.v2.y,this.v2.z)),this.v3.z=Y(this.v3.x,this.v3.y,this.v3.z),this.v4&&(this.v4.z=Y(this.v4.x,this.v4.y,this.v4.z))}create(){return{polygons:this.polygons}}}function kt(Ue,Y){const E=[4,7,6,5,0,3,7,4,4,5,1,0,6,2,1,5,7,3,2,6,1,2,3,0],J=Y>0?new _t:new rt(12);for(let Ae=0;Ae<E.length;Ae+=4){const Ce=3*E[Ae],He=3*E[Ae+1],nt=3*E[Ae+2],it=3*E[Ae+3];J.addFace4(Ue[Ce],Ue[Ce+1],Ue[Ce+2],Ue[He],Ue[He+1],Ue[He+2],Ue[nt],Ue[nt+1],Ue[nt+2],Ue[it],Ue[it+1],Ue[it+2]),0===Ae?J.setNormal(0,0,1):20===Ae?J.setNormal(0,0,-1):J.calcNormal()}return J.create()}function jt(Ue,Y){let E,J;Ue._typename===D||Ue._typename===x?(E=[Ue.fRmax2,Ue.fRmax1],J=[Ue.fRmin2,Ue.fRmin1]):(E=[Ue.fRmax,Ue.fRmax],J=[Ue.fRmin,Ue.fRmin]);const Ae=J[0]>0||J[1]>0;let Ce=0,He=360;(Ue._typename===x||Ue._typename===w||Ue._typename===b)&&(Ce=Ue.fPhi1,He=Ue.fPhi2-Ue.fPhi1);const nt=Math.max(4,Math.round(He/he.GradPerSegm));let it=nt*(E[0]<=0||E[1]<=0?1:2);if(Ae&&(it+=nt*(J[0]<=0||J[1]<=0?1:2)),E[0]>0&&(it+=nt*(J[0]>0?2:1)),E[1]>0&&(it+=nt*(J[1]>0?2:1)),He<360&&(it+=(E[0]>J[0]?2:0)+(E[1]>J[1]?2:0)),Y<0)return it;const lt=Ce*Math.PI/180,qt=He/nt*Math.PI/180,at=new Float32Array(nt+1),Jt=new Float32Array(nt+1);for(let ze=0;ze<=nt;++ze)Jt[ze]=Math.cos(lt+ze*qt),at[ze]=Math.sin(lt+ze*qt);const tn=Y?new _t:new rt(it),An=Ue._typename!==b?null:(ze,$e,ut)=>{const bt=ut<0?Ue.fNlow:Ue.fNhigh;return(ut<0?-Ue.fDz:Ue.fDz)-(ze*bt[0]+$e*bt[1])/bt[2]};for(let ze=0;ze<2&&(1!==ze||Ae);++ze){const $e=0===ze?E:J,ut=ze,bt=1-ze;let Ot=1,_n=0;if($e[0]!==$e[1]){const rn=Math.atan2($e[1]-$e[0],2*Ue.fDZ);Ot=Math.cos(rn),_n=Math.sin(rn)}1===ze&&(Ot*=-1,_n*=-1);const en=$e[0]<=0?2:$e[1]<=0?1:0;for(let rn=0;rn<nt;++rn)tn.addFace4($e[0]*Jt[rn+ut],$e[0]*at[rn+ut],Ue.fDZ,$e[1]*Jt[rn+ut],$e[1]*at[rn+ut],-Ue.fDZ,$e[1]*Jt[rn+bt],$e[1]*at[rn+bt],-Ue.fDZ,$e[0]*Jt[rn+bt],$e[0]*at[rn+bt],Ue.fDZ,en),An&&tn.recalcZ(An),tn.setNormal_12_34(Ot*Jt[rn+ut],Ot*at[rn+ut],_n,Ot*Jt[rn+bt],Ot*at[rn+bt],_n,en)}for(let ze=0;ze<2;++ze){if(E[ze]<=0)continue;const $e=ze,ut=1-ze,bt=0===ze?1:-1,Ot=J[ze]<=0?2:0;2===Ot&&360===He&&!An&&tn.startPolygon(0===ze);for(let _n=0;_n<nt;++_n)tn.addFace4(J[ze]*Jt[_n+$e],J[ze]*at[_n+$e],bt*Ue.fDZ,E[ze]*Jt[_n+$e],E[ze]*at[_n+$e],bt*Ue.fDZ,E[ze]*Jt[_n+ut],E[ze]*at[_n+ut],bt*Ue.fDZ,J[ze]*Jt[_n+ut],J[ze]*at[_n+ut],bt*Ue.fDZ,Ot),An?(tn.recalcZ(An),tn.calcNormal()):tn.setNormal(0,0,bt);tn.stopPolygon()}return He<360&&(tn.addFace4(J[1]*Jt[0],J[1]*at[0],-Ue.fDZ,E[1]*Jt[0],E[1]*at[0],-Ue.fDZ,E[0]*Jt[0],E[0]*at[0],Ue.fDZ,J[0]*Jt[0],J[0]*at[0],Ue.fDZ,E[0]===J[0]?2:J[1]===E[1]?1:0),An&&tn.recalcZ(An),tn.calcNormal(),tn.addFace4(J[0]*Jt[nt],J[0]*at[nt],Ue.fDZ,E[0]*Jt[nt],E[0]*at[nt],Ue.fDZ,E[1]*Jt[nt],E[1]*at[nt],-Ue.fDZ,J[1]*Jt[nt],J[1]*at[nt],-Ue.fDZ,E[0]===J[0]?1:J[1]===E[1]?2:0),An&&tn.recalcZ(An),tn.calcNormal()),tn.create()}function hi(Ue){if(!Ue)return null;let Y,E,J;switch(Ue._typename){case"TGeoTranslation":Y=Ue.fTranslation;break;case"TGeoRotation":E=Ue.fRotationMatrix;break;case"TGeoScale":J=Ue.fScale;break;case"TGeoGenTrans":J=Ue.fScale;case"TGeoCombiTrans":Y=Ue.fTranslation,Ue.fRotation&&(E=Ue.fRotation.fRotationMatrix);break;case"TGeoHMatrix":Y=Ue.fTranslation,E=Ue.fRotationMatrix,J=Ue.fScale;break;case"TGeoIdentity":break;default:console.warn(`unsupported matrix ${Ue._typename}`)}if(!Y&&!E&&!J)return null;const Ae=new be.kn4;return E&&Ae.set(E[0],E[1],E[2],0,E[3],E[4],E[5],0,E[6],E[7],E[8],0,0,0,0,1),Y&&Ae.setPosition(Y[0],Y[1],Y[2]),J&&Ae.scale(new be.Pq0(J[0],J[1],J[2])),Ae}function qi(Ue,Y){let E=null;if(Ue===de)E=new be.kn4,Y.fTrans&&(E.set(Y.fTrans[0],Y.fTrans[4],Y.fTrans[8],0,Y.fTrans[1],Y.fTrans[5],Y.fTrans[9],0,Y.fTrans[2],Y.fTrans[6],Y.fTrans[10],0,0,0,0,1),E.setPosition(Y.fTrans[12],Y.fTrans[13],Y.fTrans[14]));else if(Y.fMatrix)E=hi(Y.fMatrix);else if("TGeoNodeOffset"===Y._typename&&Y.fFinder){const J=(0,v.BIT)(14);switch(Y.fFinder.fBits&J&&We("Unsupported reflected pattern "+Y.fFinder._typename),Y.fFinder._typename){case"TGeoPatternX":case"TGeoPatternY":case"TGeoPatternZ":case"TGeoPatternParaX":case"TGeoPatternParaY":case"TGeoPatternParaZ":{const Ae=Y.fFinder.fStart+(Y.fIndex+.5)*Y.fFinder.fStep;switch(E=new be.kn4,Y.fFinder._typename[Y.fFinder._typename.length-1]){case"X":E.setPosition(Ae,0,0);break;case"Y":E.setPosition(0,Ae,0);break;case"Z":E.setPosition(0,0,Ae)}break}case"TGeoPatternCylPhi":{const Ae=Math.PI/180*(Y.fFinder.fStart+(Y.fIndex+.5)*Y.fFinder.fStep),Ce=Math.cos(Ae),He=Math.sin(Ae);E=new be.kn4,E.set(Ce,-He,0,0,He,Ce,0,0,0,0,1,0,0,0,0,1);break}case"TGeoPatternCylR":E=new be.kn4;break;case"TGeoPatternTrapZ":{const Ae=Y.fFinder.fStart+(Y.fIndex+.5)*Y.fFinder.fStep;E=new be.kn4,E.setPosition(Y.fFinder.fTxz*Ae,Y.fFinder.fTyz*Ae,Ae);break}default:We(`Unsupported pattern type ${Y.fFinder._typename}`)}}return E}function Mr(Ue){if(!Ue)return 0;if(Ue instanceof Ie)return Ue.tree.numPolygons();if(Ue.polygons)return Ue.polygons.length;const Y=Ue.getAttribute("position");return Y?.count?Math.round(Y.count/3):0}function fs(Ue,Y){if(!Ue?.fN||!Ue?.fP)return null;const E=new be.Pq0(Ue.fP[0],Ue.fP[1],Ue.fP[2]),J=new be.Pq0(Ue.fN[0],Ue.fN[1],Ue.fN[2]);J.normalize();let Ae=1e10;if(Y){const at=function ms(Ue){if(!Ue)return null;let Y=null;if(Ue instanceof Ie?Y=Ue.tree.collectPolygons():Ue.polygons&&(Y=Ue.polygons),null!==Y){const E=new be.NRn;for(let J=0;J<Y.length;++J){const Ae=Y[J],Ce=Ae.vertices.length;for(let He=0;He<Ce;++He)E.expandByPoint(Ae.vertices[He])}return E}return Ue.boundingBox||Ue.computeBoundingBox(),Ue.boundingBox.clone()}(Y);at&&(Ae=1e3*at.getSize(new be.Pq0).length())}const Ce=new be.Pq0(-Ae,-Ae/2,0),He=new be.Pq0(0,Ae,0),nt=new be.Pq0(Ae,-Ae/2,0),it=new be.Pq0(0,0,-Ae),lt=new be.LoY,qt=new Float32Array([Ce.x,Ce.y,Ce.z,nt.x,nt.y,nt.z,He.x,He.y,He.z,Ce.x,Ce.y,Ce.z,He.x,He.y,He.z,it.x,it.y,it.z,He.x,He.y,He.z,nt.x,nt.y,nt.z,it.x,it.y,it.z,nt.x,nt.y,nt.z,Ce.x,Ce.y,Ce.z,it.x,it.y,it.z]);lt.setAttribute("position",new be.THS(qt,3)),lt.computeVertexNormals(),lt.lookAt(J),lt.computeVertexNormals();for(let at=0;at<qt.length;at+=3)qt[at]=qt[at]+E.x,qt[at+1]=qt[at+1]+E.y,qt[at+2]=qt[at+2]+E.z;return lt}function wt(Ue){if(!Ue)return 0;if(Ue instanceof Ie)return Ue.tree.numPolygons();if(Ue.polygons)return Ue.polygons.length;const Y=Ue.getAttribute("position");return Y?.count?Math.round(Y.count/3):0}function me(Ue,Y,E,J,Ae){Ue.boundingBox||Ue.computeBoundingBox();const Ce=Ue.boundingBox.clone();if(Ce.applyMatrix4(Y),J||(J=0),Ce.min[E]>=J&&Ce.max[E]>=J||Ce.min[E]<=J&&Ce.max[E]<=J)return null;const He=new Ie(Ue,Y,0,Ae),nt=2*Math.max(Math.abs(Ce.min.x),Math.abs(Ce.max.x)),it=2*Math.max(Math.abs(Ce.min.y),Math.abs(Ce.max.y)),lt=2*Math.max(Math.abs(Ce.min.z),Math.abs(Ce.max.z));let qt=1e4;switch(E){case"x":qt=Math.max(it,lt);break;case"y":qt=Math.max(nt,lt);break;case"z":qt=Math.max(nt,it)}const at=function L(Ue,Y,E){let J;switch((!E||E<1e4)&&(E=1e4),Ue){case"x":J=[new Ke(Y,-3*E,E,1,0,0),new Ke(Y,E,-3*E,1,0,0),new Ke(Y,E,E,1,0,0)];break;case"y":J=[new Ke(-3*E,Y,E,0,1,0),new Ke(E,Y,E,0,1,0),new Ke(E,Y,-3*E,0,1,0)];break;default:J=[new Ke(-3*E,E,Y,0,0,1),new Ke(E,-3*E,Y,0,0,1),new Ke(E,E,Y,0,0,1)]}const Ae=new Re([new ot(J)]);return new Ie(Ae)}(E,J,qt);return He.cut_from_plane(at),at.toBufferGeometry()}function _e(Ue,Y){void 0===Y&&(Y=0);try{switch(Ue._typename){case K:return function Yt(Ue,Y){if(Y<0)return 12;const E=Ue.fDX,J=Ue.fDY,Ae=Ue.fDZ,Ce=Y?new _t:new rt(12);return Ce.addFace4(E,J,Ae,E,-J,Ae,E,-J,-Ae,E,J,-Ae),Ce.setNormal(1,0,0),Ce.addFace4(-E,J,-Ae,-E,-J,-Ae,-E,-J,Ae,-E,J,Ae),Ce.setNormal(-1,0,0),Ce.addFace4(-E,J,-Ae,-E,J,Ae,E,J,Ae,E,J,-Ae),Ce.setNormal(0,1,0),Ce.addFace4(-E,-J,Ae,-E,-J,-Ae,E,-J,-Ae,E,-J,Ae),Ce.setNormal(0,-1,0),Ce.addFace4(-E,J,Ae,-E,-J,Ae,E,-J,Ae,E,J,Ae),Ce.setNormal(0,0,1),Ce.addFace4(E,J,-Ae,E,-J,-Ae,-E,-J,-Ae,-E,J,-Ae),Ce.setNormal(0,0,-1),Ce.create()}(Ue,Y);case N:return function Tt(Ue,Y){if(Y<0)return 12;const E=Ue.fTxy,J=Ue.fTxz,Ae=Ue.fTyz;return kt([-Ue.fZ*J-E*Ue.fY-Ue.fX,-Ue.fY-Ue.fZ*Ae,-Ue.fZ,-Ue.fZ*J+E*Ue.fY-Ue.fX,Ue.fY-Ue.fZ*Ae,-Ue.fZ,-Ue.fZ*J+E*Ue.fY+Ue.fX,Ue.fY-Ue.fZ*Ae,-Ue.fZ,-Ue.fZ*J-E*Ue.fY+Ue.fX,-Ue.fY-Ue.fZ*Ae,-Ue.fZ,Ue.fZ*J-E*Ue.fY-Ue.fX,Ue.fZ*Ae-Ue.fY,Ue.fZ,Ue.fZ*J+E*Ue.fY-Ue.fX,Ue.fY+Ue.fZ*Ae,Ue.fZ,Ue.fZ*J+E*Ue.fY+Ue.fX,Ue.fY+Ue.fZ*Ae,Ue.fZ,Ue.fZ*J-E*Ue.fY+Ue.fX,Ue.fZ*Ae-Ue.fY,Ue.fZ],Y)}(Ue,Y);case g:case C:return function fn(Ue,Y){if(Y<0)return 12;let E,J;return Ue._typename===g?E=J=Ue.fDY:(E=Ue.fDy1,J=Ue.fDy2),kt([-Ue.fDx1,E,-Ue.fDZ,Ue.fDx1,E,-Ue.fDZ,Ue.fDx1,-E,-Ue.fDZ,-Ue.fDx1,-E,-Ue.fDZ,-Ue.fDx2,J,Ue.fDZ,Ue.fDx2,J,Ue.fDZ,Ue.fDx2,-J,Ue.fDZ,-Ue.fDx2,-J,Ue.fDZ],Y)}(Ue,Y);case G:case A:case R:return function ln(Ue,Y){if(Y<0)return 12;const E=[Ue.fXY[0][0],Ue.fXY[0][1],-Ue.fDZ,Ue.fXY[1][0],Ue.fXY[1][1],-Ue.fDZ,Ue.fXY[2][0],Ue.fXY[2][1],-Ue.fDZ,Ue.fXY[3][0],Ue.fXY[3][1],-Ue.fDZ,Ue.fXY[4][0],Ue.fXY[4][1],Ue.fDZ,Ue.fXY[5][0],Ue.fXY[5][1],Ue.fDZ,Ue.fXY[6][0],Ue.fXY[6][1],Ue.fDZ,Ue.fXY[7][0],Ue.fXY[7][1],Ue.fDZ],J=[4,7,6,6,5,4,3,7,4,4,0,3,5,1,0,0,4,5,6,2,1,1,5,6,7,3,2,2,6,7,1,2,3,3,0,1];for(let nt=0;nt<E.length;nt+=E.length/2)for(let it=nt;it<nt+E.length/2-3;it+=3)for(let lt=it+3;lt<nt+E.length/2;lt+=3)if(E[it]===E[lt]&&E[it+1]===E[lt+1]&&E[it+2]===E[lt+2])for(let qt=0;qt<J.length;++qt)J[qt]===lt/3&&(J[qt]=it/3);const Ae=[];let Ce=0;for(let nt=0;nt<J.length;nt+=3){const it=100*J[nt]+10*J[nt+1]+J[nt+2],lt=100*J[nt+1]+10*J[nt+2]+J[nt],qt=100*J[nt+2]+10*J[nt]+J[nt+1];J[nt]===J[nt+1]||J[nt]===J[nt+2]||J[nt+1]===J[nt+2]||Ae.indexOf(it)>=0||Ae.indexOf(lt)>=0||Ae.indexOf(qt)>=0?J[nt]=J[nt+1]=J[nt+2]=-1:(Ae.push(it,lt,qt),Ce++)}const He=Y?new _t:new rt(Ce);for(let nt=0;nt<J.length;nt+=6){const it=3*J[nt],lt=3*J[nt+1],qt=3*J[nt+2],at=3*J[nt+3],Jt=3*J[nt+4],tn=3*J[nt+5];let An=null;if(it>=0&&at>=0&&Y)if(0===nt)An=new be.Pq0(0,0,1);else if(30===nt)An=new be.Pq0(0,0,-1);else{const ze=dt(E[it],E[it+1],E[it+2],E[lt],E[lt+1],E[lt+2],E[qt],E[qt+1],E[qt+2]);ze.normalize();const $e=dt(E[at],E[at+1],E[at+2],E[Jt],E[Jt+1],E[Jt+2],E[tn],E[tn+1],E[tn+2]);$e.normalize(),ze.distanceToSquared($e)<1e-12&&(An=ze)}null!==An?(He.addFace4(E[it],E[it+1],E[it+2],E[lt],E[lt+1],E[lt+2],E[qt],E[qt+1],E[qt+2],E[Jt],E[Jt+1],E[Jt+2]),He.setNormal(An.x,An.y,An.z)):(it>=0&&(He.addFace3(E[it],E[it+1],E[it+2],E[lt],E[lt+1],E[lt+2],E[qt],E[qt+1],E[qt+2]),He.calcNormal()),at>=0&&(He.addFace3(E[at],E[at+1],E[at+2],E[Jt],E[Jt+1],E[Jt+2],E[tn],E[tn+1],E[tn+2]),He.calcNormal()))}return He.create()}(Ue,Y);case z:return function mn(Ue,Y){const E=[Ue.fRmax,Ue.fRmin],J=Ue.fPhi1,Ae=Ue.fPhi2-Ue.fPhi1,Ce=Ue.fTheta1,He=Ue.fTheta2-Ue.fTheta1,nt=E[1]<=0;let it=Ue.fNseg,lt=Ue.fNz;if(Y>0){const en=(nt?2:4)*it*lt/Y;en>1&&(it=Math.max(4,Math.floor(it/Math.sqrt(en))),lt=Math.max(4,Math.floor(lt/Math.sqrt(en))))}let qt=it*lt*2,at=it*(nt?1:2),Jt=it*(nt?1:2);const tn=360===Ae?0:lt*(nt?2:4),An=1e-10;if(Y<0)return qt*(nt?1:2)+at+Jt+tn;const ze=new Float32Array(it+1),$e=new Float32Array(it+1),ut=new Float32Array(lt+1),bt=new Float32Array(lt+1);for(let en=0;en<=lt;++en){const rn=(Ce+He/lt*en)*Math.PI/180;ut[en]=Math.sin(rn),bt[en]=Math.cos(rn)}for(let en=0;en<=it;++en){const rn=(J+Ae/it*en)*Math.PI/180;ze[en]=Math.sin(rn),$e[en]=Math.cos(rn)}Math.abs(ut[0])<=An&&(qt-=it,at=0),Math.abs(ut[lt])<=An&&(qt-=it,Jt=0);const Ot=qt*(nt?1:2)+at+Jt+tn,_n=Y?new _t:new rt(Ot);for(let en=0;en<2&&(1!==en||!nt);++en){const rn=E[en],Tn=0===en?1:-1,In=1-en,Xn=1-In;for(let Ri=0;Ri<lt;++Ri){const Wi=Ri+In,Ti=Ri+Xn;let Tr=0;Math.abs(ut[Wi])<=An?Tr=1:Math.abs(ut[Ti])<=An&&(Tr=2);for(let Qr=0;Qr<it;++Qr)_n.addFace4(rn*ut[Wi]*$e[Qr],rn*ut[Wi]*ze[Qr],rn*bt[Wi],rn*ut[Wi]*$e[Qr+1],rn*ut[Wi]*ze[Qr+1],rn*bt[Wi],rn*ut[Ti]*$e[Qr+1],rn*ut[Ti]*ze[Qr+1],rn*bt[Ti],rn*ut[Ti]*$e[Qr],rn*ut[Ti]*ze[Qr],rn*bt[Ti],Tr),_n.setNormal4(Tn*ut[Wi]*$e[Qr],Tn*ut[Wi]*ze[Qr],Tn*bt[Wi],Tn*ut[Wi]*$e[Qr+1],Tn*ut[Wi]*ze[Qr+1],Tn*bt[Wi],Tn*ut[Ti]*$e[Qr+1],Tn*ut[Ti]*ze[Qr+1],Tn*bt[Ti],Tn*ut[Ti]*$e[Qr],Tn*ut[Ti]*ze[Qr],Tn*bt[Ti],Tr)}}for(let en=0;en<=lt;en+=lt)if(Math.abs(ut[en])>=An){const rn=ut[en],Tn=bt[en],In=0===en?0:1,Xn=1-In;for(let Ri=0;Ri<it;++Ri)_n.addFace4(E[1]*rn*$e[Ri+In],E[1]*rn*ze[Ri+In],E[1]*Tn,E[0]*rn*$e[Ri+In],E[0]*rn*ze[Ri+In],E[0]*Tn,E[0]*rn*$e[Ri+Xn],E[0]*rn*ze[Ri+Xn],E[0]*Tn,E[1]*rn*$e[Ri+Xn],E[1]*rn*ze[Ri+Xn],E[1]*Tn,nt?2:0),_n.calcNormal()}if(Ae<360)for(let en=0;en<=it;en+=it){const rn=ze[en],Tn=$e[en],In=0===en?1:0,Xn=1-In;for(let Ri=0;Ri<lt;++Ri)_n.addFace4(E[1]*ut[Ri+In]*Tn,E[1]*ut[Ri+In]*rn,E[1]*bt[Ri+In],E[0]*ut[Ri+In]*Tn,E[0]*ut[Ri+In]*rn,E[0]*bt[Ri+In],E[0]*ut[Ri+Xn]*Tn,E[0]*ut[Ri+Xn]*rn,E[0]*bt[Ri+Xn],E[1]*ut[Ri+Xn]*Tn,E[1]*ut[Ri+Xn]*rn,E[1]*bt[Ri+Xn],nt?2:0),_n.calcNormal()}return _n.create()}(Ue,Y);case D:case x:case P:case w:case b:return jt(Ue,Y);case k:return function Sn(Ue,Y){const E=Math.max(4,Math.round(360/he.GradPerSegm));if(Y<0)return 4*E;const J=new Float32Array(E+1),Ae=new Float32Array(E+1);for(let qt=0;qt<=E;++qt){const at=qt/E*2*Math.PI;J[qt]=Ue.fRmin*Math.cos(at),Ae[qt]=Ue.fRmax*Math.sin(at)}const Ce=Y?new _t:new rt(4*E);let He,nt,it=1,lt=0;for(let qt=0;qt<E;++qt){Ce.addFace4(J[qt],Ae[qt],+Ue.fDZ,J[qt],Ae[qt],-Ue.fDZ,J[qt+1],Ae[qt+1],-Ue.fDZ,J[qt+1],Ae[qt+1],Ue.fDZ),He=it,nt=lt,it=J[qt+1]*Ue.fRmax/Ue.fRmin,lt=Ae[qt+1]*Ue.fRmin/Ue.fRmax;const at=Math.sqrt(it**2+lt**2);it/=at,lt/=at,Ce.setNormal_12_34(He,nt,0,it,lt,0)}for(let qt=0;qt<2;++qt){const at=0===qt?1:-1,Jt=qt,tn=1-qt;for(let An=0;An<E;++An)Ce.addFace3(0,0,at*Ue.fDZ,J[An+Jt],Ae[An+Jt],at*Ue.fDZ,J[An+tn],Ae[An+tn],at*Ue.fDZ),Ce.setNormal(0,0,at)}return Ce.create()}(Ue,Y);case m:return function cn(Ue,Y){const E=Ue.fR;let J=Math.max(6,Math.round(360/he.GradPerSegm)),Ae=Math.max(8,Math.round(Ue.fDphi/he.GradPerSegm)),Ce=(Ue.fRmin>0?4:2)*J*(Ae+(360!==Ue.fDphi?1:0));if(Y<0)return Ce;Y>0&&Ce>Y&&(J=Math.floor(J/Math.sqrt(Ce/Y)),Ae=Math.floor(Ae/Math.sqrt(Ce/Y)),Ce=(Ue.fRmin>0?4:2)*J*(Ae+(360!==Ue.fDphi?1:0)));const He=new Float32Array(J+1),nt=new Float32Array(J+1),it=new Float32Array(Ae+1),lt=new Float32Array(Ae+1);for(let en=0;en<=J;++en)He[en]=Math.sin(en/J*2*Math.PI),nt[en]=Math.cos(en/J*2*Math.PI);for(let en=0;en<=Ae;++en){const rn=(Ue.fPhi1+Ue.fDphi*en/Ae)/180*Math.PI;it[en]=Math.sin(rn),lt[en]=Math.cos(rn)}const qt=Y?new _t:new rt(Ce),at=new be.Pq0,Jt=new be.Pq0,tn=new be.Pq0,An=new be.Pq0,ze=new be.Pq0,$e=new be.Pq0,ut=new be.Pq0,bt=new be.Pq0,Ot=new be.Pq0,_n=new be.Pq0;for(let en=0;en<2&&!(en>0&&Ue.fRmin<=0);++en){const rn=en>0?Ue.fRmin:Ue.fRmax,Tn=1-en,In=1-Tn,Xn=en>0?-1:1;for(let Ri=0;Ri<Ae;++Ri){const Wi=Ri+Tn,Ti=Ri+In;Ot.x=E*lt[Wi],Ot.y=E*it[Wi],_n.x=E*lt[Ti],_n.y=E*it[Ti];for(let Tr=0;Tr<J;++Tr)at.x=(E+rn*nt[Tr])*lt[Wi],at.y=(E+rn*nt[Tr])*it[Wi],at.z=rn*He[Tr],Jt.x=(E+rn*nt[Tr+1])*lt[Wi],Jt.y=(E+rn*nt[Tr+1])*it[Wi],Jt.z=rn*He[Tr+1],tn.x=(E+rn*nt[Tr+1])*lt[Ti],tn.y=(E+rn*nt[Tr+1])*it[Ti],tn.z=rn*He[Tr+1],An.x=(E+rn*nt[Tr])*lt[Ti],An.y=(E+rn*nt[Tr])*it[Ti],An.z=rn*He[Tr],qt.addFace4(at.x,at.y,at.z,Jt.x,Jt.y,Jt.z,tn.x,tn.y,tn.z,An.x,An.y,An.z),ze.subVectors(at,Ot).normalize(),$e.subVectors(Jt,Ot).normalize(),ut.subVectors(tn,_n).normalize(),bt.subVectors(An,_n).normalize(),qt.setNormal4(Xn*ze.x,Xn*ze.y,Xn*ze.z,Xn*$e.x,Xn*$e.y,Xn*$e.z,Xn*ut.x,Xn*ut.y,Xn*ut.z,Xn*bt.x,Xn*bt.y,Xn*bt.z)}}if(360!==Ue.fDphi)for(let en=0;en<=Ae;en+=Ae){const rn=Ue.fRmax,Tn=Ue.fRmin,In=en>0?0:1,Xn=1-In,Ri=Ue.fRmin>0?0:1,Wi=en>0?1:-1;for(let Ti=0;Ti<J;++Ti)qt.addFace4((E+rn*nt[Ti+In])*lt[en],(E+rn*nt[Ti+In])*it[en],rn*He[Ti+In],(E+Tn*nt[Ti+In])*lt[en],(E+Tn*nt[Ti+In])*it[en],Tn*He[Ti+In],(E+Tn*nt[Ti+Xn])*lt[en],(E+Tn*nt[Ti+Xn])*it[en],Tn*He[Ti+Xn],(E+rn*nt[Ti+Xn])*lt[en],(E+rn*nt[Ti+Xn])*it[en],rn*He[Ti+Xn],Ri),qt.setNormal(-Wi*it[en],Wi*lt[en],0)}return qt.create()}(Ue,Y);case H:case X:return function gn(Ue,Y){const E=Ue.fPhi1,J=Ue.fDphi;let Ae,Ce;Ue._typename===X?(Ae=Ue.fNedges,Ce=1/Math.cos(Math.PI/180*J/Ae/2)):(Ae=Math.max(5,Math.round(J/he.GradPerSegm)),Ce=1);const He=new Int16Array(2*Ue.fNz);let nt=0,it=!1;for(let ut=0;ut<Ue.fNz;++ut)Ue.fRmin[ut]>0&&(it=!0);if(Y<0)return(it?4:2)*Ae*(Ue.fNz-1);const lt=360===J?null:[];for(let ut=0;ut<2;++ut){const bt=0===ut?"fRmax":"fRmin";for(let Ot=0;Ot<Ue.fNz;++Ot){const _n=Ue.fZ[Ot],en=Ue[bt][Ot];He[2*Ot+ut]=0,!(Ot>0&&Ot<Ue.fNz-1&&(Ue.fZ[Ot-1]===_n&&Ue[bt][Ot-1]===en||Ue[bt][Ot+1]===en&&Ue[bt][Ot-1]===en))&&(Ot>0&&(0===ut||it)&&(He[2*Ot+ut]=1,nt++),null!==lt&&(0===ut?lt.push(new be.I9Y(Ce*en,_n)):en<Ue.fRmax[Ot]&&lt.unshift(new be.I9Y(Ce*en,_n))))}}let qt=nt*Ae*2;Ue.fRmin[0]!==Ue.fRmax[0]&&(qt+=Ae*(it?2:1)),Ue.fRmin[Ue.fNz-1]!==Ue.fRmax[Ue.fNz-1]&&(qt+=Ae*(it?2:1));let at=null;if(null!==lt){if(lt.length===2*Ue.fNz){at=[];for(let ut=Ue.fNz-1;ut>0;--ut){if(Ue.fZ[ut]===Ue.fZ[ut-1])continue;const bt=2*Ue.fNz-1-ut;at.push([bt,ut-1,ut]),at.push([bt,bt+1,ut-1])}}else at=be.xJ6.triangulateShape(lt,[]);qt+=2*at.length}const Jt=E*Math.PI/180,tn=J/Ae*Math.PI/180,An=new Float32Array(Ae+1),ze=new Float32Array(Ae+1);for(let ut=0;ut<=Ae;++ut)ze[ut]=Math.cos(Jt+ut*tn),An[ut]=Math.sin(Jt+ut*tn);const $e=Y?new _t:new rt(qt);for(let ut=0;ut<2;++ut){const bt=0===ut?"fRmax":"fRmin",Ot=1-ut,_n=ut;let en=Ue.fZ[0],rn=Ce*Ue[bt][0];for(let Tn=0;Tn<Ue.fNz;++Tn){if(0===He[2*Tn+ut])continue;const In=Ue.fZ[Tn],Xn=Ce*Ue[bt][Tn];let Ri=1,Wi=0;if(Xn!==rn){const Ti=Math.atan2(Xn-rn,In-en);Ri=Math.cos(Ti),Wi=Math.sin(Ti)}ut>0&&(Ri*=-1,Wi*=-1);for(let Ti=0;Ti<Ae;++Ti)$e.addFace4(rn*ze[Ti+Ot],rn*An[Ti+Ot],en,Xn*ze[Ti+Ot],Xn*An[Ti+Ot],In,Xn*ze[Ti+_n],Xn*An[Ti+_n],In,rn*ze[Ti+_n],rn*An[Ti+_n],en),$e.setNormal_12_34(Ri*ze[Ti+Ot],Ri*An[Ti+Ot],Wi,Ri*ze[Ti+_n],Ri*An[Ti+_n],Wi);en=In,rn=Xn}}for(let ut=0;ut<Ue.fNz;ut+=Ue.fNz-1){const bt=Ce*Ue.fRmin[ut],Ot=Ce*Ue.fRmax[ut];if(bt===Ot)continue;const _n=Ue.fZ[ut],en=0===ut?1:0,rn=1-en,Tn=0===ut?-1:1;!it&&!at&&$e.startPolygon(ut>0);for(let In=0;In<Ae;++In)$e.addFace4(bt*ze[In+en],bt*An[In+en],_n,Ot*ze[In+en],Ot*An[In+en],_n,Ot*ze[In+rn],Ot*An[In+rn],_n,bt*ze[In+rn],bt*An[In+rn],_n,it?0:2),$e.setNormal(0,0,Tn);$e.stopPolygon()}if(at)for(let ut=0;ut<=Ae;ut+=Ae){const bt=0===ut?1:2,Ot=3-bt;for(let _n=0;_n<at.length;++_n){const en=lt[at[_n][0]],rn=lt[at[_n][bt]],Tn=lt[at[_n][Ot]];$e.addFace3(en.x*ze[ut],en.x*An[ut],en.y,rn.x*ze[ut],rn.x*An[ut],rn.y,Tn.x*ze[ut],Tn.x*An[ut],Tn.y),$e.calcNormal()}}return $e.create()}(Ue,Y);case I:return function Cn(Ue,Y){let E=(Ue.fNz-1)*Ue.fNvert*2;if(Y<0)return E+3*Ue.fNvert;const J=[];for(let He=0;He<Ue.fNvert;++He)J.push(new be.I9Y(Ue.fX[He],Ue.fY[He]));let Ae=be.xJ6.triangulateShape(J,[]);Ae.length<J.length-2?(We(`Problem with XTRU shape ${Ue.fName} with ${J.length} vertices`),Ae=[]):E+=2*Ae.length;const Ce=Y?new _t:new rt(E);for(let He=0;He<Ue.fNz-1;++He){const nt=Ue.fZ[He],it=Ue.fScale[He],lt=Ue.fZ[He+1],qt=Ue.fScale[He+1],at=Ue.fX0[He],Jt=Ue.fX0[He+1],tn=Ue.fY0[He],An=Ue.fY0[He+1];for(let ze=0;ze<Ue.fNvert;++ze){const $e=(ze+1)%Ue.fNvert;Ce.addFace4(it*Ue.fX[ze]+at,it*Ue.fY[ze]+tn,nt,qt*Ue.fX[ze]+Jt,qt*Ue.fY[ze]+An,lt,qt*Ue.fX[$e]+Jt,qt*Ue.fY[$e]+An,lt,it*Ue.fX[$e]+at,it*Ue.fY[$e]+tn,nt),Ce.calcNormal()}}for(let He=0;He<=Ue.fNz-1;He+=Ue.fNz-1){const nt=Ue.fZ[He],it=Ue.fScale[He],lt=Ue.fX0[He],qt=Ue.fY0[He];for(let at=0;at<Ae.length;++at){const Jt=Ae[at],tn=J[Jt[0]],An=J[Jt[0===He?2:1]],ze=J[Jt[0===He?1:2]];Ce.addFace3(it*tn.x+lt,it*tn.y+qt,nt,it*An.x+lt,it*An.y+qt,nt,it*ze.x+lt,it*ze.y+qt,nt),Ce.setNormal(0,0,0===He?-1:1)}}return Ce.create()}(Ue,Y);case O:return function Ln(Ue,Y){let E=Math.max(4,Math.round(360/he.GradPerSegm)),J=30;if(Y>0){const bt=2*E*(J+1)/Y;bt>1&&(E=Math.max(5,Math.floor(E/Math.sqrt(bt))),J=Math.max(5,Math.floor(J/Math.sqrt(bt))))}const Ae=Ue.fRlo,Ce=Ue.fRhi;let He=(J+1)*E*2;if(0===Ae&&(He-=2*E),0===Ce&&(He-=2*E),Y<0)return He;let nt=-Ue.fDZ,it=Ue.fDZ;Ue.fA>=0?Ue.fB>nt&&(nt=Ue.fB):Ue.fB<it&&(it=Ue.fB);const lt=Math.atan2(nt,Ae),qt=Math.atan2(it,Ce),at=new Float32Array(E+1),Jt=new Float32Array(E+1);for(let bt=0;bt<=E;++bt)Jt[bt]=Math.cos(bt/E*2*Math.PI),at[bt]=Math.sin(bt/E*2*Math.PI);const tn=Y?new _t:new rt(He);let An=nt,ze=0,$e=0,ut=-1;for(let bt=0;bt<=J+1;++bt){let Ot=0,_n=0,en=0,rn=-1;if(0===bt&&0===Ae)continue;if(bt===J+1&&0===ze)break;switch(bt){case 0:Ot=nt,_n=Ae;break;case J:Ot=it,_n=Ce;break;case J+1:Ot=it,_n=0;break;default:{const In=Math.tan(lt+(qt-lt)*bt/J);_n=.5*(In+Math.sqrt(In**2-4*Ue.fA*Ue.fB))/Ue.fA,_n<1e-6&&(_n=0),Ot=_n*In}}en=Ue.fA*_n,rn=Ue.fA>0?-1:1;const Tn=0===ze?1:0===_n?2:0;for(let In=0;In<E;++In)tn.addFace4(_n*Jt[In],_n*at[In],Ot,ze*Jt[In],ze*at[In],An,ze*Jt[In+1],ze*at[In+1],An,_n*Jt[In+1],_n*at[In+1],Ot,Tn),0===Tn||1===bt&&0===Ae||bt===J+1&&0===Ce?tn.setNormal4(en*Jt[In],en*at[In],rn,$e*Jt[In],$e*at[In],ut,$e*Jt[In+1],$e*at[In+1],ut,en*Jt[In+1],en*at[In+1],rn,Tn):tn.setNormal(0,0,bt<J?-1:1);An=Ot,ze=_n,$e=en,ut=rn}return tn.create()}(Ue,Y);case ee:return function Zn(Ue,Y){if(0===Ue.fTin&&0===Ue.fTout)return jt(Ue,Y);let E=Math.max(4,Math.round(360/he.GradPerSegm)),J=30,Ae=E*(J+1)*(Ue.fRmin>0?4:2);if(Y<0)return Ae;Y>0&&Y>Ae&&(E=Math.max(4,Math.floor(E/Math.sqrt(Ae/Y))),J=Math.max(4,Math.floor(J/Math.sqrt(Ae/Y))),Ae=E*(J+1)*(Ue.fRmin>0?4:2));const Ce=new Float32Array(E+1),He=new Float32Array(E+1);for(let it=0;it<=E;++it)He[it]=Math.cos(it/E*2*Math.PI),Ce[it]=Math.sin(it/E*2*Math.PI);const nt=Y?new _t:new rt(Ae);for(let it=0;it<2&&!(it>0&&Ue.fRmin<=0);++it){const lt=it>0?Ue.fRmin:Ue.fRmax,qt=it>0?Ue.fTinsq:Ue.fToutsq,at=1-it,Jt=1-at;for(let tn=0;tn<J;++tn){const An=tn/J*2*Ue.fDz-Ue.fDz,ze=(tn+1)/J*2*Ue.fDz-Ue.fDz,$e=Math.sqrt(lt**2+qt*An**2),ut=Math.sqrt(lt**2+qt*ze**2);for(let bt=0;bt<E;++bt)nt.addFace4($e*He[bt+at],$e*Ce[bt+at],An,ut*He[bt+at],ut*Ce[bt+at],ze,ut*He[bt+Jt],ut*Ce[bt+Jt],ze,$e*He[bt+Jt],$e*Ce[bt+Jt],An),nt.calcNormal()}}for(let it=0;it<2;++it){const lt=0===it?Ue.fDz:-Ue.fDz,qt=Math.sqrt(Ue.fRmax**2+Ue.fToutsq*lt**2),at=Ue.fRmin>0?Math.sqrt(Ue.fRmin**2+Ue.fTinsq*lt**2):0,Jt=Ue.fRmin>0?0:1,tn=1-it,An=1-tn;for(let ze=0;ze<E;++ze)nt.addFace4(qt*He[ze+tn],qt*Ce[ze+tn],lt,at*He[ze+tn],at*Ce[ze+tn],lt,at*He[ze+An],at*Ce[ze+An],lt,qt*He[ze+An],qt*Ce[ze+An],lt,Jt),nt.setNormal(0,0,0===it?1:-1)}return nt.create()}(Ue,Y);case"TGeoTessellated":return function ui(Ue,Y){let E=0;for(let Ae=0;Ae<Ue.fFacets.length;++Ae)E+=4===Ue.fFacets[Ae].fNvert?2:1;if(Y<0)return E;const J=Y?new _t:new rt(E);for(let Ae=0;Ae<Ue.fFacets.length;++Ae){const Ce=Ue.fFacets[Ae],He=Ue.fVertices[Ce.fIvert[0]].fVec,nt=Ue.fVertices[Ce.fIvert[1]].fVec,it=Ue.fVertices[Ce.fIvert[2]].fVec;if(4===Ce.fNvert){const lt=Ue.fVertices[Ce.fIvert[3]].fVec;J.addFace4(He[0],He[1],He[2],nt[0],nt[1],nt[2],it[0],it[1],it[2],lt[0],lt[1],lt[2]),J.calcNormal()}else J.addFace3(He[0],He[1],He[2],nt[0],nt[1],nt[2],it[0],it[1],it[2]),J.calcNormal()}return J.create()}(Ue,Y);case ge:return function W(Ue,Y){if(Y<0)return _e(Ue.fNode.fLeft,-1)+_e(Ue.fNode.fRight,-1);let E,J,Ae=!1;const Ce=hi(Ue.fNode.fLeftMat),He=hi(Ue.fNode.fRightMat);if(0===Y?Y=4e3:Ae=!0,Ce&&Ce.determinant()<-.9&&We("Axis reflection in left composite shape - not supported"),He&&He.determinant()<-.9&&We("Axis reflections in right composite shape - not supported"),E=Ue.fNode.fLeft._typename===ve?fs(Ue.fNode.fLeft):_e(Ue.fNode.fLeft,Y),!E)return null;let nt=wt(E),it=0;if(E._exceed_limit&&(nt+=Y),nt<Y&&(J=Ue.fNode.fRight._typename===ve?fs(Ue.fNode.fRight,E):_e(Ue.fNode.fRight,Y),it=wt(J)),nt+it>=Y||!J)return E.polygons&&(E=Qe(E.polygons)),Ce&&E.applyMatrix4(Ce),E._exceed_limit=!0,E;let lt=new Ie(E,Ce,he.CompressComp?0:void 0);const qt=new Ie(J,He,lt.maxid);switch(lt.maxid=qt.maxid,Ue.fNode._typename){case"TGeoIntersection":lt.direct_intersect(qt);break;case"TGeoUnion":lt.direct_union(qt);break;case"TGeoSubtraction":lt.direct_subtract(qt);break;default:We("unsupported bool operation "+Ue.fNode._typename+", use first geom")}return 0===wt(lt)&&(We(`Zero faces in comp shape left: ${Ue.fNode.fLeft._typename} ${wt(E)} faces right: ${Ue.fNode.fRight._typename} ${wt(J)} faces  use first`),lt=new Ie(E,Ce)),Ae?{polygons:lt.toPolygons()}:lt.toBufferGeometry()}(Ue,Y);case ie:break;case Se:{const E=_e(Ue.fShape,Y);return Ue.fScale&&Y>=0&&(0,v.isFunc)(E?.scale)&&E.scale(Ue.fScale.fScale[0],Ue.fScale.fScale[1],Ue.fScale.fScale[2]),E}case ve:if(Y<0)return 1;default:We(`unsupported shape type ${Ue._typename}`)}}catch(E){let J="";void 0!==E.stack&&(J=E.stack.split("\n")[0],J=J.indexOf(E.message)>=0?E.stack.split("\n")[1]:"at: "+J),We(`${Ue._typename} err: ${E.message} ${J}`)}return Y<0?0:null}function Et(Ue,Y){if(Ue.server_shape&&(Ue.nsegm===Y||!Ue.shape))return Ue.server_shape;Ue.nsegm=Y;let E=null;if(Ue.shape)E=_e(Ue.shape);else{if(!Ue.raw?.buffer)return console.error("No raw data at all"),null;E=Ue.sz?function Be(Ue){let Y=0;if(Ue.sz[0]&&(Ue.vtxBuff=new Float32Array(Ue.raw.buffer,Y,Ue.sz[0]),Y+=4*Ue.sz[0]),Ue.sz[1]&&(Y+=4*Ue.sz[1]),Ue.sz[2]&&(Ue.prefixBuf=new Uint32Array(Ue.raw.buffer,Y,2),Y+=8,Ue.idxBuff=new Uint32Array(Ue.raw.buffer,Y,Ue.sz[2]-2)),4!==Ue.prefixBuf[0])throw Error("Expect triangles first.");if(Ue.idxBuff.length!==3*Ue.prefixBuf[1])throw Error("Expect single list of triangles in index buffer.");const Ae=new be.LoY;return Ae.setAttribute("position",new be.THS(Ue.vtxBuff,3)),Ae.setIndex(new be.THS(Ue.idxBuff,1)),Ae.computeVertexNormals(),Ae}(Ue):function gt(Ue){const Y=new Float32Array(Ue.raw.buffer,0,Ue.raw.buffer.byteLength/4),E=new be.LoY;return E.setAttribute("position",new be.THS(Y,3)),E.setIndex(new be.THS(new Uint32Array(Ue.idx),1)),E.computeVertexNormals(),E}(Ue)}return{_typename:"$$Shape$$",ready:!0,geom:E,nfaces:Mr(E)}}function Mt(Ue){let Y=[],E=null;if(void 0!==Ue.fVolume?E=Ue.fVolume.fShape:void 0!==Ue.fShape?E=Ue.fShape:void 0!==Ue.fShapeBits&&void 0!==Ue.fShapeId&&(E=Ue),!E)return Y.push(Ue._typename),Y;const J=Math.max(E.fDX,E.fDY,E.fDZ),Ae=J>1e7||J<1e-7,Ce=He=>void 0===He?"???":He===Math.round(He)&&He<1e7?Math.round(He):Ae?He.toExponential(4):He.toPrecision(7);switch(Y.push(E._typename),Y.push(`DX=${Ce(E.fDX)} DY=${Ce(E.fDY)} DZ=${Ce(E.fDZ)}`),E._typename){case K:break;case N:Y.push(`Alpha=${E.fAlpha} Phi=${E.fPhi} Theta=${E.fTheta}`);break;case C:Y.push(`Dy1=${Ce(E.fDy1)} Dy2=${Ce(E.fDy1)}`);case g:Y.push(`Dx1=${Ce(E.fDx1)} Dx2=${Ce(E.fDx1)}`);break;case G:case A:case R:break;case z:Y.push(`Rmin=${Ce(E.fRmin)} Rmax=${Ce(E.fRmax)}`,`Phi1=${E.fPhi1} Phi2=${E.fPhi2}`,`Theta1=${E.fTheta1} Theta2=${E.fTheta2}`);break;case x:Y.push(`Phi1=${E.fPhi1} Phi2=${E.fPhi2}`);case D:Y.push(`Rmin1=${Ce(E.fRmin1)} Rmax1=${Ce(E.fRmax1)}`,`Rmin2=${Ce(E.fRmin2)} Rmax2=${Ce(E.fRmax2)}`);break;case b:case w:Y.push(`Phi1=${E.fPhi1} Phi2=${E.fPhi2}`);case k:case P:Y.push(`Rmin=${Ce(E.fRmin)} Rmax=${Ce(E.fRmax)}`);break;case m:Y.push(`Rmin=${Ce(E.fRmin)} Rmax=${Ce(E.fRmax)}`,`Phi1=${E.fPhi1} Dphi=${E.fDphi}`);break;case H:case X:case I:break;case O:Y.push(`Rlo=${Ce(E.fRlo)} Rhi=${Ce(E.fRhi)}`,`A=${Ce(E.fA)} B=${Ce(E.fB)}`);break;case ee:Y.push(`Rmin=${Ce(E.fRmin)} Rmax=${Ce(E.fRmax)}`,`StIn=${Ce(E.fStIn)} StOut=${Ce(E.fStOut)}`);break;case ge:case ie:break;case Se:Y=Mt(E.fShape),E.fScale&&Y.unshift(`Scale X=${E.fScale.fScale[0]} Y=${E.fScale.fScale[1]} Z=${E.fScale.fScale[2]}`)}return Y}function Nt(Ue){const Y=new be.kn4;return Ue.updateMatrixWorld(),Ue.matrixWorldInverse.copy(Ue.matrixWorld).invert(),Y.multiplyMatrices(Ue.projectionMatrix,Ue.matrixWorldInverse),Y}function Qt(Ue){if(!Ue)return null;Ue instanceof be.ubm&&(Ue=Nt(Ue));const Y=new be.PPD;return Y.setFromProjectionMatrix(Ue),Y.corners=new Float32Array([1,1,1,1,1,-1,1,-1,1,1,-1,-1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,-1,0,0,0]),Y.test=new be.Pq0(0,0,0),Y.CheckShape=function(E,J){const Ae=this.test,Ce=this.corners.length,He=this.corners;for(let nt=0;nt<Ce;nt+=3)if(Ae.x=He[nt]*J.fDX,Ae.y=He[nt+1]*J.fDY,Ae.z=He[nt+2]*J.fDZ,this.containsPoint(Ae.applyMatrix4(E)))return!0;return!1},Y.CheckBox=function(E){const J=this.test;let Ae=0;return J.set(E.min.x,E.min.y,E.min.z),this.containsPoint(J)&&Ae++,J.set(E.min.x,E.min.y,E.max.z),this.containsPoint(J)&&Ae++,J.set(E.min.x,E.max.y,E.min.z),this.containsPoint(J)&&Ae++,J.set(E.min.x,E.max.y,E.max.z),this.containsPoint(J)&&Ae++,J.set(E.max.x,E.max.y,E.max.z),this.containsPoint(J)&&Ae++,J.set(E.max.x,E.min.y,E.max.z),this.containsPoint(J)&&Ae++,J.set(E.max.x,E.max.y,E.min.z),this.containsPoint(J)&&Ae++,J.set(E.max.x,E.max.y,E.max.z),this.containsPoint(J)&&Ae++,Ae>5},Y}function Zt(Ue,Y){Ue||(Ue={material_kind:"lambert"});const E=Object.assign({},Y);let J;return void 0===E.opacity&&(E.opacity=1),Ue.transparency&&(E.opacity=Math.min(1-Ue.transparency,E.opacity)),E.wireframe=Ue.wireframe??!1,E.color||(E.color="red"),E.side=be.hB5,E.transparent=E.opacity<1,E.depthWrite=1===E.opactity,"basic"===Ue.material_kind?J=new be.V9B(E):"depth"===Ue.material_kind?(delete E.color,J=new be.CSG(E)):"toon"===Ue.material_kind?J=new be.Df(E):"matcap"===Ue.material_kind?(delete E.wireframe,J=new be.FNr(E)):"standard"===Ue.material_kind?(E.metalness=Ue.metalness??.5,E.roughness=Ue.roughness??.1,J=new be._4j(E)):"normal"===Ue.material_kind?(delete E.color,J=new be.qBx(E)):"physical"===Ue.material_kind?(E.metalness=Ue.metalness??.5,E.roughness=Ue.roughness??.1,E.reflectivity=Ue.reflectivity??.5,E.emissive=E.color,J=new be.uSd(E)):"phong"===Ue.material_kind?(E.shininess=Ue.shininess??.9,J=new be.tXL(E)):(E.vertexColors=!1,J=new be.G_z(E)),void 0!==J.flatShading&&void 0!==Ue.flatShading&&(J.flatShading=Ue.flatShading),J.inherentOpacity=Y.opacity??1,J.inherentArgs=Y,J}function dn(Ue,Y){if(Ue===Y)return 0;const E=Ue?.length??0,J=Y?.length??0,Ae=E<J?E:J;let Ce=0;for(;Ce<Ae;){if(Ue[Ce]<Y[Ce])return-1;if(Ue[Ce]>Y[Ce])return 1;++Ce}return E<J?-1:E>J?1:0}function vn(Ue,Y){if(!Ue||!Y)return!1;if(Ue===Y)return!0;if(Ue.length!==Y.length)return!1;for(let E=0;E<Ue.length;++E)if(Ue[E]!==Y[E])return!1;return!0}class Fn{constructor(Y,E){this.toplevel=!0,this.name_prefix="",this.maxdepth=1,this.vislevel=4,this.maxnodes=1e4,Y?(Y.$geoh&&(this.toplevel=!1),this.createClones(Y)):E&&(this.nodes=E)}setVisLevel(Y){this.vislevel=Y&&Number.isInteger(Y)?Y:4}getVisLevel(){return this.vislevel}setMaxVisNodes(Y,E){this.maxnodes=Number.isFinite(Y)?Y:1e4,E&&Number.isFinite(E)&&(this.maxnodes*=E)}getMaxVisNodes(){return this.maxnodes}setConfig(Y){this._cfg=Y}updateNode(Y){Y&&Number.isInteger(Y.id)&&Y.id<this.nodes.length&&(this.nodes[Y.id]=Y)}getNodeShape(Y){if(!this.origin||!this.nodes)return null;const E=this.origin[Y],J=this.nodes[Y];return E&&J?J.kind!==fe?E.fShape:E.fVolume?E.fVolume.fShape:null:null}cleanup(Y,E){if(Y)for(let J=0;J<Y.length;++J)delete Y[J].stack,Y[J]=void 0;if(E)for(let J=0;J<E.length;++J)delete E[J].geom,E[J]=void 0;if(this.nodes)for(let J=0;J<this.nodes.length;++J)this.nodes[J]&&delete this.nodes[J].chlds;delete this.nodes,delete this.origin,delete this.sortmap}createClones(Y,E,J){if(!E){if("$$Shape$$"===Y?._typename)return this.createClonesForShape(Y);this.origin=[],E=1,J=Ne(Y)}if(J<0||!Y||"_refid"in Y)return;Y._refid=this.origin.length,this.origin.push(Y),E>this.maxdepth&&(this.maxdepth=E);let Ae=null;if(Ae=J===fe?Y.fVolume?.fNodes?.arr||null:Y.fElements?.arr||null,null!==Ae){pt(Y,Ae);for(let He=0;He<Ae.length;++He)this.createClones(Ae[He],E+1,J)}if(E>1)return;this.nodes=[];const Ce=[];for(let He=0;He<this.origin.length;++He){const nt={id:He,kind:J,vol:0,nfaces:0};this.nodes.push(nt),Ce.push(nt)}for(let He=0;He<this.origin.length;++He){const nt=this.origin[He],it=this.nodes[He];let lt=null,qt=null;J===de?(qt=nt.fShape,nt.fElements&&(lt=nt.fElements.arr)):nt.fVolume&&(qt=nt.fVolume.fShape,nt.fVolume.fNodes&&(lt=nt.fVolume.fNodes.arr));const at=qi(J,nt);if(at){if(it.matrix=at.elements,1===it.matrix[0]){let Jt=!0;for(let tn=1;tn<it.matrix.length&&Jt;++tn)Jt=it.matrix[tn]===(5===tn||10===tn||15===tn?1:0);Jt&&delete it.matrix}it.matrix&&J===de&&(it.abs_matrix=!0)}if(qt&&(it.fDX=qt.fDX,it.fDY=qt.fDY,it.fDZ=qt.fDZ,it.vol=Math.sqrt(qt.fDX**2+qt.fDY**2+qt.fDZ**2),void 0===qt.$nfaces&&(qt.$nfaces=_e(qt,-1)),it.nfaces=qt.$nfaces,it.nfaces<=0&&(it.vol=0)),lt){it.chlds=new Array(lt.length);for(let Jt=0;Jt<lt.length;++Jt)it.chlds[Jt]=lt[Jt]._refid}}for(let He=0;He<this.origin.length;++He)delete this.origin[He]._refid;Ce.sort((He,nt)=>nt.vol-He.vol),this.sortmap=new Array(this.nodes.length);for(let He=0;He<this.nodes.length;++He)this.sortmap[He]=Ce[He].id,Ce[He].sortid=He}createClonesForShape(Y){this.origin=[],this.plain_shape=Y,this.nodes=[{id:0,sortid:0,kind:2,name:"Shape",nfaces:Y.nfaces,fDX:1,fDY:1,fDZ:1,vol:1,vis:!0}]}countVisibles(){const Y=this.nodes?.length||0;let E=0;for(let J=0;J<Y;++J)this.nodes[J].vis&&E++;return E}markVisibles(Y,E,J){if(this.plain_shape)return 1;if(!this.origin||!this.nodes)return 0;let Ae=0;for(let Ce=0;Ce<this.nodes.length;++Ce){const He=this.nodes[Ce],nt=this.origin[Ce];He.vis=0,delete He.nochlds,He.kind===fe?nt.fVolume&&(Y?(He.vis=De(nt.fVolume,ce.kVisOnScreen)?99:0,0===Ce&&He.vis&&J&&(He.vis=0),E&&(Xe(nt.fVolume,ce.kVisNone,!1),Xe(nt.fVolume,ce.kVisThis,He.vis>0),Xe(nt.fVolume,ce.kVisDaughters,!0),Xe(nt,ce.kVisDaughters,!0))):(He.vis=!De(nt.fVolume,ce.kVisNone)&&De(nt.fVolume,ce.kVisThis)?99:0,(!De(nt,ce.kVisDaughters)||!De(nt.fVolume,ce.kVisDaughters))&&(He.nochlds=!0),He.vis>0&&He.chlds&&!He.nochlds&&(He.vis=1),0===Ce&&(J&&(He.vis=0),delete He.nochlds))):(He.vis=nt.fRnrSelf?99:0,0===Ce&&1===this.nodes.length&&(He.vis=99),this.vislevel=9999),(He.vol<=0||He.nfaces<=0)&&(He.vis=0),He.vis&&Ae++}return Ae}produceIdShifts(){for(let E=0;E<this.nodes.length;++E)this.nodes[E].idshift=-1;!function Y(E,J){if(J.idshift<0&&(J.idshift=0,J.chlds))for(let Ae=0;Ae<J.chlds.length;++Ae)J.idshift+=Y(E,E[J.chlds[Ae]]);return J.idshift+1}(this.nodes,this.nodes[0])}getVisibleFlags(){const Y=new Array(this.nodes.length);for(let E=0;E<this.nodes.length;++E)Y[E]={vis:this.nodes[E].vis,nochlds:this.nodes[E].nochlds};return Y}setVisibleFlags(Y){if(!this.nodes||!Y||!Y.length!==this.nodes.length)return 0;let E=0;for(let J=0;J<this.nodes.length;++J){const Ae=this.nodes[J];Ae.vis=Y[J].vis,Ae.nochlds=Y[J].nochlds,Ae.vis&&E++}return E}setPhysNodeVisibility(Y,E){let J=!1;if("clearall"!==E){if("clear"===E){if(J=!0,!this.fVisibility)return}else E=!!E;if(Y){this.fVisibility||(this.fVisibility=[]);for(let Ae=0;Ae<this.fVisibility.length;++Ae){const Ce=this.fVisibility[Ae],He=dn(Ce.stack,Y);if(0===He)return void(J?(this.fVisibility.splice(Ae,1),0===this.fVisibility.length&&delete this.fVisibility):Ce.visible=E);if(He>0)return void(J||this.fVisibility.splice(Ae,0,{visible:E,stack:Y}))}J||this.fVisibility.push({visible:E,stack:Y})}}else delete this.fVisibility}getPhysNodeVisibility(Y){if(!Y||!this.fVisibility)return null;for(let E=0;E<this.fVisibility.length;++E){const J=this.fVisibility[E],Ae=dn(J.stack,Y);if(0===Ae)return J;if(Ae>0)return null}return null}scanVisible(Y,E){if(!this.nodes)return 0;void 0===E&&(Y||(Y={}),(E=Y.vislvl||this.vislevel||4)>88&&(E=88),Y.stack=new Array(100),Y.nodeid=0,Y.counter=0,Y.last=0,Y.copyStack=function(nt){const it={nodeid:this.nodeid,seqid:this.counter,stack:new Array(this.last)};nt&&(it.factor=nt);for(let lt=0;lt<this.last;++lt)it.stack[lt]=this.stack[lt+1];return it},Y.domatrix&&(Y.matrices=[],Y.mpool=[new be.kn4],Y.getmatrix=function(){return this.matrices[this.last]}),this.fVisibility?.length&&(Y.vindx=0,Y.varray=this.fVisibility,Y.vstack=Y.varray[Y.vindx].stack,Y.testPhysVis=function(){if(!this.vstack||this.vstack?.length!==this.last)return;for(let it=0;it<this.last;++it)if(this.vstack[it]!==this.stack[it+1])return;const nt=this.varray[this.vindx++].visible;return this.vstack=this.vindx<this.varray.length?this.varray[this.vindx].stack:null,nt}));const J=this.nodes[Y.nodeid];let Ae=0;if(Y.domatrix){Y.mpool[Y.last+1]||(Y.mpool[Y.last+1]=new be.kn4);const nt=Y.last>0?Y.matrices[Y.last-1]:new be.kn4;J.matrix?(Y.matrices[Y.last]=Y.mpool[Y.last].fromArray(nt.elements),Y.matrices[Y.last].multiply(Y.mpool[Y.last+1].fromArray(J.matrix))):Y.matrices[Y.last]=nt}let Ce=J.vis,He=J.nochlds;if(0===Y.nodeid&&Y.main_visible)Ce=E+1;else if(Y.testPhysVis){const nt=Y.testPhysVis();void 0!==nt&&(Ce=nt&&!J.chlds?E+1:0,He=!nt)}if(He&&(E=0),Ce>E&&(!Y.func||Y.func(J))&&Ae++,Y.counter++,E>0&&J.chlds){Y.last++;for(let nt=0;nt<J.chlds.length;++nt)Y.nodeid=J.chlds[nt],Y.stack[Y.last]=nt,Ae+=this.scanVisible(Y,E-1);Y.last--}else Y.counter+=J.idshift||0;return 0===Y.last&&(delete Y.last,delete Y.stack,delete Y.copyStack,delete Y.counter,delete Y.matrices,delete Y.mpool,delete Y.getmatrix,delete Y.vindx,delete Y.varray,delete Y.vstack,delete Y.testPhysVis),Ae}getNodeName(Y){if(this.origin){const J=this.origin[Y];return J?ht(J):""}const E=this.nodes[Y];return E?E.name:""}resolveStack(Y,E){const J={id:0,obj:null,node:this.nodes[0],name:this.name_prefix||""};if(E&&(J.matrix=new be.kn4,J.node.matrix&&J.matrix.fromArray(J.node.matrix)),this.origin&&(J.obj=this.origin[0]),Y)for(let Ae=0;Ae<Y.length;++Ae){J.id=J.node.chlds[Y[Ae]],J.node=this.nodes[J.id],this.origin&&(J.obj=this.origin[J.id]);const Ce=this.getNodeName(J.id);Ce&&(J.name&&(J.name+="/"),J.name+=Ce),E&&J.node.matrix&&J.matrix.multiply((new be.kn4).fromArray(J.node.matrix))}return J}getStackName(Y){return this.resolveStack(Y).name}buildStackByIds(Y){if(!Y)return null;if(0!==Y[0])return console.error("wrong ids - first should be 0"),null;let E=this.nodes[0];const J=[];for(let Ae=1;Ae<Y.length;++Ae){const Ce=Y[Ae];if(!E)return null;const He=E.chlds.indexOf(Ce);if(He<0)return console.error(`wrong nodes ids ${Y[Ae]} is not child of ${Y[Ae-1]}`),null;J.push(He),E=this.nodes[Ce]}return J}buildIdsByStack(Y){if(!Y)return null;let E=this.nodes[0];const J=[0];for(let Ae=0;Ae<Y.length;++Ae){const Ce=E.chlds[Y[Ae]];J.push(Ce),E=this.nodes[Ce]}return J}getNodeIdByStack(Y){if(!Y||!this.nodes)return-1;let E=this.nodes[0],J=0;for(let Ae=0;Ae<Y.length;++Ae)J=E.chlds[Y[Ae]],E=this.nodes[J];return J}isIdInStack(Y,E){if(!Y)return!0;let J=this.nodes[0],Ae=0;for(let Ce=0;Ce<E.length;++Ce){if(Ae=J.chlds[E[Ce]],Ae===Y)return!0;J=this.nodes[Ae]}return!1}findStackByName(Y){const E=Y.split("/"),J=[];let Ae=0;if(this.getNodeName(Ae)!==E[0])return null;for(let Ce=1;Ce<E.length;++Ce){const He=this.nodes[Ae];if(!He.chlds)return null;for(let nt=0;nt<He.chlds.length;++nt){const it=He.chlds[nt];if(this.getNodeName(it)===E[Ce]){J.push(nt),Ae=it;break}}if(J.length===Ce-1)return null}return J}setDefaultColors(Y){if(this.use_dflt_colors=Y,this.use_dflt_colors&&!this.dflt_table){const E={kWhite:0,kBlack:1,kGray:920,kRed:632,kGreen:416,kBlue:600,kYellow:400,kMagenta:616,kCyan:432,kOrange:800,kSpring:820,kTeal:840,kAzure:860,kViolet:880,kPink:900},J=110,Ae=[];for(let Ce=0;Ce<J;Ce++)Ae.push(E.kGray);Ae[3]=E.kYellow-10,Ae[4]=Ae[5]=E.kGreen-10,Ae[6]=Ae[7]=E.kBlue-7,Ae[8]=Ae[9]=E.kMagenta-3,Ae[10]=Ae[11]=E.kRed-10,Ae[12]=E.kGray+1,Ae[13]=E.kBlue-10,Ae[14]=E.kOrange+7,Ae[16]=E.kYellow+1,Ae[20]=E.kYellow-10,Ae[24]=Ae[25]=Ae[26]=E.kBlue-8,Ae[29]=E.kOrange+9,Ae[79]=E.kOrange-2,this.dflt_table=Ae}}getDrawEntryProperties(Y,E){const J=this.nodes[Y.nodeid];if(2===J.kind){const it={name:J.name,nname:J.name,shape:null,material:null,chlds:null},lt=Y.opacity||1,qt=Y.color||"#0000FF";return it.fillcolor=new be.Q1f("#"===qt[0]?qt:`rgb(${qt})`),it.material=Zt(this._cfg,{opacity:lt,color:it.fillcolor}),it}if(!this.origin)return console.error("origin not there - kind",J.kind,Y.nodeid,J),null;const Ce=this.origin[Y.nodeid];if(J.kind===de){const it={name:ht(Ce),nname:ht(Ce),shape:Ce.fShape,material:null,chlds:null};null!==Ce.fElements&&(it.chlds=Ce.fElements.arr);{const lt=Math.min(1,Ce.fRGBA[3]);it.fillcolor=new be.Q1f(Ce.fRGBA[0],Ce.fRGBA[1],Ce.fRGBA[2]),it.material=Zt(this._cfg,{opacity:lt,color:it.fillcolor})}return it}const He=Ce.fVolume,nt={name:ht(He),nname:ht(Ce),volume:He,shape:He.fShape,material:null,chlds:He.fNodes?.arr,linewidth:He.fLineWidth};{let it=1;E||(E=["white","black","red","green","blue","yellow","magenta","cyan"]),Y.custom_color?nt.fillcolor=Y.custom_color:He.fFillColor>1&&1===He.fLineColor?nt.fillcolor=E[He.fFillColor]:He.fLineColor>=0&&(nt.fillcolor=E[He.fLineColor]);const lt=He.fMedium?.fMaterial;if(lt){const qt=lt.fFillStyle;let at=qt>=3e3&&qt<=3100?qt-3e3:0;if(this.use_dflt_colors){const Jt=Math.round(lt.fZ);nt.fillcolor=E[this.dflt_table[Jt]],lt.fDensity<.1&&(at=60)}at>0&&(it=(100-at)/100),void 0===nt.fillcolor&&(nt.fillcolor=E[lt.fFillColor])}void 0===nt.fillcolor&&(nt.fillcolor="lightgrey"),nt.material=Zt(this._cfg,{opacity:it,color:nt.fillcolor})}return nt}createObject3D(Y,E,J){let Ae=this.nodes[0],Ce=E,He=0;const nt=(0,v.isObject)(J)||"force"===J;for(let it=0;it<=Y.length;++it){const lt=it>0?Y[it-1]:0,qt=it>0?this.nodes[Ae.chlds[lt]]:Ae;if(!qt)return console.error(`Wrong stack ${JSON.stringify(Y)} for nodes at level ${it}, node.id ${Ae.id}, numnodes ${this.nodes.length}, nchld ${lt}, numchilds ${Ae.chlds.length}, chldid ${Ae.chlds[lt]}`),null;let at;if(Ae=qt,Ce.children)for(let Jt=0;Jt<Ce.children.length;++Jt)if(Ce.children[Jt].nchld===lt){at=Ce.children[Jt];break}if(at)Ce=at,at.$jsroot_drawable&&He++;else{if(!nt)return null;at=new be.B69,this._cfg?.set_names&&(at.name=this.getNodeName(Ae.id)),this._cfg?.set_origin&&this.origin&&(at.userData=this.origin[Ae.id]),Ae.abs_matrix?(at.absMatrix=new be.kn4,at.absMatrix.fromArray(Ae.matrix)):Ae.matrix&&(at.matrix.fromArray(Ae.matrix),at.matrix.decompose(at.position,at.quaternion,at.scale)),at.nchld=lt,Ce.add(at),0===it&&(0,v.isObject)(J)&&J.scale&&(J.scale.x<0||J.scale.y<0||J.scale.z<0)&&(at.scale.copy(J.scale),at.updateMatrix()),at.updateMatrixWorld(),Ce=at}}if("mesh"===J||"delete_mesh"===J){let it=null;if(Ce)for(let qt=0;qt<Ce.children.length&&!it;++qt){const at=Ce.children[qt];"Mesh"===at.type&&void 0===at.nchld&&(it=at)}if("mesh"===J||!it)return it;const lt=Ce;for(;it&&it!==E;)Ce=it.parent,Ce.remove(it),it=0===Ce.children.length?Ce:null;return lt}return Ce&&(Ce.$jsroot_drawable=!0,Ce.$jsroot_depth=He),Ce}createEntryMesh(Y,E,J,Ae,Ce){if(!Ae||!Ae.ready)return null;if(J.done=!0,Ae.used=!0,!Ae.geom||!Ae.nfaces)return this.createObject3D(J.stack,E,"delete_mesh"),null;const He=this.getDrawEntryProperties(J,Ce),nt=this.createObject3D(J.stack,E,Y),it=nt.absMatrix||nt.matrixWorld;let lt;return He.material.wireframe=Y.wireframe,He.material.side=Y.doubleside?be.$EB:be.hB5,lt=it.determinant()>-.9?new be.eaF(Ae.geom,He.material):function $n(Ue,Y){void 0===Ue.geomZ&&(Ue.geomZ=ai(Ue.geom));const E=new be.eaF(Ue.geomZ,Y);return E.scale.copy(new be.Pq0(1,1,-1)),E.updateMatrix(),E._flippedMesh=!0,E}(Ae,He.material),nt.add(lt),nt.absMatrix&&(lt.matrix.copy(nt.absMatrix),lt.matrix.decompose(lt.position,lt.quaternion,lt.scale),lt.updateMatrixWorld()),lt.stack=J.stack,lt.renderOrder=this.maxdepth-J.stack.length,Y.set_names&&(lt.name=this.getNodeName(J.nodeid)),Y.set_origin&&(lt.userData=He.volume),lt.$jsroot_order=nt.$jsroot_depth,void 0!==Y.info?.num_meshes&&(Y.info.num_meshes++,Y.info.num_faces+=Ae.nfaces),lt}createInstancedMeshes(Y,E,J,Ae,Ce){if(Y.instancing<0)return!1;const He=[];let nt=1;for(let lt=0;lt<J.length;++lt){const qt=J[lt];if(qt.done)continue;const at=qt.server_shape||Ae[qt.shapeid];if(!at||!at.ready)return console.warn(`Problem with shape id ${qt.shapeid} when building`),!1;if(!at.geom||!at.nfaces)continue;void 0===at.instances&&(at.instances=[],He.push(at));const Jt=at.instances.find(tn=>tn.nodeid===qt.nodeid);Jt?(Jt.entries.push(qt),nt=Math.max(nt,Jt.entries.length)):at.instances.push({nodeid:qt.nodeid,entries:[qt]})}return(Y.instancing>0?nt>2:J.length>1e4&&nt>10)?(He.forEach(lt=>{lt.used=!0,lt.instances.forEach(qt=>{const at=qt.entries[0],Jt=this.getDrawEntryProperties(at,Ce);if(Jt.material.wireframe=Y.wireframe,Jt.material.side=Y.doubleside?be.$EB:be.hB5,1===qt.entries.length)this.createEntryMesh(Y,E,at,lt,Ce);else{const tn=[],An=[],ze=[],$e=[],ut=[],bt=[];if(qt.entries.forEach(Ot=>{const _n=this.resolveStack(Ot.stack,!0);_n.matrix.determinant()>-.9?(tn.push(_n.matrix),ze.push(Ot.stack),ut.push(this.getNodeName(Ot.nodeid))):(An.push(_n.matrix),$e.push(Ot.stack),bt.push(this.getNodeName(Ot.nodeid))),Ot.done=!0}),tn.length>0){const Ot=new be.ZLX(lt.geom,Jt.material,tn.length);Ot.stacks=ze,tn.forEach((_n,en)=>Ot.setMatrixAt(en,_n)),E.add(Ot),Ot.renderOrder=1,Y.set_names&&(Ot.name=ut[0],Ot.names=ut),Y.set_origin&&(Ot.userData=Jt.volume),Ot.$jsroot_order=1,Y.info.num_meshes++,Y.info.num_faces+=lt.nfaces*tn.length}if(An.length>0){void 0===lt.geomZ&&(lt.geomZ=ai(lt.geom));const Ot=new be.ZLX(lt.geomZ,Jt.material,An.length);Ot.stacks=$e;const _n=(new be.kn4).makeScale(1,1,-1);An.forEach((en,rn)=>{Ot.setMatrixAt(rn,en.multiply(_n))}),Ot._flippedMesh=!0,E.add(Ot),Ot.renderOrder=1,Y.set_names&&(Ot.name=bt[0],Ot.names=bt),Y.set_origin&&(Ot.userData=Jt.volume),Ot.$jsroot_order=1,Y.info.num_meshes++,Y.info.num_faces+=lt.nfaces*An.length}}}),delete lt.instances}),!0):(He.forEach(lt=>{delete lt.instances}),!1)}getVolumeBoundary(Y,E,J){const Ae={min:0,max:1,sortidcut:0};if(!this.sortmap)return console.error("sorting map do not exist"),Ae;let Ce,He,nt=0,it=0;for(let lt=0;lt<this.sortmap.length&&nt<J&&it<E;++lt){const qt=this.sortmap[lt];0!==Y[qt]&&(He=this.nodes[qt],Ce||(Ce=He),nt+=Y[qt],it+=Y[qt]*He.nfaces)}return He?(Ae.max=Ce.vol,Ae.min=He.vol,Ae.sortidcut=He.sortid,Ae):(console.error("no volumes selected"),Ae)}collectVisibles(Y,E){if(this.plain_shape)return{lst:[{nodeid:0,seqid:0,stack:[],factor:1,shapeid:0,server_shape:this.plain_shape}],complete:!0};const J={facecnt:0,viscnt:new Array(this.nodes.length),vislvl:this.getVisLevel(),reset(){this.total=0,this.facecnt=0,this.viscnt.fill(0)},func(at){return this.total++,this.facecnt+=at.nfaces,this.viscnt[at.id]++,!0}};J.reset();let Ae=this.scanVisible(J);0===Ae&&this.nodes[0].vis<2&&!this.nodes[0].nochlds&&(J.reset(),J.main_visible=!0,Ae=this.scanVisible(J));const Ce=this.getMaxVisNodes();if(Ce>0)for(;Ae>Ce&&J.vislvl>1;)J.vislvl--,J.reset(),Ae=this.scanVisible(J);this.actual_level=J.vislvl;let He=0,nt=0,it=-1,lt=10,qt=this.nodes.length+1;if(J.facecnt>Y){const tn=this.getVolumeBoundary(J.viscnt,Y*(E?.8:1),Ce*(E?.8:1));if(He=tn.min,nt=tn.max,qt=tn.sortidcut,E){J.domatrix=!0,J.frustum=E,J.totalcam=0,J.func=function(An){return An.vol<=He&&this.frustum.CheckShape(this.getmatrix(),An)&&(this.viscnt[An.id]++,this.totalcam+=An.nfaces),!0};for(let An=0;An<J.viscnt.length;++An)J.viscnt[An]=0;this.scanVisible(J),it=J.totalcam>.2*Y?this.getVolumeBoundary(J.viscnt,.2*Y,.2*Ce).min:0,lt=nt/(it>0?it>0:He)}}return J.items=[],J.func=function(at){return at.sortid<qt?this.items.push(this.copyStack()):it>=0&&at.vol>it&&this.frustum.CheckShape(this.getmatrix(),at)&&this.items.push(this.copyStack(lt)),!0},this.scanVisible(J),{lst:J.items,complete:0===He}}mergeVisibles(Y,E){let J=0;const Ae=[];for(let Ce=0;Ce<Y.length&&J<E.length;++Ce){for(;J<E.length&&E[J].seqid<Y[Ce].seqid;)Ae.push(E[J++]);J<E.length&&E[J].seqid===Y[Ce].seqid&&(E[J].done&&(Y[Ce].done=!0),J++)}for(;J<E.length;)Ae.push(E[J++]);return Ae}collectShapes(Y){if(this.plain_shape)return[this.plain_shape];const E=[];for(let J=0;J<Y.length;++J){const Ae=Y[J],Ce=this.getNodeShape(Ae.nodeid);Ce&&(void 0===Ce._id?(Ce._id=E.length,E.push({id:Ce._id,shape:Ce,vol:this.nodes[Ae.nodeid].vol,refcnt:1,factor:1,ready:!1})):E[Ce._id].refcnt++,Ae.shape=E[Ce._id],Ae.factor&&Ae.factor>Ae.shape.factor&&(Ae.shape.factor=Ae.factor))}E.sort((J,Ae)=>Ae.vol*Ae.factor-J.vol*J.factor);for(let J=0;J<E.length;++J){const Ae=E[J];Ae.id=J,delete Ae.shape._id}for(let J=0;J<Y.length;++J){const Ae=Y[J];Ae.shape&&(Ae.shapeid=Ae.shape.id,delete Ae.shape)}return E}mergeShapesLists(Y,E){if(!Y)return E;for(let J=0;J<Y.length;++J){const Ae=Y[J];Ae.shape._geom=Ae.geom,delete Ae.geom,void 0!==Ae.geomZ&&(Ae.shape._geomZ=Ae.geomZ,delete Ae.geomZ)}for(let J=0;J<E.length;++J){const Ae=E[J];void 0!==Ae.shape._geom&&(Ae.geom=Ae.shape._geom,delete Ae.shape._geom),void 0!==Ae.shape._geomZ&&(Ae.geomZ=Ae.shape._geomZ,delete Ae.shape._geomZ)}for(let J=0;J<Y.length;++J){const Ae=Y[J];delete Ae.shape._geom,delete Ae.shape._geomZ}return E}buildShapes(Y,E,J){let Ae=0;const Ce=(new Date).getTime(),He={done:!1,shapes:0,faces:0,notusedshapes:0};for(let nt=0;nt<Y.length;++nt){const it=Y[nt];if(He.done)it.ready=!0;else if(it.ready||(it._typename="$$Shape$$",it.ready=!0,void 0===it.geom&&(it.geom=_e(it.shape),it.geom&&Ae++),it.nfaces=wt(it.geom)),He.shapes++,it.used||He.notusedshapes++,He.faces+=it.nfaces*it.refcnt,He.faces>=E)He.done=!0;else if(Ae>.01*Y.length&&void 0!==J&&(new Date).getTime()-Ce>J)return He}return He.done=!0,He}static formatServerElement(Y){Y.kind=2,Y.vis=2;const E=Y.matr;if(delete Y.matr,!E?.length)return Y;if(16===E.length)Y.matrix=E;else{const J=Y.matrix=new Array(16);J.fill(0),J[0]=J[5]=J[10]=J[15]=1,3===E.length?(J[12]=E[0],J[13]=E[1],J[14]=E[2]):4===E.length?(J[0]=E[0],J[5]=E[1],J[10]=E[2],J[15]=E[3]):9===E.length?(J[0]=E[0],J[4]=E[1],J[8]=E[2],J[1]=E[3],J[5]=E[4],J[9]=E[5],J[2]=E[6],J[6]=E[7],J[10]=E[8]):console.error(`wrong number of elements ${E.length} in the matrix`)}return Y}}function ai(Ue){let Y=Ue.getAttribute("position").array,E=Ue.getAttribute("normal").array;const J=Ue.getIndex();if(J){const it=J.array,lt=Ue.drawRange.start;let qt=Ue.drawRange.count;lt+qt>it.length&&(qt=it.length-lt);const at=new Float32Array(3*qt),Jt=new Float32Array(3*qt);for(let tn=0;tn<qt;++tn){const An=it[lt+tn];(An<0||3*An>=Y.length)&&console.log(`strange index ${3*An} totallen = ${Y.length}`),at[3*tn]=Y[3*An],at[3*tn+1]=Y[3*An+1],at[3*tn+2]=Y[3*An+2],Jt[3*tn]=E[3*An],Jt[3*tn+1]=E[3*An+1],Jt[3*tn+2]=E[3*An+2]}Y=at,E=Jt}const Ae=Y.length,Ce=new Float32Array(Ae),He=new Float32Array(Ae);for(let it=0,lt=0;it<Ae;it+=3)Ce[it]=Y[it+lt],Ce[it+1]=Y[it+1+lt],Ce[it+2]=-Y[it+2+lt],He[it]=E[it+lt],He[it+1]=E[it+1+lt],He[it+2]=-E[it+2+lt],lt+=3,6===lt&&(lt=-3);const nt=new be.LoY;return nt.setAttribute("position",new be.THS(Ce,3)),nt.setAttribute("normal",new be.THS(He,3)),nt}function kn(Ue,Y,E){if(!Ue?.geometry)return Y;if(Y||(Y=(new be.NRn).makeEmpty()),Ue.isInstancedMesh){const Ce=new be.kn4,He=(new be.NRn).makeEmpty();Ue.geometry.computeBoundingBox();for(let nt=0;nt<Ue.count;nt++)Ue.getMatrixAt(nt,Ce),He.copy(Ue.geometry.boundingBox).applyMatrix4(Ce),Y.union(He);return Y}E||Ue.updateWorldMatrix(!1,!1);const J=new be.Pq0,Ae=Ue.geometry.attributes?.position;if(void 0!==Ae)for(let Ce=0,He=Ae.count;Ce<He;Ce++)J.fromBufferAttribute(Ae,Ce),E||J.applyMatrix4(Ue.matrixWorld),Y.expandByPoint(J);return Y}function Rn(Ue){Ue&&((0,v.isFunc)(Ue.geom?.dispose)&&Ue.geom.dispose(),(0,v.isFunc)(Ue.geomZ?.dispose)&&Ue.geomZ.dispose(),delete Ue.geom,delete Ue.geomZ)}function ei(Ue,Y,E,J){const Ae=new be.tBo;function Ce(lt){lt&&lt.traverse(qt=>{qt.renderOrder=qt.defaultOrder||0,qt.material&&(qt.material.depthWrite=!0)})}function He(lt,qt,at){if(lt.children)for(let Jt=0;Jt<lt.children.length;++Jt){const tn=lt.children[Jt];tn.$jsroot_order===qt?tn.material&&(tn.material.transparent?(tn.material.depthWrite=!1,at.push(tn)):Ce(tn)):(void 0===lt.$jsroot_depth||lt.$jsroot_depth<qt)&&He(tn,qt,at)}}E&&"dflt"!==E?function it(lt,qt,at,Jt){const tn=[];let An=!1;if(He(lt,qt,tn),tn.length){if(at===Jt)for(let ze=0;ze<tn.length;++ze)tn[ze].renderOrder=at;else An=function nt(lt,qt,at){if(lt.length>1e3){for(let An=0;An<lt.length;++An)lt[An].renderOrder=(qt+at)/2;return!1}const Jt=new be.Pq0;for(let An=0;An<lt.length;++An){const ze=lt[An];let $e=ze.$jsroot_box3;if($e||(ze.$jsroot_box3=$e=kn(ze)),"size"===E){const Ot=$e.getSize(new be.Pq0);ze.$jsroot_distance=Ot.x*Ot.y*Ot.z;continue}if("pnt"===E){ze.$jsroot_distance=Y.distanceTo($e.getCenter(Jt));continue}let ut=Math.min(Y.distanceTo($e.min),Y.distanceTo($e.max));const bt=new be.Pq0($e.min.x,$e.min.y,$e.max.z);ut=Math.min(ut,Y.distanceTo(bt)),bt.set($e.min.x,$e.max.y,$e.min.z),ut=Math.min(ut,Y.distanceTo(bt)),bt.set($e.max.x,$e.min.y,$e.min.z),ut=Math.min(ut,Y.distanceTo(bt)),bt.set($e.max.x,$e.max.y,$e.min.z),ut=Math.min(ut,Y.distanceTo(bt)),bt.set($e.max.x,$e.min.y,$e.max.z),ut=Math.min(ut,Y.distanceTo(bt)),bt.set($e.min.x,$e.max.y,$e.max.z),ut=Math.min(ut,Y.distanceTo(bt)),ze.$jsroot_distance=ut}lt.sort((An,ze)=>An.$jsroot_distance-ze.$jsroot_distance);const tn=new Array(lt.length);for(let An=0;An<lt.length;++An)lt[An].$jsroot_index=An,tn[An]=lt[An];if("ray"===E)for(let An=lt.length-1;An>=0;--An){const ze=lt[An];let ut,bt=ze.$jsroot_box3.getCenter(Jt);for(let Ot=0;Ot<2;++Ot){bt.sub(Y).normalize(),Ae.set(Y,bt),ut=Ae.intersectObjects(lt,!1)||[];const _n=[];for(let rn=0;rn<ut.length;++rn)_n.indexOf(ut[rn].object)<0&&_n.push(ut[rn].object);if(ut=_n,ut.indexOf(ze)<0&&Ot>0&&console.log(`MISS ${J?.resolveStack(ze.stack)?.name}`),ut.indexOf(ze)>=0||Ot>0)break;const en=ze.geometry.attributes.position.array;bt=new be.Pq0((en[0]+en[3]+en[6])/3,(en[1]+en[4]+en[7])/3,(en[2]+en[5]+en[8])/3),bt.applyMatrix4(ze.matrixWorld)}for(let Ot=0;Ot<ut.length-1;++Ot){const en=ut[Ot+1],rn=ut[Ot].$jsroot_index,Tn=en.$jsroot_index;if(!(rn<Tn)){for(let In=Tn;In<rn;++In)tn[In]=tn[In+1],tn[In].$jsroot_index=In;tn[rn]=en,en.$jsroot_index=rn}}}for(let An=0;An<tn.length;++An)tn[An].renderOrder=Math.round(at-(An+1)/(tn.length+1)*(at-qt)),delete tn[An].$jsroot_index,delete tn[An].$jsroot_distance;return!0}(tn,at,Jt),An||(at=Jt=(at+Jt)/2);for(let ze=0;ze<tn.length;++ze){let ut=at,bt=Jt;An&&(bt=tn[ze].renderOrder,ut=bt-(Jt-at)/(tn.length+2)),it(tn[ze].parent,qt+1,ut,bt)}}}(Ue,0,1,1e6):Ce(Ue)}function Yi(Ue){switch(Ue._typename){case G:return"img_geoarb8";case D:return"img_geocone";case x:return"img_geoconeseg";case ge:return"img_geocomposite";case P:return"img_geotube";case w:return"img_geotubeseg";case N:return"img_geopara";case O:return"img_geoparab";case H:return"img_geopcon";case X:return"img_geopgon";case ie:return"img_geoassembly";case z:return"img_geosphere";case m:return"img_geotorus";case g:return"img_geotrd1";case C:return"img_geotrd2";case I:return"img_geoxtru";case A:return"img_geotrap";case R:return"img_geogtra";case k:return"img_geoeltu";case ee:return"img_geohype";case b:return"img_geoctub"}return"img_geotube"}},6856:(Gr,xt,Te)=>{"use strict";Te.d(xt,{TB:()=>Qe,fm:()=>Re,iF:()=>ot,rb:()=>xe.rb});var be=Te(5774),v=Te(4186),V=Te(3324),Le=Te(165),xe=Te(2481),Je=Te(5460);function ot(Ie,L){return Ie<.5?L?"%S.%L":"%H:%M:%S.%L":Ie<30?L?"%Mm%S":"%H:%M:%S":(Ie/=60)<30?L?"%Hh%M":"%d/%m %H:%M":(Ie/=60)<12?L?"%d-%Hh":"%d/%m/%y %Hh":(Ie/=24)<15.218425?L?"%d/%m":"%d/%m/%y":(Ie/=30.43685)<6?"%d/%m/%y":(Ie/=12)<2?L?"%m/%y":"%d/%m/%y":"%Y"}const Re={initAxisPainter(){this.name="yaxis",this.kind=xe.UV,this.func=null,this.order=0,this.full_min=0,this.full_max=1,this.scale_min=0,this.scale_max=1,this.ticks=[]},cleanupAxisPainter(){this.ticks=[],delete this.format,delete this.func,delete this.tfunc1,delete this.tfunc2,delete this.gr},assignFrameMembers(Ie,L){Ie[`gr${L}`]=this.gr,Ie[`log${L}`]=this.log,Ie[`scale_${L}min`]=this.scale_min,Ie[`scale_${L}max`]=this.scale_max},convertDate(Ie){return new Date(this.timeoffset+1e3*Ie)},revertPoint(Ie){const L=this.func.invert(Ie);return this.kind===xe.Yu?(L-this.timeoffset)/1e3:L},formatTime(Ie,L){return L?this.tfunc1(Ie):this.tfunc2(Ie)},formatLog(Ie,L,he){const re=parseFloat(Ie),fe=Math.round(re);if(!L)return fe===re&&Math.abs(fe)<1e9?fe.toString():(0,Le.lg)(re,he||v.gStyle.fStatFormat);if(re<=0)return null;let de=Math.log10(re);const pe=this.logbase;return 10!==pe&&(de/=Math.log10(pe)),this.moreloglabels||Math.abs(de-Math.round(de))<.001?this.noexp||2===L?Math.abs(pe-Math.E)<.001?(0,Le.lg)(re,he||v.gStyle.fStatFormat):re.toFixed(de<0?Math.round(.5-de):0):this.formatExp(pe,Math.floor(de+.01),re):null},formatNormal(Ie,L,he){let re=parseFloat(Ie);if(L&&this.order&&(re/=Math.pow(10,this.order)),v.gStyle.fStripDecimals&&re===Math.round(re))return Math.abs(re)<1e9?re.toFixed(0):re.toExponential(4);if(L){if(this.ndig>10)return re.toExponential(this.ndig-11);let fe=re.toFixed(this.ndig);const de=fe.indexOf(".");if(de>0&&v.settings.StripAxisLabels)for(;fe.length>=de&&("0"===fe[fe.length-1]||"."===fe[fe.length-1]);)fe=fe.slice(0,fe.length-1);return fe}return(0,Le.lg)(re,he||v.gStyle.fStatFormat)},formatExp(Ie,L,he){let re="";const fe=Math.abs(Ie-Math.E)<.001?"e":Ie.toString();if(he){if(he=Math.round(he/Math.pow(Ie,L)),v.settings.StripAxisLabels){if(0===L)return he.toString();if(1===L&&1===he)return fe}1!==he&&(re=he.toString()+(v.settings.Latex?"#times":"x"))}if(re+=fe,v.settings.Latex>v.constants.Latex.Symbols)return re+`^{${L}}`;const de={0:"\u2070",1:"\xb9",2:"\xb2",3:"\xb3",4:"\u2074",5:"\u2075",6:"\u2076",7:"\u2077",8:"\u2078",9:"\u2079","-":"\u207b"},pe=L.toString();for(let ce=0;ce<pe.length;++ce)re+=de[pe[ce]];return re},axisAsText(Ie,L){return this.kind===xe.Yu&&(Ie=this.convertDate(Ie)),this.format?this.format(Ie,!1,L):Ie.toPrecision(4)},poduceLogTicks(Ie,L){const he=fe=>{let de=0,pe=0;for(let G=1;G<fe.length;++G){const D=fe[G]-fe[G-1];de+=D,pe+=D**2}const ce=de/(fe.length-1),K=pe/(fe.length-1)-ce**2;return K<=0||!(Math.abs(ce)<1e-100)&&Math.sqrt(K)/ce<1e-6};let re=Ie.ticks(L);for(;L>4&&he(re);)L=Math.round(.8*L),re=Ie.ticks(L);if(L<5&&he(re)&&this.logbase&&10!==this.logbase){const fe=[];re.forEach(de=>{const pe=Math.log10(de)/Math.log10(this.logbase);Math.abs(Math.round(pe)-pe)<.01&&fe.push(de)}),fe.length>0&&(re=fe)}return re},produceTicks(Ie,L){if(!this.noticksopt){const fe=Ie*(L||1);if(this.log)return this.poduceLogTicks(this.func,fe);const de=this.func.domain(),pe=G=>G.length<=fe||!(G.length>fe+1)&&(G[0]===de[0]||G[fe]===de[1]),ce=this.func.ticks(fe);if(L||pe(ce))return ce;const K=this.func.ticks(Math.round(.7*fe));return K.length>2&&pe(K)?K:ce}const he=this.func.domain(),re=[];L&&(Ie=(Ie-1)*L);for(let fe=0;fe<=Ie;++fe)re.push((he[0]*(Ie-fe)+he[1]*fe)/Ie);return re},analyzeWheelEvent(Ie,L,he,re){he||(he={});let fe=0,de=1,pe=1;if("dleft"in he&&(de=he.dleft,fe=1),"dright"in he&&(pe=he.dright,fe=1),he.delta?fe=he.delta:Ie&&(fe=Ie.wheelDelta?-Ie.wheelDelta:Ie.deltaY||Ie.detail),!fe||re&&he.ignore)return;fe=fe<0?-.2:.2,de*=fe,pe*=fe;const ce=he.min=this.scale_min,K=he.max=this.scale_max,G=this.full_min,D=this.full_max;if(he.min===he.max&&fe<0&&(he.min=G,he.max=D),!(he.min>=he.max)){if(he.reverse&&(L=1-L),L>0&&L<1){if(this.log){let x=he.min>0?Math.log10(he.max/he.min):2;x>10?x=10:x<.01&&(x=.01),he.min=he.min/Math.pow(10,x*de*L),he.max=he.max*Math.pow(10,x*pe*(1-L))}else if(de!==-pe||he.reverse){let x=he.max-he.min,P=x;de>0&&(x=1.001*x/(1-de)),he.min+=-de*L*x,pe>0&&(P=1.001*P/(1-pe)),he.max-=-pe*(1-L)*P}else{let x=(he.max-he.min)*pe*L;Math.round(he.max)===he.max&&Math.round(he.min)===he.min&&Math.abs(x)>1&&(x=Math.round(x)),he.min+x<G?x=G-he.min:he.max+x>D&&(x=D-he.max),0!==x?(he.min+=x,he.max+=x):(delete he.min,delete he.max)}he.min>=he.max?he.min=he.max=void 0:de!==pe?(he.min<G&&ce===G||he.max>D&&K===D)&&(he.min=he.max=void 0):(he.min<G&&(he.min=G),he.max>D&&(he.max=D))}else he.min=he.max=void 0;return he.changed=void 0!==he.min&&void 0!==he.max,he}}};class Qe extends xe.JW{constructor(L,he,re){super(L,he),this.is_gaxis=he?._typename===v.clTGaxis,Object.assign(this,Re),this.initAxisPainter(),this.embedded=re,this.invert_side=!1,this.lbls_both_sides=!1}cleanup(){this.cleanupAxisPainter(),super.cleanup()}getAxisType(){return v.clTAxis}configureAxis(L,he,re,fe,de,pe,ce,K){this.name=L,this.full_min=he,this.full_max=re,this.kind=xe.UV,this.vertical=pe,this.log=K.log||0,this.noexp_changed=K.noexp_changed,this.symlog=K.symlog||!1,this.reverse=K.reverse||!1,this.swap_side=K.swap_side||!1,this.fixed_ticks=K.fixed_ticks||null,this.maxTickSize=K.maxTickSize||0;const G=this.getObject();if(K.time_scale||G.fTimeDisplay?(this.kind=xe.Yu,this.timeoffset=function st(Ie){if(!Ie)return 7889184e5;const he=Ie.fTimeFormat.indexOf("%F");if(he<0)return 1e3*v.gStyle.fTimeOffset;let re=Ie.fTimeFormat.slice(he+2);if(0===re.indexOf("1995-01-01 00:00:00s0"))return 7889184e5;if("0"===re||""===re)return 0;const fe=(b,g,C)=>{const N=re.indexOf(b);if(N<0)return g;const O=parseInt(re.slice(0,N));return re=re.slice(N+1),!Number.isInteger(O)||O<g||O>C?g:O},de=fe("-",1900,2900),pe=fe("-",1,12)-1,ce=fe(" ",1,31),K=fe(":",0,23),G=fe(":",0,59),D=fe("s",0,59),x=fe(" ",0,999);let w=new Date(Date.UTC(de,pe,ce,K,G,D,x)).getTime();if(re=re.toUpperCase(),0===re.indexOf("GMT")&&(re=re.slice(4).trim(),re.length>3)){let b=0,g=1e3;"-"===re[0]&&(b=1,g=-1e3),w-=g*(3600*parseInt(re.slice(b,b+2))+60*parseInt(re.slice(b+2,b+4)))}return w}(G),this.timegmt=function Ke(Ie){const L=Ie?.fTimeFormat??"";return L.indexOf("gmt")>0||L.indexOf("GMT")>0}(G)):this.kind=K.axis_func?xe.Z_:G.fLabels?xe.ei:xe.UV,this.kind===xe.Yu)this.func=(0,V.w7)().domain([this.convertDate(fe),this.convertDate(de)]);else if(this.log){if(this.logbase=1===this.log||10===this.log?10:3===this.log?Math.E:Math.round(this.log),de<=0&&(de=1),fe<=0&&G&&!K.logcheckmin)for(let P=0;P<G.fNbins&&!((fe=Math.max(fe,G.GetBinLowEdge(P+1)))>0);++P);fe<=0&&K.log_min_nz&&(fe=this.log_min_nz=K.log_min_nz),(fe<=0||fe>=de)&&(fe=de*(K.logminfactor||1e-4)),this.func=this.kind===xe.Z_?this.createFuncHandle(K.axis_func,this.logbase,fe,de):(0,V.ZE)().base(this.logbase).domain([fe,de])}else if(this.symlog){let P=Math.max(Math.abs(fe),Math.abs(de));Number.isInteger(this.symlog)&&this.symlog>0?P*=Math.pow(10,-1*this.symlog):P*=.01,this.func=(0,V.aX)().constant(P).domain([fe,de])}else this.func=this.kind===xe.Z_?this.createFuncHandle(K.axis_func,0,fe,de):(0,V.m4)().domain([fe,de]);if(this.vertical^this.reverse){const P=ce[0];ce[0]=ce[1],ce[1]=P}this.func.range(ce),this.scale_min=fe,this.scale_max=de,this.gr=this.kind===xe.Yu?P=>this.func(this.convertDate(P)):this.log?P=>P<this.scale_min?this.vertical?this.func.range()[0]+5:-5:this.func(P):this.func,delete this.format;let D=508;this.is_gaxis?D=G.fNdiv:G&&(D=G.fNdivisions?Math.max(G.fNdivisions,4):0),this.nticks=D%100,this.nticks2=(D%1e4-this.nticks)/100,this.nticks3=Math.floor(D/1e4),G&&!this.is_gaxis&&this.nticks>20&&(this.nticks=20);let x=Math.abs(this.func.range()[1]-this.func.range()[0]);if(x<=0&&(x=100),this.kind===xe.Yu){this.nticks>8&&(this.nticks=8);const P=this.scale_max-this.scale_min,w=G.fTimeFormat.indexOf("%F"),b=ot(P/x,!1);let g=w>=0?G.fTimeFormat.slice(0,w):G.fTimeFormat;(!g||P<.1*(this.full_max-this.full_min))&&(g=ot(P/this.nticks,!0)),this.tfunc1=this.tfunc2=this.timegmt?(0,V.aL)(g):(0,V.DC)(g),b!==g&&(this.tfunc2=this.timegmt?(0,V.aL)(b):(0,V.DC)(b)),this.format=this.formatTime}else if(this.log)this.nticks2>1&&(this.nticks*=this.nticks2,this.nticks2=1),this.noexp=G?.TestBit(xe.rb.kNoExponent),this.scale_max<300&&this.scale_min>.3&&!this.noexp_changed&&(this.noexp=!0),this.moreloglabels=G?.TestBit(xe.rb.kMoreLogLabels),this.format=this.formatLog;else if(this.kind===xe.ei){this.nticks=50;const P=this.scale_max-this.scale_min;this.nticks>P&&(this.nticks=Math.round(P)),this.regular_labels=!0,G&&G.fNbins&&G.fLabels&&(G.fNbins!==Math.round(G.fXmax-G.fXmin)||0!==G.fXmin||G.fXmax!==G.fNbins)&&(this.regular_labels=!1),this.nticks2=1,this.format=this.formatLabels}else this.order=0,this.ndig=0,this.format=this.formatNormal}getScaleMin(){return this.func?.domain()[0]??0}getScaleMax(){return this.func?.domain()[1]??0}formatLabels(L){const he=this.getObject();let re=parseFloat(L);if(re=this.regular_labels?Math.floor(re):Math.round((re-he.fXmin)/(he.fXmax-he.fXmin)*he.fNbins),re<0||re>=he.fNbins)return null;for(let fe=0;fe<he.fLabels.arr.length;++fe){const de=he.fLabels.arr[fe];if(de.fUniqueID===re+1)return de.fString}return null}createTicks(L,he,re,fe){re&&this.nticks&&this.kind===xe.UV&&(this.noticksopt=!0);const de={painter:this,nminor:0,nmiddle:0,nmajor:0,func:this.func,minor:[],middle:[],major:[]};let pe=[];if(this.fixed_ticks)this.fixed_ticks.forEach(ce=>{ce>=this.scale_min&&ce<=this.scale_max&&pe.push(ce)});else if(this.kind===xe.ei){de.lbl_pos=[];const ce=this.getObject();for(let K=0;K<=ce.fNbins;++K){const G=this.regular_labels?K:ce.fXmin+K/ce.fNbins*(ce.fXmax-ce.fXmin);G>=this.scale_min&&G<=this.scale_max&&(de.lbl_pos.push(G),pe.push(G))}}else pe=this.produceTicks(this.nticks);if(de.minor=de.middle=de.major=pe,L){const ce=de.major,K=1e-5*(this.scale_max-this.scale_min);return ce[0]>this.scale_min+K&&ce.unshift(this.scale_min),ce[ce.length-1]<this.scale_max-K&&ce.push(this.scale_max),ce}if(this.nticks2>1&&(!this.log||10===this.logbase)&&!this.fixed_ticks){de.minor=de.middle=this.produceTicks(de.major.length,this.nticks2);const ce=Math.abs(this.func.range()[1]-this.func.range()[0]);de.middle.length<=de.major.length||de.middle.length>ce/3.5?de.minor=de.middle=de.major:this.nticks3>1&&!this.log&&(de.minor=this.produceTicks(de.middle.length,this.nticks3),(de.minor.length<=de.middle.length||de.minor.length>ce/1.7)&&(de.minor=de.middle))}if(de.reset=function(){this.nminor=this.nmiddle=this.nmajor=0},de.next=function(ce){return!(this.nminor>=this.minor.length||(this.tick=this.minor[this.nminor++],this.grpos=this.func(this.tick),ce&&(this.grpos=Math.round(this.grpos)),this.kind=3,this.nmiddle<this.middle.length&&Math.abs(this.grpos-this.func(this.middle[this.nmiddle]))<1&&(this.nmiddle++,this.kind=2),this.nmajor<this.major.length&&Math.abs(this.grpos-this.func(this.major[this.nmajor]))<1&&(this.nmajor++,this.kind=1),0))},de.last_major=function(){return 1===this.kind&&this.nmajor===this.major.length},de.next_major_grpos=function(){return this.nmajor>=this.major.length?null:this.func(this.major[this.nmajor])},de.get_modifier=function(){return this.painter.findLabelModifier(this.painter.getObject(),this.nmajor-1,this.major)},this.order=0,this.ndig=0,(this.kind===xe.UV||this.kind===xe.Z_)&&!this.log&&de.major.length>0){let ce=0,K=0,G=!1;if(!he){const w=Math.max(Math.abs(de.major[0]),Math.abs(de.major[de.major.length-1])),b=Math.min(Math.abs(de.major[0]),Math.abs(de.major[de.major.length-1])),g=w>0?3*Math.round(Math.log10(w)/3):0,C=b>0?3*Math.round(Math.log10(b)/3):0;G=w<2e4,(w||b)&&(ce=Math.max(g,C)+3,K=Math.min(g,C)-3)}let D=0,x=this.ndig,P=1e10;for(let w=K;w<=ce;w+=3){if(G&&3===w)continue;this.order=w,this.ndig=0;let b=[],g=0,C=0;for(;g<de.major.length;){const N=this.format(de.major[g],!0);if(b.indexOf(N)<0){b.push(N);const O=N.indexOf(".");!w&&!he&&(O>v.gStyle.fAxisMaxDigits||O<0&&N.length>v.gStyle.fAxisMaxDigits)&&(C+=1e10,G=!1),C+=N.length,g++}else{if(++this.ndig>15)break;b=[],g=0,C=0}}!w&&this.ndig<4&&(C-=2*de.major.length+3),C<P&&(P=C,D=this.order,x=this.ndig)}this.order=D,this.ndig=x,fe&&(this.order&&console.warn(`Axis painter - integer labels are configured, but axis order ${this.order} is preferable`),this.ndig&&console.warn(`Axis painter - integer labels are configured, but ${this.ndig} decimal digits are required`),this.ndig=0,this.order=0)}return de}isCenteredLabels(){return this.kind===xe.ei||!this.log&&this.getObject()?.TestBit(xe.rb.kCenterLabels)}addTitleDrag(L,he,re,fe,de){if(!v.settings.MoveResize||this.isBatchMode())return;let ce,K,G,D,x,P,w,pe=null;const b=(0,V.$E)().subject(Object);b.on("start",g=>{g.sourceEvent.preventDefault(),g.sourceEvent.stopPropagation();const C=L.node().getBBox(),N=he?C.height:C.width;G=ce=L.property("shift_x"),D=K=L.property("shift_y"),x=he?ce>0:K>0,P=he?[de,de/2,0]:[0,de/2,de];const O=he?-N/2:N/2;"middle"===this.title_align?(P[0]+=O,P[2]-=O):"begin"===this.title_align?(P[1]-=O,P[2]-=2*O):(P[0]+=2*O,P[1]+=O),w=this.titleCenter?1:fe^this.titleOpposite?0:2,P[w]=he?K:ce,pe=L.append("rect").attr("x",C.x).attr("y",C.y).attr("width",C.width).attr("height",C.height).style("cursor","move").call(Le.Ru,!0)}).on("drag",g=>{if(!pe)return;g.sourceEvent.preventDefault(),g.sourceEvent.stopPropagation(),ce+=g.dx,K+=g.dy;let C,N,O=0;const H=he?K:ce;for(let X=1;X<3;++X)Math.abs(H-P[X])<Math.abs(H-P[O])&&(O=X);he?(C=ce,N=P[O]):(N=K,C=P[O]),x===(he?C>0:N>0)&&(G=C,D=N,w=O,(0,Le.bk)(L,G,D))}).on("end",g=>{if(!pe)return;g.sourceEvent.preventDefault(),g.sourceEvent.stopPropagation(),L.property("shift_x",G).property("shift_y",D);const C=this.getObject(),N=this.source_axis,O=(X,ie)=>{C&&C.TestBit(X)!==ie&&C.InvertBit(X),N&&N.TestBit(X)!==ie&&N.InvertBit(X)};this.titleOffset=(he?G:D)/re;const H=this.titleOffset/this.offsetScaling/this.titleSize;C&&(C.fTitleOffset=H),N&&(N.fTitleOffset=H),1===w?(O(xe.rb.kCenterTitle,!0),this.titleCenter=!0,O(xe.rb.kOppositeTitle,!1),this.titleOpposite=!1):0===w?(O(xe.rb.kCenterTitle,!1),this.titleCenter=!1,O(xe.rb.kOppositeTitle,!0),this.titleOpposite=!0):(O(xe.rb.kCenterTitle,!1),this.titleCenter=!1,O(xe.rb.kOppositeTitle,!1),this.titleOpposite=!1),this.submitAxisExec(`SetTitleOffset(${H});;SetBit(${xe.rb.kCenterTitle},${this.titleCenter?1:0})`),pe.remove(),pe=null}),L.style("cursor","move").call(b)}setHistPainter(L,he){this.hist_painter=L,this.hist_axis=he}submitAxisExec(L,he){const re=this.hist_painter?.snapid;re&&this.hist_axis&&!he?this.submitCanvExec(L,`${re}#${this.hist_axis}`):this.is_gaxis&&this.submitCanvExec(L)}produceTicksPath(L,he,re,fe,de,pe){let ce="",K="";for(this.ticks=[];L.next(!0);){let G=Math.round(re/4),D=0;L.kind<3&&(G=Math.round(re/2)),1===L.kind&&(null!==this.format(L.tick,!0)&&(G=re),this.ticks.push(L.grpos)),fe>0?D=-G:he<0&&(D=-G,G=0),ce+=this.vertical?`M${G},${L.grpos}H${D}`:`M${L.grpos},${-G}V${-D}`,de&&(K+=this.vertical?`M${de-G},${L.grpos}H${de-D}`:`M${L.grpos},${de+G}V${de+D}`)}return pe?ce+K:""}findLabelModifier(L,he,re){if(!L.fModLabs)return null;for(let fe=0;fe<L.fModLabs.arr.length;++fe){const de=L.fModLabs.arr[fe];if(void 0!==de.fLabValue&&0===de.fLabNum){const pe=this.log?1e-6*re[he]:1e-6*(this.scale_max-this.scale_min);if(Math.abs(de.fLabValue-re[he])<pe)return de}if(de.fLabNum===he+1||de.fLabNum<0&&he===re.length+de.fLabNum)return de}return null}drawLabels(L,he,re,fe,de,pe,ce,K,G,D,x,P){var w=this;return(0,be.A)(function*(){const b=w.isCenteredLabels(),g=he.TestBit(xe.rb.kLabelsVert),C=[L.append("svg:g").attr("class","axis_labels")],N=de.lbl_pos||de.major,O=v.gStyle.AxisTiltAngle??25;let H=1,X=0,ie=0,z=!1,m=!1,I=0,A=0;function R(k){const ee=this.result_width;if(I=Math.max(I,ee),ee&&(!k.vertical&&!g||k.vertical&&g)&&!k.log){let ve=.45*this.gap_before+.45*this.gap_after;this.gap_before?this.gap_after||(ve=.9*this.gap_before):ve=.9*this.gap_after,H=Math.min(H,ve/ee)}else k.vertical&&x&&this.normal_side&&x-K>20&&ee>x-K&&(H=Math.min(H,(x-K)/ee));H>1e-4&&H<.7&&!m&&!k.vertical&&!g&&X>5&&1===C.length&&!1===z&&(z=!0);let ge=H;z&&(A&&I?(ge=Math.min(1,.8*A/I),ge<H&&(z=0,ge=H)):ge*=3),(ge>1e-4&&ge<1||!1!==z)&&(ie=1/ge,k.scaleTextDrawing(ie,C[0]))}w.lbls_both_sides&&C.push(L.append("svg:g").attr("class","axis_labels").attr("transform",w.vertical?`translate(${re})`:`translate(0,${-fe})`)),P>0&&(A=P/Math.sin(O/180*Math.PI)-Math.tan(O/180*Math.PI));for(let k=0;k<C.length;++k){k>0&&(pe=-pe);let ee=0;const ge=w.vertical?-K*pe:K*pe+D*G;w.startTextDrawing(ce,"font",C[k]);for(let ve=0;ve<N.length;++ve){let Se=w.format(N[ve],!0);if(null===Se)continue;const De=w.findLabelModifier(he,ve,N);if(0===De?.fTextSize)continue;De&&(m=!0),De?.fLabText&&(Se=De.fLabText);const Xe={text:Se,color:ce.color,latex:1,draw_g:C[k],normal_side:0===k};let ct=Math.round(w.func(N[ve]));if(De?.fTextColor>0&&(Xe.color=w.getColor(De.fTextColor)),Xe.gap_before=ve>0?Math.abs(Math.round(ct-w.func(N[ve-1]))):0,Xe.gap_after=ve<N.length-1?Math.abs(Math.round(w.func(N[ve+1])-ct)):0,b){const $=Xe.gap_after||Xe.gap_before;if(ct=Math.round(ct-(w.vertical!==w.reverse?.5*$:-.5*$)),ct<-5||ct>(w.vertical?fe:re)+5)continue}if(X=Math.max(X,Se.length),w.vertical?(Xe.x=ge,Xe.y=ct,Xe.align=g?pe<0?23:20:pe<0?12:32):(Xe.x=ct,Xe.y=ge,Xe.align=g?pe<0?12:32:pe<0?20:23,!w.log||w.noexp||w.vertical||23!==Xe.align?Xe.align%10==3&&(Xe.y-=.1*ce.size):(Xe.align=21,Xe.y+=ce.size)),g?Xe.rotate=270:De&&-1!==De.fTextAngle&&(Xe.rotate=-De.fTextAngle),0===k&&(Xe.post_process=R),w.drawText(Xe),w.symlog&&ee&&ct!==ee&&(w.vertical&&!g||!w.vertical&&g)){const $=Math.abs(ct-ee);H=Math.min(H,1.1*$/ce.size)}ee=ct}if(w.order){let ve=0,Se=0;"xaxis"===w.name?(ve=v.gStyle.fXAxisExpXOffset||0,Se=v.gStyle.fXAxisExpYOffset||0):"yaxis"===w.name&&(ve=v.gStyle.fYAxisExpXOffset||0,Se=v.gStyle.fYAxisExpYOffset||0),ve&&(ve=Math.round(ve*(w.getPadPainter()?.getPadWidth()??0))),Se&&(Se=Math.round(Se*(w.getPadPainter()?.getPadHeight()??0))),w.drawText({color:ce.color,x:ve+(w.vertical?5*pe:re+5),y:Se+(w.has_obstacle?ge:w.vertical?-3:-3*pe),align:w.vertical?pe<0?30:10:w.has_obstacle^pe<0?13:10,latex:1,text:"#times"+w.formatExp(10,w.order),draw_g:C[k]})}}return w.finishTextDrawing(C[0],!0).then(()=>{if(C.length>1)return ie&&w.scaleTextDrawing(ie,C[1]),w.finishTextDrawing(C[1],!0)}).then(()=>(z&&C[0].selectAll("text").each(function(){const k=(0,V.Lt)(this),ee=k.attr("transform");k.attr("transform",`${ee} rotate(${O})`).style("text-anchor","start")}),I))})()}extractDrawAttributes(L,he,re){const fe=this.getObject();let de=this.getPadPainter();fe.$use_top_pad&&(de=de?.getPadPainter());const pe=de?.getPadWidth()||L||he/.8,ce=de?.getPadHeight()||L||re/.8,K=L||(this.vertical?re/ce*pe:he/pe*ce);let D,x,P,G=0;if(this.scalingSize=L||Math.max(Math.min(pe,ce),10),this.is_gaxis){const b=fe.fChopt.indexOf("S")>=0;this.optionUnlab=fe.fChopt.indexOf("U")>=0,this.optionMinus=fe.fChopt.indexOf("-")>=0||fe.TestBit(xe.rb.kTickMinus),this.optionPlus=fe.fChopt.indexOf("+")>=0||fe.TestBit(xe.rb.kTickPlus),this.optionNoopt=fe.fChopt.indexOf("N")>=0,this.optionInt=fe.fChopt.indexOf("I")>=0,this.optionText=fe.fChopt.indexOf("T")>=0,this.createAttLine({attr:fe}),G=b?fe.fTickSize:.03,D=this.getColor(fe.fTextColor),x=fe.fTextFont,P=fe.fLabelOffset,(this.vertical&&fe.fY1>fe.fY2&&!this.optionMinus||!this.vertical&&fe.fX1>fe.fX2)&&(P=-P)}else this.optionUnlab=!1,this.optionMinus=this.vertical^this.invert_side,this.optionPlus=!this.optionMinus,this.optionNoopt=!1,this.optionInt=!1,this.optionText=!1,this.createAttLine({color:fe.fAxisColor,width:1,style:1}),G=fe.fTickLength,D=this.getColor(fe.fTitleColor),x=fe.fTitleFont,P=fe.fLabelOffset;P+=this.vertical?.002:.005,this.kind===xe.ei&&(this.optionText=!0),this.optionNoexp=fe.TestBit(xe.rb.kNoExponent),this.ticksSize=Math.round(G*K),L&&this.ticksSize<0&&(this.ticksSize=-this.ticksSize),this.maxTickSize&&this.ticksSize>this.maxTickSize&&(this.ticksSize=this.maxTickSize),this.ticksColor=this.lineatt.color,this.ticksWidth=this.lineatt.width;const w=this.optionText?.66666:1;this.labelSize=Math.round(fe.fLabelSize<1?w*fe.fLabelSize*this.scalingSize:w*fe.fLabelSize),this.labelsOffset=Math.round(P*this.scalingSize),this.labelsFont=new Je.qg(fe.fLabelFont,this.labelSize,L),(this.labelSize<=0||Math.abs(fe.fLabelOffset)>1.1)&&(this.optionUnlab=!0),this.labelsFont.setColor(this.getColor(fe.fLabelColor)),this.fTitle=fe.fTitle,this.fTitle?(this.titleSize=fe.fTitleSize>=1?fe.fTitleSize:Math.round(fe.fTitleSize*this.scalingSize),this.titleFont=new Je.qg(x,this.titleSize,L),this.titleFont.setColor(D),this.offsetScaling=fe.fTitleSize>=1?1:(this.vertical?pe:ce)/this.scalingSize,this.titleOffset=fe.fTitleOffset,!this.titleOffset&&"x"===this.name[0]&&(this.titleOffset=v.gStyle.fXaxis.fTitleOffset),this.titleOffset*=this.titleSize*this.offsetScaling,this.titleCenter=fe.TestBit(xe.rb.kCenterTitle),this.titleOpposite=fe.TestBit(xe.rb.kOppositeTitle)):(delete this.titleSize,delete this.titleFont,delete this.offsetScaling,delete this.titleOffset,delete this.titleCenter,delete this.titleOpposite)}drawAxis(L,he,re,fe,de,pe,ce,K,G){var D=this;return(0,be.A)(function*(){const x=D.getObject(),P=D.swap_side||!1;let w=L,b=!0;de?D.invert_side&&(de=-de):de=0,D.extractDrawAttributes(void 0,he,re),D.is_gaxis&&(b=0!==x.fLineColor),D.lineatt.not_standard=!0,(!D.is_gaxis||"zaxis"===D.name)&&(w=L.selectChild(`.${D.name}_container`),w.empty()?w=L.append("svg:g").attr("class",`${D.name}_container`):w.selectAll("*").remove());let g="";b&&(g="M0,0"+(D.vertical?`v${re}`:`h${he}`),de&&(g+=D.vertical?`M${de},0v${re}`:`M0,${de}h${he}`)),w.attr("transform",fe);let C=1,N=0;D.optionPlus&&D.optionMinus?(C=1,N=1):D.optionMinus?C=P^D.vertical?1:-1:D.optionPlus&&(C=P^D.vertical?-1:1);const O=D.createTicks(!1,D.optionNoexp,D.optionNoopt,D.optionInt);g+=D.produceTicksPath(O,C,D.ticksSize,N,de,b&&!pe&&!D.disable_ticks),!pe&&g&&!D.lineatt.empty()&&w.append("svg:path").attr("d",g).call(D.lineatt.func);let H=0,X=0,ie=null,z=0;return(pe||D.optionUnlab?Promise.resolve(0):D.drawLabels(w,x,he,re,O,C,D.labelsFont,D.labelsOffset,D.ticksSize,N,ce,G)).then(I=>{if(z=I,v.settings.Zooming&&!D.disable_zooming&&!D.isBatchMode()){const ge=Math.max(D.labelsFont.size,5),ve=w.append("svg:rect").attr("class","axis_zoom").style("opacity","0").style("cursor","crosshair");if(D.vertical){const Se=(z||2*ge)+3;ve.attr("x",C>0?-Se:0).attr("y",0).attr("width",Se).attr("height",re)}else ve.attr("x",0).attr("y",C>0?0:-ge-3).attr("width",he).attr("height",ge+3)}if(D.position=0,K){const ge=w.node(),ve=D.getPadSvg().node();if((0,v.isFunc)(ge?.getBoundingClientRect)&&(0,v.isFunc)(ve?.getBoundingClientRect)){const Se=ge.getBoundingClientRect(),De=ve.getBoundingClientRect();D.position=Se.left-De.left}ge&&!ve&&console.warn("Why PAD element missing when search for position")}if(!D.fTitle||pe)return!0;ie=w.append("svg:g").attr("class","axis_title");let A=C;const R=x.TestBit(xe.rb.kRotateTitle)?-1:1;D.startTextDrawing(D.titleFont,"font",ie);const k=P^D.titleOpposite;return D.title_align=D.titleCenter?"middle":R<0^k?"begin":"end",D.vertical?(A*=-1.6,H=Math.round(A*D.titleOffset),X=Math.round(D.titleCenter?re/2:k?re:0),D.drawText({align:D.title_align+";middle",rotate:R<0?90:270,text:D.fTitle,color:D.titleFont.color,draw_g:ie})):(A*=1.6,H=Math.round(D.titleCenter?he/2:k?0:he),X=Math.round(A*D.titleOffset),D.drawText({align:D.title_align+";middle",rotate:R<0?180:0,text:D.fTitle,color:D.titleFont.color,draw_g:ie})),D.addTitleDrag(ie,D.vertical,A,P,D.vertical?re:he),D.finishTextDrawing(ie)}).then(()=>(ie&&(!D.titleOffset&&D.vertical&&z&&(H=Math.round(-C*(z+.7*D.offsetScaling*D.titleSize))),(0,Le.bk)(ie,H,X),ie.property("shift_x",H).property("shift_y",X)),D))})()}}},2725:(Gr,xt,Te)=>{"use strict";Te.r(xt),Te.d(xt,{TCanvasPainter:()=>re,TPadPainter:()=>Ke.jg,drawTFrame:()=>K,drawTPadSnapshot:()=>pe,ensureTCanvas:()=>fe});var be=Te(5774),v=Te(4186),V=Te(3324),Le=Te(9606),xe=Te(5619),Je=Te(2481),st=Te(1564),Ke=Te(9788);const ot=(0,v.BIT)(15),Re=(0,v.BIT)(17),Qe=(0,v.BIT)(18),Ie=(0,v.BIT)(19),L=(0,v.BIT)(23);function he(D,x,P){const w=new st.nc(D,x);return w.addToPadPrimitives(),"3d"===P&&(w.mode3d=!0),w.redraw()}class re extends Ke.jg{constructor(x,P){super(x,P,!0),this._websocket=null,this.tooltip_allowed=v.settings.Tooltip,null===x&&null===P&&(v.settings.SmallPad.width=20,v.settings.SmallPad.height=10)}cleanup(){this._changed_layout&&this.setLayoutKind("simple"),delete this._changed_layout,super.cleanup()}getLayoutKind(){const x=this.selectDom("origin");return(x.empty()?"":x.property("layout"))||"simple"}setLayoutKind(x,P){const w=this.selectDom("origin");w.empty()||(x||(x="simple"),w.property("layout",x),w.property("layout_selector","simple"!==x&&P?P:null),this._changed_layout="simple"!==x)}changeLayout(x,P){var w=this;return(0,be.A)(function*(){if(w.getLayoutKind()===x)return!0;const g=w.selectDom("origin"),C=g.select(".side_panel2"),N=[];let X,O=g.select(".side_panel"),H=w.selectDom();for(;H.node().firstChild;)N.push(H.node().removeChild(H.node().firstChild));if(O.empty()||(0,Je.tP)(O.node()),C.empty()||(0,Je.tP)(C.node()),w.setLayoutKind("simple"),g.html(""),"simple"===x){H=g;for(let ie=0;ie<N.length;++ie)H.node().appendChild(N[ie]);w.setLayoutKind(x),X=!0}else{const ie=new xe.ho(g.node(),x);void 0===P&&(P=0===x.indexOf("vert")?0:1),H=(0,V.Lt)(ie.getGridFrame(P)),H.classed("central_panel",!0).style("position","relative"),2===P?(O=(0,V.Lt)(ie.getGridFrame(0)),O.classed("side_panel2",!0).style("position","relative"),O=(0,V.Lt)(ie.getGridFrame(3)),O.classed("side_panel",!0).style("position","relative")):(O=(0,V.Lt)(ie.getGridFrame(1-P)),O.classed("side_panel",!0).style("position","relative"));for(let z=0;z<N.length;++z)H.node().appendChild(N[z]);w.setLayoutKind(x,".central_panel"),g.property("mdi",null)}return(0,Je.XR)(H.node(),X),!0})()}toggleProjection(x){var P=this;return(0,be.A)(function*(){if(delete P.proj_painter,x&&(P.proj_painter={X:!1,Y:!1}),(0,v.isFunc)(P.showUI5ProjectionArea))return P.showUI5ProjectionArea(x);let b,w="simple";switch(x){case"XY":w="projxy",b=2;break;case"X":case"bottom":w="vert2_31",b=0;break;case"Y":case"left":w="horiz2_13",b=1;break;case"top":w="vert2_13",b=1;break;case"right":w="horiz2_31",b=0}return P.changeLayout(w,b)})()}drawProjection(x,P,w){var b=this;return(0,be.A)(function*(){if(!b.proj_painter)return!1;if(void 0===w&&(w="hist"),x||(x="X"),!b.proj_painter[x]){b.proj_painter[x]="init";const g=(0,v.create)(v.clTCanvas),C=b.pad,N=b.getFramePainter();let O;return"X"===x?(g.fLeftMargin=C.fLeftMargin,g.fRightMargin=C.fRightMargin,g.fLogx=N.logx,g.fUxmin=N.logx?Math.log10(N.scale_xmin):N.scale_xmin,g.fUxmax=N.logx?Math.log10(N.scale_xmax):N.scale_xmax,O="fixframe"):"Y"===x&&(g.fBottomMargin=C.fBottomMargin,g.fTopMargin=C.fTopMargin,g.fLogx=N.logy,g.fUxmin=N.logy?Math.log10(N.scale_ymin):N.scale_ymin,g.fUxmax=N.logy?Math.log10(N.scale_ymax):N.scale_ymax,O="rotate"),g.fPrimitives.Add(P,w),((0,v.isFunc)(b.drawInUI5ProjectionArea)?b.drawInUI5ProjectionArea(g,O,x):b.drawInSidePanel(g,O,x)).then(X=>(b.proj_painter[x]=X,X))}return(0,v.isStr)(b.proj_painter[x])?(console.log("Not ready with first painting",x),!0):(b.proj_painter[x].getMainPainter()?.updateObject(P,w),b.proj_painter[x].redrawPad())})()}testUI5(){return!!this.use_openui&&(console.warn("full ui5 should be used - not loaded yet? Please check!!"),!0)}drawInSidePanel(x,P,w){var b=this;return(0,be.A)(function*(){const g="projxy"===b.getLayoutKind()&&"Y"===w?".side_panel2":".side_panel",C=b.selectDom("origin").select(g);return C.empty()?null:b.drawObject(C.node(),x,P)})()}showMessage(x){this.testUI5()||(0,Le.Rh)(x,7e3)}saveCanvasAsFile(x){const P=x.indexOf(".");this.createImage(x.slice(P+1)).then(w=>this.sendWebsocket(`SAVE:${x}:${w}`))}sendSaveCommand(x){this.sendWebsocket("PRODUCE:"+x)}submitMenuRequest(x,P,w){var b=this;return(0,be.A)(function*(){return new Promise(g=>{b._getmenu_callback=g,b.sendWebsocket("GETMENU:"+w)})})()}submitExec(x,P,w){if(!this._readonly&&x&&(w||(w=x.snapid),w&&(0,v.isStr)(w)&&P))return this.sendWebsocket(`OBJEXEC:${w}:${P}`)}sendWebsocket(x){return this._websocket?.canSend()?(this._websocket.send(x),!0):(console.warn(`DROP SEND: ${x}`),!1)}closeWebsocket(x){this._websocket&&(this._websocket.close(x),this._websocket.cleanup(),delete this._websocket)}useWebsocket(x){this.closeWebsocket(),this._websocket=x,this._websocket.setReceiver(this),this._websocket.connect()}websocketTimeout(x,P){if(!this._websocket)return;this._websocket._tmouts||(this._websocket._tmouts={});const w=this._websocket._tmouts[x];if(void 0===P)return void 0!==w;"reset"===P?w&&(clearTimeout(w),delete this._websocket._tmouts[x]):!w&&Number.isInteger(P)&&(this._websocket._tmouts[x]=setTimeout(()=>{delete this._websocket._tmouts[x]},P))}onWebsocketOpened(){}onWebsocketClosed(){this.embed_canvas||(0,Le.W4)()}onWebsocketMsg(x,P){if("CLOSE"===P)this.onWebsocketClosed(),this.closeWebsocket(!0);else if("SNAP6:"===P.slice(0,6)){const w=P.indexOf(":",6),b=P.slice(6,w),g=(0,v.parse)(P.slice(w+1));this.syncDraw(!0).then(()=>{this.snapid||this.resizeBrowser(g.fSnapshot.fWindowWidth,g.fSnapshot.fWindowHeight),!this.snapid&&(0,v.isFunc)(this.setFixedCanvasSize)&&(this._online_fixed_size=this.setFixedCanvasSize(g.fSnapshot.fCw,g.fSnapshot.fCh,g.fFixedSize))}).then(()=>this.redrawPadSnap(g)).then(()=>{this.completeCanvasSnapDrawing();let C=this.getWebPadOptions();C&&(C=":"+C),x.send(`READY6:${b}${C}`),this.confirmDraw()})}else if("MENU:"===P.slice(0,5)){const w=(0,v.parse)(P.slice(5));(0,v.isFunc)(this._getmenu_callback)&&(this._getmenu_callback(w),delete this._getmenu_callback)}else if("CMD:"===P.slice(0,4)){const w=(P=P.slice(4)).indexOf(":"),b=P.slice(0,w),g=P.slice(w+1),C=`REPLY:${b}:`;"SVG"===g||"PNG"===g||"JPEG"===g?this.createImage(g.toLowerCase()).then(N=>x.send(C+N)):(console.log(`Unrecognized command ${g}`),x.send(C))}else if("DXPROJ:"===P.slice(0,7)||"DYPROJ:"===P.slice(0,7)){const w=P[1],b=(0,v.parse)(P.slice(7));this.websocketTimeout(`proj${w}`,"reset"),this.drawProjection(w,b)}else if("CTRL:"===P.slice(0,5)){const w=(0,v.parse)(P.slice(5))||{};let b=!1;if(void 0!==w.title&&typeof document<"u"&&(document.title=w.title),w.x&&w.y&&typeof window<"u"&&(window.moveTo(w.x,w.y),b=!0),w.w&&w.h&&(this.resizeBrowser(Number.parseInt(w.w),Number.parseInt(w.h)),b=!0),w.cw&&w.ch&&(0,v.isFunc)(this.setFixedCanvasSize)&&(this._online_fixed_size=this.setFixedCanvasSize(Number.parseInt(w.cw),Number.parseInt(w.ch),!0),b=!0),["Menu","StatusBar","Editor","ToolBar","ToolTips"].forEach(C=>{void 0!==w[C]&&this.showSection(C,"1"===w[C])}),w.edit){const C=this.findSnap(w.edit);C&&this.showSection("Editor",!0).then(()=>this.producePadEvent("select",C.getPadPainter(),C))}w.winstate&&typeof window<"u"&&("iconify"===w.winstate?window.blur():window.focus()),b&&this.sendResized(!0)}else console.log(`unrecognized msg ${P}`)}sendResized(x){if(!this.pad||typeof window>"u")return;const P=this.getPadWidth(),w=this.getPadHeight(),b=window.screenLeft,g=window.screenTop,C=window.outerWidth,N=window.outerHeight,O=this._online_fixed_size?1:0;x||(x=P>0&&w>0&&(this.pad.fCw!==P||this.pad.fCh!==w))&&(this.pad.fCw=P,this.pad.fCh=w),x&&this.sendWebsocket(`RESIZED:${JSON.stringify([b,g,C,N,P,w,O])}`)}clickPadButton(x,P){return"ToggleGed"===x?this.activateGed(this,null,"toggle"):"ToggleStatus"===x?this.activateStatusBar("toggle"):super.clickPadButton(x,P)}hasEventStatus(){return!this.testUI5()&&(this.brlayout?this.brlayout.hasStatus():(0,xe.gZ)()?.hasStatusLine()??!1)}canStatusBar(){return this.testUI5()||this.brlayout||(0,xe.gZ)()}activateStatusBar(x){this.testUI5()||(this.brlayout?this.brlayout.createStatusLine(23,x):(0,xe.gZ)()?.createStatusLine(23,x),this.processChanges("sbits",this))}showCanvasStatus(...x){this.testUI5()||(this.brlayout||(0,xe.gZ)()?.brlayout)?.showStatus(...x)}hasGed(){return!this.testUI5()&&(this.brlayout?.hasContent()??!1)}removeGed(){this.testUI5()||(this.registerForPadEvents(null),this.ged_view&&(this.ged_view.getController().cleanupGed(),this.ged_view.destroy(),delete this.ged_view),this.brlayout?.deleteContent(!0),this.processChanges("sbits",this))}getUi5PanelData(){return{jsroot:{settings:v.settings,create:v.create,parse:v.parse,toJSON:v.toJSON,loadScript:v.loadScript,EAxisBits:Je.rb,getColorExec:Le.pp}}}activateGed(x,P,w){var b=this;return(0,be.A)(function*(){if(b.testUI5()||!b.brlayout)return!1;if(b.brlayout.hasContent())return"toggle"===w||!1===w?b.removeGed():x?.getPadPainter()?.selectObjectPainter(x),!0;if(!1===w)return!1;const g=b.brlayout.createBrowserBtns();return Le.IK.createSVG(g,Le.IK.diamand,15,"toggle fix-pos mode","browser").style("margin","3px").on("click",()=>b.brlayout.toggleKind("fix")),Le.IK.createSVG(g,Le.IK.circle,15,"toggle float mode","browser").style("margin","3px").on("click",()=>b.brlayout.toggleKind("float")),Le.IK.createSVG(g,Le.IK.cross,15,"delete GED","browser").style("margin","3px").on("click",()=>b.removeGed()),b.brlayout.setBrowserContent("<div class='jsroot_browser_hierarchy' id='ged_placeholder'>Loading GED ...</div>"),b.brlayout.setBrowserTitle("GED"),b.brlayout.toggleBrowserKind(P||"float"),new Promise(C=>{(0,Le.cA)().then(N=>{(0,V.Lt)("#ged_placeholder").text(""),N.ui.require(["sap/ui/model/json/JSONModel","sap/ui/core/mvc/XMLView"],(O,H)=>{const X=new O({handle:null});H.create({viewName:"rootui5.canv.view.Ged",viewData:b.getUi5PanelData("Ged")}).then(ie=>{ie.setModel(X),ie.placeAt("ged_placeholder"),b.ged_view=ie,b.registerForPadEvents(ie.getController().padEventsReceiver.bind(ie.getController())),x?.getPadPainter()?.selectObjectPainter(x),console.log("activate GED"),b.processChanges("sbits",b),C(!0)})})})})})()}showSection(x,P){var w=this;return(0,be.A)(function*(){if(w.testUI5())return!1;switch(x){case"Menu":case"ToolBar":break;case"StatusBar":w.activateStatusBar(P);break;case"Editor":return w.activateGed(w,null,!!P);case"ToolTips":w.setTooltipAllowed(P)}return!0})()}completeCanvasSnapDrawing(){this.pad&&(this.addPadInteractive(),typeof document<"u"&&!this.embed_canvas&&this._websocket&&(document.title=this.pad.fTitle),!this._all_sections_showed&&(this._all_sections_showed=!0,this.showSection("Menu",this.pad.TestBit(Re)),this.showSection("StatusBar",this.pad.TestBit(ot)),this.showSection("ToolBar",this.pad.TestBit(Qe)),this.showSection("Editor",this.pad.TestBit(Ie)),this.showSection("ToolTips",this.pad.TestBit(L)||this._highlight_connect)))}processHighlightConnect(x){if(!x||0===x.length||!this._highlight_connect||!this._websocket||this.doingDraw()||!this._websocket.canSend(2))return;const P=x[0]||x[1];if(!(P&&P.painter&&P.painter.snapid&&P.user_info))return;const w=P.painter.getPadPainter()||this;if(!w.snapid)return;const b=[w.snapid,P.painter.snapid,"0","0"];void 0!==P.user_info.binx&&void 0!==P.user_info.biny?(b[2]=P.user_info.binx.toString(),b[3]=P.user_info.biny.toString()):void 0!==P.user_info.bin&&(b[2]=P.user_info.bin.toString());const g=JSON.stringify(b);this._last_highlight_msg!==g&&(this._last_highlight_msg=g,this.sendWebsocket(`HIGHLIGHT:${g}`))}processChanges(x,P,w){if(!this._websocket||this._readonly||!this._websocket.canSend(2)||!(0,v.isStr)(x))return;let b="";switch(P||(P=this),x){case"sbits":b="STATUSBITS:"+this.getStatusBits();break;case"frame":case"zoom":(0,v.isFunc)(P.getWebPadOptions)||(P=P.getPadPainter()),(0,v.isFunc)(P.getWebPadOptions)&&(b="OPTIONS6:"+P.getWebPadOptions("only_this"));break;case"padpos":b="OPTIONS6:"+P.getWebPadOptions("with_subpads");break;case"drawopt":P.snapid&&(b="DRAWOPT:"+JSON.stringify([P.snapid.toString(),P.getDrawOpt()||""]));break;case"pave_moved":{const g=(0,Ke.O4)(P);g&&(b="PRIMIT6:"+(0,v.toJSON)(g));break}case"logx":case"logy":case"logz":{const g=P.getPadPainter();g?.snapid&&g?.pad&&(P=g,x=`exec:${"SetLog"+x[3]}(${g.pad["fLog"+x[3]]})`);break}}if(!b&&(0,v.isFunc)(P?.getSnapId)&&"exec:"===x.slice(0,5)){const g=P.getSnapId(w);g&&(b="PRIMIT6:"+(0,v.toJSON)({_typename:"TWebObjectOptions",snapid:g,opt:x.slice(5),fcust:"exec",fopt:[]}))}b?this._websocket.send(b):console.log(`Unprocessed changes ${x} for painter of ${P?.getObject()?._typename} subelem ${w}`)}selectActivePad(x,P,w){if(!this.snapid||!x)return;let b=null,g=!1;const C=x.matchObjectType(Ke.cw);x.snapid&&this._websocket&&(b={_typename:"TWebPadClick",padid:x.snapid.toString(),objid:"",x:-1,y:-1,dbl:!1}),!x.is_active_pad&&!C&&(g=!0,this.forEachPainterInPad(N=>N.drawActiveBorder(null,N===x),"pads")),void 0!==P?.snapid&&b&&(g=!0,b.objid=P.snapid.toString()),w&&b&&(g=!0,b.x=Math.round(w.x||0),b.y=Math.round(w.y||0),w.dbl&&(b.dbl=!0)),b&&(g||C)&&this.sendWebsocket("PADCLICKED:"+(0,v.toJSON)(b))}getStatusBits(){let x=0;return this.hasEventStatus()&&(x|=ot),this.hasGed()&&(x|=Ie),this.isTooltipAllowed()&&(x|=L),this.use_openui&&(x|=Re),x}produceJSON(){const x=this.getObject(),P=0===x.fFillStyle,w=[],b=[];P&&(x.fFillStyle=1001),this.forEachPainterInPad(C=>{const N=C.getMainPainter(),O=C.getFramePainter();if(!(0,v.isFunc)(N?.getHisto)||!(0,v.isFunc)(N?.getDimension))return;const H=N.getHisto(),X=N.getDimension();if(!H?.fXaxis)return;const ie=(z,m)=>{O?.zoomChangedInteractive(z)&&(w.push({axis:m,f:m.fFirst,l:m.fLast,b:m.fBits}),m.fFirst=N.getSelectIndex(z,"left",1),m.fLast=N.getSelectIndex(z,"right"),(m.fFirst>0||m.fLast<m.fNbins)!==m.TestBit(Je.rb.kAxisRange)&&m.InvertBit(Je.rb.kAxisRange))};ie("x",H.fXaxis),X>1&&ie("y",H.fYaxis),X>2&&ie("z",H.fZaxis),2===X&&O?.zoomChangedInteractive("z")&&(b.push({hist:H,min:H.fMinimum,max:H.fMaximum}),H.fMinimum=O.zoom_zmin??O.zmin,H.fMaximum=O.zoom_zmax??O.zmax)},"pads"),this.normal_canvas||this.forEachPainterInPad(C=>{if(C.isSecondary())return;const N=C.getObject();N?._typename&&x.fPrimitives.Add(N,C.getDrawOpt())},"objects");const g=(0,v.toJSON)(x);return P&&(x.fFillStyle=0),w.forEach(C=>{C.axis.fFirst=C.f,C.axis.fLast=C.l,C.axis.fBits=C.b}),b.forEach(C=>{C.hist.fMinimum=C.min,C.hist.fMaximum=C.max}),this.normal_canvas||x.fPrimitives.Clear(),g}resizeBrowser(x,P){!x||!P||this.isBatchMode()||this.embed_canvas||this.batch_mode||(v.browser.qt5&&x>100&&P>60&&(x-=3,P-=30),this._websocket?.resizeWindow(x,P))}static draw(x,P,w){return(0,be.A)(function*(){const b=!P;b&&(P=(0,v.create)(v.clTCanvas));const g=new re(x,P);if(g.checkSpecialsInPrimitives(P),!b&&P.fCw&&P.fCh&&!g.isBatchMode()){const C=g.selectDom().node().getBoundingClientRect();!C.height&&C.width>.1*P.fCw&&(g.selectDom().style("width",P.fCw+"px").style("height",P.fCh+"px"),g._fixed_size=!0)}return g.decodeOptions(w),g.normal_canvas=!b,g.createCanvasSvg(0),g.addPadButtons(),b&&w.indexOf("noframe")<0&&he(x,null),(0,Je.QD)({pp:g,active:!0}),g.drawPrimitives().then(()=>(g.addPadInteractive(),g.showPadButtons(),g))})()}}function fe(D,x){return de.apply(this,arguments)}function de(){return(de=(0,be.A)(function*(D,x){if(!D)return Promise.reject(Error("Painter not provided in ensureTCanvas"));const P=!1===x||"3d"===x?"noframe":"";return(D.getCanvSvg().empty()?re.draw(D.getDom(),null,P):Promise.resolve(!0)).then(()=>(!1!==x&&D.getFrameSvg().selectChild(".main_layer").empty()&&!D.getFramePainter()&&he(D.getDom(),null,x),D.addToPadPrimitives(),D))})).apply(this,arguments)}function pe(D,x){return ce.apply(this,arguments)}function ce(){return(ce=(0,be.A)(function*(D,x){const P=(0,v.create)(v.clTCanvas),w=new re(D,P);return w.normal_canvas=!1,w.addPadButtons(),w.syncDraw(!0).then(()=>w.redrawPadSnap(x)).then(()=>(w.confirmDraw(),w.showPadButtons(),w))})).apply(this,arguments)}function K(D,x,P){return G.apply(this,arguments)}function G(){return(G=(0,be.A)(function*(D,x,P){const w=new st.nc(D,x);return w.mode3d="3d"===P,fe(w,!1).then(()=>w.redraw())})).apply(this,arguments)}},1564:(Gr,xt,Te)=>{"use strict";Te.d(xt,{G_:()=>D,WJ:()=>G,nc:()=>P,qP:()=>re,wM:()=>x});var be=Te(5774),v=Te(4186),V=Te(3324),Le=Te(165),xe=Te(2481),Je=Te(9248),st=Te(6856),Ke=Te(5460),ot=Te(9646),Re=Te(9606);const Ie=3e-4;function L(w,b){if(!w)return;const g=w.getFramePainter();(0,v.isFunc)(g?.setTooltipEnabled)&&(g.setTooltipEnabled(b),g.processFrameTooltipEvent(null)),(0,v.isFunc)(w.control?.setTooltipEnabled)&&w.control.setTooltipEnabled(b)}function he(w,b){return w.$touch_arr??(0,V.D_)(w,b)}function re(w){switch(w){case 1:return(b,g)=>{const C=Math.PI/180,N=b/2*C,O=g*C,H=Math.sqrt(2),X=2*H/Math.PI,ie=Math.cos(O),z=Math.sqrt(1+ie*Math.cos(N));return{x:ie*Math.sin(N)*2*H/z/X/C,y:Math.sin(O)*H/z/X/C}};case 2:return(b,g)=>({x:b,y:Math.log(Math.tan((Math.PI/2+g/180*Math.PI)/2))});case 3:return(b,g)=>({x:b*Math.cos(g/180*Math.PI),y:g});case 4:return(b,g)=>({x:b*(2*Math.cos(2*g/180*Math.PI/3)-1),y:180*Math.sin(g/180*Math.PI/3)});case 5:return(b,g)=>{const C=g*Math.PI/180;let O,H,N=C;for(let X=0;X<100;X++){if(O=2*N+Math.sin(2*N)-Math.PI*Math.sin(C),H=4*Math.cos(N)**2,H<1e-20){N=C;break}if(N-=O/H,Math.abs(O/H)<1e-4)break}return{x:b*Math.cos(N),y:90*Math.sin(N)}}}}function fe(w){if(!(0,v.isFunc)(w?.getDimension)||1!==w.getDimension())return;const b=w.draw_content?w.hmin:w.ymin,g=w.draw_content?w.hmax:w.ymax;w.zoom_ymin!==w.zoom_ymax&&b!==g&&b<=w.zoom_ymin&&w.zoom_ymax<=g&&(w.zoom_ymin=w.zoom_ymax=0)}let de=null,pe="",ce=null;function K(w,b){return de&&ce===w&&pe===b}function G(w,b){if(!v.settings.MoveResize)return;const g=w,C=g.getPadPainter();if(C?._fast_drawing||C?.isBatchMode())return;function N(z,m){function I(A,R){const k="js_"+A.replace(/[-]/g,"_");let ee=z.selectChild("."+k);if(b.cleanup)return ee.remove();ee.empty()&&(ee=z.append("path").classed(k,!0)),ee.style("opacity",0).style("cursor",A).attr("d",R),m&&ee.call(m)}I("nw-resize","M2,2h15v-5h-20v20h5Z"),I("ne-resize",`M${b.width-2},2h-15v-5h20v20h-5 Z`),I("sw-resize",`M2,${b.height-2}h15v5h-20v-20h5Z`),I("se-resize",`M${b.width-2},${b.height-2}h-15v5h20v-20h-5Z`),b.no_change_x||(I("w-resize",`M-3,18h5v${Math.max(0,b.height-36)}h-5Z`),I("e-resize",`M${b.width+3},18h-5v${Math.max(0,b.height-36)}h5Z`)),b.no_change_y||(I("n-resize",`M18,-3v5h${Math.max(0,b.width-36)}v-5Z`),I("s-resize",`M18,${b.height+3}v-5h${Math.max(0,b.width-36)}v5Z`))}!1===C?.isEditable()&&(b.cleanup=!0),(0,v.isFunc)(b.getDrawG)||(b.getDrawG=()=>g?.draw_g);const O=(z,m,I,A)=>{ce=null,pe="",de&&(de.remove(),de=null);const R=b.getDrawG();if(!R)return!1;const k=b.x,ee=b.y;b.minwidth&&I<b.minwidth&&(I=b.minwidth),b.minheight&&A<b.minheight&&(A=b.minheight);const ge=I!==b.width||A!==b.height,ve=z!==k||m!==ee;if(b.x=z,b.y=m,b.width=I,b.height=A,b.no_transform||(0,Le.bk)(R,z,m),L(g,!0),N(R),(ge||ve)&&(ge&&(0,v.isFunc)(b.resize)&&b.resize(I,A),ve&&(0,v.isFunc)(b.move)&&b.move(z,m,z-k,m-ee),ge||ve)){if(b.obj){const Se=b.pad_rect??C.getPadRect();b.obj.fX1NDC=z/Se.width,b.obj.fX2NDC=(z+I)/Se.width,b.obj.fY1NDC=1-(m+A)/Se.height,b.obj.fY2NDC=1-m/Se.height,b.obj.modified_NDC=!0}else(0,v.isFunc)(b.move_resize)&&b.move_resize(z,m,I,A);(0,v.isFunc)(b.redraw)&&b.redraw(b)}return ge||ve},H=(0,V.$E)().subject(Object),X=(0,V.$E)().subject(Object);X.on("start",null).on("drag",null).on("end",null),H.on("start",function(z){if((0,Re.iE)(z.sourceEvent)||pe||(0,v.isFunc)(b.is_disabled)&&b.is_disabled("move"))return;(0,ot.IV)(),L(g,!1),z.sourceEvent.preventDefault(),z.sourceEvent.stopPropagation();const m=b.pad_rect??C.getPadRect(),I={x:b.x,y:b.y,width:b.width,height:b.height,acc_x1:b.x,acc_y1:b.y,pad_w:m.width-b.width,pad_h:m.height-b.height,drag_tm:new Date,path:`v${b.height}h${b.width}v${-b.height}z`,evnt_x:z.x,evnt_y:z.y};ce=g,pe="move",de=(0,V.Lt)(b.getDrawG().node().parentNode).append("path").attr("d",`M${I.acc_x1},${I.acc_y1}${I.path}`).style("cursor","move").style("pointer-events","none").property("drag_handle",I).call(Le.Ru,!0)}).on("drag",function(z){if(!K(g,"move"))return;z.sourceEvent.preventDefault(),z.sourceEvent.stopPropagation();const m=de.property("drag_handle");b.no_change_x||(m.acc_x1+=z.dx),b.no_change_y||(m.acc_y1+=z.dy),m.x=Math.min(Math.max(m.acc_x1,0),m.pad_w),m.y=Math.min(Math.max(m.acc_y1,0),m.pad_h),de.attr("d",`M${m.x},${m.y}${m.path}`)}).on("end",function(z){if(!K(g,"move"))return;z.sourceEvent.stopPropagation(),z.sourceEvent.preventDefault();const m=de.property("drag_handle");if(!1===O(m.x,m.y,b.width,b.height)){const I=(new Date).getTime()-m.drag_tm.getTime();b.ctxmenu&&I>600?(0,ot.sj)({clientX:m.evnt_x,clientY:m.evnt_y,skip_close:1},g):b.canselect&&I<=600&&g.getPadPainter()?.selectObjectPainter(g)}});const ie=(0,V.$E)().subject(Object);ie.on("start",function(z){if((0,Re.iE)(z.sourceEvent)||pe||(0,v.isFunc)(b.is_disabled)&&b.is_disabled("resize"))return;(0,ot.IV)(),L(g,!1),z.sourceEvent.stopPropagation(),z.sourceEvent.preventDefault();const m=b.pad_rect??C.getPadRect(),I={x:b.x,y:b.y,width:b.width,height:b.height,acc_x1:b.x,acc_y1:b.y,acc_x2:b.x+b.width,acc_y2:b.y+b.height,pad_w:m.width,pad_h:m.height};ce=g,pe="resize",de=(0,V.Lt)(b.getDrawG().node().parentNode).append("rect").style("cursor",(0,V.Lt)(this).style("cursor")).attr("x",I.acc_x1).attr("y",I.acc_y1).attr("width",I.acc_x2-I.acc_x1).attr("height",I.acc_y2-I.acc_y1).property("drag_handle",I).call(Le.Ru,!0)}).on("drag",function(z){if(!K(g,"resize"))return;z.sourceEvent.preventDefault(),z.sourceEvent.stopPropagation();const m=de.property("drag_handle"),I=(0,V.Lt)(this);let A=z.dx,R=z.dy;b.no_change_x&&(A=0),b.no_change_y&&(R=0),I.classed("js_nw_resize")?(m.acc_x1+=A,m.acc_y1+=R):I.classed("js_ne_resize")?(m.acc_x2+=A,m.acc_y1+=R):I.classed("js_sw_resize")?(m.acc_x1+=A,m.acc_y2+=R):I.classed("js_se_resize")?(m.acc_x2+=A,m.acc_y2+=R):I.classed("js_w_resize")?m.acc_x1+=A:I.classed("js_n_resize")?m.acc_y1+=R:I.classed("js_e_resize")?m.acc_x2+=A:I.classed("js_s_resize")&&(m.acc_y2+=R);const k=Math.max(0,m.acc_x1),ee=Math.min(m.acc_x2,m.pad_w),ge=Math.max(0,m.acc_y1),ve=Math.min(m.acc_y2,m.pad_h);m.x=Math.min(k,ee),m.y=Math.min(ge,ve),m.width=Math.abs(ee-k),m.height=Math.abs(ve-ge),de.attr("x",m.x).attr("y",m.y).attr("width",m.width).attr("height",m.height)}).on("end",function(z){if(!K(g,"resize"))return;z.sourceEvent.preventDefault();const m=de.property("drag_handle");O(m.x,m.y,m.width,m.height)}),b.only_resize||b.getDrawG().style("cursor",b.cleanup?null:"move").call(b.cleanup?X:H),b.only_move||N(b.getDrawG(),ie)}const D={hints_layer(){return this.getCanvPainter()?.getLayerSvg("info_layer")??(0,V.Lt)(null)},isTooltipShown(){if(!this.tooltip_enabled||!this.isTooltipAllowed())return!1;const w=this.hints_layer().selectChild(".objects_hints");return!w.empty()&&w.property("hints_pad")===this.getPadName()},setTooltipEnabled(w){void 0!==w&&(this.tooltip_enabled=w)},processFrameTooltipEvent(w,b){if(w?.handler){const Cn=this.draw_g?.selectChild(".main_layer");if(!Cn||Cn.empty())w=null;else if(w.touch&&b){const Ln=he(b,Cn.node());w=Ln&&1===Ln.length?{touch:!0,x:Ln[0][0],y:Ln[0][1]}:null}else if(b){const Ln=(0,V.Wn)(b,Cn.node());w={touch:!1,x:Ln[0],y:Ln[1]}}}let g=0,C=0,N=0,O=0,H=!1,X=11;const I=this.getFrameRect(),A=this.getPadPainter(),R=A?.getPadWidth(),k=new Ke.qg(160,X),ee=!this.isTooltipAllowed()||!this.tooltip_enabled;w&&(w.disabled=ee,w.painters=!0);const ge=A?.processPadTooltipEvent(w)??[];A?._deliver_webcanvas_events&&A?.is_active_pad&&w&&(0,v.isFunc)(A?.deliverWebCanvasEvent)&&A.deliverWebCanvasEvent("move",I.x+w.x,I.y+w.y,ge),w?.touch&&(X=15);for(let Cn=0;Cn<ge.length;++Cn){const Ln=ge[Cn];if(Ln){if(void 0!==Ln.user_info&&Ln.painter?.provideUserTooltip(Ln.user_info),!Ln.lines||0===Ln.lines.length){ge[Cn]=null;continue}for(let Zn=0;Zn<Cn;++Zn){const ui=ge[Zn];let hi=!1;if(ui&&ui.lines.length===Ln.lines.length){for(let qi=0;qi<Ln.lines.length&&!hi;++qi)ui.lines[qi]!==Ln.lines[qi]&&(hi=!0);if(!hi){ge[Cn]=null;break}}}ge[Cn]&&(g++,Ln.exact&&C++,Ln.lines.forEach(Zn=>{N=Math.max(N,Zn.length)}),Ln.height=Math.round(Ln.lines.length*X*1.2+6-X*(1.2-1)),void 0!==Ln.color1&&"none"!==Ln.color1&&(0!==O&&O!==Ln.color1&&(H=!0),O=Ln.color1))}}let ve=null,Se=ge.length>1;for(let Cn=0;Cn<ge.length;++Cn){const Ln=ge[Cn],Zn=Ln?.lines?Ln.lines[0]?.lastIndexOf("/"):-1;if(Zn>0){const ui=Ln.lines[0].slice(0,Zn+1);null===ve?ve=ui:ve!==ui&&(Se=!1)}else Se=!1}const De=this.hints_layer(),Xe=g>15,ct=w?Math.round(w.x)+","+Math.round(w.y):"";let $=De.selectChild(".objects_hints"),tt="",We="",Ne="",Fe=null,ht=1e10,pt=null;for(let Cn=0;Cn<ge.length;++Cn){if(!ge[Cn])continue;if(Fe||(Fe=ge[Cn]),ge[Cn].exact&&C<2&&(!Fe||!Fe.exact)){Fe=ge[Cn];break}if(!w||void 0===ge[Cn].x||void 0===ge[Cn].y)continue;const Ln=(w.x-ge[Cn].x)**2+(w.y-ge[Cn].y)**2;Ln<ht&&(ht=Ln,pt=ge[Cn])}if((!Fe||!Fe.exact)&&ht<400&&(Fe=pt),Fe&&(We=Fe.lines&&Fe.lines.length>1?Fe.lines[0]:Fe.name,tt=Fe.title||"",Ne=Fe.line,!Ne&&Fe.lines&&(Ne=Fe.lines.slice(1).join(" "))),this.showObjectStatus(We,tt,Ne,ct),!w||ee||0===ge.length||0===N||Xe&&!pt)return void $.remove();$.empty()&&($=De.append("svg:g").attr("class","objects_hints").style("pointer-events","none"));let dt={x:0,y:0},rt=I.transform||"";A.iscan||(dt=(0,Le.md)(this.getPadSvg(),dt),rt=`translate(${dt.x},${dt.y}) ${rt}`),$.attr("transform",rt).property("last_point",w).property("hints_pad",this.getPadName());let _t=$.property("viewmode")||"",Yt=0,kt=w.x+I.hint_delta_x;if(Xe||1===g)_t="single",kt+=15;else{let Cn=.5,Ln=.5;"left"===_t?Ln=.7:"right"===_t&&(Cn=.3),kt<=Cn*I.width?(_t="left",kt=20):kt>=Ln*I.width?(_t="right",kt=I.width-60):kt=$.property("startx")}_t!==$.property("viewmode")&&($.property("viewmode",_t),$.selectAll("*").remove());let Tt=10,fn=10,ln=-1111,mn=-1111;const jt=-dt.y,Sn=this.getCanvPainter(),cn=Sn.getPadHeight()-I.y-dt.y;for(let Cn=0;Cn<ge.length;++Cn){let qi=function(){return function(){return function(Mr){return Mr<.8?"0":5*(Mr-.8)}}},Ln=ge[Cn],Zn=$.selectChild(`.painter_hint_${Cn}`);if(Xe&&Ln!==pt&&(Ln=null),null===Ln){Zn.remove();continue}const ui=Zn.empty();if(ui&&(Zn=$.append("svg:svg").attr("class",`painter_hint_${Cn}`).attr("opacity",0).style("overflow","hidden").style("pointer-events","none")),"single"===_t)Tt=w.touch?w.y-Ln.height-5:Math.min(w.y+15,cn-Ln.height-3)+I.hint_delta_y;else{for(let Mr=0;Mr<ge.length&&fn<cn;++Mr){const Sr=ge[Mr];Sr&&Sr.y>=fn-5&&Sr.y<=fn+Sr.height+5&&(fn=Sr.y+10,Mr=-1)}-1111===ln&&-1111===mn&&(ln=mn=Ln.x),ln=Math.min(ln,Ln.x),mn=Math.min(mn,Ln.x)}Zn.attr("x",kt).attr("y",Tt).property("curry",Tt).property("gapy",fn),Tt+=Ln.height+5,fn+=Ln.height+5,ui||Zn.selectAll("*").remove(),Zn.attr("width",60).attr("height",Ln.height);const hi=Zn.append("rect").attr("x",0).attr("y",0).attr("width",60).attr("height",Ln.height).style("fill","lightgrey").style("pointer-events","none");if(g>1){const Mr=H?Ln.color1:Ln.color2;Mr&&"none"!==Mr&&hi.style("stroke",Mr)}hi.attr("stroke-width",Ln.exact?3:1);for(let Mr=0;Mr<(Ln.lines?.length??0);Mr++){let Sr=Ln.lines[Mr];if(0===Mr&&ve&&Se&&(Sr=Sr.slice(ve.length)),Sr){const ms=Zn.append("svg:text").attr("text-anchor","start").attr("x",3).attr("y",3+Mr*X*1.2).attr("dy",".8em").style("fill","black").style("pointer-events","none").call(k.func).text(Sr),fs=(0,Le.xh)(ms,"bbox");Yt=Math.max(Yt,fs.width)}}ui&&(v.settings.TooltipAnimation>0?Zn.transition().duration(v.settings.TooltipAnimation).attrTween("opacity",qi()):Zn.attr("opacity",1))}Yt+=6;const gn=$.selectAll("svg");if("right"===_t&&kt+Yt>I.width-20&&(kt=I.width-Yt-20,gn.attr("x",kt)),"single"===_t&&kt+Yt>R-I.x&&kt>Yt+20&&(kt-=Yt+20,gn.attr("x",kt)),"single"!==_t&&fn<cn&&fn!==Tt)ln<=kt+Yt+5&&mn>=kt-5&&gn.attr("y",function(){return(0,V.Lt)(this).property("gapy")});else if("single"!==_t&&Tt>cn){const Cn=Math.max(cn-Tt-10,jt);Cn<0&&gn.attr("y",function(){return(0,V.Lt)(this).property("curry")+Cn})}Yt>10&&gn.attr("width",Yt).select("rect").attr("width",Yt),$.property("startx",kt),Sn._highlight_connect&&(0,v.isFunc)(Sn.processHighlightConnect)&&Sn.processHighlightConnect(ge)},assign(w){Object.assign(w,this,{tooltip_enabled:!0})}},x={addBasicInteractivity(){D.assign(this),!this._frame_rotate&&!this._frame_fixpos&&G(this,{obj:this,x:this._frame_x,y:this._frame_y,width:this.getFrameWidth(),height:this.getFrameHeight(),is_disabled:O=>"move"===O&&this.mode3d,only_resize:!0,minwidth:20,minheight:20,redraw:()=>this.sizeChanged()});const w=this.draw_g.selectChild("path"),b=this.draw_g.selectChild(".main_layer");w.style("pointer-events","visibleFill").style("cursor","default"),b.style("pointer-events","visibleFill").style("cursor","default").property("handlers_set",0);const g=this.getPadPainter(),C=g?._fast_drawing?0:1;if(b.property("handlers_set")!==C){const O=C?this.processFrameTooltipEvent.bind(this,null):null,H=C?this.processFrameTooltipEvent.bind(this,{handler:!0,touch:!1}):null;if(b.property("handlers_set",C).on("mouseenter",H).on("mousemove",H).on("mouseleave",O),v.browser.touches){const X=C?this.processFrameTooltipEvent.bind(this,{handler:!0,touch:!0}):null;b.on("touchstart",X).on("touchmove",X).on("touchend",O).on("touchcancel",O)}}b.attr("x",0).attr("y",0).attr("width",this.getFrameWidth()).attr("height",this.getFrameHeight());const N=this.hints_layer().selectChild(".objects_hints");!N.empty()&&this.isTooltipAllowed()&&N.property("hints_pad")===this.getPadName()&&setTimeout(this.processFrameTooltipEvent.bind(this,N.property("last_point"),null),10)},addFrameInteractivity(w){var b=this;return(0,be.A)(function*(){const g=b.getPadPainter(),C=b.getFrameSvg();if(g?._fast_drawing||C.empty())return b;if(w){const H=C.selectAll(".x2axis_container"),X=C.selectAll(".y2axis_container");return v.settings.ContextMenu&&(H.on("contextmenu",ie=>b.showContextMenu("x2",ie)),X.on("contextmenu",ie=>b.showContextMenu("y2",ie))),H.on("mousemove",ie=>b.showAxisStatus("x2",ie)),X.on("mousemove",ie=>b.showAxisStatus("y2",ie)),b}const N=C.selectAll(".xaxis_container"),O=C.selectAll(".yaxis_container");return b.can_zoom_x=b.can_zoom_y=v.settings.Zooming,g?.options&&(g.options.NoZoomX&&(b.can_zoom_x=!1),g.options.NoZoomY&&(b.can_zoom_y=!1)),C.property("interactive_set")||(b.addFrameKeysHandler(),b.zoom_kind=0,b.zoom_rect=null,b.zoom_origin=null,b.zoom_curr=null),v.settings.Zooming&&(v.settings.ZoomMouse&&(C.on("mousedown",H=>b.startRectSel(H)),C.on("dblclick",H=>b.mouseDoubleClick(H))),v.settings.ZoomWheel&&C.on("wheel",H=>b.mouseWheel(H))),v.browser.touches&&(v.settings.Zooming&&v.settings.ZoomTouch||v.settings.ContextMenu)&&C.on("touchstart",H=>b.startTouchZoom(H)),v.settings.ContextMenu&&(v.browser.touches&&(N.on("touchstart",H=>b.startSingleTouchHandling("x",H)),O.on("touchstart",H=>b.startSingleTouchHandling("y",H))),C.on("contextmenu",H=>b.showContextMenu("",H)),N.on("contextmenu",H=>b.showContextMenu("x",H)),O.on("contextmenu",H=>b.showContextMenu("y",H))),N.on("mousemove",H=>b.showAxisStatus("x",H)),O.on("mousemove",H=>b.showAxisStatus("y",H)),C.property("interactive_set",!0),b})()},addFrameKeysHandler(){this.keys_handler||typeof window>"u"||(this.keys_handler=w=>this.processKeyPress(w),window.addEventListener("keydown",this.keys_handler,!1))},processKeyPress(w){if((0,ot.as)())return!0;const g=this.selectDom(),C=this.getPadPainter();let N=w.key;if(!v.settings.HandleKeys||g.empty()||!1===this.enabledKeys||(0,xe.OZ)()!==C||["PageUp","PageDown","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","PrintScreen","Escape","*"].indexOf(N)<0)return!1;w.shiftKey&&(N=`Shift ${N}`),w.altKey&&(N=`Alt ${N}`),w.ctrlKey&&(N=`Ctrl ${N}`);const O={name:"x",dleft:0,dright:0};switch(N){case"ArrowLeft":O.dleft=-1,O.dright=1;break;case"ArrowRight":O.dleft=1,O.dright=-1;break;case"Ctrl ArrowLeft":O.dleft=O.dright=-1;break;case"Ctrl ArrowRight":O.dleft=O.dright=1;break;case"ArrowUp":O.name="y",O.dleft=1,O.dright=-1;break;case"ArrowDown":O.name="y",O.dleft=-1,O.dright=1;break;case"Ctrl ArrowUp":O.name="y",O.dleft=O.dright=1;break;case"Ctrl ArrowDown":O.name="y",O.dleft=O.dright=-1;break;case"Escape":return C?.enlargePad(null,!1,!0),!0}if(O.dleft||O.dright){if(!v.settings.Zooming||this.mode3d&&0!==N.indexOf("Ctrl"))return!1;this.analyzeMouseWheelEvent(null,O,.5),O.changed&&(this.zoom(O.name,O.min,O.max),this.zoomChangedInteractive(O.name,!0)),w.stopPropagation(),w.preventDefault()}else{const H=C?.findPadButton(N);H&&(C.clickPadButton(H),w.stopPropagation(),w.preventDefault())}return!0},processFrameClick(w,b){const g=this.getPadPainter();if(!g)return;w.painters=!0,w.disabled=!0;const C=g.processPadTooltipEvent(w);let O,N=null;for(let H=0;H<C.length&&!N;++H)C[H]&&C[H].exact&&(N=C[H]);if(N){const H=b?this._dblclick_handler:this._click_handler;H&&(O=H(N.user_info,w))}return b||g.selectObjectPainter(N?N.painter:this,{x:w.x+(this._frame_x||0),y:w.y+(this._frame_y||0)}),O},shiftMoveHanlder(w,b){if(w.buttons===this._shifting_buttons){const g=this.getFrameSvg(),C=(0,V.Wn)(w,g.node()),N=this.draw_g.selectChild(".main_layer"),O=b[0]-C[0],H=1===this.scales_ndim?0:b[1]-C[1],X=this.getFrameWidth(),ie=this.getFrameHeight();this._shifting_dx=O,this._shifting_dy=H,N.attr("viewBox",`${O} ${H} ${X} ${ie}`),w.preventDefault(),w.stopPropagation()}},shiftUpHanlder(w){w.preventDefault(),(0,V.Lt)(window).on("mousemove.shiftHandler",null).on("mouseup.shiftHandler",null),void 0!==this._shifting_dx&&void 0!==this._shifting_dy&&this.performScalesShift()},performScalesShift(){const w=this.getFrameWidth(),b=this.getFrameHeight(),g=this.draw_g.selectChild(".main_layer"),C=this.getGrFuncs(),N=C.revertAxis("x",this._shifting_dx),O=C.revertAxis("x",this._shifting_dx+w),H=C.revertAxis("y",this._shifting_dy+b),X=C.revertAxis("y",this._shifting_dy);g.attr("viewBox",`0 0 ${w} ${b}`),delete this._shifting_dx,delete this._shifting_dy,L(this,!0),1===this.scales_ndim?this.zoomSingle("x",N,O):this.zoom(N,O,H,X)},startRectSel(w){if(this.zoom_kind>100)return;const b=this.getFrameSvg(),g=(0,V.Wn)(w,b.node());if(3===w.buttons||1===w.button)return this.clearInteractiveElements(),this._shifting_buttons=w.buttons,w.$emul||(0,V.Lt)(window).on("mousemove.shiftHandler",O=>this.shiftMoveHanlder(O,g)).on("mouseup.shiftHandler",O=>this.shiftUpHanlder(O),!0),L(this,!1),w.preventDefault(),void w.stopPropagation();if(0!==w.button)return;w.preventDefault(),this.clearInteractiveElements();const C=this.getFrameWidth(),N=this.getFrameHeight();return this.zoom_lastpos=g,this.zoom_curr=[Math.max(0,Math.min(C,g[0])),Math.max(0,Math.min(N,g[1]))],this.zoom_origin=[0,0],this.zoom_second=!1,g[0]<0||g[0]>C?(this.zoom_second=g[0]>C&&this.y2_handle,this.zoom_kind=3,this.zoom_origin[1]=this.zoom_curr[1],this.zoom_curr[0]=C,this.zoom_curr[1]+=1):g[1]<0||g[1]>N?(this.zoom_second=g[1]<0&&this.x2_handle,this.zoom_kind=2,this.zoom_origin[0]=this.zoom_curr[0],this.zoom_curr[0]+=1,this.zoom_curr[1]=N):(this.zoom_kind=1,this.zoom_origin[0]=this.zoom_curr[0],this.zoom_origin[1]=this.zoom_curr[1]),w.$emul||(0,V.Lt)(window).on("mousemove.zoomRect",O=>this.moveRectSel(O)).on("mouseup.zoomRect",O=>this.endRectSel(O),!0),this.zoom_rect=null,L(this,!1),w.stopPropagation(),1!==this.zoom_kind?(0,v.postponePromise)(()=>this.startLabelsMove(),500):void 0},startLabelsMove(){if(this.zoom_rect)return;const w=2===this.zoom_kind?this.x_handle:this.y_handle;!(0,v.isFunc)(w?.processLabelsMove)||!this.zoom_lastpos||w.processLabelsMove("start",this.zoom_lastpos)&&(this.zoom_labels=w)},moveRectSel(w){if(0===this.zoom_kind||this.zoom_kind>100)return;w.preventDefault();const b=(0,V.Wn)(w,this.getFrameSvg().node());if(this.zoom_labels)return this.zoom_labels.processLabelsMove("move",b);switch(this.zoom_lastpos[0]=b[0],this.zoom_lastpos[1]=b[1],b[0]=Math.max(0,Math.min(this.getFrameWidth(),b[0])),b[1]=Math.max(0,Math.min(this.getFrameHeight(),b[1])),this.zoom_kind){case 1:this.zoom_curr[0]=b[0],this.zoom_curr[1]=b[1];break;case 2:this.zoom_curr[0]=b[0];break;case 3:this.zoom_curr[1]=b[1]}const g=Math.min(this.zoom_origin[0],this.zoom_curr[0]),C=Math.min(this.zoom_origin[1],this.zoom_curr[1]),N=Math.abs(this.zoom_curr[0]-this.zoom_origin[0]),O=Math.abs(this.zoom_curr[1]-this.zoom_origin[1]);if(!this.zoom_rect){if(1!==this.zoom_kind&&(N<2||O<2))return;this.zoom_rect=this.getFrameSvg().append("rect").style("pointer-events","none").call(Le.Ru,!0)}this.zoom_rect.attr("x",g).attr("y",C).attr("width",N).attr("height",O)},endRectSel(w){if(0===this.zoom_kind||this.zoom_kind>100)return;w.preventDefault(),w.$emul||(0,V.Lt)(window).on("mousemove.zoomRect",null).on("mouseup.zoomRect",null);const b=(0,V.Wn)(w,this.getFrameSvg().node());let C,g=this.zoom_kind;if(this.zoom_labels)this.zoom_labels.processLabelsMove("stop",b);else{const O=[this.can_zoom_x,this.can_zoom_y];switch(b[0]=Math.max(0,Math.min(this.getFrameWidth(),b[0])),b[1]=Math.max(0,Math.min(this.getFrameHeight(),b[1])),this.zoom_kind){case 1:this.zoom_curr[0]=b[0],this.zoom_curr[1]=b[1];break;case 2:this.zoom_curr[0]=b[0],O[1]=!1;break;case 3:this.zoom_curr[1]=b[1],O[0]=!1}const H=this.swap_xy?1:0,X=1-H;let ie,z,m,I,A=!1,R="x",k="y";O[H]&&Math.abs(this.zoom_curr[H]-this.zoom_origin[H])>10&&(this.zoom_second&&2===this.zoom_kind&&(R="x2"),ie=Math.min(this.revertAxis(R,this.zoom_origin[H]),this.revertAxis(R,this.zoom_curr[H])),z=Math.max(this.revertAxis(R,this.zoom_origin[H]),this.revertAxis(R,this.zoom_curr[H])),A=!0),O[X]&&Math.abs(this.zoom_curr[X]-this.zoom_origin[X])>10&&(this.zoom_second&&3===this.zoom_kind&&(k="y2"),m=Math.min(this.revertAxis(k,this.zoom_origin[X]),this.revertAxis(k,this.zoom_curr[X])),I=Math.max(this.revertAxis(k,this.zoom_origin[X]),this.revertAxis(k,this.zoom_curr[X])),A=!0),"x2"===R?(this.zoomChangedInteractive(R,!0),C=this.zoomSingle(R,ie,z),g=0):"y2"===k?(this.zoomChangedInteractive(k,!0),C=this.zoomSingle(k,m,I),g=0):A&&(this.zoomChangedInteractive("x",!0),this.zoomChangedInteractive("y",!0),C=this.zoom(ie,z,m,I),g=0)}const N=1===g?{x:this.zoom_origin[0],y:this.zoom_origin[1]}:null;switch(this.clearInteractiveElements(),g){case 1:this.processFrameClick(N);break;case 2:this.getPadPainter()?.selectObjectPainter(this,null,"xaxis");break;case 3:this.getPadPainter()?.selectObjectPainter(this,null,"yaxis")}return C},mouseDoubleClick(w){w.preventDefault();const b=(0,V.Wn)(w,this.getFrameSvg().node()),g=this.getFrameWidth(),C=this.getFrameHeight();this.clearInteractiveElements();const N=b[0]>=0&&b[0]<=g,O=b[1]>=0&&b[1]<=C;if(N&&O&&this._dblclick_handler&&this.processFrameClick({x:b[0],y:b[1]},!0))return;let H=(this.can_zoom_x?"x":"")+(this.can_zoom_y?"y":"")+"z";if(N){if(!O){if(!this.can_zoom_x)return;H=this.swap_xy?"y":"x",b[1]<0&&this[H+"2_handle"]&&(H+="2")}}else{if(!this.can_zoom_y)return;H=this.swap_xy?"x":"y",b[0]>g&&this[H+"2_handle"]&&(H+="2")}return this.unzoom(H).then(X=>{if(X)return;const ie=this.getPadPainter(),z=this.getFrameRect();return ie?.selectObjectPainter(ie,{x:b[0]+z.x,y:b[1]+z.y,dbl:!0})})},startTouchZoom(w){if(w.preventDefault(),w.stopPropagation(),0!==this.zoom_kind||pe)return;const b=he(w,this.getFrameSvg().node());if(1===b.length){const H=(new Date).getTime();let X=1e10,ie=100,z=100;this.last_touch_time&&this.last_touch_pos&&(X=H-this.last_touch_time,ie=Math.abs(b[0][0]-this.last_touch_pos[0]),z=Math.abs(b[0][1]-this.last_touch_pos[1])),this.last_touch_time=H,this.last_touch_pos=b[0],X<500&&ie<20&&z<20?(this.clearInteractiveElements(),this.unzoom("xyz"),delete this.last_touch_time):v.settings.ContextMenu&&this.startSingleTouchHandling("",w)}if(2!==b.length||!v.settings.Zooming||!v.settings.ZoomTouch)return;this.clearInteractiveElements(),this.endSingleTouchHandling(null);const g=b[0],C=b[1],N=this.getFrameWidth(),O=this.getFrameHeight();this.zoom_curr=[Math.min(g[0],C[0]),Math.min(g[1],C[1])],this.zoom_origin=[Math.max(g[0],C[0]),Math.max(g[1],C[1])],this.zoom_second=!1,this.zoom_curr[0]<0||this.zoom_curr[0]>N?(this.zoom_second=this.zoom_curr[0]>N&&this.y2_handle,this.zoom_kind=103,this.zoom_curr[0]=0,this.zoom_origin[0]=N):this.zoom_origin[1]>O||this.zoom_origin[1]<0?(this.zoom_second=this.zoom_origin[1]<0&&this.x2_handle,this.zoom_kind=102,this.zoom_curr[1]=0,this.zoom_origin[1]=O):this.zoom_kind=101,pe="zoom",L(this,!1),this.zoom_rect=this.getFrameSvg().append("rect").attr("id","zoomRect").attr("x",this.zoom_curr[0]).attr("y",this.zoom_curr[1]).attr("width",this.zoom_origin[0]-this.zoom_curr[0]).attr("height",this.zoom_origin[1]-this.zoom_curr[1]).call(Le.Ru,!0),w.$emul||(0,V.Lt)(window).on("touchmove.zoomRect",H=>this.moveTouchZoom(H)).on("touchcancel.zoomRect",H=>this.endTouchZoom(H)).on("touchend.zoomRect",H=>this.endTouchZoom(H))},moveTouchZoom(w){if(this.zoom_kind<100)return;w.preventDefault();const b=he(w,this.getFrameSvg().node());if(2!==b.length)return this.clearInteractiveElements();const g=b[0],C=b[1];103!==this.zoom_kind&&(this.zoom_curr[0]=Math.min(g[0],C[0]),this.zoom_origin[0]=Math.max(g[0],C[0])),102!==this.zoom_kind&&(this.zoom_curr[1]=Math.min(g[1],C[1]),this.zoom_origin[1]=Math.max(g[1],C[1])),this.zoom_rect.attr("x",this.zoom_curr[0]).attr("y",this.zoom_curr[1]).attr("width",this.zoom_origin[0]-this.zoom_curr[0]).attr("height",this.zoom_origin[1]-this.zoom_curr[1]),(this.zoom_origin[0]-this.zoom_curr[0]>10||this.zoom_origin[1]-this.zoom_curr[1]>10)&&L(this,!1),w.stopPropagation()},endTouchZoom(w){if(this.zoom_kind<100)return;pe="",w.preventDefault(),w.$emul||(0,V.Lt)(window).on("touchmove.zoomRect",null).on("touchend.zoomRect",null).on("touchcancel.zoomRect",null);let b,g,C,N,O=!1,H="x",X="y";const ie=this.swap_xy?1:0,z=1-ie,m=[!0,!0];102===this.zoom_kind&&(m[1]=!1),103===this.zoom_kind&&(m[0]=!1),m[ie]&&Math.abs(this.zoom_curr[ie]-this.zoom_origin[ie])>10&&(this.zoom_second&&102===this.zoom_kind&&(H="x2"),b=Math.min(this.revertAxis(H,this.zoom_origin[ie]),this.revertAxis(H,this.zoom_curr[ie])),g=Math.max(this.revertAxis(H,this.zoom_origin[ie]),this.revertAxis(H,this.zoom_curr[ie])),O=!0),m[z]&&Math.abs(this.zoom_curr[z]-this.zoom_origin[z])>10&&(this.zoom_second&&103===this.zoom_kind&&(X="y2"),C=Math.min(this.revertAxis(X,this.zoom_origin[z]),this.revertAxis(X,this.zoom_curr[z])),N=Math.max(this.revertAxis(X,this.zoom_origin[z]),this.revertAxis(X,this.zoom_curr[z])),O=!0),this.clearInteractiveElements(),delete this.last_touch_time,"x2"===H?(this.zoomChangedInteractive(H,!0),this.zoomSingle(H,b,g)):"y2"===X?(this.zoomChangedInteractive(X,!0),this.zoomSingle(X,C,N)):O&&(this.zoomChangedInteractive("x",!0),this.zoomChangedInteractive("y",!0),this.zoom(b,g,C,N)),w.stopPropagation()},analyzeMouseWheelEvent(w,b,g,C,N){const O=N?this[b.name+"2_handle"]:null;return O?(b.second=Object.assign({},b),O.analyzeWheelEvent(w,g,b.second,C)):this[b.name+"_handle"]?.analyzeWheelEvent(w,g,b,C)},isAllowedDefaultYZooming(){if(this.self_drawaxes)return!0;const w=this.getPadPainter();if(w?.painters)for(let b=0;b<w.painters.length;++b){const g=w.painters[b];if(void 0!==g?.wheel_zoomy)return g.wheel_zoomy}return!1},mouseWheel(w){w.stopPropagation(),w.preventDefault(),this.clearInteractiveElements();const b={name:"x",reverse:this.reverse_x},g={name:"y",reverse:this.reverse_y,ignore:!this.isAllowedDefaultYZooming()},C=(0,V.Wn)(w,this.getFrameSvg().node()),N=this.getFrameWidth(),O=this.getFrameHeight();this.can_zoom_x&&this.analyzeMouseWheelEvent(w,this.swap_xy?g:b,C[0]/N,C[1]>=0&&C[1]<=O,C[1]<0),this.can_zoom_y&&this.analyzeMouseWheelEvent(w,this.swap_xy?b:g,1-C[1]/O,C[0]>=0&&C[0]<=N,C[0]>N);let H=this.zoom(b.min,b.max,g.min,g.max);return b.changed&&this.zoomChangedInteractive("x",!0),g.changed&&this.zoomChangedInteractive("y",!0),b.second&&(H=H.then(()=>this.zoomSingle("x2",b.second.min,b.second.max)),b.second.changed&&this.zoomChangedInteractive("x2",!0)),g.second&&(H=H.then(()=>this.zoomSingle("y2",g.second.min,g.second.max)),g.second.changed&&this.zoomChangedInteractive("y2",!0)),H},showContextMenu(w,b,g){if(3===b?.buttons)return b.preventDefault();if("zoom_kind"in this&&this.zoom_kind>100)return;let C,N=this,O=null,H=!1,X=null;const ie=this.getFrameSvg().node();if((0,v.isFunc)(b?.stopPropagation)){b.preventDefault(),b.stopPropagation();const z=(0,V.Wn)(b,ie),m=he(b,ie);1===m.length?C={x:m[0][0],y:m[0][1],touch:!0}:2===z.length&&(C={x:z[0],y:z[1],touch:!1})}else if(void 0!==b?.x&&void 0!==b?.y&&void 0===b?.clientX){C=b;const z=ie.getBoundingClientRect();b={clientX:z.left+C.x,clientY:z.top+C.y}}if("painter"===w&&g)N=g,w="";else if("main"===w)N=this.getMainPainter(!0),w="";else if(w)("x"===w||"y"===w||"z"===w||"pal"===w)&&(O=this.getMainPainter(!0),this.v7_frame&&(0,v.isFunc)(O?.v7EvalAttr)&&(O=null));else{const z=this.getPadPainter();let m=null;if(X=this,C&&z){C.painters=!0;const I=z.processPadTooltipEvent(C);let A=1e3;for(let R=0;R<I.length;++R)if(I[R]?.menu){const k=I[R].menu_dist??7;k<A&&(m=I[R].painter,A=k)}}m?N=m:w="frame",C&&(H=C.x>0&&C.x<20&&C.y>0&&C.y<20),X.setLastEventPos(C)}return O||(O=N),(0,v.isFunc)(N?.fillContextMenu)?(this.clearInteractiveElements(),(0,ot.ES)(b,N).then(z=>{let m=z.painter.fillContextMenu(z,w,g);if(X&&(!m||H&&"frame"!==w)&&(m=X.fillContextMenu(z)),m)return O.fillObjectExecMenu(z,w).then(I=>(L(I.painter,!1),I.show().then(()=>L(I.painter,!0))))})):void 0},startSingleTouchHandling(w,b){const g=he(b,this.getFrameSvg().node());if(1!==g.length)return;b.preventDefault(),b.stopPropagation(),(0,ot.IV)();const C=(new Date).getTime();this._shifting_dx=0,this._shifting_dy=0,L(this,!1),(0,V.Lt)(window).on("touchmove.singleTouch",w?null:N=>this.moveTouchHandling(N,w,g[0])).on("touchcancel.singleTouch",N=>this.endSingleTouchHandling(N,w,g[0],C)).on("touchend.singleTouch",N=>this.endSingleTouchHandling(N,w,g[0],C))},moveTouchHandling(w,b,g){const C=this.getFrameSvg(),N=this.draw_g.selectChild(".main_layer");let O;try{O=he(w,C.node())[0]}catch{O=[0,0],w?.changedTouches&&(O=[w.changedTouches[0].clientX,w.changedTouches[0].clientY])}const H=g[0]-O[0],X=1===this.scales_ndim?0:g[1]-O[1],ie=this.getFrameWidth(),z=this.getFrameHeight();this._shifting_dx=H,this._shifting_dy=X,N.attr("viewBox",`${H} ${X} ${ie} ${z}`)},endSingleTouchHandling(w,b,g,C){w?.preventDefault(),w?.stopPropagation(),L(this,!0),(0,V.Lt)(window).on("touchmove.singleTouch",null).on("touchcancel.singleTouch",null).on("touchend.singleTouch",null),null!==w&&(Math.abs(this._shifting_dx)>2||Math.abs(this._shifting_dy)>2?this.performScalesShift():(new Date).getTime()-C>700&&this.showContextMenu(b,{x:g[0],y:g[1]}))},clearInteractiveElements(){(0,ot.IV)(),this.zoom_kind=0,this.zoom_rect?.remove(),delete this.zoom_rect,delete this.zoom_curr,delete this.zoom_origin,delete this.zoom_lastpos,delete this.zoom_labels,L(this,!0)},assign(w){Object.assign(w,this)}};class P extends xe.JW{constructor(b,g){super(b,g&&g.$dummy?null:g),this.zoom_kind=0,this.mode3d=!1,this.shrink_frame_left=0,this.xmin=this.xmax=0,this.ymin=this.ymax=0,this.ranges_set=!1,this.axes_drawn=!1,this.keys_handler=null,this.projection=0}getFramePainter(){return this}is_root6(){return!0}getObject(b){return"xaxis"===b?this.xaxis:"yaxis"===b?this.yaxis:super.getObject()}setFrameActive(b){this.enabledKeys=b&&v.settings.HandleKeys,this.control&&(this.control.enableKeys=this.enabledKeys)}shrinkFrame(b,g){this.fX1NDC+=b,this.fX2NDC-=g}setLastEventPos(b){this.fLastEventPnt=b}getLastEventPos(){return this.fLastEventPnt}getProjectionFunc(){return re(this.projection)}recalculateRange(b,g,C){this.projection=b||0,2===this.projection&&(this.scale_ymin<=-90||this.scale_ymax>=90)&&(console.warn(`Mercator Projection: Latitude out of range ${this.scale_ymin} ${this.scale_ymax}`),this.projection=0);const N=this.getProjectionFunc();if(!N)return;const O=[N(this.scale_xmin,this.scale_ymin),N(this.scale_xmin,this.scale_ymax),N(this.scale_xmax,this.scale_ymax),N(this.scale_xmax,this.scale_ymin)];this.scale_xmin<0&&this.scale_xmax>0&&(O.push(N(0,this.scale_ymin)),O.push(N(0,this.scale_ymax))),this.scale_ymin<0&&this.scale_ymax>0&&(O.push(N(this.scale_xmin,0)),O.push(N(this.scale_xmax,0))),this.original_xmin=this.scale_xmin,this.original_xmax=this.scale_xmax,this.original_ymin=this.scale_ymin,this.original_ymax=this.scale_ymax,g&&(this.scale_xmin=this.scale_xmax=O[0].x),C&&(this.scale_ymin=this.scale_ymax=O[0].y);for(let H=1;H<O.length;++H)g&&(this.scale_xmin=Math.min(this.scale_xmin,O[H].x),this.scale_xmax=Math.max(this.scale_xmax,O[H].x)),C&&(this.scale_ymin=Math.min(this.scale_ymin,O[H].y),this.scale_ymax=Math.max(this.scale_ymax,O[H].y))}setAxesRanges(b,g,C,N,O,H,X,ie,z,m){if(this.ranges_set=!0,this.xaxis=b,this.xmin=g,this.xmax=C,this.yaxis=N,this.ymin=O,this.ymax=H,this.zaxis=X,this.zmin=ie,this.zmax=z,m?.check_pad_range){delete m.check_pad_range;const I=m.getDimension();this.applyAxisZoom("x"),I>1&&this.applyAxisZoom("y"),I>2&&this.applyAxisZoom("z")}m&&!m._checked_zooming&&(m._checked_zooming=!0,m.options.minimum!==v.kNoZoom&&(this.zoom_zmin=m.options.minimum,this.zoom_zmax=this.zmax),m.options.maximum!==v.kNoZoom&&(this.zoom_zmax=m.options.maximum,void 0===this.zoom_zmin&&(this.zoom_zmin=this.zmin)))}setAxes2Ranges(b,g,C,N,O,H,X,ie){b&&(this.x2axis=g,this.x2min=C,this.x2max=N),O&&(this.y2axis=H,this.y2min=X,this.y2max=ie)}getAxis(b){switch(b){case"x":return this.xaxis;case"y":return this.yaxis;case"z":return this.zaxis;case"x2":return this.x2axis;case"y2":return this.y2axis}return null}applyPadUserRange(b,g){if(!b)return;let C=b[`fU${g}min`],N=b[`fU${g}max`],O=1e-7;if("x"===g){if(Math.abs(b.fX1)>O||Math.abs(b.fX2-1)>O){const z=b.fX2-b.fX1;C=b.fX1+z*b.fLeftMargin,N=b.fX2-z*b.fRightMargin}}else if(Math.abs(b.fY1)>O||Math.abs(b.fY2-1)>O){const z=b.fY2-b.fY1;C=b.fY1+z*b.fBottomMargin,N=b.fY2-z*b.fTopMargin}if(C>=N||Math.abs(C)<O&&Math.abs(N-1)<O)return;b[`fLog${g}`]>0&&(C=Math.exp(C*Math.log(10)),N=Math.exp(N*Math.log(10)));let H=g;this.swap_xy&&(H="x"===g?"y":"x");const X=this[`scale_${H}min`],ie=this[`scale_${H}max`];O=1e-7*(ie-X),(Math.abs(C-X)>O||Math.abs(N-ie)>O)&&(this[`zoom_${H}min`]=C,this[`zoom_${H}max`]=N)}applyAxisZoom(b){if(this.zoomChangedInteractive(b))return;this[`zoom_${b}min`]=this[`zoom_${b}max`]=0;const g=this.getAxis(b);g?.TestBit(xe.rb.kAxisRange)&&g.fFirst!==g.fLast&&(g.fFirst>1||g.fLast<g.fNbins)&&(this[`zoom_${b}min`]=g.fFirst>1?g.GetBinLowEdge(g.fFirst):g.fXmin,this[`zoom_${b}max`]=g.fLast<g.fNbins?g.GetBinLowEdge(g.fLast+1):g.fXmax,g.InvertBit(xe.rb.kAxisRange),g.fFirst=1,g.fLast=g.fNbins)}createXY(b){this.cleanXY(),b||(b={ndim:1}),this.swap_xy=b.swap_xy||!1,this.reverse_x=b.reverse_x||!1,this.reverse_y=b.reverse_y||!1,this.logx=this.logy=0;const g=this.getFrameWidth(),C=this.getFrameHeight(),O=this.getPadPainter().getRootPad(),H=O.fLogx,X=(1===b.ndim?O.fLogv:void 0)??O.fLogy;this.scales_ndim=b.ndim,this.scale_xmin=this.xmin,this.scale_xmax=this.xmax,this.scale_ymin=this.ymin,this.scale_ymax=this.ymax,b.extra_y_space&&((this.swap_xy?H:X)&&this.scale_ymax>0?this.scale_ymax=Math.exp(1.1*Math.log(this.scale_ymax)):this.scale_ymax+=.1*(this.scale_ymax-this.scale_ymin)),b.check_pad_range&&(this.applyAxisZoom("x"),b.ndim>1&&this.applyAxisZoom("y"),b.ndim>2&&this.applyAxisZoom("z"),"pad_range"===b.check_pad_range&&(this.applyPadUserRange(O,"x"),this.applyPadUserRange(O,"y"))),b.zoom_xmin!==b.zoom_xmax&&(this.zoom_xmin===this.zoom_xmax||!this.zoomChangedInteractive("x"))&&(this.zoom_xmin=b.zoom_xmin,this.zoom_xmax=b.zoom_xmax),b.zoom_ymin!==b.zoom_ymax&&(this.zoom_ymin===this.zoom_ymax||!this.zoomChangedInteractive("y"))&&(this.zoom_ymin=b.zoom_ymin,this.zoom_ymax=b.zoom_ymax);let ie=!0,z=!0;this.zoom_xmin!==this.zoom_xmax&&(this.scale_xmin=this.zoom_xmin,this.scale_xmax=this.zoom_xmax,ie=!1),this.zoom_ymin!==this.zoom_ymax&&(this.scale_ymin=this.zoom_ymin,this.scale_ymax=this.zoom_ymax,z=!1),this.recalculateRange(b.Proj,ie,z),this.x_handle=new st.TB(this.getDom(),this.xaxis,!0),this.x_handle.setPadName(this.getPadName()),this.x_handle.setHistPainter(b.hist_painter,"x"),this.x_handle.configureAxis("xaxis",this.xmin,this.xmax,this.scale_xmin,this.scale_xmax,this.swap_xy,this.swap_xy?[0,C]:[0,g],{reverse:this.reverse_x,log:this.swap_xy?X:H,noexp_changed:this.x_noexp_changed,symlog:this.swap_xy?b.symlog_y:b.symlog_x,logcheckmin:this.swap_xy,logminfactor:1e-4}),this.x_handle.assignFrameMembers(this,"x"),this.y_handle=new st.TB(this.getDom(),this.yaxis,!0),this.y_handle.setPadName(this.getPadName()),this.y_handle.setHistPainter(b.hist_painter,"y"),this.y_handle.configureAxis("yaxis",this.ymin,this.ymax,this.scale_ymin,this.scale_ymax,!this.swap_xy,this.swap_xy?[0,g]:[0,C],{reverse:this.reverse_y,log:this.swap_xy?H:X,noexp_changed:this.y_noexp_changed,symlog:this.swap_xy?b.symlog_x:b.symlog_y,logcheckmin:b.ndim<2||this.swap_xy,log_min_nz:b.ymin_nz&&b.ymin_nz<=this.ymax?.5*b.ymin_nz:0,logminfactor:Ie}),this.y_handle.assignFrameMembers(this,"y"),this.setRootPadRange(O)}createXY2(b){b||(b={ndim:this.scales_ndim??1}),this.reverse_x2=b.reverse_x||!1,this.reverse_y2=b.reverse_y||!1,this.logx2=this.logy2=0;const g=this.getFrameWidth(),C=this.getFrameHeight(),O=this.getPadPainter().getRootPad();b.second_x&&(this.scale_x2min=this.x2min,this.scale_x2max=this.x2max),b.second_y&&(this.scale_y2min=this.y2min,this.scale_y2max=this.y2max),b.extra_y_space&&b.second_y&&((this.swap_xy?O.fLogx:O.fLogy)&&this.scale_y2max>0?this.scale_y2max=Math.exp(1.1*Math.log(this.scale_y2max)):this.scale_y2max+=.1*(this.scale_y2max-this.scale_y2min)),this.zoom_x2min!==this.zoom_x2max&&b.second_x&&(this.scale_x2min=this.zoom_x2min,this.scale_x2max=this.zoom_x2max),this.zoom_y2min!==this.zoom_y2max&&b.second_y&&(this.scale_y2min=this.zoom_y2min,this.scale_y2max=this.zoom_y2max),b.second_x&&(this.x2_handle=new st.TB(this.getDom(),this.x2axis,!0),this.x2_handle.setPadName(this.getPadName()),this.x2_handle.setHistPainter(b.hist_painter,"x"),this.x2_handle.configureAxis("x2axis",this.x2min,this.x2max,this.scale_x2min,this.scale_x2max,this.swap_xy,this.swap_xy?[0,C]:[0,g],{reverse:this.reverse_x2,log:this.swap_xy?O.fLogy:O.fLogx,noexp_changed:this.x2_noexp_changed,logcheckmin:this.swap_xy,logminfactor:1e-4}),this.x2_handle.assignFrameMembers(this,"x2")),b.second_y&&(this.y2_handle=new st.TB(this.getDom(),this.y2axis,!0),this.y2_handle.setPadName(this.getPadName()),this.y2_handle.setHistPainter(b.hist_painter,"y"),this.y2_handle.configureAxis("y2axis",this.y2min,this.y2max,this.scale_y2min,this.scale_y2max,!this.swap_xy,this.swap_xy?[0,g]:[0,C],{reverse:this.reverse_y2,log:this.swap_xy?O.fLogx:O.fLogy,noexp_changed:this.y2_noexp_changed,logcheckmin:b.ndim<2||this.swap_xy,log_min_nz:b.ymin_nz&&b.ymin_nz<this.y2max?.5*b.ymin_nz:0,logminfactor:Ie}),this.y2_handle.assignFrameMembers(this,"y2"))}getGrFuncs(b,g){const C=b&&this.grx2,N=g&&this.gry2;return C||N?{use_x2:C,grx:C?this.grx2:this.grx,logx:this.logx,x_handle:C?this.x2_handle:this.x_handle,scale_xmin:C?this.scale_x2min:this.scale_xmin,scale_xmax:C?this.scale_x2max:this.scale_xmax,use_y2:N,gry:N?this.gry2:this.gry,logy:this.logy,y_handle:N?this.y2_handle:this.y_handle,scale_ymin:N?this.scale_y2min:this.scale_ymin,scale_ymax:N?this.scale_y2max:this.scale_ymax,swap_xy:this.swap_xy,fp:this,revertAxis(O,H){return"x"===O&&this.use_x2&&(O="x2"),"y"===O&&this.use_y2&&(O="y2"),this.fp.revertAxis(O,H)},axisAsText(O,H){return"x"===O&&this.use_x2&&(O="x2"),"y"===O&&this.use_y2&&(O="y2"),this.fp.axisAsText(O,H)}}:this}setRootPadRange(b,g){if(!b||!this.ranges_set)return;g?(b.fUxmin=b.fUymin=-.9,b.fUxmax=b.fUymax=.9):(b.fLogx=this.swap_xy?this.logy:this.logx,b.fUxmin=b.fLogx?Math.log10(this.scale_xmin):this.scale_xmin,b.fUxmax=b.fLogx?Math.log10(this.scale_xmax):this.scale_xmax,b.fLogy=this.swap_xy?this.logx:this.logy,b.fUymin=b.fLogy?Math.log10(this.scale_ymin):this.scale_ymin,b.fUymax=b.fLogy?Math.log10(this.scale_ymax):this.scale_ymax);const C=b.fUxmax-b.fUxmin,N=b.fUymax-b.fUymin;let O=1-b.fLeftMargin-b.fRightMargin,H=1-b.fBottomMargin-b.fTopMargin;O<=0&&(O=.01),H<=0&&(H=.01),b.fX1=b.fUxmin-C/O*b.fLeftMargin,b.fX2=b.fUxmax+C/O*b.fRightMargin,b.fY1=b.fUymin-N/H*b.fBottomMargin,b.fY2=b.fUymax+N/H*b.fTopMargin}drawGrids(b){const g=this.getFrameSvg().selectChild(".axis_layer");g.selectAll(".xgrid").remove(),g.selectAll(".ygrid").remove();const C=this.getPadPainter(),N=C?.getRootPad(!0),O=this.getFrameHeight(),H=this.getFrameWidth(),X=v.gStyle.fGridStyle;if(N?.fGridx&&b&&this.x_handle?.ticks){const ie=v.gStyle.fGridColor>0?v.gStyle.fGridColor:this.getAxis("x")?.fAxisColor??1;let z="";this.x_handle.ticks.forEach(m=>{z+=this.swap_xy?`M0,${m}h${H}`:`M${m},0v${O}`}),g.append("svg:path").attr("class","xgrid").attr("d",z).style("stroke",this.getColor(ie)||"black").style("stroke-width",v.gStyle.fGridWidth).style("stroke-dasharray",(0,Je.Ov)(X))}if(N?.fGridy&&b&&this.y_handle?.ticks){const ie=v.gStyle.fGridColor>0?v.gStyle.fGridColor:this.getAxis("y")?.fAxisColor??1;let z="";this.y_handle.ticks.forEach(m=>{z+=this.swap_xy?`M${m},0v${O}`:`M0,${m}h${H}`}),g.append("svg:path").attr("class","ygrid").attr("d",z).style("stroke",this.getColor(ie)||"black").style("stroke-width",v.gStyle.fGridWidth).style("stroke-dasharray",(0,Je.Ov)(X))}}axisAsText(b,g){const C=this[`${b}_handle`];return C?C.axisAsText(g,v.settings[b.toUpperCase()+"ValuesFormat"]):g.toPrecision(4)}hasDrawnAxes(b,g){return!b&&!g&&this.axes_drawn}drawAxes(b,g,C,N,O,H,X){var ie=this;return(0,be.A)(function*(){if(ie.cleanAxesDrawings(),ie.xmin===ie.xmax||ie.ymin===ie.ymax)return!1;void 0===N&&(N=0);const z=ie.getFrameSvg().selectChild(".axis_layer"),m=ie.getFrameWidth(),I=ie.getFrameHeight(),A=ie.getPadPainter(),R=A.getRootPad(!0),k=X&&(R?.fGridx||R?.fGridy);ie.x_handle.invert_side=N>=10,ie.x_handle.lbls_both_sides=!ie.x_handle.invert_side&&R?.fTickx>1,ie.x_handle.has_obstacle=O,ie.y_handle.invert_side=N%10==1,ie.y_handle.lbls_both_sides=!ie.y_handle.invert_side&&R?.fTicky>1,ie.y_handle.has_obstacle=H;const ee=ie.swap_xy?ie.y_handle:ie.x_handle,ge=ie.swap_xy?ie.x_handle:ie.y_handle;(!g||!C)&&A._fast_drawing&&(g=C=!0);let ve=Promise.resolve(!0);if(!g||!C||k){const Se=!b&&v.settings.CanAdjustFrame,De=ee.drawAxis(z,m,I,ee.invert_side?null:`translate(0,${I})`,R?.fTickx?-I:0,g,void 0,!1,A.getPadHeight()-I-ie.getFrameY()),Xe=ge.drawAxis(z,m,I,ge.invert_side?`translate(${m})`:null,R?.fTicky?m:0,C,ge.invert_side?0:ie._frame_x,Se);ve=Promise.all([De,Xe]).then(()=>{if(ie.drawGrids(k),!Se)return;let ct=0;const $=ge.position;return-.2*m<$&&$<0?(ct=-$/m+.001,ie.shrink_frame_left+=ct):$>0&&$<.3*m&&ie.shrink_frame_left>0&&$/m>ie.shrink_frame_left&&(ct=-ie.shrink_frame_left,ie.shrink_frame_left=0),ct?(ie.shrinkFrame(ct,0),ie.redraw().then(()=>ie.drawAxes(!0))):void 0})}return ve.then(()=>(b||(ie.axes_drawn=!0),!0))})()}drawAxes2(b,g){const C=this.getFrameSvg().selectChild(".axis_layer"),N=this.getFrameWidth(),O=this.getFrameHeight(),H=this.getPadPainter(),X=H.getRootPad(!0);b&&(this.x2_handle.invert_side=!0,this.x2_handle.lbls_both_sides=!1,this.x2_handle.has_obstacle=!1),g&&(this.y2_handle.invert_side=!0,this.y2_handle.lbls_both_sides=!1);let m,I,ie=this.swap_xy?this.y2_handle:this.x2_handle,z=this.swap_xy?this.x2_handle:this.y2_handle;return(ie||z)&&H._fast_drawing&&(ie=z=null),ie&&(m=ie.drawAxis(C,N,O,ie.invert_side?null:`translate(0,${O})`,X?.fTickx?-O:0,!1,void 0,!1)),z&&(I=z.drawAxis(C,N,O,z.invert_side?`translate(${N})`:null,X?.fTicky?N:0,!1,z.invert_side?0:this._frame_x,!1)),Promise.all([m,I])}updateAttributes(b){const g=this.getPadPainter(),C=g?.getRootPad(!0),N=this.getObject();(void 0===this.fX1NDC||b&&!this.modified_NDC)&&(C?(this.fX1NDC=C.fLeftMargin,this.fX2NDC=1-C.fRightMargin,this.fY1NDC=C.fBottomMargin,this.fY2NDC=1-C.fTopMargin):(this.fX1NDC=v.gStyle.fPadLeftMargin,this.fX2NDC=1-v.gStyle.fPadRightMargin,this.fY1NDC=v.gStyle.fPadBottomMargin,this.fY2NDC=1-v.gStyle.fPadTopMargin)),void 0===this.fillatt&&(this.createAttFill(N?{attr:N}:C?.fFrameFillColor?{pattern:C.fFrameFillStyle,color:C.fFrameFillColor}:C?{attr:C}:{pattern:1001,color:0}),!N&&this.fillatt.empty()&&g?.iscan?this.fillatt.setSolidColor("white"):4e3===C?.fFillStyle&&!this.fillatt.empty()&&this.fillatt.setOpacity(0)),this.createAttLine(N||void 0===C?.fFrameLineColor?{attr:N,color:"black"}:{color:C.fFrameLineColor,width:C.fFrameLineWidth,style:C.fFrameLineStyle})}sizeChanged(){const b=this.getPadPainter()?.getRootPad(!0);b&&(b.fLeftMargin=this.fX1NDC,b.fRightMargin=1-this.fX2NDC,b.fBottomMargin=this.fY1NDC,b.fTopMargin=1-this.fY2NDC,this.setRootPadRange(b)),this.interactiveRedraw("pad","frame")}cleanXY(){delete this.grx,delete this.gry,delete this.grz,delete this.grx2,delete this.gry2,this.x_handle?.cleanup(),this.y_handle?.cleanup(),this.z_handle?.cleanup(),this.x2_handle?.cleanup(),this.y2_handle?.cleanup(),delete this.x_handle,delete this.y_handle,delete this.z_handle,delete this.x2_handle,delete this.y2_handle}cleanAxesDrawings(){this.x_handle?.removeG(),this.y_handle?.removeG(),this.z_handle?.removeG(),this.x2_handle?.removeG(),this.y2_handle?.removeG(),this.draw_g?.selectChild(".axis_layer").selectAll("*").remove(),this.axes_drawn=!1}cleanFrameDrawings(){(0,v.isFunc)(this.create3DScene)&&this.create3DScene(-1),this.cleanAxesDrawings(),this.cleanXY(),this.ranges_set=!1,this.xmin=this.xmax=0,this.ymin=this.ymax=0,this.zmin=this.zmax=0,this.zoom_xmin=this.zoom_xmax=0,this.zoom_ymin=this.zoom_ymax=0,this.zoom_zmin=this.zoom_zmax=0,this.scale_xmin=this.scale_xmax=0,this.scale_ymin=this.scale_ymax=0,this.scale_zmin=this.scale_zmax=0,this.draw_g?.selectChild(".main_layer").selectAll("*").remove(),this.draw_g?.selectChild(".upper_layer").selectAll("*").remove(),this.xaxis=null,this.yaxis=null,this.zaxis=null,this.draw_g&&(this.draw_g.selectAll("*").remove(),this.draw_g.on("mousedown",null).on("dblclick",null).on("wheel",null).on("contextmenu",null).property("interactive_set",null),this.draw_g.remove()),delete this.draw_g,this.keys_handler&&(window.removeEventListener("keydown",this.keys_handler,!1),this.keys_handler=null)}cleanup(){this.cleanFrameDrawings(),delete this._click_handler,delete this._dblclick_handler,delete this.enabledKeys;const b=this.getPadPainter();b?.frame_painter_ref===this&&delete b.frame_painter_ref,super.cleanup()}redraw(){const b=this.getPadPainter();b&&(b.frame_painter_ref=this),this.updateAttributes();const g=b?.getPadRect()??{width:10,height:10},C=Math.round(g.width*this.fX1NDC),N=Math.round(g.height*(1-this.fY2NDC));let z,m,I,O=Math.round(g.width*(this.fX2NDC-this.fX1NDC)),H=Math.round(g.height*(this.fY2NDC-this.fY1NDC)),X=!1,ie=!1;return b?.options&&(b.options.RotateFrame&&(X=!0),b.options.FixFrame&&(ie=!0)),X?(z=`rotate(-90,${C},${N}) translate(${C-H},${N})`,[O,H]=[H,O]):z=(0,Le.bk)(C,N),this._frame_x=C,this._frame_y=N,this._frame_width=O,this._frame_height=H,this._frame_rotate=X,this._frame_fixpos=ie,this.mode3d||(this.draw_g=this.getFrameSvg(),this.draw_g.empty()?(this.draw_g=this.getLayerSvg("primitives_layer").append("svg:g").attr("class","root_frame"),this.isBatchMode()||this.draw_g.append("svg:title").text(""),m=this.draw_g.append("svg:path"),I=this.draw_g.append("svg:svg").attr("class","main_layer").attr("x",0).attr("y",0).attr("overflow","hidden"),this.draw_g.append("svg:g").attr("class","axis_layer"),this.draw_g.append("svg:g").attr("class","upper_layer")):(m=this.draw_g.selectChild("path"),I=this.draw_g.selectChild(".main_layer")),this.axes_drawn=!1,this.draw_g.attr("transform",z),m.attr("d",`M0,0H${O}V${H}H0Z`).call(this.fillatt.func).call(this.lineatt.func),I.attr("width",O).attr("height",H).attr("viewBox",`0 0 ${O} ${H}`)),this}changeAxisLog(b,g){const C=this.getPadPainter(),N=C?.getRootPad(!0);if(!N)return;C._interactively_changed=!0;const O=`fLog${b}`;return N[O]||(this.swap_xy&&"x"===b?b="y":this.swap_xy&&"y"===b&&(b="x"),this[`${b}_handle`]?.kind!==xe.ei)?(("toggle"===g||void 0===g)&&(g=N[O]?0:1),N[O]=g,this.interactiveRedraw("pad",`log${b}`)):void 0}toggleAxisLog(b){return this.changeAxisLog(b,"toggle")}fillContextMenu(b,g,C){const N=this.getMainPainter(!0),O=this.getPadPainter(),H=O?.getRootPad(!0),X="pal"===g;if(X&&(g="z"),"x"===g||"y"===g||"z"===g||"x2"===g||"y2"===g){const z=C||this[g+"axis"],m=this[`${g}_handle`];if(!(0,v.isFunc)(z?.TestBit))return!1;if(b.add(`header: ${g.toUpperCase()} axis`),b.add("Unzoom",()=>this.unzoom(g)),H){const I="fLog"+g[0];b.add("sub:SetLog "+g[0],()=>{b.input("Enter log kind: 0 - off, 1 - log10, 2 - log2, 3 - ln, ...",H[I],"int",0,1e4).then(A=>{this.changeAxisLog(g[0],A)})}),b.addchk(0===H[I],"linear",()=>this.changeAxisLog(g[0],0)),b.addchk(1===H[I],"log10",()=>this.changeAxisLog(g[0],1)),b.addchk(2===H[I],"log2",()=>this.changeAxisLog(g[0],2)),b.addchk(3===H[I],"ln",()=>this.changeAxisLog(g[0],3)),b.addchk(4===H[I],"log4",()=>this.changeAxisLog(g[0],4)),b.addchk(8===H[I],"log8",()=>this.changeAxisLog(g[0],8)),b.add("endsub:")}return b.addchk(z.TestBit(xe.rb.kMoreLogLabels),"More log",I=>{z.InvertBit(xe.rb.kMoreLogLabels),N?.snapid&&1===g.length?N.interactiveRedraw("pad",`exec:SetMoreLogLabels(${I})`,g):this.interactiveRedraw("pad")}),b.addchk(m?.noexp??z.TestBit(xe.rb.kNoExponent),"No exponent",I=>{I!==z.TestBit(xe.rb.kNoExponent)&&z.InvertBit(xe.rb.kNoExponent),m&&(m.noexp_changed=!0),this[`${g}_noexp_changed`]=!0,N?.snapid&&1===g.length?N.interactiveRedraw("pad",`exec:SetNoExponent(${I})`,g):this.interactiveRedraw("pad")}),"z"===g&&(0,v.isFunc)(N?.fillPaletteMenu)&&N.fillPaletteMenu(b,!X),m?.kind===xe.ei&&z.fNbins>20&&b.add("Find label",()=>b.input("Label id").then(I=>{if(I)for(let A=0;A<z.fNbins;++A)if(m.formatLabels(A)===I)return this.zoom(g,Math.max(0,A-4),Math.min(z.fNbins,A+5))})),b.addTAxisMenu(xe.rb,N||this,z,g),!0}const ie=0===b.size();return b.add(ie?"header:Frame":"separator"),this.zoom_xmin!==this.zoom_xmax&&b.add("Unzoom X",()=>this.unzoom("x")),this.zoom_ymin!==this.zoom_ymax&&b.add("Unzoom Y",()=>this.unzoom("y")),this.zoom_zmin!==this.zoom_zmax&&b.add("Unzoom Z",()=>this.unzoom("z")),this.zoom_x2min!==this.zoom_x2max&&b.add("Unzoom X2",()=>this.unzoom("x2")),this.zoom_y2min!==this.zoom_y2max&&b.add("Unzoom Y2",()=>this.unzoom("y2")),b.add("Unzoom all",()=>this.unzoom("all")),H&&(b.addchk(H.fLogx,"SetLogx",()=>this.toggleAxisLog("x")),b.addchk(H.fLogy,"SetLogy",()=>this.toggleAxisLog("y")),(0,v.isFunc)(N?.getDimension)&&N.getDimension()>1&&b.addchk(H.fLogz,"SetLogz",()=>this.toggleAxisLog("z")),b.add("separator")),b.addchk(this.isTooltipAllowed(),"Show tooltips",()=>this.setTooltipAllowed("toggle")),b.addAttributesMenu(this,ie?"":"Frame "),b.add("Save to gStyle",()=>{v.gStyle.fPadBottomMargin=this.fY1NDC,v.gStyle.fPadTopMargin=1-this.fY2NDC,v.gStyle.fPadLeftMargin=this.fX1NDC,v.gStyle.fPadRightMargin=1-this.fX2NDC,this.fillatt?.saveToStyle("fFrameFillColor","fFrameFillStyle"),this.lineatt?.saveToStyle("fFrameLineColor","fFrameLineWidth","fFrameLineStyle")},"Store frame position and graphical attributes to gStyle"),b.add("separator"),b.add("sub:Save as"),["svg","png","jpeg","pdf","webp"].forEach(z=>b.add(`frame.${z}`,()=>O.saveAs(z,"frame",`frame.${z}`))),b.add("endsub:"),!0}fillWebObjectOptions(b){b.fcust="frame",b.fopt=[this.scale_xmin||0,this.scale_ymin||0,this.scale_xmax||0,this.scale_ymax||0]}getFrameX(){return this._frame_x||0}getFrameY(){return this._frame_y||0}getFrameWidth(){return this._frame_width||0}getFrameHeight(){return this._frame_height||0}getFrameRect(){return{x:this._frame_x||0,y:this._frame_y||0,width:this.getFrameWidth(),height:this.getFrameHeight(),transform:this.draw_g?.attr("transform")||"",hint_delta_x:0,hint_delta_y:0}}configureUserClickHandler(b){this._click_handler=(0,v.isFunc)(b)?b:null}configureUserDblclickHandler(b){this._dblclick_handler=(0,v.isFunc)(b)?b:null}zoom(b,g,C,N,O,H){var X=this;return(0,be.A)(function*(){"x"===b?(b=g,g=C,C=void 0):"y"===b?(N=C,C=g,b=g=void 0):"z"===b&&(O=g,H=C,b=g=C=void 0);let ie=b!==g,z=C!==N,m=O!==H,I=!1,A=!1,R=!1;if(ie){let ee=0;b<=X.xmin&&(b=X.xmin,ee++),g>=X.xmax&&(g=X.xmax,ee++),2===ee&&(ie=!1,I=!0)}else I=b===g&&0===b;if(z){let ee=0;(C<=X.ymin||!X.ymin&&X.logy&&(!X.y_handle?.log_min_nz&&C<Ie*X.ymax||C<X.y_handle?.log_min_nz))&&(C=X.ymin,ee++),N>=X.ymax&&(N=X.ymax,ee++),2===ee&&1!==X.scales_ndim&&(z=!1,A=!0)}else A=C===N&&0===C;if(m){let ee=0;O<=X.zmin&&(O=X.zmin,ee++),H>=X.zmax&&(H=X.zmax,ee++),2===ee&&X.scales_ndim>2&&(m=!1,R=!0)}else R=O===H&&0===O;let k=!1;return(ie||z||m)&&X.forEachPainter(ee=>{(0,v.isFunc)(ee.canZoomInside)&&(ie&&ee.canZoomInside("x",b,g)&&(X.zoom_xmin=b,X.zoom_xmax=g,k=!0,ie=!1),z&&ee.canZoomInside("y",C,N)&&(X.zoom_ymin=C,X.zoom_ymax=N,k=!0,z=!1),m&&ee.canZoomInside("z",O,H)&&(X.zoom_zmin=O,X.zoom_zmax=H,k=!0,m=!1))}),(I||A||R)&&(I&&(X.zoom_xmin!==X.zoom_xmax&&(k=!0),X.zoom_xmin=X.zoom_xmax=0),A&&(X.zoom_ymin!==X.zoom_ymax&&(k=!0,fe(X.getMainPainter())),X.zoom_ymin=X.zoom_ymax=0),R&&(X.zoom_zmin!==X.zoom_zmax&&(k=!0),X.zoom_zmin=X.zoom_zmax=0),k||X.getPadPainter()?.painters?.forEach(ee=>{(0,v.isFunc)(ee?.unzoomUserRange)&&ee.unzoomUserRange(I,A,R)&&(k=!0)})),!!k&&X.interactiveRedraw("pad","zoom").then(()=>!0)})()}zoomSingle(b,g,C){var N=this;return(0,be.A)(function*(){if(!N[b+"_handle"])return!1;let O=g!==C,H=!1;if(O){let ie=0;g<=N[b+"min"]&&(g=N[b+"min"],ie++),C>=N[b+"max"]&&(C=N[b+"max"],ie++),2===ie&&(O=!1,H=!0)}else H=g===C&&0===g;let X=!1;return O&&N.forEachPainter(ie=>{(0,v.isFunc)(ie.canZoomInside)&&O&&ie.canZoomInside(b[0],g,C)&&(N[`zoom_${b}min`]=g,N[`zoom_${b}max`]=C,X=!0,O=!1)}),H&&(N[`zoom_${b}min`]!==N[`zoom_${b}max`]&&(X=!0,"y"===b&&fe(N.getMainPainter())),N[`zoom_${b}min`]=N[`zoom_${b}max`]=0),!!X&&N.interactiveRedraw("pad","zoom").then(()=>!0)})()}isAxisZoomed(b){return this[`zoom_${b}min`]!==this[`zoom_${b}max`]}unzoom(b,g,C){var N=this;return(0,be.A)(function*(){return"all"===b?N.unzoom("x2").then(()=>N.unzoom("y2")).then(()=>N.unzoom("xyz")):"x2"===b||"y2"===b?N.zoomSingle(b,0,0).then(O=>(O&&N.zoomChangedInteractive(b,"unzoom"),O)):(typeof b>"u"?b=g=C=!0:(0,v.isStr)(b)&&(C=b.indexOf("z")>=0,g=b.indexOf("y")>=0,b=b.indexOf("x")>=0),N.zoom(b?0:void 0,b?0:void 0,g?0:void 0,g?0:void 0,C?0:void 0,C?0:void 0).then(O=>(O&&b&&N.zoomChangedInteractive("x","unzoom"),O&&g&&N.zoomChangedInteractive("y","unzoom"),O&&C&&N.zoomChangedInteractive("z","unzoom"),O)))})()}zoomChangedInteractive(b,g){if("reset"===b)return void(this.zoom_changed_x=this.zoom_changed_y=this.zoom_changed_z=void 0);if(!b||"any"===b)return this.zoom_changed_x||this.zoom_changed_y||this.zoom_changed_z;if("x"!==b&&"y"!==b&&"z"!==b)return;const C="zoom_changed_"+b;if(void 0===g)return this[C];"unzoom"!==g?g&&(this[C]=!0):this[C]=void 0===this[C]}revertAxis(b,g){return this[`${b}_handle`]?.revertPoint(g)??0}showAxisStatus(b,g){const C=this.getAxis(b),N=(0,V.Wn)(g,this.getFrameSvg().node());let O=b,H=v.clTAxis,X="x"===b?0:1;C&&(O=C.fName,H=C.fTitle||`TAxis object for ${b}`),this.swap_xy&&(X=1-X);const ie=this.revertAxis(b,N[X]);this.showObjectStatus(O,H,`${b} : ${this.axisAsText(b,ie)}`,`${N[0]},${N[1]}`)}addKeysHandler(){this.isBatchMode()||(x.assign(this),this.addFrameKeysHandler())}addInteractivity(b){return!(this.isBatchMode()||!v.settings.Zooming&&!v.settings.ContextMenu)&&(x.assign(this),b||this.addBasicInteractivity(),this.addFrameInteractivity(b))}}},9788:(Gr,xt,Te)=>{"use strict";Te.d(xt,{DR:()=>de,O4:()=>ce,cw:()=>L,jg:()=>K});var be=Te(5774),v=Te(4186),V=Te(3324),Le=Te(139),xe=Te(165),Je=Te(2481),st=Te(9248),Ke=Te(5460),ot=Te(1564),Re=Te(9646),Qe=Te(9606),Ie=Te(5619);const L="TButton",he=(0,v.BIT)(22);function re(G,D){return Math.round((D||1)*(G.iscan||!G.has_canvas?16:12))}function fe(G,D,x){x?.preventDefault(),x?.stopPropagation();const P=G.getLayerSvg("btns_layer",G.this_pad_name),w=P.select("[name='Toggle']");if(w.empty())return;let b=w.property("buttons_state");w.property("timout_handler")&&("timeout"!==D&&clearTimeout(w.property("timout_handler")),w.property("timout_handler",null));let g=!1;switch(D){case"enable":g=!0,G.btns_active_flag=!0;break;case"enterbtn":return void(G.btns_active_flag=!0);case"timeout":g=!1;break;case"toggle":b=!b,w.property("buttons_state",b),g=b;break;case"disable":case"leavebtn":return G.btns_active_flag=!1,void(b||w.property("timout_handler",setTimeout(()=>fe(G,"timeout"),1200)))}P.selectAll("svg").each(function(){this!==w.node()&&(0,V.Lt)(this).style("display",g?"":"none")})}const de={alignButtons(G,D,x){const P=re(this,1.25),w=(G.property("nextx")||0)+P;let b,g;G.property("vertical")?(b=G.property("leftside")?2:D-P,g=x-w):(b=G.property("leftside")?2:D-w,g=x-P),(0,xe.bk)(G,b,g)},findPadButton(G){const D=this.getLayerSvg("btns_layer",this.this_pad_name);let x="";return D.empty()||D.selectAll("svg").each(function(){(0,V.Lt)(this).attr("key")===G&&(x=(0,V.Lt)(this).attr("name"))}),x},removePadButtons(){const G=this.getLayerSvg("btns_layer",this.this_pad_name);G.empty()||(G.selectAll("*").remove(),G.property("nextx",null))},showPadButtons(){const G=this.getLayerSvg("btns_layer",this.this_pad_name);if(G.empty()||(G.selectAll("*").remove(),!this._buttons))return;const D=this.iscan||!this.has_canvas;let P,w=G.property("leftside")?re(this,1.25):0;if(this._fast_drawing)P=Qe.IK.createSVG(G,Qe.IK.circle,re(this),"enlargePad",!1).attr("name","Enlarge").attr("x",0).attr("y",0).on("click",b=>this.clickPadButton("enlargePad",b));else{P=Qe.IK.createSVG(G,Qe.IK.rect,re(this),"Toggle tool buttons",!1).attr("name","Toggle").attr("x",0).attr("y",0).property("buttons_state","popup"!==v.settings.ToolBar||v.browser.touches).on("click",b=>fe(this,"toggle",b)),P.node()._mouseenter=()=>fe(this,"enable"),P.node()._mouseleave=()=>fe(this,"disable");for(let b=0;b<this._buttons.length;++b){const g=this._buttons[b];let C=g.btn;(0,v.isStr)(C)&&(C=Qe.IK[C]),C||(C=Qe.IK.circle);const N=Qe.IK.createSVG(G,C,re(this),g.tooltip+(D?"":` on pad ${this.this_pad_name}`)+(g.keyname?` (keyshortcut ${g.keyname})`:""),!1);G.property("vertical")?N.attr("x",0).attr("y",w):N.attr("x",w).attr("y",0),N.attr("name",g.funcname).style("display",P.property("buttons_state")?"":"none").attr("key",g.keyname||null).on("click",O=>this.clickPadButton(g.funcname,O)),N.node()._mouseenter=()=>fe(this,"enterbtn"),N.node()._mouseleave=()=>fe(this,"leavebtn"),w+=re(this,1.25)}}G.property("nextx",w),this.alignButtons(G,this.getPadWidth(),this.getPadHeight()),G.property("vertical")?P.attr("y",w):G.property("leftside")||P.attr("x",w)},assign(G){Object.assign(G,this)}};function ce(G){if(!G?.snapid)return null;const D={_typename:"TWebObjectOptions",snapid:G.snapid.toString(),opt:G.getDrawOpt(!0),fcust:"",fopt:[]};return(0,v.isFunc)(G.fillWebObjectOptions)&&G.fillWebObjectOptions(D),D}class K extends Je.JW{constructor(D,x,P){super(D,x),this.pad=x,this.iscan=P,this.this_pad_name="",!this.iscan&&x?.fName&&(this.this_pad_name=x.fName.replace(" ","_"),(!/^[A-Za-z][A-Za-z0-9_]*$/.test(this.this_pad_name)||"button"===this.this_pad_name&&x._typename===L)&&(this.this_pad_name="jsroot_pad_"+v.internals.id_counter++)),this.painters=[],this.has_canvas=!0,this.forEachPainter=this.forEachPainterInPad;const w=this.selectDom();!w.empty()&&w.property("_batch_mode")&&(this.batch_mode=!0)}isBatchMode(){return void 0!==this.batch_mode?this.batch_mode:!!(0,v.isBatchMode)()||!(this.iscan||!this.has_canvas)&&this.getCanvPainter()?.isBatchMode()}isRoot6(){return!0}isEditable(){return this.pad?.fEditable??!0}svg_this_pad(){return this.getPadSvg(this.this_pad_name)}getMainPainter(){return this.main_painter_ref||null}setMainPainter(D,x){(!this.main_painter_ref||x)&&(this.main_painter_ref=D)}cleanup(){this._doing_draw&&console.error("pad drawing is not completed when cleanup is called"),this.painters.forEach(x=>x.cleanup());const D=this.svg_this_pad();D.empty()||(D.property("pad_painter",null),this.iscan||D.remove()),delete this.main_painter_ref,delete this.frame_painter_ref,delete this.pads_cache,delete this.custom_palette,delete this._pad_x,delete this._pad_y,delete this._pad_width,delete this._pad_height,delete this._doing_draw,delete this._interactively_changed,delete this._snap_primitives,delete this._last_grayscale,delete this._custom_colors,delete this._custom_palette_indexes,delete this._custom_palette_colors,delete this.root_colors,this.painters=[],this.pad=null,this.this_pad_name=void 0,this.has_canvas=!1,(0,Je.QD)({pp:this,active:!1}),super.cleanup()}getFramePainter(){return this.frame_painter_ref}getPadWidth(){return this._pad_width||0}getPadHeight(){return this._pad_height||0}getPadRect(){return{x:this._pad_x||0,y:this._pad_y||0,width:this.getPadWidth(),height:this.getPadHeight()}}getPadLog(D){const x=this.getRootPad();return"x"===D?x?.fLogx:"y"===D&&(x?.fLogv??x?.fLogy)}getFrameRect(){const D=this.getFramePainter();if(D)return D.getFrameRect();const x=this.getPadWidth(),P=this.getPadHeight(),w={};return this.pad?(w.szx=Math.round(Math.max(0,.5-Math.max(this.pad.fLeftMargin,this.pad.fRightMargin))*x),w.szy=Math.round(Math.max(0,.5-Math.max(this.pad.fBottomMargin,this.pad.fTopMargin))*P)):(w.szx=Math.round(.5*x),w.szy=Math.round(.5*P)),w.width=2*w.szx,w.height=2*w.szy,w.x=Math.round(x/2-w.szx),w.y=Math.round(P/2-w.szy),w.hint_delta_x=w.szx,w.hint_delta_y=w.szy,w.transform=(0,xe.bk)(w.x,w.y)||"",w}getRootPad(D){return void 0===D||D?this.pad:null}cleanPrimitives(D){if((0,v.isFunc)(D))for(let x=this.painters.length-1;x>=0;--x)D(this.painters[x])&&(this.painters[x].cleanup(),this.painters.splice(x,1))}removePrimitive(D){const x=this.painters[D],P=[];let w=D;for(let b=this.painters.length-1;b>=0;--b)(b===D||this.painters[b].isSecondary(x))&&(P.push(this.painters[b]),this.painters.splice(b,1),b<=D&&w--);return P.forEach(b=>{b.cleanup(),this.main_painter_ref===b&&(delete this.main_painter_ref,w=-111)}),w}getCustomPalette(){return this.custom_palette||this.getCanvPainter()?.custom_palette}getNumPainters(){return this.painters.length}getAutoColor(D){D||(D=this._num_primitives||5),D<2&&(D=2);let x=this._auto_color??0;this._auto_color=(x+1)%D,x>=D&&(x=D-1);const P=this._custom_palette_indexes||this.getCanvPainter()?._custom_palette_indexes;if(P?.length)return P[Math.round(x*(P.length-3)/(D-1))];this._auto_palette||(this._auto_palette=(0,Le.jh)(v.settings.Palette,this.isGrayscale()));const w=Math.round(x*(this._auto_palette.getLength()-3)/(D-1)),b=this._auto_palette.getColor(w);return this.addColor(b)}forEachPainterInPad(D,x){x||(x="all"),"objects"!==x&&D(this);for(let P=0;P<this.painters.length;++P){const w=this.painters[P];(0,v.isFunc)(w.forEachPainterInPad)?"objects"!==x&&w.forEachPainterInPad(D,x):"pads"!==x&&D(w)}}registerForPadEvents(D){this.pad_events_receiver=D}producePadEvent(D,x,P,w,b){"select"===D&&(0,v.isFunc)(this.selectActivePad)&&this.selectActivePad(x,P,w),(0,v.isFunc)(this.pad_events_receiver)&&this.pad_events_receiver({what:D,padpainter:x,painter:P,position:w,place:b})}selectObjectPainter(D,x,P){const w=this.iscan||!this.has_canvas,b=w?this:this.getCanvPainter();void 0===D&&(D=this),x&&!w&&(x=(0,xe.md)(this.svg_this_pad(),x)),(0,Je.QD)({pp:this,active:!0}),b?.producePadEvent("select",this,D,x,P)}drawActiveBorder(D,x){if(void 0!==x){if(this.is_active_pad===x)return;this.is_active_pad=x}if(void 0===this.is_active_pad)return;D||(D=this.iscan?this.getCanvSvg().selectChild(".canvas_fillrect"):this.svg_this_pad().selectChild(".root_pad_border"));const P=this.getCanvPainter();let w=this.is_active_pad&&P?.highlight_gpad?new st.gx({style:1,width:1,color:"red"}):this.lineatt;w||(w=new st.gx({color:"none"})),D.call(w.func)}setFastDrawing(D,x){const P=this._fast_drawing;this._fast_drawing=v.settings.SmallPad&&(D<v.settings.SmallPad.width||x<v.settings.SmallPad.height),P!==this._fast_drawing&&this.showPadButtons()}isGrayscale(){return!!this.iscan&&(this.pad?.TestBit(he)??!1)}setGrayscale(D){if(!this.iscan)return;let x=!1;void 0===D?(D=this.pad?.TestBit(he)??!1,x=void 0!==this._last_grayscale&&this._last_grayscale!==D):D!==this.pad?.TestBit(he)&&(this.pad?.InvertBit(he),x=!0),x&&this.forEachPainter(P=>{delete P._color_palette}),this.root_colors=D?(0,Le.uw)(this._custom_colors):this._custom_colors,this._last_grayscale=D,this.custom_palette=this._custom_palette_colors?new Le.rE(this._custom_palette_colors,D):null}createCanvasSvg(D,x){const P=this.isBatchMode();let N,O,H,b=null,g=null,C=null;if(D>0){if(this._fixed_size)return D>1;if(g=this.getCanvSvg(),g.empty()||(b=g.property("height_factor"),C=this.testMainResize(D,null,b),!C.changed&&1===D))return!1;P||(N=this.getLayerSvg("btns_layer",this.this_pad_name)),O=this.getLayerSvg("info_layer",this.this_pad_name),H=g.selectChild(".canvas_fillrect")}else{const z=this.selectDom();"static"===z.style("position")&&z.style("position","relative"),g=z.append("svg").attr("class","jsroot root_canvas").property("pad_painter",this).property("current_pad","").property("redraw_by_resize",!1),this.setTopPainter(),P?g.attr("xmlns","http://www.w3.org/2000/svg"):this.online_canvas||g.append("svg:title").text("ROOT canvas"),(!P||this.pad.fFillStyle>0)&&(H=g.append("svg:path").attr("class","canvas_fillrect")),P||H.style("pointer-events","visibleFill").on("dblclick",m=>this.enlargePad(m,!0)).on("click",()=>this.selectObjectPainter()).on("mouseenter",()=>this.showObjectStatus()).on("contextmenu",v.settings.ContextMenu?m=>this.padContextMenu(m):null),g.append("svg:g").attr("class","primitives_layer"),O=g.append("svg:g").attr("class","info_layer"),P||(N=g.append("svg:g").attr("class","btns_layer").property("leftside","left"===v.settings.ToolBarSide).property("vertical",v.settings.ToolBarVert)),b=.66,this.pad?.fCw&&this.pad?.fCh&&this.pad?.fCw>0&&(b=this.pad.fCh/this.pad.fCw,(b<.1||b>10)&&(b=.66)),this._fixed_size?(z.style("overflow","auto"),C={width:this.pad.fCw,height:this.pad.fCh},(!C.width||!C.height)&&(C=(0,xe.xh)(z))):C=this.testMainResize(2,x,b)}this.setGrayscale(),this.createAttFill({attr:this.pad}),C.width<=5||C.height<=5?(g.style("display","none"),console.warn(`Hide canvas while geometry too small w=${C.width} h=${C.height}`),this._pad_width&&this._pad_height?(C.width=this._pad_width,C.height=this._pad_height):(C.width=800,C.height=600)):g.style("display",null),g.attr("x",0).attr("y",0).style("position","absolute"),this._fixed_size?g.attr("width",C.width).attr("height",C.height):g.style("width","100%").style("height","100%").style("left",0).style("top",0).style("bottom",0).style("right",0),g.style("filter",v.settings.DarkMode||this.pad?.$dark?"invert(100%)":null),g.attr("viewBox",`0 0 ${C.width} ${C.height}`).attr("preserveAspectRatio","none").property("height_factor",b).property("draw_x",0).property("draw_y",0).property("draw_width",C.width).property("draw_height",C.height),this._pad_x=0,this._pad_y=0,this._pad_width=C.width,this._pad_height=C.height,H&&(H.attr("d",`M0,0H${C.width}V${C.height}H0Z`).call(this.fillatt.func),this.drawActiveBorder(H)),this.setFastDrawing(C.width*(1-this.pad.fLeftMargin-this.pad.fRightMargin),C.height*(1-this.pad.fBottomMargin-this.pad.fTopMargin)),this.alignButtons&&N&&this.alignButtons(N,C.width,C.height);let X=O.selectChild(".canvas_date");if(v.gStyle.fOptDate){X.empty()&&(X=O.append("text").attr("class","canvas_date"));const z=Math.round(C.height*(1-v.gStyle.fDateY)),m=new Date;let I=Math.round(C.width*v.gStyle.fDateX);!P&&I<25&&(I=25),v.gStyle.fOptDate>3&&m.setTime(1e3*v.gStyle.fOptDate),(0,xe.bk)(X,I,z).style("text-anchor","start").text((0,xe.ic)(m))}else X.remove();const ie=this.getItemName();return ie?this.drawItemNameOnCanvas(ie):v.gStyle.fOptFile||O.selectChild(".canvas_item").remove(),!0}drawItemNameOnCanvas(D){const x=this.getLayerSvg("info_layer",this.this_pad_name);let P=x.selectChild(".canvas_item");const w=(0,Ie.gZ)().findRootFileForItem(D),b=3===v.gStyle.fOptFile?D:2===v.gStyle.fOptFile?w?._fullurl:w?._name;if(v.gStyle.fOptFile&&b){P.empty()&&(P=x.append("text").attr("class","canvas_item"));const g=this.getPadRect();(0,xe.bk)(P,Math.round(g.width*(1-v.gStyle.fDateX)),Math.round(g.height*(1-v.gStyle.fDateY))).style("text-anchor","end").text(b)}else P.remove();(2===v.gStyle.fOptDate||3===v.gStyle.fOptDate)&&w?._file&&x.selectChild(".canvas_date").text((0,xe.ic)(2===v.gStyle.fOptDate?w._file.fDatimeC.getDate():w._file.fDatimeM.getDate()))}isPadEnlarged(){return this.iscan||!this.has_canvas?"on"===this.enlargeMain("state"):this.getCanvSvg().property("pad_enlarged")===this.pad}enlargePad(D,x,P){if(D?.preventDefault(),D?.stopPropagation(),x&&this._websocket&&"off"===this.enlargeMain("state"))return;const w=this.getCanvSvg(),b=w.property("pad_enlarged");if(!this.iscan&&this.has_canvas&&(b||this.hasObjectsToDraw()||this.painters))b||P?b===this.pad?(this.enlargeMain(!1),w.property("pad_enlarged",null)):!P&&x&&console.error("missmatch with pad double click events"):(this.enlargeMain(!0,!0),w.property("pad_enlarged",this.pad),(0,Je.QD)({pp:this,active:!0}));else{if(this._fixed_size||!this.enlargeMain(!P&&"toggle"))return;"off"===this.enlargeMain("state")?w.property("pad_enlarged",null):(0,Je.QD)({pp:this,active:!0})}return this.checkResize(!0)}createPadSvg(D){if(!this.has_canvas)return this.createCanvasSvg(D?2:0),!0;const x=this.getCanvSvg(),P=x.property("draw_width"),w=x.property("draw_height"),b=x.property("pad_enlarged"),g=!(this.pad_draw_disabled||b&&b!==this.pad),C=this.isBatchMode();let ie,z,m,N=Math.round(this.pad.fAbsWNDC*P),O=Math.round(this.pad.fAbsHNDC*w),H=Math.round(this.pad.fAbsXlowNDC*P),X=Math.round(w*(1-this.pad.fAbsYlowNDC))-O;if(b===this.pad&&(N=P,O=w,H=X=0),D?(ie=this.svg_this_pad(),z=ie.selectChild(".root_pad_border"),C||(m=this.getLayerSvg("btns_layer",this.this_pad_name)),this.addPadInteractive(!0)):(ie=x.selectChild(".primitives_layer").append("svg:svg").classed("__root_pad_"+this.this_pad_name,!0).attr("pad",this.this_pad_name).property("pad_painter",this),C||ie.append("svg:title").text("subpad "+this.this_pad_name),(!C||this.pad.fFillStyle>0||this.pad.fLineStyle>0&&this.pad.fLineColor>0)&&(z=ie.append("svg:path").attr("class","root_pad_border")),C||z.style("pointer-events","visibleFill").on("dblclick",I=>this.enlargePad(I,!0)).on("click",()=>this.selectObjectPainter()).on("mouseenter",()=>this.showObjectStatus()).on("contextmenu",v.settings.ContextMenu?I=>this.padContextMenu(I):null),ie.append("svg:g").attr("class","primitives_layer"),C||(m=ie.append("svg:g").attr("class","btns_layer").property("leftside","left"!==v.settings.ToolBarSide).property("vertical",v.settings.ToolBarVert))),this.createAttFill({attr:this.pad}),this.createAttLine({attr:this.pad,color0:this.pad.fBorderMode?"":"none"}),ie.style("display",g?null:"none").attr("viewBox",`0 0 ${N} ${O}`).attr("preserveAspectRatio","none").attr("x",H).attr("y",X).attr("width",N).attr("height",O).property("draw_x",H).property("draw_y",X).property("draw_width",N).property("draw_height",O),this._pad_x=H,this._pad_y=X,this._pad_width=N,this._pad_height=O,z){z.attr("d",`M0,0H${N}V${O}H0Z`).call(this.fillatt.func).call(this.lineatt.func),this.drawActiveBorder(z);let I=ie.selectChild(".root_pad_border1"),A=ie.selectChild(".root_pad_border2");if(this.pad.fBorderMode&&this.pad.fBorderSize){const R=this.pad.fBorderSize,k=this.pad.fBorderSize,ee=`M0,0h${N}l${-R},${k}h${2*R-N}v${O-2*k}l${-R},${k}z`,ge=`M${N},${O}v${-O}l${-R},${k}v${O-2*k}h${2*R-N}l${-R},${k}z`;A.empty()&&(A=ie.insert("svg:path",".primitives_layer").attr("class","root_pad_border2")),I.empty()&&(I=ie.insert("svg:path",".primitives_layer").attr("class","root_pad_border1")),I.attr("d",this.pad.fBorderMode>0?ee:ge).call(this.fillatt.func).style("fill",(0,V.Qh)(this.fillatt.color).brighter(.5).formatHex()),A.attr("d",this.pad.fBorderMode>0?ge:ee).call(this.fillatt.func).style("fill",(0,V.Qh)(this.fillatt.color).darker(.5).formatHex())}else I.remove(),A.remove()}return this.setFastDrawing(N*(1-this.pad.fLeftMargin-this.pad.fRightMargin),O*(1-this.pad.fBottomMargin-this.pad.fTopMargin)),ie.property("can3d")===v.constants.Embed3D.Overlay&&this.selectDom().select(".draw3d_"+this.this_pad_name).style("display",g?"":"none"),this.alignButtons&&m&&this.alignButtons(m,N,O),g}addPadInteractive(D=!1){if((0,v.isFunc)(this.$userInteractive)&&(this.$userInteractive(),delete this.$userInteractive),this.isBatchMode()||this.iscan)return;const x=this.getCanvSvg(),P=x.property("draw_width"),w=x.property("draw_height");(0,ot.WJ)(this,{cleanup:D,x:this._pad_x,y:this._pad_y,width:this._pad_width,height:this._pad_height,no_transform:!0,only_resize:!0,is_disabled:b=>x.property("pad_enlarged")||this.btns_active_flag||"move"===b&&(this._disable_dragging||this.getFramePainter()?.mode3d),getDrawG:()=>this.svg_this_pad(),pad_rect:{width:P,height:w},minwidth:20,minheight:20,move_resize:(b,g,C,N)=>{const O=this.pad.fAbsXlowNDC,H=this.pad.fAbsYlowNDC,X=C/P/this.pad.fAbsWNDC,ie=N/w/this.pad.fAbsHNDC,z=b/P-O,m=1-(g+N)/w-H;this.forEachPainterInPad(I=>{I.pad.fAbsXlowNDC+=(I.pad.fAbsXlowNDC-O)*(X-1)+z,I.pad.fAbsYlowNDC+=(I.pad.fAbsYlowNDC-H)*(ie-1)+m,I.pad.fAbsWNDC*=X,I.pad.fAbsHNDC*=ie},"pads")},redraw:()=>this.interactiveRedraw("pad","padpos")})}disablePadDrawing(){!this.pad_draw_disabled&&this.has_canvas&&!this.iscan&&(this.pad_draw_disabled=!0,this.createPadSvg(!0))}checkSpecial(D){if(!D)return!1;if(D._typename===v.clTStyle)return Object.assign(v.gStyle,D),!0;if(D._typename===v.clTObjArray&&"ListOfColors"===D.name){if(this.options?.CreatePalette){let x=[];for(let P=D.arr.length-this.options.CreatePalette;P<D.arr.length;++P){const w=(0,Le.d_)(D.arr[P]);if(!w){console.log("Fail to create color for palette"),x=null;break}x.push(w)}x&&(this.custom_palette=new Le.rE(x))}return(!this.options||this.options.GlobalColors)&&(0,Le.np)(D),this._custom_colors=this.options?.LocalColors?(0,Le.TZ)(null,D):null,!0}if(D._typename===v.clTObjArray&&"CurrentColorPalette"===D.name){const x=[],P=[];let w=!1;for(let g=0;g<D.arr.length;++g){const C=D.arr[g];C?._typename===v.clTColor?(P[g]=C.fNumber,x[g]=(0,Le.d_)(C)):(console.log(`Missing color with index ${g}`),w=!0)}const b=!this.options||!w&&!this.options.IgnorePalette;return this._custom_palette_indexes=b?P:null,this._custom_palette_colors=b?x:null,!0}return!1}checkSpecialsInPrimitives(D){const x=D?.fPrimitives;if(x)for(let P=0;P<x.arr?.length;++P)this.checkSpecial(x.arr[P])&&(x.arr.splice(P,1),x.opt.splice(P,1),P--)}findInPrimitives(D,x){const P=b=>b&&b?.fName===D&&(!x||b?._typename===x),w=this._snap_primitives?.find(b=>P(1===b.fKind?b.fSnapshot:null));return w?w.fSnapshot:this.pad?.fPrimitives?.arr.find(P)}findPainterFor(D,x,P){return this.painters.find(w=>{const b=w.getObject();return!(!b||(!D||b!==D)&&(!x&&!P||x&&b.fName!==x||P&&b._typename!==P))})}hasObjectsToDraw(){return this.pad?.fPrimitives?.arr?.find(D=>D._typename!==v.clTPad)}syncDraw(D){const x={kind:D||"redraw"};return void 0===this._doing_draw?(this._doing_draw=[x],Promise.resolve(!0)):!(!0!==x.kind&&this._doing_draw.findIndex((P,w)=>w>0&&P.kind===x.kind)>0)&&(this._doing_draw.push(x),new Promise(P=>{x.func=P}))}doingDraw(){return void 0!==this._doing_draw}confirmDraw(){if(void 0===this._doing_draw)return console.warn("failure, should not happen");if(this._doing_draw.shift(),0===this._doing_draw.length)delete this._doing_draw;else{const D=this._doing_draw[0];D.func&&(D.func(),delete D.func)}}drawObject(){return(0,be.A)(function*(){return console.log("Not possible to draw object without loading of draw.mjs"),null})()}drawPrimitives(D){var x=this;return(0,be.A)(function*(){if(void 0===D)return x.iscan&&(x._start_tm=(new Date).getTime()),x._num_primitives=x.pad?.fPrimitives?.arr?.length||0,x.syncDraw(!0).then(()=>x.drawPrimitives(0));if(!x.pad||D>=x._num_primitives){if(x._start_tm){const w=(new Date).getTime()-x._start_tm;w>1e3&&console.log(`Canvas ${x.pad?.fName||"---"} drawing took ${(.001*w).toFixed(2)}s`),delete x._start_tm}return void x.confirmDraw()}const P=x.pad.fPrimitives.arr[D];return!P||D>0&&P._typename===v.clTFrame&&x.getFramePainter()?x.drawPrimitives(D+1):x.drawObject(x.getDom(),P,x.pad.fPrimitives.opt[D]).then(w=>((0,v.isObject)(w)&&(w._primitive=!0),x.drawPrimitives(D+1)))})()}divide(D,x){var P=this;return(0,be.A)(function*(){if(!P.pad.Divide(D,x))return P;const w=b=>b>=P.pad.fPrimitives.arr.length?P:P.drawObject(P.getDom(),P.pad.fPrimitives.arr[b]).then(()=>w(b+1));return w(0)})()}getSubPadPainter(D){for(let x=0;x<this.painters.length;++x){const P=this.painters[x];if(P.pad&&(0,v.isFunc)(P.forEachPainterInPad)&&P.pad.fNumber===D)return P}return null}processPadTooltipEvent(D){const x=[],P=[];return this.painters?.forEach(w=>{(0,v.isFunc)(w.processTooltipEvent)&&x.push(w)}),D&&(D.nproc=x.length),x.forEach(w=>{const b=w.processTooltipEvent(D)||{user_info:null};P.push(b),D?.painters&&(b.painter=w)}),P}changeDarkMode(D){this.getCanvSvg().style("filter",D??v.settings.DarkMode?"invert(100%)":null)}fillContextMenu(D){if(D.add(this.pad?`header:${this.pad._typename}::${this.pad.fName}`:"header:Canvas"),D.addchk(this.isTooltipAllowed(),"Show tooltips",()=>this.setTooltipAllowed("toggle")),!this._websocket){let P=function(w){this.pad[w.slice(1)]=parseInt(w[0]),this.interactiveRedraw("pad",w.slice(1))};D.addchk(this.pad?.fGridx,"Grid x",(this.pad?.fGridx?"0":"1")+"fGridx",P),D.addchk(this.pad?.fGridy,"Grid y",(this.pad?.fGridy?"0":"1")+"fGridy",P),D.add("sub:Ticks x"),D.addchk(0===this.pad?.fTickx,"normal","0fTickx",P),D.addchk(1===this.pad?.fTickx,"ticks on both sides","1fTickx",P),D.addchk(2===this.pad?.fTickx,"labels on both sides","2fTickx",P),D.add("endsub:"),D.add("sub:Ticks y"),D.addchk(0===this.pad?.fTicky,"normal","0fTicky",P),D.addchk(1===this.pad?.fTicky,"ticks on both sides","1fTicky",P),D.addchk(2===this.pad?.fTicky,"labels on both sides","2fTicky",P),D.add("endsub:"),D.addchk(this.pad?.fEditable,"Editable",w=>{this.pad.fEditable=w,this.interactiveRedraw("pad")}),this.iscan&&D.addchk(this.pad?.TestBit(he),"Gray scale",w=>{this.setGrayscale(w),this.interactiveRedraw("pad")}),(0,v.isFunc)(this.drawObject)&&D.add("Build legend",()=>this.buildLegend()),D.addAttributesMenu(this),D.add("Save to gStyle",()=>{this.pad&&(this.fillatt?.saveToStyle(this.iscan?"fCanvasColor":"fPadColor"),v.gStyle.fPadGridX=this.pad.fGridx,v.gStyle.fPadGridY=this.pad.fGridy,v.gStyle.fPadTickX=this.pad.fTickx,v.gStyle.fPadTickY=this.pad.fTicky,v.gStyle.fOptLogx=this.pad.fLogx,v.gStyle.fOptLogy=this.pad.fLogy,v.gStyle.fOptLogz=this.pad.fLogz)},"Store pad fill attributes, grid, tick and log scale settings to gStyle"),this.iscan&&D.addSettingsMenu(!1,!1,w=>{"dark"===w&&this.changeDarkMode()})}D.add("separator"),(0,v.isFunc)(this.hasMenuBar)&&(0,v.isFunc)(this.actiavteMenuBar)&&D.addchk(this.hasMenuBar(),"Menu bar",P=>this.actiavteMenuBar(P)),(0,v.isFunc)(this.hasEventStatus)&&(0,v.isFunc)(this.activateStatusBar)&&(0,v.isFunc)(this.canStatusBar)&&this.canStatusBar()&&D.addchk(this.hasEventStatus(),"Event status",()=>this.activateStatusBar("toggle")),(this.enlargeMain()||this.has_canvas&&this.hasObjectsToDraw())&&D.addchk(this.isPadEnlarged(),"Enlarge "+(this.iscan?"canvas":"pad"),()=>this.enlargePad());const x=this.this_pad_name||(this.iscan?"canvas":"pad");return D.add("sub:Save as"),["svg","png","jpeg","pdf","webp"].forEach(P=>D.add(`${x}.${P}`,()=>this.saveAs(P,this.iscan,`${x}.${P}`))),D.add("endsub:"),!0}padContextMenu(D){var x=this;return(0,be.A)(function*(){return D.stopPropagation&&(D.stopPropagation(),D.preventDefault(),x.getFramePainter()?.setLastEventPos()),(0,Re.ES)(D,x).then(P=>(x.fillContextMenu(P),x.fillObjectExecMenu(P,""))).then(P=>P.show())})()}redrawPad(D){var x=this;return(0,be.A)(function*(){const P=x.syncDraw(D);if(!1===P)return console.log(`Prevent redrawing of ${x.pad.fName}`),!1;let w=!0;const b=g=>{for(;g<x.painters.length;){const C=x.painters[g++];let N=0;if((w||C.this_pad_name)&&(N=C.redraw(D)),(0,v.isPromise)(N))return N.then(()=>b(g))}return!0};return P.then(()=>(x.iscan?x.createCanvasSvg(2):w=x.createPadSvg(!0),b(0))).then(()=>(x.addPadInteractive(),x.confirmDraw(),(0,Je.OZ)()===x&&x.getCanvPainter()?.producePadEvent("padredraw",x),!0))})()}redraw(D){this.redrawPad(D)}needRedrawByResize(){const D=this.svg_this_pad();return!D.empty()&&D.property("can3d")===v.constants.Embed3D.Overlay||this.painters.findIndex(x=>!!(0,v.isFunc)(x.needRedrawByResize)&&x.needRedrawByResize())>=0}checkCanvasResize(D,x){if(this._ignore_resize||!this.iscan&&this.has_canvas)return!1;const P=this.syncDraw("canvas_resize");if(!1===P)return!1;(!0===D||!1===D)&&(x=D,D=null),(0,v.isObject)(D)&&D.force&&(x=!0),x||(x=this.needRedrawByResize());let w=!1;const b=g=>!w||g>=this.painters.length?(this.confirmDraw(),w):(0,v.getPromise)(this.painters[g].redraw(x?"redraw":"resize")).then(()=>b(g+1));return P.then(()=>(w=this.createCanvasSvg(x?2:1,D),w&&this.iscan&&this.pad&&this.online_canvas&&!this.embed_canvas&&!this.isBatchMode()&&(this._resize_tmout&&clearTimeout(this._resize_tmout),this._resize_tmout=setTimeout(()=>{delete this._resize_tmout,(0,v.isFunc)(this.sendResized)&&this.sendResized()},1e3)),b(0)))}updateObject(D){if(!D)return!1;this.pad.fBits=D.fBits,this.pad.fTitle=D.fTitle,this.pad.fGridx=D.fGridx,this.pad.fGridy=D.fGridy,this.pad.fTickx=D.fTickx,this.pad.fTicky=D.fTicky,this.pad.fLogx=D.fLogx,this.pad.fLogy=D.fLogy,this.pad.fLogz=D.fLogz,this.pad.fUxmin=D.fUxmin,this.pad.fUxmax=D.fUxmax,this.pad.fUymin=D.fUymin,this.pad.fUymax=D.fUymax,this.pad.fX1=D.fX1,this.pad.fX2=D.fX2,this.pad.fY1=D.fY1,this.pad.fY2=D.fY2,this.pad.fLeftMargin=D.fLeftMargin,this.pad.fRightMargin=D.fRightMargin,this.pad.fBottomMargin=D.fBottomMargin,this.pad.fTopMargin=D.fTopMargin,this.pad.fFillColor=D.fFillColor,this.pad.fFillStyle=D.fFillStyle,this.pad.fLineColor=D.fLineColor,this.pad.fLineStyle=D.fLineStyle,this.pad.fLineWidth=D.fLineWidth,this.pad.fPhi=D.fPhi,this.pad.fTheta=D.fTheta,this.pad.fEditable=D.fEditable,this.iscan&&this.checkSpecialsInPrimitives(D);const x=this.getFramePainter();if(x&&x.updateAttributes(!x.modified_NDC),!D.fPrimitives)return!1;let P=!1,w=0;for(let b=0;b<D.fPrimitives.arr?.length;++b)for(;w<this.painters.length;){const g=this.painters[w++];if(g._primitive){g.updateObject(D.fPrimitives.arr[b],D.fPrimitives.opt[b])&&(P=!0);break}}return P}buildLegend(D,x,P,w,b,g){var C=this;return(0,be.A)(function*(){const N=C.findPainterFor(null,"",v.clTLegend);if(!N&&!(0,v.isFunc)(C.drawObject))return Promise.reject(Error("Not possible to build legend while module draw.mjs was not load"));const O=N?.getObject()??(0,v.create)(v.clTLegend),H=C.getRootPad(!0);O.fPrimitives.Clear();for(let m=0;m<C.painters.length;++m){const I=C.painters[m],A=I.getObject();if(!A||A.fName===v.kTitle||"stats"===A.fName||!1===I.draw_content||A._typename===v.clTLegend||A._typename===v.clTHStack||A._typename===v.clTMultiGraph)continue;const R=(0,v.create)(v.clTLegendEntry);R.fObject=A,R.fLabel=I.getItemName(),("all"===g||!R.fLabel)&&(R.fLabel=A.fName),R.fOption="",R.fLabel&&(I.lineatt?.used&&(R.fOption+="l"),I.fillatt?.used&&(R.fOption+="f"),I.markeratt?.used&&(R.fOption+="p"),R.fOption||(R.fOption="l"),O.fPrimitives.Add(R))}if(N)return N.redraw();let ie=O.fPrimitives.arr.length;if(!ie)return null;ie>8&&(ie=8),ie*=.1,D===P||x===w?(O.fX1NDC=.4*H.fLeftMargin+.6*(1-H.fRightMargin),O.fY1NDC=(1-ie)*(1-H.fTopMargin)+ie*H.fBottomMargin,O.fX2NDC=.99-H.fRightMargin,O.fY2NDC=.99-H.fTopMargin,void 0===g&&(g="autoplace")):(O.fX1NDC=D,O.fY1NDC=x,O.fX2NDC=P,O.fY2NDC=w),O.fFillStyle=1001,O.fTitle=b??"";const z=C.has_canvas?C.selectCurrentPad(C.this_pad_name):void 0;return C.drawObject(C.getDom(),O,g).then(m=>(C.selectCurrentPad(z),m))})()}addObjectPainter(D,x,P){if(D&&x&&x[P]&&void 0===D.snapid){this.painters.indexOf(D)<0&&this.painters.push(D),D.snapid=x[P].fObjectID;const w=b=>{if(b._unique_painter_id)for(let g=0;g<this.painters.length;++g){const C=this.painters[g];C._main_painter_id===b._unique_painter_id&&C._secondary_id&&(C.snapid=b.snapid+"#"+C._secondary_id,w(C))}};w(D)}}processSnapStyle(D){Object.assign(v.gStyle,D.fSnapshot)}processSnapColors(D){const x=(0,Le.LQ)(D.fSnapshot.fOper);(!this.options||this.options.GlobalColors)&&(0,Le.np)(x);const P=this.pad?.TestBit(he)??!1,w=(0,Le.TZ)(null,x,P);if(this._custom_colors=this.options?.LocalColors?w:null,!D.fSnapshot.fBuf||this.options&&this.options.IgnorePalette)delete this._custom_palette_indexes,delete this._custom_palette_colors,delete this.custom_palette;else{const b=[],g=[];for(let C=0;C<D.fSnapshot.fBuf.length;++C)b[C]=Math.round(D.fSnapshot.fBuf[C]),g[C]=w[b[C]];this._custom_palette_indexes=b,this._custom_palette_colors=g,this.custom_palette=new Le.rE(g,P)}}processSnapFont(D){const x=D.fSnapshot.fOper.split(":");(0,Ke.uT)(Number.parseInt(x[0]),x[1],x[2],x[3])}processSpecialSnaps(D){for(;D?.length;){const x=D[0];if(5===x.fKind)D.shift(),this.processSnapStyle(x);else if(4===x.fKind)D.shift(),this.processSnapColors(x);else{if(6!==x.fKind)break;D.shift(),this.processSnapFont(x)}}}drawNextSnap(D,x){var P=this;return(0,be.A)(function*(){if(void 0===x&&(x=-1,P._snaps_map={},P._num_primitives=D?D.length:0),++x,!D||x>=D.length)return delete P._snaps_map,P;const w=D[x];if(5===w.fKind)return P.processSnapStyle(w),P.drawNextSnap(D,x);if(4===w.fKind)return P.processSnapColors(w),P.drawNextSnap(D,x);const b=w.fObjectID,g=1===w.fKind&&w.fSnapshot?._typename===v.clTFrame;let C=(P._snaps_map[b]||0)+1,N=null;P._snaps_map[b]=C;for(let O=0;O<P.painters.length;++O){const H=P.painters[O];if(H.snapid===b){if(0==--C){N=H;break}}else if(g&&!H.snapid&&H===P.getFramePainter()){H.snapid=b,N=H;break}}if(N){if(3===w.fKind)return N.redrawPadSnap(w).then(()=>P.drawNextSnap(D,x));let O;return 1===w.fKind?N.updateObject(w.fSnapshot,w.fOption,!0)&&(O=N.redraw()):2===w.fKind&&N.updateObject(w.fSnapshot)&&(O=N.redraw()),(0,v.getPromise)(O).then(()=>P.drawNextSnap(D,x))}if(3===w.fKind){const O=w.fSnapshot;O.fPrimitives=null;const H=new K(P.getDom(),O,!1);H.decodeOptions(w.fOption),H.addToPadPrimitives(P.this_pad_name),H.snapid=w.fObjectID,H.is_active_pad=!!w.fActive,H._readonly=w.fReadOnly??!1,H._snap_primitives=w.fPrimitives,H._has_execs=w.fHasExecs??!1,O.$disable_drawing&&(H.pad_draw_disabled=!0),H.processSpecialSnaps(w.fPrimitives),H.createPadSvg(),H.matchObjectType(v.clTPad)&&w.fPrimitives.length>0&&H.addPadButtons(!0);const X=H.selectCurrentPad(H.this_pad_name);return H.drawNextSnap(w.fPrimitives).then(()=>(H.addPadInteractive(),H.selectCurrentPad(X),P.drawNextSnap(D,x)))}return 1!==w.fKind&&2!==w.fKind||"__ignore_drawing__"===w.fOption?P.drawNextSnap(D,x):P.drawObject(P.getDom(),w.fSnapshot,w.fOption).then(O=>(P.addObjectPainter(O,D,x),P.drawNextSnap(D,x)))})()}findSnap(D){if(this.snapid===D)return this;if(!this.painters)return null;for(let x=0;x<this.painters.length;++x){let P=this.painters[x];if((0,v.isFunc)(P.findSnap)?P=P.findSnap(D):P.snapid!==D&&(P=null),P)return P}return null}redrawPadSnap(D){var x=this;return(0,be.A)(function*(){if(!D?.fPrimitives)return x;x.is_active_pad=!!D.fActive,x._readonly=D.fReadOnly??!1,x._snap_primitives=D.fPrimitives,x._has_execs=D.fHasExecs??!1;const P=D.fSnapshot;if(P.fPrimitives=null,x._deliver_webcanvas_events=P.fExecs?.arr?.length>0,void 0===x.snapid){x.snapid=D.fObjectID,x.draw_object=x.pad=P,x.isBatchMode()&&(!P.fCw||!P.fCh)&&(P.fCw=900,P.fCh=700),(!P.fCw||!P.fCh)&&(x._fixed_size=!1);const N=x.selectDom().attr("id");!x.isBatchMode()&&!x.use_openui&&!x.brlayout&&N&&(0,v.isStr)(N)&&(x.brlayout=new Ie.jX(N,null,x),x.brlayout.create(N,!0),x.setDom(x.brlayout.drawing_divid()),(0,Qe.d7)(x.brlayout)),x.processSpecialSnaps(D.fPrimitives),x.createCanvasSvg(0),x.isBatchMode()||x.addPadButtons(!0),typeof D.fHighlightConnect<"u"&&(x._highlight_connect=D.fHighlightConnect);let O=Promise.resolve(!0);if((0,v.isStr)(D.fScripts)&&D.fScripts){let H="";0===D.fScripts.indexOf("load:")?H=D.fScripts.slice(5).split(";"):0===D.fScripts.indexOf("assert:")&&(H=D.fScripts.slice(7)),O=H?(0,v.loadScript)(H):(0,v.injectCode)(D.fScripts)}return O.then(()=>x.drawNextSnap(D.fPrimitives))}x.updateObject(P),x.iscan?x.createCanvasSvg(2):x.createPadSvg(!0);const w=(N,O,H,X)=>{const ie=N.find(m=>!(void 0===m.snapid||!m.matchObjectType(H)||X&&(!m.getObject()||m.getObject().fName!==X)));if(!ie)return;const z=O.find(m=>!(1!==m.fKind||!m.fSnapshot||m.fSnapshot._typename!==H||X&&m.fSnapshot.fName!==X));z&&ie.snapid!==z.fObjectID&&(ie.snapid=z.fObjectID)};D.fWithoutPrimitives||(w(x.painters,D.fPrimitives,v.clTFrame),w(x.painters,D.fPrimitives,v.clTPaveText,v.kTitle));let b=!1,g=!1;if(!D.fWithoutPrimitives)for(let N=0;N<x.painters.length;++N){const O=x.painters[N];if(!(0,v.isStr)(O.snapid)||O.isSecondary())continue;const H=D.fPrimitives.find(X=>X.fObjectID===O.snapid&&!X.$checked);if(H)b=!0,H.$checked=!0;else if(N=x.removePrimitive(N),g=!0,-111===N){b=!1;break}}if(g&&delete x.pads_cache,!b&&!D.fWithoutPrimitives){const N=x.getFramePainter(),O=x.painters;x.painters=[],O.forEach(H=>{N!==H&&H.cleanup()}),delete x.main_painter_ref,N&&(x.painters.push(N),N.cleanFrameDrawings(),N.redraw()),(0,v.isFunc)(x.removePadButtons)&&x.removePadButtons(),x.addPadButtons(!0)}const C=x.selectCurrentPad(x.this_pad_name);return x.drawNextSnap(D.fPrimitives).then(()=>(x.addPadInteractive(),x.selectCurrentPad(C),(0,Je.OZ)()===x&&x.getCanvPainter()?.producePadEvent("padredraw",x),x))})()}deliverWebCanvasEvent(D,x,P,w){if(!this._deliver_webcanvas_events||!this.is_active_pad||this.doingDraw()||void 0===x||void 0===P)return;const b=this.getCanvPainter();if(!b||!b._websocket||!b._websocket.canSend(2)||b._readonly)return;let g="";w&&w[0]&&w[0].painter?.snapid&&(g=w[0].painter.snapid.toString());const C=JSON.stringify([this.snapid,D,x.toString(),P.toString(),g]);b.sendWebsocket(`EVENT:${C}`)}createImage(D){var x=this;return(0,be.A)(function*(){return"png"===D||"jpeg"===D||"svg"===D||"pdf"===D?x.produceImage(!0,D).then(P=>{if(!P||"svg"===D)return P;const w=P.indexOf("base64,");return w>0?P.slice(w+7):""}):""})()}getWebPadOptions(D,x){let P=void 0===D,w=null,b=!0;if(P&&this._readonly)return"";if("only_this"===D?(P=!0,b=!1):"with_subpads"===D&&(P=!0,b=!0),P&&(D=[]),x||(x=this.iscan?this:this.getCanvPainter()),this.snapid){if(w={_typename:"TWebPadOptions",snapid:this.snapid.toString(),active:!!this.is_active_pad,cw:0,ch:0,w:[],bits:0,primitives:[],logx:this.pad.fLogx,logy:this.pad.fLogy,logz:this.pad.fLogz,gridx:this.pad.fGridx,gridy:this.pad.fGridy,tickx:this.pad.fTickx,ticky:this.pad.fTicky,mleft:this.pad.fLeftMargin,mright:this.pad.fRightMargin,mtop:this.pad.fTopMargin,mbottom:this.pad.fBottomMargin,xlow:0,ylow:0,xup:1,yup:1,zx1:0,zx2:0,zy1:0,zy2:0,zz1:0,zz2:0},this.iscan)w.bits=this.getStatusBits(),w.cw=this.getPadWidth(),w.ch=this.getPadHeight(),w.w=[window.screenLeft,window.screenTop,window.outerWidth,window.outerHeight];else if(x){const g=x.getPadWidth(),C=x.getPadHeight(),N=this.getPadRect();w.cw=g,w.ch=C,w.xlow=N.x/g,w.ylow=1-(N.y+N.height)/C,w.xup=w.xlow+N.width/g,w.yup=w.ylow+N.height/C}this.getPadRanges(w)?D.push(w):console.log(`fail to get ranges for pad ${this.pad.fName}`)}return this.painters.forEach(g=>{if((0,v.isFunc)(g.getWebPadOptions))b&&g.getWebPadOptions(D,x);else{const C=ce(g);C&&w.primitives.push(C)}}),P?(0,v.toJSON)(D):void 0}getPadRanges(D){if(!D)return!1;const x=this.getFramePainter(),P=this.svg_this_pad();if(D.ranges=x?.ranges_set??!1,D.ux1=D.px1=D.ranges?x.scale_xmin:0,D.uy1=D.py1=D.ranges?x.scale_ymin:0,D.ux2=D.px2=D.ranges?x.scale_xmax:0,D.uy2=D.py2=D.ranges?x.scale_ymax:0,D.uz1=D.ranges?x.scale_zmin??0:0,D.uz2=D.ranges?x.scale_zmax??0:0,x&&(x.zoom_xmin!==x.zoom_xmax&&(D.zx1=x.zoom_xmin,D.zx2=x.zoom_xmax),x.zoom_ymin!==x.zoom_ymax&&(D.zy1=x.zoom_ymin,D.zy2=x.zoom_ymax),x.zoom_zmin!==x.zoom_zmax&&(D.zz1=x.zoom_zmin,D.zz2=x.zoom_zmax)),!D.ranges||P.empty())return!0;const w=(C,N,O)=>C?N<=0?O:(N=Math.log10(N),C>1&&(N/=Math.log10(C)),N):N,b=x.getFrameRect();D.ux1=w(x.logx,D.ux1,0),D.ux2=w(x.logx,D.ux2,1);let g=(D.ux2-D.ux1)/(b.width||10);return D.px1=D.ux1-g*b.x,D.px2=D.px1+g*this.getPadWidth(),D.uy1=w(x.logy,D.uy1,0),D.uy2=w(x.logy,D.uy2,1),g=(D.uy2-D.uy1)/(b.height||10),D.py1=D.uy1-g*b.y,D.py2=D.py1+g*this.getPadHeight(),!0}itemContextMenu(D){const x=this.svg_this_pad().node().getBoundingClientRect(),P={clientX:x.left+10,clientY:x.top+10};if("pad"===D)return(0,v.postponePromise)(()=>this.padContextMenu(P),50);let b,w=null;switch(D){case"xaxis":case"yaxis":case"zaxis":w=this.getFramePainter(),b=D[0];break;case"frame":w=this.getFramePainter();break;default:{const g=parseInt(D);Number.isInteger(g)&&(w=this.painters[g])}}return(0,v.isFunc)(w?.fillContextMenu)?(0,Re.ES)(P,w).then(g=>{if(w.fillContextMenu(g,b)||w.snapid)return w.fillObjectExecMenu(g,b).then(()=>(0,v.postponePromise)(()=>g.show(),50))}):void 0}saveAs(D,x,P){P||(P=(this.this_pad_name||(this.iscan?"canvas":"pad"))+"."+D),this.produceImage(x,D).then(w=>{if(!w)return console.error(`Fail to produce image ${P}`);(0,Qe.OJ)(P,"svg"!==D?w:"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(w))})}findActivePad(){let D;return this.forEachPainterInPad(x=>{x.is_active_pad&&!D&&(D=x)},"pads"),D}produceImage(D,x){var P=this;return(0,be.A)(function*(){const w="frame"===D,b=w?P.getFrameSvg(P.this_pad_name):D?P.getCanvSvg():P.svg_this_pad(),g=D&&!w?P.getCanvPainter():P,C=[];if(b.empty())return"";if(w||!D){const ie=P.getCanvSvg().selectChild(".canvas_defs");ie.empty()||(C.push({prnt:P.getCanvSvg(),defs:ie}),b.node().insertBefore(ie.node(),b.node().firstChild))}let N=null;g.forEachPainterInPad(ie=>{if(ie.is_active_pad&&!N&&(N=ie,N.drawActiveBorder(null,!1)),w)return;const z={prnt:ie.svg_this_pad()};C.push(z);const m=ie.getLayerSvg("btns_layer",ie.this_pad_name);z.btns_node=m.node(),z.btns_node&&(z.btns_prnt=z.btns_node.parentNode,z.btns_next=z.btns_node.nextSibling,m.remove());const I=ie.getFramePainter();if(!(0,v.isFunc)(I?.render3D)||!(0,v.isFunc)(I?.access3dKind))return;const A=I.access3dKind();if(A!==v.constants.Embed3D.Overlay&&A!==v.constants.Embed3D.Embed)return;const R=I.getSizeFor3d(v.constants.Embed3D.Embed),k=I.renderer.domElement;I.render3D(0);const ee=k.toDataURL("image/png");A===v.constants.Embed3D.Embed&&(z.foreign=z.prnt.select("."+R.clname),z.foreign.remove());const ge=I.getFrameSvg();z.frame_node=ge.node(),z.frame_node&&(z.frame_next=z.frame_node.nextSibling,ge.remove()),z.img=z.prnt.insert("image",".primitives_layer").attr("x",R.x).attr("y",R.y).attr("width",k.width).attr("height",k.height).attr("href",ee)},"pads");let O=b.property("draw_width"),H=b.property("draw_height");if(w){const ie=P.getFramePainter();O=ie.getFrameWidth(),H=ie.getFrameHeight()}const X="pdf"===x?{node:b.node(),width:O,height:H,reset_tranform:w}:(0,xe.NM)(`<svg width="${O}" height="${H}" xmlns="http://www.w3.org/2000/svg">${b.node().innerHTML}</svg>`);return(0,xe.Vm)(X,x).then(ie=>{N?.drawActiveBorder(null,!0);for(let z=0;z<C.length;++z){const m=C[z];m.img?.remove();const I=m.prnt.selectChild(".primitives_layer");m.foreign&&m.prnt.node().insertBefore(m.foreign.node(),I.node()),m.frame_node&&I.node().insertBefore(m.frame_node,m.frame_next),m.btns_node&&m.btns_prnt.insertBefore(m.btns_node,m.btns_next),m.defs&&m.prnt.node().insertBefore(m.defs.node(),m.prnt.node().firstChild)}return ie})})()}clickPadButton(D,x){if("CanvasSnapShot"===D)return this.saveAs("png",!0);if("enlargePad"===D)return this.enlargePad();if("PadSnapShot"===D)return this.saveAs("png",!1);if("PadContextMenus"===D)return x?.preventDefault(),x?.stopPropagation(),(0,Re.IV)()?void 0:(0,Re.ES)(x,this).then(b=>{b.add("header:Menus"),b.add(this.iscan?"Canvas":"Pad","pad",this.itemContextMenu),this.getFramePainter()&&b.add("Frame","frame",this.itemContextMenu);const g=this.getMainPainter();if(g&&(b.add("X axis","xaxis",this.itemContextMenu),b.add("Y axis","yaxis",this.itemContextMenu),(0,v.isFunc)(g.getDimension)&&g.getDimension()>1&&b.add("Z axis","zaxis",this.itemContextMenu)),this.painters?.length){b.add("separator");const C=[];this.painters.forEach((N,O)=>{const H=N?.getObject();if(!H||C.indexOf(H)>=0)return;let X=(0,v.isFunc)(N.getClassName)?N.getClassName():H._typename||"";X&&(X+="::"),X+=(0,v.isFunc)(N.getObjectName)?N.getObjectName():H.fName||`item${O}`,b.add(X,O,this.itemContextMenu),C.push(H)})}b.show()});let P=!1;const w=[];for(let b=0;b<this.painters.length;++b){const g=this.painters[b];(0,v.isFunc)(g.clickPadButton)&&w.push(g.clickPadButton(D,x)),!P&&(0,v.isFunc)(g.clickButton)&&(P=g.clickButton(D),(0,v.isPromise)(P)&&w.push(P))}return Promise.all(w)}addPadButton(D,x,P,w){if(v.settings.ToolBar&&!this.isBatchMode()){this._buttons||(this._buttons=[]);for(let g=0;g<this._buttons.length;++g)if(this._buttons[g].funcname===P)return;if(this._buttons.push({btn:D,tooltip:x,funcname:P,keyname:w}),!this.iscan&&this.has_canvas&&0!==P.indexOf("Pad")&&"enlargePad"!==P){const g=this.getCanvPainter();g&&g!==this&&g.addPadButton(D,x,P)}}}showPadButtons(){this._buttons&&(de.assign(this),this.showPadButtons())}addPadButtons(D){this.addPadButton("camera","Create PNG",this.iscan?"CanvasSnapShot":"PadSnapShot","Ctrl PrintScreen"),v.settings.ContextMenu&&this.addPadButton("question","Access context menus","PadContextMenus"),(!this.iscan&&this.has_canvas&&this.hasObjectsToDraw()||this.enlargeMain("verify"))&&this.addPadButton("circle","Enlarge canvas","enlargePad"),D&&this.brlayout&&(this.addPadButton("diamand","Toggle Ged","ToggleGed"),this.addPadButton("three_circles","Toggle Status","ToggleStatus"))}decodeOptions(D){const x=this.getObject();if(!x)return;const P=new xe.nC(D);function w(b,g){g||(g=x),b(g);const C=g.fPrimitives?.arr||[];for(let N=0;N<C.length;++N)C[N]._typename===v.clTPad&&w(b,C[N])}this.options||(this.options={}),Object.assign(this.options,{GlobalColors:!0,LocalColors:!1,CreatePalette:0,IgnorePalette:!1,RotateFrame:!1,FixFrame:!1}),(P.check("NOCOLORS")||P.check("NOCOL"))&&(this.options.GlobalColors=this.options.LocalColors=!1),(P.check("LCOLORS")||P.check("LCOL"))&&(this.options.GlobalColors=!1,this.options.LocalColors=!0),(P.check("NOPALETTE")||P.check("NOPAL"))&&(this.options.IgnorePalette=!0),P.check("ROTATE")&&(this.options.RotateFrame=!0),P.check("FIXFRAME")&&(this.options.FixFrame=!0),P.check("FIXSIZE")&&this.iscan&&(this._fixed_size=!0),P.check("CP",!0)&&(this.options.CreatePalette=P.partAsInt(0,0)),P.check("NOZOOMX")&&(this.options.NoZoomX=!0),P.check("NOZOOMY")&&(this.options.NoZoomY=!0),P.check("GRAYSCALE")&&!x.TestBit(he)&&x.InvertBit(he),P.check("NOMARGINS")&&w(b=>{b.fLeftMargin=b.fRightMargin=b.fBottomMargin=b.fTopMargin=0}),P.check("WHITE")&&w(b=>{b.fFillColor=0}),P.check("LOG2X")&&w(b=>{b.fLogx=2,b.fUxmin=0,b.fUxmax=1,b.fX1=0,b.fX2=1}),P.check("LOGX")&&w(b=>{b.fLogx=1,b.fUxmin=0,b.fUxmax=1,b.fX1=0,b.fX2=1}),P.check("LOG2Y")&&w(b=>{b.fLogy=2,b.fUymin=0,b.fUymax=1,b.fY1=0,b.fY2=1}),P.check("LOGY")&&w(b=>{b.fLogy=1,b.fUymin=0,b.fUymax=1,b.fY1=0,b.fY2=1}),P.check("LOG2Z")&&w(b=>{b.fLogz=2}),P.check("LOGZ")&&w(b=>{b.fLogz=1}),P.check("LOGV")&&w(b=>{b.fLogv=1}),P.check("LOG2")&&w(b=>{b.fLogx=b.fLogy=b.fLogz=2}),P.check("LOG")&&w(b=>{b.fLogx=b.fLogy=b.fLogz=1}),P.check("LNX")&&w(b=>{b.fLogx=3,b.fUxmin=0,b.fUxmax=1,b.fX1=0,b.fX2=1}),P.check("LNY")&&w(b=>{b.fLogy=3,b.fUymin=0,b.fUymax=1,b.fY1=0,b.fY2=1}),P.check("LN")&&w(b=>{b.fLogx=b.fLogy=b.fLogz=3}),P.check("GRIDX")&&w(b=>{b.fGridx=1}),P.check("GRIDY")&&w(b=>{b.fGridy=1}),P.check("GRID")&&w(b=>{b.fGridx=b.fGridy=1}),P.check("TICKX")&&w(b=>{b.fTickx=1}),P.check("TICKY")&&w(b=>{b.fTicky=1}),P.check("TICKZ")&&w(b=>{b.fTickz=1}),P.check("TICK")&&w(b=>{b.fTickx=b.fTicky=1}),P.check("OTX")&&w(b=>{b.$OTX=!0}),P.check("OTY")&&w(b=>{b.$OTY=!0}),P.check("CTX")&&w(b=>{b.$CTX=!0}),P.check("CTY")&&w(b=>{b.$CTY=!0}),P.check("RX")&&w(b=>{b.$RX=!0}),P.check("RY")&&w(b=>{b.$RY=!0}),this.storeDrawOpt(D)}static draw(D,x,P){return(0,be.A)(function*(){const w=new K(D,x,!1);w.decodeOptions(P),w.getCanvSvg().empty()?(w.has_canvas=!1,w.this_pad_name="",w.setTopPainter()):w.addToPadPrimitives(w.pad_name),x?.$disable_drawing&&(w.pad_draw_disabled=!0),w.createPadSvg(),w.matchObjectType(v.clTPad)&&(!w.has_canvas||w.hasObjectsToDraw())&&w.addPadButtons();const b=w.has_canvas?w.selectCurrentPad(w.this_pad_name):void 0;return(0,Je.QD)({pp:w,active:!0}),w.drawPrimitives().then(()=>(w.showPadButtons(),w.addPadInteractive(),w.selectCurrentPad(b),w))})()}}},4493:(Gr,xt,Te)=>{"use strict";Te.r(xt),Te.d(xt,{HierarchyPainter:()=>N,drawInspector:()=>X,drawList:()=>re,drawStreamerInfo:()=>O,folderHierarchy:()=>de,getHPainter:()=>Re.gZ,keysHierarchy:()=>K,listHierarchy:()=>ce,markAsStreamerInfo:()=>x,objectHierarchy:()=>G,taskHierarchy:()=>pe});var be=Te(5774),v=Te(4186),V=Te(3324),Le=Te(9907),xe=Te(139),Je=Te(165),st=Te(2481),Ke=Te(9646),ot=Te(8521),Re=Te(5619),Qe=Te(9606);const Ie="TopFolder";function he(z){return z<1e4?z.toFixed(0)+"B":z<1e6?(z/1e3).toFixed(2)+"KiB":z<1e9?(z/1e6).toFixed(2)+"MiB":(z/1e9).toFixed(2)+"GiB"}function re(z,m,I){return fe.apply(this,arguments)}function fe(){return(fe=(0,be.A)(function*(z,m,I){return m&&m.arr?{dom:z,lst:m,opt:I,indx:-1,painter:null,draw_next(){for(;++this.indx<this.lst.arr.length;){const R=this.lst.arr[this.indx];if(R)return(0,ot.$2)(this.dom,R,this.lst.opt&&this.lst.opt[this.indx]?this.lst.opt[this.indx]:this.opt).then(ee=>(ee&&!this.painter&&(this.painter=ee),this.draw_next()))}return this.painter}}.draw_next():null})).apply(this,arguments)}function de(z,m){if(!m?.fFolders)return!1;if(0===m.fFolders.arr.length)return z._more=!1,!0;z._childs=[];for(let I=0;I<m.fFolders.arr.length;++I){const A=m.fFolders.arr[I];z._childs.push({_name:A.fName,_kind:v.prROOT+A._typename,_obj:A})}return!0}function pe(z,m){if(!m?.fTasks)return!1;if(G(z,m,{exclude:["fTasks","fName"]}),0===m.fTasks.arr.length&&0===z._childs.length)return z._more=!1,!0;for(let I=0;I<m.fTasks.arr.length;++I){const A=m.fTasks.arr[I];z._childs.push({_name:A.fName,_kind:v.prROOT+A._typename,_obj:A})}return!0}function ce(z,m){if(!(0,v.isRootCollection)(m))return!1;if(void 0===m.arr||0===m.arr.length)return z._more=!1,!0;let I=!1,A=z;for(;A;)A._do_context&&(I=!0),A=A._parent;const R=m._typename===v.clTMap,k=[],ee=[],ge=[];for(let ve=0;ve<m.arr.length;++ve){const Se=R?m.arr[ve].first:m.arr[ve];if(!Se)continue;const De=Se.fName||Se.name;if(!De)continue;const Xe=k.indexOf(De);Xe>=0?ee[Xe]++:(ee[k.length]=ge[k.length]=1,k.push(De))}z._childs=[];for(let ve=0;ve<m.arr.length;++ve){const Se=R?m.arr[ve].first:m.arr[ve];let De;if(Se?._typename){switch(De={_name:Se.fName||Se.name,_kind:v.prROOT+Se._typename,_title:`${Se.fTitle||""} type:${Se._typename}`,_obj:Se},Se._typename){case v.clTColor:De._value=(0,xe.d_)(Se);break;case v.clTText:case v.clTLatex:De._value=Se.fTitle;break;case v.clTObjString:De._value=Se.fString;break;default:m.opt&&m.opt[ve]&&m.opt[ve].length&&(De._value=m.opt[ve])}if(I&&(0,ot.Xv)(Se._typename)&&(De._direct_context=!0),!De._name||Number.isInteger(parseInt(De._name))&&parseInt(De._name)!==ve||m.arr.indexOf(Se)<ve)De._name=ve.toString();else{const Xe=k.indexOf(Se.fName);Xe>=0&&ee[Xe]>1&&(De._cycle=ge[Xe]++,De._keyname=De._name,De._name=De._keyname+";"+De._cycle)}}else De={_name:ve.toString(),_kind:v.prROOT+"NULL",_title:"NULL",_value:"null",_obj:null};z._childs.push(De)}return!0}function K(z,m,I,A){if(void 0===m)return!1;z._childs=[];for(let R=0;R<m.length;++R){const k=m[R];if(v.settings.OnlyLastCycle&&R>0&&k.fName===m[R-1].fName&&k.fCycle<m[R-1].fCycle)continue;const ee={_name:k.fName+";"+k.fCycle,_cycle:k.fCycle,_kind:v.prROOT+k.fClassName,_title:k.fTitle+` (size: ${he(k.fObjlen)})`,_keyname:k.fName,_readobj:null,_parent:z};if(k.fRealName&&(ee._realname=k.fRealName+";"+k.fCycle),k.fClassName===Le.Fk||k.fClassName===Le.lZ){const ge=A&&I?I.getDir(A+k.fName):null;ge?(ee._name=k.fName,K(ee,ge.fKeys,I,A+k.fName+"/")):(ee._more=!0,ee._expand=function(ve,Se){return K(ve,Se.fKeys)})}else if(k.fClassName===v.clTList&&k.fName===Le.D1){if(v.settings.SkipStreamerInfos)continue;ee._name=Le.D1,ee._kind=v.prROOT+Le.R0,ee._title="List of streamer infos for binary I/O",ee._readobj=I.fStreamerInfos}z._childs.push(ee)}return!0}function G(z,m,I=void 0){if(!z||null===m)return!1;z._childs=[];let A=Object.prototype.toString.apply(m);if("[object DataView]"===A){let tt={_parent:z,_name:"size",_value:m.byteLength.toString(),_vclass:"h_value_num"};z._childs.push(tt);const We=m.byteLength<10?1:Math.log10(m.byteLength);for(let Ne=0;Ne<m.byteLength;++Ne){if(Ne%16==0){for(tt={_parent:z,_name:Ne.toString(),_value:"",_vclass:"h_value_num"};tt._name.length<We;)tt._name="0"+tt._name;z._childs.push(tt)}let Fe=m.getUint8(Ne).toString(16);for(;Fe.length<2;)Fe="0"+Fe;tt._value&&(tt._value+=Ne%4==0?" | ":" "),tt._value+=Fe}return!0}let R=!0,k=!1,ee=z;for(;ee;){if(ee._do_context&&(k=!0),"_nosimple"in ee){R=ee._nosimple;break}ee=ee._parent}const ge=(0,v.isArrayProto)(A)>0&&m.length,ve=ge&&m.length>v.settings.HierarchyLimit;let De,Xe,ct,$,Se=!1;if(ge&&"Object"===z._name&&!z._parent&&(z._name="Array"),ve){Se=!0;for(let tt=0;tt<m.length;++tt){const We=typeof m[tt];if(!("number"===We||"boolean"===We||"string"===We&&m[tt].length<16)){Se=!1;break}}}if("_obj"in z?z._obj!==m&&alert("object missmatch"):z._obj=m,z._title||(m._typename?z._title=v.prROOT+m._typename:ge&&(z._title="Array len: "+m.length)),Se){for(let tt=0;tt<m.length;){let We=Math.min(tt+10,m.length),Ne=!0,Fe=tt;for(;Ne;){Ne=!0;for(let pt=Fe;pt<We;++pt)m[tt]!==m[pt]&&(Ne=!1);if(Ne){if(We===m.length)break;Fe=We,We=Math.min(We+10,m.length)}else if(Fe!==tt){We=Fe,Ne=!0;break}}const ht={_parent:z,_name:tt+".."+(We-1),_vclass:"h_value_num"};if(Ne)ht._value=m[tt].toString();else{ht._value="";for(let pt=tt;pt<We;++pt)ht._value+=(pt===tt?"[ ":", ")+m[pt].toString();ht._value+=" ]"}z._childs.push(ht),tt=We}return!0}for(const tt in m){if("_typename"===tt||"$"===tt[0])continue;const We=m[tt];if((0,v.isFunc)(We)||I?.exclude&&I.exclude.indexOf(tt)>=0)continue;if(ve&&De){if(ct===We){++$,Xe=tt;continue}$>0&&(De._name+=".."+Xe)}const Ne={_parent:z,_name:tt};if(ve&&(De=Ne,Xe=tt,ct=We,$=0),null===We){Ne._value=Ne._title="null",R||z._childs.push(Ne);continue}let Fe=!1;if((0,v.isObject)(We))if(A=Object.prototype.toString.apply(We),(0,v.isArrayProto)(A)>0)Ne._title="array len="+We.length,Fe="[object Array]"!==A,0===We.length?(Ne._value="[ ]",Ne._more=!1):(Ne._value="[...]",Ne._more=!0,Ne._expand=G,Ne._obj=We);else if("[object DataView]"===A)Ne._title="DataView len="+We.byteLength,Ne._value="[...]",Ne._more=!0,Ne._expand=G,Ne._obj=We;else if("[object Date]"===A)Ne._more=!1,Ne._title="Date",Ne._value=We.toString(),Ne._vclass="h_value_num";else{(We.$kind||We._typename)&&(Ne._kind=Ne._title=v.prROOT+(We.$kind||We._typename)),We._typename&&(Ne._title=We._typename,k&&(0,ot.Xv)(We._typename)&&(Ne._direct_context=!0));let ht=z,pt=!1;for(;ht&&!pt;)pt=ht._obj===We,ht=ht._parent;if(pt)Ne._value="{ prnt }",Ne._vclass="h_value_num",Ne._more=!1,Fe=!0;else switch(Ne._obj=We,Ne._more=!1,We._typename){case v.clTColor:Ne._value=(0,xe.d_)(We);break;case v.clTText:case v.clTLatex:Ne._value=We.fTitle;break;case v.clTObjString:Ne._value=We.fString;break;default:(0,v.isRootCollection)(We)&&(0,v.isObject)(We.arr)?(Ne._value=We.arr.length?"[...]":"[]",Ne._title+=", size:"+We.arr.length,We.arr.length>0&&(Ne._more=!0)):(Ne._more=!0,Ne._value="{ }")}}else"number"==typeof We||"boolean"==typeof We?(Fe=!0,Ne._value="fBits"===tt?"0x"+We.toString(16):We.toString(),Ne._vclass="h_value_num"):(0,v.isStr)(We)?(Fe=!0,Ne._value="&quot;"+We.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"&quot;",Ne._vclass="h_value_str"):typeof We>"u"?(Fe=!0,Ne._value="undefined",Ne._vclass="h_value_num"):(Fe=!0,alert(`miss ${tt} type ${typeof We}`));(!Fe||!R)&&z._childs.push(Ne)}return ve&&De&&$>0&&(De._name+=".."+Xe),!0}function D(z){const m={_name:Le.D1,_childs:[]};for(let I=0;I<z.arr.length;++I){const A=z.arr[I];if(A._typename===v.clTList)continue;if(typeof A.fName>"u"){console.warn(`strange element in StreamerInfo with type ${A._typename}`);continue}const R={_name:`${A.fName};${A.fClassVersion}`,_kind:`class ${A.fName}`,_title:`class:${A.fName} version:${A.fClassVersion} checksum:${A.fCheckSum}`,_icon:"img_class",_childs:[]};if(A.fTitle&&(R._title+="  "+A.fTitle),m._childs.push(R),!(typeof A.fElements>"u")){for(let k=0;k<A.fElements.arr.length;++k){const ee=A.fElements.arr[k];if(!ee?.fName)continue;let ge=`${ee.fTypeName} ${ee.fName}`;const ve=`${ee.fTypeName} type:${ee.fType}`;if(1===ee.fArrayDim)ge+=`[${ee.fArrayLength}]`;else for(let Se=0;Se<ee.fArrayDim;++Se)ge+=`[${ee.fMaxIndex[Se]}]`;4294967295===ee.fBaseVersion?ge+=":-1":void 0!==ee.fBaseVersion&&(ge+=`:${ee.fBaseVersion}`),ge+=";",ee.fTitle&&(ge+=` // ${ee.fTitle}`),R._childs.push({_name:ge,_title:ve,_kind:ee.fTypeName,_icon:"BASE"===ee.fTypeName?"img_class":"img_member"})}R._childs.length||delete R._childs}}return m}function x(z,m,I){I?._typename===v.clTList&&(I._typename=Le.R0)}function P(z){const m={_name:"Object",_title:"",_click_action:"expand",_nosimple:!1,_do_context:!0};return(0,v.isStr)(z.fName)&&z.fName&&(m._name=z.fName),(0,v.isStr)(z.fTitle)&&z.fTitle&&(m._title=z.fTitle),z._typename&&(m._title+=`  type:${z._typename}`),(0,v.isRootCollection)(z)?(m._name=z.name||z._typename,ce(m,z)):G(m,z),m}function w(z){const m=[];if(!(0,v.isStr)(z)||!(z=z.trim()))return m;if(z.length<2||"["!==z[0]||"]"!==z[z.length-1])return m.push(z),m;let I=0,A=0,R=0,k=1;for(let ee=1;ee<z.length;++ee)if(A>0)"'"===z[ee]&&A--;else if(R>0)'"'===z[ee]&&R--;else switch(z[ee]){case"'":A++;break;case'"':R++;break;case"[":I++;break;case"]":if(ee<z.length-1){I--;break}case",":if(0===I){let ge=z.substring(k,ee).trim();ge.length>1&&ge[0]===ge[ge.length-1]&&('"'===ge[0]||"'"===ge[0])&&(ge=ge.slice(1,ge.length-1)),m.push(ge),k=ee+1}}return 0===m.length&&m.push(z.slice(1,z.length-1).trim()),m}function b(z,m){if(m&&z&&"_childs"in m){for(let I=0;I<m._childs.length;++I)(m._childs[I]._more||m._childs[I]._childs)&&(m._childs[I]._expand=b);return z._childs=m._childs,m._childs=null,!0}return!1}function g(z){return z?.expand||z?.get_expand||z?.expand_item}const C=v.prROOT+v.clTFile;class N extends Je.b8{constructor(m,I,A){super(I),this.name=m,this.h=null,this.with_icons=!0,"__as_dark_mode__"===A?this.setBasicColors():this.background=A,this.files_monitoring=!I,this.nobrowser=null===I,(0,Re.gZ)()||(0,Re.kV)(this)}setBasicColors(){this.background=v.settings.DarkMode?"black":"white",this.textcolor=v.settings.DarkMode?"#eee":"#111"}cleanup(){this.clearHierarchy(!0),super.cleanup(),(0,Re.gZ)()===this&&(0,Re.kV)(null)}fileHierarchy(m,I){const A=this;return I||(I={}),I._name=m.fFileName,I._title=(m.fTitle?m.fTitle+", path: ":"")+m.fFullURL+`, size: ${he(m.fEND)}, modified: ${(0,Je.ic)(m.fDatimeM.getDate())}`,I._kind=C,I._file=m,I._fullurl=m.fFullURL,I._localfile=m.fLocalFile,I._had_direct_read=!1,I._get=function(R,k){if(R?._readobj)return Promise.resolve(R._readobj);R&&(k=A.itemFullName(R,this));const ee=ge=>(this._file||(this._file=ge),ge?ge.readObject(k).then(ve=>{if(!R&&ve){const Se=A.findItem({name:k,top:this,last_exists:!0,check_keys:!0});if(void 0!==Se?.last&&Se.last!==this){const De=ge.getDir(A.itemFullName(Se.last,this));if(De){Se.last._name=Se.last._keyname;const Xe=A.itemFullName(Se.last,this);K(Se.last,De.fKeys,ge,Xe+"/")}}else K(this,ge.fKeys,ge,"");R=A.findItem({name:k,top:this})}return R&&(R._readobj=ve,"_expand"in R&&(R._name=R._keyname)),ve}):Promise.resolve(null));return this._file?ee(this._file):this._localfile?(0,Le.Tq)(this._localfile).then(ge=>ee(ge)):this._fullurl?(0,Le.Tq)(this._fullurl).then(ge=>ee(ge)):Promise.resolve(null)},K(I,m.fKeys,m,""),I}forEachItem(m,I){(0,v.isFunc)(m)&&function A(R,k){if(R&&(k&&(R._parent=k),m(R),"_childs"in R))for(let ee=0;ee<R._childs.length;++ee)A(R._childs[ee],R)}(I||this.h)}findItem(m){let A=this.h,R="";if((0,v.isStr)(m))R=m,m={};else{if(!(0,v.isObject)(m))return null;R=m.name,"top"in m&&(A=m.top)}return"__top_folder__"===R?A:(0,v.isStr)(R)&&0===R.indexOf("img:")?null:function I(k,ee){if(!ee||!k)return k;let ge=ee.length;if(!k._parent&&k._kind!==Ie&&0===ee.indexOf(k._name)){if(ee===k._name)return k;const Se=k._name.length;"/"===ee[Se]&&(ee=ee.slice(Se+1),ge=ee.length)}function ve(Se,De){return De||(Se._parent=k),ge>=ee.length-1||ge<0?Se:I(Se,ee.slice(ge+1))}for(;ge>0;){let Se=ge>=ee.length?ee:ee.slice(0,ge);if(k._childs){for(let Xe=0;Xe<k._childs.length;++Xe)if(k._childs[Xe]._name===Se)return ve(k._childs[Xe]);if(k._kind===Ie&&void 0!==k._childs[0]._online)for(let Xe=0;Xe<k._childs[0]._childs.length;++Xe)if(k._childs[0]._childs[Xe]._name===Se)return ve(k._childs[0]._childs[Xe],!0);if(m.check_keys){let Xe=null;for(let ct=0;ct<k._childs.length;++ct)k._childs[ct]._keyname===Se&&(!Xe||Xe._cycle<k._childs[ct]._cycle)&&(Xe=k._childs[ct]);if(Xe)return ve(Xe)}let De=m.allow_index;if("["===Se[0]&&"]"===Se[Se.length-1]&&/^\d+$/.test(Se.slice(1,Se.length-1))&&(De=!0,Se=Se.slice(1,Se.length-1)),De&&/^\d+$/.test(Se)){const Xe=parseInt(Se);if(Number.isInteger(Xe)&&Xe>=0&&Xe<k._childs.length)return ve(k._childs[Xe])}}ge=ee.lastIndexOf("/",ge-1)}if(m.force){void 0===k._childs&&(k._childs=[]),ge=ee.indexOf("/");const Se={_name:ge<0?ee:ee.slice(0,ge)};return k._childs.push(Se),ve(Se)}return m.last_exists?{last:k,rest:ee}:null}(A,R)}itemFullName(m,I,A){if(m?._kind===Ie)return"__top_folder__";let R="";for(;m;){if(void 0!==m._online&&!I)return R;if(m===I||m._kind===Ie||A&&!m._parent)break;R&&(R="/"+R),R=m._name+R,m=m._parent}return R}executeCommand(m,I){var A=arguments,R=this;return(0,be.A)(function*(){const k=R.findItem(m),ee=R.getOnlineItemUrl(k)+"/cmd.json",ge=(0,V.Lt)(I),ve=[];if("_numargs"in k)for(let De=0;De<k._numargs;++De)ve.push(De+2<A.length?A[De+2]:"");return(0!==ve.length&&I?(0,Ke.ES)().then(De=>De.showCommandArgsDialog(k._name,ve)):Promise.resolve(ve)).then(De=>{if(null===De)return!1;let Xe="";for(let ct=0;ct<De.length;++ct)Xe+=`${ct>0?"&":"?"}arg${ct+1}=${De[ct]}`;return ge.empty()||(ge.style("background","yellow"),k._title&&ge.attr("title","Executing "+k._title)),(0,v.httpRequest)(ee+Xe,"text").then(ct=>{if(ge.empty())return ct;const $=ct&&"false"!==ct?"green":"red";return ge.style("background",$),k._title&&ge.attr("title",k._title+" lastres="+ct),setTimeout(()=>{ge.style("background",null),k._icon&&ge.classed("jsroot_fastcmd_btn")&&ge.style("background-image",`url('${k._icon}')`)},2e3),"green"===$&&"_hreload"in k&&R.reload(),"green"===$&&"_update_item"in k&&R.updateItems(k._update_item.split(";")),ct})})})()}getObject(m,I){var A=this;return(0,be.A)(function*(){const R={item:null,obj:null};let k,ee;if(null===m)return R;if((0,v.isStr)(m)?k=m:(0,v.isObject)(m)&&(void 0!==m._parent&&void 0!==m._name&&void 0!==m._kind?ee=m:void 0!==m.name?k=m.name:void 0!==m.arg?k=m.arg:void 0!==m.item&&(ee=m.item)),(0,v.isStr)(k)&&0===k.indexOf("img:"))return R.obj={_typename:"TJSImage",fName:k.slice(4)},R;ee?k=A.itemFullName(ee):ee=A.findItem({name:k,allow_index:!0,check_keys:!0});const ge=ee?null:A.findItem({name:k,last_exists:!0,check_keys:!0,allow_index:!0});if(null!==ge&&"last"in ge&&null!==ge.last){const Se=A.itemFullName(ge.last);return(0,v.isObject)(m)&&"rest"in m&&(m.rest===ge.rest||m.rest.length<=ge.rest.length)?R:A.expandItem(Se,void 0,"hierarchy_expand_verbose"!==I).then(De=>{if(!De)return R;let Xe=A.itemFullName(ge.last);return Xe&&(Xe+="/"),A.getObject({name:Xe+ge.rest,rest:ge.rest},I)})}if(R.item=ee,null!==ee&&(0,v.isObject)(ee._obj))return R.obj=ee._obj,R;let ve=ee;for(;ve;){if((0,v.isFunc)(ve._get))return ve._get(ee,null,I).then(Se=>(R.obj=Se,R));ve="_parent"in ve?ve._parent:null}return R})()}isLastSibling(m){if(!m||!m._parent||!m._parent._childs)return!1;const I=m._parent._childs;let A=I.indexOf(m);if(A<0)return!1;for(;++A<I.length;)if(!("_hidden"in I[A]))return!1;return!0}addItemHtml(m,I,A){if(!m||"_hidden"in m)return!0;const R=m===this.h,k="_childs"in m,ee=(0,ot.hd)(m._kind),ge=this.itemFullName(m);let ct,ve="",Se="",De=!1,Xe=!1;ee&&("icon"in ee&&(ve=ee.icon),"icon2"in ee&&(Se=ee.icon2),!ve&&(0,v.isFunc)(ee.icon_get)&&(ve=ee.icon_get(m,this)),((0,ot.Xv)(ee)||"execute"in ee||"aslink"in ee||g(ee)&&!1!==m._more)&&(De=!0)),"_icon"in m&&(ve=m._icon),"_icon2"in m&&(Se=m._icon2),!ve&&"_online"in m&&(m._icon=ve="img_globe"),!ve&&R&&(m._icon=ve="img_base"),(m._more||m._expand||m._player||m._can_draw)&&(De=!0);let $=De;!$&&(0,v.isStr)(m._kind)&&0===m._kind.indexOf(v.prROOT)&&($=De=!0),Se||(Se=ve),ve||(ve=k||m._more?"img_folder":"img_page"),Se||(Se=k||m._more?"img_folderopen":"img_page"),"update"===A?(I.selectAll("*").remove(),ct=I):(ct=I.append("div"),A&&A>=(m._parent._show_limit||v.settings.HierarchyLimit)&&(Xe=!0)),m._d3cont=ct.node(),ct.attr("item",ge);const tt=ct.append("div").attr("class","h_line");let We=R?null:m._parent;for(;We&&We!==this.h;)tt.insert("div",":first-child").attr("class",this.isLastSibling(We)?"img_empty":"img_line"),We=We._parent;let Ne="",Fe=!1;R||(k&&!Xe?(Ne=m._isopen?"img_minus":"img_plus",Fe=!0):Ne="img_join");const ht=this;if(Ne){(Xe||this.isLastSibling(m))&&(Ne+="bottom");const _t=tt.append("div").attr("class",Ne);Fe&&_t.style("cursor","pointer").on("click",function(Yt){ht.tree_click(Yt,this,"plusminus")})}if(this.with_icons&&!Xe){const _t=m._isopen?Se:ve,Yt=0===_t.indexOf("img_")?tt.append("div").attr("class",_t).attr("title",m._kind):tt.append("img").attr("src",_t).attr("alt","").attr("title",m._kind).style("vertical-align","top").style("width","18px").style("height","18px");("_icon_click"in m||ee&&"icon_click"in ee)&&Yt.on("click",function(kt){ht.tree_click(kt,this,"icon")})}const pt=tt.append("a");if((De||k||Xe)&&pt.attr("class","h_item").on("click",function(_t){ht.tree_click(_t,this)}),Xe)return m._break_point=!0,pt.attr("title","there are "+(m._parent._childs.length-A)+" more items").text("...more..."),!1;"disp_kind"in ht?(v.settings.DragAndDrop&&De&&this.enableDrag(pt,ge),v.settings.ContextMenu&&$&&pt.on("contextmenu",function(_t){ht.tree_contextmenu(_t,this)}),pt.on("mouseover",function(){ht.tree_mouseover(!0,this)}).on("mouseleave",function(){ht.tree_mouseover(!1,this)})):m._direct_context&&v.settings.ContextMenu&&pt.on("contextmenu",function(_t){ht.direct_contextmenu(_t,this)});let dt=m._name,rt="";if("_realname"in m&&(dt=m._realname),"_title"in m&&(rt=m._title),"_fullname"in m&&(rt+="  fullname: "+m._fullname),rt||(rt=dt),pt.attr("title",rt).text(dt+("_value"in m?":":"")).style("background",m._background?m._background:null),"_value"in m){const _t=tt.append("p");"_vclass"in m&&_t.attr("class",m._vclass),m._isopen||_t.html(m._value)}if(k&&(R||m._isopen)){const _t=ct.append("div").attr("class","h_childs");this.show_overflow&&_t.style("overflow","initial");for(let Yt=0;Yt<m._childs.length;++Yt){const kt=m._childs[Yt];if(kt._parent=m,!this.addItemHtml(kt,_t,Yt))break}}return!0}toggleOpenState(m,I,A){const R=I||this.h;if(void 0===R._childs){if(!m||this.with_icons&&!R._more&&!R._expand&&!this.canExpandItem(R))return!1;const ee=this.expandItem(this.itemFullName(R));return(0,v.isPromise)(ee)&&(0,v.isObject)(A)&&A.push(ee),void 0!==R._childs&&(R._isopen=!0),R._isopen}if(R!==this.h&&m&&!R._isopen)return R._isopen=!0,!0;let k=!1;for(let ee=0;ee<R._childs.length;++ee)this.toggleOpenState(m,R._childs[ee],A)&&(k=!0);return R===this.h||m||!R._isopen||k?(I||this.refreshHtml(),!1):(delete R._isopen,!0)}exapndToLevel(m){var I=this;return(0,be.A)(function*(){if(!m||!Number.isFinite(m)||m<0)return I;const A=[];return I.toggleOpenState(!0,I.h,A),Promise.all(A).then(()=>I.exapndToLevel(m-1))})()}refreshHtml(){var m=this;return(0,be.A)(function*(){const I=m.selectDom();if(I.empty())return m;I.html("").style("overflow",m.show_overflow?"auto":"hidden").style("display","flex").style("flex-direction","column"),function L(z){function m(k,ee,ge,ve){return`.jsroot .img_${k} { display: inline-block; height: ${ee}px; width: ${ee}px; background-image: url("data:image/${ge};base64,${ve}"); }`}(0,Qe.fz)(`\n.jsroot .h_tree { display: block; white-space: nowrap; }\n.jsroot .h_tree * { padding: 0; margin: 0; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; box-sizing: content-box; line-height: 14px }\n.jsroot .h_tree img { border: 0px; vertical-align: middle; }\n.jsroot .h_tree a { text-decoration: none; vertical-align: top; white-space: nowrap; padding: 1px 2px 0px 2px; display: inline-block; margin: 0; }\n.jsroot .h_tree p { font-weight: bold; white-space: nowrap; text-decoration: none; vertical-align: top; white-space: nowrap; padding: 1px 2px 0px 2px; display: inline-block; margin: 0; }\n.jsroot .h_value_str { color: green; }\n.jsroot .h_value_num { color: blue; }\n.jsroot .h_line { height: 18px; display: block; }\n.jsroot .h_button { cursor: pointer; color: blue; text-decoration: underline; }\n.jsroot .h_item { cursor: pointer; }\n.jsroot .h_item:hover { text-decoration: underline; }\n.jsroot .h_childs { overflow: hidden; display: block; }\n.jsroot_fastcmd_btn { height: 32px; width: 32px; display: inline-block; margin: 2px; padding: 2px; background-position: left 2px top 2px;\n                      background-repeat: no-repeat; background-size: 24px 24px; border-color: inherit; }\n.jsroot_inspector { border: 1px solid ${v.settings.DarkMode?"green":"black"}; box-shadow: 1px 1px 2px 2px ${v.settings.DarkMode?"#555":"#aaa"}; opacity: 0.95; background-color: ${v.settings.DarkMode?"black":"#E6E6FA"}; }\n.jsroot_drag_area { background-color: #007fff; }\n${m("minus",18,"gif","R0lGODlhEgASAJEDAIKCgoCAgAAAAP///yH5BAEAAAMALAAAAAASABIAAAInnD+By+2rnpyhWvsizE0zf4CIIpRlgiqaiDosa7zZdU22A9y6u98FADs=")}\n${m("minusbottom",18,"gif","R0lGODlhEgASAJECAICAgAAAAP///wAAACH5BAEAAAIALAAAAAASABIAAAImlC+Ay+2rnpygWvsizE0zf4CIEpRlgiqaiDosa7zZdU32jed6XgAAOw==")}\n${m("plus",18,"gif","R0lGODlhEgASAJECAICAgAAAAP///wAAACH5BAEAAAIALAAAAAASABIAAAIqlC+Ay+2rnpygWvsizCcczWieAW7BeSaqookfZ4yqU5LZdU06vfe8rysAADs=")}\n${m("plusbottom",18,"gif","R0lGODlhEgASAJECAICAgAAAAP///wAAACH5BAEAAAIALAAAAAASABIAAAIplC+Ay+2rnpygWvsizCcczWieAW7BeSaqookfZ4yqU5LZdU36zvd+XwAAOw==")}\n${m("empty",18,"gif","R0lGODlhEgASAJEAAAAAAP///4CAgP///yH5BAEAAAMALAAAAAASABIAAAIPnI+py+0Po5y02ouz3pwXADs=")}\n${m("line",18,"gif","R0lGODlhEgASAIABAICAgP///yH5BAEAAAEALAAAAAASABIAAAIZjB+Ay+2rnpwo0uss3kfz7X1XKE5k+ZxoAQA7")}\n${m("join",18,"gif","R0lGODlhEgASAIABAICAgP///yH5BAEAAAEALAAAAAASABIAAAIcjB+Ay+2rnpwo0uss3kf5BGocNJZiSZ2opK5BAQA7")}\n${m("joinbottom",18,"gif","R0lGODlhEgASAIABAICAgP///yH5BAEAAAEALAAAAAASABIAAAIZjB+Ay+2rnpwo0uss3kf5BGrcSJbmiaZGAQA7")}\n${m("base",18,"gif","R0lGODlhEwASAPcAAPv6/Pn4+mnN/4zf/764x2vO//Dv84HZ/5jl/0ZGmfTz9vLy8lHB/+zr70u+/7S03IODtd7d6c/P0ndqiq/w/4Pb/5SKo/Py9fPy9tTU121kjd/f4MzM062tx5+zy5rO67GwxNDM14d8mJzn/7awwry713zX/9bW27u71lFRmW5uoZ+fxjOy/zm1/9HQ2o3g/2xfgZeMplav7sn9/6Cgv37X/6Dp/3jU/2uJ2M7J1JC63vn5+v38/d7e38PD0Z7o/9LR4LS01cPDzPb1+Nzb5IJ2lHCEv5bk/53C3MrJ3X56t+np6YF7o3JsndTU5Wtgh5GHoKaesuLi4mrO/19RdnnV/4WBqF5QdWPK/4+PvW5uu4+PuuHh4q7w/97e68C9z63w/9PT0+zs7FtbmWVXerS0yaqitpuSqWVlpcL6/8jD0H/C9mVajqWu3nFwpYqHtFfE/42DnaWl0bTz/5OPt+7u7tra5Y+Yz+Tk56fM6Gek5pG50LGpvOHh72LJ/9XU5lbD/6GnwHpujfDu8mxpntzb45qav7PH41+n6JeXyUZGopyYsWeGyDu2/6LQ44re/1yV41TD/8LC1zix/sS/zdTU4Y+gsd/c5L7z+a6uzE+3+XG89L6+087O1sTD3K2twoGBtWVbgomo4P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAKMALAAAAAATABIAAAjtAEcJFLgDTyE7SVCsAAJgoMNRYTII8fEpkAckOpiEaPhwlARLexxhmpEGzJEmBAJ0HMXhw6MfXeZQsDHADZ8hK13kMTEAwQgEL2oYiaJgJZFDU24cqHCgSgFGFgysBJAJkB8BBQRggQNJxKCVo0rIcMAgEgMHmnBMaADWEyIWLRptEqWETRG2K//ombSmjRZFoaCo4djRyZ0HchIlSECIRNGVXur0WcAlCJoUoOhcAltpyQIxPSRtGQPhjRkMKyN0krLhBCcaKrJoOCO1I48vi0CU6WDIyhNBKcEGyBEDBpUrZOJQugC2ufPnDwMCADs=")}\n${m("folder",18,"gif","R0lGODlhEgASANUAAPv7++/v79u3UsyZNOTk5MHBwaNxC8KPKre3t55sBrqHIpxqBMmWMb2KJbOBG5lnAdu3cbWCHaBuCMuYM///urB+GMWSLad1D8eUL6ampqVzDbeEH6t5E8iVMMCNKMbGxq58FppoAqh2EKx6FP/Ub//4k+vr6///nP/bdf/kf//viba2tv//////mQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAC4ALAAAAAASABIAAAaRQJdwSCwaj8ik0jUYTBidAEA5YFkplANhehxABGAwpKHYRByVwHBibbvbo8+Q0TrZ7/jWBTHEtP6AgX8GK0MWLSWJiostEoVCBy0qk5SVLQmPLh4tKZ2eny0LmQ0tKKanqC0hmQotJK+wsS0PfEIBZxUgHCIaBhIJCw8ZBUMABAUrycrLBQREAAEm0tPUUktKQQA7")}\n${m("folderopen",18,"gif","R0lGODlhEgASANUAAO/v76VzDfv7+8yZNMHBweTk5JpoAqBuCMuYM8mWMZ5sBpxqBPr7/Le3t///pcaaGvDker2KJc+iJqd1D7B+GOKzQ8KPKqJwCrOBG7WCHbeEH9e4QNq/bP/rhJlnAffwiaampuLBUMmgIf3VcKRyDP/XhLqHIqNxC8iVMMbGxqx6FP/kf//bdf/vievr67a2tv/4k8aaGf//nP//mf///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAADUALAAAAAASABIAAAaVwJpwSCwaj8ikUjgYIBIogEA5oFkZDEtheqzKvl9axKTJYCiAIYIGblutqtQwQYPZ73jZpCGM+f+AfiEdJy99M21tMxwxJQeGNTGIeHcyHzEjCpAAki2en54OIhULkAKSMiuqqysOGxIGkDWcMyy2t7YQDx58QqcBwMAkFwcKCwYgBEQFBC/Oz9AEBUUALtbX2FJLSUEAOw==")}\n${m("page",18,"gif","R0lGODlhEgASAOYAAPv7++/v7/j7/+32/8HBweTk5P39/djr/8Df//7///P5/8Ph//T09fn5+YGVw2t0pc7n/15hkFWn7ZOq0nqDsMDA/9nh7YSbyoqo2eTx/5G46pK873N+sPX6//f395Cjy83m/7rd/9jl9m13qGVqmoeh0n+OvI+z5Yyu387T//b6/2dtnvz9/32JtpS/8sbGxv7+/tvn92lwom96rHJ8rnSAsoep3NHp/8nk/7e3t+vr67a2tun1/3V4o+Hw/9vt/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAEEALAAAAAASABIAAAejgEGCg4SFhoeILjaLjDY1AQCHG0AGAA0eDBY1E5CGGjBAoQkCMTUSHwGGJwaiAh0iNbEvhiihAgIDPDwpFRw5hhgsuLk8Pz8HNL+FJSoKuT4+xzczyoQXzjzQxjcgI9WDDrraPzc4OA/fgibZ0eTmCzLpQS0Z7TflCwgr8hT2EOYIQpCQ16OgwYMRCBgqQGCHw4cOCRQwBCCAjosYL3ZCxNFQIAA7")}\n${m("question",18,"gif","R0lGODlhEgASAPelAOP0//7//9bs//n///j//9Ls/8Pn//r//6rB1t3f5crO2N7g5k1livT4+7PW9dXt/+v4/+Xl5LHW9Ov6/+j1/6CyxrfCz9rd5Nzj6un1/Z6ouwcvj8HBzO7+/+3//+Ln7BUuXNHv/6K4y+/9/wEBZvX08snn/19qhufs8fP7/87n/+/t7czr/5q1yk55q97v/3Cfztnu//z//+X6/ypIdMHY7rPc/7fX9cbl/9/h52WHr2yKrd/0/9fw/4KTs9rm75Svzb2+ya690pu92mWJrcT3//H//+Dv/Xym35S216Ouwsvt/3N/mMnZ5gEBcMnq/wEBXs/o/wEBetzw/zdYpTdZpsvP2ClGml2N3b3H0Nzu/2Z2lF1ricrl/93w/97h6JqluktojM/u/+/z9g8pVff4+ebu9q+1xa6/zzdFaIiXr5Wyz0xslrTK4uL//2uIp11rh8Xj/NXn+Oz2/9bf6bG2xAEBePP//1xwkK/K5Nbr/8fp/2OBtG53kai3ykVCYwEBde/6/7O4xabI+fD//+by/x8+jDhZpM/q/6jK58nO19ny/7jV7ZO42NHr/9H4/2ZwimSV6VBxwMDX7Nvf5hYwX5m20sfb6Ieqyk9Yjr/k/cPM2NDp/+/098Tl9yQ9jLfW+Mne8sjU30JklP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAKUALAAAAAASABIAAAjxAEsJHEiwoMEyGMaQWthg0xeDAlGUWKjoz5mFAegY/LBiIalMUK54JCWEoJkIpA6kSDmoAykKgRaqGSiq04A5A5r4AKOEAAAtE2S0USAwSwYIhUb8METiUwAvemLMCMVEoIUjAF5MIYXAThUCDzgVWDQJjkA0cngIEHAHCCAqRqJ0QeQoDxeBFS71KKDCwxonhwiZwPEkzo4+AimJqBFCjBs+UjZ4WmLgxhAQVgb6acGIBShJkbAgMSAhCQ1IBTW8sZRI055HDhoRqXQCYo4tDMJgsqGDTJo6EAlyYFNkVJDgBgXBcJEAucEFeC44n04wIAA7")}\n${m("histo1d",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEW9vb2np6empqanpqenpqivr6//AAD3+fn09vb19vf3+Pv8+v//+//29/v3+fr19vbZ3Nza3d7X0+Lb3t7b3N3AwMP2+PimpqXe4+Th6uvQ0dTi6uzg5ebFx8nt6vb////r5/T2+fnl4e3a3uDN0NT7/P6lpqX3+vvn9vhcVVHu+//W1uH48//29P///f+mpqelpqb4/v/t/f9oY2H6///59v/x8fXw9fny9/78/v+lpqf7//9iXl12dHPW2t/R1tdtaGbT2dpoZmT6/v9ycnKCgoJpZGJ6dnT3///2///0//95entpa2t+gIKLjI55d3aDgYBvcXL1+/z9/v6lpaWGiIt7fH6Ji42SlJeEhIZubGyMjI17fYD+//+kpKSmpaaRk5WIioyRk5aYmp2OkJJ+f4KTlZilpKWcnqGVl5qcnqCfoaOYmp6PkZOdn6GsrrGoqq6qrK+rrbGpq66lp6uqrbCoqq20tLSsrKzc3NzMzMzPz88AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB6enrU4/9iYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmLU4/9KSkoAAAAAAAAAAAB6enrU4//m5uZiYmLm5uZiYmLm5uZiYmLm5uZiYmLm5ubU4/9KSkoAAAAAAAAAAAB6enrU4/9KSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkrU4/9KSkoAAAAAAAAAAABubm7U4//U4//U4//U4//U4//U4//U4//U4//U4//U4//U4/9KSkoAAAAAAAAAAABubm5KSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABt6dBwBYjWHVG2AAAAB3RSTlP///////8AGksDRgAAAAlwSFlzAAALEgAACxIB0t1+/AAAAOxJREFUeNpjYGBkggBmFmYmRlY2BkZ2DhDg5OLm4eblY2RjYOIXEBQSFhEFkgKCYkxsDOKcEpJS0jKycvJS8gpcIAFFJWUVGFIFCqipa8hrymtpy+sI6crr6bMxGBgayRvLm8iamkmZW1gCBayslWxs7ewd7OwdlZStrYC2ODm7uLrJu3t4usl7mRiwMeh7+/j6+VsHBMr7+wQFhwAFQsPCIyKjomOiIsOiYuPYGOITEpOSU1LTElNTElPlgQLpGZlZ2Tm5eZm5OZm5IAGm/ILCouKS0rKS4oISeaDDypniEICpgo2hsgoZVLMBAHIaNxuoIXy2AAAAAElFTkSuQmCC")}\n${m("histo2d",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAACXBIWXMAAAsSAAALEgHS3X78AAABUUlEQVR42o1R0U7CQBDkU/w/v8qk1/OhCS+88miMiQYMBMNRTqiisQiRhF6h13adsuVKDEYvm81kdmdv9q7V7XallP65I30UrpErLGW73SaiFtDF5dXWmNNITJrubJ4RWUI2qU33GTorAdSJMeMwhOxpEE20noRTYISaajBcMrsdOlkgME+/vILtPw6j+BPg5vZuFRuUgZGX71tc2AjALuYrpWcP/WE1+ADAADMAY/OyFghfpJnlSTCAvLb1YDbJmArC5izwQa0K4g5EdgSbTQKTX8keOC8bgXSWAEbqmbs5BmPF3iyR8I+vdNrhIj3ewzdnlaBeWroCDHBZxWtm9DzaEyU2L8pSCNEI+N76+fVs8rE8fbeRUiWR53kHgWgs6cXbD2OOIScQnji7g7OE2UVZNILflnbrulx/XKfTAfL+OugJgqAShGF4/7/T6/Ug+AYZrx7y3UV8agAAAABJRU5ErkJggg==")}\n${m("histo3d",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEX////48OjIgTrHfjjKgTr78+yixH9HiQBHiACiw37jvJXfpVP6wzT7zTn7yj3lp1qOhyJzvgCa3wCa3gB2ugBinQ6Pt2D4+vfOjEr96p3986z83mT99rD99a3WhEvC0kaU3gCV3ADG71zo/KORzw1gowBonS3Z5snHfTb6uyD6tzD+/Nb7z0/70D3KdTXI1l3h+qTi+KXD7luU3ACY3gCc4QCi3g1QjwXHfjr710T6xi/+9sn70UH73E/MdDqhvQCi1BKkug2XxACU1wCS2ADD51rr9aJXkw/MpYDgpkb71U7+9MP7007hnEO3niOj0hGq3SCZtQCbtQCjtwj//+7F4Vui0wBDhgDk5eTMxcGxfi3TfTq+fyPPz4ak3xux5TG87kmZuwCZvACWtgDf8a+c0gCy3yNLiwD7/Ps1iwCiyAPF3F7j7bG67EW77kmq5yWYzwCZwwCTugDc8KTE51ve9YZCigCgwgCVuQDa5p7U9YSq4yWT2gCV2wCT2wCp2h/y+9HC6lW87DlChQBGigCixgCYvgDK3nyXvgC72UjG7mSj3xXL7XDK7W7b9J+36TrG9lBDhQBHigClywCbxQDJ33SXvwCYvQCcwADq+8S77Ei460Hd+KDD9VHU/2VEhgBdlR1rowCXwwDK4W6bxgCaxQCVvQDp/L+/8k7F91fn/6zC9V18tiNbkx/U1dSyv6RglihnoQCYwwChyQDs/7/P/2fE92F5tCBdkib19vXW1taoupVLiwNooQCWwADo/7h5tSBFhgaouZXx8vHOz86ftYVJiQBNjQKetIXt7u3Nzs0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBfAAAAAAAAAA2tmA2tmAAACQAAAAAAAAAAAAAAAAAAAAAATgAABNBfMAAAAAAAAA2tpQ2tpQAACQAAAAAAAAAAAAAAAAAAAAAAdQAABNBfMAAAAAAAAA2tsg2tsgAACQAAAAAAAAAAAAAAAAAAAAAAggAABNBfMCaVmCSAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAAQVJREFUeNpjYGBkYmZhZWBj5+BkAAMubh5ePn4BQSFhEVExcaCAhKSUtIysnLyCopKyiqqaOoOGppa2jq6evoGhkbGJqZk5g4WllbWNrZ29g6OTs4urmzuDh6eXt4+vn39AYFBwSGhYOENEZFR0TGxcfEJiUnJKalo6A0NGZlZ2Tm5efkFhUXFJqTnQnrLyisqq6prauvqGxqZmoEBLa1t7R2dXd09vX/+EiUCBSZOnTJ02fcbMWbPnzJ03HyiwYOGixUuWLlu+YuWq1WvWAgXWrd+wcdPmTVu2btu+Y/06kHd27tq9Z+++/QcOHtq1E+JBhsNHjh47fuLIYQYEOHnq1EkwAwCuO1brXBOTOwAAAABJRU5ErkJggg==")}\n${m("graph",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AEFCgohaz8VogAAAT9JREFUOMulkz1LQlEYx39XmrIhcLa5i4mD4JBQrtHieDbb+gx3dbl9hca7tLi4VOsRMkKQVO7LLAQNNdSQgyJPg903tDT8w4HzPDznd56Xc1BKCVsokzTGjhPBXDcQAAEZDgPZCHDQaESH5/PYXyqZxp8A349vGHkjOXo3uXtp035sy79KABi8DQCwshb7x3U6gIYU6KNej+1kEwUEjbQeWtIb9mTsOCIgN1eXgiYd96OdcKNBOoCuQc47pFgoGmHw7skZTK9X16CUku5zV9BIkhz4vgSuG/nsWzvKIhmXAah+VpfJsxnGZMKkUln05NwykqOORq6UWkn+TRokXFEG/Vx/45c3fbrnFKjpRVkZgHKxbAC8NptrAfm9PAD2l42VtdJjDDwv2CSLpSaGMgsFc91hpdRFKtNtf6OxLeAbVYSb7ipFh3AAAAAASUVORK5CYII=")}\n${m("mgraph",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEW9vb2np6empqanpqenpqivr68AAAD3+fn09vb19vf3+Pv8+v//+//29/v3+fr19vbZ3Nza3d6/wcLb3t7b3N3AwMPi4et2oz0yfwDh3+n2+PimpqXe4+Th6uvD0NHi6uzg5ebFx8nt6vY2ggDs/881gQDr5/T2+fnFz9DDZVrAIhDEZVvJ0tTN0NTX0+IvZAA4hAAuYgDT0N77/P6lpqX3+vvn9vi/JRL81cHBJhTu+//W1uEkXgD48//29P8fWwD//f+mpqelpqb4/v/t/f+yCwDBKBi3CgD6//8kYAD59v/x8fXQ0dTw9fny9/78/v+lpqf7//+wAADV5ezZ5e7g6PQjZQDf4+/W2t/R1tfT2drT3+OvAAD9///6/v/////k4vIiXwC1AAD3///2///X6Oz0//9+rUgzfwAwdADa6u6xCwDAJxb5///1+/z9/v6lpaUwfADo/8vl4e3a3uDb6eu+IxL808C+IhDZ5+nW2tr+//+kpKSmpaaArUgvewB1oj39/v/e5ebVd227HgvJa2H8///6/PylpKXn4+ze4eLg5+j9/v20tLSsrKzc3NzMzMzPz88AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAPAAAAAAEAAAEAAABzL1z/CSMAAAAAAAAAAAAAAAMAAAAmCTsAAAAAAAAAAAAAAAAAAAQAAQEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7op0gAAAAB3RSTlP///////8AGksDRgAAAAlwSFlzAAALEgAACxIB0t1+/AAAAOhJREFUeNpjYGBkggBmFmYmRlY2BkZ2DhDg5OLm4eblY2RjYOIXEBQSFhEVE5cQl5RiYmOQ5pSRlZNXUFRSVlFV4wIJqGtoamnr6OrpGxgaGQMFTEzNzC0sraxtbPXs7B0c2RicnF1c3dw9PL28fXz9/IECAYFBwSGhYeERkVHRMYEBQFti4+ITEuOTklNSg9I8nNgYHOPTMzLjA7Oyc7Jz8/ILQAKFRRnFJaVl5RWVVdU1bAy18XX1DfGNTc0trW3t8UCBjvj4+M746q74+O7qHpAAUzwyADqsl6kGAZj62Bj6JyCDiWwAyPNF46u5fYIAAAAASUVORK5CYII=")}\n${m("tree",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAAAQAAAAEABcxq3DAAACjklEQVQ4y4WTy49LcRzFP+2tzmVUr9dIDJOWGGVBicgEyTQTCzIetUFssDKJSFhY2SARCYvBbGrj8QcIkYglk8xCmEQ9xqNexbQVY2Zub3un9/W7PwstHZH4Jie/7+Kc8/suzgnwr+kjBqSBbm2lkm6bHyH3XM9SZQ8Z8s3UQJPo0IJVof5EZ7v2faxMrKONlhmQWN5GSFEwLbhybjBPhDwVsmQ4AaA09Mou+k8d702EAzXiS6KEgzahoIthGOi6DtKlN71GS+/cEPs0WewaX2R9ZphssP776UhESY0WSpQNg7Jh4Anx+zgJVKpV3uZyvHjzir27NwGs/XVBH8c7N2nnjx7eSqlYxPM8JCCkxBU+rhA4dVhCYJgmyc4Ej96/7rLi8nNAPc/k2ZNp7cnTpziuiy8lvpSI+tvYhS/xpY8vJXMiEbZv3MzFq3cJqaqiPX72jnKt9kfQRPZ9f5qZ70sMawyAas1GseIy1rNtVXK8Mkm1VsP2PBzhYQuB5Qns+t6AJQSqqlIcrTAy+ONGENBWLF3MN71MxXGo1mE6DqbrYLou8z/a7L3uMKvgUnU8xk2T3u71ADGFDdgvCx/3TwkLEfKxhWDHbY+eYZ+Obz6tJcmRApRsuJ8Ex4Po7Jl8/TDBl7flm4Gm5F1vSZKaFQUh4cB9OLgaDB3UVrjwA+6tBnKAis4El8lwujmJSVQeoKAxFzqDcG0KWhZC6R30tUJRQD3Odxqy4G+DDFks4pisY5RLgRx5pZ5T4cKy95yhSrxZDBCaVqIMOpAd2EIeSEW7wLQh3Ar7RtCHbk0v0vQy1WdgCymgf147Sa0dhAOVMZgoALDu2BDZ/xloQAzQgIOhMCnPYQ+gHRvi4d/8n00kYDRVLifLAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDEwLTAyLTExVDE0OjUxOjE3LTA2OjAwHh/NoQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAwNC0wOS0yMFQxNzoxMDoyNi0wNTowMCcJijsAAAAASUVORK5CYII=")}\n${m("branch",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEX///99plFAfADL27hpmyfP8YxyoilSiRiv0XGGygK02VtRiBmVwjh8xQCcziFZkhLz9+9BfQB2rwaCyACRygFQigXw9Ox0mkpXkQCJzwBblgBmkzP8/fxEgQBCfwBEgQejwITe3t5hkC1CfgBfjynZ2tmSq3eArDu72oNvoDJajyTY2dhFgQDCzLqhvn9EgAazx55XkwCVzC2824GMs1J0oUTY48xajiK72YR9qj2Tq3dhkix+th99xAB3uADA3oQ+fABEgABIgwW82oOUyi5VkgCf0CaEygB+wwCbzjN1mkrA3YZ1tAB7wAB+uB1vl0JdmgCJwwCKzwBoqAB4nVBikiuayzZ8wQCFywCg0Sjd3t1lkjFBfABLgwhKgwlmpgCK0QCJxQBclwDMzMzPz89GggCDpFxDfgCIpmPl5eUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABhAABQEABuZQBjYQBvcgAIZABiYQBlZAAABQDU/wCx/wCO/wBr/wBI/wAl/wAA/wAA3AAAuQAAlgAAcwAAUADU/wCx/wCO/wBr/wBI/wAl/wAA/gAA3AAAuQAAlgAAcwAAUADj/wDH/wCr/wCP/wBz/wBX/wBV/wBJ3AA9uQAxlgAlcwAZUADw/wDi/wDU/wDG/wC4/wCq/wCq/wCS3AB6uQBilgBKcwAyUAD//wD//wD//wD//wD//wD//wD+/gDc3AC5uQCWlgBzcwBQUAD/8AD/4gD/1AD/xgD/uAD/qgD/qgDckgC5egCWYgBzSgBQMgD/4wD/xwD/qwD/jwD/cwD/VwD/VQDcSQC5PQCWMQBzJQBQGQD/1AD/sQD/jgD/awD/SAD/JQD+AADcAAC5AACWAABzAABQAAD/1AD/sQD/jgD/awD/SAD/JQD/AADcAACwULzWAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAALZJREFUeNpjYAADRiZGBmTAzMLKxowswM7BycWNLMDEw8vHL4AkICgkLCIqhiQgLiEpJS0D5cjKySsoKimrqMJk1dQ1NLW0dXQZ9PTlZEECBoZGxiamOmbmmhaWViABaxtbO3sHRycTZxdXA7ANbu4enkxeDt4+vn7WIAH/gMCg4JBQprDwiEhBkEBUtGBMrI5OXHxCYpI/2BrV5OSU5NS09BjB6CiE01JTM5KTVZHcmpycCWEAANfrHJleKislAAAAAElFTkSuQmCC")}\n${m("leaf",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEX////M27mQs2tilDA9eQA7egBbkhVTjAxJgwWBqVdGgQBrnySdxViu0WrE4oaYv2PC35NtoCqxvaSevX5FgAB7qje73nDK6neu109vpyVupCGo2kJ9xwBQhBtilC9pnx7G63PM6olgnAB/vQBDigCVv0yb1CaDzAB8uBJwmkNnnBnB52ui2Ca94WZopAE/hgCtz2ue2CmDywCByACKujtdjyqdvHpdlhLV9YdkowCFxwCw1lFXmAJvpC5jng1coABlpwBprAB8sitAfABDfgKx31Gr3TuCsi5sqABtqgBUkxTV85zL7I213mef0j+OxyKk00k/ewCp3TCSyhCw0mRRjQC23HmU0h55wQB5vQB4uQB1tgCIwBeJxgCBvQDC3ndCjACYx1204Fx6wwB7vQB1tABzsQBBfQBpkzdtpQB9tQA/iQCMu1SMukNUlQBYmQBsqAd4rh11rwZyrQBvqgBDfwCqvZVWkQBUnACp0Hq/43K733C+4X+w12eZyT2IvSN5sgpZkwBxmUSDqFlbnACJzQy742p/wwB2ugBysgBwrwBvqwBwqQBhmgBCfwDV2NN8pk1foACO1QBZmABRkABpqwB3uQB0sgB0rgBnogBUjgC7w7NymkFdnQBUhxmis41okjdCfgBGgQWHpWPMzMzb3NtumD5NhQzT09Pv8O/a2trOz87l5eXc3NzPz88AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABtHAA4HXQAAEgAAB9CTigAAABCfCQ4HTxy6Kw4HXRy+8xy+8wAAMwAAAAAAAAAAAAAAAAAAAAAAAgAAAgAABgYAAG7AAAAACgAAAgAAAgYAAEAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4Hnw4HnwAAFRpRiYmO2V0aWRtSSY7ZWdsZVNpdGNBO251amRGO3R0bCYmO3J3ZWlvVCY7c2xuaVc7d28ABCwBG8q3AAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAAOtJREFUeNpjYIACRiZmFlY2dg4ol5OLm4eXj19AUAjMFRYRFROXkJSSlpEF8+XkFRSVlFVU1dQ1NMF8LW0dXT19A0MjYxNTIN/M3MLSytrG1s7ewdHJGSjg4urm7uHp5e3j6+cfABIIDAoOCVUJC4+IjIqOAQk4x8bFJyQmJadEpaalpQMFMjKzsnNy8/ILCouKS0qBAmXlFZVV1TW1dfUNJY1NQIHmlta29o7ozq7unt6+fgaGCRMnTZ4ydVrU9BkzZ5XOBiqYM3HuvPkL0tPTFy5avATkzqXLlq9YuWoJEKxeA/Ho2nUMyAAA9OtDOfv2TiUAAAAASUVORK5CYII=")}\n${m("leaf_method",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAKlBMVEUAAAAAgADzExMAgIAAAADAwMCAgADxGRnuFxLnHhHuIyPKJQ/rLi7////aW8ZOAAAAAXRSTlMAQObYZgAAAAFiS0dEDfa0YfUAAAAHdElNRQfgCxIPFR/msbP7AAAAaUlEQVQI12NggANBBiYFMMNQxAjCYA4UUoZIBRpBGMyiQorGIIaxWRCEwSYo3igiCNJlaLkwGSwkJn1QGMhgNDQ0TDU2dACqERYTDksGG5SkmGoApBnFhBRTBUAiaYJpDIJgs10cGBgdACxbDamu76Z5AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE3LTAxLTE3VDA5OjMwOjM1KzAxOjAwyGHxKQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNi0xMS0xOFQxNToyMTozMSswMTowMJgvuUkAAAAASUVORK5CYII=")}\n${m("globe",18,"gif","R0lGODlhEwASAPcAAPr7/AFyAQFCpwGD6jy3/wE9on7N0AE+pAFjyMLI0AE2mwF94wGP9QFpzgU3nISSopWgrmJsfTNLfgFHqAFuBilNiTp4sLnGzwWb/0xYb/P09mRygGl0hRlnMgR12V2Pr6e4xF9peS2Cyh5FpBdSfgF84YmisdPa30hjvw+foQFYvlWj4HWIlkWb5gk5n/b4+gw+kgFMscXb6ylmieDj5ju2pylTsniElgqd/u/x8wGW/O7v8SVMsUq+JSSJXQFiwfv+/AFqvB9ntobZeKbc/9vt+B+YmW2rvKruzQGPkm3PPrjmxQFIklrFLVbD4QGMYaXkoIPD13LC+nGw5AGFQHG66gF2eBaJxket9sLf84HI+wF7axBdbg2c0CR+1QFsEIfJ7yqoUIbH41tldgF+KzVTjn3QfitZgTJZkaDR8gKDsXeWrE+zogE3nCeKzQFtJ0tknjdnbQGB6EJgxQFqAcLJ0WC//yKm/wE+o7vI0ARozEOz/4/g/4KToyaX4/D09pCpuNHV24HA6gw7oAF/AXWKnEVSb5TI6VzDTrPprxBQts7e6FNdcBA9oySd9RRjPAhnD2NvgIydrF+6wdLo9v7//2K+twKSdDmKyeD56wGCyHq12VnF+ZXXsARdTjZWthShoo7gtilDlAFw1RCXvF+z6p/R8kqZzAF0Oj5jjFuJqgFoAkRgxtzr9YmcrJKsugFlylfBgxJGhjJIeFnFuhmi/+bo65ipt8Hn+UhVco7B5SZowAGBKoaZqAGGAVHBUwF8Qq7Y819qe4DEoVyYwrnb8QGN9GCy6QFTuHB9jgGY/gFRtuTu9ZOhr150iwFbwTFiwFus4h9mYt/y+kWZ35vM7hGfccz43Xy/6m3BuS1GiYveqDRfwnbUV4rdu////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAN8ALAAAAAATABIAAAj/AL8JHEiwVTVspar8ITiwiJhswyaBibJJUq9Trxh+S2OAVihvSzqRcoTpmy5ADIPFqrHtGpBETbrIuXJEBgiGbHoogTItExJOoAbw8rHmAkFTC8KYwTWkGx8COp4AozAjD8Epo4wQQfTLCQEcxqigoiONBUFqerRYspYCgzIGmgi98cRlA8EVLaR4UJPk0oASVgKs6kAiBMFDdrzAarDFF5kgCJA9ilNBGMFjWAQse/YjwBcVMfCcgTMr2UBKe0QIaHNgAiQmBRS4+CSKEYSBWe44E6JoEAxZDhrxmDPCEAcaA4vVinTCwi5uKFhBs6EtQ4QEOQYy8+NGUDRiqdCUJJGQa8yNQDsADHyxSNUHE4Vc3erzoFkdWxoAVNLIv7///98EBAA7")}\n${m("canvas",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEX/AAC1t7etsLCsrq6rrq6rrq2tr6+0tratsK/////p6enIysrl5OTn5uXo5+ajpaXo5+dhhKdliKlmialgg6elp6f6+/vIycnr7Ozw7u7x7u7x7u3t6+vLzMvp7vbs7/bz8PD17+3z7u2rrq/6xS76xy13zv9+z/+EwLF4zP/38/NfgqWAoL36uCj6vCmR2f+TxamSrBmNvoj++fz8+Pf69/WZ3f+g4P+n4/+Cnw2Dox16nQ3//f9hg6eBob6x5/+46f+77P+p2NKSZhOi1s////7//fusrq98sB6CsyWDtSmFuC9+dBl/tilfgqasr6+sr7DbAADcAABcgqWAoLyusLC4urqssLCssLGrsLCrr7Ctr67c3NzMzMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABoAAAKAgJldmV0dU8GB3JvTnZDBWVyb2xsYwdjYWxhUBB0bmVrY2F1b3IICGRPYmFyZWQAAAXj1P/Hsf+rjv+Pa/9zSP9XJf9VAP9JANw9ALkxAJYlAHMZAFDU1P+xsf+Ojv9ra/9ISP8lJf8AAP4AANwAALkAAJYAAHMAAFDU4/+xx/+Oq/9rj/9Ic/8lV/8AVf8ASdwAPbkAMZYAJXMAGVDU8P+x4v+O1P9rxv9IuP8lqv8Aqv8AktwAerkAYpYASnMAMlDU//+x//+O//9r//9I//8l//8A/v4A3NwAubkAlpYAc3MAUFDU//Cx/+KO/9Rr/8ZI/7gl/6oA/6oA3JIAuXoAlmIAc0oAUDLU/+Ox/8eO/6tr/49I/3Ml/1cA/1UA3EkAuT0AljEAcyUAUBnU/9Sx/7GO/45r/2tI/0gl/yUA/gAA3AAAuQAAlgAAcwAAUADj/9TH/7Gr/46P/2tz/0hX/yVV/wBJ3AAQ+AFLAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAALpJREFUeNpjYGBkYmZhYWFlYWNngAAOTijg4oYIMHPy8PLx8nDycwpwQwUEhYSFRDhFxTi5xCECEpJS0jKcsqL8nGwgARZOOXkFRSWwMcwgAWVOFVU1dQ1NLW0dmICunr6BoZGxiSlEgJnTzNzC0sraxtYOJmDv4Ojk7MLp6gYRcOf08PTy9vHl9IOa4c+JAGCBAM7AoEDOwEDO4BCIABOSilCQQBhTeERkVGS4f3R0aBhIICYWAWIYGAClIBsa7hXG7gAAAABJRU5ErkJggg==")}\n${m("profile",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAACXBIWXMAAAsSAAALEgHS3X78AAABZElEQVR42o1R22rCQBD1U/p//apCNtsHwRdfBaFIKbRoUVKMMTWBWIxVCq2b+07POrn4UKjDMpw9O2fm7G5vNBpJKe2/Qto4uEc2WMrBYEBEPaAky36UulwnlSRpUeZEBSGrpEiyHJVGAPVJqZvbO3ftv83Dle+vvPV4/LD0PGYAcKrSFJUsEOgHKoj3s9dFGH9uou3k8ekQKxyDQcYpBnYC7Hm9zBZmlL8BiIJDC0AWpa4FwhZJXoDCBgYAjgU5ToBt+k1tL14ssFNNvIEBAFwVljJlSDBfpwyg1ISnYoEsiHju5XLcd+T50q0tEQm7eaWKKNfUWgKApUsbPFY0lzY6DraEZm585Do/CLMzqLQWQnSC9k34lVa7PTsBs/zYOa4LB5ZlnQXCbif40Ra50jUwE6JtCcMlUiMQlugEQYisG8CWtGlRdQL+jmui/rjhcAhk/Reo6ff7RuB53vN1MZ1OIfgFQC1cuR3Y6lIAAAAASUVORK5CYII=")}\n${m("execute",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAABlBMVEXAwMAAxwCvbOAvAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAACBJREFUCFtjYIABHgYGfiA6wMD/gYH/B5g8ABLhYUAGAHniBNrUPuoHAAAAAElFTkSuQmCC")}\n${m("file",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAAAQAAAAEABcxq3DAAAA2klEQVRIx61VURbDIAgTX+9ljg4n2z5sNouj1ml+LE9rQkSU5PA6kTZBToTznj5aqKqq+py4lFJKScnMzCwlAAB6IbnNuyXycd1g3oHrf32CmR9mZqpVOdDHs2DmI+c+AiJixu1RAN9xFUcdWCjVIr8xCX8Jubc8Ao9CJF8nRFgNJBxZSCEkjmrIxxSS0yIAoBU4OkpfU8sCPEbEvqaOXcR31zWORbYJ8EI8rsK+DWm7gMVb8F/GK7eg6818jNjJZjMn0agY7x6oxqL5sWbIbhLHoQN78PQ5F3kDgX8u9tphBfoAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMDItMDZUMTA6Mjc6MzErMDE6MDChLu/mAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjIwKzAxOjAwIGvf8wAAAABJRU5ErkJggg==")}\n${m("text",16,"gif","R0lGODlhEgASALMAAP/////MzP+Zmf9mZv8zM/8AAMzM/8zMzJmZ/5mZmWZm/2ZmZjMz/zMzMwAA/////yH5BAUUAA8ALAAAAAASABIAAARo8MlJq73SKGSwdSDjUQoIjhNYOujDnGAnFXRBZKoBIpMw1ICHaaigBAq/AUK1CVEIhcfPNFlRbAEBEvWr0VDYQLYgkCQWh8XiAfgRymPyoTFRa2uPO009maP8ZmsjAHxnBygLDQ1zihEAOw==")}\n${m("task",18,"png","iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAAAAACMfPpKAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAATklEQVQY05XQUQoAIAgD0N3JY3fIChWttKR9xYvBCj0J0FsI3VVKQflwV22J0oyo3LOCc6pHW4dqi56v2CebbpMLtcmr+uTizz6UYpBnADSS8gvhaL5WAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE2LTA0LTA3VDA5OjQyOjQ4KzAyOjAwMgzRmQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOCswMTowMJ0LlncAAAAASUVORK5CYII=")}\n${m("pavetext",18,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAAsSURBVBjTY2CgCuBAAt1gASS5KKgARBpJACSEooIsARRbkABYoDsKCRDhEQBA2Am/6OrPewAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNi0wMS0wNFQxMDoxODoyNyswMTowMHsz6UQAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MjArMDE6MDAga9/zAAAAAElFTkSuQmCC")}\n${m("pavelabel",18,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAApSURBVBjTY2CgCuBAAt1gASS5KJgABzUEgABFANUWJAAWYIhCAkR4BAAHoAkEyi2U3wAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNi0wMS0wNFQxMDoxODoyNyswMTowMHsz6UQAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MjArMDE6MDAga9/zAAAAAElFTkSuQmCC")}\n${m("list",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AEECTc01vBgywAAAE9JREFUOMu1k8ERwDAMwqRc9l/Z/eeRpKZlABkOLFD0JQGgAAah5kp8Y30F2HEwDhGTCG6tX5yqtAV/acEdwHQHl0Y8RbA7pLIxRPziGyM9xLEOKSpp/5AAAAAASUVORK5CYII=")}\n${m("color",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAM1BMVEUAAAAA4xcavGZGS1xZT79lW+9wdvFz/3N6fo3RISTZwXbyniXz80v/AAD/zAD/66v//6vGWiYeAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADswAAA7MAbGhBn4AAAAHdElNRQfgAQQLLBhOmhPcAAAAIklEQVQY02NgRgEMDAzMnLzcfDwC7IxMbKwsQ10A3XMEAQA3JQVNowlkTAAAAABJRU5ErkJggg==")}\n${m("colz",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAMFBMVEV6fo0A4xcavGZGS1xZT79lW+9wdvFz/3PRISTZwXbyniXz80v/AAD/zAD/66v//6t1AkcGAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADswAAA7MAbGhBn4AAAAHdElNRQfgAQQLNwdqpNWzAAAAT0lEQVQI12NgYGAwNjZmAAOLjmY0hs2ZwxCG1arFEIbt3csQhvXuzRCG/f/PEIZ5eTGEYSgoDGEYKSlDGGZpyRCGaWgwhGHi4gxhwG0HAwCr3BFWzqCkcAAAAABJRU5ErkJggg==")}\n${m("frame",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfgAQQLOwq4oOYCAAAAcUlEQVQoz7WQMQqAMAxFX0Uk4OLgIbp4oZ7BA/cOXR0KDnGpRbGayT+EQF74nw+GHIBo+5hdWdqAaFDoLIsegCSeWE0VcMxXYM6xvmiZSYDTooSR4WlxzzBZwGYBuwWs4mWUpVHJe1H9F1J7yC4ov+kAkTYXFCNzDrEAAAAASUVORK5CYII=")}\n${m("class",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QAvQC9AL1pQtWoAAAAjUlEQVR42p2T2wnAIAxFM0g/O6jDdBBHcAyHKKQYjfiI0UY4P8I9BG4CID8smB4+8SUsohpO3CFzKqmBFrhCO4kqQnCR6MJF4BEJTVQFhBAmASNIZkH6a0OMc8oUDAu8z7RhTTBVyIIEhxeCdYWjQApvK2TBrgGpwpP1livsBXC0ROMO/LqDKjKEzaf8AZWbJP6pTT9BAAAATHpUWHRTb2Z0d2FyZQAAeNpz0FDW9MxNTE/1TUzPTM5WMNEz0jNQsLTUNzDWNzBUSC7KLC6pdMitLC7JTNZLLdZLKS3IzyvRS87PBQDzvxJ8u4pLSgAAADN6VFh0U2lnbmF0dXJlAAB42ktKs0hLMkk2MzJKNEuzMLKwtEizSElMMbNITUw0NUtNAQCc7Qma0Goe1QAAAABJRU5ErkJggg==")}\n${m("member",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QAvQC9AL1pQtWoAAAAX0lEQVR42mNgAAIVBob/+DADPgBS8GCPBV6M1xCKDcDnBRcoZhgW4D8DBV75v2bLATAmxyC4ZmRMrCFYNfeU9BBvwJwpS8AYWTNZBoAwTDPFBpAciDCDyNFMtXSAFwAAUyq0GRPbbz4AAABMelRYdFNvZnR3YXJlAAB42nPQUNb0zE1MT/VNTM9MzlYw0TPSM1CwtNQ3MNY3MFRILsosLql0yK0sLslM1kst1kspLcjPK9FLzs8FAPO/Eny7iktKAAAAM3pUWHRTaWduYXR1cmUAAHjaS01JNrE0S00zSbU0NEsxMbMwM0xOSjYwNzY3NLRIMjUCAJcdCJ2BHe6SAAAAAElFTkSuQmCC")}\n${m("tf1",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADFBMVEX/////AP8/SMz///+Cf5VqAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfgCw4QHgSCla+2AAAAL0lEQVQI12MQYAACrAQXiFBoABINCgwMQgwcDAwSDEwMDKmhodMYJjAwaKDrAAEAoRAEjHDJ/uQAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTYtMTEtMTRUMTc6Mjk6MjErMDE6MDDxcSccAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE2LTExLTE0VDE3OjI5OjA1KzAxOjAwNka8zgAAAABJRU5ErkJggg==")}\n${m("tf2",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADFBMVEX/////AP8A/wD////pL6WoAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfgCw4PNgzGaW1jAAAARUlEQVQI12NgEGDQZAASKkBigQKQ6GhgYBDiYgASIiAigIGBS8iBgUFhEpCnoAEkUkNDQxkagUIMrUDMMAVETAARQI0MAD5GCJ7tAr1aAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE2LTExLTE0VDE2OjUxOjUzKzAxOjAwi1Gz3gAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNi0xMS0xNFQxNjo1MTozNiswMTowMG5bLUIAAAAASUVORK5CYII=")}\n`,z,"jsroot_hstyle")}(I.node());const A=m,R=[];let k=null;if(m.forEachItem(ve=>{delete ve._d3cont,"_fastcmd"in ve&&"Command"===ve._kind&&R.push(ve),"_status"in ve&&!k&&(k=ve)}),!m.h||I.empty())return m;if(R.length){const ve=I.append("div").attr("style","display: inline; vertical-align: middle; white-space: nowrap;");for(let Se=0;Se<R.length;++Se){const De=ve.append("button").text("").attr("class","jsroot_fastcmd_btn").attr("item",m.itemFullName(R[Se])).attr("title",R[Se]._title).on("click",function(){A.executeCommand((0,V.Lt)(this).attr("item"),this)});R[Se]._icon&&De.style("background-image",`url('${R[Se]._icon}')`)}}const ee=I.append("p").attr("class","jsroot").style("margin-bottom","3px").style("margin-top",0);ee.append("a").attr("class","h_button").text("expand all").attr("title","expand all items in the browser").on("click",()=>m.toggleOpenState(!0)),ee.append("text").text(" | "),ee.append("a").attr("class","h_button").text("collapse all").attr("title","collapse all items in the browser").on("click",()=>m.toggleOpenState(!1)),(0,v.isFunc)(m.removeInspector)&&(ee.append("text").text(" | "),ee.append("a").attr("class","h_button").text("remove").attr("title","remove inspector").on("click",()=>m.removeInspector())),"_online"in m.h&&(ee.append("text").text(" | "),ee.append("a").attr("class","h_button").text("reload").attr("title","reload object list from the server").on("click",()=>m.reload())),"disp_kind"in m&&(ee.append("text").text(" | "),ee.append("a").attr("class","h_button").text("clear").attr("title","clear all drawn objects").on("click",()=>m.clearHierarchy(!1)));const ge=I.append("div").attr("class","jsroot").style("font-size",m.with_icons?"12px":"15px").style("flex","1");if(m.show_overflow||ge.style("overflow","auto"),m.background&&ge.style("background-color",m.background).style("margin","2px").style("padding","2px"),m.textcolor&&ge.style("color",m.textcolor),m.addItemHtml(m.h,ge.append("div").attr("class","h_tree")),m.setTopPainter(),k&&!m.status_disabled&&!(0,v.decodeUrl)().has("nostatus")){const ve=(0,v.findFunction)(k._status);if((0,v.isFunc)(ve))return m.createStatusLine().then(Se=>{Se&&ve(Se,m.itemFullName(k))})}return m})()}updateTreeNode(m,I){if(void 0===I||I.empty()){I=(0,V.Lt)(m._d3cont?m._d3cont:null);const A=this.itemFullName(m);if(I.empty()&&(I=this.selectDom().select(`[item='${A}']`)),I.empty()&&"_cycle"in m&&(I=this.selectDom().select(`[item='${A};${m._cycle}']`)),I.empty())return}this.addItemHtml(m,I,"update"),this.brlayout?.adjustBrowserSize(!0)}updateBackground(m,I){if(!m||!m._d3cont)return;const A=(0,V.Lt)(m._d3cont);if(A.empty())return;const R=A.select(".h_item");R.style("background",m._background?m._background:null),I&&m._background&&R.node().scrollIntoView(!1)}focusOnItem(m){var I=this;return(0,be.A)(function*(){(0,v.isStr)(m)&&(m=I.findItem(m));const A=m?I.itemFullName(m):"";if(!A)return!1;let R=m,k=!1;for(;R;)void 0!==R._childs&&!R._isopen&&(R._isopen=!0,k=!0),R=R._parent;return(k?I.refreshHtml():Promise.resolve(!0)).then(()=>{const ge=I.selectDom().select(`[item='${A}']`);return!ge.empty()&&(ge.node().scrollIntoView(),!0)})})()}tree_click(m,I,A){if(!I)return;const R=(0,V.Lt)(I.parentNode.parentNode),k=R.attr("item"),ee=k?this.findItem(k):null;if(!ee)return;if(ee._break_point){delete ee._break_point,this.addItemHtml(ee,R,"update");const ct=ee._parent,$=ct._childs.indexOf(ee),tt=(0,V.Lt)(R.node().parentNode);if($<0)return console.error("internal error");ct._show_limit=2*(ct._show_limit||v.settings.HierarchyLimit);for(let We=$+1;We<ct._childs.length;++We){const Ne=ct._childs[We];if(Ne._parent=ct,!this.addItemHtml(Ne,tt,We))break}return}let ve,ge=ee;for(;ge&&void 0===(ve=ge._click_action);)ge=ge._parent;A||(A="item");const De=(0,ot.iO)(ee._kind,ee._kind===v.prROOT+v.clTKey&&ee._more?"noinspect":""),Xe=De.handle;if("icon"===A){let ct=null;return(0,v.isFunc)(ee._icon_click)?ct=ee._icon_click:(0,v.isFunc)(Xe?.icon_click)&&(ct=Xe.icon_click),void(ct&&ct(ee,this)&&this.updateTreeNode(ee,R))}if("item"===A&&"_expand"in ee&&!m.ctrlKey&&!m.shiftKey&&(A="plusminus"),"plusminus"===A&&!("_childs"in ee)&&ee._more||"item"===A&&"expand"===ve)return this.expandItem(k,R);if("item"===A){if(ee._player)return this.player(k);if(Xe?.aslink)return window.open(k+"/");if(Xe?.execute)return this.executeCommand(k,I.parentNode);if(Xe?.ignore_online&&this.isOnlineItem(ee))return;const ct="expand"===this.default_by_click;let $=ee._can_draw,tt=ee._more,We="";if(m.shiftKey&&(We=Xe?.shift||v.kInspect,(0,v.isStr)(We)&&0===We.indexOf(v.kInspect)&&Xe?.noinspect&&(We="")),m.ctrlKey&&Xe?.ctrl&&(We=Xe.ctrl),!We&&!Xe?.always_draw)for(let Ne=ee._parent;Ne;Ne=Ne._parent)if(Ne._painter){$=!1,void 0===tt&&(tt=!1);break}if(ee._childs&&(tt=!1),void 0===$&&($=De.draw),void 0===tt&&(tt=De.expand||De.get_expand),$&&tt&&!We&&(ct||"expand"===Xe?.dflt||Xe?.exapnd_after_draw&&this.isItemDisplayed(k))&&($=!1),$&&!We&&(We="__default_draw_option__"),$)return this.display(k,We,!0);if(tt||ct)return this.expandItem(k,R);if((0,v.isStr)(ee._kind)&&0===ee._kind.indexOf(v.prROOT)&&De.inspect&&!1!==$)return this.display(k,v.kInspect,!0);if(!ee._childs||ee===this.h)return}ee._isopen?delete ee._isopen:ee._isopen=!0,this.updateTreeNode(ee,R)}tree_mouseover(m,I){const A=(0,V.Lt)(I.parentNode.parentNode).attr("item"),R=this.findItem(A);if(!R)return;let k,ee=R;for(;ee&&!k;)k=ee._painter,ee=ee._parent;(0,v.isFunc)(k?.mouseOverHierarchy)&&k.mouseOverHierarchy(m,A,R)}direct_contextmenu(m,I){m.preventDefault();const A=(0,V.Lt)(I.parentNode.parentNode).attr("item"),R=this.findItem(A);R&&(0,v.isFunc)(this.fill_context)&&(0,Ke.ES)(m,this).then(k=>{this.fill_context(k,R),k.size()>0&&(k.tree_node=I.parentNode,k.show())})}fillSettingsMenu(m,I){m.addSettingsMenu(!0,I,A=>{"refresh"===A?(this.forEachRootFile(R=>K(R,R._file.fKeys,R._file,"")),this.refreshHtml()):"dark"===A?this.changeDarkMode():"width"===A&&this.brlayout?.adjustSeparators(v.settings.BrowserWidth,null)})}changeDarkMode(){this.textcolor&&(this.setBasicColors(),this.refreshHtml()),this.brlayout?.createStyle(),this.createButtons(),(0,v.isFunc)(this.disp?.changeDarkMode)&&this.disp.changeDarkMode(),this.disp?.forEachFrame(m=>{let I=(0,st.m6)(m);I||(I=(0,st.Nn)(m)),(0,v.isFunc)(I?.changeDarkMode)&&I!==this&&I.changeDarkMode()})}toggleDarkMode(){v.settings.DarkMode=!v.settings.DarkMode,this.changeDarkMode()}tree_contextmenu(m,I){m.preventDefault();const A=(0,V.Lt)(I.parentNode.parentNode).attr("item"),R=this.findItem(A);if(!R)return;const k=this.getOnlineProp(A),ee=this.getFileProp(A);return(0,Ke.ES)(m,this).then(ve=>{if(A&&R._parent||"_jsonfile"in R)if(k)this.fillOnlineMenu(ve,k,A);else{const Se=(0,ot.iO)(R._kind,"nosame");if(R._can_draw&&(Se.opts||(Se.opts=[""]),Se.opts.indexOf("")<0&&Se.opts.unshift("")),Se.opts){ve.addDrawMenu("Draw",Se.opts,Xe=>this.display(A,Xe),"Draw item in the new frame");const De=this.disp?.getActiveFrame();!Se.noappend&&De&&((0,st.m6)(De)||(0,st.Nn)(De))&&ve.addDrawMenu("Superimpose",Se.opts,Xe=>this.dropItem(A,De,Xe),"Superimpose item with drawing on active frame")}if(ee&&Se.opts&&!ee.localfile){const De=v.settings.NewTabUrl||v.source_dir;let Xe=function ge(ve){const De=document.createElement("div");return De.innerHTML=`<a href="${Xe=ve,Xe.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")}">x</a>`,De.firstChild.href;var Xe}(ee.fileurl);if(0===Xe.indexOf(De)&&(Xe=Xe.slice(De.length)),Xe=`${ee.kind}=${Xe}`,ee.itemname){let $=ee.itemname;$.search(/\+| |,/)>=0&&($=`'${$}'`),Xe+=`&item=${$}`}let ct="nobrowser";v.settings.WithCredentials&&(ct+="&with_credentials"),v.settings.NewTabUrlPars&&(ct+="&"+v.settings.NewTabUrlPars),v.settings.NewTabUrlExportSettings&&(1111!==v.gStyle.fOptStat&&(ct+=`&optstat=${v.gStyle.fOptStat}`),0!==v.gStyle.fOptFit&&(ct+=`&optfit=${v.gStyle.fOptFit}`),0!==v.gStyle.fOptDate&&(ct+=`&optdate=${v.gStyle.fOptDate}`),0!==v.gStyle.fOptFile&&(ct+=`&optfile=${v.gStyle.fOptFile}`),1!==v.gStyle.fOptTitle&&(ct+=`&opttitle=${v.gStyle.fOptTitle}`),"UTC"===v.settings.TimeZone?ct+="&utc":v.settings.TimeZone&&(ct+=`&timezone='${v.settings.TimeZone}'`),Math.abs(v.gStyle.fDateX-.01)>.001&&(ct+=`&datex=${v.gStyle.fDateX.toFixed(3)}`),Math.abs(v.gStyle.fDateY-.01)>.001&&(ct+=`&datey=${v.gStyle.fDateY.toFixed(3)}`),v.gStyle.fHistMinimumZero&&(ct+="&histzero"),v.settings.DarkMode&&(ct+="&dark=on"),v.settings.UseStamp||(ct+="&usestamp=off"),v.settings.OnlyLastCycle&&(ct+="&lastcycle"),1!==v.settings.OptimizeDraw&&(ct+=`&optimize=${v.settings.OptimizeDraw}`),200!==v.settings.MaxRanges&&(ct+=`&maxranges=${v.settings.MaxRanges}`),v.settings.FuncAsCurve&&(ct+="&tf1=curve"),v.settings.ToolBar||v.settings.Tooltip||v.settings.ContextMenu||v.settings.Zooming||v.settings.MoveResize||v.settings.DragAndDrop?v.settings.ContextMenu||(ct+="&nomenu"):ct+="&interactive=0"),ve.addDrawMenu("Draw in new tab",Se.opts,$=>window.open(`${De}?${ct}&${Xe}&opt=${$}`),"Draw item in the new browser tab or window")}(Se.expand||Se.get_expand)&&(R._more||void 0===R._more)&&(void 0===R._childs?ve.add("Expand",()=>this.expandItem(A),"Exapnd content of object"):ve.add("Unexpand",()=>{R._more=!0,delete R._childs,delete R._isopen,R.expand_item&&delete R._expand,this.updateTreeNode(R)},"Remove all childs from hierarchy")),R._kind===v.prROOT+v.clTStyle&&ve.add("Apply",()=>this.applyStyle(A))}else{let Se="",De=0;const Xe=[],ct=()=>De++>0?"&":"?";this.forEachRootFile(We=>Xe.push(We._file.fFullURL)),this.getTopOnlineItem()||(Se=v.source_dir+"index.htm"),this.isMonitoring()&&(Se+=ct()+"monitoring="+this.getMonitoringInterval()),1===Xe.length?Se+=`${ct()}file=${Xe[0]}`:Xe.length>1&&(Se+=`${ct()}files=${JSON.stringify(Xe)}`),this.disp_kind&&(Se+=ct()+"layout="+this.disp_kind.replace(/ /g,""));const $=[],tt=[];this.disp?.forEachFrame(We=>{const Ne=new st.JW(We);let pt,Fe=Ne.getTopPainter(),ht=Fe?Fe.getItemName():null;ht?pt=Fe.getDrawOpt()||Fe.getItemDrawOpt():(Fe=null,Ne.forEachPainter(dt=>{const rt=dt.getItemName();if(!rt)return;let _t=dt.getDrawOpt()||dt.getItemDrawOpt()||"";Fe?Fe.getPadPainter()===dt.getPadPainter()&&(0===_t.indexOf("same ")&&(_t=_t.slice(5)),ht+="+"+rt,pt+="+"+_t):(Fe=dt,ht=rt,pt=_t)})),ht&&($.push(ht),tt.push(pt||""))}),1===$.length?Se+=ct()+"item="+$[0]+ct()+"opt="+tt[0]:$.length>1&&(Se+=ct()+"items="+JSON.stringify($)+ct()+"opts="+JSON.stringify(tt)),ve.add("Direct link",()=>window.open(Se)),ve.add("Only items",()=>window.open(Se+"&nobrowser")),this.fillSettingsMenu(ve)}(0,v.isFunc)(R._menu)&&R._menu(ve,R,this),ve.size()>0&&(ve.tree_node=I.parentNode,ve.separ&&ve.add("separator"),ve.add("Close"),ve.show())}),!1}player(m,I){var A=this;return(0,be.A)(function*(){const R=A.findItem(m);if(!R||!R._player||!(0,v.isStr)(R._player))return null;let k=null;if(R._module){const ee=yield A.importModule(R._module);k=ee?ee[R._player]:null}else(R._prereq||R._player.indexOf("JSROOT.")>=0)&&(yield A.loadScripts("",R._prereq)),k=(0,v.findFunction)(R._player);return(0,v.isFunc)(k)?(yield A.createDisplay(),k(A,m,I)):null})()}canDisplay(m,I){if(!m)return!1;if(m._player)return!0;if(void 0!==m._can_draw)return m._can_draw;if((0,v.isStr)(I)&&0===I.indexOf(v.kInspect))return!0;const A=(0,ot.hd)(m._kind,I);return(0,ot.Xv)(A)}isItemDisplayed(m){const I=this.getDisplay();return!!I&&null!==I.findFrame(m)}display(m,I,A){var R=this;return(0,be.A)(function*(){const k=m;let ge=null,ve=!1,Se=null,De=m;const Xe=I?.indexOf("::_display_on_frame_::")??-1;Xe>=0&&(De=I.slice(Xe+22),I=I.slice(0,Xe));const ct=($,tt)=>(tt&&console.log("When display ",m,"got",tt),ve&&Se&&delete Se._doing_update,ve||(0,Qe.Rh)(),(0,v.isFunc)($?.setItemName)&&($.setItemName(k,ve?null:I,R),Se&&!Se._painter&&(Se._painter=$)),$||ge);return R.createDisplay().then($=>{if(!$)return ct();if(Se=R.findItem(k),Se&&"_player"in Se)return R.player(k,I).then(Ne=>ct(Ne));if(ve=(0,v.isStr)(I)&&0===I.indexOf("update:"),ve){if(I=I.slice(7),!Se||Se._doing_update)return ct();Se._doing_update=!0}if(Se&&!R.canDisplay(Se,I))return ct();let tt="",We=!1;if((0,v.isStr)(I)&&I.indexOf("divid:")>=0){const Ne=I.indexOf("divid:");tt=I.slice(Ne+6),I=I.slice(0,Ne)}return"__default_draw_option__"===I&&(We=!0,I=""),ve||(0,Qe.Rh)(`Loading ${k} ...`),R.getObject(k,I).then(Ne=>{ve||(0,Qe.Rh)(),Se||(Se=Ne.item);let Fe=Ne.obj;if(!Fe)return ct();ve||(0,Qe.Rh)(`Drawing ${k} ...`);let ht=Fe._typename?(0,ot.hd)(v.prROOT+Fe._typename):null;if(ht?.draw_field&&Fe[ht.draw_field]&&(Fe=Fe[ht.draw_field],I||(I=ht.draw_field_opt||""),ht=Fe._typename?(0,ot.hd)(v.prROOT+Fe._typename):null),We&&!I&&ht?.dflt&&"expand"!==ht.dflt&&(I=ht.dflt),tt)return(ve?ot.AI:ot.$2)(tt,Fe,I).then(_t=>ct(_t)).catch(_t=>ct(null,_t));let pt=!1;if($.forEachPainter((rt,_t)=>{if(rt.getItemName()!==k)return;const Yt=rt.getItemDrawOpt();We&&A&&(I=Yt),(ve||!I||Yt===I)&&(A&&!pt&&(pt=!0,$.activateFrame(_t)),(0,v.isFunc)(rt.redrawObject)&&rt.redrawObject(Fe,I)&&(ge=rt))}),ge)return ct();if(ve)return console.warn(`something went wrong - did not found painter when doing update of ${k}`),ct();const dt=$.findFrame(De,!0);return(0,st.tP)(dt),$.activateFrame(dt),(0,ot.$2)(dt,Fe,I).then(rt=>ct(rt)).catch(rt=>ct(null,rt))})})})()}enableDrag(m){m.attr("draggable","true").on("dragstart",function(I){const A=this.parentNode.parentNode.getAttribute("item");I.dataTransfer.setData("item",A)})}enableDrop(m){const I=this;(0,V.Lt)(m).on("dragover",function(A){const R=A.dataTransfer.getData("item"),k=I.findItem(R);(0,v.isStr)(k?._kind)&&0===k._kind.indexOf(v.prROOT)&&A.preventDefault()}).on("dragenter",function(){(0,V.Lt)(this).classed("jsroot_drag_area",!0)}).on("dragleave",function(){(0,V.Lt)(this).classed("jsroot_drag_area",!1)}).on("drop",function(A){(0,V.Lt)(this).classed("jsroot_drag_area",!1);const R=A.dataTransfer.getData("item");R&&I.dropItem(R,this)})}clearDrop(m){(0,V.Lt)(m).on("dragover",null).on("dragenter",null).on("dragleave",null).on("drop",null)}dropItem(m,I,A){var R=this;return(0,be.A)(function*(){(!A||!(0,v.isStr)(A))&&(A="");const k=(ee,ge)=>(!ge&&(0,v.isFunc)(ee?.setItemName)&&ee.setItemName(m,null,R),ee);if("$legend"===m){const ee=(0,st.m6)(I);return(0,v.isFunc)(ee?.buildLegend)?ee.buildLegend(0,0,0,0,"",A).then(ge=>k(ge)):(console.error("Not possible to build legend"),k(null))}return R.getObject(m).then(ee=>{if(!ee.obj)return null;const ge=(0,st.Nn)(I);return(0,v.isFunc)(ge?.performDrop)?ge.performDrop(ee.obj,m,ee.item,A).then(ve=>k(ve,ge===ve)):ge?.accept_drops?(0,ot.$2)(I,ee.obj,"same "+A).then(ve=>k(ve,ge===ve)):(R.cleanupFrame(I),(0,ot.$2)(I,ee.obj,A).then(ve=>k(ve)))})})()}updateItems(m){var I=this;return(0,be.A)(function*(){if(!I.disp)return!1;const A=[],R=[];let k=!1,ee=!1;return(0,v.isStr)(m)?m=[m]:(0,v.isObject)(m)||(void 0===m&&(m=!I.isMonitoring()),ee=!0,k=!!m),I.disp.forEachPainter(ge=>{const ve=ge.getItemName();if((0,v.isStr)(ve)&&!(A.indexOf(ve)>=0)){if(ee){const Se=I.findItem(ve);if(!Se||"_not_monitor"in Se||"_player"in Se)return;if(!("_always_monitor"in Se)){const De=(0,ot.hd)(Se._kind);let Xe=!1;if(void 0!==De?.monitor){if(!1===De.monitor||"never"===De.monitor)return;"always"===De.monitor&&(Xe=!0)}if(!Xe&&k)return}}else if(m.indexOf(ve)<0)return;A.push(ve),R.push("update:"+ge.getItemDrawOpt())}},!0),I.files_monitoring&&!k&&ee&&I.forEachRootFile(ge=>{I.forEachItem(ve=>{delete ve._readobj},ge),delete ge._file}),I.displayItems(A,R)})()}displayItems(m,I){var A=this;return(0,be.A)(function*(){if(!m||0===m.length)return!0;const R=A;for(I||(I=[]);I.length<m.length;)I.push("__default_draw_option__");if(1===I.length&&"iotest"===I[0]){A.clearHierarchy(),(0,V.Lt)("#"+A.disp_frameid).html("<h2>Start I/O test</h2>");const De=new Date;return A.getObject(m[0]).then(()=>{const Xe=new Date;return(0,V.Lt)("#"+A.disp_frameid).append("h2").html("Item "+m[0]+" reading time = "+(Xe.getTime()-De.getTime())+"ms"),!0})}const k=new Array(m.length),ee=new Array(m.length),ge=new Array(m.length);for(let De=0;De<m.length;++De){k[De]=ee[De]=null;const Xe=m[De];let ct=!0;if(0===Xe?.indexOf("img:")){ge[De]=!0;continue}Xe?.length>1&&"'"===Xe[0]&&"'"===Xe[Xe.length-1]&&(m[De]=Xe.slice(1,Xe.length-1),ct=!1);let $=R.findItem({name:m[De],check_keys:!0});if($){m[De]=R.itemFullName($);continue}if(ct&&"["===m[De][0]&&"]"===m[De][m[De].length-1]?(k[De]=w(m[De]),m[De]=k[De].shift()):ct&&m[De].indexOf("+")>0&&(k[De]=m[De].split("+"),m[De]=k[De].shift()),k[De]&&k[De].length>0){for(let We=0;We<k[De].length;++We){const Ne=k[De][We].indexOf("_same_");Ne>0&&null===R.findItem(k[De][We])&&(k[De][We]=k[De][We].slice(0,Ne)+m[De].slice(Ne)),$=R.findItem({name:k[De][We],check_keys:!0}),$&&(k[De][We]=R.itemFullName($))}for("["===I[De][0]&&"]"===I[De][I[De].length-1]?(ee[De]=w(I[De]),I[De]=ee[De].shift()):I[De].indexOf("+")>0?(ee[De]=I[De].split("+"),I[De]=ee[De].shift()):ee[De]=[];ee[De].length<k[De].length;)ee[De].push("")}const tt=m[De].indexOf("_same_");tt>0&&!R.findItem(m[De])&&De>0&&(m[De]=m[De].slice(0,tt)+m[0].slice(tt)),$=R.findItem({name:m[De],check_keys:!0}),$&&(m[De]=R.itemFullName($))}for(let De=m.length-1;De>=0;--De){if(ge[De])continue;const Xe=R.findItem(m[De]);!Xe||R.canDisplay(Xe,I[De])||(R.expandItem(m[De],null,!0),m.splice(De,1),I.splice(De,1),k.splice(De,1))}if(0===m.length)return!0;const ve=new Array(m.length),Se=new Array(m.length);for(let De=0;De<m.length;++De){Se[De]=0;let Xe=m[De],ct=0;m.indexOf(Xe)<De&&(Se[De]=!0);const $=I[De].indexOf("frameid:");if($>=0)Xe=I[De].slice($+8),I[De]=I[De].slice(0,$);else for(;ve.indexOf(Xe)>=0;)Xe=m[De]+"_"+ct++;ve[De]=Xe}for(let De=0;De<m.length;++De){if(0!==Se[De])continue;let Xe=De;for(let ct=0;ct<m.length;++ct)m[De]===m[ct]&&I[ct].indexOf("main")>=0&&(Xe=ct);for(let ct=0;ct<m.length;++ct)m[De]===m[ct]&&(Se[ct]=Xe!==ct)}return A.createDisplay().then(De=>{if(!De)return!1;for(let $=0;$<m.length;++$)0!==I[$].indexOf("update:")&&(De.createFrame(ve[$]),I[$]+="::_display_on_frame_::"+ve[$]);function Xe($,tt){if(tt&&k[$]&&k[$].length>0)return R.dropItem(k[$].shift(),tt.getDom(),ee[$].shift()).then(()=>Xe($,tt));k[$]=null,m[$]=null;for(let We=0;We<m.length;++We)if(null!==m[We]&&Se[We]&&m.indexOf(m[We])===We)return Se[We]=!1,R.display(m[We],I[We]).then(Ne=>Xe(We,Ne))}const ct=[];if(A._one_by_one){let $=function(tt){return tt>=m.length||(Se[tt]?$(tt+1):R.display(m[tt],I[tt]).then(We=>Xe(tt,We)).then(()=>$(tt+1)))};ct.push($(0))}else for(let $=0;$<m.length;++$)Se[$]||ct.push(R.display(m[$],I[$]).then(tt=>Xe($,tt)));return Promise.all(ct)})})()}reload(){var m=this;return(0,be.A)(function*(){return"_online"in m.h&&m.openOnline(m.h._online).then(()=>m.refreshHtml())})()}activateItems(m,I){(0,v.isStr)(m)&&(m=[m]);const A=[],R=[];this.forEachItem(ge=>{ge._background&&(A.push(ge),delete ge._background)});const k=()=>{for(let ge=R.length-1;ge>=0;--ge)this.updateTreeNode(R[ge]);for(let ge=0;ge<A.length;++ge)this.updateBackground(A[ge],I)},ee=(ge,ve)=>{if(void 0===ge){if(0===m.length)return k();ge=m.shift()}let Se=this.findItem(ge);if(!Se){const De=this.findItem({name:ge,last_exists:!0,check_keys:!0,allow_index:!0});if(!De||!De.last)return ee();if(De.now_found=this.itemFullName(De.last),I)return void 0!==ve&&De.now_found===ve?ee():this.expandItem(De.now_found).then(Xe=>{if(!Xe)return ee();let ct=this.itemFullName(De.last);ct&&(ct+="/"),ee(ct+De.rest,De.now_found)});Se=De.last}if(Se){let De=Se._parent;for(;De;){if(!De._isopen){if(!I){Se=De;break}De._isopen=!0,R.indexOf(De)<0&&R.push(De)}De=De._parent}Se._background="LightSteelBlue",A.indexOf(Se)<0&&A.push(Se)}ee()};if(I&&this.brlayout){if(!this.brlayout.browser_kind)return this.createBrowser("float",!0).then(()=>ee());this.brlayout.browser_visible||this.brlayout.toggleBrowserVisisbility()}ee()}canExpandItem(m){if(!m)return!1;if(m._expand)return!0;const I=(0,ot.hd)(m._kind,"::expand");return I&&g(I)}expandItem(m,I,A){var R=this;return(0,be.A)(function*(){const k=R.findItem(m),ee=R;if(!k&&I)return;function ge(De,Xe){return ve.apply(this,arguments)}function ve(){return(ve=(0,be.A)(function*(De,Xe){if((0,v.isStr)(De._expand)&&(De._expand=(0,v.findFunction)(De._expand)),!(0,v.isFunc)(De._expand)){let ct=(0,ot.hd)(De._kind,"::expand");if(ct?.expand_item&&!ee._inspector&&(Xe=Xe[ct.expand_item],De.expand_item=ct.expand_item,ct=Xe?._typename?(0,ot.hd)(v.prROOT+Xe._typename,"::expand"):null),ct?.expand||ct?.get_expand)if((0,v.isFunc)(ct.expand))De._expand=ct.expand;else if((0,v.isStr)(ct.expand)){if(!v.internals.ignore_v6){const $=yield(0,v._ensureJSROOT)();yield $.require(ct.prereq),yield $._complete_loading()}De._expand=ct.expand=(0,v.findFunction)(ct.expand)}else(0,v.isFunc)(ct.get_expand)&&(De._expand=ct.expand=yield ct.get_expand())}return Xe&&(0,v.isFunc)(De._expand)&&De._expand(De,Xe)||Xe&&G(De,Xe)?(De._isopen=!0,De._parent&&!De._parent._isopen?(De._parent._isopen=!0,A||ee.updateTreeNode(De._parent)):A||ee.updateTreeNode(De,I),De):-1})).apply(this,arguments)}let Se=Promise.resolve(-1);if(k){if(!1===k._more||!k._parent&&k._childs)return;if(k._childs&&k._isopen)return k._isopen=!1,void(A||R.updateTreeNode(k,I));k._obj&&(Se=ge(k,k._obj))}return Se.then(De=>-1!==De?De:((0,Qe.Rh)("Loading "+m),R.getObject(m,A?"hierarchy_expand":"hierarchy_expand_verbose").then(Xe=>{if((0,Qe.Rh)(),Xe.obj)return ge(Xe.item,Xe.obj).then(ct=>-1!==ct?ct:void 0)})))})()}getTopOnlineItem(m){if(m){for(;m&&!("_online"in m);)m=m._parent;return m}return this.h?"_online"in this.h?this.h:this.h._childs&&"_online"in this.h._childs[0]?this.h._childs[0]:null:null}forEachJsonFile(m){if(this.h){if("_jsonfile"in this.h)return m(this.h);if(this.h._childs)for(let I=0;I<this.h._childs.length;++I){const A=this.h._childs[I];"_jsonfile"in A&&m(A)}}}openJsonFile(m){var I=this;return(0,be.A)(function*(){let A=!1;if(I.forEachJsonFile(R=>{R._jsonfile===m&&(A=!0)}),!A)return(0,v.httpRequest)(m,"object").then(R=>{if(!R)return;const k={_jsonfile:m,_kind:v.prROOT+R._typename,_jsontmp:R,_name:m.split("/").pop()};if(R.fTitle&&(k._title=R.fTitle),k._get=function(ee){return ee._jsontmp?Promise.resolve(ee._jsontmp):(0,v.httpRequest)(ee._jsonfile,"object").then(ge=>(ee._jsontmp=ge,ge))},I.h)if(I.h._kind===Ie)I.h._childs.push(k);else{const ee=I.h;I.h={_name:"_jsonfile"in ee?"Files":"Items",_kind:Ie,_childs:[ee,k]}}else I.h=k;return I.refreshHtml()})})()}forEachRootFile(m){if(this.h){if(this.h._kind===C&&this.h._file)return m(this.h);if(this.h._childs)for(let I=0;I<this.h._childs.length;++I){const A=this.h._childs[I];A._kind===C&&"_fullurl"in A&&m(A)}}}findRootFileForItem(m){let I=this.findItem(m);for(;I;){if(I._kind===C&&I._fullurl&&I._file)return I;I=I?._parent}return null}openRootFile(m){var I=this;return(0,be.A)(function*(){let A=!1;if(I.forEachRootFile(k=>{k._fullurl===m&&(A=!0)}),A)return;const R=(0,v.isStr)(m)?m:"file";return(0,Qe.Rh)(`Opening ${R} ...`),(0,Le.Tq)(m).then(k=>{const ee=I.fileHierarchy(k);if(ee._isopen=!0,I.h)if(I.h._kind===Ie)I.h._childs.push(ee);else{const ge=I.h;I.h={_name:ge._kind===C?"Files":"Items",_kind:Ie,_childs:[ge,ee],_isopen:!0}}else I.h=ee,I._topname&&(ee._name=I._topname);return I.refreshHtml()}).catch(()=>((0,v.isBatchMode)()?console.error(`Fail to open ${R} - check CORS headers`):(0,V.Lt)("#gui_fileCORS").style("background","red").empty()||setTimeout(()=>(0,V.Lt)("#gui_fileCORS").style("background",""),5e3),!1)).finally(()=>(0,Qe.Rh)())})()}listServerDir(m){var I=this;return(0,be.A)(function*(){return(0,v.httpRequest)(m,"text").then(A=>{if(!A)return!1;const R={_name:"Files",_kind:Ie,_childs:[],_isopen:!0};let k=0;for(;k<A.length&&(k=A.indexOf('a href="',k+1),!(k<0));){k+=8;const ee=A.indexOf('"',k+1);if(ee<0)break;const ge=A.slice(k,ee);k=ee+1,ge.lastIndexOf(".root")===ge.length-5&&ge.length>5?R._childs.push({_name:ge,_title:m+ge,_url:m+ge,_kind:C,_click_action:"expand",_more:!0,_obj:{},_expand:ve=>(0,Le.Tq)(ve._url).then(Se=>{if(!Se)return!1;delete ve._exapnd,delete ve._more,delete ve._click_action,delete ve._obj,ve._isopen=!0,I.fileHierarchy(Se,ve),I.updateTreeNode(ve)})}):(ge.lastIndexOf(".json.gz")===ge.length-8&&ge.length>8||ge.lastIndexOf(".json")===ge.length-5&&ge.length>5)&&R._childs.push({_name:ge,_title:m+ge,_jsonfile:m+ge,_can_draw:!0,_get:ve=>(0,v.httpRequest)(ve._jsonfile,"object").then(Se=>(Se&&(ve._kind=v.prROOT+Se._typename,ve._jsontmp=Se,I.updateTreeNode(ve)),Se))})}return R._childs.length>0&&(I.h=R),!0})})()}applyStyle(m){var I=this;return(0,be.A)(function*(){if(!m)return!0;let A=Promise.resolve(m);if((0,v.isStr)(m)){const R=I.findItem({name:m,allow_index:!0,check_keys:!0});null!==R?A=I.getObject(R).then(k=>k.obj):m.indexOf(".json")>0&&(A=(0,v.httpRequest)(m,"object"))}return A.then(R=>{R?._typename===v.clTStyle&&Object.assign(v.gStyle,R)})})()}getFileProp(m){let I=this.findItem(m);if(!I)return null;let A=I._name;for(;I._parent;){if(I=I._parent,"_file"in I)return{kind:"file",fileurl:I._file.fURL,itemname:A,localfile:!!I._file.fLocalFile};if("_jsonfile"in I)return{kind:"json",fileurl:I._jsonfile,itemname:A};A=I._name+"/"+A}return null}getOnlineItemUrl(m){(0,v.isStr)(m)&&(m=this.findItem(m));let I=m;for(;I&&void 0===I._online;)I=I._parent;return I?I._online+this.itemFullName(m,I):null}isOnlineItem(m){return null!==this.getOnlineItemUrl(m)}importModule(m){return(0,be.A)(function*(){switch(m){case"core":return Promise.resolve().then(Te.bind(Te,4186));case"draw_tree":return Promise.all([Te.e(825),Te.e(76),Te.e(840)]).then(Te.bind(Te,6840));case"hierarchy":return{HierarchyPainter:N,markAsStreamerInfo:x}}return import(m)})()}getOnlineItem(m,I,A){var R=this;return(0,be.A)(function*(){let k=I,ee=!1,ge="",ve="object",Se=null;if((0,v.isStr)(A)&&0===A.indexOf("hierarchy_expand")&&(ee=!0,A=void 0),m){k=R.getOnlineItemUrl(m);let De=null;if("_kind"in m&&(Se=(0,ot.hd)(m._kind)),ee?(ge="h.json?compact=3",m._expand=b):m._make_request?De=m._module?(yield R.importModule(m._module))[m._make_request]:(0,v.findFunction)(m._make_request):Se?.make_request&&(De=Se.make_request),(0,v.isFunc)(De)){const Xe=De(R,m,k,A);Xe&&((0,v.isStr)(Xe)?ge=Xe:("req"in Xe&&(ge=Xe.req),"kind"in Xe&&(ve=Xe.kind)))}!ge&&0!==m._kind.indexOf(v.prROOT)&&(ge="item.json.gz?compact=3")}if(!I&&m&&"_cached_draw_object"in R&&!ge){const De=R._cached_draw_object;return delete R._cached_draw_object,De}return ge||(ge="root.json.gz?compact=23"),k&&(k+="/"),k+=ge,new Promise(De=>{let Xe=null;(0,v.createHttpRequest)(k,ve,ct=>{const $=tt=>{if((0,v.isFunc)(tt)){const We=tt(R,m,ct,A,Xe);(0,v.isObject)(We)&&(ct=We)}De(ct)};!ee&&m?._after_request?m._module?R.importModule(m._module).then(tt=>$(tt[m._after_request])):$((0,v.findFunction)(m._after_request)):$(Se?.after_request)},void 0,!0).then(ct=>{Xe=ct,ct.send(null)})})})()}openOnline(m){var I=this;return(0,be.A)(function*(){const A=function(){var R=(0,be.A)(function*(k){if(I.h=k,!k)return Promise.resolve(null);I.h?._title&&typeof document<"u"&&(document.title=I.h._title),k._isopen=!0,I.h._online=m,I.h._get=(De,Xe,ct)=>I.getOnlineItem(De,Xe,ct),I.h._expand=b;const ee=[],ge=[],ve=[],Se=[];return I.forEachItem(De=>{void 0!==De._childs&&(De._expand=b),De._autoload&&De._autoload.split(";").forEach(ct=>{ct.length>4&&ct.lastIndexOf(".mjs")===ct.length-4?Se.push(I.importModule(ct)):ct.length>3&&ct.lastIndexOf(".js")===ct.length-3?ge.find($=>$===ct)||ge.push(ct):ct.length>4&&ct.lastIndexOf(".css")===ct.length-4?ee.find($=>$===ct)||ee.push(ct):ct&&!ve.find($=>$===ct)&&ve.push(ct)})}),I.loadScripts(ge,ve).then(()=>(0,v.loadScript)(ee)).then(()=>Promise.all(Se)).then(()=>(I.forEachItem(De=>{if(!("_drawfunc"in De)||!("_kind"in De))return;let Xe="kind:"+De._kind;0===De._kind.indexOf(v.prROOT)&&(Xe=De._kind.slice(5));const ct=De._drawopt;(!(0,ot.Xv)(Xe)||ct)&&(0,ot.uA)({name:Xe,func:De._drawfunc,script:De._drawscript,opt:ct})}),I))});return function(ee){return R.apply(this,arguments)}}();if(m||(m=""),(0,v.isObject)(m)){const R=m;return m="",A(R)}return(0,v.httpRequest)(m+"h.json?compact=3","object").then(R=>A(R))})()}getOnlineProp(m){let I=this.findItem(m);if(!I)return null;let A=I._name;for(;I._parent;){if(I=I._parent,"_online"in I)return{server:I._online,itemname:A};A=I._name+"/"+A}return null}fillOnlineMenu(m,I,A){const R=this.findItem(A),k=(0,ot.iO)(R._kind,"nosame;noinspect"),ee=(0,ot.hd)(R._kind),ge=!!(0,v.isStr)(R._kind)&&0===R._kind.indexOf(v.prROOT);k.opts&&!1!==R._can_draw&&(k.opts.push(v.kInspect),m.addDrawMenu("Draw",k.opts,ve=>this.display(A,ve))),!R._childs&&!1!==R._more&&(R._more||ge||k.expand||k.get_expand)&&m.add("Expand",()=>this.expandItem(A)),ee?.execute&&m.add("Execute",()=>this.executeCommand(A,m.tree_node)),k.opts&&!1!==R._can_draw&&m.addDrawMenu("Draw in new window",k.opts,ve=>window.open(I.server+`?nobrowser&item=${I.itemname}`+(this.isMonitoring()?`&monitoring=${this.getMonitoringInterval()}`:"")+(ve?`&opt=${ve}`:""))),k.opts?.length&&ge&&!1!==R._can_draw&&m.addDrawMenu("Draw as png",k.opts,ve=>window.open(I.server+I.itemname+"/root.png?w=600&h=400"+(ve?"&opt="+ve:"")),"Request PNG image from the server"),"_player"in R&&m.add("Player",()=>this.player(A))}setHierarchy(m){this.h=m,this.refreshHtml()}setMonitoring(m,I){this._runMonitoring("cleanup"),m&&(m=parseInt(m),Number.isInteger(m)&&m>0?(this._monitoring_interval=Math.max(100,m),I=!0):this._monitoring_interval=3e3),this._monitoring_on=I,this.isMonitoring()&&this._runMonitoring()}_runMonitoring(m){return"cleanup"!==m&&this.isMonitoring()?"frame"===m?(delete this._monitoring_handle,void(this._monitoring_frame=requestAnimationFrame(this._runMonitoring.bind(this,"draw")))):("draw"===m&&(delete this._monitoring_frame,this.updateItems()),void(this._monitoring_handle=setTimeout(this._runMonitoring.bind(this,"frame"),this.getMonitoringInterval()))):(this._monitoring_handle&&(clearTimeout(this._monitoring_handle),delete this._monitoring_handle),void(this._monitoring_frame&&(cancelAnimationFrame(this._monitoring_frame),delete this._monitoring_frame)))}getMonitoringInterval(){return this._monitoring_interval||3e3}isMonitoring(){return this._monitoring_on}setDisplay(m,I){!I&&(0,v.isObject)(m)?(this.disp=m,this.disp_kind="custom",this.disp_frameid=null):(this.disp_kind=m,this.disp_frameid=I),!this.register_resize&&"batch"!==this.disp_kind&&(this.register_resize=!0,(0,Qe.d7)(this))}getLayout(){return this.disp_kind}removePainter(m){this.forEachItem(I=>{I._painter===m&&(delete I._painter,(0,v.isFunc)(I.clear)&&I.clear())})}clearHierarchy(m){this.disp&&(this.disp.cleanup(),delete this.disp);const I=[];this.forEachItem(A=>{delete A._painter,!m&&(0,v.isFunc)(A.clear)&&A.clear(),m&&I.push(A)}),m&&(this.enableMonitoring(!1),this.selectDom().html(""),I.forEach(A=>{delete A._parent,delete A._childs,delete A._obj,delete A._d3cont}),delete this.h)}getDisplay(){return this.disp}cleanupFrame(m){(0,V.Lt)(m).attr("frame_title",null),this.clearDrop(m);const I=(0,st.tP)(m);I.length>0&&this.forEachItem(A=>{A._painter&&I.indexOf(A._painter)>=0&&delete A._painter})}createDisplay(){var m=this;return(0,be.A)(function*(){if("disp"in m){if(m.disp.numDraw()>0||"custom"===m.disp_kind)return m.disp;m.disp.cleanup(),delete m.disp}return"batch"===m.disp_kind?((0,v.isNodeJs)()?(0,Je.lf)():Promise.resolve(null)).then(A=>(m.disp=new Re.bG(1200,800,A?.body),m.disp)):document.getElementById(m.disp_frameid)?(m.disp=0===m.disp_kind.indexOf("flex")||0===m.disp_kind.indexOf("coll")?new Re.o5(m.disp_frameid):"tabs"===m.disp_kind?new Re.Hb(m.disp_frameid):new Re.ho(m.disp_frameid,m.disp_kind),m.disp.cleanupFrame=m.cleanupFrame.bind(m),v.settings.DragAndDrop&&m.disp.setInitFrame(m.enableDrop.bind(m)),m.disp):null})()}createCustomDisplay(m,I){var A=this;return(0,be.A)(function*(){if("simple"!==A.disp_kind)return A.createDisplay();if(A.disp_kind=I,A.disp){const R=A.disp.numDraw();if(R>1||1===R&&!A.disp.findFrame(m))return A.createDisplay();A.disp.cleanup(),delete A.disp}return A.createDisplay()})()}updateOnOtherFrames(m,I){const A=this.disp;if(!A)return!1;const R=I._typename?(0,ot.hd)(v.prROOT+I._typename):null;R?.draw_field&&I[R?.draw_field]&&(I=I[R?.draw_field]);let k=!1;return A.forEachPainter(ee=>{ee===m||ee.getItemName()!==m.getItemName()||(0,v.isFunc)(ee.redrawObject)&&ee.redrawObject(I)&&(k=!0)}),k}checkResize(m){this.disp&&this.disp.checkMDIResize(null,m)}loadScripts(m,I,A){return(0,be.A)(function*(){return!m?.length&&!I?.length||(A&&!globalThis.JSROOT&&(globalThis.JSROOT={version:v.version,gStyle:v.gStyle,create:v.create,httpRequest:v.httpRequest,loadScript:v.loadScript,decodeUrl:v.decodeUrl,source_dir:v.source_dir,settings:v.settings,addUserStreamer:Le.Ub,addDrawFunc:ot.uA,draw:ot.$2,redraw:ot.AI}),v.internals.ignore_v6||A?(0,v.loadScript)(m):(0,v._ensureJSROOT)().then(R=>R.require(I).then(()=>(0,v.loadScript)(m)).then(()=>R._complete_loading())))})()}startGUI(m,I){var A=this;return(0,be.A)(function*(){const R=(0,v.decodeUrl)(I),k=jt=>{let Sn=R.get(jt,null);return null===Sn&&m&&!m.empty()&&m.node().hasAttribute(jt)&&(Sn=m.attr(jt)),Sn},ge=jt=>{let Sn=(jt=>{let Sn=[];for(;jt;){const cn=jt.indexOf(";");let gn=cn>0?jt.slice(0,cn):jt;jt=cn>0?jt.slice(cn+1):"";let Cn=!0;"#"===gn[0]&&(gn=gn.slice(1),Cn=!1);const Ln=R.get(gn,null);Cn?Sn=Sn.concat(w(Ln)):null!==Ln&&Sn.push(Ln)}return Sn})(jt);if(Sn.length>0||!m||m.empty())return Sn;for(;jt;){const cn=jt.indexOf(";");let gn=cn>0?jt.slice(0,cn):jt;jt=cn>0?jt.slice(cn+1):"";let Cn=!0;if("#"===gn[0]&&(gn=gn.slice(1),Cn=!1),"files"===gn||!m.node().hasAttribute(gn))continue;const Ln=m.attr(gn);Cn?Sn=Sn.concat(w(Ln)):null!==Ln&&Sn.push(Ln)}return Sn},ve=R.get("path")||"",Se=ge("#json;jsons"),De=ge("expand"),Xe=k("focus"),ct=k("layout"),$=ge("#style"),tt=k("title");A._one_by_one=v.settings.drop_items_one_by_one??null!==k("one_by_one");let We=k("prereq")||"",Ne=k("load"),Fe=k("dir"),ht=k("inject"),pt=ge("#file;files"),dt=ge("#item;items"),rt=ge("#opt;opts"),_t=k("monitoring"),Yt=0,kt=k("status"),Tt=k("browser"),fn=!!Tt;if(_t=null===_t?0:""===_t?3e3:parseInt(_t),null!==k("float")?(Tt="float",fn=!0):null!==k("fix")&&(Tt="fix",fn=!0),!fn&&v.browser.screenWidth<=640&&(Tt="float"),A.no_select=k("noselect"),null!==k("files_monitoring")&&(A.files_monitoring=!0),tt&&typeof document<"u"&&(document.title=tt),0===De.length&&""===k("expand")&&De.push(""),ve){for(let jt=0;jt<pt.length;++jt)pt[jt]=ve+pt[jt];for(let jt=0;jt<Se.length;++jt)Se[jt]=ve+Se[jt]}if(0===dt.length&&""===k("item")&&dt.push(""),1===Se.length&&0===dt.length&&0===De.length&&dt.push(""),!A.disp_kind)if((0,v.isStr)(ct)&&ct)A.disp_kind=ct;else if(v.settings.DislpayKind&&"simple"!==v.settings.DislpayKind)A.disp_kind=v.settings.DislpayKind;else switch(dt.length){case 0:case 1:A.disp_kind="simple";break;case 2:A.disp_kind="vert2";break;case 3:A.disp_kind="vert21";break;case 4:A.disp_kind="vert22";break;case 5:A.disp_kind="vert32";break;case 6:A.disp_kind="vert222";break;case 7:A.disp_kind="vert322";break;case 8:A.disp_kind="vert332";break;case 9:A.disp_kind="vert333";break;default:A.disp_kind="flex"}"no"===kt?kt=null:"off"===kt?(A.status_disabled=!0,kt=null):"on"===kt?kt=!0:null!==kt&&(Yt=parseInt(kt),(!Number.isInteger(Yt)||Yt<5)&&(Yt=0),kt=!0),""===A.no_select&&(A.no_select=!0),Tt?"no"===Tt?Tt="":"off"===Tt&&(Tt="",kt=null,A.exclude_browser=!0):Tt="fix",null!==k("nofloat")&&(A.float_browser_disabled=!0),A.start_without_browser&&(Tt=""),A._topname=k("topname");const ln=()=>{let jt;if(Ne||We)jt=A.loadScripts(Ne,We),Ne="",We="";else if(ht)jt=A.loadScripts(ht,"",!0),ht="";else if(Tt)jt=A.createBrowser(Tt),Tt="";else if(null!==kt)jt=A.createStatusLine(Yt,kt),kt=null;else if(Se.length>0)jt=A.openJsonFile(Se.shift());else if(pt.length>0)jt=A.openRootFile(pt.shift());else if(Fe)jt=A.listServerDir(Fe),Fe="";else if(De.length>0)jt=A.expandItem(De.shift());else{if(!($.length>0))return A.refreshHtml().then(()=>A.displayItems(dt,rt)).then(()=>Xe?A.focusOnItem(Xe):A).then(()=>(A.setMonitoring(_t),dt?A.refreshHtml():A));jt=A.applyStyle($.shift())}return jt.then(ln)};let mn=null;if(A.is_online){const jt=v.internals.getCachedHierarchy||(0,v.findFunction)("GetCachedHierarchy");(0,v.isFunc)(jt)&&(mn=jt()),(0,v.isObject)(mn)||(mn=""),"draw"===A.is_online&&!dt.length&&dt.push("")}return null!==mn?A.openOnline(mn).then(()=>(!A.exclude_browser&&!fn&&"_browser"in A.h&&(Tt=A.h._browser,"no"===Tt?Tt="":"off"===Tt&&(Tt="",kt=null,A.exclude_browser=!0)),"_monitoring"in A.h&&!_t&&(_t=A.h._monitoring),"_loadfile"in A.h&&0===pt.length&&(pt=w(A.h._loadfile)),"_drawitem"in A.h&&0===dt.length&&(dt=w(A.h._drawitem),rt=w(A.h._drawopt)),"_layout"in A.h&&!ct&&("draw"!==A.is_online||dt.length>1)&&(A.disp_kind=A.h._layout),"_toptitle"in A.h&&A.exclude_browser&&typeof document<"u"&&(document.title=A.h._toptitle),m&&A.prepareGuiDiv(m.attr("id"),A.disp_kind),ln())):(m&&A.prepareGuiDiv(m.attr("id"),A.disp_kind),ln())})()}prepareGuiDiv(m,I){this.gui_div=(0,v.isStr)(m)?m:m.attr("id"),this.brlayout=new Re.jX(this.gui_div,this),this.brlayout.create(!this.exclude_browser),this.createButtons(),this.setDisplay(I,this.brlayout.drawing_divid())}createButtons(){if(this.exclude_browser)return;const m=this.brlayout?.createBrowserBtns();m&&(Qe.IK.createSVG(m,Qe.IK.diamand,15,"toggle fix-pos browser","browser").style("margin","3px").on("click",()=>this.createBrowser("fix",!0)),this.float_browser_disabled||Qe.IK.createSVG(m,Qe.IK.circle,15,"toggle float browser","browser").style("margin","3px").on("click",()=>this.createBrowser("float",!0)),this.status_disabled||Qe.IK.createSVG(m,Qe.IK.three_circles,15,"toggle status line","browser").style("margin","3px").on("click",()=>this.createStatusLine(0,"toggle")))}hasStatusLine(){return!(this.status_disabled||!this.gui_div||!this.brlayout)&&this.brlayout.hasStatus()}createStatusLine(m,I){var A=this;return(0,be.A)(function*(){return!A.status_disabled&&A.gui_div&&A.brlayout?A.brlayout.createStatusLine(m,I):""})()}redrawObject(m){return!(!this._inspector&&!this._streamer_info)&&(this.h=this._streamer_info?D(m):P(m),this.refreshHtml().then(()=>{this.setTopPainter()}))}createBrowser(m,I){var A=this;return(0,be.A)(function*(){if(!A.gui_div||A.exclude_browser||!A.brlayout)return!1;const R=(0,V.Lt)(`#${A.gui_div} .jsroot_browser`);if(R.empty())return!1;if("float"===m&&A.float_browser_disabled&&(m="fix"),!R.select(".jsroot_browser_area").empty())return I&&A.brlayout.toggleKind(m),!0;let k=`<p class="jsroot_browser_version"><a href="https://root.cern/js/">JSROOT</a> version <span style="color:green"><b>${v.version}</b></span></p>`;if(A.is_online)k+='<p> Hierarchy in <a href="h.json">json</a> and <a href="h.xml">xml</a> format</p><div style="display:inline; vertical-align:middle; white-space: nowrap;"><label style="margin-right:5px"><input type="checkbox" name="monitoring" class="gui_monitoring"/>Monitoring</label>';else if(A.no_select)"file"===A.no_select&&(k+='<div style="display:flex;flex-direction:row">');else{const ve=(0,V.Lt)("#"+A.gui_div),Se=ve.attr("files")||"../files/hsimple.root",De=(0,v.decodeUrl)().get("path")||ve.attr("path")||"",Xe=Se.split(";");k+='<input type="text" value="" style="width:95%; margin:5px;border:2px;" class="gui_urlToLoad" title="input file name"/><div style="display:flex;flex-direction:row;padding-top:5px"><select class="gui_selectFileName" style="flex:1;padding:2px;" title="select file name"<option value="" selected="selected"></option>',Xe.forEach(ct=>{k+=`<option value="${De+ct}">${ct}</option>`}),k+='</select><input type="file" class="gui_localFile" accept=".root" style="display:none"/><output id="list" style="display:none"></output><input type="button" value="..." class="gui_fileBtn" style="min-width:3em;padding:3px;margin-left:5px;margin-right:5px;" title="select local file for reading"/><br/></div><p id="gui_fileCORS"><small><a href="https://github.com/root-project/jsroot/blob/master/docs/JSROOT.md#reading-root-files-from-other-servers">Read docu</a> how to open files from other servers.</small></p><div style="display:flex;flex-direction:row"><input style="padding:3px;margin-right:5px" class="gui_ReadFileBtn" type="button" title="Read the Selected File" value="Load"/><input style="padding:3px;margin-right:5px" class="gui_ResetUIBtn" type="button" title="Close all opened files and clear drawings" value="Reset"/>'}(A.is_online||!A.no_select||"file"===A.no_select)&&(k+='<select style="padding:2px;margin-right:5px;" title="layout kind" class="gui_layout"></select></div>'),k+=`<div id="${A.gui_div}_browser_hierarchy" class="jsroot_browser_hierarchy"></div>`,A.brlayout.setBrowserContent(k),A.brlayout.setBrowserTitle(A.is_online?"ROOT online server":"Read a ROOT file")?.on("contextmenu",ve=>{ve.preventDefault(),(0,Ke.ES)(ve).then(Se=>{A.fillSettingsMenu(Se,!0),Se.show()})}).on("dblclick",()=>{A.createBrowser("float"===A.brlayout?.browser_kind?"fix":"float",!0)}),!A.is_online&&!A.no_select&&(A.readSelectedFile=function(){const ve=R.select(".gui_urlToLoad").property("value").trim();ve&&(ve.toLowerCase().lastIndexOf(".json")===ve.length-5?this.openJsonFile(ve):this.openRootFile(ve))},R.select(".gui_selectFileName").property("value","").on("change",ve=>R.select(".gui_urlToLoad").property("value",ve.target.value)),R.select(".gui_fileBtn").on("click",()=>R.select(".gui_localFile").node().click()),R.select(".gui_ReadFileBtn").on("click",()=>A.readSelectedFile()),R.select(".gui_ResetUIBtn").on("click",()=>A.clearHierarchy(!0)),R.select(".gui_urlToLoad").on("keyup",ve=>{"Enter"===ve.code&&A.readSelectedFile()}),R.select(".gui_localFile").on("change",ve=>{const Se=ve.target.files;for(let De=0;De<Se.length;++De){const Xe=Se[De];R.select(".gui_urlToLoad").property("value",Xe.name),A.openRootFile(Xe)}}));const ge=R.select(".gui_layout");return ge.empty()||(["simple","vert2","vert3","vert231","horiz2","horiz32","flex","tabs","grid 2x2","grid 1x3","grid 2x3","grid 3x3","grid 4x4"].forEach(ve=>ge.append("option").attr("value",ve).html(ve)),ge.on("change",ve=>{const Se=ve.target.value||"flex";A.setDisplay(Se,A.gui_div+"_drawing"),v.settings.DislpayKind=Se})),A.setDom(A.gui_div+"_browser_hierarchy"),I&&(A.refreshHtml(),A.initializeBrowser()),A.brlayout.toggleBrowserKind(m||"fix")})()}initializeBrowser(){const m=(0,V.Lt)(`#${this.gui_div} .jsroot_browser`);if(m.empty()||!this.brlayout)return;this.brlayout.adjustBrowserSize();const I=m.select(".gui_layout").node();if(I){let A=!1;for(const R in I.options){const k=I.options[R].text;if((0,v.isStr)(k)&&(k===this.getLayout()||k.replace(/ /g,"")===this.getLayout())){I.selectedIndex=R,A=!0;break}}if(!A){const R=document.createElement("option");R.innerHTML=R.value=this.getLayout(),I.appendChild(R),I.selectedIndex=I.options.length-1}}if(this.is_online)this.h?._toptitle&&this.brlayout.setBrowserTitle(this.h._toptitle),m.select(".gui_monitoring").property("checked",this.isMonitoring()).on("click",A=>{this.enableMonitoring(A.target.checked),this.updateItems()});else if(!this.no_select){let A="";this.forEachRootFile(R=>{A||(A=R._fullurl)}),m.select(".gui_urlToLoad").property("value",A)}}enableMonitoring(m){this.setMonitoring(void 0,m);const I=(0,V.Lt)(`#${this.gui_div} .jsroot_browser .gui_monitoring`);!I.empty()&&I.property("checked")!==m&&I.property("checked",m)}}function O(z,m){return H.apply(this,arguments)}function H(){return(H=(0,be.A)(function*(z,m){const I=new N("sinfo",z,"__as_dark_mode__");return(0,v.isBatchMode)()?(I.selectDom().property("_json_object_",m),I):(I._streamer_info=!0,I.h=D(m),I.refreshHtml().then(()=>(I.setTopPainter(),I)))})).apply(this,arguments)}function X(z,m,I){return ie.apply(this,arguments)}function ie(){return(ie=(0,be.A)(function*(z,m,I){(0,st.tP)(z);const A=new N("inspector",z,"__as_dark_mode__");if((0,v.isBatchMode)())return A.selectDom().property("_json_object_",m),A;A.default_by_click="expand",A.with_icons=!1,A._inspector=!0;let R=0;return(0,v.isStr)(I)&&0===I.indexOf(v.kInspect)&&(I=I.slice(v.kInspect.length)).length>0&&(R=Number.parseInt(I)),A.selectDom().classed("jsroot_inspector")&&(A.removeInspector=function(){this.selectDom().remove()}),A.fill_context=function(k,ee){const ge=(0,ot.iO)(ee._kind,"nosame");ge.opts&&k.addDrawMenu("nosub:Draw",ge.opts,ve=>{if(!ee?._obj)return;const Se=ee._obj;let De=this.selectDom().node();if((0,v.isFunc)(this.removeInspector)&&(De=De.parentNode,this.removeInspector(),0===ve.indexOf(v.kInspect)))return this.showInspector(ve,Se);(0,st.tP)(De),(0,ot.$2)(De,Se,ve)})},A.h=P(m),A.refreshHtml().then(()=>(A.setTopPainter(),A.exapndToLevel(R)))})).apply(this,arguments)}st.JW.prototype.showInspector=function(z,m){if("check"===z)return!0;const I=this.selectDom(),A=(0,Je.xh)(I),R=Math.round(.05*A.width)+"px",k=Math.round(.05*A.height)+"px",ee="root_inspector_"+v.internals.id_counter++;return I.append("div").attr("id",ee).attr("class","jsroot_inspector").style("position","absolute").style("top",k).style("bottom",k).style("left",R).style("right",R),m?._typename||(m=(0,v.isFunc)(this.getPrimaryObject)?this.getPrimaryObject():this.getObject()),X(ee,m,z)},v.internals.drawInspector=X},5619:(Gr,xt,Te)=>{"use strict";Te.d(xt,{Hb:()=>he,bG:()=>fe,gZ:()=>ot,ho:()=>L,jX:()=>de,kV:()=>Re,o5:()=>re});var be=Te(5774),v=Te(3324),V=Te(4186),Le=Te(165),xe=Te(2481),Je=Te(9646),st=Te(9606);let Ke=null;function ot(){return Ke}function Re(pe){Ke=pe}class Qe extends Le.b8{constructor(ce){super(),this.frameid=ce,"$batch$"!==ce&&(this.setDom(ce),this.selectDom().property("mdi",this)),this.cleanupFrame=xe.tP,this.active_frame_title=""}setInitFrame(ce){this.initFrame=ce,this.forEachFrame(K=>ce(K))}beforeCreateFrame(ce){this.active_frame_title=ce}afterCreateFrame(ce){return(0,V.isFunc)(this.initFrame)&&this.initFrame(ce),ce}forEachFrame(ce,K){console.warn(`forEachFrame not implemented in MDIDisplay ${typeof ce} ${K}`)}forEachPainter(ce,K){this.forEachFrame(G=>{new xe.JW(G).forEachPainter(D=>ce(D,G))},K)}numDraw(){let ce=0;return this.forEachFrame(()=>++ce),ce}findFrame(ce,K){let G=null;return this.forEachFrame(D=>{(0,v.Lt)(D).attr("frame_title")===ce&&(G=D)}),!G&&K&&(G=this.createFrame(ce)),G}activateFrame(ce){this.active_frame_title=ce?(0,v.Lt)(ce).attr("frame_title"):""}getActiveFrame(){return this.findFrame(this.active_frame_title)}checkMDIResize(ce,K){let G=null;this.forEachPainter((D,x)=>{if((!ce||(0,v.Lt)(x).attr("id")===ce)&&null!==D.getItemName()&&(0,V.isFunc)(D.checkResize)){if(G===x)return;D.checkResize(K),G=x}})}cleanup(){this.active_frame_title="",this.forEachFrame(this.cleanupFrame),this.selectDom().html("").property("mdi",null)}}class L extends Qe{constructor(ce,K,G){super(ce),this.framecnt=0,this.getcnt=0,this.groups=[],this.vertical=K&&"v"===K[0],this.use_separarators=!K||K.indexOf("x")<0,this.simple_layout=!1;const D=this.selectDom();if(D.style("overflow","hidden"),"simple"===K)return this.simple_layout=!0,this.use_separarators=!1,void(this.framecnt=1);let P,w,b,x=2;if("projxy"===K)this.vertical=!1,this.use_separarators=!0,P=[2,2],w=[1,3],b=[[3,1],[3,1]],K="",this.match_sizes=!0;else if(0===K.indexOf("grid")||G){K=G?K+"x"+G:K.slice(4).trim(),this.use_separarators=!1,"i"===K[0]&&(this.use_separarators=!0,K=K.slice(1));const g=K.indexOf("x");let C,N;if(g>0?(N=parseInt(K.slice(g+1)),C=parseInt(K.slice(0,g))):C=N=parseInt(K),Number.isInteger(C)||(C=3),Number.isInteger(N)||(N=3),N>1)this.vertical=!0,x=N,C>1&&(P=new Array(x).fill(C));else{if(!(C>1))return this.simple_layout=!0,this.use_separarators=!1,void(this.framecnt=1);this.vertical=!1,x=C}K=""}if(K&&K.indexOf("_")>0){let g=parseInt(K.slice(K.indexOf("_")+1),10);if(Number.isInteger(g)&&g>10)for(K=K.slice(0,K.indexOf("_")),w=[];g>0;)w.unshift(Math.max(g%10,1)),g=Math.round((g-w[0])/10),0===w[0]&&(w[0]=1)}if(K=K?parseInt(K.replace(/^\D+/g,""),10):0,Number.isInteger(K)&&K>1)if(K<10)x=K;else{for(P=[];K>0;)P.unshift(K%10),K=Math.round((K-P[0])/10),0===P[0]&&(P[0]=1);x=P.length}w?.length!==x&&(w=void 0),b?.length!==x&&(b=void 0),this.simple_layout||this.createGroup(this,D,x,P,w,b)}createGroup(ce,K,G,D,x,P){x||(x=new Array(G));let w=0,b=0;for(let g=0;g<G;++g)w+=x[g]||1;for(let g=0;g<G;++g)x[g]=Math.round(100*(x[g]||1)/w),b+=x[g],g===G-1&&(x[g]+=100-b);for(let g=0;g<G;++g){const C={id:g,drawid:-1,position:0,size:x[g],parent:ce};g>0&&(C.position=ce.groups[g-1].position+ce.groups[g-1].size),C.position0=C.position,(!D||!D[g]||D[g]<2)&&(C.drawid=this.framecnt++),ce.groups.push(C);const N=K.append("div").attr("groupid",C.id);ce.match_sizes&&(C.node=N.node()),ce.vertical?N.style("float","bottom").style("height",C.size.toFixed(2)+"%").style("width","100%"):N.style("float","left").style("width",C.size.toFixed(2)+"%").style("height","100%"),C.drawid>=0?(N.classed("jsroot_newgrid",!0),(0,V.isStr)(this.frameid)&&N.attr("id",`${this.frameid}_${C.drawid}`)):N.style("display","flex").style("flex-direction",ce.vertical?"row":"column"),D&&D[g]>1&&(C.vertical=!ce.vertical,C.groups=[],N.style("overflow","hidden"),this.createGroup(C,N,D[g],null,P?P[g]:null))}if(this.use_separarators&&(0,V.isFunc)(this.createSeparator))for(let g=1;g<G;++g)this.createSeparator(ce,K,ce.groups[g])}handleSeparator(ce,K){const G=(X,ie)=>{let z=X?.firstChild;for(;z;){if(z.getAttribute("groupid")===ie)return(0,v.Lt)(z);z=z.nextSibling}return(0,v.Lt)(X).select(`[groupid='${ie}']`)},D=(X,ie,z)=>{const m=X.vertical?"height":"width",I=X.groups[z].size.toFixed(2)+"%";G(ie,z).style(m,I).selectAll(".jsroot_separator").style(m,I)},x=(X,ie)=>{let z=G(X,ie);z.classed("jsroot_newgrid")||(z=z.select(".jsroot_newgrid")),z.each(function(){(0,xe.XR)(this)})},P=(X,ie,z)=>{z.style(X.vertical?"top":"left",`calc(${ie.position.toFixed(2)}% - 2px)`)},w=(0,v.Lt)(ce),b=ce.parentNode,g=w.property("handle"),C=w.property("separator_id"),N=g.groups[C];let O=!1,H=!1;if("start"===K)return N.startpos=N.position,void(N.acc_drag=0);if("end"===K){if(Math.abs(N.startpos-N.position)<.5)return;O=!0}else{let X;"restore"===K?X=N.position0:g.vertical?(N.acc_drag+=K.dy,X=N.startpos+(N.acc_drag+2)/b.clientHeight*100):(N.acc_drag+=K.dx,X=N.startpos+(N.acc_drag+2)/b.clientWidth*100);const ie=N.position-X;if(Math.abs(ie)<.3||Math.min(g.groups[C-1].size-ie,N.size+ie)<3)return;g.groups[C-1].size-=ie,N.size+=ie,N.position=X,P(g,N,w),H=!0,O="restore"===K}if(H&&(D(g,b,C-1),D(g,b,C)),O&&(x(b,C-1),x(b,C)),g.parent?.match_sizes)for(let X=0;X<g.parent.groups.length;++X){const ie=g.parent.groups[X];ie===g||!ie.node||(ie.groups[C].size=g.groups[C].size,ie.groups[C].position=g.groups[C].position,ie.groups[C-1].size=g.groups[C-1].size,ie.groups[C-1].position=g.groups[C-1].position,H&&((0,v.Lt)(ie.node).selectAll(".jsroot_separator").each(function(){const z=(0,v.Lt)(this);z.property("separator_id")===C&&P(ie,ie.groups[C],z)}),D(ie,ie.node,C-1),D(ie,ie.node,C)),O&&(x(ie.node,C-1),x(ie.node,C)))}}createSeparator(ce,K,G){const D=K.append("div");D.classed("jsroot_separator",!0).property("handle",ce).property("separator_id",G.id).attr("style","pointer-events: all; border: 0; margin: 0; padding: 0; position: absolute;").style(ce.vertical?"top":"left",`calc(${G.position.toFixed(2)}% - 2px)`).style(ce.vertical?"width":"height",(ce.size?.toFixed(2)||100)+"%").style(ce.vertical?"height":"width","5px").style("cursor",ce.vertical?"ns-resize":"ew-resize").append("div").attr("style","position: absolute;"+(ce.vertical?"left: 0; right: 0; top: 50%; height: 3px; border-top: 1px dotted #ff0000":"top: 0; bottom: 0; left: 50%; width: 3px; border-left: 1px dotted #ff0000"));const x=this,P=(0,v.$E)().on("start",function(){x.handleSeparator(this,"start")}).on("drag",function(w){x.handleSeparator(this,w)}).on("end",function(){x.handleSeparator(this,"end")});D.call(P).on("dblclick",function(){x.handleSeparator(this,"restore")}),V.browser.touches&&!K.on("touchmove")&&K.on("touchmove",()=>{})}forEachFrame(ce){this.simple_layout?ce(this.getGridFrame()):this.selectDom().selectAll(".jsroot_newgrid").each(function(){ce(this)})}getActiveFrame(){if(this.simple_layout)return this.getGridFrame();let ce=super.getActiveFrame();return ce||(this.forEachFrame(K=>{ce||(ce=K)}),ce)}numGridFrames(){return this.framecnt}getGridFrame(ce){if(this.simple_layout)return this.selectDom("origin").node();let K=null;return this.selectDom().selectAll(".jsroot_newgrid").each(function(){0==ce--&&(K=this)}),K}createFrame(ce){this.beforeCreateFrame(ce);let K=null,G=this.framecnt||2;for(;!K&&G--;)K=this.getGridFrame(this.getcnt),!this.simple_layout&&this.framecnt&&(this.getcnt=(this.getcnt+1)%this.framecnt),(0,v.Lt)(K).classed("jsroot_fixed_frame")&&(K=null);return K&&(this.cleanupFrame(K),(0,v.Lt)(K).attr("frame_title",ce)),this.afterCreateFrame(K)}}class he extends Qe{constructor(ce){super(ce),this.cnt=0,this.selectDom().style("overflow","hidden")}cleanup(){this.selectDom().style("overflow",null),this.cnt=0,super.cleanup()}forEachFrame(ce,K){if((0,V.isFunc)(ce))if(K){const D=this.getActiveFrame();D&&ce(D)}else this.selectDom().select(".jsroot_tabs_main").selectAll(".jsroot_tabs_draw").each(function(){ce(this)})}modifyTabsFrame(ce,K){const G=this.selectDom().select(".jsroot_tabs"),D=G.select(".jsroot_tabs_labels"),x=G.select(".jsroot_tabs_main");let P,w;if(D.selectAll(".jsroot_tabs_label").each(function(){const g=(0,v.Lt)(this).property("frame_id")===ce,C=V.settings.DarkMode?"#333":"white";"activate"===K?(0,v.Lt)(this).style("background",g?C:V.settings.DarkMode?"black":"#ddd").style("color",V.settings.DarkMode?"#ddd":"inherit").style("border-color",C):"close"===K&&g&&this.parentNode.remove()}),x.selectAll(".jsroot_tabs_draw").each(function(){(0,v.Lt)(this).property("frame_id")===ce?P=this:w=this,"activate"===K&&(0,v.Lt)(this).style("background",V.settings.DarkMode?"black":"white")}),P)if("activate"===K)P.parentNode.appendChild(P);else if("close"===K){const b=P===this.getActiveFrame();(0,xe.tP)(P),P.remove(),b&&this.activateFrame(w)}}activateFrame(ce){ce&&this.modifyTabsFrame((0,v.Lt)(ce).property("frame_id"),"activate"),super.activateFrame(ce)}createFrame(ce){this.beforeCreateFrame(ce);const K=this.selectDom();let D,x,G=K.select(".jsroot_tabs");G.empty()?(G=K.append("div").attr("class","jsroot_tabs").attr("style","display: flex; flex-direction: column; position: absolute; overflow: hidden; left: 0px; top: 0px; bottom: 0px; right: 0px;"),D=G.append("div").attr("class","jsroot_tabs_labels").attr("style","white-space: nowrap; position: relative; overflow-x: auto"),x=G.append("div").attr("class","jsroot_tabs_main").attr("style","margin: 0; flex: 1 1 0%; position: relative")):(D=G.select(".jsroot_tabs_labels"),x=G.select(".jsroot_tabs_main"));const P=this.cnt++,w=this;let b=ce;if((!b||!(0,V.isStr)(b))&&(b=`frame_${P}`),b.length>15){let C=b.lastIndexOf("/");C===b.length-1&&(C=b.lastIndexOf("/",C-1)),b=C>0&&b.length-C<20&&b.length-C>1?b.slice(C+1):"..."+b.slice(b.length-17)}D.append("span").attr("tabindex",0).append("label").attr("class","jsroot_tabs_label").attr("style","border: 1px solid; display: inline-block; font-size: 1rem; left: 1px;margin-left: 3px; padding: 0px 5px 1px 5px; position: relative; vertical-align: bottom;").property("frame_id",P).text(b).attr("title",ce).on("click",function(C){C.preventDefault(),w.modifyTabsFrame((0,v.Lt)(this).property("frame_id"),"activate")}).append("button").attr("title","close").attr("style","margin-left: .5em; padding: 0; font-size: 0.5em; width: 1.8em; height: 1.8em; vertical-align: center;").html("&#x2715;").on("click",function(){w.modifyTabsFrame((0,v.Lt)(this.parentNode).property("frame_id"),"close")});const g=x.append("div").attr("frame_title",ce).attr("class","jsroot_tabs_draw").attr("style","overflow: hidden; position: absolute; left: 0px; top: 0px; bottom: 0px; right: 0px;").property("frame_id",P);return this.modifyTabsFrame(P,"activate"),this.afterCreateFrame(g.node())}changeDarkMode(){const ce=this.getActiveFrame();this.modifyTabsFrame((0,v.Lt)(ce).property("frame_id"),"activate")}}class re extends Qe{constructor(ce){super(ce),this.cnt=0,this.selectDom().on("contextmenu",K=>this.showContextMenu(K)).style("overflow","auto")}cleanup(){this.selectDom().style("overflow",null).on("contextmenu",null),this.cnt=0,super.cleanup()}forEachFrame(ce,K){if(!(0,V.isFunc)(ce))return;const G=this;this.selectDom().select(".jsroot_flex_top").selectAll(".jsroot_flex_draw").each(function(){K&&"min"===G.getFrameState(this)||ce(this)})}getActiveFrame(){let ce=super.getActiveFrame();return ce&&"min"!==(0,v.Lt)(ce.parentNode).property("state")||(ce=null,this.forEachFrame(K=>{ce=K},!0)),ce}activateFrame(ce){if("first"===ce||"last"===ce){let G=null;this.forEachFrame(D=>{("last"===ce||!G)&&(G=D)},!0),ce=G}if(!ce||"jsroot_flex_draw"!==ce.getAttribute("class")||this.getActiveFrame()===ce)return;super.activateFrame(ce);const K=ce.parentNode;K.parentNode.append(K),"min"!==this.getFrameState(ce)&&((0,xe.QD)({pp:(0,xe.m6)(ce),active:!0}),(0,xe.XR)(ce))}getFrameState(ce){return(0,v.Lt)(ce.parentNode).property("state")}getFrameRect(ce){if("max"===this.getFrameState(ce)){const x=this.selectDom().select(".jsroot_flex_top");return{x:0,y:0,w:x.node().clientWidth,h:x.node().clientHeight}}const K=(0,v.Lt)(ce.parentNode),G=K.style("left"),D=K.style("top");return{x:parseInt(G.slice(0,G.length-2)),y:parseInt(D.slice(0,D.length-2)),w:K.node().clientWidth,h:K.node().clientHeight}}changeFrameState(ce,K,G){const D=(0,v.Lt)(ce.parentNode),x=D.property("state"),P=this.selectDom().select(".jsroot_flex_top");if(x===K)return!1;switch("normal"===x&&D.property("original_style",D.attr("style")),P.style("overflow",null),K){case"min":D.style("height","auto").style("width","auto"),D.select(".jsroot_flex_draw").style("display","none");break;case"max":D.style("height","100%").style("width","100%").style("left","").style("top",""),D.select(".jsroot_flex_draw").style("display",null),P.style("overflow","hidden");break;default:D.select(".jsroot_flex_draw").style("display",null),D.attr("style",D.property("original_style"))}if(D.select(".jsroot_flex_header").selectAll("button").each(function(w){const b=(0,v.Lt)(this);"minimize"===w.t&&"min"===K||"maximize"===w.t&&"max"===K?b.html("&#x259E;").attr("title","restore"):b.html(w.n).attr("title",w.t)}),D.property("state",K),D.select(".jsroot_flex_resize").style("display","normal"===K?null:"none"),"min"===K){const w=this.getFrameRect(ce),b=this.selectDom().select(".jsroot_flex_top"),g=b.node().clientWidth,C=b.node().clientHeight,N=[],O=4,H=(ie,z)=>ie.x<=z.x&&ie.x+ie.w>=z.x||z.x<=ie.x&&z.x+z.w>=ie.x,X=(ie,z)=>ie.y<=z.y&&ie.y+ie.h>=z.y||z.y<=ie.y&&z.y+z.h>=ie.y;this.forEachFrame(ie=>{ie!==ce&&"min"===this.getFrameState(ie)&&N.push(this.getFrameRect(ie))}),w.y=C;do{w.x=O,w.y-=w.h+O;let ie=O,z=!1;N.forEach(m=>{X(m,w)&&(ie=Math.max(ie,m.x+m.w+O),H(m,w)&&(z=!0))}),z&&(w.x=ie)}while(w.x+w.w>g-O&&w.y>0);w.y<0&&(w.x=O,w.y=C-w.h-O),D.style("left",w.x+"px").style("top",w.y+"px")}else G||(0,xe.XR)(ce);return!0}_clickButton(ce){const K=(0,v.Lt)(ce).datum(),G=(0,v.Lt)(ce.parentNode.parentNode),D=G.select(".jsroot_flex_draw").node();if("close"===K.t)return this.cleanupFrame(D),G.remove(),void this.activateFrame("last");const x=G.property("state");let P;P="maximize"===K.t?"max"===x?"normal":"max":"min"===x?"normal":"min",this.changeFrameState(D,P)&&this.activateFrame("min"!==P?D:"last")}createFrame(ce){this.beforeCreateFrame(ce);const K=this,G=this.selectDom();let D=G.select(".jsroot_flex_top");D.empty()&&(D=G.append("div").attr("class","jsroot_flex_top").attr("style","overflow: auto; position: relative; height: 100%; width: 100%"));const x=D.node().clientWidth,P=D.node().clientHeight,w=D.append("div");w.html(`<div class='jsroot_flex_header' style='height: 23px; overflow: hidden; background-color: lightblue'><p style='margin: 1px; float: left; font-size: 14px; padding-left: 5px'>${ce}</p></div><div id='${this.frameid}_cont${this.cnt}' class='jsroot_flex_draw' style='overflow: hidden; width: 100%; height: calc(100% - 24px); background: white'></div><div class='jsroot_flex_resize' style='position: absolute; right: 3px; bottom: 1px; overflow: hidden; cursor: nwse-resize'>&#x25FF;</div>`),w.attr("class","jsroot_flex_frame").style("position","absolute").style("left",Math.round(x*(this.cnt%5)/10)+"px").style("top",Math.round(P*(this.cnt%5)/10)+"px").style("width",Math.round(.58*x)+"px").style("height",Math.round(.58*P)+"px").style("border","1px solid black").style("box-shadow","1px 1px 2px 2px #aaa").property("state","normal").select(".jsroot_flex_header").on("click",function(){K.activateFrame((0,v.Lt)(this.parentNode).select(".jsroot_flex_draw").node())}).selectAll("button").data([{n:"&#x2715;",t:"close"},{n:"&#x2594;",t:"maximize"},{n:"&#x2581;",t:"minimize"}]).enter().append("button").attr("type","button").attr("style","float: right; padding: 0; width: 1.4em; text-align: center; font-size: 10px; margin-top: 2px; margin-right: 4px").attr("title",X=>X.t).html(X=>X.n).on("click",function(){K._clickButton(this)});let b=null,g=null,C=!1,N=[];const O=(0,v.$E)().subject(Object);O.on("start",function(X){if("button"===X.sourceEvent.target.type)return K._clickButton(X.sourceEvent.target);if((0,st.iE)(X.sourceEvent))return;const ie=(0,v.Lt)(this.parentNode);!ie.classed("jsroot_flex_frame")||"max"===ie.property("state")||(C=!(0,v.Lt)(this).classed("jsroot_flex_resize"),(C||"min"!==ie.property("state"))&&(K.activateFrame(ie.select(".jsroot_flex_draw").node()),g=D.append("div").attr("style",ie.attr("style")).style("border","2px dotted #00F"),"min"===ie.property("state")&&g.style("width",ie.node().clientWidth+"px").style("height",ie.node().clientHeight+"px"),X.sourceEvent.preventDefault(),X.sourceEvent.stopPropagation(),b=ie,N=[]))}).on("drag",function(X){if(!g)return;X.sourceEvent.preventDefault(),X.sourceEvent.stopPropagation();const ie=(z,m,I)=>{if(z>=N.length){const A=g.style(m);N[z]=parseInt(A.slice(0,A.length-2))}N[z]+=I,g.style(m,Math.max(0,N[z])+"px")};C?(ie(0,"left",X.dx),ie(1,"top",X.dy)):(ie(0,"width",X.dx),ie(1,"height",X.dy))}).on("end",function(X){g&&(X.sourceEvent.preventDefault(),X.sourceEvent.stopPropagation(),C?(b.style("left",g.style("left")),b.style("top",g.style("top"))):(b.style("width",g.style("width")),b.style("height",g.style("height"))),g.remove(),g=null,C||(0,xe.XR)(b.select(".jsroot_flex_draw").node()))}),w.select(".jsroot_flex_header").call(O),w.select(".jsroot_flex_resize").call(O);const H=w.select(".jsroot_flex_draw").attr("frame_title",ce).property("frame_cnt",this.cnt++).node();return this.afterCreateFrame(H)}minimizeAll(){this.forEachFrame(ce=>this.changeFrameState(ce,"min"))}showAll(){this.forEachFrame(ce=>{"min"===this.getFrameState(ce)&&this.changeFrameState(ce,"normal")})}closeAllFrames(){const ce=[];this.forEachFrame(K=>ce.push(K)),ce.forEach(K=>{this.cleanupFrame(K),(0,v.Lt)(K.parentNode).remove()})}sortFrames(ce){const K=[];if(this.forEachFrame(C=>{const N=this.getFrameState(C);"min"!==N&&("max"===N&&this.changeFrameState(C,"normal",!0),K.push(C))}),0===K.length)return;const G=this.selectDom(),D=G.node().clientWidth,x=G.node().clientHeight,P=Math.min(40,Math.round(.4*D/K.length)),w=Math.min(40,Math.round(.4*x/K.length));let b=Math.ceil(Math.sqrt(K.length)),g=b;b>1&&b*(b-1)>=K.length&&(D>x?g--:b--),K.forEach((C,N)=>{const O=(0,v.Lt)(C.parentNode);"cascade"===ce?O.style("left",N*P+"px").style("top",N*w+"px").style("width",Math.round(.58*D)+"px").style("height",Math.round(.58*x)+"px"):O.style("left",Math.round(D/b*(N%b))+"px").style("top",Math.round(x/g*((N-N%b)/b))+"px").style("width",Math.round(D/b-4)+"px").style("height",Math.round(x/g-4)+"px"),(0,xe.XR)(C)})}showContextMenu(ce){if("jsroot_flex_top"!==ce.target.getAttribute("class")||0===this.numDraw())return;ce.preventDefault();const K=[];let G=0;this.forEachFrame(x=>{K.push(x),"min"===this.getFrameState(x)&&G++});const D=this.getActiveFrame();K.sort((x,P)=>(0,v.Lt)(x).property("frame_cnt")<(0,v.Lt)(P).property("frame_cnt")?-1:1),(0,Je.ES)(ce,this).then(x=>{x.add("header:Flex"),x.add("Cascade",()=>this.sortFrames("cascade"),"Cascade frames"),x.add("Tile",()=>this.sortFrames("tile"),"Tile all frames"),G<K.length&&x.add("Minimize all",()=>this.minimizeAll(),"Minimize all frames"),G>0&&x.add("Show all",()=>this.showAll(),"Restore minimized frames"),x.add("Close all",()=>this.closeAllFrames()),x.add("separator"),K.forEach((P,w)=>x.addchk(P===D,("min"===this.getFrameState(P)?"[min] ":"")+(0,v.Lt)(P).attr("frame_title"),w,b=>{const g=K[b];"min"===this.getFrameState(g)&&this.changeFrameState(g,"normal"),this.activateFrame(g)})),x.show()})}}class fe extends Qe{constructor(ce,K,G){super("$batch$"),this.frames=[],this.width=ce||1200,this.height=K||800,this.jsdom_body=G||(0,v.Lt)("body")}forEachFrame(ce){this.frames.forEach(ce)}createFrame(ce){this.beforeCreateFrame(ce);const K=this.jsdom_body.append("div").style("visible","hidden").attr("width",this.width).attr("height",this.height).style("width",this.width+"px").style("height",this.height+"px").attr("id","jsroot_batch_"+this.frames.length).attr("frame_title",ce);return this.frames.push(K.node()),this.afterCreateFrame(K.node())}numFrames(){return this.frames.length}makeJSON(ce,K){const G=this.frames[ce];if(!G)return;const D=(0,v.Lt)(G).property("_json_object_");return D?((0,v.Lt)(G).property("_json_object_",null),(0,xe.tP)(G),(0,v.Lt)(G).remove(),(0,V.toJSON)(D,K)):void 0}makeSVG(ce){const K=this.frames[ce];if(!K)return;const G=(0,v.Lt)(K);function D(){const P=(0,v.Lt)(this);"none"===P.style("display")&&P.remove()}G.select("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("width",this.width).attr("height",this.height).attr("title",null).attr("style",null).attr("class",null).attr("x",null).attr("y",null),G.selectAll("g.root_frame").each(D),G.selectAll("svg").each(D);const x=(0,Le.NM)(G.html());return(0,xe.tP)(K),G.remove(),x}}class de{constructor(ce,K,G){this.gui_div=ce,this.hpainter=K,this.objpainter=G,this.browser_kind=null}main(){return(0,v.Lt)("#"+this.gui_div)}browser(){return this.main().select(".jsroot_browser")}drawing(){return(0,v.Lt)(`#${this.gui_div}_drawing`)}status(){return(0,v.Lt)(`#${this.gui_div}_status`)}drawing_divid(){return this.gui_div+"_drawing"}checkResize(){(0,V.isFunc)(this.hpainter?.checkResize)?this.hpainter.checkResize():(0,V.isFunc)(this.objpainter?.checkResize)&&this.objpainter.checkResize(!0)}createStyle(){const ce=V.settings.DarkMode?"black":"#E6E6FA",G=V.settings.DarkMode?"#ddd":"inherit",D=V.settings.DarkMode?`background-color: #222; color: ${G}`:"";(0,st.fz)(`.jsroot_browser { pointer-events: none; position: absolute; left: 0px; top: 0px; bottom: 0px; right: 0px; margin: 0px; border: 0px; overflow: hidden; }.jsroot_draw_area { background-color: ${ce}; overflow: hidden; margin: 0px; border: 0px; }.jsroot_browser_area { color: ${G}; background-color: ${ce}; font-size: 12px; font-family: Verdana; pointer-events: all; box-sizing: initial; }.jsroot_browser_area input { ${D} }.jsroot_browser_area select { ${D} }.jsroot_browser_title { font-family: Verdana; font-size: 20px; color: ${V.settings.DarkMode?"#ccc":"inherit"}; }.jsroot_browser_btns { pointer-events: all; display: flex; flex-direction: column; }.jsroot_browser_area p { margin-top: 5px; margin-bottom: 5px; white-space: nowrap; }.jsroot_browser_hierarchy { flex: 1; margin-top: 2px; }.jsroot_status_area { background-color: ${ce}; overflow: hidden; font-size: 12px; font-family: Verdana; pointer-events: all; }.jsroot_browser_resize { position: absolute; right: 3px; bottom: 3px; margin-bottom: 0px; margin-right: 0px; opacity: 0.5; cursor: se-resize; z-index: 1; }`,this.main().node(),"browser_layout_style")}create(ce){const K=this.main();K.append("div").attr("id",this.drawing_divid()).classed("jsroot_draw_area",!0).style("position","absolute").style("left",0).style("top",0).style("bottom",0).style("right",0),ce&&K.append("div").classed("jsroot_browser",!0),this.createStyle()}createBrowserBtns(){const ce=this.browser();if(ce.empty())return;let K=ce.select(".jsroot_browser_btns");return K.empty()?K=ce.append("div").attr("class","jsroot jsroot_browser_btns").attr("style","position: absolute; left: 7px; top: 7px"):K.html(""),K}removeBrowserBtns(){this.browser().select(".jsroot_browser_btns").remove()}setBrowserContent(ce){const K=this.browser();K.empty()||K.insert("div",".jsroot_browser_btns").classed("jsroot_browser_area",!0).style("position","absolute").style("left","0px").style("top","0px").style("bottom","0px").style("width","250px").style("overflow","hidden").style("padding-left","5px").style("display","flex").style("flex-direction","column").html(`<p class='jsroot_browser_title'>title</p><div class='jsroot_browser_resize' style='display:none'>&#9727</div>${ce}`)}hasContent(){const ce=this.browser();return!ce.empty()&&!ce.select(".jsroot_browser_area").empty()}deleteContent(ce){const K=this.browser();K.empty()||(ce||this.createStatusLine(0,"delete"),this.toggleBrowserVisisbility(!0),ce?(K.select(".jsroot_browser_area").remove(),K.select(".jsroot_browser_btns").remove(),K.select(".jsroot_v_separator").remove()):K.selectAll("*").remove(),delete this.browser_visible,delete this.browser_kind,this.checkResize())}hasStatus(){return!this.browser().empty()&&!this.status().empty()}setBrowserTitle(ce){const K=this.browser(),G=K.empty()?null:K.select(".jsroot_browser_title");return G&&G.text(ce).style("cursor","flex"===this.browser_kind?"move":null),G}toggleKind(ce){"changing"!==this.browser_visible&&(ce===this.browser_kind?this.toggleBrowserVisisbility():this.toggleBrowserKind(ce))}createStatusLine(ce,K){var G=this;return(0,be.A)(function*(){const D=G.browser();if(D.empty())return"";const x=G.gui_div+"_status",P=(0,v.Lt)("#"+x),w=!P.empty();if("toggle"===K?K=!w:"delete"===K?(K=!1,ce=0,delete G.status_layout):void 0===K&&(K=!0,G.status_layout="app"),w)return!0===K?x:(D.select(".jsroot_h_separator").remove(),P.remove(),"app"!==G.status_layout&&delete G.status_layout,G.status_handler&&V.internals.showStatus===G.status_handler&&(delete V.internals.showStatus,delete G.status_handler),G.adjustSeparators(null,0,!0),"");if(!1===K)return"";const b=G.drawing().style("left");D.insert("div",".jsroot_browser_area").attr("id",x).classed("jsroot_status_area",!0).style("position","absolute").style("left",b).style("height","20px").style("bottom","0px").style("right","0px").style("margin",0).style("border",0);const g=V.settings.DarkMode?"grey":"azure",C=D.insert("div",".jsroot_browser_area").classed("jsroot_h_separator",!0).attr("style",`pointer-events: all; border: 0; margin: 0; padding: 0; background-color: ${g}; position: absolute; left: ${b}; right: 0; bottom: 20px; height: 5px; cursor: ns-resize;`),N=(0,v.$E)().on("start",()=>{G._hsepar_move=G._hsepar_position,C.style("background-color","grey")}).on("drag",H=>{G._hsepar_move-=H.dy,G.adjustSeparators(null,Math.max(5,Math.round(G._hsepar_move)))}).on("end",()=>{delete G._hsepar_move,C.style("background-color",null),G.checkResize()});if(C.call(N),V.browser.touches&&!D.on("touchmove")&&D.on("touchmove",()=>{}),(!ce||(0,V.isStr)(ce))&&(ce=G.last_hsepar_height||20),G.adjustSeparators(null,ce,!0),"app"===G.status_layout)return x;G.status_layout=new L(x,"horizx4_1213");const O=["object name","object title","mouse coordinates","object info"];for(let H=0;H<4;++H)(0,v.Lt)(G.status_layout.getGridFrame(H)).attr("title",O[H]).style("overflow","hidden").append("label").attr("style","margin: 3px; margin-left: 5px; font-size: 14px; vertical-align: middle; white-space: nowrap;");return V.internals.showStatus=G.status_handler=G.showStatus.bind(G),x})()}adjustSeparators(ce,K,G,D){if(!this.gui_div)return;const x=this.browser();if(null===K&&D&&!x.select(".jsroot_h_separator").empty()&&(K=x.select(".jsroot_h_separator").style("bottom"),K=(0,V.isStr)(K)&&K.length>2&&K.indexOf("px")===K.length-2?K.slice(0,K.length-2):null),null!==K){K=parseInt(K);const w=x.select(".jsroot_h_separator");let b=0;if(!w.empty()){K<5&&(K=5);const g=x.node().clientHeight-5;g>0&&(K<0&&(K+=g),K>g&&(K=g)),this.last_hsepar_height=K,w.style("bottom",K+"px").style("height","5px"),this.status().style("height",K+"px"),b=K+5}this._hsepar_position=K,this.drawing().style("bottom",`${b}px`)}null!==ce&&(ce=Math.max(50,Number.parseInt(ce)),this._vsepar_position=ce,x.select(".jsroot_browser_area").style("width",ce-5+"px"),this.drawing().style("left",ce+5+"px"),x.select(".jsroot_h_separator").style("left",ce+5+"px"),this.status().style("left",ce+5+"px"),x.select(".jsroot_v_separator").style("left",ce+"px").style("width","5px")),G&&this.checkResize()}showStatus(...ce){if(!(0,V.isObject)(this.status_layout)||!(0,V.isFunc)(this.status_layout.getGridFrame))return;let K=0;for(let G=0;G<4;++G){const D=this.status_layout.getGridFrame(G).querySelector("label");K=Math.max(K,D.clientHeight),D.innerHTML=ce[G]||""}this.status_layout.first_check||(this.status_layout.first_check=!0,K>5&&(K>this.last_hsepar_height||K<this.last_hsepar_height+5)&&this.adjustSeparators(null,K,!0))}toggleBrowserVisisbility(ce){if(!this.gui_div||(0,V.isStr)(this.browser_visible))return;const K=this.browser(),G=K.select(".jsroot_browser_area");if(G.empty())return;const D=K.select(".jsroot_v_separator"),x=(0,v.Lt)(`#${this.gui_div}_drawing`);let P=G.property("last_left"),w=G.property("last_vsepar"),b=G.property("last_drawing");if(this.browser_visible){G.property("last_left",G.style("left")),D.empty()||(G.property("last_vsepar",D.style("left")),G.property("last_drawing",x.style("left"))),P=-G.node().clientWidth-10+"px";const N=K.node().clientWidth;D.empty()&&G.node().offsetLeft>N/2&&(P=N+10+"px"),w="-10px",b="0px"}else{if(ce)return;G.property("last_left",null).property("last_vsepar",null).property("last_drawing",null)}const g=!this.browser_visible,C=ce?0:700;this.browser_visible="changing",G.transition().style("left",P).duration(C).on("end",()=>{ce||(this.browser_visible=g,g&&this.setButtonsPosition())}),g||K.select(".jsroot_browser_btns").transition().style("left","7px").style("top","7px").duration(C),D.empty()||(D.transition().style("left",w).duration(C),x.transition().style("left",b).duration(C).on("end",this.checkResize.bind(this))),this.status_layout&&"fix"===this.browser_kind&&(K.select(".jsroot_h_separator").transition().style("left",b).duration(C),K.select(".jsroot_status_area").transition().style("left",b).duration(C))}adjustBrowserSize(ce){if(!this.gui_div||"float"!==this.browser_kind)return;const K=this.browser();if(K.empty())return;const G=K.select(".jsroot_browser_area"),D=K.select(".jsroot_browser_hierarchy"),x=(0,v.Lt)(D.node().firstChild);if(ce)return void(G.node().parentNode.clientHeight-10<G.node().clientHeight&&G.style("bottom","0px").style("top","0px"));if(x.empty())return;const P=D.node().clientHeight,w=x.node().clientHeight;void 0!==w&&w<.7*P&&G.style("bottom","")}setButtonsPosition(){if(!this.gui_div)return;const ce=this.browser(),K=ce.select(".jsroot_browser_btns");if(K.empty())return;let G=7,D=7;if(this.browser_visible){const x=ce.select(".jsroot_browser_area");G=x.node().offsetTop+7,D=x.node().offsetLeft-ce.node().offsetLeft+x.node().clientWidth-27}K.style("left",`${D}px`).style("top",`${G}px`)}toggleBrowserKind(ce){var K=this;return(0,be.A)(function*(){if(!K.gui_div)return null;if(!ce){if(!K.browser_kind)return null;ce="float"===K.browser_kind?"fix":"float"}const G=K.browser(),D=G.select(".jsroot_browser_area");if("float"===K.browser_kind?D.style("bottom","0px").style("top","0px").style("width","").style("height","").classed("jsroot_float_browser",!1).style("border",null):"fix"===K.browser_kind&&(G.select(".jsroot_v_separator").remove(),D.style("left","0px"),K.drawing().style("left","0px"),G.select(".jsroot_h_separator").style("left","0px"),K.status().style("left","0px"),K.checkResize()),K.browser_kind=ce,K.browser_visible=!0,G.select(".jsroot_browser_resize").style("display","float"===ce?null:"none"),G.select(".jsroot_browser_title").style("cursor","float"===ce?"move":null),"float"===ce){D.style("bottom","40px").classed("jsroot_float_browser",!0).style("border","solid 3px white");const x=(0,v.$E)().on("start",()=>{const w=D.style("left"),b=D.style("top");K._float_left=parseInt(w.slice(0,w.length-2)),K._float_top=parseInt(b.slice(0,b.length-2)),K._max_left=Math.max(0,G.node().clientWidth-D.node().offsetWidth-1),K._max_top=Math.max(0,G.node().clientHeight-D.node().offsetHeight-1)}).filter(w=>G.select(".jsroot_browser_title").node()===w.target).on("drag",w=>{K._float_left+=w.dx,K._float_top+=w.dy,D.style("left",Math.min(Math.max(0,K._float_left),K._max_left)+"px").style("top",Math.min(Math.max(0,K._float_top),K._max_top)+"px"),K.setButtonsPosition()}),P=(0,v.$E)().on("start",()=>{const w=D.style("width");K._float_width=parseInt(w.slice(0,w.length-2)),K._float_height=D.node().clientHeight,K._max_width=G.node().clientWidth-D.node().offsetLeft-1,K._max_height=G.node().clientHeight-D.node().offsetTop-1}).on("drag",w=>{K._float_width+=w.dx,K._float_height+=w.dy,D.style("width",Math.min(Math.max(100,K._float_width),K._max_width)+"px").style("height",Math.min(Math.max(100,K._float_height),K._max_height)+"px"),K.setButtonsPosition()});G.call(x),G.select(".jsroot_browser_resize").call(P),K.adjustBrowserSize()}else{D.style("left","0px").style("top","0px").style("bottom","0px").style("height",null);const x=V.settings.DarkMode?"grey":"azure",P=G.append("div").classed("jsroot_v_separator",!0).attr("style",`pointer-events: all; border: 0; margin: 0; padding: 0; background-color: ${x}; position: absolute; top: 0; bottom: 0; cursor: ew-resize;`),w=(0,v.$E)().on("start",()=>{K._vsepar_move=K._vsepar_position,P.style("background-color","grey")}).on("drag",b=>{K._vsepar_move+=b.dx,K.setButtonsPosition(),V.settings.BrowserWidth=Math.max(50,Math.round(K._vsepar_move)),K.adjustSeparators(V.settings.BrowserWidth,null)}).on("end",()=>{delete K._vsepar_move,P.style("background-color",null),K.checkResize()});P.call(w),V.browser.touches&&!G.on("touchmove")&&G.on("touchmove",()=>{}),K.adjustSeparators(V.settings.BrowserWidth,null,!0,!0)}return K.setButtonsPosition(),K})()}}},9646:(Gr,xt,Te)=>{"use strict";Te.d(xt,{ES:()=>Ie,Ew:()=>ot,IV:()=>L,as:()=>he,sj:()=>re,wh:()=>fe});var be=Te(5774),v=Te(4186),V=Te(3324),Le=Te(9606),xe=Te(139),Je=Te(7952),st=Te(9248),Ke=Te(5460);const ot="__front__";class Re{constructor(pe,ce,K){this.painter=pe,this.menuname=ce,(0,v.isObject)(K)&&void 0!==K.clientX&&void 0!==K.clientY&&(this.show_evnt={clientX:K.clientX,clientY:K.clientY,skip_close:K.skip_close}),this.remove_handler=()=>this.remove(),this.element=null,this.cnt=0}native(){return!1}load(){var pe=this;return(0,be.A)(function*(){return pe})()}getEventPosition(){return this.show_evnt}add(){throw Error("add() method has to be implemented in the menu")}size(){return this.cnt}remove(){if(this.element){if(this.show_evnt?.skip_close)return void(this.show_evnt.skip_close=0);if(this.element.remove(),this.element=null,(0,v.isFunc)(this.resolveFunc)){const pe=this.resolveFunc;delete this.resolveFunc,pe()}document.body.removeEventListener("click",this.remove_handler)}}show(){throw Error("show() method has to be implemented in the menu class")}addchk(pe,ce,K,G,D){let x=G;(0,v.isFunc)(K)&&(D=G,G=K,x=P=>G("1"===P),K=pe?"0":"1"),this.add((pe?"chk:":"unk:")+ce,K,x,D)}addDrawMenu(pe,ce,K,G){if(!ce||!ce.length)return;let D=!1;if(0===pe.indexOf("nosub:")&&(D=!0,pe=pe.slice(6)),1===ce.length)return ce[0]===v.kInspect&&(pe=pe.replace("Draw","Inspect")),void this.add(pe,ce[0],K);D||this.add("sub:"+pe,ce[0],K,G);for(let x=1;x<ce.length;++x){let P=ce[x]||(this._use_plain_text?"<dflt>":"&lt;dflt&gt;"),w=x+1;if(ce.length>5)for(;w<ce.length&&0===ce[w].indexOf(P);)w++;if(D&&(P=pe+" "+P),w>=x+2){this.add("sub:"+P,ce[x],K);for(let b=x+1;b<w;++b)this.add(ce[b],ce[b],K);this.add("endsub:"),x=w-1}else if(P===v.kInspect){this.add("sub:"+P,ce[x],K,"Inspect object content");for(let b=0;b<10;++b)this.add(b.toString(),v.kInspect+b,K,`Inspect object and expand to level ${b}`);this.add("endsub:")}else this.add(P,ce[x],K)}D||(this.add("<input>",()=>{const x=(0,v.isFunc)(this.painter?.getDrawOpt)?this.painter.getDrawOpt():ce[0];this.input("Provide draw option",x,"text").then(K)},"Enter draw option in dialog"),this.add("endsub:"))}addColorMenu(pe,ce,K,G){if(void 0===ce)return;const D=!(0,v.isStr)(ce);this.add("sub:"+pe,()=>{this.input("Enter color "+(D?"(only id number)":"(name or id)"),ce,D?"int":"text",D?0:void 0,D?9999:void 0).then(x=>{const P=parseInt(x);if(Number.isInteger(P)&&(0,xe.oU)(P))x=(0,xe.oU)(P);else if(D)return;K(D?P:x)})});for(let x=0;x<5;++x){this.add("column:");for(let P=0;P<10;P++){let w=10*x+P;D||--w;let b=w<0?"none":(0,xe.oU)(w);0===w&&1===G&&(b="none"),this.add(`<svg width="50" height="18" style="margin:0px;background-color:${b}">${ce===(D?w:b)?`<rect width="50" height="18" style="fill:none;stroke-width:3px;stroke:${1===w?"red":"black"}"></rect>`:""}<text x="4" y="12" style='font-size:12px' fill="${1===w?"white":"black"}">${w<=0||"#"!==b[0]?b:`col ${w}`}</text></svg>`,D?w:b,X=>K(D?parseInt(X):X),"Select color "+b)}if(this.add("endcolumn:"),!this.native())break}this.add("endsub:")}addSizeMenu(pe,ce,K,G,D,x,P){if(void 0===D)return;let w=[],b=!1;if((0,v.isObject)(G))w=G,G=1;else for(let N=ce;N<=K;N+=G)w.push(N);const g=N=>Math.abs(N-D)<1e-5*(K-ce),C=(N,O)=>(N===D&&b&&(O=!0),N.toFixed(G>=1?0:G>=.1?O?2:1:O?4:2));w.findIndex(g)<0&&(b=!0,w.push(D),w=w.sort((N,O)=>N>O)),this.add("sub:"+pe,()=>this.input("Enter value of "+pe,C(D,!0),G>=1?"int":"float").then(x),P),w.forEach(N=>this.addchk(g(N),C(N),N,O=>x(G>=1?Number.parseInt(O):Number.parseFloat(O)))),this.add("endsub:")}addPaletteMenu(pe,ce){const K=(G,D,x,P)=>{D?x||(x=D):D=`pal ${G}`,x&&(x+=`, code ${G}`),this.addchk(G===pe||P,"<nobr>"+D+"</nobr>",G,ce,x||D)};if(this.add("sub:Palette",()=>this.input("Enter palette code [1..113]",pe,"int",1,113).then(ce)),this.add("column:"),K(57,"Bird","Default color palette",pe>113),K(55,"Rainbow"),K(51,"Deep Sea"),K(52,"Grayscale","New gray scale"),K(1,"","Old gray scale",pe>0&&pe<10),K(50,"ROOT 5","Default color palette in ROOT 5",pe>=10&&pe<51),K(53,"","Dark body radiator"),K(54,"","Two-color hue"),K(56,"","Inverted dark body radiator"),K(58,"Cubehelix"),K(59,"","Green Red Violet"),K(60,"","Blue Red Yellow"),K(61,"Ocean"),this.add("endcolumn:"),!this.native())return this.add("endsub:");this.add("column:"),K(62,"","Color Printable On Grey"),K(63,"Alpine"),K(64,"Aquamarine"),K(65,"Army"),K(66,"Atlantic"),K(67,"Aurora"),K(68,"Avocado"),K(69,"Beach"),K(70,"Black Body"),K(71,"","Blue Green Yellow"),K(72,"Brown Cyan"),K(73,"CMYK"),K(74,"Candy"),this.add("endcolumn:"),this.add("column:"),K(75,"Cherry"),K(76,"Coffee"),K(77,"","Dark Rain Bow"),K(78,"","Dark Terrain"),K(79,"Fall"),K(80,"Fruit Punch"),K(81,"Fuchsia"),K(82,"Grey Yellow"),K(83,"","Green Brown Terrain"),K(84,"Green Pink"),K(85,"Island"),K(86,"Lake"),K(87,"","Light Temperature"),this.add("endcolumn:"),this.add("column:"),K(88,"","Light Terrain"),K(89,"Mint"),K(90,"Neon"),K(91,"Pastel"),K(92,"Pearl"),K(93,"Pigeon"),K(94,"Plum"),K(95,"Red Blue"),K(96,"Rose"),K(97,"Rust"),K(98,"","Sandy Terrain"),K(99,"Sienna"),K(100,"Solar"),this.add("endcolumn:"),this.add("column:"),K(101,"","South West"),K(102,"","Starry Night"),K(103,"","Sunset"),K(104,"","Temperature Map"),K(105,"","Thermometer"),K(106,"Valentine"),K(107,"","Visible Spectrum"),K(108,"","Water Melon"),K(109,"Cool"),K(110,"Copper"),K(111,"","Gist Earth"),K(112,"Viridis"),K(113,"Cividis"),this.add("endcolumn:"),this.add("endsub:")}addRebinMenu(pe){this.add("sub:Rebin",()=>this.input("Enter rebin value",2,"int",2).then(pe));for(let ce=2;ce<=7;ce++)this.add(ce.toString(),ce,K=>pe(parseInt(K)));this.add("endsub:")}addSelectMenu(pe,ce,K,G){const D="number"==typeof K;this.add("sub:"+pe);for(let x=0;x<ce.length;++x)this.addchk(D?x===K:ce[x]===K,ce[x],D?x:ce[x],P=>G(D?Number.parseInt(P):P));this.add("endsub:")}addRColorMenu(pe,ce,K){const G=["default","black","white","red","green","blue","yellow","magenta","cyan"];this.add("sub:"+pe,()=>{this.input("Enter color name - empty string will reset color",ce).then(K)});let D="black";for(let x=0;x<G.length;++x){const P=G[x];let w=!1,b="";x>0?(b="background-color:"+P,D="white"===P?"black":"white",(0,v.isStr)(ce)&&ce&&"auto"!==ce&&"["!==ce[0]&&(w=(0,V.Qh)(ce).toString()===(0,V.Qh)(P).toString())):w=!ce,this.addchk(w,`<svg width='100' height='18' style='margin:0px;${b}'><text x='4' y='12' style='font-size:12px' fill='${D}'>${P}</text></svg>`,P,C=>K("default"===C?null:C))}this.add("endsub:")}addRAttrTextItems(pe,ce,K){ce||(ce={}),this.addRColorMenu("color",pe.color,G=>K({name:"color",value:G})),pe.scaled?this.addSizeMenu("size",.01,.1,.01,pe.size/pe.scale,G=>K({name:"size",value:G})):this.addSizeMenu("size",6,20,2,pe.size,G=>K({name:"size",value:G})),this.addSelectMenu("family",["Arial","Times New Roman","Courier New","Symbol"],pe.name,G=>K({name:"font_family",value:G})),this.addSelectMenu("style",["normal","italic","oblique"],pe.style||"normal",G=>K({name:"font_style",value:"normal"===G?null:G})),this.addSelectMenu("weight",["normal","lighter","bold","bolder"],pe.weight||"normal",G=>K({name:"font_weight",value:"normal"===G?null:G})),ce.noalign||this.add("align"),ce.noangle||this.add("angle")}addLineStyleMenu(pe,ce,K){this.add("sub:"+pe,()=>this.input("Enter line style id (1-solid)",ce,"int",1,11).then(G=>{(0,st.Ov)(G)&&K(G)}));for(let G=1;G<11;++G){const D=(0,st.Ov)(G);this.addchk(ce===G,`<svg width='100' height='14'><text x='2' y='13' style='font-size:12px'>${G}</text><line x1='30' y1='7' x2='100' y2='7' stroke='black' stroke-width='3' stroke-dasharray='${D}'></line></svg>`,G,P=>K(parseInt(P)))}this.add("endsub:")}addFillStyleMenu(pe,ce,K,G,D){this.add("sub:"+pe,()=>{this.input("Enter fill style id (1001-solid, 3000..3010)",ce,"int",0,4e3).then(P=>{P>=0&&P<=4e3&&D(P)})});const x=[1,1001,3001,3002,3003,3004,3005,3006,3007,3010,3021,3022];for(let P=0;P<x.length;++P){let w=x[P];if(G){const b=G.createAttFill({std:!1,pattern:x[P],color:K||1});w=`<svg width='100' height='18'><text x='1' y='12' style='font-size:12px'>${x[P].toString()}</text><rect x='40' y='0' width='60' height='18' stroke='none' fill='${b.getFillColor()}'></rect></svg>`}this.addchk(ce===x[P],w,x[P],b=>D(parseInt(b)))}this.add("endsub:")}addFontMenu(pe,ce,K){const G=ce&&Number.isInteger(ce)?ce%10:2;this.add("sub:"+pe,()=>{this.input("Enter font id from [0..20]",Math.floor(ce/10),"int",0,20).then(x=>{x>=0&&x<=20&&K(10*x+G)})}),this.add("column:");const D=(0,v.getDocument)();for(let x=1;x<20;++x){const P=10*x+G,w=new Ke.qg(P,14),b=(0,V.Lt)(D.createElementNS("http://www.w3.org/2000/svg","text"));let g=w.getFontName(),C="";w.weight&&(C+="b",g+=" "+w.weight),w.style&&(C+=w.style[0],g+=" "+w.style),C&&(C=" "+C),b.attr("x",1).attr("y",15).text(g.split(" ")[0]+C),w.setFont(b);const N=ce!==P?"":"<rect width='90' height='18' style='fill:none;stroke:black'></rect>",O=`<svg width='90' height='18'>${b.node().outerHTML}${N}</svg>`;this.add(O,P,H=>K(parseInt(H)),`${P}: ${g}`),10===x&&(this.add("endcolumn:"),this.add("column:"))}this.add("endcolumn:"),this.add("endsub:")}addAlignMenu(pe,ce,K){this.add(`sub:${pe}`,()=>{this.input("Enter align like 12 or 31",ce).then(x=>{const P=parseInt(x);if(P<11||P>33)return;const w=Math.floor(P/10),b=P%10;w>0&&w<4&&b>0&&b<4&&K(P)})});const G=["left","middle","right"],D=["bottom","centered","top"];for(let x=1;x<4;++x)for(let P=1;P<4;++P)this.addchk(10*x+P===ce,`${10*x+P}: ${G[x-1]} ${D[P-1]}`,10*x+P,w=>K(parseInt(w)));this.add("endsub:")}addAttributesMenu(pe,ce){const K=pe===pe.getFramePainter(),G=K?pe.getPadPainter():null;if(ce||(ce=""),pe.lineatt?.used&&(this.add(`sub:${ce}Line att`),this.addSizeMenu("width",1,10,1,pe.lineatt.width,D=>{pe.lineatt.change(void 0,D),(0,Le.sd)(pe,"fLineWidth",D),G&&(0,Le.sd)(G,"fFrameLineWidth",D),pe.interactiveRedraw(!0,`exec:SetLineWidth(${D})`)}),this.addColorMenu("color",pe.lineatt.color,D=>{pe.lineatt.change(D),(0,Le.sd)(pe,"fLineColor",D,!0),G&&(0,Le.sd)(G,"fFrameLineColor",D,!0),pe.interactiveRedraw(!0,(0,Le.pp)(D,"SetLineColor"))}),this.addLineStyleMenu("style",pe.lineatt.style,D=>{pe.lineatt.change(void 0,void 0,D),(0,Le.sd)(pe,"fLineStyle",D),G&&(0,Le.sd)(G,"fFrameLineStyle",D),pe.interactiveRedraw(!0,`exec:SetLineStyle(${D})`)}),this.add("endsub:"),!K&&pe.lineatt?.excl_side)){this.add("sub:Exclusion"),this.add("sub:side");for(let D=-1;D<=1;++D)this.addchk(pe.lineatt.excl_side===D,D,D,x=>{pe.lineatt.changeExcl(parseInt(x)),pe.interactiveRedraw()});this.add("endsub:"),this.addSizeMenu("width",10,100,10,pe.lineatt.excl_width,D=>{pe.lineatt.changeExcl(void 0,D),pe.interactiveRedraw()}),this.add("endsub:")}if(pe.fillatt?.used&&(this.add(`sub:${ce}Fill att`),this.addColorMenu("color",pe.fillatt.colorindx,D=>{pe.fillatt.change(D,void 0,pe.getCanvSvg()),(0,Le.sd)(pe,"fFillColor",D,!0),G&&(0,Le.sd)(G,"fFrameFillColor",D,!0),pe.interactiveRedraw(!0,(0,Le.pp)(D,"SetFillColor"))},pe.fillatt.kind),this.addFillStyleMenu("style",pe.fillatt.pattern,pe.fillatt.colorindx,pe,D=>{pe.fillatt.change(void 0,D,pe.getCanvSvg()),(0,Le.sd)(pe,"fFillStyle",D),G&&(0,Le.sd)(G,"fFrameFillStyle",D),pe.interactiveRedraw(!0,`exec:SetFillStyle(${D})`)}),this.add("endsub:")),pe.markeratt?.used){this.add(`sub:${ce}Marker att`),this.addColorMenu("color",pe.markeratt.color,x=>{(0,Le.sd)(pe,"fMarkerColor",x,!0),pe.markeratt.change(x),pe.interactiveRedraw(!0,(0,Le.pp)(x,"SetMarkerColor"))}),this.addSizeMenu("size",.5,6,.5,pe.markeratt.size,x=>{(0,Le.sd)(pe,"fMarkerSize",x),pe.markeratt.change(void 0,void 0,x),pe.interactiveRedraw(!0,`exec:SetMarkerSize(${x})`)}),this.add("sub:style");const D=[1,2,3,4,5,6,7,8,21,22,23,24,25,26,27,28,29,30,31,32,33,34];for(let x=0;x<D.length;++x){const P=new Je.e({style:D[x],color:pe.markeratt.color,size:1.7}),w=`<svg width='60' height='18'><text x='1' y='12' style='font-size:12px'>${D[x].toString()}</text><path stroke='black' fill='${P.fill?"black":"none"}' d='${P.create(40,8)}'></path></svg>`;this.addchk(pe.markeratt.style===D[x],w,D[x],b=>{pe.markeratt.change(void 0,parseInt(b)),pe.interactiveRedraw(!0,`exec:SetMarkerStyle(${b})`)})}this.add("endsub:"),this.add("endsub:")}if(pe.textatt?.used){this.add(`sub:${ce}Text att`),this.addFontMenu("font",pe.textatt.font,x=>{(0,Le.sd)(pe,"fTextFont",x),pe.textatt.change(x),pe.interactiveRedraw(!0,`exec:SetTextFont(${x})`)});const D=pe.textatt.size<1;this.addSizeMenu("size",D?.03:6,D?.2:26,D?.01:2,pe.textatt.size,x=>{(0,Le.sd)(pe,"fTextSize",x),pe.textatt.change(void 0,x),pe.interactiveRedraw(!0,`exec:SetTextSize(${x})`)}),this.addColorMenu("color",pe.textatt.color,x=>{(0,Le.sd)(pe,"fTextColor",x,!0),pe.textatt.change(void 0,void 0,x),pe.interactiveRedraw(!0,(0,Le.pp)(x,"SetTextColor"))}),this.addAlignMenu("align",pe.textatt.align,x=>{(0,Le.sd)(pe,"fTextAlign",x),pe.textatt.change(void 0,void 0,void 0,x),pe.interactiveRedraw(!0,`exec:SetTextAlign(${x})`)}),pe.textatt.can_rotate&&this.addSizeMenu("angle",-180,180,45,pe.textatt.angle,x=>{(0,Le.sd)(pe,"fTextAngle",x),pe.textatt.change(void 0,void 0,void 0,void 0,x),pe.interactiveRedraw(!0,`exec:SetTextAngle(${x})`)}),this.add("endsub:")}}addTAxisMenu(pe,ce,K,G){const D=K._typename===v.clTGaxis;this.add("Divisions",()=>this.input("Set Ndivisions",K.fNdivisions,"int",0).then(P=>{K.fNdivisions=P,ce.interactiveRedraw("pad",`exec:SetNdivisions(${P})`,G)})),this.add("sub:Labels"),this.addchk(K.TestBit(pe.kCenterLabels),"Center",P=>{K.InvertBit(pe.kCenterLabels),ce.interactiveRedraw("pad",`exec:CenterLabels(${P})`,G)}),this.addchk(K.TestBit(pe.kLabelsVert),"Rotate",P=>{K.InvertBit(pe.kLabelsVert),ce.interactiveRedraw("pad",`exec:SetBit(TAxis::kLabelsVert,${P})`,G)}),this.addColorMenu("Color",K.fLabelColor,P=>{K.fLabelColor=P,ce.interactiveRedraw("pad",(0,Le.pp)(P,"SetLabelColor"),G)}),this.addSizeMenu("Offset",-.02,.1,.01,K.fLabelOffset,P=>{K.fLabelOffset=P,ce.interactiveRedraw("pad",`exec:SetLabelOffset(${P})`,G)});let x=K.fLabelSize>=1;this.addSizeMenu("Size",x?2:.02,x?30:.11,x?2:.01,K.fLabelSize,P=>{K.fLabelSize=P,ce.interactiveRedraw("pad",`exec:SetLabelSize(${P})`,G)}),this.add("endsub:"),this.add("sub:Title"),this.add("SetTitle",()=>{this.input("Enter axis title",K.fTitle).then(P=>{K.fTitle=P,ce.interactiveRedraw("pad",`exec:SetTitle("${P}")`,G)})}),this.addchk(K.TestBit(pe.kCenterTitle),"Center",P=>{K.InvertBit(pe.kCenterTitle),ce.interactiveRedraw("pad",`exec:CenterTitle(${P})`,G)}),this.addchk(K.TestBit(pe.kOppositeTitle),"Opposite",()=>{K.InvertBit(pe.kOppositeTitle),ce.redrawPad()}),this.addchk(K.TestBit(pe.kRotateTitle),"Rotate",P=>{K.InvertBit(pe.kRotateTitle),ce.interactiveRedraw("pad",D?`exec:SetBit(TAxis::kRotateTitle, ${P})`:`exec:RotateTitle(${P})`,G)}),D?this.addColorMenu("Color",K.fTextColor,P=>{K.fTextColor=P,ce.interactiveRedraw("pad",(0,Le.pp)(P,"SetTitleColor"),G)}):this.addColorMenu("Color",K.fTitleColor,P=>{K.fTitleColor=P,ce.interactiveRedraw("pad",(0,Le.pp)(P,"SetTitleColor"),G)}),this.addSizeMenu("Offset",0,3,.2,K.fTitleOffset,P=>{K.fTitleOffset=P,ce.interactiveRedraw("pad",`exec:SetTitleOffset(${P})`,G)}),x=K.fTitleSize>=1,this.addSizeMenu("Size",x?2:.02,x?30:.11,x?2:.01,K.fTitleSize,P=>{K.fTitleSize=P,ce.interactiveRedraw("pad",`exec:SetTitleSize(${P})`,G)}),this.add("endsub:"),this.add("sub:Ticks"),D?(this.addColorMenu("Color",K.fLineColor,P=>{K.fLineColor=P,ce.interactiveRedraw("pad",(0,Le.pp)(P,"SetLineColor"),G)}),this.addSizeMenu("Size",-.05,.055,.01,K.fTickSize,P=>{K.fTickSize=P,ce.interactiveRedraw("pad",`exec:SetTickLength(${P})`,G)})):(this.addColorMenu("Color",K.fAxisColor,P=>{K.fAxisColor=P,ce.interactiveRedraw("pad",(0,Le.pp)(P,"SetAxisColor"),G)}),this.addSizeMenu("Size",-.05,.055,.01,K.fTickLength,P=>{K.fTickLength=P,ce.interactiveRedraw("pad",`exec:SetTickLength(${P})`,G)})),this.add("endsub:"),D&&this.add("Options",()=>this.input("Enter TGaxis options like +L or -G",K.fChopt,"string").then(P=>{K.fChopt=P,ce.interactiveRedraw("pad",`exec:SetOption("${P}")`,G)}))}addSettingsMenu(pe,ce,K){this.add(ce?"header:Settings":"sub:Settings"),this.add("sub:Files"),pe&&(this.addchk(v.settings.OnlyLastCycle,"Last cycle",x=>{v.settings.OnlyLastCycle=x,K&&K("refresh")}),this.addchk(!v.settings.SkipStreamerInfos,"Streamer infos",x=>{v.settings.SkipStreamerInfos=!x,K&&K("refresh")})),this.addchk(v.settings.UseStamp,"Use stamp arg",x=>{v.settings.UseStamp=x}),this.addSizeMenu("Max ranges",1,1e3,[1,10,20,50,200,1e3],v.settings.MaxRanges,x=>{v.settings.MaxRanges=x},"Maximal number of ranges in single http request"),this.addchk(v.settings.HandleWrongHttpResponse,"Handle wrong http response",x=>{v.settings.HandleWrongHttpResponse=x}),this.addchk(v.settings.WithCredentials,"With credentials",x=>{v.settings.WithCredentials=x},"Submit http request with user credentials"),this.add("endsub:"),this.add("sub:Toolbar"),this.addchk(!1===v.settings.ToolBar,"Off",x=>{v.settings.ToolBar=!x}),this.addchk(!0===v.settings.ToolBar,"On",x=>{v.settings.ToolBar=x}),this.addchk("popup"===v.settings.ToolBar,"Popup",x=>{v.settings.ToolBar=!!x&&"popup"}),this.add("separator"),this.addchk("left"===v.settings.ToolBarSide,"Left side",x=>{v.settings.ToolBarSide=x?"left":"right"}),this.addchk(v.settings.ToolBarVert,"Vertical",x=>{v.settings.ToolBarVert=x}),this.add("endsub:"),this.add("sub:Interactive"),this.addchk(v.settings.Tooltip,"Tooltip",x=>{v.settings.Tooltip=x}),this.addchk(v.settings.ContextMenu,"Context menus",x=>{v.settings.ContextMenu=x}),this.add("sub:Zooming"),this.addchk(v.settings.Zooming,"Global",x=>{v.settings.Zooming=x}),this.addchk(v.settings.ZoomMouse,"Mouse",x=>{v.settings.ZoomMouse=x}),this.addchk(v.settings.ZoomWheel,"Wheel",x=>{v.settings.ZoomWheel=x}),this.addchk(v.settings.ZoomTouch,"Touch",x=>{v.settings.ZoomTouch=x}),this.add("endsub:"),this.addchk(v.settings.HandleKeys,"Keypress handling",x=>{v.settings.HandleKeys=x}),this.addchk(v.settings.MoveResize,"Move and resize",x=>{v.settings.MoveResize=x}),this.addchk(v.settings.DragAndDrop,"Drag and drop",x=>{v.settings.DragAndDrop=x}),this.addchk(v.settings.DragGraphs,"Drag graph points",x=>{v.settings.DragGraphs=x}),this.addSelectMenu("Progress box",["off","on","modal"],(0,v.isStr)(v.settings.ProgressBox)?v.settings.ProgressBox:v.settings.ProgressBox?"on":"off",x=>{v.settings.ProgressBox="off"!==x&&(" on"===x||x)}),this.add("endsub:"),this.add("sub:Drawing"),this.addSelectMenu("Optimize",["None","Smart","Always"],v.settings.OptimizeDraw,x=>{v.settings.OptimizeDraw=x}),this.addPaletteMenu(v.settings.Palette,x=>{v.settings.Palette=x}),this.addchk(v.settings.AutoStat,"Auto stat box",x=>{v.settings.AutoStat=x}),this.addSelectMenu("Latex",["Off","Symbols","Normal","MathJax","Force MathJax"],v.settings.Latex,x=>{v.settings.Latex=x}),this.addSelectMenu("3D rendering",["Default","WebGL","Image"],v.settings.Render3D,x=>{v.settings.Render3D=x}),this.addSelectMenu("WebGL embeding",["Default","Overlay","Embed"],v.settings.Embed3D,x=>{v.settings.Embed3D=x}),this.add("endsub:"),this.add("sub:Geometry"),this.add("Grad per segment:  "+v.settings.GeoGradPerSegm,()=>this.input("Grad per segment in geometry",v.settings.GeoGradPerSegm,"int",1,60).then(x=>{v.settings.GeoGradPerSegm=x})),this.addchk(v.settings.GeoCompressComp,"Compress composites",x=>{v.settings.GeoCompressComp=x}),this.add("endsub:"),pe&&(this.add("sub:Browser"),this.add("Hierarchy limit:  "+v.settings.HierarchyLimit,()=>this.input("Max number of items in hierarchy",v.settings.HierarchyLimit,"int",10,1e5).then(x=>{v.settings.HierarchyLimit=x,K&&K("refresh")})),this.add("Browser width:  "+v.settings.BrowserWidth,()=>this.input("Browser width in px",v.settings.BrowserWidth,"int",50,2e3).then(x=>{v.settings.BrowserWidth=x,K&&K("width")})),this.add("endsub:")),this.add("Dark mode: "+(v.settings.DarkMode?"On":"Off"),()=>{v.settings.DarkMode=!v.settings.DarkMode,K&&K("dark")});const G=x=>{v.gStyle[x.slice(1)]=parseInt(x[0])},D=(x,P,w)=>{this.add("sub:"+x);const b=v.gStyle[P]>=w.length?1:v.gStyle[P];for(let g=0;g<w.length;++g)this.addchk(b===g,w[g],`${g}${P}`,G);this.add("endsub:")};this.add("sub:gStyle"),this.add("sub:Canvas"),this.addColorMenu("Color",v.gStyle.fCanvasColor,x=>{v.gStyle.fCanvasColor=x}),D("Draw date","fOptDate",["Off","Current time","File create time","File modify time"]),this.add(`Time zone: ${v.settings.TimeZone}`,()=>this.input("Input time zone like UTC. empty string - local timezone",v.settings.TimeZone,"string").then(x=>{v.settings.TimeZone=x})),D("Draw file","fOptFile",["Off","File name","Full file URL","Item name"]),this.addSizeMenu("Date X",.01,.1,.01,v.gStyle.fDateX,x=>{v.gStyle.fDateX=x},"configure gStyle.fDateX for date/item name drawings"),this.addSizeMenu("Date Y",.01,.1,.01,v.gStyle.fDateY,x=>{v.gStyle.fDateY=x},"configure gStyle.fDateY for date/item name drawings"),this.add("endsub:"),this.add("sub:Pad"),this.addColorMenu("Color",v.gStyle.fPadColor,x=>{v.gStyle.fPadColor=x}),this.add("sub:Grid"),this.addchk(v.gStyle.fPadGridX,"X",x=>{v.gStyle.fPadGridX=x}),this.addchk(v.gStyle.fPadGridY,"Y",x=>{v.gStyle.fPadGridY=x}),this.addColorMenu("Color",v.gStyle.fGridColor,x=>{v.gStyle.fGridColor=x}),this.addSizeMenu("Width",1,10,1,v.gStyle.fGridWidth,x=>{v.gStyle.fGridWidth=x}),this.addLineStyleMenu("Style",v.gStyle.fGridStyle,x=>{v.gStyle.fGridStyle=x}),this.add("endsub:"),D("Ticks X","fPadTickX",["normal","ticks on both sides","labels on both sides"]),D("Ticks Y","fPadTickY",["normal","ticks on both sides","labels on both sides"]),D("Log X","fOptLogx",["off","on","log 2"]),D("Log Y","fOptLogy",["off","on","log 2"]),D("Log Z","fOptLogz",["off","on","log 2"]),this.add("endsub:"),this.add("sub:Frame"),this.addColorMenu("Fill color",v.gStyle.fFrameFillColor,x=>{v.gStyle.fFrameFillColor=x}),this.addFillStyleMenu("Fill style",v.gStyle.fFrameFillStyle,v.gStyle.fFrameFillColor,null,x=>{v.gStyle.fFrameFillStyle=x}),this.addColorMenu("Line color",v.gStyle.fFrameLineColor,x=>{v.gStyle.fFrameLineColor=x}),this.addSizeMenu("Line width",1,10,1,v.gStyle.fFrameLineWidth,x=>{v.gStyle.fFrameLineWidth=x}),this.addLineStyleMenu("Line style",v.gStyle.fFrameLineStyle,x=>{v.gStyle.fFrameLineStyle=x}),this.addSizeMenu("Border size",0,10,1,v.gStyle.fFrameBorderSize,x=>{v.gStyle.fFrameBorderSize=x}),this.add("sub:Margins"),this.addSizeMenu("Bottom",0,.5,.05,v.gStyle.fPadBottomMargin,x=>{v.gStyle.fPadBottomMargin=x}),this.addSizeMenu("Top",0,.5,.05,v.gStyle.fPadTopMargin,x=>{v.gStyle.fPadTopMargin=x}),this.addSizeMenu("Left",0,.5,.05,v.gStyle.fPadLeftMargin,x=>{v.gStyle.fPadLeftMargin=x}),this.addSizeMenu("Right",0,.5,.05,v.gStyle.fPadRightMargin,x=>{v.gStyle.fPadRightMargin=x}),this.add("endsub:"),this.add("endsub:"),this.add("sub:Title"),this.addColorMenu("Fill color",v.gStyle.fTitleColor,x=>{v.gStyle.fTitleColor=x}),this.addFillStyleMenu("Fill style",v.gStyle.fTitleStyle,v.gStyle.fTitleColor,null,x=>{v.gStyle.fTitleStyle=x}),this.addColorMenu("Text color",v.gStyle.fTitleTextColor,x=>{v.gStyle.fTitleTextColor=x}),this.addSizeMenu("Border size",0,10,1,v.gStyle.fTitleBorderSize,x=>{v.gStyle.fTitleBorderSize=x}),this.addSizeMenu("Font size",.01,.1,.01,v.gStyle.fTitleFontSize,x=>{v.gStyle.fTitleFontSize=x}),this.addFontMenu("Font",v.gStyle.fTitleFont,x=>{v.gStyle.fTitleFont=x}),this.addSizeMenu("X: "+v.gStyle.fTitleX.toFixed(2),0,1,.1,v.gStyle.fTitleX,x=>{v.gStyle.fTitleX=x}),this.addSizeMenu("Y: "+v.gStyle.fTitleY.toFixed(2),0,1,.1,v.gStyle.fTitleY,x=>{v.gStyle.fTitleY=x}),this.addSizeMenu("W: "+v.gStyle.fTitleW.toFixed(2),0,1,.1,v.gStyle.fTitleW,x=>{v.gStyle.fTitleW=x}),this.addSizeMenu("H: "+v.gStyle.fTitleH.toFixed(2),0,1,.1,v.gStyle.fTitleH,x=>{v.gStyle.fTitleH=x}),this.add("endsub:"),this.add("sub:Stat box"),this.addColorMenu("Fill color",v.gStyle.fStatColor,x=>{v.gStyle.fStatColor=x}),this.addFillStyleMenu("Fill style",v.gStyle.fStatStyle,v.gStyle.fStatColor,null,x=>{v.gStyle.fStatStyle=x}),this.addColorMenu("Text color",v.gStyle.fStatTextColor,x=>{v.gStyle.fStatTextColor=x}),this.addSizeMenu("Border size",0,10,1,v.gStyle.fStatBorderSize,x=>{v.gStyle.fStatBorderSize=x}),this.addSizeMenu("Font size",0,30,5,v.gStyle.fStatFontSize,x=>{v.gStyle.fStatFontSize=x}),this.addFontMenu("Font",v.gStyle.fStatFont,x=>{v.gStyle.fStatFont=x}),this.add("Stat format",()=>this.input("Stat format",v.gStyle.fStatFormat).then(x=>{v.gStyle.fStatFormat=x})),this.addSizeMenu("X: "+v.gStyle.fStatX.toFixed(2),.2,1,.1,v.gStyle.fStatX,x=>{v.gStyle.fStatX=x}),this.addSizeMenu("Y: "+v.gStyle.fStatY.toFixed(2),.2,1,.1,v.gStyle.fStatY,x=>{v.gStyle.fStatY=x}),this.addSizeMenu("Width: "+v.gStyle.fStatW.toFixed(2),.1,1,.1,v.gStyle.fStatW,x=>{v.gStyle.fStatW=x}),this.addSizeMenu("Height: "+v.gStyle.fStatH.toFixed(2),.1,1,.1,v.gStyle.fStatH,x=>{v.gStyle.fStatH=x}),this.add("endsub:"),this.add("sub:Legend"),this.addColorMenu("Fill color",v.gStyle.fLegendFillColor,x=>{v.gStyle.fLegendFillColor=x}),this.addSizeMenu("Border size",0,10,1,v.gStyle.fLegendBorderSize,x=>{v.gStyle.fLegendBorderSize=x}),this.addFontMenu("Font",v.gStyle.fLegendFont,x=>{v.gStyle.fLegendFont=x}),this.addSizeMenu("Text size",0,.1,.01,v.gStyle.fLegendTextSize,x=>{v.gStyle.fLegendTextSize=x},"legend text size, when 0 - auto adjustment is used"),this.add("endsub:"),this.add("sub:Histogram"),this.addchk(1===v.gStyle.fOptTitle,"Hist title",x=>{v.gStyle.fOptTitle=x?1:0}),this.addchk(v.gStyle.fOrthoCamera,"Orthographic camera",x=>{v.gStyle.fOrthoCamera=x}),this.addchk(v.gStyle.fHistMinimumZero,"Base0",x=>{v.gStyle.fHistMinimumZero=x},"when true, BAR and LEGO drawing using base = 0"),this.add("Text format",()=>this.input("Paint text format",v.gStyle.fPaintTextFormat).then(x=>{v.gStyle.fPaintTextFormat=x})),this.add("Time offset",()=>this.input("Time offset in seconds, default is 788918400 for 1/1/1995",v.gStyle.fTimeOffset,"int").then(x=>{v.gStyle.fTimeOffset=x})),this.addSizeMenu("ErrorX: "+v.gStyle.fErrorX.toFixed(2),0,1,.1,v.gStyle.fErrorX,x=>{v.gStyle.fErrorX=x}),this.addSizeMenu("End error",0,12,1,v.gStyle.fEndErrorSize,x=>{v.gStyle.fEndErrorSize=x},"size in pixels of end error for E1 draw options, gStyle.fEndErrorSize"),this.addSizeMenu("Top margin",0,.5,.05,v.gStyle.fHistTopMargin,x=>{v.gStyle.fHistTopMargin=x},"Margin between histogram top and frame top"),this.addColorMenu("Fill color",v.gStyle.fHistFillColor,x=>{v.gStyle.fHistFillColor=x}),this.addFillStyleMenu("Fill style",v.gStyle.fHistFillStyle,v.gStyle.fHistFillColor,null,x=>{v.gStyle.fHistFillStyle=x}),this.addColorMenu("Line color",v.gStyle.fHistLineColor,x=>{v.gStyle.fHistLineColor=x}),this.addSizeMenu("Line width",1,10,1,v.gStyle.fHistLineWidth,x=>{v.gStyle.fHistLineWidth=x}),this.addLineStyleMenu("Line style",v.gStyle.fHistLineStyle,x=>{v.gStyle.fHistLineStyle=x}),this.add("endsub:"),this.add("separator"),this.add("sub:Predefined"),["Modern","Plain","Bold"].forEach(x=>this.addchk(v.gStyle.fName===x,x,x,Le.Jb)),this.add("endsub:"),this.add("endsub:"),this.add("separator"),this.add("Save settings",()=>{((0,Le.sb)(!0)?Promise.resolve(!0):this.confirm("Save settings","Pressing OK one agreess that JSROOT will store settings in browser local storage")).then(P=>{P&&((0,Le.DZ)(),(0,Le.PL)())})},"Store settings and gStyle in browser local storage"),this.add("Delete settings",()=>{(0,Le.DZ)(-1),(0,Le.PL)(-1)},"Delete settings and gStyle from browser local storage"),ce||this.add("endsub:")}runModal(){return(0,be.A)(function*(){throw Error("runModal() must be reimplemented")})()}info(pe,ce){return this.runModal(pe,`<p>${ce}</p>`,{height:120,width:400,resizable:!0})}confirm(pe,ce){var K=this;return(0,be.A)(function*(){return K.runModal(pe,ce,{btns:!0,height:120,width:400}).then(G=>!!G)})()}input(pe,ce,K,G,D){var x=this;return(0,be.A)(function*(){K||(K="text");let w="";null==ce&&(ce=""),"int"===K&&(void 0!==G&&(w+=` min="${G}"`),void 0!==D&&(w+=` max="${D}"`));const b=`<form><fieldset style="padding:0; border:0"><input type="${"int"===K?"number":"text"}" value="${ce}" ${w} style="width:98%;display:block" class="jsroot_dlginp"/></fieldset></form>`;return new Promise(g=>{x.runModal(pe,b,{btns:!0,height:150,width:400}).then(C=>{if(!C)return;let N=C.querySelector(".jsroot_dlginp").value;"float"===K?(N=Number.parseFloat(N),Number.isFinite(N)&&g(N)):"int"===K?(N=parseInt(N),Number.isInteger(N)&&g(N)):g(N)})})})()}showMethodArgsDialog(pe){var ce=this;return(0,be.A)(function*(){const K=ce.menuname+"_dialog";let G='<form> <fieldset style="padding:0; border:0">';for(let D=0;D<pe.fArgs.length;++D){const x=pe.fArgs[D];x.fValue=x.fDefault,'""'===x.fValue&&(x.fValue=""),G+=`<label for="${K}_inp${D}">${x.fName}</label>\n                          <input type='text' tabindex="${D+1}" id="${K}_inp${D}" value="${x.fValue}" style="width:100%;display:block"/>`}return G+="</fieldset></form>",new Promise(D=>{ce.runModal(pe.fClassName+"::"+pe.fName,G,{btns:!0,height:100+60*pe.fArgs.length,width:400,resizable:!0}).then(x=>{if(!x)return;let P="";for(let w=0;w<pe.fArgs.length;++w){const b=pe.fArgs[w];let g=x.querySelector(`#${K}_inp${w}`).value;""===g&&(g=b.fDefault),("Option_t*"===b.fTitle||"const char*"===b.fTitle)&&(g||(g='""'),'"'!==g[0]&&(g='"'+g),'"'!==g[g.length-1]&&(g+='"')),P+=(w>0?",":"")+g}D(P)})})})()}showCommandArgsDialog(pe,ce){var K=this;return(0,be.A)(function*(){const G=K.menuname+"_dialog";let D='<form> <fieldset style="padding:0; border:0">';for(let x=0;x<ce.length;++x)D+=`<label for="${G}_inp${x}">arg${x+1}</label><input type='text' id="${G}_inp${x}" value="${ce[x]}" style="width:100%;display:block"/>`;return D+="</fieldset></form>",new Promise(x=>{K.runModal("Arguments for command "+pe,D,{btns:!0,height:110+60*ce.length,width:400,resizable:!0}).then(P=>{if(!P)return x(null);const w=[];for(let b=0;b<ce.length;++b)w.push(P.querySelector(`#${G}_inp${b}`).value);x(w)})})})()}}class Qe extends Re{constructor(pe,ce,K){super(pe,ce,K),this.code=[],this._use_plain_text=!0,this.stack=[this.code]}native(){return!0}load(){var pe=this;return(0,be.A)(function*(){return pe})()}add(pe,ce,K,G){let D=this.stack[this.stack.length-1];if("separator"===pe)return D.push({divider:!0});if(0===pe.indexOf("header:"))return D.push({text:pe.slice(7),header:!0});if("endsub:"===pe)return this.stack.pop(),D=this.stack[this.stack.length-1],void(0===D[D.length-1].sub.length&&(D[D.length-1].sub=void 0));if("endcolumn:"===pe)return this.stack.pop();(0,v.isFunc)(ce)&&(G=K,K=ce,ce=pe);const x={};if(D.push(x),"column:"===pe)return x.column=!0,x.sub=[],void this.stack.push(x.sub);0===pe.indexOf("sub:")&&(pe=pe.slice(4),x.sub=[],this.stack.push(x.sub)),0===pe.indexOf("chk:")?(x.checked=!0,pe=pe.slice(4)):0===pe.indexOf("unk:")&&(x.checked=!1,pe=pe.slice(4)),x.text=pe,x.title=G,x.arg=ce,x.func=K}size(){return this.code.length}_buildContextmenu(pe,ce,K,G){const D=(0,v.getDocument)(),x=D.createElement("div"),P="position: absolute; top: 0; user-select: none; z-index: 100000; background-color: rgb(250, 250, 250); margin: 0; padding: 0px; width: auto;min-width: 100px; box-shadow: 0px 0px 10px rgb(0, 0, 0, 0.2); border: 3px solid rgb(215, 215, 215); font-family: Arial, helvetica, sans-serif, serif;font-size: 13px; color: rgb(0, 0, 0, 0.8); line-height: 15px;";if(G===D.body){const N=D.getElementsByClassName("jsroot_ctxt_container");for(;N.length>0;)N[0].parentNode.removeChild(N[0]);x.className="jsroot_ctxt_container",x.style=P,x.style.position="fixed",x.style.left=ce+"px",x.style.top=K+"px"}else ce<0&&K===ce?(x.className="jsroot_ctxt_column",x.style.float="left",x.style.width=(100/-ce).toFixed(1)+"%"):(x.className="jsroot_ctxt_container",x.style=P,x.style.left=-G.offsetLeft+G.offsetWidth+"px");let w=!1,b=0;pe.forEach(N=>{N.checked&&(w=!0),N.column&&b++}),pe.forEach(N=>{if(b>0)return x.style.display="flex",void(N.column&&this._buildContextmenu(N.sub,-b,-b,x));if(N.divider){const z=D.createElement("hr");return z.style="width: 85%; margin: 3px auto; border: 1px solid rgb(0, 0, 0, 0.15)",void x.appendChild(z)}const O=D.createElement("div");if(O.style.position="relative",x.appendChild(O),N.header)return O.style="background-color: lightblue; padding: 3px 7px; font-weight: bold; border-bottom: 1px;",void(O.innerHTML=N.text);const H=D.createElement("div");H.style.width="100%",H.style.height="100%",H.style.display="flex",H.style.justifyContent="space-between",H.style.cursor="pointer",N.title&&H.setAttribute("title",N.title),O.appendChild(H),N.text||(N.text="item");const X=D.createElement("div");if(X.style="margin: 0; padding: 3px 7px; pointer-events: none; white-space: nowrap",N.text.indexOf("<svg")>=0)if(w){X.style.display="flex";const z=D.createElement("span");z.innerHTML=N.checked?"\u2713":"",z.style.display="inline-block",z.style.width="1em",X.appendChild(z);const m=D.createElement("div");m.innerHTML=N.text,X.appendChild(m)}else X.innerHTML=N.text;else{if(w){const m=D.createElement("span");m.innerHTML=N.checked?"\u2713":"",m.style.display="inline-block",m.style.width="1em",X.appendChild(m)}const z=D.createElement("span");z.textContent=0===N.text.indexOf("<nobr>")?N.text.slice(6,N.text.length-7):N.text,X.appendChild(z)}function ie(z,m){m?(z.classList.add("jsroot_ctxt_focus"),z.style["background-color"]="rgb(220, 220, 220)"):z.classList.contains("jsroot_ctxt_focus")&&(z.style["background-color"]=null,z.classList.remove("jsroot_ctxt_focus"),z.querySelector(".jsroot_ctxt_container")?.remove())}if(H.appendChild(X),N.extraText||N.sub){const z=D.createElement("span");z.className="jsroot_ctxt_extraText",z.style="margin: 0; padding: 3px 7px; color: rgb(0, 0, 0, 0.6);",z.textContent=N.sub?"\u25b6":N.extraText,H.appendChild(z),N.sub&&v.browser.touches&&z.addEventListener("click",m=>{m.preventDefault(),m.stopPropagation();const I=O.parentNode.querySelector(".jsroot_ctxt_focus");I&&ie(I,!1),O!==I&&(ie(O,!0),this._buildContextmenu(N.sub,0,0,O))})}v.browser.touches||H.addEventListener("mouseenter",()=>{this.prevHovArea&&(this.prevHovArea.style["background-color"]=null),H.style["background-color"]="rgb(235, 235, 235)",this.prevHovArea=H,x.childNodes.forEach(z=>ie(z,!1)),N.sub&&(ie(O,!0),this._buildContextmenu(N.sub,0,0,O))}),N.func&&O.addEventListener("click",z=>{(this.painter?N.func.bind(this.painter):N.func)(N.arg),z.stopPropagation(),this.remove()})}),G.appendChild(x);const g=D.documentElement.clientWidth,C=D.documentElement.clientHeight;if(G===D.body)ce+x.offsetWidth>g&&(x.style.left=g-x.offsetWidth+"px"),x.offsetHeight>C?(x.style.top=0,x.style.overflowY="scroll",x.style.overflowX="hidden",x.style.height=C+"px"):K+x.offsetHeight>C&&(x.style.top=C-x.offsetHeight+"px");else if("jsroot_ctxt_column"!==x.className){const N=G.getBoundingClientRect(),O=x.getBoundingClientRect();O.left+O.width>g&&(x.style.left=-G.offsetLeft-O.width+"px"),O.height>C?(x.style.top=-O.top+"px",x.style.overflowY="scroll",x.style.overflowX="hidden",x.style.height=C+"px"):O.height<C&&O.height>C/2?x.style.top=O.top-C/2>=0?-O.top-O.height+C+"px":-O.top+"px":O.top+O.height>C&&(x.style.top=-O.height+N.height+"px")}return x}show(pe){var ce=this;return(0,be.A)(function*(){ce.remove(),!pe&&ce.show_evnt&&(pe=ce.show_evnt);const K=(0,v.getDocument)(),G=typeof window>"u"?{x:0,y:0}:{x:window.scrollX,y:window.scrollY};K.body.addEventListener("click",ce.remove_handler);const D=K.getElementById(ce.menuname);return D&&D.remove(),ce.element=ce._buildContextmenu(ce.code,(pe?.clientX||0)+G.x,(pe?.clientY||0)+G.y,K.body),ce.element.setAttribute("id",ce.menuname),ce})()}createModal(pe,ce,K){K||(K={}),K.Ok||(K.Ok="Ok");const G={args:K},D=(this?.menuname??"root_modal")+"_dialog";(0,V.Lt)(`#${D}`).remove(),(0,V.Lt)(`#${D}_block`).remove();const x=Math.min(K.width||450,Math.round(.9*v.browser.screenWidth));G.block=(0,V.Lt)("body").append("div").attr("id",`${D}_block`).attr("class","jsroot_dialog_block").attr("style","z-index: 100000; position: absolute; left: 0px; top: 0px; bottom: 0px; right: 0px; opacity: 0.2; background-color: white"),G.element=(0,V.Lt)("body").append("div").attr("id",D).attr("class","jsroot_dialog").style("position","absolute").style("width",`${x}px`).style("left","50%").style("top","50%").style("z-index",100001).attr("tabindex","0").html(`<div style='position: relative; left: -50%; top: -50%; border: solid green 3px; padding: 5px; display: flex; flex-flow: column; background-color: white'><div style='flex: 0 1 auto; padding: 5px'>${pe}</div><div class='jsroot_dialog_content' style='flex: 1 1 auto; padding: 5px'>${ce}</div><div class='jsroot_dialog_footer' style='flex: 0 1 auto; padding: 5px'><button class='jsroot_dialog_button' style='float: right; width: fit-content; margin-right: 1em'>${K.Ok}</button>`+(K.btns?"<button class='jsroot_dialog_button' style='float: right; width: fit-content; margin-right: 1em'>Cancel</button>":"")+"</div></div>"),G.done=function(w){this._done||(this._done=!0,(0,v.isFunc)(this.call_back)&&this.call_back(w),this.element.remove(),this.block.remove())},G.setContent=function(w,b){this._done||(this.element.select(".jsroot_dialog_content").html(w),b&&(this.args.Ok=b,this.element.select(".jsroot_dialog_button").text(b)))},G.element.on("keyup",w=>{("Enter"===w.code||"Escape"===w.code)&&(w.preventDefault(),w.stopPropagation(),G.done("Enter"===w.code?G.element.node():null))}),G.element.on("keydown",w=>{("Enter"===w.code||"Escape"===w.code)&&(w.preventDefault(),w.stopPropagation())}),G.element.selectAll(".jsroot_dialog_button").on("click",w=>{G.done(K.btns&&(0,V.Lt)(w.target).text()===K.Ok?G.element.node():null)});let P=G.element.select(".jsroot_dialog_content").select("input");return P.empty()&&(P=G.element.select(".jsroot_dialog_footer").select("button")),P.empty()||P.node().focus(),G}runModal(pe,ce,K){var G=this;return(0,be.A)(function*(){const D=G.createModal(pe,ce,K);return new Promise(x=>{D.call_back=x})})()}}function Ie(de,pe,ce){return new Qe(pe,ce||"root_ctx_menu",de).load()}function L(de){const pe=(0,v.getDocument)().getElementById(de||"root_ctx_menu");return pe?.remove(),!!pe}function he(de){de||(de="root_ctx_menu");const pe=(0,v.getDocument)();return!(!pe.getElementById(de)&&!pe.getElementById(de+"_dialog"))}function re(de,pe,ce){(0,v.isFunc)(de.stopPropagation)&&(de.stopPropagation(),de.preventDefault()),Ie(de,pe).then(K=>(pe.fillContextMenu(K),ce===ot&&(0,v.isFunc)(pe.bringToFront)&&(K.add("Bring to front",()=>pe.bringToFront(!0)),ce=void 0),pe.fillObjectExecMenu(K,ce))).then(K=>K.show())}function fe(de,pe){!de?.isBatchMode()&&de?.draw_g&&de.draw_g.on("contextmenu",v.settings.ContextMenu?ce=>re(ce,de,pe):null)}v.internals._modalProgress=function(de,pe){if(!de||!(0,v.isStr)(de))return v.internals.modal?.done(),void delete v.internals.modal;v.internals.modal||(v.internals.modal=Qe.prototype.createModal("Progress",de)),v.internals.modal.setContent(de,pe?"Abort":"Ok"),v.internals.modal.call_back=pe}},9606:(Gr,xt,Te)=>{"use strict";Te.d(xt,{DZ:()=>D,IK:()=>Ie,Jb:()=>de,OJ:()=>C,PL:()=>P,Rh:()=>st,W4:()=>Ke,X2:()=>re,cA:()=>Re,d7:()=>L,fz:()=>fe,iE:()=>he,pp:()=>X,sb:()=>x,sd:()=>ie});var be=Te(5774),v=Te(4186),V=Te(3324),Le=Te(165),xe=Te(2481),Je=Te(139);function st(z,m,I){if((0,v.isBatchMode)()||typeof document>"u")return;const A="jsroot_progressbox",R="modal"===v.settings.ProgressBox&&(0,v.isFunc)(v.internals._modalProgress)?v.internals._modalProgress:null;let k=(0,V.Lt)("#"+A);if(!v.settings.ProgressBox)return R&&R(),k.remove();if(0===arguments.length||!z)return(-1!==m||!k.empty()&&k.property("with_timeout"))&&k.remove(),void(R&&R());if(R)k.remove(),R(z,I);else{k.empty()&&(k=(0,V.Lt)(document.body).append("div").attr("id",A).attr("style","position: fixed; min-width: 100px; height: auto; overflow: visible; z-index: 101; border: 1px solid #999; background: #F8F8F8; left: 10px; bottom: 10px;"),k.append("p")),k.property("with_timeout",!1);const ee=k.select("p");(0,v.isStr)(z)&&ee.html(z).on("click",(0,v.isFunc)(I)?I:null).attr("title",(0,v.isFunc)(I)?"Click element to abort current operation":""),ee.attr("style","font-size: 10px; margin-left: 10px; margin-right: 10px; margin-top: 3px; margin-bottom: 3px")}Number.isFinite(m)&&m>0&&(k.empty()||k.property("with_timeout",!0),setTimeout(()=>st("",-1),m))}function Ke(){typeof window>"u"||(window.close(),window.open("","_self").close())}function ot(z,m){if(!z||0===z.length)return void((0,v.isFunc)(m.rejectFunc)&&(m.rejectFunc(Error("openui5 was not possible to load")),m.rejectFunc=null));let I=z.shift();0===I.indexOf("roothandler")&&I.indexOf("://")<0&&(I=I.replace(/:\//g,"://"));const A=document.createElement("script");A.setAttribute("type","text/javascript"),A.setAttribute("id","sap-ui-bootstrap"),A.setAttribute("src",I+(m.ui5dbg?"resources/sap-ui-core-dbg.js":"resources/sap-ui-core.js")),A.setAttribute("data-sap-ui-libs",m.openui5libs??"sap.m, sap.ui.layout, sap.ui.unified, sap.ui.commons"),A.setAttribute("data-sap-ui-theme",m.openui5theme||"sap_belize"),A.setAttribute("data-sap-ui-compatVersion","edge"),A.setAttribute("data-sap-ui-async","true"),A.setAttribute("data-sap-ui-preload","async"),A.setAttribute("data-sap-ui-evt-oninit","completeUI5Loading()"),A.onerror=function(){A.parentNode.removeChild(A),ot(z,m)},A.onload=function(){console.log(`Load openui5 from ${I}`)},document.head.appendChild(A)}function Re(z){return Qe.apply(this,arguments)}function Qe(){return(Qe=(0,be.A)(function*(z){if("object"==typeof globalThis.sap)return globalThis.sap;z||(z={});let m=v.source_dir.replace(/jsrootsys/g,"rootui5sys");m===v.source_dir&&(m=window.location.port&&window.location.pathname.indexOf("/win")>=0&&(!z.openui5src||"nojsroot"===z.openui5src||"jsroot"===z.openui5src)?window.location.origin+window.location.pathname+"../rootui5sys/":void 0);const I=[];let A="https://openui5.hana.ondemand.com/1.98.0/",R=m?m+"distribution/":"";if((0,v.isStr)(z.openui5src))switch(z.openui5src){case"nodefault":A="";break;case"default":I.push(A),A="";break;case"nojsroot":break;case"jsroot":I.push(R),R="";break;default:I.push(z.openui5src)}else z.ui5dbg&&(R="");return R&&I.indexOf(R)<0&&I.push(R),A&&I.indexOf(A)<0&&I.push(A),new Promise((k,ee)=>{z.resolveFunc=k,z.rejectFunc=ee,globalThis.completeUI5Loading=function(){globalThis.sap.ui.loader.config({paths:{jsroot:v.source_dir,rootui5:m}}),z.resolveFunc&&(z.resolveFunc(globalThis.sap),z.resolveFunc=null)},ot(I,z)})})).apply(this,arguments)}const Ie={camera:{path:"M 152.00,304.00c0.00,57.438, 46.562,104.00, 104.00,104.00s 104.00-46.562, 104.00-104.00s-46.562-104.00-104.00-104.00S 152.00,246.562, 152.00,304.00z M 480.00,128.00L 368.00,128.00 c-8.00-32.00-16.00-64.00-48.00-64.00L 192.00,64.00 c-32.00,0.00-40.00,32.00-48.00,64.00L 32.00,128.00 c-17.60,0.00-32.00,14.40-32.00,32.00l0.00,288.00 c0.00,17.60, 14.40,32.00, 32.00,32.00l 448.00,0.00 c 17.60,0.00, 32.00-14.40, 32.00-32.00L 512.00,160.00 C 512.00,142.40, 497.60,128.00, 480.00,128.00z M 256.00,446.00c-78.425,0.00-142.00-63.574-142.00-142.00c0.00-78.425, 63.575-142.00, 142.00-142.00c 78.426,0.00, 142.00,63.575, 142.00,142.00 C 398.00,382.426, 334.427,446.00, 256.00,446.00z M 480.00,224.00l-64.00,0.00 l0.00-32.00 l 64.00,0.00 L 480.00,224.00 z"},disk:{path:"M384,0H128H32C14.336,0,0,14.336,0,32v448c0,17.656,14.336,32,32,32h448c17.656,0,32-14.344,32-32V96L416,0H384z M352,160   V32h32v128c0,17.664-14.344,32-32,32H160c-17.664,0-32-14.336-32-32V32h128v128H352z M96,288c0-17.656,14.336-32,32-32h256   c17.656,0,32,14.344,32,32v192H96V288z"},question:{path:"M256,512c141.375,0,256-114.625,256-256S397.375,0,256,0S0,114.625,0,256S114.625,512,256,512z M256,64   c63.719,0,128,36.484,128,118.016c0,47.453-23.531,84.516-69.891,110.016C300.672,299.422,288,314.047,288,320   c0,17.656-14.344,32-32,32c-17.664,0-32-14.344-32-32c0-40.609,37.25-71.938,59.266-84.031   C315.625,218.109,320,198.656,320,182.016C320,135.008,279.906,128,256,128c-30.812,0-64,20.227-64,64.672   c0,17.664-14.336,32-32,32s-32-14.336-32-32C128,109.086,193.953,64,256,64z M256,449.406c-18.211,0-32.961-14.75-32.961-32.969   c0-18.188,14.75-32.953,32.961-32.953c18.219,0,32.969,14.766,32.969,32.953C288.969,434.656,274.219,449.406,256,449.406z"},undo:{path:"M450.159,48.042c8.791,9.032,16.983,18.898,24.59,29.604c7.594,10.706,14.146,22.207,19.668,34.489  c5.509,12.296,9.82,25.269,12.92,38.938c3.113,13.669,4.663,27.834,4.663,42.499c0,14.256-1.511,28.863-4.532,43.822  c-3.009,14.952-7.997,30.217-14.953,45.795c-6.955,15.577-16.202,31.52-27.755,47.826s-25.88,32.9-42.942,49.807  c-5.51,5.444-11.787,11.67-18.834,18.651c-7.033,6.98-14.496,14.366-22.39,22.168c-7.88,7.802-15.955,15.825-24.187,24.069  c-8.258,8.231-16.333,16.203-24.252,23.888c-18.3,18.13-37.354,37.016-57.191,56.65l-56.84-57.445  c19.596-19.472,38.54-38.279,56.84-56.41c7.75-7.685,15.772-15.604,24.108-23.757s16.438-16.163,24.33-24.057  c7.894-7.893,15.356-15.33,22.402-22.312c7.034-6.98,13.312-13.193,18.821-18.651c22.351-22.402,39.165-44.648,50.471-66.738  c11.279-22.09,16.932-43.567,16.932-64.446c0-15.785-3.217-31.005-9.638-45.671c-6.422-14.665-16.229-28.504-29.437-41.529  c-3.282-3.282-7.358-6.395-12.217-9.325c-4.871-2.938-10.381-5.503-16.516-7.697c-6.121-2.201-12.815-3.992-20.058-5.373  c-7.242-1.374-14.9-2.064-23.002-2.064c-8.218,0-16.802,0.834-25.788,2.507c-8.961,1.674-18.053,4.429-27.222,8.271  c-9.189,3.842-18.456,8.869-27.808,15.089c-9.358,6.219-18.521,13.819-27.502,22.793l-59.92,60.271l93.797,94.058H0V40.91  l93.27,91.597l60.181-60.532c13.376-15.018,27.222-27.248,41.536-36.697c14.308-9.443,28.608-16.776,42.89-21.992  c14.288-5.223,28.505-8.74,42.623-10.557C294.645,0.905,308.189,0,321.162,0c13.429,0,26.389,1.185,38.84,3.562  c12.478,2.377,24.2,5.718,35.192,10.029c11.006,4.311,21.126,9.404,30.374,15.265C434.79,34.724,442.995,41.119,450.159,48.042z"},arrow_right:{path:"M30.796,226.318h377.533L294.938,339.682c-11.899,11.906-11.899,31.184,0,43.084c11.887,11.899,31.19,11.893,43.077,0  l165.393-165.386c5.725-5.712,8.924-13.453,8.924-21.539c0-8.092-3.213-15.84-8.924-21.551L338.016,8.925  C332.065,2.975,324.278,0,316.478,0c-7.802,0-15.603,2.968-21.539,8.918c-11.899,11.906-11.899,31.184,0,43.084l113.391,113.384  H30.796c-16.822,0-30.463,13.645-30.463,30.463C0.333,212.674,13.974,226.318,30.796,226.318z"},arrow_up:{path:"M295.505,629.446V135.957l148.193,148.206c15.555,15.559,40.753,15.559,56.308,0c15.555-15.538,15.546-40.767,0-56.304  L283.83,11.662C276.372,4.204,266.236,0,255.68,0c-10.568,0-20.705,4.204-28.172,11.662L11.333,227.859  c-7.777,7.777-11.666,17.965-11.666,28.158c0,10.192,3.88,20.385,11.657,28.158c15.563,15.555,40.762,15.555,56.317,0  l148.201-148.219v493.489c0,21.993,17.837,39.82,39.82,39.82C277.669,669.267,295.505,651.439,295.505,629.446z"},arrow_diag:{path:"M279.875,511.994c-1.292,0-2.607-0.102-3.924-0.312c-10.944-1.771-19.333-10.676-20.457-21.71L233.97,278.348  L22.345,256.823c-11.029-1.119-19.928-9.51-21.698-20.461c-1.776-10.944,4.031-21.716,14.145-26.262L477.792,2.149  c9.282-4.163,20.167-2.165,27.355,5.024c7.201,7.189,9.199,18.086,5.024,27.356L302.22,497.527  C298.224,506.426,289.397,511.994,279.875,511.994z M118.277,217.332l140.534,14.294c11.567,1.178,20.718,10.335,21.878,21.896  l14.294,140.519l144.09-320.792L118.277,217.332z"},auto_zoom:{path:"M505.441,242.47l-78.303-78.291c-9.18-9.177-24.048-9.171-33.216,0c-9.169,9.172-9.169,24.045,0.006,33.217l38.193,38.188  H280.088V80.194l38.188,38.199c4.587,4.584,10.596,6.881,16.605,6.881c6.003,0,12.018-2.297,16.605-6.875  c9.174-9.172,9.174-24.039,0.011-33.217L273.219,6.881C268.803,2.471,262.834,0,256.596,0c-6.229,0-12.202,2.471-16.605,6.881  l-78.296,78.302c-9.178,9.172-9.178,24.045,0,33.217c9.177,9.171,24.051,9.171,33.21,0l38.205-38.205v155.4H80.521l38.2-38.188  c9.177-9.171,9.177-24.039,0.005-33.216c-9.171-9.172-24.039-9.178-33.216,0L7.208,242.464c-4.404,4.403-6.881,10.381-6.881,16.611  c0,6.227,2.477,12.207,6.881,16.61l78.302,78.291c4.587,4.581,10.599,6.875,16.605,6.875c6.006,0,12.023-2.294,16.61-6.881  c9.172-9.174,9.172-24.036-0.005-33.211l-38.205-38.199h152.593v152.063l-38.199-38.211c-9.171-9.18-24.039-9.18-33.216-0.022  c-9.178,9.18-9.178,24.059-0.006,33.222l78.284,78.302c4.41,4.404,10.382,6.881,16.611,6.881c6.233,0,12.208-2.477,16.611-6.881  l78.302-78.296c9.181-9.18,9.181-24.048,0-33.205c-9.174-9.174-24.054-9.174-33.21,0l-38.199,38.188v-152.04h152.051l-38.205,38.199  c-9.18,9.175-9.18,24.037-0.005,33.211c4.587,4.587,10.596,6.881,16.604,6.881c6.01,0,12.024-2.294,16.605-6.875l78.303-78.285  c4.403-4.403,6.887-10.378,6.887-16.611C512.328,252.851,509.845,246.873,505.441,242.47z"},statbox:{path:"M28.782,56.902H483.88c15.707,0,28.451-12.74,28.451-28.451C512.331,12.741,499.599,0,483.885,0H28.782   C13.074,0,0.331,12.741,0.331,28.451C0.331,44.162,13.074,56.902,28.782,56.902zM483.885,136.845H28.782c-15.708,0-28.451,12.741-28.451,28.451c0,15.711,12.744,28.451,28.451,28.451H483.88   c15.707,0,28.451-12.74,28.451-28.451C512.331,149.586,499.599,136.845,483.885,136.845zM483.885,273.275H28.782c-15.708,0-28.451,12.731-28.451,28.452c0,15.707,12.744,28.451,28.451,28.451H483.88   c15.707,0,28.451-12.744,28.451-28.451C512.337,286.007,499.599,273.275,483.885,273.275zM256.065,409.704H30.492c-15.708,0-28.451,12.731-28.451,28.451c0,15.707,12.744,28.451,28.451,28.451h225.585   c15.707,0,28.451-12.744,28.451-28.451C284.516,422.436,271.785,409.704,256.065,409.704z"},circle:{path:"M256,256 m-150,0 a150,150 0 1,0 300,0 a150,150 0 1,0 -300,0"},three_circles:{path:"M256,85 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0  M256,255 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0  M256,425 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0 "},diamand:{path:"M256,0L384,256L256,511L128,256z"},rect:{path:"M90,90h352v352h-352z"},cross:{path:"M80,40l176,176l176,-176l40,40l-176,176l176,176l-40,40l-176,-176l-176,176l-40,-40l176,-176l-176,-176z"},vrgoggles:{size:"245.82 141.73",path:"M175.56,111.37c-22.52,0-40.77-18.84-40.77-42.07S153,27.24,175.56,27.24s40.77,18.84,40.77,42.07S198.08,111.37,175.56,111.37ZM26.84,69.31c0-23.23,18.25-42.07,40.77-42.07s40.77,18.84,40.77,42.07-18.26,42.07-40.77,42.07S26.84,92.54,26.84,69.31ZM27.27,0C11.54,0,0,12.34,0,28.58V110.9c0,16.24,11.54,30.83,27.27,30.83H99.57c2.17,0,4.19-1.83,5.4-3.7L116.47,118a8,8,0,0,1,12.52-.18l11.51,20.34c1.2,1.86,3.22,3.61,5.39,3.61h72.29c15.74,0,27.63-14.6,27.63-30.83V28.58C245.82,12.34,233.93,0,218.19,0H27.27Z"},th2colorz:{recs:[{x:128,y:486,w:256,h:26,f:"rgb(38,62,168)"},{y:461,f:"rgb(22,82,205)"},{y:435,f:"rgb(16,100,220)"},{y:410,f:"rgb(18,114,217)"},{y:384,f:"rgb(20,129,214)"},{y:358,f:"rgb(14,143,209)"},{y:333,f:"rgb(9,157,204)"},{y:307,f:"rgb(13,167,195)"},{y:282,f:"rgb(30,175,179)"},{y:256,f:"rgb(46,183,164)"},{y:230,f:"rgb(82,186,146)"},{y:205,f:"rgb(116,189,129)"},{y:179,f:"rgb(149,190,113)"},{y:154,f:"rgb(179,189,101)"},{y:128,f:"rgb(209,187,89)"},{y:102,f:"rgb(226,192,75)"},{y:77,f:"rgb(244,198,59)"},{y:51,f:"rgb(253,210,43)"},{y:26,f:"rgb(251,230,29)"},{y:0,f:"rgb(249,249,15)"}]},th2color:{recs:[{x:0,y:256,w:13,h:39,f:"rgb(38,62,168)"},{x:13,y:371,w:39,h:39},{y:294,h:39},{y:256,h:39},{y:218,h:39},{x:51,y:410,w:39,h:39},{y:371,h:39},{y:333,h:39},{y:294},{y:256,h:39},{y:218,h:39},{y:179,h:39},{y:141,h:39},{y:102,h:39},{y:64},{x:90,y:448,w:39,h:39},{y:410},{y:371,h:39},{y:333,h:39,f:"rgb(22,82,205)"},{y:294},{y:256,h:39,f:"rgb(16,100,220)"},{y:218,h:39},{y:179,h:39,f:"rgb(22,82,205)"},{y:141,h:39},{y:102,h:39,f:"rgb(38,62,168)"},{y:64},{y:0,h:27},{x:128,y:448,w:39,h:39},{y:410},{y:371,h:39},{y:333,h:39,f:"rgb(22,82,205)"},{y:294,f:"rgb(20,129,214)"},{y:256,h:39,f:"rgb(9,157,204)"},{y:218,h:39,f:"rgb(14,143,209)"},{y:179,h:39,f:"rgb(20,129,214)"},{y:141,h:39,f:"rgb(16,100,220)"},{y:102,h:39,f:"rgb(22,82,205)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{y:0,h:27},{x:166,y:486,h:14},{y:448,h:39},{y:410},{y:371,h:39,f:"rgb(22,82,205)"},{y:333,h:39,f:"rgb(20,129,214)"},{y:294,f:"rgb(82,186,146)"},{y:256,h:39,f:"rgb(179,189,101)"},{y:218,h:39,f:"rgb(116,189,129)"},{y:179,h:39,f:"rgb(82,186,146)"},{y:141,h:39,f:"rgb(14,143,209)"},{y:102,h:39,f:"rgb(16,100,220)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{x:205,y:486,w:39,h:14},{y:448,h:39},{y:410},{y:371,h:39,f:"rgb(16,100,220)"},{y:333,h:39,f:"rgb(9,157,204)"},{y:294,f:"rgb(149,190,113)"},{y:256,h:39,f:"rgb(244,198,59)"},{y:218,h:39},{y:179,h:39,f:"rgb(226,192,75)"},{y:141,h:39,f:"rgb(13,167,195)"},{y:102,h:39,f:"rgb(18,114,217)"},{y:64,f:"rgb(22,82,205)"},{y:26,h:39,f:"rgb(38,62,168)"},{x:243,y:448,w:39,h:39},{y:410},{y:371,h:39,f:"rgb(18,114,217)"},{y:333,h:39,f:"rgb(30,175,179)"},{y:294,f:"rgb(209,187,89)"},{y:256,h:39,f:"rgb(251,230,29)"},{y:218,h:39,f:"rgb(249,249,15)"},{y:179,h:39,f:"rgb(226,192,75)"},{y:141,h:39,f:"rgb(30,175,179)"},{y:102,h:39,f:"rgb(18,114,217)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{x:282,y:448,h:39},{y:410},{y:371,h:39,f:"rgb(18,114,217)"},{y:333,h:39,f:"rgb(14,143,209)"},{y:294,f:"rgb(149,190,113)"},{y:256,h:39,f:"rgb(226,192,75)"},{y:218,h:39,f:"rgb(244,198,59)"},{y:179,h:39,f:"rgb(149,190,113)"},{y:141,h:39,f:"rgb(9,157,204)"},{y:102,h:39,f:"rgb(18,114,217)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{x:320,y:448,w:39,h:39},{y:410},{y:371,h:39,f:"rgb(22,82,205)"},{y:333,h:39,f:"rgb(20,129,214)"},{y:294,f:"rgb(46,183,164)"},{y:256,h:39},{y:218,h:39,f:"rgb(82,186,146)"},{y:179,h:39,f:"rgb(9,157,204)"},{y:141,h:39,f:"rgb(20,129,214)"},{y:102,h:39,f:"rgb(16,100,220)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{x:358,y:448,h:39},{y:410},{y:371,h:39,f:"rgb(22,82,205)"},{y:333,h:39},{y:294,f:"rgb(16,100,220)"},{y:256,h:39,f:"rgb(20,129,214)"},{y:218,h:39,f:"rgb(14,143,209)"},{y:179,h:39,f:"rgb(18,114,217)"},{y:141,h:39,f:"rgb(22,82,205)"},{y:102,h:39,f:"rgb(38,62,168)"},{y:64},{y:26,h:39},{x:397,y:448,w:39,h:39},{y:371,h:39},{y:333,h:39},{y:294,f:"rgb(22,82,205)"},{y:256,h:39},{y:218,h:39},{y:179,h:39,f:"rgb(38,62,168)"},{y:141,h:39},{y:102,h:39},{y:64},{y:26,h:39},{x:435,y:410,h:39},{y:371,h:39},{y:333,h:39},{y:294},{y:256,h:39},{y:218,h:39},{y:179,h:39},{y:141,h:39},{y:102,h:39},{y:64},{x:474,y:256,h:39},{y:179,h:39}]},th2draw3d:{path:"M172.768,0H51.726C23.202,0,0.002,23.194,0.002,51.712v89.918c0,28.512,23.2,51.718,51.724,51.718h121.042   c28.518,0,51.724-23.2,51.724-51.718V51.712C224.486,23.194,201.286,0,172.768,0z M177.512,141.63c0,2.611-2.124,4.745-4.75,4.745   H51.726c-2.626,0-4.751-2.134-4.751-4.745V51.712c0-2.614,2.125-4.739,4.751-4.739h121.042c2.62,0,4.75,2.125,4.75,4.739 L177.512,141.63L177.512,141.63z M460.293,0H339.237c-28.521,0-51.721,23.194-51.721,51.712v89.918c0,28.512,23.2,51.718,51.721,51.718h121.045   c28.521,0,51.721-23.2,51.721-51.718V51.712C512.002,23.194,488.802,0,460.293,0z M465.03,141.63c0,2.611-2.122,4.745-4.748,4.745   H339.237c-2.614,0-4.747-2.128-4.747-4.745V51.712c0-2.614,2.133-4.739,4.747-4.739h121.045c2.626,0,4.748,2.125,4.748,4.739 V141.63z M172.768,256.149H51.726c-28.524,0-51.724,23.205-51.724,51.726v89.915c0,28.504,23.2,51.715,51.724,51.715h121.042   c28.518,0,51.724-23.199,51.724-51.715v-89.915C224.486,279.354,201.286,256.149,172.768,256.149z M177.512,397.784   c0,2.615-2.124,4.736-4.75,4.736H51.726c-2.626-0.006-4.751-2.121-4.751-4.736v-89.909c0-2.626,2.125-4.753,4.751-4.753h121.042 c2.62,0,4.75,2.116,4.75,4.753L177.512,397.784L177.512,397.784z M460.293,256.149H339.237c-28.521,0-51.721,23.199-51.721,51.726v89.915c0,28.504,23.2,51.715,51.721,51.715h121.045   c28.521,0,51.721-23.199,51.721-51.715v-89.915C512.002,279.354,488.802,256.149,460.293,256.149z M465.03,397.784   c0,2.615-2.122,4.736-4.748,4.736H339.237c-2.614,0-4.747-2.121-4.747-4.736v-89.909c0-2.626,2.121-4.753,4.747-4.753h121.045 c2.615,0,4.748,2.116,4.748,4.753V397.784z"},createSVG(z,m,I,A,R){const k=!0===R||!1===R?R:v.settings.DarkMode,ee="browser"===R?v.browser.touches?.2:0:k?.8:.2,ge=z.append("svg:svg").attr("width",I+"px").attr("height",I+"px").attr("viewBox","0 0 512 512").style("overflow","hidden").style("cursor","pointer").style("fill",k?"rgba(255, 224, 160)":"steelblue").style("opacity",ee).property("opacity0",ee).property("opacity1",k?1:.8).on("mouseenter",function(){const ve=(0,V.Lt)(this);ve.style("opacity",ve.property("opacity1"));const Se=ve.node()._mouseenter;(0,v.isFunc)(Se)&&Se()}).on("mouseleave",function(){const ve=(0,V.Lt)(this);ve.style("opacity",ve.property("opacity0"));const Se=ve.node()._mouseleave;(0,v.isFunc)(Se)&&Se()});if("recs"in m){const ve={};for(let Se=0;Se<m.recs.length;++Se)Object.assign(ve,m.recs[Se]),ge.append("rect").attr("x",ve.x).attr("y",ve.y).attr("width",ve.w).attr("height",ve.h).style("fill",ve.f)}else ge.append("svg:path").attr("d",m.path);return ge.append("svg:rect").attr("x",0).attr("y",0).attr("width",512).attr("height",512).style("opacity",0).style("fill","none").style("pointer-events","visibleFill").append("svg:title").text(A),ge}};function L(z,m){if(!z||(0,v.isBatchMode)()||typeof window>"u"||typeof document>"u")return;let I=null,A=m||300;function R(){if(I=null,document.body.style.cursor="wait",(0,v.isFunc)(z))z();else if((0,v.isFunc)(z?.checkResize))z.checkResize();else{const k=new Le.b8(z).selectDom();if(!k.empty()){const ee=k.property("mdi");(0,v.isFunc)(ee?.checkMDIResize)?ee.checkMDIResize():(0,xe.XR)(k.node())}}document.body.style.cursor="auto"}A<20&&(A=20),window.addEventListener("resize",()=>{null!==I&&clearTimeout(I),I=setTimeout(R,A)})}function he(z){return 2===z?.buttons||2===z?.button}function re(z,m=!0){if(!v.settings.MoveResize||z.isBatchMode()||!z.draw_g)return;if(!1===z.getPadPainter()?.isEditable()&&(m=!1),!m){if(z.draw_g.property("assigned_move")){const k=(0,V.$E)().subject(Object);k.on("start",null).on("drag",null).on("end",null),z.draw_g.style("cursor",null).property("assigned_move",null).call(k)}return}if(z.draw_g.property("assigned_move"))return;const I=(0,V.$E)().subject(Object);let A=!0,R=!1;I.on("start",function(k){if(R=!!this.moveEnabled&&!this.moveEnabled(),R||he(k.sourceEvent))return;k.sourceEvent.preventDefault(),k.sourceEvent.stopPropagation();const ee=(0,V.Wn)(k,this.draw_g.node());A=!0,this.moveStart&&this.moveStart(ee[0],ee[1])}.bind(z)).on("drag",function(k){R||(k.sourceEvent.preventDefault(),k.sourceEvent.stopPropagation(),A=!1,this.moveDrag&&this.moveDrag(k.dx,k.dy))}.bind(z)).on("end",function(k){if(R)return;k.sourceEvent.preventDefault(),k.sourceEvent.stopPropagation(),this.moveEnd&&this.moveEnd(A);let ee=null;if(A){const ge=(0,V.Wn)(k,this.draw_g.node());ee={x:ge[0],y:ge[1],dbl:!1}}this.getPadPainter()?.selectObjectPainter(this,ee)}.bind(z)),z.draw_g.style("cursor","move").property("assigned_move",!0).call(I)}function fe(z,m,I){if((0,v.isBatchMode)()||!z||typeof document>"u")return!0;const A=(m||document).getElementsByTagName("style");for(let k=0;k<A.length;++k){if(I&&A[k].getAttribute("tag")===I)return A[k].innerHTML=z,!0;if(A[k].innerHTML===z)return!0}const R=document.createElement("style");return I&&R.setAttribute("tag",I),R.innerHTML=z,(m||document.head).appendChild(R),!0}function de(z){switch(v.gStyle.fName=z,z){case"Modern":Object.assign(v.gStyle,{fFrameBorderMode:0,fFrameFillColor:0,fCanvasBorderMode:0,fCanvasColor:0,fPadBorderMode:0,fPadColor:0,fStatColor:0,fTitleAlign:23,fTitleX:.5,fTitleBorderSize:0,fTitleColor:0,fTitleStyle:0,fOptStat:1111,fStatY:.935,fLegendBorderSize:1,fLegendFont:42,fLegendTextSize:0,fLegendFillColor:0});break;case"Plain":Object.assign(v.gStyle,{fFrameBorderMode:0,fCanvasBorderMode:0,fPadBorderMode:0,fPadColor:0,fCanvasColor:0,fTitleColor:0,fTitleBorderSize:0,fStatColor:0,fStatBorderSize:1,fLegendBorderSize:1});break;case"Bold":Object.assign(v.gStyle,{fCanvasColor:10,fCanvasBorderMode:0,fFrameLineWidth:3,fFrameFillColor:10,fPadColor:10,fPadTickX:1,fPadTickY:1,fPadBottomMargin:.15,fPadLeftMargin:.15,fTitleColor:10,fTitleTextColor:600,fStatColor:10})}}let pe="jsroot_";function K(z,m,I){typeof localStorage>"u"||(Number.isFinite(m)&&m<0?localStorage.removeItem(pe+I):localStorage.setItem(pe+I,(0,v.btoa_func)(JSON.stringify(z))))}function D(z=365,m="settings"){K(v.settings,z,m)}function x(z=!1,m="settings"){const I=function G(z){if(typeof localStorage>"u")return null;const m=localStorage.getItem(pe+z),I=m?JSON.parse((0,v.atob_func)(m)):null;return(0,v.isObject)(I)?I:null}(m);return!!I&&(z||Object.assign(v.settings,I),!0)}function P(z=365,m="style"){K(v.gStyle,z,m)}let b=null;function g(z){if(0===z.indexOf("data:image/svg+xml;charset=utf-8,"))return decodeURIComponent(z.slice(33));if(0===z.indexOf("data:image/")){const I=z.indexOf("base64,");if(I>0){const A=z.slice(I+7);return(0,v.atob_func)(A)}}return z}function C(z,m){return N.apply(this,arguments)}function N(){return(N=(0,be.A)(function*(z,m){if((0,v.isFunc)(b))return b(z,g(m));if((0,v.isNodeJs)())return Te.e(756).then(Te.t.bind(Te,9756,19)).then(I=>(I.writeFileSync(z,g(m)),!0));if(typeof document<"u"){const I=document.createElement("a");return I.download=z,I.href=m,document.body.appendChild(I),new Promise(A=>{I.addEventListener("click",()=>{I.parentNode.removeChild(I),A(!0)}),I.click()})}return!1})).apply(this,arguments)}function H(z){const m=(0,Je.HG)();let I=-1;if((0,v.isStr)(z)){if(z&&"none"!==z){for(let A=1;A<m.length;++A)if(m[A]===z){I=A;break}}else I=0;I<0&&0===z.indexOf("rgb")&&(I=9999)}else Number.isInteger(z)&&m[z]&&(I=z,z=m[I]);return{id:I,col:z}}function X(z,m){const I=H(z);if(I.id<0)return"";if(I.id>=50){const A=(0,V.yW)(I.col);I.id=`TColor::GetColor(${A.r},${A.g},${A.b})`}return`exec:${m}(${I.id})`}function ie(z,m,I,A){if(A){const k=H(I);if(k.id<0||9999===k.id)return;I=k.id}const R=z?.getObject();R&&void 0!==R[m]&&(R[m]=I)}},3752:(Gr,xt,Te)=>{"use strict";Te.r(xt),Te.d(xt,{TH1Painter:()=>st});var be=Te(5774),v=Te(4186),V=Te(7387),Le=Te(6856),xe=Te(2105),Je=Te(1194);class st extends Je.N{draw3D(ot){this.mode3d=!0;const Re=this.getFramePainter(),Qe=this.isMainPainter(),Ie=this.getHisto(),L=1+2*v.gStyle.fHistTopMargin;let he=Promise.resolve(!0);return"resize"===ot?Qe&&Re.resize3D()&&Re.render3D():(this.createHistDrawAttributes(!0),this.scanContent(!0),Qe&&((0,V.wx)(Re),he=Re.create3DScene(this.options.Render3D,this.options.x3dscale,this.options.y3dscale,this.options.Ortho).then(()=>{Re.setAxesRanges(Ie.fXaxis,this.xmin,this.xmax,Ie.fYaxis,this.ymin,this.ymax,Ie.fZaxis,0,0,this),Re.set3DOptions(this.options),Re.drawXYZ(Re.toplevel,Le.TB,{use_y_for_z:!0,zmult:L,zoom:v.settings.Zooming,ndim:1,draw:-1!==this.options.Axis,drawany:this.options.isCartesian()})})),Re.mode3d&&(he=he.then(()=>{(0,V.CS)(this),Re.render3D(),this.updateStatWebCanvas(),Re.addKeysHandler()}))),Qe&&(he=he.then(()=>this.drawColorPalette(this.options.Zscale&&(12===this.options.Lego||14===this.options.Lego)))),he.then(()=>this.updateFunctions()).then(()=>this.updateHistTitle()).then(()=>this)}static draw(ot,Re,Qe){return(0,be.A)(function*(){return xe.mf._drawHist(new st(ot,Re),Qe)})()}}},4862:(Gr,xt,Te)=>{"use strict";Te.r(xt),Te.d(xt,{TH2Painter:()=>Re});var be=Te(5774),v=Te(4186),V=Te(5225),Le=Te(2009),xe=Te(7387),Je=Te(6856),st=Te(2105),Ke=Te(1631);class Re extends Ke.AJ{draw3D(Ie){var L=this;return(0,be.A)(function*(){L.mode3d=!0;const he=L.getFramePainter(),re=L.isMainPainter(),fe=L.getHisto();let de=Promise.resolve(!0);if("resize"===Ie)re&&he.resize3D()&&he.render3D();else{const pe=L.getPadPainter().getRootPad(!0),ce=pe?.fLogv??pe?.fLogz;let K=1;L.options.minimum!==v.kNoZoom&&L.options.maximum!==v.kNoZoom?(L.zmin=L.options.minimum,L.zmax=L.options.maximum):(L.draw_content||0!==L.gmaxbin)&&(L.zmin=ce?.3*L.gminposbin:L.gminbin,L.zmax=L.gmaxbin,K=1+2*v.gStyle.fHistTopMargin),ce&&L.zmin<=0&&(L.zmin=1e-5*L.zmax),L.createHistDrawAttributes(!0),re&&((0,xe.wx)(he),de=he.create3DScene(L.options.Render3D,L.options.x3dscale,L.options.y3dscale,L.options.Ortho).then(()=>{he.setAxesRanges(fe.fXaxis,L.xmin,L.xmax,fe.fYaxis,L.ymin,L.ymax,fe.fZaxis,L.zmin,L.zmax,L),he.set3DOptions(L.options),he.drawXYZ(he.toplevel,Je.TB,{zmult:K,zoom:v.settings.Zooming,ndim:2,draw:-1!==L.options.Axis,drawany:L.options.isCartesian(),reverse_x:L.options.RevX,reverse_y:L.options.RevY})})),he.mode3d&&(de=de.then(()=>{L.draw_content?L.isTH2Poly()?function ot(Qe){const Ie=Qe.getHisto(),L=Qe.getFramePainter(),he=L.z_handle.getScaleMin(),re=L.z_handle.getScaleMax(),fe=Ie.fBins.arr.length,de=L.grz(he);let pe,ce,K,G;Qe.maxbin=Qe.gmaxbin,Qe.minbin=Qe.gminbin,Qe.minposbin=Qe.gminposbin;const D=Qe.getContour(!0),x=Qe.getHistPalette();for(K=0;K<fe;++K){if(ce=Ie.fBins.arr[K],ce.fContent<he||(pe=D.getPaletteIndex(x,ce.fContent),null===pe)||ce.fXmin>L.scale_xmax||ce.fXmax<L.scale_xmin||ce.fYmin>L.scale_ymax||ce.fYmax<L.scale_ymin)continue;G=L.grz(ce.fContent>re?re:ce.fContent);const P=[],w=[];let b=1,g=ce.fPoly,C=0;g._typename===v.clTMultiGraph&&(b=ce.fPoly.fGraphs.arr.length,g=null);for(let z=0;z<b;++z){(!g||z>0)&&(g=ce.fPoly.fGraphs.arr[z]);const m=g.fX,I=g.fY;let R,k,A=g.fNpoints;for(;A>2&&m[0]===m[A-1]&&I[0]===I[A-1];)--A;for(let ee=0;ee<2;++ee){let ge,ve,Se,De,Xe=L.size_x3d*L.size_z3d;const ct=ee>0?0:Xe/1e6;R=[],k=null;for(let $=0;$<A;++$)Se=L.grx(m[$]),De=L.gry(I[$]),$>0&&(Xe=(Se-ge)*(Se-ge)+(De-ve)*(De-ve)),Xe>ct&&(R.push(new V.I9Y(Se,De)),ge=Se,ve=De);try{R.length>2&&(k=V.xJ6.triangulateShape(R,[]))}catch{k=null}if(k&&k.length>R.length-3)break}k?.length&&R&&(P.push(R),w.push(k),C+=2*k.length,G>de&&(C+=2*R.length))}const N=new Float32Array(9*C);let O=0;for(let z=0;z<P.length;++z){const m=P[z],I=w[z];for(let A=0;A<2;++A)for(let R=0;R<I.length;++R){const k=I[R],ee=m[k[0]],ge=m[k[0===A?2:1]],ve=m[k[0===A?1:2]];N[O]=ee.x,N[O+1]=ee.y,N[O+2]=A?G:de,O+=3,N[O]=ge.x,N[O+1]=ge.y,N[O+2]=A?G:de,O+=3,N[O]=ve.x,N[O+1]=ve.y,N[O+2]=A?G:de,O+=3}if(G>de)for(let A=0;A<m.length;++A){const R=m[A],k=m[A>0?A-1:m.length-1];N[O]=R.x,N[O+1]=R.y,N[O+2]=de,O+=3,N[O]=k.x,N[O+1]=k.y,N[O+2]=de,O+=3,N[O]=k.x,N[O+1]=k.y,N[O+2]=G,O+=3,N[O]=R.x,N[O+1]=R.y,N[O+2]=de,O+=3,N[O]=k.x,N[O+1]=k.y,N[O+2]=G,O+=3,N[O]=R.x,N[O+1]=R.y,N[O+2]=G,O+=3}}const H=new V.LoY;H.setAttribute("position",new V.THS(N,3)),H.computeVertexNormals();const X=new V.V9B((0,Le.Bx)(Qe._color_palette?.getColor(pe),{vertexColors:!1})),ie=new V.eaF(H,X);L.add3DMesh(ie),ie.painter=Qe,ie.bins_index=K,ie.draw_z0=de,ie.draw_z1=G,ie.tip_color=65280,ie.tooltip=function(){const z=this.painter,m=z.getFramePainter(),I=z.getObject().fBins.arr[this.bins_index];return{use_itself:!0,x1:m.grx(I.fXmin),x2:m.grx(I.fXmax),y1:m.gry(I.fYmin),y2:m.gry(I.fYmax),z1:this.draw_z0,z2:this.draw_z1,bin:this.bins_index,value:I.fContent,color:this.tip_color,lines:z.getPolyBinTooltips(this.bins_index)}}}}(L):L.options.Contour?(0,xe.SF)(L,!0):L.options.Surf?(0,xe.u$)(L):L.options.Error?(0,xe.s6)(L):(0,xe.CS)(L):L.options.Axis&&L.options.Zscale&&(L.getContourLevels(!0),L.getHistPalette()),he.render3D(),L.updateStatWebCanvas(),he.addKeysHandler()}))}return re&&(de=de.then(()=>L.drawColorPalette(L.options.Zscale&&(12===L.options.Lego||14===L.options.Lego||11===L.options.Surf||12===L.options.Surf)))),de.then(()=>L.updateFunctions()).then(()=>L.updateHistTitle()).then(()=>L)})()}static draw(Ie,L,he){return(0,be.A)(function*(){return st.mf._drawHist(new Re(Ie,L),he)})()}}},5074:(Gr,xt,Te)=>{"use strict";Te.r(xt),Te.d(xt,{TH3Painter:()=>Qe});var be=Te(5774),v=Te(4186),V=Te(5225),Le=Te(165),xe=Te(2725),Je=Te(6856),st=Te(2009),Ke=Te(2105),ot=Te(7387),Re=Te(9489);class Qe extends Ke.mf{getDimension(){return 3}scanContent(L){if(L&&this.nbinsx&&this.nbinsy&&this.nbinsz)return;const he=this.getHisto();this.extractAxesProperties(3),this.gminbin=this.gmaxbin=he.getBinContent(1,1,1),this.gminposbin=null;for(let re=0;re<this.nbinsx;++re)for(let fe=0;fe<this.nbinsy;++fe)for(let de=0;de<this.nbinsz;++de){const pe=he.getBinContent(re+1,fe+1,de+1);pe<this.gminbin?this.gminbin=pe:pe>this.gmaxbin&&(this.gmaxbin=pe),pe>0&&(null===this.gminposbin||this.gminposbin>pe)&&(this.gminposbin=pe)}null===this.gminposbin&&this.gmaxbin>0&&(this.gminposbin=1e-4*this.gmaxbin),this.draw_content=0!==this.gmaxbin||0!==this.gminbin,this.transferFunc=this.findFunction(v.clTF1,"TransferFunction"),this.transferFunc&&!this.transferFunc.TestBit((0,v.BIT)(9))&&this.transferFunc.InvertBit((0,v.BIT)(9))}countStat(L,he){const re=this.getHisto(),fe=re.fXaxis,de=re.fYaxis,pe=re.fZaxis,ce=this.getSelectIndex("x","left"),K=this.getSelectIndex("x","right"),G=this.getSelectIndex("y","left"),D=this.getSelectIndex("y","right"),x=this.getSelectIndex("z","left"),P=this.getSelectIndex("z","right"),w=this.getFramePainter(),b={name:re.fName,entries:0,eff_entries:0,integral:0,meanx:0,meany:0,meanz:0,rmsx:0,rmsy:0,rmsz:0,skewx:0,skewy:0,skewz:0,skewd:0,kurtx:0,kurty:0,kurtz:0,kurtd:0},g=Math.abs(re.fTsumw)>1e-300&&!w.isAxisZoomed("x")&&!w.isAxisZoomed("y")&&!w.isAxisZoomed("z");let C,N,O,H,X,ie,z,m,I,A,R=0,k=0,ee=0,ge=0,ve=0,Se=0,De=0,Xe=0;for((0,v.isFunc)(L)||(L=null),C=0;C<this.nbinsx+2;++C)for(H=fe.GetBinCoord(C-.5),X=C<ce?0:C>K?2:1,N=0;N<this.nbinsy+2;++N)for(ie=de.GetBinCoord(N-.5),z=N<G?0:N>D?2:1,O=0;O<this.nbinsz+2;++O)m=pe.GetBinCoord(O-.5),I=O<x?0:O>P?2:1,(!L||L(H,ie,m))&&(A=re.getBinContent(C,N,O),b.entries+=A,!g&&1===X&&1===z&&1===I&&(R+=A,k+=A*A,ee+=H*A,ge+=ie*A,ve+=m*A,Se+=H**2*A,De+=ie**2*A,Xe+=m**2*A));if(g&&(R=re.fTsumw,k=re.fTsumw2,ee=re.fTsumwx,Se=re.fTsumwx2,ge=re.fTsumwy,De=re.fTsumwy2,ve=re.fTsumwz,Xe=re.fTsumwz2),Math.abs(R)>1e-300&&(b.meanx=ee/R,b.meany=ge/R,b.meanz=ve/R,b.rmsx=Math.sqrt(Math.abs(Se/R-b.meanx*b.meanx)),b.rmsy=Math.sqrt(Math.abs(De/R-b.meany*b.meany)),b.rmsz=Math.sqrt(Math.abs(Xe/R-b.meanz*b.meanz))),b.integral=R,re.fEntries>1&&(b.entries=re.fEntries),b.eff_entries=k?R*R/k:Math.abs(R),he&&!this.isTH2Poly()){let ct=0,$=0,tt=0,We=0,Ne=0,Fe=0,ht=0,pt=0;for(let fn=ce;fn<K;++fn){H=fe.GetBinCoord(fn+.5);for(let ln=G;ln<D;++ln){ie=de.GetBinCoord(ln+.5);for(let mn=x;mn<P;++mn)m=pe.GetBinCoord(mn+.5),(!L||L(H,ie,m))&&(pt=re.getBinContent(fn+1,ln+1,mn+1),ht+=pt,ct+=pt*Math.pow(H-b.meanx,3),$+=pt*Math.pow(ie-b.meany,3),tt+=pt*Math.pow(m-b.meany,3),We+=pt*Math.pow(H-b.meanx,4),Ne+=pt*Math.pow(ie-b.meany,4),Fe+=pt*Math.pow(ie-b.meany,4))}}const dt=Math.pow(b.rmsx,3),rt=Math.pow(b.rmsy,3),_t=Math.pow(b.rmsz,3),Yt=Math.pow(b.rmsx,4),kt=Math.pow(b.rmsy,4),Tt=Math.pow(b.rmsz,4);ht*dt!=0&&(b.skewx=ct/(ht*dt)),ht*rt!=0&&(b.skewy=$/(ht*rt)),ht*_t!=0&&(b.skewz=tt/(ht*_t)),b.skewd=b.eff_entries>0?Math.sqrt(6/b.eff_entries):0,ht*Yt!=0&&(b.kurtx=We/(ht*Yt)-3),ht*kt!=0&&(b.kurty=Ne/(ht*kt)-3),ht*Tt!=0&&(b.kurtz=Fe/(ht*Tt)-3),b.kurtd=b.eff_entries>0?Math.sqrt(24/b.eff_entries):0}return b}fillStatistic(L,he,re){if(this.isIgnoreStatsFill())return!1;1===he&&(he=1111);const fe=he%10,de=Math.floor(he/10)%10,pe=Math.floor(he/100)%10,ce=Math.floor(he/1e3)%10,K=Math.floor(he/1e6)%10,G=Math.floor(he/1e7)%10,D=Math.floor(he/1e8)%10,x=this.countStat(void 0,G>0||D>0);return L.clearPave(),fe>0&&L.addText(x.name),de>0&&L.addText("Entries = "+L.format(x.entries,"entries")),pe>0&&(L.addText("Mean x = "+L.format(x.meanx)),L.addText("Mean y = "+L.format(x.meany)),L.addText("Mean z = "+L.format(x.meanz))),ce>0&&(L.addText("Std Dev x = "+L.format(x.rmsx)),L.addText("Std Dev y = "+L.format(x.rmsy)),L.addText("Std Dev z = "+L.format(x.rmsz))),K>0&&L.addText("Integral = "+L.format(x.integral,"entries")),2===G?(L.addText(`Skewness x = ${L.format(x.skewx)} #pm ${L.format(x.skewd)}`),L.addText(`Skewness y = ${L.format(x.skewy)} #pm ${L.format(x.skewd)}`),L.addText(`Skewness z = ${L.format(x.skewz)} #pm ${L.format(x.skewd)}`)):G>0&&(L.addText(`Skewness x = ${L.format(x.skewx)}`),L.addText(`Skewness y = ${L.format(x.skewy)}`),L.addText(`Skewness z = ${L.format(x.skewz)}`)),2===D?(L.addText(`Kurtosis x = ${L.format(x.kurtx)} #pm ${L.format(x.kurtd)}`),L.addText(`Kurtosis y = ${L.format(x.kurty)} #pm ${L.format(x.kurtd)}`),L.addText(`Kurtosis z = ${L.format(x.kurtz)} #pm ${L.format(x.kurtd)}`)):D>0&&(L.addText(`Kurtosis x = ${L.format(x.kurtx)}`),L.addText(`Kurtosis y = ${L.format(x.kurty)}`),L.addText(`Kurtosis z = ${L.format(x.kurtz)}`)),re&&L.fillFunctionStat(this.findFunction(v.clTF3),re,3),!0}getBinTooltips(L,he,re){const fe=[],de=this.getHisto();fe.push(this.getObjectHint(),`x = ${this.getAxisBinTip("x",de.fXaxis,L)}  xbin=${L+1}`,`y = ${this.getAxisBinTip("y",de.fYaxis,he)}  ybin=${he+1}`,`z = ${this.getAxisBinTip("z",de.fZaxis,re)}  zbin=${re+1}`);const pe=de.getBinContent(L+1,he+1,re+1);if(pe===Math.round(pe)?fe.push(`entries = ${pe}`):fe.push(`entries = ${(0,Le.lg)(pe,v.gStyle.fStatFormat)}`),this.matchObjectType(v.clTProfile3D)){const ce=de.getBinError(de.getBin(L+1,he+1,re+1));fe.push("error = "+(ce===Math.round(ce)?ce.toString():(0,Le.lg)(ce,v.gStyle.fPaintTextFormat)))}return fe}draw3DScatter(){const L=this.getObject(),he=this.getFramePainter(),re=this.getSelectIndex("x","left",.5),fe=this.getSelectIndex("x","right",0),de=this.getSelectIndex("y","left",.5),pe=this.getSelectIndex("y","right",0),ce=this.getSelectIndex("z","left",.5),K=this.getSelectIndex("z","right",0);let G,D,x,P;if(fe<=re||pe<=de||K<=ce)return Promise.resolve(!0);const w=this.gmaxbin>1e3?1e3/this.gmaxbin:1,b=Math.max(0,this.gminbin);let g=0,C=0;for(G=re;G<fe;++G)for(D=de;D<pe;++D)for(x=ce;x<K;++x)P=L.getBinContent(G+1,D+1,x+1),C+=P,!(P<=b)&&(g+=Math.round(P*w));if(g>(he.webgl?1e5:3e4))return!1;const N=new st._l(g,he.webgl,he.size_x3d/200),O=new Int32Array(g),H=new Le.YF(C);let X=0;for(G=re;G<fe;++G)for(D=de;D<pe;++D)for(x=ce;x<K;++x){if(P=L.getBinContent(G+1,D+1,x+1),P<=b)continue;const ie=Math.round(P*w);for(let z=0;z<ie;++z){const m=L.fXaxis.GetBinCoord(G+H.random()),I=L.fYaxis.GetBinCoord(D+H.random()),A=L.fZaxis.GetBinCoord(x+H.random());O[X++]=L.getBin(G+1,D+1,x+1),N.addPoint(he.grx(m),he.gry(I),he.grz(A))}}return N.createPoints({color:this.getColor(L.fMarkerColor)}).then(ie=>(he.add3DMesh(ie),ie.bins=O,ie.painter=this,ie.tip_color=3===L.fMarkerColor?16711680:65280,ie.tooltip=function(z){const m=Math.floor(z.index/this.nvertex);if(m<0||m>=this.bins.length)return null;const I=this.painter,A=I.getHisto(),R=I.getFramePainter(),k=I.get3DToolTip(this.bins[m]);return k.x1=R.grx(A.fXaxis.GetBinLowEdge(k.ix)),k.x2=R.grx(A.fXaxis.GetBinLowEdge(k.ix+1)),k.y1=R.gry(A.fYaxis.GetBinLowEdge(k.iy)),k.y2=R.gry(A.fYaxis.GetBinLowEdge(k.iy+1)),k.z1=R.grz(A.fZaxis.GetBinLowEdge(k.iz)),k.z2=R.grz(A.fZaxis.GetBinLowEdge(k.iz+1)),k.color=this.tip_color,k.opacity=.3,k},!0))}draw3DBins(){var L=this;return(0,be.A)(function*(){if(!L.draw_content)return!1;let he=L.options.Box?L.options.BoxStyle:0;if(!he&&L.options.Scat){const jt=L.draw3DScatter();if(!1!==jt)return jt;he=12}else!he&&!L.options.GLBox&&!L.options.GLColor&&!L.options.Lego&&(he=12);const re=L.getHisto(),fe=L.getFramePainter();let b,g,de=0,pe=!1,ce=!1,K=!1,G=1,D=-1,x=L.getPadPainter()?.getRootPad()?.fLogv,P=!0,w=0,C=L.getColor(re.fFillColor),N=.5;if(!he&&L.options.Lego&&(he=1===L.options.Lego?10:L.options.Lego),11===L.options.GLBox||12===L.options.GLBox){N=.4,pe=!0,12===L.options.GLBox&&(K=!0);const jt=fe.webgl?new V.Gu$(.5,16,12):new V.Gu$(.5,8,6);jt.applyMatrix4((new V.kn4).makeRotationX(Math.PI/2)),jt.computeVertexNormals();const Sn=jt.getIndex().array,cn=jt.getAttribute("position").array,gn=jt.getAttribute("normal").array;de=3*Sn.length,b=new Float32Array(de),g=new Float32Array(de);for(let Cn=0;Cn<Sn.length;++Cn){const Ln=3*Sn[Cn];b[3*Cn]=cn[Ln],b[3*Cn+1]=cn[Ln+1],b[3*Cn+2]=cn[Ln+2],g[3*Cn]=gn[Ln],g[3*Cn+1]=gn[Ln+1],g[3*Cn+2]=gn[Ln+2]}}else{const jt=st.DJ.Indexes,Sn=st.DJ.Normals,cn=st.DJ.Vertices;de=3*jt.length,b=new Float32Array(de),g=new Float32Array(de);for(let gn=0,Cn=-3;gn<jt.length;++gn){const Ln=cn[jt[gn]];b[3*gn]=Ln.x-.5,b[3*gn+1]=Ln.y-.5,b[3*gn+2]=Ln.z-.5,gn%6==0&&(Cn+=3),g[3*gn]=Sn[Cn],g[3*gn+1]=Sn[Cn+1],g[3*gn+2]=Sn[Cn+2]}ce=!0,12===he?K=!0:13===he?(K=!0,ce=!1):L.options.GLColor&&(K=!0,G=.5,P=!1,ce=!1,D=0,pe=!0)}L._box_option=he,P&&x?L.gminposbin&&L.gmaxbin>L.gminposbin?(w=Math.log(L.gminposbin)-.1,P=1/(Math.log(L.gmaxbin)-w)):(x=0,P=1):P&&(P=L.gminbin||L.gmaxbin?1/Math.max(Math.abs(L.gminbin),Math.abs(L.gmaxbin)):1);const O=jt=>{if(D>=0&&jt<D)return 0;if(!P)return 1;if(x){if(jt<=0)return 0;jt=Math.log(jt)-w}return Math.pow(Math.abs(jt*P),.3333)},H=L.getSelectIndex("x","left",.5),X=L.getSelectIndex("x","right",0),ie=L.getSelectIndex("y","left",.5),z=L.getSelectIndex("y","right",0),m=L.getSelectIndex("z","left",.5),I=L.getSelectIndex("z","right",0);if(X<=H||z<=ie||I<=m)return!1;const A={},R={},k=K?L.getContour():null,ee=K?L.getHistPalette():null;let ve,Se,De,Xe,ct,ge=0,$=0,tt=null;L.transferFunc&&(0,Re.Dx)(L.transferFunc,!0)&&(tt=L.transferFunc);const We=jt=>{const Sn=3*(0,Re.rr)(tt,ct,!1);return!Sn||Sn<0||Sn>=1?jt:jt+1e4*Math.round(200*Sn)};for(ve=H;ve<X;++ve)for(Se=ie;Se<z;++Se)for(De=m;De<I;++De){if(ct=re.getBinContent(ve+1,Se+1,De+1),!L.options.GLColor&&(0===ct||ct<L.gminbin)||(Xe=O(ct),Xe<.001)||(ge++,!K))continue;let jt=k.getPaletteIndex(ee,ct);null!==jt?(tt&&(jt=We(jt)),void 0===A[jt]&&(A[jt]=0,R[jt]=$++),A[jt]+=1):console.error(`not found color for value = ${ct}`)}K||(A[0]=ge,$=1,R[0]=0);const Ne=new Array($),Fe=new Array($),ht=new Array($),pt=new Array($),dt=new Array($),rt=new Array($),_t=new Array($);for(const jt in A){ge=A[jt];const Sn=R[jt];Ne[Sn]=dt[Sn]=0,ce&&(dt[Sn]=ge*de/3>65520?2:1),Fe[Sn]=new Float32Array(ge*de),ht[Sn]=new Float32Array(ge*de),pt[Sn]=new Int32Array(ge),1===dt[Sn]&&(rt[Sn]=new Uint16Array(ge*st.DJ.MeshSegments.length)),2===dt[Sn]&&(_t[Sn]=new Float32Array(ge*st.DJ.Segments.length*3))}let Yt,kt,Tt,fn,ln,mn;for(ve=H;ve<X;++ve)for(Yt=fe.grx(re.fXaxis.GetBinLowEdge(ve+1)),kt=fe.grx(re.fXaxis.GetBinLowEdge(ve+2)),Se=ie;Se<z;++Se)for(Tt=fe.gry(re.fYaxis.GetBinLowEdge(Se+1)),fn=fe.gry(re.fYaxis.GetBinLowEdge(Se+2)),De=m;De<I;++De){if(ct=re.getBinContent(ve+1,Se+1,De+1),!L.options.GLColor&&(0===ct||ct<L.gminbin)||(Xe=O(ct),Xe<.001))continue;let jt=0;if(K){let Cn=k.getPaletteIndex(ee,ct);if(null===Cn)continue;tt&&(Cn=We(Cn)),jt=R[Cn]}ge=Ne[jt],ln=fe.grz(re.fZaxis.GetBinLowEdge(De+1)),mn=fe.grz(re.fZaxis.GetBinLowEdge(De+2)),pt[jt][ge]=re.getBin(ve+1,Se+1,De+1);const Sn=Fe[jt],cn=ht[jt];let gn=ge*de;for(let Cn=0;Cn<de;Cn+=3,gn+=3)Sn[gn]=(kt+Yt)/2+b[Cn]*(kt-Yt)*Xe,Sn[gn+1]=(fn+Tt)/2+b[Cn+1]*(fn-Tt)*Xe,Sn[gn+2]=(mn+ln)/2+b[Cn+2]*(mn-ln)*Xe,cn[gn]=g[Cn],cn[gn+1]=g[Cn+1],cn[gn+2]=g[Cn+2];if(1===dt[jt]){const Cn=st.DJ.MeshSegments;gn=ge*Cn.length;const Ln=Math.round(ge*de/3),Zn=rt[jt];for(let ui=0;ui<Cn.length;++ui)Zn[gn+ui]=Ln+Cn[ui]}if(2===dt[jt]){const Cn=st.DJ.Segments,Ln=_t[jt];gn=ge*Cn.length*3;for(let Zn=0;Zn<Cn.length;++Zn,gn+=3){const ui=st.DJ.Vertices[Cn[Zn]];Ln[gn]=(kt+Yt)/2+(ui.x-.5)*(kt-Yt)*Xe,Ln[gn+1]=(fn+Tt)/2+(ui.y-.5)*(fn-Tt)*Xe,Ln[gn+2]=(mn+ln)/2+(ui.z-.5)*(mn-ln)*Xe}}Ne[jt]=ge+1}for(const jt in A){const Sn=R[jt],cn=new V.LoY;cn.setAttribute("position",new V.THS(Fe[Sn],3)),cn.setAttribute("normal",new V.THS(ht[Sn],3));let gn=G;K&&(C=L._color_palette.getColor(jt%1e4),jt>1e4&&(gn=Math.floor(jt/1e4)/200));const Cn=pe?new V.G_z({color:C,opacity:gn,transparent:gn<1,vertexColors:!1}):new V.V9B({color:C,opacity:gn,transparent:gn<1,vertexColors:!1}),Ln=new V.eaF(cn,Cn);if(Ln.bins=pt[Sn],Ln.bins_faces=de/9,Ln.painter=L,Ln.tipscale=N,Ln.tip_color=3===re.fFillColor?16711680:65280,Ln.get_weight=O,Ln.tooltip=function(Zn){const ui=Math.floor(Zn.faceIndex/this.bins_faces);if(ui<0||ui>=this.bins.length)return null;const hi=this.painter,qi=hi.getHisto(),Mr=hi.getFramePainter(),Sr=hi.get3DToolTip(this.bins[ui]),ms=Mr.grx(qi.fXaxis.GetBinCoord(Sr.ix-1)),fs=Mr.grx(qi.fXaxis.GetBinCoord(Sr.ix)),wt=Mr.gry(qi.fYaxis.GetBinCoord(Sr.iy-1)),W=Mr.gry(qi.fYaxis.GetBinCoord(Sr.iy)),me=Mr.grz(qi.fZaxis.GetBinCoord(Sr.iz-1)),_e=Mr.grz(qi.fZaxis.GetBinCoord(Sr.iz)),Be=this.get_weight(Sr.value)*this.tipscale;return Sr.x1=(fs+ms)/2-(fs-ms)*Be,Sr.x2=(fs+ms)/2+(fs-ms)*Be,Sr.y1=(W+wt)/2-(W-wt)*Be,Sr.y2=(W+wt)/2+(W-wt)*Be,Sr.z1=(_e+me)/2-(_e-me)*Be,Sr.z2=(_e+me)/2+(_e-me)*Be,Sr.color=this.tip_color,Sr},fe.add3DMesh(Ln),dt[Sn]>0){const Zn=new V.mrM({color:L.getColor(re.fLineColor)}),ui=1===dt[Sn]?(0,st.Fc)(Fe[Sn],Zn,rt[Sn]):(0,st.Fc)(_t[Sn],Zn);fe.add3DMesh(ui)}}return!0})()}redraw(L){var he=this;return(0,be.A)(function*(){const re=he.getFramePainter(),fe=he.getHisto();let de=Promise.resolve(!0);return"resize"===L?re.resize3D()&&re.render3D():((0,ot.wx)(re),de=re.create3DScene(he.options.Render3D,he.options.x3dscale,he.options.y3dscale,he.options.Ortho).then(()=>(re.setAxesRanges(fe.fXaxis,he.xmin,he.xmax,fe.fYaxis,he.ymin,he.ymax,fe.fZaxis,he.zmin,he.zmax,he),re.set3DOptions(he.options),re.drawXYZ(re.toplevel,Je.TB,{zoom:v.settings.Zooming,ndim:3,draw:-1!==he.options.Axis,drawany:he.options.isCartesian()}),he.draw3DBins())).then(()=>{re.render3D(),he.updateStatWebCanvas(),re.addKeysHandler()})),he.isMainPainter()&&(de=de.then(()=>he.drawColorPalette(he.options.Zscale&&(12===he._box_option||13===he._box_option)))),de.then(()=>he.updateFunctions()).then(()=>he.updateHistTitle()).then(()=>he)})()}fillToolbar(){const L=this.getPadPainter();L&&(L.addPadButton("auto_zoom","Unzoom all axes","ToggleZoom","Ctrl *"),this.draw_content&&L.addPadButton("statbox","Toggle stat box","ToggleStatBox"),L.showPadButtons())}canZoomInside(L,he,re){let fe=this.getHisto();return fe&&(fe=fe[`f${L.toUpperCase()}axis`]),!fe||fe.FindBin(re,.5)-fe.FindBin(he,0)>1}autoZoom(){const L=this.getSelectIndex("x","left"),he=this.getSelectIndex("x","right"),re=this.getSelectIndex("y","left"),fe=this.getSelectIndex("y","right"),de=this.getSelectIndex("z","left"),pe=this.getSelectIndex("z","right"),ce=this.getObject();let K,G,D;if(L===he||re===fe||de===pe)return;let x=ce.getBinContent(L+1,re+1,de+1);for(K=L;K<he;++K)for(G=re;G<fe;++G)for(D=de;D<pe;++D)x=Math.min(x,ce.getBinContent(K+1,G+1,D+1));if(x>0)return;let P=he,w=L,b=fe,g=re,C=pe,N=de;for(K=L;K<he;++K)for(G=re;G<fe;++G)for(D=de;D<pe;++D)ce.getBinContent(K+1,G+1,D+1)>x&&(K<P&&(P=K),K>=w&&(w=K+1),G<b&&(b=G),G>=g&&(g=G+1),D<C&&(C=D),D>=N&&(N=D+1));let O,H,X,ie,z,m,I=!1;return P===w-1&&P>L+1&&w<he-1&&(P--,w++),b===g-1&&b>re+1&&g<fe-1&&(b--,g++),C===N-1&&C>de+1&&N<pe-1&&(C--,N++),(P>L||w<he)&&P<w-1&&(O=ce.fXaxis.GetBinLowEdge(P+1),H=ce.fXaxis.GetBinLowEdge(w+1),I=!0),(b>re||g<fe)&&b<g-1&&(X=ce.fYaxis.GetBinLowEdge(b+1),ie=ce.fYaxis.GetBinLowEdge(g+1),I=!0),(C>de||N<pe)&&C<N-1&&(z=ce.fZaxis.GetBinLowEdge(C+1),m=ce.fZaxis.GetBinLowEdge(N+1),I=!0),I?this.getFramePainter().zoom(O,H,X,ie,z,m):void 0}fillHistContextMenu(L){const he=this.getSupportedDrawOptions();L.addDrawMenu("Draw with",he,re=>{if(0===re.indexOf(v.kInspect))return this.showInspector(re);this.decodeOptions(re),this.interactiveRedraw(!0,"drawopt")})}static draw(L,he,re){return(0,be.A)(function*(){const fe=new Qe(L,he);return fe.mode3d=!0,(0,xe.ensureTCanvas)(fe,"3d").then(()=>(fe.setAsMainPainter(),fe.decodeOptions(re),fe.checkPadRange(),fe.scanContent(),fe.createStat(),fe.redraw())).then(()=>fe.drawFunctions()).then(()=>(fe.fillToolbar(),fe))})()}}},6673:(Gr,xt,Te)=>{"use strict";Te.r(xt),Te.d(xt,{TPavePainter:()=>L});var be=Te(5774),v=Te(4186),V=Te(3324),Le=Te(1085),xe=Te(165),Je=Te(2481),st=Te(9646),Ke=Te(6856),ot=Te(1564),Re=Te(2725);const Qe=(0,v.BIT)(17);class L extends Je.JW{constructor(re,fe){super(re,fe),this.Enabled=!0,this.UseContextMenu=!0}autoPlaceLegend(re,fe,de){var pe=this;return(0,be.A)(function*(){let K=pe.getFrameSvg().selectChild(".main_layer").node().outerHTML;K=(0,xe.NM)(K),K='<svg xmlns="http://www.w3.org/2000/svg"'+K.slice(4);const G=fe?.fLeftMargin??v.gStyle.fPadLeftMargin,D=fe?.fRightMargin??v.gStyle.fPadRightMargin,x=fe?.fTopMargin??v.gStyle.fPadTopMargin,P=fe?.fBottomMargin??v.gStyle.fPadBottomMargin;return(0,xe.Vm)(K).then(w=>{if(!w)return!1;let b=100,g=100;const N=w.getContext("2d").getImageData(0,0,w.width,w.height).data,O=Math.floor(w.width/b),H=Math.floor(w.height/g),X=new Array(b*g);N.length!==w.width*w.height*4&&(console.log(`Image size missmatch in TLegend autoplace ${N.length} expected ${w.width*w.height*4}`),b=g=0);for(let R=0;R<b;++R){const k=R*O,ee=k+O;for(let ge=0;ge<g;++ge){const ve=ge*H,Se=ve+H;let De=0;for(let Xe=k;Xe<ee&&!De;++Xe)for(let ct=ve;ct<Se;++ct){const $=4*(ct*w.width+Xe);if(N[$]||N[$+1]||N[$+2]||N[$+3]){De=1;break}}X[ge*b+R]=De}}const ie=.3/Math.max(.2,1-G-D),z=Math.min(.5,Math.max(.1,.05*re.fPrimitives.arr.length))/Math.max(.2,1-x-P),m=Math.round(ie*b),I=Math.round(z*g),A=(R,k)=>{for(let ee=R;ee<R+m;++ee)for(let ge=k;ge<k+I;++ge)if(X[ge*b+ee])return!1;return!0};for(let R=0;R<b-m;++R)for(let k=g-I-1;k>=0;--k)if(A(R,k))return re.fX1NDC=G+R/b*(1-G-D),re.fX2NDC=re.fX1NDC+ie*(1-G-D),re.fY2NDC=1-x-k/g*(1-P-x),re.fY1NDC=re.fY2NDC-z*(1-P-x),!0}).then(w=>{if(w||de)return w;re.fX1NDC=Math.max(G??0,re.fX2NDC-.3),re.fX2NDC=Math.min(re.fX1NDC+.3,1-D);const b=Math.max(re.fPrimitives?.05*re.fPrimitives.arr.length:0,.2);return re.fY2NDC=Math.min(1-x,re.fY1NDC+b),re.fY1NDC=Math.max(re.fY2NDC-b,P),!0})})()}drawPave(re){var fe=this;return(0,be.A)(function*(){if(!fe.Enabled)return fe.removeG(),fe;const de=fe.getObject(),pe=de.fOption.toUpperCase(),ce=fe.getFramePainter(),K=fe.getPadPainter(),G=K.getRootPad(!0);let D,x,P;0===de.fInit&&(fe.stored=Object.assign({},de),de.fInit=1,de._typename!==v.clTPaletteAxis||de.fX1||de.fX2||de.fY1||de.fY2?pe.indexOf("NDC")>=0?(de.fX1NDC=de.fX1,de.fX2NDC=de.fX2,de.fY1NDC=de.fY1,de.fY2NDC=de.fY2):G&&0===G.fX1&&1===G.fX2&&0===G.fY1&&1===G.fY2&&(0,v.isStr)(re)&&re.indexOf("postpone")>=0?(de.fInit=0,de.fX1NDC=de.fY1NDC=.99,de.fX2NDC=de.fY2NDC=1):G?(G.fLogx&&(de.fX1>0&&(de.fX1=Math.log10(de.fX1)),de.fX2>0&&(de.fX2=Math.log10(de.fX2))),G.fLogy&&(de.fY1>0&&(de.fY1=Math.log10(de.fY1)),de.fY2>0&&(de.fY2=Math.log10(de.fY2))),de.fX1NDC=(de.fX1-G.fX1)/(G.fX2-G.fX1),de.fY1NDC=(de.fY1-G.fY1)/(G.fY2-G.fY1),de.fX2NDC=(de.fX2-G.fX1)/(G.fX2-G.fX1),de.fY2NDC=(de.fY2-G.fY1)/(G.fY2-G.fY1)):(de.fX1NDC=de.fY1NDC=.1,de.fX2NDC=de.fY2NDC=.9):ce?(de.fX1NDC=ce.fX2NDC+.01,de.fX2NDC=Math.min(.96,ce.fX2NDC+.06),de.fY1NDC=ce.fY1NDC,de.fY2NDC=ce.fY2NDC):(de.fX2NDC=.8,de.fX1NDC=.9,de.fY1NDC=.1,de.fY2NDC=.9));let w=Promise.resolve(!0);return de._typename===v.clTLegend&&(fe.AutoPlace||de.fX1NDC===de.fX2NDC&&de.fY1NDC===de.fY2NDC)&&(w=fe.autoPlaceLegend(de,G).then(b=>(delete fe.AutoPlace,b||(de.fX1NDC=ce.fX2NDC-.2,de.fX2NDC=ce.fX2NDC,de.fY1NDC=ce.fY2NDC-.1,de.fY2NDC=ce.fY2NDC),b))),w.then(()=>{if(fe.isStats()&&!fe.NoFillStats&&!K._fast_drawing){const H=de.$main_painter||fe.getMainPainter();if((0,v.isFunc)(H?.fillStatistic)){let X=parseInt(de.fOptStat),ie=parseInt(de.fOptFit);if((!Number.isInteger(X)||de.TestBit(Qe))&&(X=v.gStyle.fOptStat),(!Number.isInteger(ie)||de.TestBit(Qe))&&(ie=v.gStyle.fOptFit),H.fillStatistic(fe,X,ie)){let z=de.fLines?.arr.length||0;if(z>0&&!fe.moved_interactive&&function Ie(he){const re=(fe,de)=>Math.abs(fe-de)<.001;return re(he.fX1NDC,v.gStyle.fStatX-v.gStyle.fStatW)&&re(he.fY1NDC,v.gStyle.fStatY-v.gStyle.fStatH)&&re(he.fX2NDC,v.gStyle.fStatX)&&re(he.fY2NDC,v.gStyle.fStatY)}(de)){const m=fe._has_fit&&fe._fit_dim>1?v.gStyle.fStatH:0;m&&(z-=fe._fit_cnt);let I=v.gStyle.fStatH,A=v.gStyle.fStatW;fe._has_fit&&(A=1.8*v.gStyle.fStatW),v.gStyle.fStatFontSize<=0||v.gStyle.fStatFont%10==3?I=.25*z*v.gStyle.fStatH:v.gStyle.fStatFontSize<1&&(I=z*v.gStyle.fStatFontSize),de.fX1NDC=Math.max(.02,de.fX2NDC-A),de.fY1NDC=Math.max(.02,de.fY2NDC-I-m)}}}}const b=K.getPadRect(),g=de.fBorderSize,C=pe.indexOf("NB")>=0,N=pe.indexOf("L")>=0?-1:pe.indexOf("R")>=0?1:0,O=pe.indexOf("T")>=0?-1:pe.indexOf("B")>=0?1:0;if(fe.createG(),fe._pave_x=Math.round(de.fX1NDC*b.width),fe._pave_y=Math.round((1-de.fY2NDC)*b.height),x=Math.round((de.fX2NDC-de.fX1NDC)*b.width),P=Math.round((de.fY2NDC-de.fY1NDC)*b.height),(0,xe.bk)(fe.draw_g,fe._pave_x,fe._pave_y),fe.createAttLine({attr:de,width:g>0?de.fLineWidth:0}),fe.createAttFill({attr:de}),de._typename===v.clTDiamond){const H=Math.round(P/2),X=Math.round(x/2),ie=`l${X},${-H}l${X},${H}l${-X},${H}z`;g>1&&de.fShadowColor>0&&(N||O)&&!fe.fillatt.empty()&&!C&&fe.draw_g.append("svg:path").attr("d","M0,"+(H+g)+ie).style("fill",fe.getColor(de.fShadowColor)).style("stroke",fe.getColor(de.fShadowColor)).style("stroke-width","1px"),D=fe.draw_g.append("svg:path").attr("d","M0,"+H+ie).call(fe.fillatt.func).call(fe.lineatt.func);const z=fe.draw_g.append("svg:g");return(0,xe.bk)(z,Math.round(x/4),Math.round(P/4)),fe.drawPaveText(X,H,re,z)}if(g>1&&de.fShadowColor>0&&!de.fNpaves&&(N||O)&&!C){const H=fe.getColor(de.fShadowColor);let X="";X=N<0&&O<0?`M0,0v${P-g}h${-g}v${-P}h${x}v${g}z`:N<0&&O>0?`M0,${P}v${g-P}h${-g}v${P}h${x}v${-g}z`:N>0&&O<0?`M${g},0v${-g}h${x}v${P}h${-g}v${g-P}z`:`M${x},${g}h${g}v${P}h${-x}v${-g}h${x-g}z`,fe.draw_g.append("svg:path").attr("d",X).style("fill",H).style("stroke",H).style("stroke-width","1px")}if(de.fNpaves)for(let H=de.fNpaves-1;H>0;--H)fe.draw_g.append("svg:path").attr("d",`M${4*N*H},${4*O*H}h${x}v${P}h${-x}z`).call(fe.fillatt.func).call(fe.lineatt.func);return(!fe.isBatchMode()||!fe.fillatt.empty()||!fe.lineatt.empty()&&!C)&&(D=fe.draw_g.append("svg:path").attr("d",`M0,0H${x}V${P}H0Z`).call(fe.fillatt.func),C||D.call(fe.lineatt.func)),!(0,v.isFunc)(fe.paveDrawFunc)||fe.paveDrawFunc(x,P,re)}).then(()=>(fe.isBatchMode()||de._typename===v.clTPave||(D&&D.style("pointer-events","visibleFill").on("mouseenter",()=>fe.showObjectStatus()),(0,ot.WJ)(fe,{obj:de,x:fe._pave_x,y:fe._pave_y,width:x,height:P,minwidth:10,minheight:20,canselect:!0,redraw:()=>{fe.moved_interactive=!0,fe.interactiveRedraw(!1,"pave_moved"),fe.drawPave()},ctxmenu:v.browser.touches&&v.settings.ContextMenu&&fe.UseContextMenu}),fe.UseContextMenu&&v.settings.ContextMenu&&fe.draw_g.on("contextmenu",b=>fe.paveContextMenu(b)),de._typename===v.clTPaletteAxis&&fe.interactivePaletteAxis(x,P)),fe))})()}fillWebObjectOptions(re){const fe=this.getObject();return fe?.fInit&&(re.fcust="pave",re.fopt=[fe.fX1NDC,fe.fY1NDC,fe.fX2NDC,fe.fY2NDC],"stats"===fe.fName&&this.isStats()&&fe.fLines.arr.forEach(de=>{(de._typename===v.clTText||de._typename===v.clTLatex)&&(re.fcust+=`;;${de.fTitle}`)})),re}drawPaveLabel(re,fe){var de=this;return(0,be.A)(function*(){const pe=de.getObject();return pe.fLabel&&pe.fLabel.trim()?(de.createAttText({attr:pe,can_rotate:!1}),de.startTextDrawing(de.textatt.font,fe/1.2),de.drawText(de.textatt.createArg({width:re,height:fe,text:pe.fLabel,norotate:!0})),de.finishTextDrawing()):de})()}drawPaveStats(re,fe){const de=this.getObject(),pe=[],ce=[];let K=0,G=0,D=0;for(let C=0;C<de.fLines.arr.length;++C){const N=de.fLines.arr[C];(N._typename===v.clTText||N._typename===v.clTLatex)&&(pe.push(N.fTitle),ce.push(N.fTextColor))}const x=pe.length;for(let C=0;C<x;++C){const N=pe[C];if(C>0&&(D=Math.max(D,N.length)),0===C||N.indexOf("|")<0)continue;0===K&&(K=C);const O=N.split("|");O.length>G&&(G=O.length)}const P=fe/x,w=de.fMargin*re;let b=!1;if(this.createAttText({attr:de,can_rotate:!1}),this.startTextDrawing(this.textatt.font,fe/(1.2*x)),1===x)this.drawText(this.textatt.createArg({width:re,height:fe,text:pe[0],latex:1,norotate:!0}));else for(let C=0;C<x;++C){const N=C*P,O=ce[C]>1?this.getColor(ce[C]):this.textatt.color;if(K&&C>=K){const H=pe[C].split("|");for(let X=0;X<H.length;++X)this.drawText({align:"middle",x:re*X/G,y:N,latex:0,width:re/G,height:P,text:H[X],color:O})}else if(pe[C].indexOf("=")<0){if(0===C){b=!0;const H=Math.max(D,Math.round((re-2*w)/P/.65));pe[C].length>H+5&&(pe[C]=pe[C].slice(0,H+2)+"...")}this.drawText({align:0===C?"middle":"start",x:w,y:N,width:re-2*w,height:P,text:pe[C],color:O})}else{const H=pe[C].split("="),X=[];for(let ie=0;ie<2;++ie)X.push({align:0===ie?"start":"end",x:w,y:N,width:re-2*w,height:P,text:H[ie],color:O,_expected_width:re-2*w,_args:X,post_process(m){this._args[0].ready&&this._args[1].ready&&m.scaleTextDrawing(1.05*(this._args[0].result_width+this._args[1].result_width)/this._expected_width,m.draw_g)}});for(let ie=0;ie<2;++ie)this.drawText(X[ie])}}let g="";if(de.fBorderSize>0&&b&&(g+=`M0,${Math.round(P)}h${re}`),K>0&&G>1){for(let C=K;C<x;++C)g+=`M0,${Math.round(C*P)}h${re}`;for(let C=0;C<G-1;++C)g+=`M${Math.round(re/G*(C+1))},${Math.round(K*P)}V${fe}`}return g&&this.draw_g.append("svg:path").attr("d",g).call(this.lineatt.func),this.finishTextDrawing(void 0,x>1)}drawPaveText(re,fe,de,pe){const ce=this.getObject(),K=ce.fLines?.arr||[],G=K.length,D=this.getPadPainter(),x=D.getPadHeight(),P=ce.fLabel.length>0,w=[],b=ce.fMargin*re,g=fe/(G||1);let C=0;this.createAttText({attr:ce,can_rotate:!1}),1===G&&this.textatt.size>0&&(C=Math.max(3,this.textatt.getSize(x))),pe||(pe=this.draw_g);const N=1===G&&D._fast_drawing;let O=0,H=!1;for(let X=0;X<G;++X){const ie=K[X],z=X*g;switch(ie._typename){case v.clTText:case v.clTLatex:{if(!ie.fTitle||!ie.fTitle.trim())continue;let m=ie.fTextColor?this.getColor(ie.fTextColor):"";if(m||(m=this.textatt.color),H=!0,ie.fX||ie.fY||ie.fTextSize){const I=ie.fTextAlign||this.textatt.align,A=Math.floor(I/10),R=I%10,k=ie.fX?ie.fX*re:1===A?b:2===A?re/2:re-b,ee=ie.fY?(1-ie.fY)*fe:z+(2===R?g/2:3===R?g:0),ge=pe.append("svg:g");this.startTextDrawing(this.textatt.font,this.textatt.getAltSize(ie.fTextSize,x),ge),this.drawText({align:I,x:k,y:ee,text:ie.fTitle,color:m,latex:ie._typename===v.clTText?0:1,draw_g:ge,fast:N}),w.push(this.finishTextDrawing(ge))}else 0==O++&&this.startTextDrawing(this.textatt.font,.85*fe/G,pe,C),this.drawText({x:b,y:z,width:re-2*b,height:g,align:ie.fTextAlign||this.textatt.align,draw_g:pe,latex:ie._typename===v.clTText?0:1,text:ie.fTitle,color:m,fast:N});break}case v.clTLine:{const m=ie.fX1?Math.round(ie.fX1*re):0,I=ie.fX2?Math.round(ie.fX2*re):re,A=ie.fY1?Math.round((1-ie.fY1)*fe):Math.round(z+.5*g),R=ie.fY2?Math.round((1-ie.fY2)*fe):Math.round(z+.5*g),k=this.createAttLine(ie);pe.append("svg:path").attr("d",`M${m},${A}L${I},${R}`).call(k.func);break}case v.clTBox:{const m=ie.fX1?Math.round(ie.fX1*re):0,I=ie.fX2?Math.round(ie.fX2*re):re,A=ie.fY1?Math.round((1-ie.fY1)*fe):Math.round(z),R=ie.fY2?Math.round((1-ie.fY2)*fe):Math.round(z+g),k=this.createAttFill(ie);pe.append("svg:path").attr("d",`M${m},${A}H${I}V${R}H${m}Z`).call(k.func);break}}}if(O>0&&w.push(this.finishTextDrawing(pe,O>1)),this.isTitle()&&this.draw_g.style("display",H?null:"none"),P){const X=Math.round(.25*re),ie=Math.round(.02*-fe),z=Math.round(.5*re),m=Math.round(.04*fe),I=pe.append("svg:g");I.append("svg:path").attr("d",`M${X},${ie}h${z}v${m}h${-z}z`).call(this.fillatt.func).call(this.lineatt.func),this.startTextDrawing(this.textatt.font,m/1.5,I),this.drawText({align:22,x:X,y:ie,width:z,height:m,text:ce.fLabel,color:this.textatt.color,draw_g:I}),w.push(this.finishTextDrawing(I))}return Promise.all(w).then(()=>this)}format(re,fe){fe||(fe="stat");const de=this.getObject();switch(fe){case"stat":fe=de.fStatFormat||v.gStyle.fStatFormat;break;case"fit":fe=de.fFitFormat||v.gStyle.fFitFormat;break;case"entries":if(Math.abs(re)<1e9&&Math.round(re)===re)return re.toFixed(0);fe="14.7g";break;case"last":fe=this.lastformat}const pe=(0,xe.lg)(re,fe||"6.4g",!0);return this.lastformat=pe[1],pe[0]}drawLegend(re,fe){const de=this.getObject(),pe=de.fPrimitives.arr.length;let ce=de.fNColumns,K=pe,G=!1,D=!1;if(ce<2)ce=1;else for(;(K-1)*ce>=pe;)K--;const x=z=>!(z.fObject||z.fOption||z.fLabel&&" "!==z.fLabel);for(let z=0;z<pe;++z){const m=de.fPrimitives.arr[z];x(m)?1===ce&&K--:m.fLabel&&(G=!0,(m.fTextFont&&m.fTextFont!==de.fTextFont||m.fTextSize&&m.fTextSize!==de.fTextSize)&&(D=!0))}K<1&&(K=1);const P=new Array(ce+1).fill(0);if(ce>1){const z=new Array(ce).fill(1);for(let I=0;I<pe;++I){const A=de.fPrimitives.arr[I];if(x(A))continue;const R=I%ce;z[R]=Math.max(z[R],A.fLabel.length)}let m=0;for(let I=0;I<ce;++I)m+=z[I];for(let I=0;I<ce-1;++I)P[I+1]=P[I]+de.fMargin*re/ce+z[I]*(1-de.fMargin)*re/m}P[ce]=re;const w=Math.round(.03*re/ce),b=Math.round(.03*fe),g=(fe-2*b)/K,C=[],N=this.getPadPainter();let O=.9*g,H=0,X=!1;this.createAttText({attr:de,can_rotate:!1});const ie=this.textatt.getSize(N.getPadHeight());ie&&ie<O&&(O=H=ie),G&&!D&&this.startTextDrawing(this.textatt.font,O,this.draw_g,H);for(let z=0,m=-1;z<pe;++z){const I=de.fPrimitives.arr[z];if(x(I))continue;1===ce?++m:m=z;const A=I.fOption.toLowerCase(),R=m%ce,k=(m-R)/ce,ee=Math.round(P[R]),ge=Math.round(P[R+1]-P[R]),ve=ee+Math.round(de.fMargin*re/ce),Se=Math.round((ee+ve)/2),De=Math.round(k*g+b),Xe=Math.round((k+.5)*g+b),ct=I.fObject,$=-1!==A.indexOf("f"),tt=-1!==A.indexOf("l"),We=-1!==A.indexOf("e"),Ne=-1!==A.indexOf("p");let Fe=I,ht=I,pt=I,dt=null,rt=!1;if((0,v.isObject)(ct)&&("fLineColor"in ct&&(pt=ct),"fFillColor"in ct&&(Fe=ct),"fMarkerColor"in ct&&(ht=ct),dt=N.findPainterFor(ct)),$){const Yt=dt?.fillatt?.used?dt.fillatt:this.createAttFill(Fe);let kt;if(!tt&&!We&&!Ne&&(kt=dt?.lineatt?.used?dt.lineatt:this.createAttLine(pt),kt.empty()&&(kt=null)),!Yt.empty()||kt){rt=!0;const Tt=this.draw_g.append("svg:path").attr("d",`M${ee+w},${Math.round(De+.1*g)}v${Math.round(.8*g)}h${ve-2*w-ee}v${-Math.round(.8*g)}z`);Yt.empty()?Tt.style("fill","none"):Tt.call(Yt.func),kt&&Tt.call(kt.func)}}if(tt||We){const Yt=dt?.lineatt?.used?dt.lineatt:this.createAttLine(pt);if(!Yt.empty()&&(rt=!0,tt&&this.draw_g.append("svg:path").attr("d",`M${ee+w},${Xe}H${ve-w}`).call(Yt.func),We)){let kt=0,Tt=.05*g;(0,v.isFunc)(dt?.getHisto)&&1===dt.options?.ErrorKind?kt=1:(0,v.isFunc)(dt?.getGraph)&&void 0!==ct?.fLineWidth&&void 0!==ct?.fMarkerSize&&(kt=dt.options?.Ends??1,Tt=ct.fLineWidth+v.gStyle.fEndErrorSize,kt>1&&(Tt=Math.max(Tt,8*ct.fMarkerSize*.66)));const fn=3===kt?.03:0,ln=Math.round(De+g*(.1+fn)),mn=Math.round(De+g*(.9-fn)),jt=Math.round(.66*Tt);Tt=Math.round(Tt);let Sn=`M${Se},${ln}V${mn}`;switch(kt){case 1:Sn+=`M${Se-Tt},${ln}h${2*Tt}M${Se-Tt},${mn}h${2*Tt}`;break;case 2:Sn+=`M${Se-Tt},${ln+jt}v${-jt}h${2*Tt}v${jt}M${Se-Tt},${mn-jt}v${jt}h${2*Tt}v${-jt}`;break;case 3:Sn+=`M${Se-Tt},${ln}h${2*Tt}l${-Tt},${-jt}zM${Se-Tt},${mn}h${2*Tt}l${-Tt},${jt}z`;break;case 4:Sn+=`M${Se-Tt},${ln+jt}l${Tt},${-jt}l${Tt},${jt}M${Se-Tt},${mn-jt}l${Tt},${jt}l${Tt},${-jt}`}this.draw_g.append("svg:path").attr("d",Sn).call(Yt.func).style("fill",kt>1?"none":null)}}if(Ne){const Yt=dt?.markeratt?.used?dt.markeratt:this.createAttMarker(ht);Yt.empty()||(rt=!0,this.draw_g.append("svg:path").attr("d",Yt.create((ee+ve)/2,Xe)).call(Yt.func))}!rt&&dt?.lineatt&&!dt.lineatt.empty()&&this.draw_g.append("svg:path").attr("d",`M${ee+w},${Math.round(De+.1*g)}v${Math.round(.8*g)}h${ve-2*w-ee}v${-Math.round(.8*g)}z`).style("fill","none").call(dt.lineatt.func);let _t=ve;if((0,v.isStr)(A)&&"h"!==A.toLowerCase()?X=!0:X||(_t=ee+w),I.fLabel){let Yt=this.draw_g;const kt=this.createAttText({attr:I,std:!1,attr_alt:de});if(D){Yt=this.draw_g.append("svg:g");const Tt=kt.getSize(N.getPadHeight());this.startTextDrawing(kt.font,Tt,Yt,H)}this.drawText({draw_g:Yt,align:kt.align,x:_t,y:De,scale:D&&!I.fTextSize||!de.fTextSize,width:ee+ge-_t-w,height:g,text:I.fLabel,color:kt.color}),D&&C.push(this.finishTextDrawing(Yt))}}return G&&!D&&C.push(this.finishTextDrawing()),Promise.all(C)}drawPaletteAxis(re,fe,de){const pe=this.getObject(),ce=pe.fAxis,K=(0,v.isStr)(de)&&de.indexOf("can_move")>=0,G=(0,v.isStr)(de)&&de.indexOf("postpone")>=0,D=(0,v.isStr)(de)&&de.indexOf("cjust")>=0,x=this.getPadPainter(),P=x.getPadWidth(),w=x.getPadHeight(),b=x.getRootPad(!0),g=pe.$main_painter||this.getMainPainter(),C=this.getFramePainter(),N=g.fContour,O=N?.getLevels(),H=(0,v.isFunc)(g.getDimension)&&3===g.getDimension(),X=b?.fLogv??(!H&&b?.fLogz),ie=g._color_palette,z=g.getObject()?.fZaxis,m=b?.fTickz?.35:.7;let R,k,I=0,A=100,ee="",ge=0;if(this._palette_vertical=pe.fX2NDC-pe.fX1NDC<pe.fY2NDC-pe.fY1NDC,ce.fTickSize=.6*re/P,typeof z?.fLabelOffset<"u"&&!H&&(ce.fBits=z.fBits&~Je.rb.kTickMinus&~Je.rb.kTickPlus,ce.fTitle=z.fTitle,ce.fTitleSize=z.fTitleSize,ce.fTitleOffset=z.fTitleOffset,ce.fTextColor=z.fTitleColor,ce.fTextFont=z.fTitleFont,ce.fLineColor=z.fAxisColor,ce.fLabelSize=z.fLabelSize,ce.fLabelColor=z.fLabelColor,ce.fLabelFont=z.fLabelFont,ce.fLabelOffset=z.fLabelOffset,this.z_handle.setHistPainter(g,"z"),this.z_handle.source_axis=z),N&&C&&!H?void 0!==C.zmin&&void 0!==C.zmax&&C.zmin!==C.zmax?(R=C.zmin,k=C.zmax,I=C.zoom_zmin,A=C.zoom_zmax,I===A&&(I=R,A=k)):(I=O[0],A=O[O.length-1]):void 0!==g.gmaxbin&&void 0!==g.gminbin?(I=g.gminbin,A=g.gmaxbin):void 0!==g.hmin&&void 0!==g.hmax&&(I=g.hmin,A=g.hmax),this.draw_g.selectAll("rect").style("fill","white"),(void 0===R||void 0===k||R===k)&&(R=I,k=A),this._palette_vertical?(this._swap_side=pe.fX2NDC<.5,this.z_handle.configureAxis("zaxis",R,k,I,A,!0,[0,fe],{log:X,fixed_ticks:D?O:null,maxTickSize:Math.round(re*m),swap_side:this._swap_side}),ee=this._swap_side?null:`translate(${re})`,b?.fTickz&&(ge=this._swap_side?re:-re)):(this._swap_side=pe.fY1NDC>.5,this.z_handle.configureAxis("zaxis",R,k,I,A,!1,[0,re],{log:X,fixed_ticks:D?O:null,maxTickSize:Math.round(fe*m),swap_side:this._swap_side}),ee=this._swap_side?null:`translate(0,${fe})`,b?.fTickz&&(ge=this._swap_side?fe:-fe)),N&&ie&&!G)for(let ve=0;ve<O.length-1;++ve){let ct,Se=Math.round(this.z_handle.gr(O[ve])),De=Math.round(this.z_handle.gr(O[ve+1])),Xe=.5*(O[ve]+O[ve+1]);if(this._palette_vertical){if(De>=fe||Se<0)continue;Se+=1,Se>fe?(Se=fe,Xe=.001*O[ve]+.999*O[ve+1],De<0&&(De=0)):De<0&&(De=0,Xe=.999*O[ve]+.001*O[ve+1]),ct=`M0,${De}H${re}V${Se}H0Z`}else{if(Se>=re||De<0)continue;De+=1,De>re?(De=re,Xe=.999*O[ve]+.001*O[ve+1],Se<0&&(Se=0)):Se<0&&(Se=0,Xe=.001*O[ve]+.999*O[ve+1]),ct=`M${Se},0V${fe}H${De}V0Z`}const $=N.getPaletteColor(ie,Xe);if(!$)continue;const tt=this.draw_g.append("svg:path").attr("d",ct).style("fill",$).property("fill0",$).property("fill1",(0,V.Qh)($).darker(.5).formatHex());this.isTooltipAllowed()&&tt.on("mouseover",function(){(0,V.Lt)(this).transition().duration(100).style("fill",(0,V.Lt)(this).property("fill1"))}).on("mouseout",function(){(0,V.Lt)(this).transition().duration(100).style("fill",(0,V.Lt)(this).property("fill0"))}).append("svg:title").text(O[ve].toFixed(2)+" - "+O[ve+1].toFixed(2)),v.settings.Zooming&&tt.on("dblclick",()=>this.getFramePainter().unzoom("z"))}else this.draw_g.append("svg:path").attr("d",`M0,0H${re}V${fe}H0Z`).style("fill","white");return this.z_handle.drawAxis(this.draw_g,re,fe,ee,ge).then(()=>{if(K&&"getBoundingClientRect"in this.draw_g.node()){const ve=this.draw_g.node().getBoundingClientRect();if(this._palette_vertical){const Se=this._pave_x+parseInt(ve.width)-Math.round(.995*P)+3;Se>0&&(this._pave_x-=Se,(0,xe.bk)(this.draw_g,this._pave_x,this._pave_y),pe.fX1NDC-=Se/P,pe.fX2NDC-=Se/P)}else{const Se=Math.round((1.05-v.gStyle.fTitleY)*w)-ve.y;Se>0&&(this._pave_y+=Se,(0,xe.bk)(this.draw_g,this._pave_x,this._pave_y),pe.fY1NDC-=Se/w,pe.fY2NDC-=Se/w)}}return this})}interactivePaletteAxis(re,fe){let de=!1,pe=0,ce=0,K=null;const G=P=>{if(!de)return;P.preventDefault();const w=(0,V.Wn)(P,this.draw_g.node());this._palette_vertical?(ce=Math.min(Math.max(w[1],0),fe),K.attr("y",Math.min(pe,ce)).attr("height",Math.abs(ce-pe))):(ce=Math.min(Math.max(w[0],0),re),K.attr("x",Math.min(pe,ce)).attr("width",Math.abs(ce-pe)))},D=P=>{if(!de)return;P.preventDefault(),(0,V.Lt)(window).on("mousemove.colzoomRect",null).on("mouseup.colzoomRect",null),K.remove(),K=null,de=!1;const w=this.z_handle.revertPoint(pe),b=this.z_handle.revertPoint(ce);this.getFramePainter().zoom("z",Math.min(w,b),Math.max(w,b)),this.getFramePainter().zoomChangedInteractive("z",!0)};v.settings.Zooming&&this.draw_g.selectAll(".axis_zoom").on("mousedown",P=>{if(de)return;de=!0,P.preventDefault(),P.stopPropagation();const w=(0,V.Wn)(P,this.draw_g.node());K=this.draw_g.append("svg:rect").attr("id","colzoomRect").call(xe.Ru,!0),this._palette_vertical?(pe=ce=w[1],K.attr("x","0").attr("width",re).attr("y",pe).attr("height",1)):(pe=ce=w[0],K.attr("x",pe).attr("width",1).attr("y",0).attr("height",fe)),(0,V.Lt)(window).on("mousemove.colzoomRect",G).on("mouseup.colzoomRect",D,!0)}).on("dblclick",()=>this.getFramePainter().unzoom("z")),v.settings.ZoomWheel&&this.draw_g.on("wheel",P=>{const w=(0,V.Wn)(P,this.draw_g.node()),g=this.z_handle.analyzeWheelEvent(P,this._palette_vertical?1-w[1]/fe:w[0]/re);g?.changed&&(this.getFramePainter().zoom("z",g.min,g.max),this.getFramePainter().zoomChangedInteractive("z",!0))})}fillContextMenuItems(re){const fe=this.getObject();if(this.isStats()){re.add("Default position",()=>{fe.fX2NDC=v.gStyle.fStatX,fe.fX1NDC=fe.fX2NDC-v.gStyle.fStatW,fe.fY2NDC=v.gStyle.fStatY,fe.fY1NDC=fe.fY2NDC-v.gStyle.fStatH,fe.fInit=1,this.interactiveRedraw(!0,"pave_moved")}),re.add("Save to gStyle",()=>{v.gStyle.fStatX=fe.fX2NDC,v.gStyle.fStatW=fe.fX2NDC-fe.fX1NDC,v.gStyle.fStatY=fe.fY2NDC,v.gStyle.fStatH=fe.fY2NDC-fe.fY1NDC,this.fillatt?.saveToStyle("fStatColor","fStatStyle"),v.gStyle.fStatTextColor=fe.fTextColor,v.gStyle.fStatFontSize=fe.fTextSize,v.gStyle.fStatFont=fe.fTextFont},"Store stats position and graphical attributes to gStyle"),re.add("SetStatFormat",()=>{re.input("Enter StatFormat",fe.fStatFormat).then(pe=>{pe&&(fe.fStatFormat=pe,this.interactiveRedraw(!0,`exec:SetStatFormat("${pe}")`))})}),re.add("SetFitFormat",()=>{re.input("Enter FitFormat",fe.fFitFormat).then(pe=>{pe&&(fe.fFitFormat=pe,this.interactiveRedraw(!0,`exec:SetFitFormat("${pe}")`))})}),re.add("separator"),re.add("sub:SetOptStat",()=>{re.input("Enter OptStat",fe.fOptStat,"int").then(pe=>{fe.fOptStat=pe,this.interactiveRedraw(!0,`exec:SetOptStat(${pe})`)})});const de=(pe,ce)=>{let K=pe<10?fe.fOptStat:fe.fOptFit;K=parseInt(parseInt(K)/parseInt(Math.pow(10,pe%10)))%10,re.addchk(K,ce,100*K+pe,G=>{const D=parseInt(G/100);let x=G%100<10?fe.fOptStat:fe.fOptFit;x-=(D>0?D:-1)*parseInt(Math.pow(10,G%10)),G%100<10?(fe.fOptStat=x,this.interactiveRedraw(!0,`exec:SetOptStat(${x})`)):(fe.fOptFit=x,this.interactiveRedraw(!0,`exec:SetOptFit(${x})`))})};de(0,"Histogram name"),de(1,"Entries"),de(2,"Mean"),de(3,"Std Dev"),de(4,"Underflow"),de(5,"Overflow"),de(6,"Integral"),de(7,"Skewness"),de(8,"Kurtosis"),re.add("endsub:"),re.add("sub:SetOptFit",()=>{re.input("Enter OptStat",fe.fOptFit,"int").then(pe=>{fe.fOptFit=pe,this.interactiveRedraw(!0,`exec:SetOptFit(${pe})`)})}),de(10,"Fit parameters"),de(11,"Par errors"),de(12,"Chi square / NDF"),de(13,"Probability"),re.add("endsub:"),re.add("separator")}else fe._typename===v.clTLegend?re.add("Autoplace",()=>{this.autoPlaceLegend(fe,this.getPadPainter()?.getRootPad(!0),!0).then(de=>{de&&this.interactiveRedraw(!0,"pave_moved")})}):fe.fName===v.kTitle&&(re.add("Default position",()=>{fe.fX1NDC=v.gStyle.fTitleW>0?v.gStyle.fTitleX-v.gStyle.fTitleW/2:v.gStyle.fPadLeftMargin,fe.fY1NDC=v.gStyle.fTitleY-Math.min(1.1*v.gStyle.fTitleFontSize,.06),fe.fX2NDC=v.gStyle.fTitleW>0?v.gStyle.fTitleX+v.gStyle.fTitleW/2:1-v.gStyle.fPadRightMargin,fe.fY2NDC=v.gStyle.fTitleY,fe.fInit=1,this.interactiveRedraw(!0,"pave_moved")}),re.add("Save to gStyle",()=>{v.gStyle.fTitleX=(fe.fX2NDC+fe.fX1NDC)/2,v.gStyle.fTitleY=fe.fY2NDC,this.fillatt?.saveToStyle("fTitleColor","fTitleStyle"),v.gStyle.fTitleTextColor=fe.fTextColor,v.gStyle.fTitleFontSize=fe.fTextSize,v.gStyle.fTitleFont=fe.fTextFont},"Store title position and graphical attributes to gStyle"));re.add("Bring to front",()=>this.bringToFront(!this.isStats()&&!this.z_handle))}paveContextMenu(re){if(this.z_handle){const fe=this.getFramePainter();(0,v.isFunc)(fe?.showContextMenu)&&fe.showContextMenu("pal",re)}else(0,st.sj)(re,this,this.isTitle()?v.kTitle:void 0)}isStats(){return this.matchObjectType(v.clTPaveStats)}isTitle(){return this.matchObjectType(v.clTPaveText)&&this.getObject()?.fName===v.kTitle}clearPave(){this.getObject().Clear()}addText(re){this.getObject().AddText(re)}fillFunctionStat(re,fe,de=1){if(this._has_fit=!1,!fe||!re)return!1;this._has_fit=!0,this._fit_dim=de,this._fit_cnt=0;const pe=1===de?fe%10:1,ce=1===de?Math.floor(fe/10)%10:1,K=1===de?Math.floor(fe/100)%10:1,G=1===de?Math.floor(fe/1e3)%10:0;if(K&&(this.addText("#chi^{2} / ndf = "+this.format(re.fChisquare,"fit")+" / "+re.fNDF),this._fit_cnt++),G&&(this.addText("Prob = "+this.format((0,Le.Prob)(re.fChisquare,re.fNDF))),this._fit_cnt++),pe)for(let D=0;D<re.GetNumPars();++D){const x=re.GetParName(D);let P=re.GetParValue(D),w=re.GetParError(D);P=void 0===P?"<not avail>":this.format(Number(P),"fit"),void 0!==w&&(w=this.format(w,"last"),0===Number(w)&&0!==re.GetParError(D)&&(w=this.format(re.GetParError(D),"4.2g"))),this.addText(ce&&w?`${x} = ${P} #pm ${w}`:`${x} = ${P}`),this._fit_cnt++}return!0}isDummyPos(re){return!re||!(re.fInit||re.fX1||re.fX2||re.fY1||re.fY2||re.fX1NDC||re.fX2NDC||re.fY1NDC||re.fY2NDC)}updateObject(re,fe){if(!this.matchObjectType(re))return!1;const de=this.getObject();switch(!de.modified_NDC&&!this.isDummyPos(re)&&(this.stored&&!re.fInit&&this.stored.fX1===re.fX1&&this.stored.fX2===re.fX2&&this.stored.fY1===re.fY1&&this.stored.fY2===re.fY2?(this.stored.fX1NDC!==re.fX1NDC&&(de.fX1NDC=re.fX1NDC),this.stored.fX2NDC!==re.fX2NDC&&(de.fX2NDC=re.fX2NDC),this.stored.fY1NDC!==re.fY1NDC&&(de.fY1NDC=re.fY1NDC),this.stored.fY2NDC!==re.fY2NDC&&(de.fY2NDC=re.fY2NDC)):(de.fInit=re.fInit,de.fX1=re.fX1,de.fX2=re.fX2,de.fY1=re.fY1,de.fY2=re.fY2,de.fX1NDC=re.fX1NDC,de.fX2NDC=re.fX2NDC,de.fY1NDC=re.fY1NDC,de.fY2NDC=re.fY2NDC),this.stored=Object.assign({},re)),de.fOption=re.fOption,de.fBorderSize=re.fBorderSize,void 0!==de.fTextColor&&void 0!==re.fTextColor&&(de.fTextAngle=re.fTextAngle,de.fTextSize=re.fTextSize,de.fTextAlign=re.fTextAlign,de.fTextColor=re.fTextColor,de.fTextFont=re.fTextFont),re._typename){case v.clTDiamond:case v.clTPaveText:return de.fLines=(0,v.clone)(re.fLines),!0;case v.clTPavesText:return de.fLines=(0,v.clone)(re.fLines),de.fNpaves=re.fNpaves,!0;case v.clTPaveLabel:case v.clTPaveClass:return de.fLabel=re.fLabel,!0;case v.clTPaveStats:return de.fOptStat=re.fOptStat,de.fOptFit=re.fOptFit,!0;case v.clTLegend:{const pe=de.fPrimitives;if(de.fPrimitives=re.fPrimitives,de.fNColumns=re.fNColumns,this.AutoPlace="autoplace"===fe,pe?.arr?.length&&pe?.arr?.length===de.fPrimitives?.arr?.length)for(let ce=0;ce<pe.arr.length;++ce){const K=pe.arr[ce].fObject,G=de.fPrimitives.arr[ce].fObject;K&&G&&K._typename===G._typename&&K.fName===G.fName&&(de.fPrimitives.arr[ce].fObject=K)}return!0}case v.clTPaletteAxis:return de.fBorderSize=1,de.fShadowColor=0,!0}return!1}redraw(){var re=this;return(0,be.A)(function*(){return re.drawPave()})()}cleanup(){this.z_handle&&(this.z_handle.cleanup(),delete this.z_handle),super.cleanup()}static canDraw(re){const fe=re?._typename;return fe===v.clTPave||fe===v.clTPaveLabel||fe===v.clTPaveClass||fe===v.clTPaveStats||fe===v.clTPaveText||fe===v.clTPavesText||fe===v.clTDiamond||fe===v.clTLegend||fe===v.clTPaletteAxis}static draw(re,fe,de){return(0,be.A)(function*(){const pe=new L(re,fe);return(0,Re.ensureTCanvas)(pe,!1).then(()=>{if(fe.fName===v.kTitle&&fe._typename===v.clTPaveText){const ce=pe.getPadPainter().findPainterFor(null,v.kTitle,v.clTPaveText);if(ce&&ce!==pe)ce.removeFromPadPrimitives(),ce.cleanup();else if("postitle"===de||pe.isDummyPos(fe)){const K=v.gStyle,G=pe.getFramePainter();if(K&&G){const D=K.fTitleX,x=K.fTitleY;let P=K.fTitleW,w=K.fTitleH;w||(w=.7*(x-G.fY2NDC)),P||(P=G.fX2NDC-G.fX1NDC),(!Number.isFinite(w)||w<=0)&&(w=.06),(!Number.isFinite(P)||P<=0)&&(P=.44),fe.fX1NDC=D-P/2,fe.fY1NDC=x-w,fe.fX2NDC=D+P/2,fe.fY2NDC=x,fe.fInit=1}}}else fe._typename===v.clTPaletteAxis&&(fe.fBorderSize=1,fe.fShadowColor=0,fe.fAxis&&(fe.fAxis.fChopt||(fe.fAxis.fChopt="+"),fe.fAxis.fNdiv||(fe.fAxis.fNdiv=12),fe.fAxis.fLabelOffset||(fe.fAxis.fLabelOffset=.005)),pe.z_handle=new Ke.TB(re,fe.fAxis,!0),pe.z_handle.setPadName(pe.getPadName()),pe.UseContextMenu=!0);switch(pe.NoFillStats="nofillstats"===de||"stats"!==fe.fName,fe._typename){case v.clTPaveLabel:case v.clTPaveClass:pe.paveDrawFunc=pe.drawPaveLabel;break;case v.clTPaveStats:pe.paveDrawFunc=pe.drawPaveStats;break;case v.clTPaveText:case v.clTPavesText:case v.clTDiamond:pe.paveDrawFunc=pe.drawPaveText;break;case v.clTLegend:pe.AutoPlace="autoplace"===de,pe.paveDrawFunc=pe.drawLegend;break;case v.clTPaletteAxis:pe.paveDrawFunc=pe.drawPaletteAxis}return pe.drawPave(de)})})()}}},7387:(Gr,xt,Te)=>{"use strict";Te.d(xt,{CS:()=>g,QK:()=>Qe,SF:()=>N,cD:()=>Ie,s6:()=>C,u$:()=>O,wx:()=>b});var be=Te(4186),v=Te(3324),V=Te(5225),Le=Te(541),xe=Te(2009),Je=Te(2525),st=Te(2105),Ke=Te(1631);function ot(H,X,ie){if((0,Je.KA)(X))return new Le._l((0,Je.xV)(X),{font:xe.Te,size:ie,height:0,curveSegments:5});const z=100*ie,m=[];let I=5;class A{constructor(ct,$){this.kind=ct??"g",this.childs=[],this.x=0,this.y=0,this.font_size=$?.font_size??z,$?.childs.push(this)}append(ct){return"svg:g"===ct?new A("g",this):"svg:text"===ct?new A("text",this):"svg:path"===ct?new A("path",this):void console.log("should create",ct)}style(ct,$){return"stroke-width"===ct&&$&&(I=Number.parseInt($)),this}translate(){this.geom&&this.geom.translate(this.x,this.y,0),this.childs.forEach(ct=>{ct.x+=this.x,ct.y+=this.y,ct.translate()})}attr(ct,$){const tt=()=>{if(!$)return"";const Ne=$[0];return $=$.slice(1),Ne},We=Ne=>{let Fe=0;for(;$[Fe]>="0"&&$[Fe]<="9"||"-"===$[Fe];)Fe++;const ht=Number.parseInt($.slice(0,Fe));return $=$.slice(Fe),Ne&&tt(),ht};if("font-size"===ct&&$)this.font_size=Number.parseInt($);else if("transform"===ct&&(0,be.isStr)($)&&0===$.indexOf("translate")){const Ne=$.slice($.indexOf("(")+1,$.lastIndexOf(")")).split(",");this.x+=Ne[0]?.01*Number.parseInt(Ne[0]):0,this.y-=Ne[1]?.01*Number.parseInt(Ne[1]):0}else if("x"===ct&&"text"===this.kind)this.x+=.01*Number.parseInt($);else if("y"===ct&&"text"===this.kind)this.y-=.01*Number.parseInt($);else if("d"===ct&&"path"===this.kind){if("M"!==tt())return console.error("Not starts with M");const Ne=[];let pt,Fe=We(!0),ht=We();for(;pt=tt();){let rt=Fe,_t=ht;switch(pt){case"L":rt=We(!0),_t=We();break;case"l":rt+=We(!0),_t+=We();break;case"H":rt=We();break;case"h":rt+=We();break;case"V":_t=We();break;case"v":_t+=We();break;default:console.log("not supported operator",pt)}const Yt=Math.atan2(_t-ht,rt-Fe),kt=.5*I*Math.sin(Yt),Tt=-.5*I*Math.cos(Yt);Ne.push(Fe-kt,ht-Tt,0,rt-kt,_t-Tt,0,rt+kt,_t+Tt,0,Fe-kt,ht-Tt,0,rt+kt,_t+Tt,0,Fe+kt,ht+Tt,0),Fe=rt,ht=_t}const dt=new Float32Array(Ne);this.geom=new V.LoY,this.geom.setAttribute("position",new V.THS(dt,3)),this.geom.scale(.01,-.01,.01),this.geom.computeVertexNormals(),m.push(this.geom)}return this}text(ct){"text"===this.kind&&(this.geom=new Le._l(ct,{font:xe.Te,size:Math.round(.01*this.font_size),height:0,curveSegments:5}),m.push(this.geom))}}const R=new A;if((0,Je.Bm)(H,R,{font_size:z,latex:1,x:0,y:0,text:X,align:["start","top"],fast:!0,font:{size:z,isMonospace:()=>!1,aver_width:.9}}),!m.length)return new Le._l((0,Je.xV)(X),{font:xe.Te,size:ie,height:0,curveSegments:5});if(R.translate(),1===m.length)return m[0];let ee=0;m.forEach(Xe=>{ee+=Xe.getAttribute("position").array.length});const ge=new Float32Array(ee),ve=new Float32Array(ee);let Se=0;m.forEach(Xe=>{const ct=Xe.getAttribute("position").array,$=Xe.getAttribute("normal").array;for(let tt=0;tt<ct.length;++tt,++Se)ge[Se]=ct[tt],ve[Se]=$[tt]});const De=new V.LoY;return De.setAttribute("position",new V.THS(ge,3)),De.setAttribute("normal",new V.THS(ve,3)),De}function Re(H,X,ie=!1,z=!1){let m;if(X?.children)for(let ee=0;ee<X.children.length&&(m=X.children[ee],!m.axis_draw);++ee)m=void 0;if(!m)return;if(!H)return void X.remove(m);const I=H.position;let A=1;I.x<0&&I.y>=0&&(A=2),I.x>=0&&I.y>=0&&(A=3),I.x>=0&&I.y<0&&(A=4);const R=(ee,ge)=>(ee<=A&&(ee+=4),ee>A&&ee<A+ge),k=ee=>{for(let ge=0;ge<ee.children?.length;++ge)void 0!==ee.children[ge].zoom&&(ee.children[ge].zoom_disabled=!ee.visible)};for(let ee=0;ee<m.children.length;++ee){const ge=m.children[ee];if(ge.grid)ge.visible=z&&R(ge.grid,3);else if(ge.zid)ge.visible=R(ge.zid,2),k(ge);else if(ge.xyid)ge.visible=R(ge.xyid,3),k(ge);else if(ge.xyboxid){let ve=5,Se=0;z&&!ie?(ve=3,Se=-2):ie&&!z?ve=3:!ie&&!z&&(ve=ge.bottom?3:0),ge.visible=R(ge.xyboxid+Se,ve),!ge.visible&&ge.bottom&&z&&(ge.visible=R(ge.xyboxid,3))}else if(ge.zboxid){let ve=2,Se=0;ie&&z?ve=5:z&&!ie?ve=4:!z&&ie&&(Se=-2,ve=4),ge.visible=R(ge.zboxid+Se,ve)}}}function Qe(H,X,ie,z){if(H.options.System===st.m)return X;const m=H.getFramePainter();let I=1/m.size_x3d,A=1/m.size_y3d;if(ie&&z&&(I*=ie/(ie-1),A*=z/(z-1)),H.options.System===st.Ee)for(let R=0;R<X.length;R+=3){const k=(1-X[R]*I)*Math.PI,ee=.5+.5*X[R+1]*A;X[R]=Math.cos(k)*ee*m.size_x3d,X[R+1]=Math.sin(k)*ee*m.size_y3d}else if(H.options.System===st.ef)for(let R=0;R<X.length;R+=3){const k=(1-X[R]*I)*Math.PI,ee=.5+X[R+2]/m.size_z3d/4;X[R]=Math.cos(k)*ee*m.size_x3d,X[R+2]=(1+Math.sin(k)*ee)*m.size_z3d}else if(H.options.System===st.ZE)for(let R=0;R<X.length;R+=3){const k=(1+X[R]*I)*Math.PI,ee=X[R+1]*A*Math.PI,ge=.5+X[R+2]/m.size_z3d/4;X[R]=ge*Math.cos(ee)*Math.cos(k)*m.size_x3d,X[R+1]=ge*Math.cos(ee)*Math.sin(k)*m.size_y3d,X[R+2]=(1+ge*Math.sin(ee))*m.size_z3d}else if(H.options.System===st.kH)for(let R=0;R<X.length;R+=3){const k=(1-X[R]*I)*Math.PI,ee=X[R+1]*A*Math.PI,ge=.5+X[R+2]/m.size_z3d/4;X[R]=ge*Math.cos(k)*m.size_x3d,X[R+1]=ge*Math.sin(ee)/Math.cos(ee)*m.size_y3d/2,X[R+2]=(1+ge*Math.sin(k))*m.size_z3d}return X}function Ie(H,X,ie,z,m){const I=new V.LoY;return H.options.System===st.m?(I.setAttribute("position",new V.THS(X,3)),ie?I.setAttribute("normal",new V.THS(ie,3)):I.computeVertexNormals()):(Qe(H,X,z,m),I.setAttribute("position",new V.THS(X,3)),I.computeVertexNormals()),I}function L(H,X){H.camera&&(H.scene.remove(H.camera),(0,xe.G1)(H.camera),delete H.camera),H.camera=X?new V.qUd(-1.3*H.size_x3d,1.3*H.size_x3d,2.3*H.size_z3d,-.7*H.size_z3d,.001,40*H.size_z3d):new V.ubm(45,H.scene_width/H.scene_height,1,40*H.size_z3d),H.camera.up.set(0,0,1),H.pointLight=new V.ZyN(16777215,3),H.pointLight.position.set(H.size_x3d/2,H.size_y3d/2,H.size_z3d/2),H.camera.add(H.pointLight),H.lookat=new V.Pq0(0,0,X?.3*H.size_z3d:.8*H.size_z3d),H.scene.add(H.camera)}function he(H,X){const ie=H.getPadPainter().getRootPad(!0),z=H.camera.isOrthographicCamera?1:1.4;let m=Math.max(.75*H.size_x3d,H.size_z3d),I=Math.max(.75*H.size_y3d,H.size_z3d);if(X&&(m===I?H.camera.position.set(-1.6*m,-3.5*I,z*H.size_z3d):m>I?H.camera.position.set(-2*m,-3.5*I,z*H.size_z3d):H.camera.position.set(-3.5*m,-2*I,z*H.size_z3d)),ie&&(X||!H.zoomChangedInteractive())&&Number.isFinite(ie.fTheta)&&Number.isFinite(ie.fPhi)&&(ie.fTheta!==H.camera_Theta||ie.fPhi!==H.camera_Phi)){H.camera_Phi=ie.fPhi,H.camera_Theta=ie.fTheta,m=3*Math.max(H.size_x3d,H.size_z3d),I=3*Math.max(H.size_y3d,H.size_z3d);const A=(270-ie.fPhi)/180*Math.PI,R=(ie.fTheta-10)/180*Math.PI;H.camera.position.set(m*Math.cos(A)*Math.cos(R),I*Math.sin(A)*Math.cos(R),H.size_z3d+(z-.9)*(m+I)*Math.sin(R)),X=!0}if(X&&H.camera.lookAt(H.lookat),X&&H.camera.isOrthographicCamera&&H.scene_width&&H.scene_height){const A=H.scene_width/H.scene_height,R=H.camera.right-H.camera.left,k=H.camera.top-H.camera.bottom;if(A>R/k){const ee=(H.camera.right+H.camera.left)/2;H.camera.left=ee-k*A/2,H.camera.right=ee+k*A/2}else{const ee=(H.camera.top+H.camera.bottom)/2;H.camera.top=ee+R/A/2,H.camera.bottom=ee-R/A/2}}H.camera.updateProjectionMatrix()}function re(H){H.control=(0,xe.Sc)(H,H.camera,H.scene,H.renderer,H.lookat);const X=H,ie=H.getMainPainter();H.control.processMouseMove=function(z){let m=null,I=null,A=null;const R=X.isTooltipAllowed();for(let k=0;k<z.length;++k)if(R&&(0,be.isFunc)(z[k].object?.tooltip)){if(m=z[k].object.tooltip(z[k]),m){I=z[k].object;break}}else z[k].object?.zoom&&!A&&(A=z[k].object);if(m&&!m.use_itself){const k=1e-4*X.size_x3d,ee=1e-4*X.size_y3d,ge=1e-4*X.size_z3d;(m.x1>m.x2||m.y1>m.y2||m.z1>m.z2)&&console.warn("check 3D hints coordinates"),m.x1-=k,m.x2+=k,m.y1-=ee,m.y2+=ee,m.z1-=ge,m.z2+=ge}if(X.highlightBin3D(m,I),!m&&A&&(0,be.isFunc)(X.get3dZoomCoord)){let k=A.zoom;const ee=A.globalIntersect(this.raycaster),ge=X.get3dZoomCoord(ee,k);return"z"===k&&A.use_y_for_z&&(k="y"),{name:k,title:"axis object",line:k+" : "+X.axisAsText(k,ge),only_status:!0}}return m?.lines?m:""},H.control.processMouseLeave=function(){X.highlightBin3D(null)},H.control.contextMenu=function(z,m){let I="painter",A=ie;if(m)for(let k=0;k<m.length;++k){const ee=m[k].object;if(ee.zoom){I=ee.zoom,A=null;break}if((0,be.isFunc)(ee.painter?.fillContextMenu)){A=ee.painter;break}}const R=ie.getFramePainter();(0,be.isFunc)(R?.showContextMenu)&&R.showContextMenu(I,z,A)}}function fe(H,X,ie,z){if(-1===H){if(!this.mode3d)return;return(0,be.isFunc)(this.clear3dCanvas)?(Re(null,this.toplevel),this.clear3dCanvas(),(0,xe.G1)(this.scene),this.control?.cleanup(),(0,xe.yW)(this.renderer),delete this.size_x3d,delete this.size_y3d,delete this.size_z3d,delete this.tooltip_mesh,delete this.scene,delete this.toplevel,delete this.camera,delete this.pointLight,delete this.renderer,delete this.control,this.render_tmout&&(clearTimeout(this.render_tmout),delete this.render_tmout),void(this.mode3d=!1)):void console.error(`Strange, why mode3d=${this.mode3d} is configured!!!!`)}if(this.mode3d=!0,"toplevel"in this){this.scene.remove(this.toplevel),(0,xe.G1)(this.toplevel),delete this.tooltip_mesh,delete this.toplevel,this.control&&this.control.HideTooltip();const I=new V.B69;return this.scene.add(I),this.toplevel=I,this.resize3D(),he(this,!1),Promise.resolve(!0)}H=(0,xe.ke)(H,this.isBatchMode()),(0,xe.LR)(this);const m=this.getSizeFor3d(void 0,H);return this.size_z3d=100,this.size_x3d=this.size_y3d=m.height>10&&m.width>10?Math.round(m.width/m.height*this.size_z3d):this.size_z3d,X&&(this.size_x3d*=X),ie&&(this.size_y3d*=ie),this.scene=new V.Z58,this.toplevel=new V.B69,this.scene.add(this.toplevel),this.scene_width=m.width,this.scene_height=m.height,this.scene_x=m.x??0,this.scene_y=m.y??0,this.camera_Phi=30,this.camera_Theta=30,L(this,z),he(this,!0),(0,xe.Yw)(this.scene_width,this.scene_height,H).then(I=>(this.renderer=I,this.webgl=H===be.constants.Render3D.WebGL,this.add3dCanvas(m,this.renderer.jsroot_dom,this.webgl),this.first_render_tm=0,this.enable_highlight=!1,!this.isBatchMode()&&this.webgl&&!(0,be.isNodeJs)()&&re(this),this))}function de(H){let X=!1;this.control&&(this.control.cleanup(),delete this.control,X=!0),L(this,H),he(this,!0),X&&re(this),this.render3D()}function pe(H,X,ie){if(H){if(!this.toplevel)return console.error("3D objects are not yet created in the frame");X&&ie&&this.remove3DMeshes(X),this.toplevel.add(H),H._painter=X}}function ce(H){if(!H||!this.toplevel)return;let X=this.toplevel.children.length;for(;X>0;){const ie=this.toplevel.children[--X];ie._painter===H&&(this.toplevel.remove(ie),(0,xe.G1)(ie))}}function K(H){if(-1111===H){const m=(0,be.getDocument)(),I=(0,xe.mZ)(!1,0,m);if(I.setSize(this.scene_width,this.scene_height),I.render(this.scene,this.camera),I.makeOuterHTML){const A=m.createElement("div");return A.innerHTML=I.makeOuterHTML(),A.childNodes[0]}return I.domElement}void 0===H&&(H=5);const X=this.isBatchMode();if(H>0&&!this.usesvg&&!X)return void(this.render_tmout||(this.render_tmout=setTimeout(()=>this.render3D(0),H)));if(this.render_tmout&&(clearTimeout(this.render_tmout),delete this.render_tmout),!this.renderer)return;(0,xe.rv)(this.renderer);const ie=new Date;Re(this.camera,this.toplevel,this.opt3d?.FrontBox,this.opt3d?.BackBox),this.renderer.render(this.scene,this.camera),(0,xe.oE)(this.renderer),0===this.first_render_tm&&(this.first_render_tm=(new Date).getTime()-ie.getTime(),this.enable_highlight=this.first_render_tm<1200&&this.isTooltipAllowed(),this.first_render_tm>500&&console.log(`three.js r${V.sPf}, first render tm = ${this.first_render_tm}`)),this.processRender3D&&this.getPadPainter()?.painters?.forEach(m=>{(0,be.isFunc)(m.handleRender3D)&&m.handleRender3D()})}function G(){const H=this.getSizeFor3d(this.access3dKind());return this.apply3dSize(H),!(this.scene_width===H.width&&this.scene_height===H.height||H.width<10||H.height<10||(this.scene_width=H.width,this.scene_height=H.height,this.camera.aspect=this.scene_width/this.scene_height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.scene_width,this.scene_height),0))}function D(H,X){const ie=!H||void 0===H.x1||!this.enable_highlight;let z=!1,m=null,I=!0,A=this.getMainPainter();if(A&&(!A.provideUserTooltip||!A.hasUserTooltip())&&(A=null),this.tooltip_selfmesh&&(I=this.tooltip_selfmesh!==X,this.tooltip_selfmesh.material.color=this.tooltip_selfmesh.save_color,delete this.tooltip_selfmesh,z=!0),this.tooltip_mesh&&(m=this.tooltip_mesh,this.toplevel.remove(this.tooltip_mesh),delete this.tooltip_mesh,z=!0),ie)return z&&this.render3D(),void(z&&A&&A.provideUserTooltip(null));if(H.use_itself)X.save_color=X.material.color,X.material.color=new V.Q1f(H.color),this.tooltip_selfmesh=X,z=I;else{z=!0;const R=xe.DJ.Indexes,k=xe.DJ.Normals,ee=xe.DJ.Vertices,ge=new V.Q1f(H.color?H.color:16711680),ve=H.opacity||1;let Se,De;if(m)Se=m.geometry.attributes.position.array,m.geometry.attributes.position.needsUpdate=!0,m.material.color=ge,m.material.opacity=ve;else{Se=new Float32Array(3*R.length),De=new Float32Array(3*R.length);const Xe=new V.LoY;Xe.setAttribute("position",new V.THS(Se,3)),Xe.setAttribute("normal",new V.THS(De,3));const ct=new V.V9B({color:ge,opacity:ve,vertexColors:!1});m=new V.eaF(Xe,ct)}H.x1===H.x2&&console.warn(`same tip X ${H.x1} ${H.x2}`),H.y1===H.y2&&console.warn(`same tip Y ${H.y1} ${H.y2}`),H.z1===H.z2&&(H.z2=H.z1+1e-4);for(let Xe=0,ct=-3;Xe<R.length;++Xe){const $=ee[R[Xe]];Se[3*Xe]=H.x1+$.x*(H.x2-H.x1),Se[3*Xe+1]=H.y1+$.y*(H.y2-H.y1),Se[3*Xe+2]=H.z1+$.z*(H.z2-H.z1),De&&(Xe%6==0&&(ct+=3),De[3*Xe]=k[ct],De[3*Xe+1]=k[ct+1],De[3*Xe+2]=k[ct+2])}this.tooltip_mesh=m,this.toplevel.add(m),H.$painter&&H.$painter.options.System!==st.m&&(Qe(H.$painter,Se),m.geometry.computeVertexNormals())}z&&this.render3D(),z&&H.$projection&&(0,be.isFunc)(H.$painter?.redrawProjection)&&H.$painter.redrawProjection(H.ix-1,H.ix,H.iy-1,H.iy),z&&A?.getObject()&&A.provideUserTooltip({obj:A.getObject(),name:A.getObject().fName,bin:H.bin,cont:H.value,binx:H.ix,biny:H.iy,binz:H.iz,grx:(H.x1+H.x2)/2,gry:(H.y1+H.y2)/2,grz:(H.z1+H.z2)/2})}function x(H){this.opt3d=H}function P(H,X,ie){ie||(ie={}),!1===ie.drawany?ie.draw=!1:ie.drawany=!0;const z=ie.v7?null:this.getPadPainter().getRootPad(!0);let m=-this.size_x3d,I=this.size_x3d,A=-this.size_y3d,R=this.size_y3d,k=0,ee=2*this.size_z3d,ge=this.size_z3d,ve=this.xmin,Se=this.xmax,De=this.ymin,Xe=this.ymax,ct=this.zmin,$=this.zmax,tt=!1,We=!1;this.size_z3d||(m=this.xmin,I=this.xmax,A=this.ymin,R=this.ymax,k=this.zmin,ee=this.zmax,ge=ee-k),"zoom_xmin"in this&&"zoom_xmax"in this&&this.zoom_xmin!==this.zoom_xmax&&(ve=this.zoom_xmin,Se=this.zoom_xmax),"zoom_ymin"in this&&"zoom_ymax"in this&&this.zoom_ymin!==this.zoom_ymax&&(De=this.zoom_ymin,Xe=this.zoom_ymax,tt=!0),"zoom_zmin"in this&&"zoom_zmax"in this&&this.zoom_zmin!==this.zoom_zmax&&(ct=this.zoom_zmin,$=this.zoom_zmax,We=!0),ie.use_y_for_z&&(this.zmin=this.ymin,this.zmax=this.ymax,ct=De,$=Xe,We=tt,De=0,Xe=1),this.lego_zmin=ct,this.lego_zmax=$,void 0!==ie.zmult&&!We&&($*=ie.zmult),this.x_handle=new X(null,this.xaxis),ie.v7&&(this.x_handle.setPadName(this.getPadName()),this.x_handle.snapid=this.snapid),this.x_handle.configureAxis("xaxis",this.xmin,this.xmax,ve,Se,!1,[m,I],{log:z?.fLogx??0,reverse:ie.reverse_x}),this.x_handle.assignFrameMembers(this,"x"),this.x_handle.extractDrawAttributes(ge),this.y_handle=new X(null,this.yaxis),ie.v7&&(this.y_handle.setPadName(this.getPadName()),this.y_handle.snapid=this.snapid),this.y_handle.configureAxis("yaxis",this.ymin,this.ymax,De,Xe,!1,[A,R],{log:z&&!ie.use_y_for_z?z.fLogy:0,reverse:ie.reverse_y}),this.y_handle.assignFrameMembers(this,"y"),this.y_handle.extractDrawAttributes(ge),this.z_handle=new X(null,this.zaxis),ie.v7&&(this.z_handle.setPadName(this.getPadName()),this.z_handle.snapid=this.snapid),this.z_handle.configureAxis("zaxis",this.zmin,this.zmax,ct,$,!1,[k,ee],{log:(ie.use_y_for_z||2===ie.ndim?z?.fLogv:void 0)??z?.fLogz??0,reverse:ie.reverse_z}),this.z_handle.assignFrameMembers(this,"z"),this.z_handle.extractDrawAttributes(ge),this.setRootPadRange(z,!0);const Ne={},Fe={},ht=this.x_handle.createTicks(!1,!0),pt=this.y_handle.createTicks(!1,!0),dt=this.z_handle.createTicks(!1,!0);let rt=1;function _t(wt,W){const me=("ticks"===W?wt.ticksColor:wt.lineatt.color)||"black",_e="ticks"===W?wt.ticksWidth:wt.lineatt.width,Be=`${me}_${_e}`;return Fe[Be]||(Fe[Be]=new V.mrM((0,xe.Bx)(me,{linewidth:_e,vertexColors:!1}))),Fe[Be]}function Yt(wt,W,me){const _e=me||("title"===W?wt.titleFont?.color:wt.labelsFont?.color)||"black";return Ne[_e]||(Ne[_e]=new V.V9B((0,xe.Bx)(_e,{vertexColors:!1}))),Ne[_e]}const kt=new V.B69;kt.axis_draw=!0,H.add(kt);let Tt=[],fn=[],ln=0;for(;ht.next();){const wt=ht.grpos;let W=1===ht.kind,me=this.x_handle.format(ht.tick,2);if(ht.last_major()?this.x_handle.fTitle||(me="x"):null===me&&(W=!1,me=""),W&&me&&ie.draw){const _e=ht.get_modifier();_e?.fLabText&&(me=_e.fLabText);const Be=ot(this,me,this.x_handle.labelsFont.size);Be.computeBoundingBox();const gt=Be.boundingBox.max.x-Be.boundingBox.min.x,Et=Be.boundingBox.max.y-Be.boundingBox.min.y;Be.center=!0,Be.offsety=this.x_handle.labelsOffset+.005*(R-A),ln=Math.max(ln,Et),_e?.fTextColor&&(Be.color=this.getColor(_e.fTextColor)),Be.grx=wt,fn.push(Be);let Mt=0;ht.last_major()||(Mt=Math.abs(ht.next_major_grpos()-wt),gt>0&&Mt>0&&(rt=Math.min(rt,.9*Mt/gt))),this.x_handle.isCenteredLabels()&&(Mt||(Mt=Math.min(wt-m,I-wt)),Be.grx+=Mt/2)}Tt.push(wt,0,0,wt,this.x_handle.ticksSize*(W?-1:-.6),0)}if(this.x_handle.fTitle&&ie.draw){const wt=ot(this,this.x_handle.fTitle,this.x_handle.titleFont.size);wt.computeBoundingBox(),wt.center=this.x_handle.titleCenter,wt.opposite=this.x_handle.titleOpposite,wt.offsety=1.6*this.x_handle.titleOffset+.005*(R-A),wt.grx=(m+I)/2,wt.kind="title",fn.push(wt)}this.get3dZoomCoord=function(wt,W){const me=this[`scale_${W}min`],_e=this[`scale_${W}max`];let Be=wt[W];switch(W){case"x":Be=(Be+this.size_x3d)/2/this.size_x3d;break;case"y":Be=(Be+this.size_y3d)/2/this.size_y3d;break;case"z":Be=Be/2/this.size_z3d}return Be=this["log"+W]?Math.exp(Math.log(me)+Be*(Math.log(_e)-Math.log(me))):me+Be*(_e-me),Be};const mn=(wt,W,me)=>{const _e=new V.LoY,Be=Math.max(this[wt+"_handle"].ticksSize,.005*W);let gt;gt="z"===wt?new Float32Array([0,0,0,4*Be,0,2*W,4*Be,0,0,0,0,0,0,0,2*W,4*Be,0,2*W]):new Float32Array([-W,0,0,W,4*-Be,0,W,0,0,-W,0,0,-W,4*-Be,0,W,4*-Be,0]),_e.setAttribute("position",new V.THS(gt,3)),_e.computeVertexNormals();const Et=new V.V9B({transparent:!0,vertexColors:!1,side:V.$EB,opacity:0}),Mt=new V.eaF(_e,Et);return Mt.zoom=wt,Mt.size_3d=W,Mt.tsz=Be,Mt.use_y_for_z=me,"y"===wt&&Mt.rotateZ(Math.PI/2).rotateX(Math.PI),Mt.v1=new V.Pq0(gt[0],gt[1],gt[2]),Mt.v2=new V.Pq0(gt[6],gt[7],gt[8]),Mt.v3=new V.Pq0(gt[3],gt[4],gt[5]),Mt.globalIntersect=function(Nt){if(!this.v1||!this.v2||!this.v3)return;const Qt=new V.Zcv;Qt.setFromCoplanarPoints(this.v1,this.v2,this.v3),Qt.applyMatrix4(this.matrixWorld);const Zt=Nt.ray.origin.clone(),dn=Zt.clone().addScaledVector(Nt.ray.direction,1e10),vn=Qt.intersectLine(new V.cZY(Zt,dn),new V.Pq0);if(!vn)return;let Fn=-this.size_3d,ai=this.size_3d;return"z"===this.zoom&&(Fn=0,ai=2*this.size_3d),vn[this.zoom]<Fn?vn[this.zoom]=Fn:vn[this.zoom]>ai&&(vn[this.zoom]=ai),vn},Mt.showSelection=function(Nt,Qt){const Zt=this.zoom;let vn,dn=this.children?this.children[0]:null;if(!Nt||!Qt)return dn&&(this.remove(dn),(0,xe.G1)(dn)),dn;if(!this.geometry)return!1;if(dn)vn=dn.geometry;else{vn=this.geometry.clone();const ai=vn.getAttribute("position").array;"z"===Zt?ai[6]=ai[3]=ai[15]=this.tsz:ai[4]=ai[16]=ai[13]=-this.tsz,dn=new V.eaF(vn,new V.V9B({color:65280,side:V.$EB,vertexColors:!1})),this.add(dn)}const Fn=vn.getAttribute("position").array;return"z"===Zt?(Fn[2]=Fn[11]=Fn[8]=Nt[Zt],Fn[5]=Fn[17]=Fn[14]=Qt[Zt]):(Fn[0]=Fn[9]=Fn[12]=Nt[Zt],Fn[6]=Fn[3]=Fn[15]=Qt[Zt]),vn.getAttribute("position").needsUpdate=!0,!0},Mt};let Sn,jt=new V.B69;for(jt.position.set(0,A,k),jt.rotation.x=1/4*Math.PI,jt.xyid=2,ie.draw&&(Sn=(0,xe.Fc)(Tt,_t(this.x_handle,"ticks")),jt.add(Sn)),fn.forEach(wt=>{const W=wt.boundingBox.max.x-wt.boundingBox.min.x,me=wt.center?wt.grx-W/2:wt.opposite?m:I-W,_e=new V.kn4;_e.set(rt,0,0,me,0,rt,0,-ln*rt-this.x_handle.ticksSize-wt.offsety,0,0,1,0,0,0,0,1);const Be=new V.eaF(wt,Yt(this.x_handle,wt.kind,wt.color));Be.applyMatrix4(_e),jt.add(Be)}),ie.zoom&&ie.drawany&&jt.add(mn("x",this.size_x3d)),kt.add(jt),jt=new V.B69,jt.position.set(0,R,k),jt.rotation.x=3/4*Math.PI,ie.draw&&jt.add(new V.DXC(Sn.geometry,Sn.material)),fn.forEach(wt=>{const W=wt.boundingBox.max.x-wt.boundingBox.min.x,me=wt.center?wt.grx+W/2:wt.opposite?m+W:I,_e=new V.kn4;_e.set(-rt,0,0,me,0,rt,0,-ln*rt-this.x_handle.ticksSize-wt.offsety,0,0,-1,0,0,0,0,1);const Be=new V.eaF(wt,Yt(this.x_handle,wt.kind,wt.color));Be.applyMatrix4(_e),jt.add(Be)}),jt.xyid=4,ie.zoom&&ie.drawany&&jt.add(mn("x",this.size_x3d)),kt.add(jt),fn=[],rt=1,ln=0,Tt=[];pt.next();){const wt=pt.grpos;let W=1===pt.kind,me=this.y_handle.format(pt.tick,2);if(pt.last_major()?this.y_handle.fTitle||(me="y"):null===me&&(W=!1,me=""),W&&me&&ie.draw){const _e=pt.get_modifier();_e?.fLabText&&(me=_e.fLabText);const Be=ot(this,me,this.y_handle.labelsFont.size);Be.computeBoundingBox();const gt=Be.boundingBox.max.x-Be.boundingBox.min.x,Et=Be.boundingBox.max.y-Be.boundingBox.min.y;Be.center=!0,ln=Math.max(ln,Et),_e?.fTextColor&&(Be.color=this.getColor(_e.fTextColor)),Be.gry=wt,Be.offsetx=this.y_handle.labelsOffset+.005*(I-m),fn.push(Be);let Mt=0;pt.last_major()||(Mt=Math.abs(pt.next_major_grpos()-wt),gt>0&&(rt=Math.min(rt,.9*Mt/gt))),this.y_handle.isCenteredLabels()&&(Mt||(Mt=Math.min(wt-A,R-wt)),Be.gry+=Mt/2)}Tt.push(0,wt,0,this.y_handle.ticksSize*(W?-1:-.6),wt,0)}if(this.y_handle.fTitle&&ie.draw){const wt=ot(this,this.y_handle.fTitle,this.y_handle.titleFont.size);wt.computeBoundingBox(),wt.center=this.y_handle.titleCenter,wt.opposite=this.y_handle.titleOpposite,wt.offsetx=1.6*this.y_handle.titleOffset+.005*(I-m),wt.gry=(A+R)/2,wt.kind="title",fn.push(wt)}if(!ie.use_y_for_z){let wt,W=new V.B69;W.position.set(m,0,k),W.rotation.y=-1/4*Math.PI,ie.draw&&(wt=(0,xe.Fc)(Tt,_t(this.y_handle,"ticks")),W.add(wt)),fn.forEach(me=>{const _e=me.boundingBox.max.x-me.boundingBox.min.x,Be=me.center?me.gry+_e/2:me.opposite?A+_e:R,gt=new V.kn4;gt.set(0,rt,0,-ln*rt-this.y_handle.ticksSize-me.offsetx,-rt,0,0,Be,0,0,1,0,0,0,0,1);const Et=new V.eaF(me,Yt(this.y_handle,me.kind,me.color));Et.applyMatrix4(gt),W.add(Et)}),W.xyid=3,ie.zoom&&ie.drawany&&W.add(mn("y",this.size_y3d)),kt.add(W),W=new V.B69,W.position.set(I,0,k),W.rotation.y=-3/4*Math.PI,ie.draw&&W.add(new V.DXC(wt.geometry,wt.material)),fn.forEach(me=>{const _e=me.boundingBox.max.x-me.boundingBox.min.x,Be=me.center?me.gry-_e/2:me.opposite?A:R-_e,gt=new V.kn4;gt.set(0,rt,0,-ln*rt-this.y_handle.ticksSize-me.offsetx,rt,0,0,Be,0,0,-1,0,0,0,0,1);const Et=new V.eaF(me,Yt(this.y_handle,me.kind,me.color));Et.applyMatrix4(gt),W.add(Et)}),W.xyid=1,ie.zoom&&ie.drawany&&W.add(mn("y",this.size_y3d)),kt.add(W)}fn=[],rt=1,Tt=[];let cn=null,gn=null,Cn=null,Ln=0;for(this.size_z3d&&ie.drawany&&(cn=[],gn=[]);dt.next();){const wt=dt.grpos;let W=1===dt.kind,me=this.z_handle.format(dt.tick,2);if(null===me&&(W=!1,me=""),W&&me&&ie.draw){const _e=dt.get_modifier();_e?.fLabText&&(me=_e.fLabText);const Be=ot(this,me,this.z_handle.labelsFont.size);Be.computeBoundingBox();const gt=Be.boundingBox.max.x-Be.boundingBox.min.x,Et=Be.boundingBox.max.y-Be.boundingBox.min.y;Be.translate(-gt,-Et/2,0),_e?.fTextColor&&(Be.color=this.getColor(_e.fTextColor)),Be.grz=wt,fn.push(Be),null!==Cn&&Et>0&&(rt=Math.min(rt,.9*(wt-Cn)/Et)),Ln=Math.max(Ln,gt),Cn=wt}cn&&W&&cn.push(m,0,wt,I,0,wt),gn&&W&&gn.push(0,A,wt,0,R,wt),Tt.push(0,0,wt,this.z_handle.ticksSize*(W?1:.6),0,wt)}if(cn&&cn.length>0){const wt=new V.Fvt({color:this.x_handle.ticksColor,dashSize:2,gapSize:2}),W=(0,xe.Fc)(cn,wt);W.position.set(0,R,0),W.grid=2,W.visible=!1,kt.add(W);const me=new V.DXC(W.geometry,wt);me.position.set(0,A,0),me.grid=4,me.visible=!1,kt.add(me)}if(gn&&gn.length>0){const wt=new V.Fvt({color:this.y_handle.ticksColor,dashSize:2,gapSize:2}),W=(0,xe.Fc)(gn,wt);W.position.set(I,0,0),W.grid=3,W.visible=!1,kt.add(W);const me=new V.DXC(W.geometry,wt);me.position.set(m,0,0),me.grid=1,me.visible=!1,kt.add(me)}const Zn=[],ui=ie.draw?(0,xe.Fc)(Tt,_t(this.z_handle,"ticks")):null;for(let wt=0;wt<4;++wt){if(Zn.push(new V.B69),fn.forEach((W,me)=>{const _e=new V.kn4;let Be=W.grz;this.z_handle.isCenteredLabels()&&(me<fn.length-1?Be=(Be+fn[me+1].grz)/2:me>0&&(Be=Math.min(1.5*Be-.5*fn[me-1].grz,ee))),_e.set(-rt,0,0,this.z_handle.ticksSize+.005*(I-m)+this.z_handle.labelsOffset,0,0,1,0,0,rt,0,Be);const gt=new V.eaF(W,Yt(this.z_handle));gt.applyMatrix4(_e),Zn[wt].add(gt)}),this.z_handle.fTitle&&ie.draw){const W=ot(this,this.z_handle.fTitle,this.z_handle.titleFont.size);W.computeBoundingBox();const me=W.boundingBox.max.x-W.boundingBox.min.x,_e=this.z_handle.titleCenter?(ee+k-me)/2:this.z_handle.titleOpposite?k:ee-me;W.rotateZ(Math.PI/2);const Be=new V.kn4;Be.set(-rt,0,0,this.z_handle.ticksSize+.005*(I-m)+Ln+this.z_handle.titleOffset,0,0,1,0,0,rt,0,_e);const gt=new V.eaF(W,Yt(this.z_handle,"title"));gt.applyMatrix4(Be),Zn[wt].add(gt)}ie.draw&&ui&&Zn[wt].add(0===wt?ui:new V.DXC(ui.geometry,ui.material)),ie.zoom&&ie.drawany&&Zn[wt].add(mn("z",this.size_z3d,ie.use_y_for_z)),Zn[wt].zid=wt+2,kt.add(Zn[wt])}if(Zn[0].position.set(m,R,0),Zn[0].rotation.z=3/4*Math.PI,Zn[1].position.set(I,R,0),Zn[1].rotation.z=1/4*Math.PI,Zn[2].position.set(I,A,0),Zn[2].rotation.z=-1/4*Math.PI,Zn[3].position.set(m,A,0),Zn[3].rotation.z=-3/4*Math.PI,!ie.drawany)return;const hi=_t(this.x_handle),qi=(0,xe.Fc)([m,0,0,I,0,0],hi,null,!0);for(let wt=0;wt<2;++wt){let W=new V.DXC(qi,hi);W.position.set(0,A,0===wt?k:ee),W.xyboxid=2,W.bottom=0===wt,kt.add(W),W=new V.DXC(qi,hi),W.position.set(0,R,0===wt?k:ee),W.xyboxid=4,W.bottom=0===wt,kt.add(W)}const Mr=_t(this.y_handle),Sr=(0,xe.Fc)([0,A,0,0,R,0],Mr,null,!0);for(let wt=0;wt<2;++wt){let W=new V.DXC(Sr,Mr);W.position.set(m,0,0===wt?k:ee),W.xyboxid=3,W.bottom=0===wt,kt.add(W),W=new V.DXC(Sr,Mr),W.position.set(I,0,0===wt?k:ee),W.xyboxid=1,W.bottom=0===wt,kt.add(W)}const ms=_t(this.z_handle),fs=(0,xe.Fc)([0,0,k,0,0,ee],ms,null,!0);for(let wt=0;wt<4;++wt){const W=new V.DXC(fs,ms);W.zboxid=Zn[wt].zid,W.position.copy(Zn[wt].position),kt.add(W)}}function w(H,X,ie){H=this.x_handle.gr(H),X=this.y_handle.gr(X),ie=this.z_handle.gr(ie);const z=(new V.Pq0).set(H,X,ie);z.project(this.camera),z.x=(z.x+1)/2,z.y=(z.y+1)/2;const m=this.getPadPainter(),I=m?.getPadWidth(),A=m?.getPadHeight();return I&&A&&(z.x=(this.scene_x+z.x*this.scene_width)/I,z.y=(this.scene_y+z.y*this.scene_height)/A),z}function b(H){Object.assign(H,{create3DScene:fe,add3DMesh:pe,remove3DMeshes:ce,render3D:K,resize3D:G,change3DCamera:de,highlightBin3D:D,set3DOptions:x,drawXYZ:P,convert3DtoPadNDC:w})}function g(H,X=!1){if(!H.draw_content)return;const ie=xe.DJ.Vertices,z=xe.DJ.Indexes,m=xe.DJ.Normals,I=xe.DJ.Segments,A=[0,1,1,2,2,3,3,0],R=[new V.Pq0(0,0,0),new V.Pq0(0,1,0),new V.Pq0(1,1,0),new V.Pq0(1,0,0)],k=H.getFramePainter(),ee=H.prepareDraw({rounding:!1,use3d:!0,extra:1}),ge=H.options.cutg,ve=ee.i1,Se=ee.i2,De=ee.j1,Xe=ee.j2,ct=H.getHisto(),$=ct.$baseh,tt=11===H.options.Lego||13===H.options.Lego,We=ct.getBin(Se,Xe)<65535;if(ve>=Se||De>=Xe)return;let Ne,Fe,ht,pt,dt,rt,_t,Yt,kt,Tt,fn,ln,mn,jt,Sn,cn=k.z_handle.getScaleMin(),gn=k.z_handle.getScaleMax();const Cn=(Mt,Nt,Qt)=>(ln=ct.getBinContent(Mt+1,Nt+1),fn=$?$.getBinContent(Mt+1,Nt+1):!1!==H.options.BaseLine?H.options.BaseLine:H.options.Zero?cn:0,ln<fn&&([fn,ln]=[ln,fn]),!(fn>=Fe||ln<Ne||ge&&!ge.IsInside(ct.fXaxis.GetBinCoord(Mt+.5),ct.fYaxis.GetBinCoord(Nt+.5)))&&(mn=ln===Ne||fn>=ln,!mn||Qt>0||!$&&(!!(H.options.Zero||cn>0)||H._show_empty_bins)));let Ln=[cn,gn],Zn=null;(12===H.options.Lego||14===H.options.Lego)&&(X?(Zn=k.getHistPalette(),H.createContour(k,Zn,{full_z_range:!0}),Ln=Zn.getContour(),cn=Ln[0],gn=Ln[Ln.length-1]):(Ln=H.createContour(ct.fContour?ct.fContour.length:20,k.lego_zmin,k.lego_zmax).arr,Zn=H.getHistPalette()));for(let Mt=0;Mt<Ln.length-1;++Mt){Ne=Ln[Mt],Fe=Ln[Mt+1],Zn&&Mt===Ln.length-2&&Fe<gn&&(Fe=gn);const Nt=k.grz(Ne),Qt=k.grz(Fe);let Zt=0,dn=0,vn=0,Fn=0;for(ht=ve;ht<Se;++ht)for(pt=De;pt<Xe;++pt)Cn(ht,pt,Mt)&&(jt=!mn&&Mt>0,Sn=!mn&&ln>Fe&&Mt<Ln.length-2,vn+=mn?12:z.length,jt&&(vn-=6),Sn&&(vn-=6),tt&&!mn&&(vn-=12,Fn+=12));const ai=new Float32Array(3*vn),$n=new Float32Array(3*vn),kn=We?new Uint16Array(vn/3):new Uint32Array(vn/3),Rn=0===Fn?null:new Float32Array(3*Fn),ei=0===Fn?null:new Float32Array(3*Fn),Yi=0===Fn?null:We?new Uint16Array(Fn/3):new Uint32Array(Fn/3);let E,J,Ae,Ue=0,Y=0;for(ht=ve;ht<Se;++ht)for(_t=ee.grx[ht]+ee.xbar1*(ee.grx[ht+1]-ee.grx[ht]),Yt=ee.grx[ht]+ee.xbar2*(ee.grx[ht+1]-ee.grx[ht]),pt=De;pt<Xe;++pt){if(!Cn(ht,pt,Mt))continue;jt=!mn&&Mt>0,Sn=!mn&&ln>Fe&&Mt<Ln.length-2,kt=ee.gry[pt]+ee.ybar1*(ee.gry[pt+1]-ee.gry[pt]),Tt=ee.gry[pt]+ee.ybar2*(ee.gry[pt+1]-ee.gry[pt]),Zt=fn<=Ne?Nt:k.grz(fn),dn=ln>Fe?Qt:k.grz(ln),Ae=0,J=0,mn&&(Ae+=12,J+=24);const qt=ct.getBin(ht+1,pt+1);let at=z.length;for(jt&&(at-=6);J<at;)E=ie[z[J]],tt&&J<12?(Rn[Y]=_t+E.x*(Yt-_t),Rn[Y+1]=kt+E.y*(Tt-kt),Rn[Y+2]=Zt+E.z*(dn-Zt),ei[Y]=m[Ae],ei[Y+1]=m[Ae+1],ei[Y+2]=m[Ae+2],Y%9==0&&(Yi[Y/9]=qt),Y+=3):(ai[Ue]=_t+E.x*(Yt-_t),ai[Ue+1]=kt+E.y*(Tt-kt),ai[Ue+2]=Zt+E.z*(dn-Zt),$n[Ue]=m[Ae],$n[Ue+1]=m[Ae+1],$n[Ue+2]=m[Ae+2],Ue%9==0&&(kn[Ue/9]=qt),Ue+=3),++J,J%6==0&&(Ae+=3,Sn&&J===z.length-12&&(J+=6,Ae+=3))}const Ce=Ie(H,ai,$n);let He=X?3:ct.fFillColor,nt=H.getColor(He);Zn?nt=X?Zn.getColor(Mt):Zn.calcColor(Mt,Ln.length):(1===H.options.Lego||He<2)&&(He=1,nt="white");const it=new V.V9B((0,xe.Bx)(nt,{vertexColors:!1})),lt=new V.eaF(Ce,it);if(lt.face_to_bins_index=kn,lt.painter=H,lt.zmin=cn,lt.zmax=gn,lt.baseline=!1!==H.options.BaseLine?H.options.BaseLine:H.options.Zero?cn:0,lt.tip_color=3===He?16711680:65280,lt.handle=ee,lt.tooltip=function(qt){if(qt.faceIndex<0||qt.faceIndex>=this.face_to_bins_index.length)return null;const at=this.painter,Jt=this.handle,tn=at.getFramePainter(),An=at.getHisto(),ze=at.get3DToolTip(this.face_to_bins_index[qt.faceIndex]),$e=Math.min(tn.size_x3d,Math.max(-tn.size_x3d,Jt.grx[ze.ix-1]+Jt.xbar1*(Jt.grx[ze.ix]-Jt.grx[ze.ix-1]))),ut=Math.min(tn.size_x3d,Math.max(-tn.size_x3d,Jt.grx[ze.ix-1]+Jt.xbar2*(Jt.grx[ze.ix]-Jt.grx[ze.ix-1]))),bt=Math.min(tn.size_y3d,Math.max(-tn.size_y3d,Jt.gry[ze.iy-1]+Jt.ybar1*(Jt.gry[ze.iy]-Jt.gry[ze.iy-1]))),Ot=Math.min(tn.size_y3d,Math.max(-tn.size_y3d,Jt.gry[ze.iy-1]+Jt.ybar2*(Jt.gry[ze.iy]-Jt.gry[ze.iy-1])));ze.x1=Math.min($e,ut),ze.x2=Math.max($e,ut),ze.y1=Math.min(bt,Ot),ze.y2=Math.max(bt,Ot);let _n=this.baseline,en=ze.value;return An.$baseh&&(_n=An.$baseh.getBinContent(ze.ix,ze.iy)),en<_n&&([_n,en]=[en,_n]),ze.z1=tn.grz(Math.max(this.zmin,_n)),ze.z2=tn.grz(Math.min(this.zmax,en)),ze.color=this.tip_color,ze.$painter=at,ze.$projection=at.is_projection&&2===at.getDimension(),ze},k.add3DMesh(lt),Fn>0){const qt=Ie(H,Rn,ei),at=new V.Q1f(He<2?16711680:(0,v.Qh)(nt).darker(.5).toString()),Jt=new V.V9B({color:at,vertexColors:!1}),tn=new V.eaF(qt,Jt);tn.face_to_bins_index=Yi,tn.painter=H,tn.handle=lt.handle,tn.tooltip=lt.tooltip,tn.zmin=lt.zmin,tn.zmax=lt.zmax,tn.baseline=lt.baseline,tn.tip_color=lt.tip_color,k.add3DMesh(tn)}}if(H.options.Lego>12)return;let ui=0,hi=0;for(Fe=gn,Ne=cn,ht=ve;ht<Se;++ht)for(pt=De;pt<Xe;++pt)Cn(ht,pt,0)&&(ui+=mn?R.length:ie.length,hi+=mn?A.length:I.length);const qi=ui<=65520;qi||(ui=3*hi);const Mr=new Float32Array(3*ui),Sr=qi?new Uint16Array(hi):null,ms=k.grz(cn),fs=k.grz(gn);let wt=0,W=0,me=0,_e=0;for(ht=ve;ht<Se;++ht)for(_t=ee.grx[ht]+ee.xbar1*(ee.grx[ht+1]-ee.grx[ht]),Yt=ee.grx[ht]+ee.xbar2*(ee.grx[ht+1]-ee.grx[ht]),pt=De;pt<Xe;++pt){if(!Cn(ht,pt,0))continue;kt=ee.gry[pt]+ee.ybar1*(ee.gry[pt+1]-ee.gry[pt]),Tt=ee.gry[pt]+ee.ybar2*(ee.gry[pt+1]-ee.gry[pt]),wt=fn<=cn?ms:k.grz(fn),W=ln>gn?fs:k.grz(ln);const Mt=mn?A:I,Nt=mn?R:ie;if(qi){for(dt=0;dt<Mt.length;++dt)Sr[_e++]=me/3+Mt[dt];for(dt=0;dt<Nt.length;++dt)rt=Nt[dt],Mr[me]=_t+rt.x*(Yt-_t),Mr[me+1]=kt+rt.y*(Tt-kt),Mr[me+2]=wt+rt.z*(W-wt),me+=3}else for(dt=0;dt<Mt.length;++dt)rt=Nt[Mt[dt]],Mr[me]=_t+rt.x*(Yt-_t),Mr[me+1]=kt+rt.y*(Tt-kt),Mr[me+2]=wt+rt.z*(W-wt),me+=3}const Be=X?H.v7EvalColor("line_color","lightblue"):H.getColor(ct.fLineColor),gt=new V.mrM((0,xe.Bx)(Be,{linewidth:X?H.v7EvalAttr("line_width",1):ct.fLineWidth})),Et=(0,xe.Fc)(Qe(H,Mr),gt,qi?Sr:null);k.add3DMesh(Et)}function C(H,X=!1){const ie=H.getFramePainter(),z=H.getHisto(),m=H.prepareDraw({rounding:!1,use3d:!0,extra:1}),I=ie.z_handle.getScaleMin(),A=ie.z_handle.getScaleMax(),R=H.options.cutg;let k,ee,ge,ve,Se,De,Xe,ct,$,tt,We,Ne=0,Fe=null,ht=null,pt=0;for(let kt=0;kt<2;++kt){for(k=m.i1;k<m.i2;++k)for(De=m.grx[k],ct=m.grx[k+1],ee=m.j1;ee<m.j2;++ee)if(ve=z.getBinContent(k+1,ee+1),!(ve<I||ve>A)&&(ve!==I||H.options.Zero||I>0||H._show_empty_bins)&&(!R||R.IsInside(z.fXaxis.GetBinCoord(k+.5),z.fYaxis.GetBinCoord(ee+.5)))){if(0===kt){Ne+=3;continue}ge=z.getBin(k+1,ee+1),Se=z.getBinError(ge),ht[pt/18]=ge,Xe=m.gry[ee],$=m.gry[ee+1],tt=ie.grz(ve-Se<I?I:ve-Se),We=ie.grz(ve+Se>A?A:ve+Se),Fe[pt]=De,Fe[pt+3]=ct,Fe[pt+1]=Fe[pt+4]=(Xe+$)/2,Fe[pt+2]=Fe[pt+5]=(tt+We)/2,pt+=6,Fe[pt]=Fe[pt+3]=(De+ct)/2,Fe[pt+1]=Xe,Fe[pt+4]=$,Fe[pt+2]=Fe[pt+5]=(tt+We)/2,pt+=6,Fe[pt]=Fe[pt+3]=(De+ct)/2,Fe[pt+1]=Fe[pt+4]=(Xe+$)/2,Fe[pt+2]=tt,Fe[pt+5]=We,pt+=6}if(0===kt){if(0===Ne)return;Fe=new Float32Array(6*Ne),ht=new Int32Array(Ne/3)}}const rt=X?H.v7EvalColor("line_color","lightblue"):H.getColor(z.fLineColor),_t=new V.mrM((0,xe.Bx)(rt,{linewidth:X?H.v7EvalAttr("line_width",1):z.fLineWidth})),Yt=(0,xe.Fc)(Fe,_t);Yt.painter=H,Yt.intersect_index=ht,Yt.zmin=I,Yt.zmax=A,Yt.tip_color=3===z.fLineColor?16711680:65280,Yt.tooltip=function(kt){const Tt=Math.floor(kt.index/6);if(Tt<0||Tt>=this.intersect_index.length)return null;const fn=this.painter,ln=fn.getHisto(),mn=fn.getFramePainter(),jt=fn.get3DToolTip(this.intersect_index[Tt]),Sn=Math.min(mn.size_x3d,Math.max(-mn.size_x3d,mn.grx(ln.fXaxis.GetBinLowEdge(jt.ix)))),cn=Math.min(mn.size_x3d,Math.max(-mn.size_x3d,mn.grx(ln.fXaxis.GetBinLowEdge(jt.ix+1)))),gn=Math.min(mn.size_y3d,Math.max(-mn.size_y3d,mn.gry(ln.fYaxis.GetBinLowEdge(jt.iy)))),Cn=Math.min(mn.size_y3d,Math.max(-mn.size_y3d,mn.gry(ln.fYaxis.GetBinLowEdge(jt.iy+1))));return jt.x1=Math.min(Sn,cn),jt.x2=Math.max(Sn,cn),jt.y1=Math.min(gn,Cn),jt.y2=Math.max(gn,Cn),jt.z1=mn.grz(jt.value-jt.error<this.zmin?this.zmin:jt.value-jt.error),jt.z2=mn.grz(jt.value+jt.error>this.zmax?this.zmax:jt.value+jt.error),jt.color=this.tip_color,jt},ie.add3DMesh(Yt)}function N(H,X=!1,ie=!1){const z=H.getFramePainter(),m=H.prepareDraw({rounding:!1,use3d:!0,extra:100,middle:0}),I=H.getHisto(),A=H.getContourLevels(),R=H.getHistPalette(),k=[];let ee=2*z.size_z3d;(0,Ke.Hn)(I,m,A,R,(ve,Se,De,Xe,ct,$)=>{if(!(ct-Xe<3||X&&(ee=z.grz(A[$]),ee<0||ee>2*z.size_z3d)))for(let tt=Xe;tt<ct;++tt)k.push(Se[tt],De[tt],ee),k.push(Se[tt+1],De[tt+1],ee)});const ge=(0,xe.Fc)(k,(0,xe.DH)(H,ie?"line_":I));z.add3DMesh(ge)}function O(H,X=!1){const ie=H.getHisto(),z=H.getFramePainter(),m=z.z_handle.getScaleMin(),I=z.logz?Se=>Se<m?-.1:z.grz(Se):z.grz,R=2*z.size_z3d;let k=H.prepareDraw({rounding:!1,use3d:!0,extra:1,middle:.5,cutg:(0,be.isFunc)(H.options?.cutg?.IsInside)?H.options?.cutg:null});if(k.i2-k.i1<2||k.j2-k.j1<2)return;let ee=null,ge=null,ve=null;if(k.dolines=!0,X){let Se=0;switch(H.options.Surf){case 11:Se=2;break;case 12:case 15:case 17:Se=2,k.dolines=!1;break;case 14:k.dolines=!1,k.donormals=!0;break;case 16:Se=1,k.dogrid=!0,k.dolines=!1;break;default:ee=z.z_handle.createTicks(!0),k.dogrid=!0}Se>0&&(ve=z.getHistPalette(),2===Se&&H.createContour(z,ve,{full_z_range:!0}),ee=ve.getContour())}else switch(H.options.Surf){case 11:ee=H.getContourLevels(),ve=H.getHistPalette();break;case 12:case 15:case 17:ee=H.getContourLevels(),ve=H.getHistPalette(),k.dolines=!1;break;case 14:k.dolines=!1,k.donormals=!0;break;case 16:ee=H.getContourLevels(),k.dogrid=!0,k.dolines=!1;break;default:ee=z.z_handle.createTicks(!0),k.dogrid=!0}if(ee){ge=new Float32Array(ee.length);for(let Se=0;Se<ee.length;++Se)ge[Se]=I(ee[Se])}else ge=[0,R];if(k.grz=I,k.grz_min=0,k.grz_max=R,(0,Ke.YB)(ie,k,ee,(Se,De,Xe)=>{const ct=Ie(H,De,null,k.i2-k.i1,k.j2-k.j1),$=ct.getAttribute("normal").array;if(k.donormals&&1===Se)for(let Fe=k.i1;Fe<k.i2;++Fe)for(let ht=k.j1;ht<k.j2;++ht){const pt=8*((Fe-k.i1)*(k.j2-k.j1)+(ht-k.j1));if(-1===Xe[pt])continue;const dt=Xe[pt]>=0?pt:pt+9+Xe[pt],rt=pt+8;let _t=0,Yt=0,kt=0;for(let Tt=dt;Tt<rt;++Tt){const fn=Xe[Tt];if(fn<0)return console.error("FAILURE in NORMALS RECALCULATIONS");_t+=$[fn],Yt+=$[fn+1],kt+=$[fn+2]}_t/=rt-dt,Yt/=rt-dt,kt/=rt-dt;for(let Tt=dt;Tt<rt;++Tt){const fn=Xe[Tt];$[fn]=_t,$[fn+1]=Yt,$[fn+2]=kt}}let tt,We;X?tt=ve?.getColor(Se-1)??H.getColor(5):ve?tt=ve.calcColor(Se,ge.length):(tt=ie.fFillColor>1?H.getColor(ie.fFillColor):"white",14===H.options.Surf&&ie.fFillColor<2&&(tt=H.getColor(48))),tt||(tt="white"),We=14===H.options.Surf?new V.G_z((0,xe.Bx)(tt,{side:V.$EB,vertexColors:!1})):new V.V9B((0,xe.Bx)(tt,{side:V.$EB,vertexColors:!1}));const Ne=new V.eaF(ct,We);z.add3DMesh(Ne),Ne.painter=H},(Se,De)=>{const Xe=H.getColor(ie.fLineColor)??"white";let ct;ct=Se?1===H.options.Surf?new V.Fvt({color:0,dashSize:2,gapSize:2}):new V.mrM((0,xe.Bx)(Xe)):new V.mrM((0,xe.Bx)(Xe,{linewidth:ie.fLineWidth}));const $=(0,xe.Fc)(Qe(H,De,k.i2-k.i1,k.j2-k.j1),ct);$.painter=H,z.add3DMesh($)}),17===H.options.Surf&&N(H,!1,X),13===H.options.Surf){k=H.prepareDraw({rounding:!1,use3d:!0,extra:100,middle:0});const Se=H.getContourLevels(),De=H.getHistPalette();let Xe=-1,ct=R;(0,Ke.Hn)(ie,k,Se,De,($,tt,We,Ne,Fe)=>{if(tt[Fe]===tt[Ne]&&We[Fe]===We[Ne]&&Fe--,Fe-Ne<3)return;const ht=[];for(let fn=Ne;fn<=Fe;++fn)(fn===Ne||tt[fn]!==tt[fn-1]||We[fn]!==We[fn-1])&&ht.push(new V.I9Y(tt[fn],We[fn]));if(ht.length<3)return;const pt=V.xJ6.triangulateShape(ht,[]);if(!pt||0===pt.length)return;(Xe<0||Xe!==$)&&(Xe=$,ct+=5e-5*R);const dt=new Float32Array(9*pt.length),rt=new Float32Array(9*pt.length);let _t=0;for(let fn=0;fn<pt.length;++fn){const ln=pt[fn];for(let mn=0;mn<3;++mn){const jt=ht[ln[mn]];dt[_t]=jt.x,dt[_t+1]=jt.y,dt[_t+2]=ct,rt[_t]=0,rt[_t+1]=0,rt[_t+2]=1,_t+=3}}const Yt=Ie(H,dt,rt,k.i2-k.i1,k.j2-k.j1),kt=new V.V9B((0,xe.Bx)(De.getColor($),{side:V.$EB,opacity:.5,vertexColors:!1})),Tt=new V.eaF(Yt,kt);Tt.painter=H,z.add3DMesh(Tt)})}}},1194:(Gr,xt,Te)=>{"use strict";Te.d(xt,{N:()=>Ke,c:()=>st});var be=Te(5774),v=Te(4186),V=Te(3324),Le=Te(165),xe=Te(2105),Je=Te(9489);const st=["LOGXY","LOGX","LOGY","LOGZ","LOGV","LOG","LOG2X","LOG2Y","LOG2","LNX","LNY","LN","GRIDXY","GRIDX","GRIDY","TICKXY","TICKX","TICKY","TICKZ","FB","GRAYSCALE"];class Ke extends xe.mf{convertTH1K(){const Re=this.getObject();if(Re.fReady)return;const Qe=Re.fArray,Ie=Re.fEntries;Re.fNcells=Re.fXaxis.fNbins+2,Re.fArray=new Float64Array(Re.fNcells).fill(0);for(let L=0;L<Re.fNIn;++L)Re.Fill(Qe[L]);Re.fReady=1,Re.fEntries=Ie}scanContent(Re){Re&&!this.nbinsx&&(Re=!1),this.isTH1K()&&this.convertTH1K();const Qe=this.getHisto();Re||this.extractAxesProperties(1);const Ie=this.getSelectIndex("x","left"),L=this.getSelectIndex("x","right"),he=this.getPadPainter()?.getPadLog(this.options.BarStyle>=20?"x":"y"),re=this.options.Func?this.findFunction(v.clTF1):null;if(Re&&Ie===this.scan_xleft&&L===this.scan_xright)return;this.draw_content=!(this.options.Axis>0),this.scan_xleft=Ie,this.scan_xright=L;const fe=this.isTProfile();let D,x,de=0,pe=0,ce=0,K=0,G=!0;for(let w=0;w<this.nbinsx;++w)if(D=Qe.getBinContent(w+1),K+=fe?Qe.fBinEntries[w+1]:D,!(w<Ie||w>=L)&&(D>0&&(0===pe||D<pe)&&(pe=D),G&&(de=ce=D,G=!1),x=this.options.Error?Qe.getBinError(w+1):0,de=Math.min(de,D-x),ce=Math.max(ce,D+x),re)){const b=Qe.fXaxis.GetBinCenter(w+1),g=(0,Je.rr)(re,b);void 0!==g&&(ce=Math.max(ce,g),he&&D>0&&g>.3*D&&(pe=Math.min(pe,g)))}K+=fe?Qe.fBinEntries[0]+Qe.fBinEntries[this.nbinsx+1]:Qe.getBinContent(0)+Qe.getBinContent(this.nbinsx+1),this.stat_entries=Qe.fEntries>1?Qe.fEntries:K,this.hmin=de,this.hmax=ce,(0===this.nbinsx||Math.abs(de)<1e-300&&Math.abs(ce)<1e-300)&&(this.draw_content=!1);let P=!1;if((this.draw_content||this.isMainPainter()&&this.options.Axis>0&&!this.options.ohmin&&!this.options.ohmax&&Qe.fMinimum===v.kNoZoom&&Qe.fMaximum===v.kNoZoom)&&(de>=ce?0===de?(this.ymin=0,this.ymax=1):de<0?(this.ymin=2*de,this.ymax=0):(this.ymin=0,this.ymax=2*de):he?(this.ymin=.5*(pe||de),this.ymax=2*ce*(.9/.95)):(this.ymin=de,this.ymax=ce)),!this._exact_y_range&&!this._set_y_range&&!he){if(!1!==this.options.BaseLine&&this.ymin>=0)this.ymin=0;else{const w=this.ymin>=0;this.ymin-=v.gStyle.fHistTopMargin*(this.ymax-this.ymin),w&&this.ymin<0&&(this.ymin=0)}this.ymax+=v.gStyle.fHistTopMargin*(this.ymax-this.ymin)}this.options.ignore_min_max?de=ce=v.kNoZoom:(de=this.options.minimum,ce=this.options.maximum),de===ce&&de!==v.kNoZoom&&(de<0?(de*=2,ce=0):(de=0,ce*=2,ce||(ce=1))),this._set_y_range=!1,this.options.ohmin&&this.options.ohmax&&!this.draw_content?P=!this.options.ignore_min_max:de!==v.kNoZoom&&ce!==v.kNoZoom&&!this.draw_content&&(this.ymin===this.ymax||this.ymin>de||this.ymax<ce)?(this.ymin=de,this.ymax=ce,this._set_y_range=!0):(de!==v.kNoZoom&&(this._set_y_range=!0,de<this.ymin&&(this.ymin=de),P=!0),ce!==v.kNoZoom&&(this._set_y_range=!0,ce>this.ymax&&(this.ymax=ce),P=!0)),Re||(P?(this.zoom_ymin=de===v.kNoZoom?this.ymin:de,this.zoom_ymax=ce===v.kNoZoom?this.ymax:ce):(delete this.zoom_ymin,delete this.zoom_ymax)),this.wheel_zoomy=this.getDimension()>1||!this.draw_content}countStat(Re,Qe){const Ie=this.isTProfile(),L=this.getHisto(),he=L.fXaxis,re=this.getSelectIndex("x","left"),fe=this.getSelectIndex("x","right"),de=this.getFramePainter(),pe={name:L.fName,meanx:0,meany:0,rmsx:0,rmsy:0,integral:0,entries:this.stat_entries,eff_entries:0,xmax:0,wmax:0,skewx:0,skewd:0,kurtx:0,kurtd:0},ce=!de.isAxisZoomed("x")&&Math.abs(L.fTsumw)>1e-300;let b,K=0,G=0,D=0,x=0,P=0,w=0,g=0,C=0,N=null,O=null;for((0,v.isFunc)(Re)||(Re=null),b=re;b<fe;++b)g=he.GetBinCoord(b+.5),(!Re||Re(g))&&(Ie?(C=L.fBinEntries[b+1],P+=L.fArray[b+1],w+=L.fSumw2[b+1]):C=L.getBinContent(b+1),(null===N||C>O)&&(N=g,O=C),ce||(K+=C,G+=C*C,D+=C*g,x+=C*g**2));if(ce&&(K=L.fTsumw,G=L.fTsumw2,D=L.fTsumwx,x=L.fTsumwx2),pe.integral=K,pe.eff_entries=G?K*K/G:Math.abs(K),Math.abs(K)>1e-300&&(pe.meanx=D/K,pe.meany=P/K,pe.rmsx=Math.sqrt(Math.abs(x/K-pe.meanx**2)),pe.rmsy=Math.sqrt(Math.abs(w/K-pe.meany**2))),null!==N&&(pe.xmax=N,pe.wmax=O),Qe){let H=0,X=0,ie=0;for(b=re;b<fe;++b)g=he.GetBinCoord(b+.5),(!Re||Re(g))&&(C=Ie?L.fBinEntries[b+1]:L.getBinContent(b+1),ie+=C,H+=C*Math.pow(g-pe.meanx,3),X+=C*Math.pow(g-pe.meanx,4));const z=Math.pow(pe.rmsx,3),m=Math.pow(pe.rmsx,4);ie*z!=0&&(pe.skewx=H/(ie*z)),pe.skewd=pe.eff_entries>0?Math.sqrt(6/pe.eff_entries):0,ie*m!=0&&(pe.kurtx=X/(ie*m)-3),pe.kurtd=pe.eff_entries>0?Math.sqrt(24/pe.eff_entries):0}return pe}fillStatistic(Re,Qe,Ie){if(this.isIgnoreStatsFill())return!1;1===Qe&&(Qe=1111),1===Ie&&(Ie=111);const L=this.getHisto(),he=Qe%10,re=Math.floor(Qe/10)%10,fe=Math.floor(Qe/100)%10,de=Math.floor(Qe/1e3)%10,pe=Math.floor(Qe/1e4)%10,ce=Math.floor(Qe/1e5)%10,K=Math.floor(Qe/1e6)%10,G=Math.floor(Qe/1e7)%10,D=Math.floor(Qe/1e8)%10,x=this.countStat(void 0,G>0||D>0);return Re.clearPave(),he>0&&Re.addText(x.name),this.isTProfile()?(re>0&&Re.addText("Entries = "+Re.format(x.entries,"entries")),fe>0&&(Re.addText("Mean = "+Re.format(x.meanx)),Re.addText("Mean y = "+Re.format(x.meany))),de>0&&(Re.addText("Std Dev = "+Re.format(x.rmsx)),Re.addText("Std Dev y = "+Re.format(x.rmsy)))):(re>0&&Re.addText("Entries = "+Re.format(x.entries,"entries")),fe>0&&Re.addText("Mean = "+Re.format(x.meanx)),de>0&&Re.addText("Std Dev = "+Re.format(x.rmsx)),pe>0&&Re.addText("Underflow = "+Re.format(L.fArray.length>0?L.fArray[0]:0,"entries")),ce>0&&Re.addText("Overflow = "+Re.format(L.fArray.length>0?L.fArray[L.fArray.length-1]:0,"entries")),K>0&&Re.addText("Integral = "+Re.format(x.integral,"entries")),2===G?Re.addText(`Skewness = ${Re.format(x.skewx)} #pm ${Re.format(x.skewd)}`):G>0&&Re.addText(`Skewness = ${Re.format(x.skewx)}`),2===D?Re.addText(`Kurtosis = ${Re.format(x.kurtx)} #pm ${Re.format(x.kurtd)}`):D>0&&Re.addText(`Kurtosis = ${Re.format(x.kurtx)}`)),Ie&&Re.fillFunctionStat(this.findFunction(v.clTF1),Ie,1),!0}drawBars(Re,Qe){var Ie=this;return(0,be.A)(function*(){const L=Ie.getSelectIndex("x","left",-1),he=Ie.getSelectIndex("x","right",1),re=Ie.getHisto(),fe=re.fXaxis,de=Ie.options.Text;let pe,ce,K,G,D,x,P,w,b,g,C,N,O="",H="",X="",ie=Ie.options.BarStyle>10?Ie.options.BarStyle%10:0;for(ie>4&&(ie=4),C=Re.swap_xy?0:Qe,Number.isFinite(Ie.options.BaseLine)&&Ie.options.BaseLine>=Re.scale_ymin&&(C=Math.round(Re.gry(Ie.options.BaseLine))),de&&(pe=Ie.getColor(re.fMarkerColor),ce=-1*Ie.options.TextAngle,K=20,1!==re.fMarkerSize&&ce&&(K=.02*Qe*re.fMarkerSize),Ie.startTextDrawing(42,K,Ie.draw_g,K)),G=L;G<he;++G)if(D=fe.GetBinLowEdge(G+1),x=fe.GetBinLowEdge(G+2),!(Re.logx&&x<=0)&&(P=Math.round(Re.grx(D)),w=Math.round(Re.grx(x)),b=re.getBinContent(G+1),!(Re.logy&&b<Re.scale_ymin)&&(g=Math.round(Re.gry(b)),N=w-P,P+=Math.round(re.fBarOffset/1e3*N),N=Math.round(re.fBarWidth/1e3*N),O+=Re.swap_xy?`M${C},${P}h${g-C}v${N}h${C-g}z`:`M${P},${g}h${N}v${C-g}h${-N}z`,ie>0&&(w=P+N,N=Math.round(N*ie/10),Re.swap_xy?(H+=`M${C},${P}h${g-C}v${N}h${C-g}z`,X+=`M${C},${w}h${g-C}v${-N}h${C-g}z`):(H+=`M${P},${g}h${N}v${C-g}h${-N}z`,X+=`M${w},${g}h${-N}v${C-g}h${N}z`)),de&&b))){const z=b===Math.round(b)?b.toString():(0,Le.lg)(b,v.gStyle.fPaintTextFormat);Ie.drawText(Re.swap_xy?{align:12,x:Math.round(g+K/2),y:Math.round(P+.1),height:Math.round(.8*N),text:z,color:pe,latex:0}:ce?{align:12,x:P+N/2,y:Math.round(g-2-K/5),width:0,height:0,rotate:ce,text:z,color:pe,latex:0}:{align:22,x:Math.round(P+.1*N),y:Math.round(g-2-K),width:Math.round(.8*N),height:K,text:z,color:pe,latex:0})}if(O&&Ie.draw_g.append("svg:path").attr("d",O).call(Ie.fillatt.func),H&&Ie.draw_g.append("svg:path").attr("d",H).call(Ie.fillatt.func).style("fill",(0,V.Qh)(Ie.fillatt.color).brighter(.5).formatHex()),X&&Ie.draw_g.append("svg:path").attr("d",X).call(Ie.fillatt.func).style("fill",(0,V.Qh)(Ie.fillatt.color).darker(.5).formatHex()),de)return Ie.finishTextDrawing()})()}drawFilledErrors(Re){const Qe=this.getSelectIndex("x","left",0),Ie=this.getSelectIndex("x","right",0),L=this.getHisto(),he=[],re=[];for(let ce=Qe;ce<Ie;++ce){const K=L.fXaxis.GetBinCoord(ce+.5);if(Re.logx&&K<=0)continue;const G=Math.round(Re.grx(K)),D=L.getBinContent(ce+1),x=L.getBinError(ce+1);Re.logy&&D-x<Re.scale_ymin||(he.push({grx:G,gry:Math.round(Re.gry(D+x))}),re.unshift({grx:G,gry:Math.round(Re.gry(D-x))}))}const fe=4!==this.options.ErrorKind,de=(0,Le.Mw)(he,{line:fe}),pe=(0,Le.Mw)(re,{line:fe,cmd:"L"});this.draw_g.append("svg:path").attr("d",de+pe+"Z").call(this.fillatt.func)}drawNormal(Re,Qe,Ie){const L=this.getSelectIndex("x","left",-1),he=this.getSelectIndex("x","right",2),re=this.getHisto(),fe=!this.isBatchMode()&&v.settings.Tooltip,de=re.fXaxis,pe=!this.options.Zero,ce=this.options.Error,K=this.options.Curve,G=this.options.Text,D=G&&"E"===this.options.TextKind&&this.isTProfile()&&re.fBinEntries,x=[];let C,N,O,H,X,ie,z,m,I,A,R,k,ee,ge,ve,dt,rt,_t,Yt,kt,Tt,fn,ln,mn,jt,Sn,cn,gn,Cn,Ln,P="",w=!1,b=this.options.Mark,g=this.options.Line,Se=null,De=null,Xe=null,ct="",$=null,tt=null,We=5,Ne=!1,Fe=!1,ht=0,pt=0;if(ce&&!b&&re.fMarkerStyle>1&&(b=!0),2===this.options.ErrorKind?this.fillatt.empty()?b=!0:Se="":ce&&(g=!1,De="",$=fe?"":null,Fe=!0),pt=this.lineatt.width+v.gStyle.fEndErrorSize,1===this.options.ErrorKind&&(ht=Math.floor((this.lineatt.width-1)/2)),b){let _e=this.options.MarkStyle;!_e&&1===re.fMarkerStyle&&(_e=8),this.createAttMarker({attr:re,style:_e}),this.markeratt.size>0?(Xe="",Ne=!0,this.markeratt.resetPos(),null===$&&fe&&(!this.markeratt.fill||this.markeratt.getFullSize()<7)&&(tt="",We=Math.max(5,Math.round(.7*this.markeratt.getFullSize())))):b=!1}const Zn=ce||b,ui=Zn||G||g||K,hi=this.options.Hist&&(!this.lineatt.empty()||!this.fillatt.empty());if(!hi&&!ui)return this.removeG();if(G){if(gn=this.getColor(re.fMarkerColor),Cn=-1*this.options.TextAngle,Ln=20,1!==re.fMarkerSize&&Cn&&(Ln=.02*Ie*re.fMarkerSize),!Cn&&!this.options.TextKind){const _e=Qe/(he-L+1);_e<3*Ln&&(Cn=270,Ln=Math.round(.7*_e))}this.startTextDrawing(42,Ln,this.draw_g,Ln)}const qi=ui||he-L>3*Qe,Mr=_e=>(Yt=re.getBinContent(_e+1),!(pe&&0===Yt||(Tt=Math.round(Re.grx(de.GetBinLowEdge(_e+1))),fn=Math.round(Re.grx(de.GetBinLowEdge(_e+2))),ln=Math.round((Tt+fn)/2),void 0===N&&(N=ln),dt=Math.round(Re.gry(Yt)),ce?(kt=re.getBinError(_e+1),rt=Math.round(dt-Re.gry(Yt+kt)),_t=Math.round(Re.gry(Yt-kt)-dt)):rt=_t=20,0))),Sr=()=>{let _e=5;if(this.options.errorX>0&&(_e=Math.round((fn-Tt)*this.options.errorX),Sn=ln-_e,cn=ln+_e,De+=1===this.options.ErrorKind?`M${Sn+ht},${dt-pt}v${2*pt}m0,-${pt}h${cn-Sn-2*ht}m0,-${pt}v${2*pt}`:`M${Sn+ht},${dt}h${cn-Sn-2*ht}`),De+=1===this.options.ErrorKind?`M${ln-pt},${dt-rt+ht}h${2*pt}m${-pt},0v${rt+_t-2*ht}m${-pt},0h${2*pt}`:`M${ln},${dt-rt+ht}v${rt+_t-2*ht}`,null!==$){const Be=Math.max(rt,5),gt=Math.max(_t,5);$+=`M${ln-_e},${dt-Be}h${2*_e}v${Be+gt}h${-2*_e}z`}},ms=_e=>{if(Mr(_e)){if(G){const Be=D?re.fBinEntries[_e+1]:Yt;if(0!==Be){const gt=Be===Math.round(Be)?Be.toString():(0,Le.lg)(Be,v.gStyle.fPaintTextFormat);this.drawText(Cn?{align:12,x:ln,y:Math.round(dt-2-Ln/5),width:0,height:0,rotate:Cn,text:gt,color:gn,latex:0}:{align:22,x:Math.round(Tt+.1*(fn-Tt)),y:Math.round(dt-2-Ln),width:Math.round(.8*(fn-Tt)),height:Ln,text:gt,color:gn,latex:0})}}g?(0===ct.length?ct=`M${ln},${dt}`:ct+=mn===ln?"v"+(dt-jt):jt===dt?"h"+(ln-mn):`l${ln-mn},${dt-jt}`,mn=ln,jt=dt):K&&x.push({grx:(Tt+fn)/2,gry:Re.gry(Yt)}),Zn&&dt>=-rt&&dt<=Ie+_t&&(null!==Se&&(Se+=`M${Tt},${dt-rt}h${fn-Tt}v${rt+_t+1}h${Tt-fn}z`),null!==Xe&&Ne&&(Xe+=this.markeratt.create(ln,dt),null!==tt&&(tt+=`M${ln-We},${dt-We}h${2*We}v${2*We}h${-2*We}z`)),null!==De&&Fe&&Sr())}};if((Ne||Fe)&&(!v.settings.OptimizeDraw||he-L<5e4&&1===v.settings.OptimizeDraw)){for(ee=L;ee<he;++ee)Mr(ee)&&(null!==Xe&&(Xe+=this.markeratt.create(ln,dt)),null!==tt&&(tt+=`M${ln-We},${dt-We}h${2*We}v${2*We}h${-2*We}z`),null!==De&&Sr());Fe=Ne=!1}for(ee=L;ee<=he;++ee)X=de.GetBinLowEdge(ee+1),!(this.logx&&X<=0)&&(ie=Math.round(Re.grx(X)),w=ee===he,w&&L<he?m=H:(z=re.getBinContent(ee+1),m=Math.round(Re.gry(z))),0===P.length?(ge=ve=ee,k=C=O=ie,R=I=A=H=m,P=`M${O},${H}`):qi?ie!==O||w?(ui&&(ge===ve?ms(ge):ge<ve?(ms(ge),ms(ve)):(ms(ve),ms(ge))),hi&&(I!==A||R!==I)&&(k!==O&&(P+="h"+(O-k)),H===I?(A!==R&&(P+="v"+(A-R)),I!==A&&(P+="v"+(I-A))):(I!==R&&(P+="v"+(I-R)),A!==I&&(P+="v"+(A-I)),H!==A&&(P+="v"+(H-A))),k=O,R=H),w&&k!==ie&&(P+="h"+(ie-k)),ge=ve=ee,I=A=H=m,O=ie):(m<I?ve=ee:m>A&&(ge=ee),I=Math.min(I,m),A=Math.max(A,m),H=m):(m!==H||w)&&(ie!==O&&(P+="h"+(ie-O)),m!==H&&(P+="v"+(m-H)),H=m,O=ie));const fs=fe&&this.fillatt.empty()&&hi&&!Zn&&!g&&!K,wt=()=>{this.draw_g.append("svg:path").attr("d",P+(!this.fillatt.empty()||fs?me:"")).style("stroke-linejoin","miter").call(this.lineatt.func).call(this.fillatt.func)};let W=Ie+3;if(!fs){const _e=Math.round(Re.gry(0));_e<=0?W=-3:_e<Ie&&(W=_e)}const me=`L${O},${W}H${C}Z`;return P&&hi&&!this.fillatt.empty()&&(wt(),P=""),(Zn||g||K)&&(!ct&&x.length&&(ct=(0,Le.Mw)(x)),Se?this.draw_g.append("svg:path").attr("d",Se).call(this.fillatt.func):ct&&!this.fillatt.empty()&&!hi&&this.draw_g.append("svg:path").attr("d",ct+`L${ln},${W}H${N}Z`).call(this.fillatt.func),De&&this.draw_g.append("svg:path").attr("d",De).call(this.lineatt.func),$&&this.draw_g.append("svg:path").attr("d",$).style("fill","none").style("pointer-events",this.isBatchMode()?null:"visibleFill"),ct&&this.draw_g.append("svg:path").attr("d",ct).style("fill","none").call(this.lineatt.func),Xe&&this.draw_g.append("svg:path").attr("d",Xe).call(this.markeratt.func),tt&&this.draw_g.append("svg:path").attr("d",tt).style("fill","none").style("pointer-events",this.isBatchMode()?null:"visibleFill")),P&&hi&&wt(),G?this.finishTextDrawing():void 0}draw1DBins(){this.createHistDrawAttributes();const Re=this.getFramePainter(),Qe=Re.getGrFuncs(this.options.second_x,this.options.second_y),Ie=Re.getFrameWidth(),L=Re.getFrameHeight();return!this.draw_content||Ie<=0||L<=0?this.removeG():(this.createG(!0),this.options.Bar?this.drawBars(Qe,L).then(()=>{if(1===this.options.ErrorKind)return this.drawNormal(Qe,Ie,L)}):3===this.options.ErrorKind||4===this.options.ErrorKind?this.drawFilledErrors(Qe):this.drawNormal(Qe,Ie,L))}getBinTooltips(Re){const Qe=[],Ie=this.getObjectHint(),he=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),re=this.getHisto(),fe=re.fXaxis.GetBinLowEdge(Re+1),de=re.fXaxis.GetBinLowEdge(Re+2),pe=this.getAxisBinTip("x",re.fXaxis,Re);let ce=re.getBinContent(Re+1);return Ie&&Qe.push(Ie),this.options.Error||this.options.Mark||this.isTF1()?(Qe.push(`x = ${pe}`,`y = ${he.axisAsText("y",ce)}`),this.options.Error&&("["===pe[0]&&Qe.push(`error x = ${((de-fe)/2).toPrecision(4)}`),Qe.push(`error y = ${re.getBinError(Re+1).toPrecision(4)}`))):(Qe.push(`bin = ${Re+1}`,`x = ${pe}`),re.$baseh&&(ce-=re.$baseh.getBinContent(Re+1)),ce===Math.round(ce)?Qe.push(`entries = ${ce}`):Qe.push(`entries = ${(0,Le.lg)(ce,v.gStyle.fStatFormat)}`)),Qe}processTooltipEvent(Re){if(!Re||!this.draw_content||!this.draw_g||this.options.Mode3D)return this.draw_g?.selectChild(".tooltip_bin").remove(),null;const Qe=this.getFramePainter(),Ie=Qe.getGrFuncs(this.options.second_x,this.options.second_y),L=this.getHisto(),he=this.getSelectIndex("x","left",-1),re=this.getSelectIndex("x","right",2);let ce,K,G,D,x,fe=Qe.getFrameWidth(),de=Qe.getFrameHeight(),pe=null,P=2,w=he,b=re,g=Re.x,C=Re.y;const N=I=>{const A=L.fXaxis.GetBinLowEdge(I+1);return Ie.logx&&A<=0?null:Ie.grx(A)},O=I=>{const A=L.getBinContent(I+1);return Ie.logy&&A<Ie.scale_ymin?Ie.swap_xy?-1e3:10*de:Math.round(Ie.gry(A))};Ie.swap_xy&&([g,C,fe,de]=[C,g,de,fe]);const H=Ie.swap_xy!==Qe.x_handle.reverse;for(;w<b-1;){const I=Math.round(.5*(w+b)),A=N(I);null===A||A<g-.5?H?b=I:w=I:A>g+.5?H?w=I:b=I:(w++,b--)}if(pe=b=w,K=N(pe),H){for(;w>he&&N(w-1)<K+2;)--w;for(;b<re&&N(b+1)>K-2;)++b}else{for(;w>he&&N(w-1)>K-2;)--w;for(;b<re&&N(b+1)<K+2;)++b}if(w<b){let I=de;for(let A=w;A<=b;A++){const R=Math.abs(O(A)-C);R<I&&(I=R,pe=A)}I>de/10&&(pe=Math.round(w+(b-w)/de*C)),K=N(pe)}if(K=Math.round(K),G=Math.round(N(pe+1)),this.options.Bar){const I=G-K;K+=Math.round(L.fBarOffset/1e3*I),G=K+Math.round(L.fBarWidth/1e3*I)}K>G&&([K,G]=[G,K]);const X=Math.round((K+G)/2),ie=D=x=O(pe);if(this.options.Bar)ce=!0,P=0,D=Math.round(Ie.gry(!1!==this.options.BaseLine&&this.options.BaseLine>Ie.scale_ymin?this.options.BaseLine:Ie.scale_ymin)),D>x&&([D,x]=[x,D]),!Re.touch&&1===Re.nproc&&(C<D||C>x)&&(pe=null);else if(this.options.Error&&!0!==this.options.Hist||this.options.Mark||this.options.Line||this.options.Curve){ce=!this.isTF1();let I=3;if(this.markeratt&&(I=Math.max(I,this.markeratt.getFullSize())),this.options.Error){const A=L.getBinContent(pe+1),R=L.getBinError(pe+1);D=Math.round(Ie.gry(A+R)),x=Math.round(Ie.gry(A-R)),0===A&&this.isTProfile()&&(pe=null);const k=(G-K)*this.options.errorX;K=Math.round(X-k),G=Math.round(X+k)}G-K<2*I&&(K=X-I,G=X+I),D=Math.min(D,ie-I),x=Math.max(x,ie+I),!Re.touch&&1===Re.nproc&&(C<D||C>x)&&(pe=null)}else ce=1===Re.nproc&&re-he<fe,ce&&(x=de,this.fillatt.empty()||(x=Math.min(de,Math.max(0,Math.round(Ie.gry(0)))),x<D&&([D,x]=[x,D])),(Re.y<D||Re.y>x)&&!Re.touch&&(pe=null));null!==pe&&(pe===he&&K>g+P||pe===re-1&&G<g-P||g<K-P||g>G+P||!this.options.Zero&&0===L.getBinContent(pe+1))&&(pe=null);let z=this.draw_g.selectChild(".tooltip_bin");if(null===pe||x<=0||D>=de)return z.remove(),null;const m={name:this.getObjectName(),title:L.fTitle,x:X,y:ie,exact:!0,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getBinTooltips(pe)};if(Re.disabled)z.remove(),m.changed=!0;else if(ce)z.empty()&&(z=this.draw_g.append("svg:rect").attr("class","tooltip_bin").style("pointer-events","none").call(Le.Ru)),m.changed=z.property("current_bin")!==pe,m.changed&&z.attr("x",Ie.swap_xy?D:K).attr("width",Ie.swap_xy?x-D:G-K).attr("y",Ie.swap_xy?K:D).attr("height",Ie.swap_xy?G-K:x-D).style("opacity","0.3").property("current_bin",pe),m.exact=Math.abs(ie-C)<=5||C>=D&&C<=x,m.menu=m.exact,m.menu_dist=Math.sqrt((X-g)**2+(ie-C)**2);else{const I=this.lineatt.width+3;z.empty()&&(z=this.draw_g.append("svg:circle").attr("class","tooltip_bin").style("pointer-events","none").attr("r",I).call(this.lineatt.func).call(this.fillatt.func)),m.exact=Math.abs(X-Re.x)<=I&&Math.abs(ie-Re.y)<=I,m.menu=m.exact,m.menu_dist=Math.sqrt((X-Re.x)**2+(ie-Re.y)**2),m.changed=z.property("current_bin")!==pe,m.changed&&z.attr("cx",X).attr("cy",ie).property("current_bin",pe)}return m.changed&&(m.user_info={obj:L,name:L.fName,bin:pe,cont:L.getBinContent(pe+1),grx:X,gry:ie}),m}fillHistContextMenu(Re){Re.add("Auto zoom-in",()=>this.autoZoom());const Qe=this.getSupportedDrawOptions();Re.addDrawMenu("Draw with",Qe,Ie=>{if(0===Ie.indexOf(v.kInspect))return this.showInspector(Ie);this.decodeOptions(Ie),this.options.need_fillcol&&this.fillatt?.empty()&&this.fillatt.change(5,1001),this.interactiveRedraw("pad","drawopt")}),!this.snapid&&!this.isTProfile()&&!this.isTF1()&&Re.addRebinMenu(Ie=>this.rebinHist(Ie))}rebinHist(Re){const Qe=this.getHisto(),Ie=Qe.fXaxis,L=Math.floor(Ie.fNbins/Re);if(L<2)return;const he=new Array(L+2),re=Ie.fXbins.length>0?new Array(L):null;he[0]=Qe.fArray[0];let fe=1;for(let pe=1;pe<=L;++pe){re&&(re[pe-1]=Ie.fXbins[fe-1]);let ce=0;for(let K=0;K<Re;++K)ce+=Qe.fArray[fe++];he[pe]=ce}re?(fe<=Ie.fXbins.length&&(Ie.fXmax=Ie.fXbins[fe-1]),Ie.fXbins=re):Ie.fXmax=Ie.fXmin+(Ie.fXmax-Ie.fXmin)/Ie.fNbins*L*Re,Ie.fNbins=L;let de=0;for(;fe<Qe.fArray.length;)de+=Qe.fArray[fe++];he[L+1]=de,Qe.fArray=he,Qe.fSumw2=[],this.scanContent(),this.interactiveRedraw("pad")}autoZoom(){let Re=this.getSelectIndex("x","left",-1),Qe=this.getSelectIndex("x","right",1);const Ie=Qe-Re,L=this.getHisto();if(0===Ie||!L)return;let he=L.getBinContent(Re+1);for(let re=Re;re<Qe;++re)he=Math.min(he,L.getBinContent(re+1));if(!(he>0)){for(;Re<Qe&&L.getBinContent(Re+1)<=he;)++Re;for(;Re<Qe&&L.getBinContent(Qe)<=he;)--Qe;if(Re===Qe-1&&Re>2&&Qe<this.nbinsx-2&&(--Re,++Qe),Qe-Re<Ie&&Re<Qe)return this.getFramePainter().zoom(L.fXaxis.GetBinLowEdge(Re+1),L.fXaxis.GetBinLowEdge(Qe+1))}}canZoomInside(Re,Qe,Ie){const L=this.getHisto();return!!("x"===Re&&L&&L.fXaxis.FindBin(Ie,.5)-L.fXaxis.FindBin(Qe,0)>1||"y"===Re&&Math.abs(Ie-Qe)>1e-6*Math.abs(this.ymax-this.ymin))}callDrawFunc(Re){var Qe=this;return(0,be.A)(function*(){const Ie=Qe.getMainPainter(),L=Qe.getFramePainter();return Ie!==Qe&&L&&L.mode3d!==Qe.options.Mode3D&&Qe.copyOptionsFrom(Ie),Qe.options.Mode3D?Qe.draw3D(Re):Qe.draw2D(Re)})()}draw2D(){var Re=this;return(0,be.A)(function*(){return Re.clear3DScene(),Re.scanContent(!0),(Re.isMainPainter()?Re.drawColorPalette(!1):Promise.resolve(!0)).then(()=>Re.drawAxes()).then(()=>Re.draw1DBins()).then(()=>Re.updateFunctions()).then(()=>Re.updateHistTitle()).then(()=>(Re.updateStatWebCanvas(),Re.addInteractivity()))})()}draw3D(Re){var Qe=this;return(0,be.A)(function*(){return console.log("3D drawing is disabled, load ./hist/TH1Painter.mjs"),Qe.draw2D(Re)})()}redraw(Re){return this.callDrawFunc(Re)}static draw(Re,Qe,Ie){return(0,be.A)(function*(){return xe.mf._drawHist(new Ke(Re,Qe),Ie)})()}}},1631:(Gr,xt,Te)=>{"use strict";Te.d(xt,{AJ:()=>Qe,Hn:()=>Ke,N7:()=>ot,YB:()=>Re});var be=Te(5774),v=Te(4186),V=Te(3324),Le=Te(139),xe=Te(165),Je=Te(2481),st=Te(2105);function Ke(Ie,L,he,re,fe){const ce=new Float32Array(4008),K=new Float32Array(4008),G=new Int32Array(4008),D=he.length,x=he[0],P=he[D-1],w=[],b=[0,0,0,0],g=[0,0,0,0],C=[0,0,0,0],N=[0,0,0,0],O=L.grx,H=L.gry;let ie,z,m,A,R,k,ee,ge,ve,Se,De,Xe,ct,$,tt,X=0,I=0;const Fe=D<10?kt=>{if(kt>=P)return D-1;for(let Tt=0;Tt<D;++Tt)if(kt<he[Tt])return Tt-1;return D-1}:kt=>{if(kt<x)return-1;if(kt>=P)return D-1;let ln,Tt=0,fn=D-1;for(;fn-Tt>1;)ln=Math.round((fn+Tt)/2),kt<he[ln]?fn=ln:Tt=ln;return Tt},ht=(kt,Tt,fn,ln,mn,jt,Sn,cn)=>{const gn=fn===Sn,Cn=gn?cn-ln:Sn-fn,Ln=mn-kt;let qi,Mr,Sr,ms,Zn=Tt+1,ui=X-1,hi=0;const fs=ui+1002-3;for(;Zn<=jt&&ui<=fs;)ms=he[Zn],Sr=ms-kt,Mr=Sr/Ln,qi=Cn*Mr,gn?(ce[ui]=fn,K[ui]=ln+qi):(ce[ui]=fn+qi,K[ui]=ln),G[ui]=Zn,hi++,ui+=2,Zn++;return hi};for(R=L.j1;R<L.j2-1;++R)for(g[1]=g[0]=(H[R]+H[R+1])/2,g[3]=g[2]=(H[R+1]+H[R+2])/2,A=L.i1;A<L.i2-1;++A){for(C[0]=Ie.getBinContent(A+1,R+1),C[1]=Ie.getBinContent(A+2,R+1),C[2]=Ie.getBinContent(A+2,R+2),C[3]=Ie.getBinContent(A+1,R+2),k=0;k<4;k++)N[k]=Fe(C[k]);if(N[0]!==N[1]||N[1]!==N[2]||N[2]!==N[3]||N[3]!==N[0]){for(b[3]=b[0]=(O[A]+O[A+1])/2,b[2]=b[1]=(O[A+1]+O[A+2])/2,ee=C[0]<=C[1]?0:1,ge=C[2]<=C[3]?2:3,C[ee]>C[ge]&&(ee=ge),ee++,X=1,$=1;$<=4;$++)ge=ee%4+1,ve=ht(C[ee-1],N[ee-1],b[ee-1],g[ee-1],C[ge-1],N[ge-1],b[ge-1],g[ge-1]),X+=2*ve,ee=ge;for(ee=C[0]<=C[1]?0:1,ge=C[2]<=C[3]?2:3,C[ee]>C[ge]&&(ee=ge),ee++,X=2,$=1;$<=4;$++)ge=1===ee?4:ee-1,ve=ht(C[ee-1],N[ee-1],b[ee-1],g[ee-1],C[ge-1],N[ge-1],b[ge-1],g[ge-1]),X+=2*ve,ee=ge;for(Se=0,$=1;$<=X-5;$+=2)for(;G[$-1]!==G[$];){for(De=ce[$],Xe=K[$],ct=G[$],tt=$;tt<=X-5;tt+=2)ce[tt]=ce[tt+2],K[tt]=K[tt+2],G[tt]=G[tt+2];if(ce[X-3]=De,K[X-3]=Xe,G[X-3]=ct,Se>2e3)break;Se++}if(Se>100)continue;for($=1;$<=X-2;$+=2)ie=G[$-1],ie>=0&&ie<he.length&&(z=w[ie],z||(z=w[ie]=(0,v.createTPolyLine)(8016,!0)),m=z.fLastPoint,m<z.fN-2&&(z.fX[m+1]=Math.round(ce[$-1]),z.fY[m+1]=Math.round(K[$-1]),z.fX[m+2]=Math.round(ce[$]),z.fY[m+2]=Math.round(K[$]),z.fLastPoint=m+2,I=Math.max(I,z.fLastPoint+1)))}}const pt=new Int32Array(he.length);let dt=0;for(ie=0;ie<he.length;ie++)if(he[ie]>=0){dt=ie;break}for(k=0,ie=dt-1;ie>=0;ie--)pt[k]=ie,k++;for(ie=dt;ie<he.length;ie++)pt[k]=ie,k++;const rt=new Float32Array(2*I),_t=new Float32Array(2*I),Yt=(0,v.isFunc)(re.calcColorIndex);for(k=0;k<he.length;++k){if(ie=pt[k],z=w[ie],!z)continue;const kt=Yt?re.calcColorIndex(ie,he.length):ie,Tt=z.fX,fn=z.fY,ln=z.fLastPoint+1,mn=0,jt=0;let cn,gn,Cn,Sn=0;for(;;){for(cn=I,gn=cn+1,rt[cn]=Tt[Sn],_t[cn]=fn[Sn],rt[gn]=Tt[Sn+1],_t[gn]=fn[Sn+1],Tt[Sn]=Tt[Sn+1]=mn,fn[Sn]=fn[Sn+1]=jt;;){for(Cn=0,A=2;A<ln;A+=2)gn<2*I-1&&Tt[A]===rt[gn]&&fn[A]===_t[gn]&&(gn++,rt[gn]=Tt[A+1],_t[gn]=fn[A+1],Tt[A]=Tt[A+1]=mn,fn[A]=fn[A+1]=jt,Cn++),cn>0&&Tt[A+1]===rt[cn]&&fn[A+1]===_t[cn]&&(cn--,rt[cn]=Tt[A],_t[cn]=fn[A],Tt[A]=Tt[A+1]=mn,fn[A]=fn[A+1]=jt,Cn++);if(0===Cn)break}for(cn+1<gn&&cn>=0&&fe(kt,rt,_t,cn,gn,ie),Sn=0,A=2;A<ln;A+=2)if(Tt[A]!==mn&&fn[A]!==jt){Sn=A;break}if(0===Sn)break}}}class ot{constructor(L,he,re,fe,de,pe,ce){let K=[re,fe];if(L){K=new Float32Array(L.length);for(let ee=0;ee<L.length;++ee)K[ee]=he(L[ee])}Object.assign(this,{grz_min:re,grz_max:fe,dolines:de,donormals:pe,dogrid:ce}),this.loop=0;const G=[],D=[],x=[],P=new Float32Array(18),w=new Float32Array(6),b=(K[K.length-1]-K[0])/K.length/100;let g=0,C=null,N=0,O=0,H=null,X=0,ie=[],z=0,m=0,I=0;function A(ee,ge,ve,Se){return ee<ge-Se?-1:ee>ve+Se?1:0}function R(ee,ge,ve,Se,De,Xe,ct,$){z>=P.length&&console.log("more than 6 points???");const tt=(ct-ve)/(Xe-ve);let We=3;0!==m&&Math.abs(tt)<Math.abs(m)&&(P[z]=P[z-3],P[z+1]=P[z-2],P[z+2]=P[z-1],z-=3,We=6),P[z]=ee+tt*(Se-ee),P[z+1]=ge+tt*(De-ge),P[z+2]=ct,$&&H&&(w[I]=P[z],w[I+1]=P[z+1],w[I+2]=P[z+2],I+=3),z+=We,m=tt}function k(ee,ge,ve,Se){const De=8*((ve-ge.i1)*(ge.j2-ge.j1)+(Se-ge.j1));if(ie[De]>=0)return console.error("More than 8 vertexes for the bin");const Xe=De+8+ie[De];ie[De]--,ie[Xe]=ee}this.createNormIndex=function(ee){ee.donormals&&(ie=new Int32Array((ee.i2-ee.i1)*(ee.j2-ee.j1)*8).fill(-1))},this.createBuffers=function(){if(this.loop){for(let ee=1;ee<K.length;++ee)G[ee]&&(D[ee]=new Float32Array(9*G[ee]),x[ee]=0);this.dolines&&g>0&&(C=new Float32Array(6*g)),this.dogrid&&O>0&&(H=new Float32Array(6*O))}},this.addLineSegment=function(ee,ge,ve,Se,De,Xe){if(!this.dolines)return;const ct=A(ve,this.grz_min,this.grz_max,0),$=A(Xe,this.grz_min,this.grz_max,0);if(ct!==$||0===ct){if(!this.loop)return++g;if(0!==ct){const tt=Xe-ve;ee=Se-(Se-ee)/tt*(Xe-(ve=ct<0?this.grz_min:this.grz_max)),ge=De-(De-ge)/tt*(Xe-ve)}if(0!==$){const tt=ve-Xe;Se=ee-(ee-Se)/tt*(ve-(Xe=$<0?this.grz_min:this.grz_max)),De=ge-(ge-De)/tt*(ve-Xe)}C[N]=ee,C[N+1]=ge,C[N+2]=ve,N+=3,C[N]=Se,C[N+1]=De,C[N+2]=Xe,N+=3}},this.addMainTriangle=function(ee,ge,ve,Se,De,Xe,ct,$,tt,We,Ne,Fe,ht){for(let pt=1;pt<K.length;++pt){let dt=A(ve,K[pt-1],K[pt],b),rt=A(Xe,K[pt-1],K[pt],b),_t=A(tt,K[pt-1],K[pt],b),Yt=dt+rt+_t;if(pt>1&&pt===K.length-1&&3===Yt&&ve<=this.grz_max&&(dt=rt=_t=Yt=0),3===Yt)continue;if(-3===Yt)return;if(!this.loop){let fn=Math.abs(rt-dt)+Math.abs(_t-rt)+Math.abs(dt-_t);0===dt&&++fn,0===rt&&++fn,0===_t&&++fn,(1===fn||2===fn)&&console.error(`FOUND npnts = ${fn}`),fn>2&&(void 0===G[pt]&&(G[pt]=0),G[pt]+=fn-2),(dt>0||rt>0||_t>0)&&(dt!==rt||rt!==_t||_t!==dt)&&++O;continue}if(I=0,z=0,0===dt&&(P[z]=ee,P[z+1]=ge,P[z+2]=ve,z+=3),dt!==rt&&(m=0,(dt<0||rt<0)&&R(ee,ge,ve,Se,De,Xe,K[pt-1]),(dt>0||rt>0)&&R(ee,ge,ve,Se,De,Xe,K[pt],!0)),0===rt&&(P[z]=Se,P[z+1]=De,P[z+2]=Xe,z+=3),rt!==_t&&(m=0,(rt<0||_t<0)&&R(Se,De,Xe,ct,$,tt,K[pt-1]),(rt>0||_t>0)&&R(Se,De,Xe,ct,$,tt,K[pt],!0)),0===_t&&(P[z]=ct,P[z+1]=$,P[z+2]=tt,z+=3),_t!==dt&&(m=0,(_t<0||dt<0)&&R(ct,$,tt,ee,ge,ve,K[pt-1]),(_t>0||dt>0)&&R(ct,$,tt,ee,ge,ve,K[pt],!0)),0===z)continue;if(z<9){console.log(`found ${z/3} points, must be at least 3`);continue}if(H&&6===I){for(let fn=0;fn<6;++fn)H[X+fn]=w[fn];X+=6}const kt=D[pt];let Tt=x[pt];this.donormals&&9===z&&(k(Tt,Ne,Fe,ht),k(Tt+3,Ne,Fe+1,We?ht+1:ht),k(Tt+6,Ne,We?Fe:Fe+1,ht+1));for(let fn=3;fn<z-3;fn+=3)kt[Tt]=P[0],kt[Tt+1]=P[1],kt[Tt+2]=P[2],Tt+=3,kt[Tt]=P[fn],kt[Tt+1]=P[fn+1],kt[Tt+2]=P[fn+2],Tt+=3,kt[Tt]=P[fn+3],kt[Tt+1]=P[fn+4],kt[Tt+2]=P[fn+5],Tt+=3;x[pt]=Tt}},this.callFuncs=function(ee,ge){for(let ve=1;ve<K.length;++ve)D[ve]&&ee&&ee(ve,D[ve],ie);C&&ge&&(6*g!==N&&console.error(`SURF lines mismmatch nsegm=${g} lindx=${N} diff=${6*g-N}`),ge(!1,C)),H&&ge&&(6*O!==X&&console.error(`SURF grid draw mismatch ngridsegm=${O} gindx=${X} diff=${6*O-X}`),ge(!0,H))}}}function Re(Ie,L,he,re,fe){const de=L.grz,pe=L.original?L.origx:L.grx,ce=L.original?L.origy:L.gry,K=new ot(he,L.grz,L.grz_min,L.grz_max,L.dolines,L.donormals,L.dogrid);let G,D,x,P,w,b,g,C,N,O;for(K.createNormIndex(L),K.loop=0;K.loop<2;++K.loop)for(K.createBuffers(),G=L.i1;G<L.i2-1;++G)for(x=L.original?.5*(pe[G]+pe[G+1]):pe[G],P=L.original?.5*(pe[G+1]+pe[G+2]):pe[G+1],D=L.j1;D<L.j2-1;++D)w=L.original?.5*(ce[D]+ce[D+1]):ce[D],b=L.original?.5*(ce[D+1]+ce[D+2]):ce[D+1],g=de(Ie.getBinContent(G+1,D+1)),C=de(Ie.getBinContent(G+1,D+2)),N=de(Ie.getBinContent(G+2,D+1)),O=de(Ie.getBinContent(G+2,D+2)),K.addMainTriangle(x,w,g,P,b,O,x,b,C,!0,L,G,D),K.addMainTriangle(x,w,g,P,w,N,P,b,O,!1,L,G,D),K.addLineSegment(x,b,C,x,w,g),K.addLineSegment(x,w,g,P,w,N),G===L.i2-2&&K.addLineSegment(P,w,N,P,b,O),D===L.j2-2&&K.addLineSegment(x,b,C,P,b,O);K.callFuncs(re,fe)}class Qe extends st.mf{constructor(L,he){super(L,he),this.wheel_zoomy=!0,this._show_empty_bins=!1}cleanup(){delete this.tt_handle,super.cleanup()}toggleProjection(L,he){("Projections"===L||"Off"===L)&&(L="");let re=he,fe=he;if((0,v.isStr)(L)&&0===L.indexOf("XY")){const pe=L.length>2?L.slice(2):"";L="XY",re=fe=parseInt(pe)||1}else if((0,v.isStr)(L)&&L.length>1){const pe=L.indexOf("_");pe>0&&"X"===L[0]&&"Y"===L[pe+1]?(re=parseInt(L.slice(1,pe))||1,fe=parseInt(L.slice(pe+2))||1,L="XY"):pe>0&&"Y"===L[0]&&"X"===L[pe+1]?(fe=parseInt(L.slice(1,pe))||1,re=parseInt(L.slice(pe+2))||1,L="XY"):(re=fe=parseInt(L.slice(1))||1,L=L[0])}if(!re&&!fe&&(re=fe=1),L&&this.is_projection===L){if(this.projection_widthX!==re||this.projection_widthY!==fe)return this.projection_widthX=re,void(this.projection_widthY=fe);L=""}delete this.proj_hist;const de=this.is_projection===L?"":L;return this.projection_widthX=re,this.projection_widthY=fe,this.is_projection="",this.provideSpecialDrawArea(de).then(()=>(this.is_projection=de,this.redrawProjection()))}redrawProjection(L,he,re,fe){var de=this;return(0,be.A)(function*(){if(!de.is_projection)return!1;if(void 0===fe){if(!de.tt_handle)return;L=Math.round((de.tt_handle.i1+de.tt_handle.i2)/2),he=L+1,re=Math.round((de.tt_handle.j1+de.tt_handle.j2)/2),fe=re+1}const pe=de.getCanvPainter();if(pe&&!pe._readonly&&void 0!==de.snapid)return("X"===de.is_projection||"XY"===de.is_projection)&&!pe.websocketTimeout("projX")&&pe.sendWebsocket(`EXECANDSEND:DXPROJ:${de.snapid}:ProjectionX("_projx",${re+1},${fe},"")`)&&pe.websocketTimeout("projX",1e3),("Y"===de.is_projection||"XY"===de.is_projection)&&!pe.websocketTimeout("projY")&&pe.sendWebsocket(`EXECANDSEND:DYPROJ:${de.snapid}:ProjectionY("_projy",${L+1},${he},"")`)&&pe.websocketTimeout("projY",1e3),!0;if(de.doing_projection)return!1;de.doing_projection=!0;const ce=de.getHisto(),K=()=>{const x=(0,v.createHistogram)(v.clTH1D,de.nbinsx);return Object.assign(x.fXaxis,ce.fXaxis),x.fName="xproj",x.fTitle="X projection",x},G=()=>{const x=(0,v.createHistogram)(v.clTH1D,de.nbinsy);return Object.assign(x.fXaxis,ce.fYaxis),x.fName="yproj",x.fTitle="Y projection",x},D=(x,P)=>{let w=0,b=-1;if("X"===x){for(let g=0;g<de.nbinsx;++g){let C=0;for(let N=re;N<fe;++N)C+=ce.getBinContent(g+1,N+1);P.setBinContent(g+1,C)}P.fTitle="X projection "+(re+1===fe?`bin ${fe}`:`bins [${re+1} .. ${fe}]`),de.tt_handle&&(w=de.tt_handle.i1+1,b=de.tt_handle.i2)}else{for(let g=0;g<de.nbinsy;++g){let C=0;for(let N=L;N<he;++N)C+=ce.getBinContent(N+1,g+1);P.setBinContent(g+1,C)}P.fTitle="Y projection "+(L+1===he?`bin ${he}`:`bins [${L+1} .. ${he}]`),de.tt_handle&&(w=de.tt_handle.j1+1,b=de.tt_handle.j2)}if(w<b){const g=P.fXaxis;g.fFirst=w,g.fLast=b,(1===g.fFirst&&g.fLast===g.fNbins)===g.TestBit(Je.rb.kAxisRange)&&g.InvertBit(Je.rb.kAxisRange)}P.fEntries=0,P.fTsumw=0};if(!de.proj_hist)switch(de.is_projection){case"X":de.proj_hist=K();break;case"XY":de.proj_hist=K(),de.proj_hist2=G();break;default:de.proj_hist=G()}return"XY"===de.is_projection?(D("X",de.proj_hist),D("Y",de.proj_hist2),de.drawInSpecialArea(de.proj_hist,"","X").then(()=>de.drawInSpecialArea(de.proj_hist2,"","Y")).then(x=>(delete de.doing_projection,x))):(D(de.is_projection,de.proj_hist),de.drawInSpecialArea(de.proj_hist).then(x=>(delete de.doing_projection,x)))})()}executeMenuCommand(L,he){return!!super.executeMenuCommand(L,he)||("SetShowProjectionX"===L.fName||"SetShowProjectionY"===L.fName?(this.toggleProjection(L.fName[17],he&&parseInt(he)?parseInt(he):1),!0):"SetShowProjectionXY"===L.fName&&(this.toggleProjection("X"+he.replaceAll(",","_Y")),!0))}fillHistContextMenu(L){if(!this.isTH2Poly()&&this.getPadPainter()?.iscan){let re=this.is_projection||"";re&&(re+=this.projection_widthX),this.projection_widthX!==this.projection_widthY&&"XY"===this.is_projection&&(re=`X${this.projection_widthX}_Y${this.projection_widthY}`);const fe=["X1","X2","X3","X5","X10","Y1","Y2","Y3","Y5","Y10","XY1","XY2","XY3","XY5","XY10"];re&&fe.unshift("Off"),L.add("sub:Projections",()=>L.input("Input projection kind X1 or XY2 or X3_Y4",re,"string").then(de=>this.toggleProjection(de)));for(let de=0;de<fe.length;++de)L.addchk(re===fe[de],fe[de],fe[de],pe=>this.toggleProjection(pe));L.add("endsub:")}this.isTH2Poly()||L.add("Auto zoom-in",()=>this.autoZoom());const he=this.getSupportedDrawOptions();L.addDrawMenu("Draw with",he,re=>{if(0===re.indexOf(v.kInspect))return this.showInspector(re);const fe=this.options.Project;this.decodeOptions(re),fe===this.options.Project||this.mode3d?this.interactiveRedraw("pad","drawopt"):this.toggleProjection(this.options.Project)}),(this.options.Color||this.options.Contour||this.options.Hist||this.options.Surf||12===this.options.Lego||14===this.options.Lego)&&this.fillPaletteMenu(L,!0)}clickButton(L){const he=super.clickButton(L);if(he)return he;if(this.isMainPainter())switch(L){case"ToggleColor":return this.toggleColor();case"ToggleColorZ":return this.toggleColz();case"Toggle3D":return this.toggleMode3D()}return!1}fillToolbar(){super.fillToolbar(!0);const L=this.getPadPainter();L&&(!this.isTH2Poly()&&!this.options.Axis&&L.addPadButton("th2color","Toggle color","ToggleColor"),this.options.Axis||L.addPadButton("th2colorz","Toggle color palette","ToggleColorZ"),L.addPadButton("th2draw3d","Toggle 3D mode","Toggle3D"),L.showPadButtons())}toggleColor(){return this.options.Mode3D?(this.options.Mode3D=!1,this.options.Color=!0):(this.options.Color=!this.options.Color,this.options.Scat=!this.options.Color),this._can_move_colz=!0,this.copyOptionsToOthers(),this.interactiveRedraw("pad","drawopt")}autoZoom(){if(this.isTH2Poly())return;const L=this.getSelectIndex("x","left",-1),he=this.getSelectIndex("x","right",1),re=this.getSelectIndex("y","left",-1),fe=this.getSelectIndex("y","right",1),de=this.getObject();if(L===he||re===fe)return;let pe=de.getBinContent(L+1,re+1);for(let C=L;C<he;++C)for(let N=re;N<fe;++N)pe=Math.min(pe,de.getBinContent(C+1,N+1));if(pe>0)return;let ce=he,K=L,G=fe,D=re;for(let C=L;C<he;++C)for(let N=re;N<fe;++N)de.getBinContent(C+1,N+1)>pe&&(C<ce&&(ce=C),C>=K&&(K=C+1),N<G&&(G=N),N>=D&&(D=N+1));let x,P,w,b,g=!1;return ce===K-1&&ce>L+1&&K<he-1&&(ce--,K++),G===D-1&&G>re+1&&D<fe-1&&(G--,D++),(ce>L||K<he)&&ce<K-1&&(x=de.fXaxis.GetBinLowEdge(ce+1),P=de.fXaxis.GetBinLowEdge(K+1),g=!0),(G>re||D<fe)&&G<D-1&&(w=de.fYaxis.GetBinLowEdge(G+1),b=de.fYaxis.GetBinLowEdge(D+1),g=!0),g?this.getFramePainter().zoom(x,P,w,b):void 0}scanContent(L){if(L&&this.nbinsx&&this.nbinsy)return;const he=this.getObject();let re,fe;if(this.extractAxesProperties(2),this.isTH2Poly()){this.gminposbin=null,this.gminbin=this.gmaxbin=0;for(let pe=0,ce=he.fBins.arr.length;pe<ce;++pe){const K=he.fBins.arr[pe].fContent;0===pe&&(this.gminbin=this.gmaxbin=K),K<this.gminbin?this.gminbin=K:K>this.gmaxbin&&(this.gmaxbin=K),K>0&&(null===this.gminposbin||this.gminposbin>K)&&(this.gminposbin=K)}}else for(this.gminbin=this.gmaxbin=he.getBinContent(1,1),this.gminposbin=null,re=0;re<this.nbinsx;++re)for(fe=0;fe<this.nbinsy;++fe){const pe=he.getBinContent(re+1,fe+1);pe<this.gminbin?this.gminbin=pe:pe>this.gmaxbin&&(this.gmaxbin=pe),pe>0&&(null===this.gminposbin||this.gminposbin>pe)&&(this.gminposbin=pe)}null===this.gminposbin&&this.gmaxbin>0&&(this.gminposbin=1e-4*this.gmaxbin);const de=0!==this.gmaxbin||0!==this.gminbin;this.options.Axis>0?this.draw_content=!1:this.isTH2Poly()?(this.draw_content=de||this.options.Line||this.options.Fill||this.options.Mark,!this.draw_content&&this.options.Zero&&(this.draw_content=!0,this.options.Line=1)):this.draw_content=de}countStat(L,he){(0,v.isFunc)(L)||(L=this.options.cutg?(A,R)=>this.options.cutg.IsInside(A,R):null);const re=this.getHisto(),fe=re.fXaxis,de=re.fYaxis,pe=this.getFramePainter(),ce=pe.getGrFuncs(this.options.second_x,this.options.second_y),K={name:re.fName,entries:0,eff_entries:0,integral:0,meanx:0,meany:0,rmsx:0,rmsy:0,matrix:[0,0,0,0,0,0,0,0,0],xmax:0,ymax:0,wmax:null,skewx:0,skewy:0,skewd:0,kurtx:0,kurty:0,kurtd:0},G=!pe.isAxisZoomed("x")&&!pe.isAxisZoomed("y")&&Math.abs(re.fTsumw)>1e-300&&!L;let C,N,O,H,X,ie,z,m,I,D=0,x=0,P=0,w=0,b=0,g=0;if(this.isTH2Poly()){const A=re.fBins.arr.length;let R,k,ee,ge,ve,Se,De;for(R=0;R<A;++R){for(k=re.fBins.arr[R],C=k.fXmin>ce.scale_xmax?2:k.fXmax<ce.scale_xmin?0:1,N=k.fYmin>ce.scale_ymax?2:k.fYmax<ce.scale_ymin?0:1,O=H=De=0,ge=k.fPoly,Se=1,ge._typename===v.clTMultiGraph&&(Se=k.fPoly.fGraphs.arr.length,ge=null),ve=0;ve<Se;++ve)for((!ge||ve>0)&&(ge=k.fPoly.fGraphs.arr[ve]),ee=0;ee<ge.fNpoints;++ee)++De,O+=ge.fX[ee],H+=ge.fY[ee];De>1&&(O/=De,H/=De),X=k.fContent,K.entries+=X,K.matrix[3*N+C]+=X,1===C&&1===N&&(!L||L(O,H))&&((null===K.wmax||X>K.wmax)&&(K.wmax=X,K.xmax=O,K.ymax=H),G||(D+=X,x+=X*X,P+=O*X,w+=H*X,b+=O*O*X,g+=H*H*X))}}else{ie=this.getSelectIndex("x","left"),z=this.getSelectIndex("x","right"),m=this.getSelectIndex("y","left"),I=this.getSelectIndex("y","right");for(let A=0;A<=this.nbinsx+1;++A){C=A<=ie?0:A>z?2:1,O=fe.GetBinCoord(A-.5);for(let R=0;R<=this.nbinsy+1;++R)N=R<=m?0:R>I?2:1,H=de.GetBinCoord(R-.5),X=re.getBinContent(A,R),K.entries+=X,K.matrix[3*N+C]+=X,1===C&&1===N&&(!L||L(O,H))&&((null===K.wmax||X>K.wmax)&&(K.wmax=X,K.xmax=O,K.ymax=H),G||(D+=X,x+=X*X,P+=O*X,w+=H*X,b+=O**2*X,g+=H**2*X))}}if(G&&(D=re.fTsumw,x=re.fTsumw2,P=re.fTsumwx,b=re.fTsumwx2,w=re.fTsumwy,g=re.fTsumwy2),Math.abs(D)>1e-300&&(K.meanx=P/D,K.meany=w/D,K.rmsx=Math.sqrt(Math.abs(b/D-K.meanx**2)),K.rmsy=Math.sqrt(Math.abs(g/D-K.meany**2))),null===K.wmax&&(K.wmax=0),K.integral=D,re.fEntries>1&&(K.entries=re.fEntries),K.eff_entries=x?D*D/x:Math.abs(D),he&&!this.isTH2Poly()){let A=0,R=0,k=0,ee=0,ge=0,ve=0;for(let $=ie;$<z;++$){O=fe.GetBinCoord($+.5);for(let tt=m;tt<I;++tt)H=de.GetBinCoord(tt+.5),(!L||L(O,H))&&(ve=re.getBinContent($+1,tt+1),ge+=ve,A+=ve*Math.pow(O-K.meanx,3),R+=ve*Math.pow(H-K.meany,3),k+=ve*Math.pow(O-K.meanx,4),ee+=ve*Math.pow(H-K.meany,4))}const Se=Math.pow(K.rmsx,3),De=Math.pow(K.rmsy,3),Xe=Math.pow(K.rmsx,4),ct=Math.pow(K.rmsy,4);ge*Se!=0&&(K.skewx=A/(ge*Se)),ge*De!=0&&(K.skewy=R/(ge*De)),K.skewd=K.eff_entries>0?Math.sqrt(6/K.eff_entries):0,ge*Xe!=0&&(K.kurtx=k/(ge*Xe)-3),ge*ct!=0&&(K.kurty=ee/(ge*ct)-3),K.kurtd=K.eff_entries>0?Math.sqrt(24/K.eff_entries):0}return K}fillStatistic(L,he,re){if(this.isIgnoreStatsFill())return!1;1===he&&(he=1111);const fe=Math.floor(he%10),de=Math.floor(he/10)%10,pe=Math.floor(he/100)%10,ce=Math.floor(he/1e3)%10,K=Math.floor(he/1e4)%10,G=Math.floor(he/1e5)%10,D=Math.floor(he/1e6)%10,x=Math.floor(he/1e7)%10,P=Math.floor(he/1e8)%10,w=this.countStat(void 0,x>0||P>0);if(L.clearPave(),fe>0&&L.addText(w.name),de>0&&L.addText("Entries = "+L.format(w.entries,"entries")),pe>0&&(L.addText("Mean x = "+L.format(w.meanx)),L.addText("Mean y = "+L.format(w.meany))),ce>0&&(L.addText("Std Dev x = "+L.format(w.rmsx)),L.addText("Std Dev y = "+L.format(w.rmsy))),D>0&&L.addText("Integral = "+L.format(w.matrix[4],"entries")),2===x?(L.addText(`Skewness x = ${L.format(w.skewx)} #pm ${L.format(w.skewd)}`),L.addText(`Skewness y = ${L.format(w.skewy)} #pm ${L.format(w.skewd)}`)):x>0&&(L.addText(`Skewness x = ${L.format(w.skewx)}`),L.addText(`Skewness y = ${L.format(w.skewy)}`)),2===P?(L.addText(`Kurtosis x = ${L.format(w.kurtx)} #pm ${L.format(w.kurtd)}`),L.addText(`Kurtosis y = ${L.format(w.kurty)} #pm ${L.format(w.kurtd)}`)):P>0&&(L.addText(`Kurtosis x = ${L.format(w.kurtx)}`),L.addText(`Kurtosis y = ${L.format(w.kurty)}`)),K>0||G>0){const b=g=>w.matrix[g].toFixed(0);L.addText(`${b(6)} | ${b(7)} | ${b(7)}`),L.addText(`${b(3)} | ${b(4)} | ${b(5)}`),L.addText(`${b(0)} | ${b(1)} | ${b(2)}`)}return re&&L.fillFunctionStat(this.findFunction(v.clTF2),re,2),!0}drawBinsColor(){const L=this.getHisto(),he=this.prepareDraw(),re=this.getContour(),fe=this.getHistPalette(),de=[],pe=this._show_empty_bins,ce=1===he.xbar2&&0===he.xbar1,K=1===he.ybar2&&0===he.ybar1;let G,D,x,P,w,b,g,C=null,N=!this.options.Zero;const O=this.options.cutg,H=()=>{C.path+=`h${G}v${C.y1-C.y2}h${-G}z`,C=null};!N&&!pe&&null===re.getPaletteIndex(fe,0)&&(N=!0);for(let X=he.i1;X<he.i2;++X){G=he.grx[X+1]-he.grx[X]||1,ce?x=he.grx[X]:(x=Math.round(he.grx[X]+G*he.xbar1),G=Math.round(G*(he.xbar2-he.xbar1))||1);for(let ie=he.j2-1;ie>=he.j1;--ie){if(w=L.getBinContent(X+1,ie+1),b=0===w,b&&N||O&&!O.IsInside(L.fXaxis.GetBinCoord(X+.5),L.fYaxis.GetBinCoord(ie+.5))){C&&H();continue}if(g=re.getPaletteIndex(fe,w),null===g){if(!b||!pe){C&&H();continue}g=0}D=he.gry[ie]-he.gry[ie+1]||1,K?P=he.gry[ie+1]:(P=Math.round(he.gry[ie]-D*he.ybar2),D=Math.round(D*(he.ybar2-he.ybar1))||1);const z=`M${x},${P}`;let m=de[g];if(m){if(K&&m===C){m.y1=P+D;continue}{const I=x-m.x1,A=P-m.y2;if(I||A){const R=`m${I},${A}`;m.path+=R.length<z.length?R:z}}}else m=de[g]={path:z};C&&H(),m.x1=x,m.y2=P,K?(m.y1=P+D,C=m):m.path+=`h${G}v${D}h${-G}z`}C&&H()}return de.forEach((X,ie)=>{X&&this.draw_g.append("svg:path").attr("fill",fe.getColor(ie)).attr("d",X.path)}),he}drawBinsProjected(){const L=this.prepareDraw({rounding:!1,nozoom:!0,extra:100,original:!0}),he=this.getFramePainter(),re=he.getGrFuncs(this.options.second_x,this.options.second_y),fe=this.getContourLevels(),de=this.getHistPalette(),pe=he.getProjectionFunc();return L.grz=ce=>ce,L.grz_min=fe[0],L.grz_max=fe[fe.length-1],Re(this.getHisto(),L,fe,(ce,K)=>{let D,x,G="";for(let P=0;P<K.length;P+=3){const w=pe(K[P],K[P+1]),b=Math.round(re.grx(w.x)),g=Math.round(re.gry(w.y));if(0===P)G=`M${b},${g}`;else{if(b===D&&g===x)continue;G+=P%9==0?`m${b-D},${g-x}`:g===x?"h"+(b-D):b===D?"v"+(g-x):`l${b-D},${g-x}`}D=b,x=g}this.draw_g.append("svg:path").attr("d",G).style("fill",de.calcColor(ce,fe.length))}),L}drawBinsContour(){const L=this.prepareDraw({rounding:!1,extra:100}),he=this.getFramePainter(),re=he.getFrameWidth(),fe=he.getFrameHeight(),de=this.getContourLevels(),pe=this.getHistPalette(),ce=(G,D)=>{const x=G.x2-G.x1,P=G.y2-G.y1,w=D.x2-D.x1,b=D.y2-D.y1,g=x*b-w*P;if(0===g)return 0;const C=g>0,N=G.x1-D.x1,O=G.y1-D.y1,H=x*O-P*N;if(H<0===C)return null;const X=w*O-b*N;if(X<0===C||H>g===C||X>g===C)return null;const ie=X/g;return{x:Math.round(G.x1+ie*x),y:Math.round(G.y1+ie*P)}},K=(G,D,x,P,w,b)=>{let C,N,O,H,ie,z,m,g="",X=!1;for(let De=x;De<=P;++De){if(z=Math.round(G[De]),m=Math.round(D[De]),g)if(De===P&&x!==P&&z===O&&m===H){if(!X)return"";g+="z",w=!1,ie=!0}else{const Xe=z-C,ct=m-N;Xe?(X=!0,g+=ct?`l${Xe},${ct}`:`h${Xe}`):ct&&(X=!0,g+=`v${ct}`)}else g=`M${z},${m}`,O=z,H=m;C=z,N=m}if(!w||ie||!b)return w?g+"z":g;const I=[{x:0,y:0},{x:re,y:0},{x:re,y:fe},{x:0,y:fe}],A=(De,Xe)=>{const ct={x1:G[De],y1:D[De],x2:2*G[De]-G[De+Xe],y2:2*D[De]-D[De+Xe]};for(let $=0;$<4;++$){const tt=ce(ct,{x1:I[$].x,y1:I[$].y,x2:I[($+1)%4].x,y2:I[($+1)%4].y});if(tt)return tt.indx=$+.5,tt}return null};let R,k;for(x--;x<P-1&&!R;)R=A(++x,1);if(!R)return"";for(P++;x<P-1&&!k;)k=A(--P,-1);if(!k)return"";let ee=K(G,D,x,P),ge=k.indx;for(ee+=`L${k.x},${k.y}`;Math.abs(ge-R.indx)>.1;)ge=Math.round(ge+.5)%4,ee+=`L${I[ge].x},${I[ge].y}`,ge+=.5;return ee+`L${R.x},${R.y}z`};return 14===this.options.Contour&&this.draw_g.append("svg:path").attr("d",`M0,0h${re}v${fe}h${-re}z`).style("fill",pe.calcColor(0,de.length)),Ke(this.getHisto(),L,de,pe,(G,D,x,P,w,b)=>{const g=pe.getColor(G);let N,C=g;switch(this.options.Contour){case 1:case 14:break;case 11:C="none",N=this.createAttLine({color:g,std:!1});break;case 12:C="none",N=this.createAttLine({color:1,style:b%5+1,width:1,std:!1});break;case 13:C="none",N=this.lineatt}const O=K(D,x,P,w,"none"!==C,!0);if(!O)return;const H=this.draw_g.append("svg:path").attr("d",O).style("fill",C);N&&H.call(N.func)}),L.hide_only_zeros=!0,L}getGrNPoints(L){const he=L.fX,re=L.fY;let fe=L.fNpoints;return fe>2&&he[0]===he[fe-1]&&re[0]===re[fe-1]&&fe--,fe}createPolyGr(L,he,re){let fe="",de=0,pe=0;const ce=he.fX,K=he.fY,G=()=>{de&&(fe+="h"+de,de=0),pe&&(fe+="v"+pe,pe=0)},D=(C,N,O,H)=>{const X=Math.sqrt((C-O)**2+(N-H)**2);re.sumx+=(C+O)*X/2,re.sumy+=(N+H)*X/2,re.sum+=X},x=this.getGrNPoints(he);if(x<2)return"";const P=Math.round(L.grx(ce[0])),w=Math.round(L.gry(K[0]));let b=P,g=w;for(let C=1;C<x;++C){const N=Math.round(L.grx(ce[C])),O=Math.round(L.gry(K[C])),H=N-b,X=O-g;re&&D(b,g,N,O),(H||X)&&(0===H?((0===pe||X<0!=pe<0)&&G(),pe+=X):0===X?((0===de||H<0!=de<0)&&G(),de+=H):(G(),fe+=`l${H},${X}`),b=N,g=O)}return re&&D(b,g,P,w),G(),fe?`M${P},${w}`+fe+"z":""}createPolyBin(L,he){const re=he.fPoly._typename===v.clTMultiGraph?he.fPoly.fGraphs.arr:[he.fPoly];let fe="";for(let de=0;de<re.length;++de)fe+=this.createPolyGr(L,re[de]);return fe}drawPolyBins(){var L=this;return(0,be.A)(function*(){const he=L.getObject(),re=L.getFramePainter(),fe=re.getGrFuncs(L.options.second_x,L.options.second_y),de=L.options.Color||!L.options.Line&&!L.options.Fill&&!L.options.Text&&!L.options.Mark,pe=L.options.Line||L.options.Text&&!de,ce=L.options.Fill&&!de,K=L.options.Mark,G=re.getFrameHeight(),D=[],x=he.fBins.arr.length;let P,w,C,N,O,b="",g="",H=null,X=pe,ie=ce,z=K;L.maxbin=L.gmaxbin,L.minbin=L.gminbin,L.minposbin=L.gminposbin;const m=de?L.getContour(!0):null,I=m?L.getHistPalette():null,A=Se=>Se.fXmin>fe.scale_xmax||Se.fXmax<fe.scale_xmin||Se.fYmin>fe.scale_ymax||Se.fYmax<fe.scale_ymin;for(O=0;O<x;++O){if(C=he.fBins.arr[O],A(C))continue;const Se=C.fPoly._typename===v.clTMultiGraph?C.fPoly.fGraphs.arr:[C.fPoly];for(let De=0;De<Se.length;++De){const Xe=Se[De];H?(X&&(H.fLineColor!==Xe.fLineColor||H.fLineWidth!==Xe.fLineWidth||H.fLineStyle!==Xe.fLineStyle)&&(X=!1),ie&&(H.fFillColor!==Xe.fFillColor||H.fFillStyle!==Xe.fFillStyle)&&(ie=!1),z&&(H.fMarkerColor!==Xe.fMarkerColor||H.fMarkerStyle!==Xe.fMarkerStyle||H.fMarkerSize!==Xe.fMarkerSize)&&(z=!1)):H=Xe}if(!X&&!ie&&!z)break}const R=X&&H?L.createAttLine(H):null,k=ie&&H?L.createAttFill(H):null,ee=z&&H?L.createAttMarker({attr:H,style:L.options.MarkStyle,std:!1}):null,ge=!de&&(!pe||X)&&(!ce||ie);for(O=0;O<x;++O){if(C=he.fBins.arr[O],A(C))continue;const Se=C.fContent||L.options.Zero,De=C.fPoly._typename===v.clTMultiGraph?C.fPoly.fGraphs.arr:[C.fPoly];P=de&&Se?m.getPaletteIndex(I,C.fContent):null;const Xe=L.options.Text&&Se?{bin:C,sumx:0,sumy:0,sum:0}:null;for(let ct=0;ct<De.length;++ct){const $=De[ct];if(ee){const tt=L.getGrNPoints($);for(let We=0;We<tt;++We)g+=ee.create(fe.grx($.fX[We]),fe.gry($.fY[We]))}w=L.createPolyGr(fe,$,Xe),w&&(ge?b+=w:(null!==P||ce||pe)&&(N=L.draw_g.append("svg:path").attr("d",w),de&&null!==P?N.style("fill",L._color_palette.getColor(P)):ce?N.call(L.createAttFill($).func):N.style("fill","none"),pe&&N.call(L.createAttLine($).func)))}Xe?.sum&&D.push(Xe)}if(ge&&(N=L.draw_g.append("svg:path").attr("d",b),ce&&k?N.call(k.func):N.style("fill","none"),pe&&R&&N.call(R.func)),ee&&!ee.empty()&&g)L.draw_g.append("svg:path").attr("d",g).call(ee.func);else if(K)for(O=0;O<x;++O){if(C=he.fBins.arr[O],A(C))continue;const Se=C.fPoly._typename===v.clTMultiGraph?C.fPoly.fGraphs.arr:[C.fPoly];for(let De=0;De<Se.length;++De){const Xe=Se[De],ct=L.getGrNPoints(Xe),$=L.createAttMarker({attr:Xe,style:L.options.MarkStyle,std:!1});if(!ct||$.empty())continue;let tt="";for(let We=0;We<ct;++We)tt+=$.create(fe.grx(Xe.fX[We]),fe.gry(Xe.fY[We]));L.draw_g.append("svg:path").attr("d",tt).call($.func)}}let ve=Promise.resolve(!0);if(D.length>0){const Se=L.getColor(he.fMarkerColor),De=-1*L.options.TextAngle,Xe=L.draw_g.append("svg:g").attr("class","th2poly_text"),ct=1!==he.fMarkerSize&&De?Math.round(.02*G*he.fMarkerSize):12;for(L.startTextDrawing(42,ct,Xe,ct),O=0;O<D.length;++O){const $=D[O];let tt;C=$.bin,$.sum>0?($.midx=Math.round($.sumx/$.sum),$.midy=Math.round($.sumy/$.sum)):($.midx=Math.round(fe.grx((C.fXmin+C.fXmax)/2)),$.midy=Math.round(fe.gry((C.fYmin+C.fYmax)/2))),L.options.TextKind?(tt=C.fPoly?.fName,(!tt||"Graph"===tt)&&(tt=C.fNumber.toString())):tt=Math.round(C.fContent)===C.fContent?C.fContent.toString():(0,xe.lg)(C.fContent,v.gStyle.fPaintTextFormat),L.drawText({align:22,x:$.midx,y:$.midy,rotate:De,text:tt,color:Se,latex:0,draw_g:Xe})}ve=L.finishTextDrawing(Xe,!0)}return ve.then(()=>({poly:!0}))})()}drawBinsText(L){var he=this;return(0,be.A)(function*(){const re=he.getObject(),fe=he.options.cutg,de=he.getColor(re.fMarkerColor),pe=-1*he.options.TextAngle,ce=he.draw_g.append("svg:g").attr("class","th2_text"),K="E"===he.options.TextKind,G=K&&!he.options.TextLine?1:0;let D,x,P,w,b=20,g=0;L||(L=he.prepareDraw({rounding:!1})),1!==re.fMarkerSize&&pe&&(b=Math.round(.02*re.fMarkerSize*he.getFramePainter().getFrameHeight())),0!==re.fBarOffset&&(g=.001*re.fBarOffset),he.startTextDrawing(42,b,ce,b);for(let C=L.i1;C<L.i2;++C){const N=L.grx[C+1]-L.grx[C];for(let O=L.j1;O<L.j2;++O){const H=re.getBinContent(C+1,O+1);if(0===H&&!he._show_empty_bins||fe&&!fe.IsInside(re.fXaxis.GetBinCoord(C+.5),re.fYaxis.GetBinCoord(O+.5)))continue;const X=L.gry[O]-L.gry[O+1];let ie=H===Math.round(H)?H.toString():(0,xe.lg)(H,v.gStyle.fPaintTextFormat);if(K){const z=re.getBinError(re.getBin(C+1,O+1)),m=z===Math.round(z)?z.toString():(0,xe.lg)(z,v.gStyle.fPaintTextFormat);he.options.TextLine?ie+="\xb1"+m:ie=`#splitline{${ie}}{#pm${m}}`}pe?(D=Math.round(L.grx[C]+.5*N),x=Math.round(L.gry[O+1]+X*(.5+g)),P=w=0):(D=Math.round(L.grx[C]+.1*N),x=Math.round(L.gry[O+1]+X*(.1+g)),P=Math.round(.8*N),w=Math.round(.8*X)),he.drawText({align:22,x:D,y:x,width:P,height:w,rotate:pe,text:ie,color:de,latex:G,draw_g:ce})}}return L.hide_only_zeros=!0,he.finishTextDrawing(ce,!0).then(()=>L)})()}drawBinsArrow(){const L=this.getObject(),he=this.options.cutg,re=this.prepareDraw({rounding:!1}),fe=(re.grx[re.i2]-re.grx[re.i1])/(re.i2-re.i1+1)/2,de=(re.gry[re.j2]-re.gry[re.j1])/(re.j2-re.j1+1)/2,pe=(I,A)=>I?A?`l${I},${A}`:`h${I}`:A?`v${A}`:"";let ce,K,D,x,P,w,g,C,N,O,H,X,ie,z,m,G=1e-30,b="";for(let I=0;I<2;++I)for(ce=re.i1;ce<re.i2;++ce)for(K=re.j1;K<re.j2;++K)he&&!he.IsInside(L.fXaxis.GetBinCoord(ce+.5),L.fYaxis.GetBinCoord(K+.5))||(D=ce===re.i1?L.getBinContent(ce+2,K+1)-L.getBinContent(ce+1,K+1):ce===re.i2-1?L.getBinContent(ce+1,K+1)-L.getBinContent(ce,K+1):.5*(L.getBinContent(ce+2,K+1)-L.getBinContent(ce,K+1)),x=K===re.j1?L.getBinContent(ce+1,K+2)-L.getBinContent(ce+1,K+1):K===re.j2-1?L.getBinContent(ce+1,K+1)-L.getBinContent(ce+1,K):.5*(L.getBinContent(ce+1,K+2)-L.getBinContent(ce+1,K)),0===I?G=Math.max(G,Math.abs(D),Math.abs(x)):(P=(re.grx[ce]+re.grx[ce+1])/2,w=(re.gry[K]+re.gry[K+1])/2,g=fe*D/G,C=de*x/G,N=P-g,O=P+g,H=w-C,X=w+C,D=Math.round(O-N),x=Math.round(X-H),(D||x)&&(b+=`M${Math.round(N)},${Math.round(H)}${pe(D,x)}`,(Math.abs(D)>5||Math.abs(x)>5)&&(ie=Math.sqrt(9/(D**2+x**2)),z=Math.round(ie*(D+x)),m=Math.round(ie*(D-x)),(z||m)&&(b+=`m${-z},${m}${pe(z,-m)}${pe(-m,-z)}`)))));return this.draw_g.append("svg:path").attr("d",b).style("fill","none").call(this.lineatt.func),re}drawBinsBox(){const L=this.getObject(),he=this.prepareDraw({rounding:!1}),re=this.getMainPainter();re===this&&(re.maxbin===re.minbin&&(re.maxbin=re.gmaxbin,re.minbin=re.gminbin,re.minposbin=re.gminposbin),re.maxbin===re.minbin&&(re.minbin=Math.min(0,re.maxbin-1)));const fe=Math.max(Math.abs(re.maxbin),Math.abs(re.minbin)),de=Math.max(0,re.minbin),pe=this.getPadPainter().getRootPad(!0),ce=this.options.cutg;let K,G,D,x,C,N,O,H,X,ie,z,m,P="",w="",b="",g="",I=!1,A=0;if((pe?.fLogv??pe?.fLogz)&&fe>0){I=!0;const R=Math.log(fe);A=de>0?Math.log(de):re.minposbin>=1&&re.minposbin<100?Math.log(.7):re.minposbin>0?Math.log(.7*re.minposbin):R-10,A>=R&&(A=R-10),m=1/(R-A)}else m=1/(fe-de);for(K=he.i1;K<he.i2;++K)for(G=he.j1;G<he.j2;++G)if(D=L.getBinContent(K+1,G+1),x=Math.abs(D),!(0===x||x<de)&&(!ce||ce.IsInside(L.fXaxis.GetBinCoord(K+.5),L.fYaxis.GetBinCoord(G+.5)))&&(C=I?x>0?Math.log(x)-A:0:x-de,C=.5*(C<0?1:1-Math.sqrt(C*m)),C<0&&(C=0),ie=he.grx[K+1]-he.grx[K],z=he.gry[G]-he.gry[G+1],N=C*ie,O=C*z,H=Math.round(he.grx[K]+N),X=Math.round(he.gry[G+1]+O),ie=Math.max(Math.round(ie-2*N),1),z=Math.max(Math.round(z-2*O),1),P+=`M${H},${X}v${z}h${ie}v${-z}z`,D<0&&10===this.options.BoxStyle&&(w+=`M${H},${X}l${ie},${z}m0,${-z}l${-ie},${z}`),11===this.options.BoxStyle&&ie>5&&z>5)){const R=Math.round(.1*ie),k=Math.round(.1*z),ee=`M${H},${X}h${ie}l${-R},${k}h${2*R-ie}v${z-2*k}l${-R},${k}z`,ge=`M${H+ie},${X+z}v${-z}l${-R},${k}v${z-2*k}h${2*R-ie}l${-R},${k}z`;b+=D<0?ge:ee,g+=D<0?ee:ge}if(P){const R=this.draw_g.append("svg:path").attr("d",P).call(this.fillatt.func);11!==this.options.BoxStyle&&this.fillatt.empty()&&R.call(this.lineatt.func)}if(b&&this.fillatt.hasColor()&&this.draw_g.append("svg:path").attr("d",b).call(this.fillatt.func).style("fill",(0,V.Qh)(this.fillatt.color).brighter(.5).formatHex()),g&&this.draw_g.append("svg:path").attr("d",g).call(this.fillatt.func).style("fill",this.fillatt.hasColor()?(0,V.Qh)(this.fillatt.color).darker(.5).formatHex():"red"),w){const R=this.draw_g.append("svg:path").attr("d",w).style("fill","none");this.lineatt.empty()?R.style("stroke","black"):R.call(this.lineatt.func)}return he}drawBinsCandle(){let ie=0;const z=cn=>{let gn=1;for(;cn>=gn;)gn*=10;return gn/=10,Math.floor(ie/gn)%10===Math.floor(cn/gn)},m=(cn,gn)=>{let Cn="",Ln="",Zn=0;const ui=cn[0],hi=cn[1];if(ui>="A"&&ui<="Z"&&(Cn=ui),ui>="1"&&ui<="9"&&(Ln=ui),hi>="A"&&hi<="Z"&&Ln&&(Cn=hi),hi>="1"&&hi<="9"&&Cn&&(Ln=hi),gn)switch(Ln){case"1":default:Zn+=11311;break;case"2":Zn+=112111;break;case"3":Zn+=112311;break;case"4":Zn+=112321;break;case"5":Zn+=212111;break;case"6":Zn+=312311}else switch(Ln){case"1":default:Zn+=13001300;break;case"2":Zn+=13102300}const qi=cn.indexOf("("),Mr=cn.lastIndexOf(")");qi>=0&&Mr>qi+1&&(Zn=parseInt(cn.slice(qi+1,Mr))),ie=Zn,("Y"===Cn||"H"===Cn)&&!z(1e8)&&(ie+=1e8)};this.options.Candle?m(this.options.Candle,!0):this.options.Violin&&m(this.options.Violin,!1);const A=this.getHisto(),R=this.prepareDraw(),k=this.getFramePainter(),ee=this.getCanvPainter(),ge=k.getGrFuncs(this.options.second_x,this.options.second_y),ve=z(1e8);let Fe,ht,Se="",De="",Xe="",ct="",$="",tt="",We="",Ne=null,pt=v.gStyle.fViolinScaled,dt=v.gStyle.fCandleScaled,rt=0,_t=0;if(null!==this.options.Scaled?pt=dt=this.options.Scaled:ee?.online_canvas||(A.fTitle.indexOf("unscaled")>=0?pt=dt=!1:A.fTitle.indexOf("scaled")>=0&&(pt=dt=!0)),pt&&(z(2e6)||z(1e6)||z(3e6)))for(let cn=0;cn<this.nbinsx;++cn)for(let gn=0;gn<this.nbinsy;++gn)rt=Math.max(rt,A.getBinContent(cn+1,gn+1));const Yt=(...cn)=>{"array"===cn[1]&&(cn=cn[0]);const gn=cn.length;let Cn=2,Ln=cn[0],Zn=cn[1],ui=ve?`M${Zn},${Ln}`:`M${Ln},${Zn}`;for(;Cn<gn;){switch(cn[Cn]){case"Z":return ui+"z";case"V":Zn!==cn[Cn+1]&&(ui+=(ve?"h":"v")+(cn[Cn+1]-Zn),Zn=cn[Cn+1]);break;case"H":Ln!==cn[Cn+1]&&(ui+=(ve?"v":"h")+(cn[Cn+1]-Ln),Ln=cn[Cn+1]);break;default:ui+=ve?`l${cn[Cn+1]-Zn},${cn[Cn]-Ln}`:`l${cn[Cn]-Ln},${cn[Cn+1]-Zn}`,Ln=cn[Cn],Zn=cn[Cn+1]}Cn+=2}return ui},kt=(cn,gn)=>{tt||(this.createAttMarker({attr:A,style:z(3e5)?0:5}),this.markeratt.resetPos()),tt+=ve?this.markeratt.create(gn,cn):this.markeratt.create(cn,gn)},Tt=(cn,gn)=>{Ne||(Ne=this.createAttMarker({attr:A,style:24,std:!1}),Ne.resetPos()),We+=ve?Ne.create(gn,cn):Ne.create(cn,gn)};1===A.fMarkerColor&&(A.fMarkerColor=A.fLineColor),R.candle=[];const fn=v.gStyle.fCandleWhiskerRange,ln=v.gStyle.fCandleBoxRange,mn=[fn>=1?1e-15:.5-fn/2,ln>=1?1e-14:.5-ln/2,.5,ln>=1?1-1e-14:.5+ln/2,fn>=1?1-1e-15:.5+fn/2],jt=(cn,gn,Cn,Ln,Zn)=>{const ui=((cn,gn,Cn)=>{let Ln=0,Zn=0,ui=0;const hi={max:0,first:-1,last:-1,entries:0};for(let qi=0;qi<gn.length;++qi)gn[qi]>0&&(hi.max=Math.max(hi.max,gn[qi]),hi.first<0&&(hi.first=qi),hi.last=qi),Ln+=gn[qi],ui+=gn[qi]*(cn[qi]+cn[qi+1])/2;if(Ln<=0)return null;hi.entries=Ln,hi.mean=ui/Ln,hi.quantiles=new Array(Cn.length),hi.indx=new Array(Cn.length);for(let qi=0,Mr=0,Sr=0;qi<gn.length;++qi){const ms=Sr;let fs=cn[qi];if(ms===Cn[Zn]&&0===gn[qi]&&ms<.99){for(;0===gn[qi]&&qi<gn.length;)qi++;fs=(cn[qi]+fs)/2}for(Mr+=gn[qi],Sr=Mr/Ln;Cn[Zn]>=ms&&Cn[Zn]<Sr;){if(hi.indx[Zn]=qi,hi.quantiles[Zn]=fs+(Cn[Zn]-ms)/(Sr-ms)*(cn[qi+1]-fs),Zn++===Cn.length)return hi;fs=cn[qi]}}for(;Zn<Cn.length;)hi.indx[Zn]=gn.length-1,hi.quantiles[Zn++]=cn[cn.length-1];return hi})(Fe,ht,mn);if(!ui)return;const hi={bin:cn,swapXY:ve,fBoxDown:ui.quantiles[1],fMedian:ui.quantiles[2],fBoxUp:ui.quantiles[3]},qi=hi.fBoxUp-hi.fBoxDown;let Mr=ui.quantiles[0],Sr=ui.quantiles[4];if(z(2e3)){let Zt=hi.fBoxDown-1.5*qi,dn=ui.indx[1];for(;Fe[dn]>Zt&&dn>0;)dn--;for(;!ht[dn];)dn++;for(Mr=Fe[dn],Zt=hi.fBoxUp+1.5*qi,dn=ui.indx[3];Fe[dn]<Zt&&dn<ht.length;)dn++;for(;!ht[dn];)dn--;Sr=Fe[dn+1]}const ms=ui.mean,fs=1.57*qi/Math.sqrt(ui.entries);if(Mr<=0&&(ve&&ge.logx||!ve&&ge.logy))return;const wt=Cn-gn;let W,me,_e=(gn+Cn)/2+A.fBarOffset/1e3*wt;A.fBarWidth>0&&1e3!==A.fBarWidth?W=me=wt*A.fBarWidth/1e3:(W=.66*wt,me=.8*wt),pt&&rt>0&&(me*=ui.max/rt),dt&&_t>0&&(W*=ui.entries/_t),hi.x1=Math.round(_e-W/2),hi.x2=Math.round(_e+W/2),_e=Math.round(_e);const Be=Math.round(_e-W/3),gt=Math.round(_e+W/3),Et=ve?ge.grx:ge.gry;hi.yy1=Math.round(Et(Sr)),hi.y1=Math.round(Et(hi.fBoxUp)),hi.y0=Math.round(Et(hi.fMedian)),hi.y2=Math.round(Et(hi.fBoxDown)),hi.yy2=Math.round(Et(Mr));const Mt=Math.round(Et(ms)),Nt=Math.round(Et(hi.fMedian+fs)),Qt=Math.round(Et(hi.fMedian-fs));if(z(1e7)&&($+=Yt(_e,Math.round(Et(Fe[Ln])),"V",Math.round(Et(Fe[Zn])))),z(10)?De+=Yt(hi.x1,hi.y0,"H",hi.x2):z(20)?De+=Yt(Be,hi.y0,"H",gt):z(30)&&Tt(_e,hi.y0),z(300)?Tt(_e,Mt):z(100)&&(Xe+=Yt(hi.x1,Mt,"H",hi.x2)),z(1)&&(z(20)?Se+=Yt(hi.x1,hi.y1,"V",Nt,Be,hi.y0,hi.x1,Qt,"V",hi.y2,"H",hi.x2,"V",Qt,gt,hi.y0,hi.x2,Nt,"V",hi.y1,"Z"):Se+=Yt(hi.x1,hi.y1,"V",hi.y2,"H",hi.x2,"V",hi.y1,"Z")),z(1e4)&&(De+=Yt(hi.x1,hi.yy1,"H",hi.x2)+Yt(hi.x1,hi.yy2,"H",hi.x2)),z(1e3)&&!z(1e7)?Xe+=Yt(_e,hi.y1,"V",hi.yy1)+Yt(_e,hi.y2,"V",hi.yy2):(z(1e3)&&z(1e7)||z(2e3))&&(De+=Yt(_e,hi.y1,"V",hi.yy1)+Yt(_e,hi.y2,"V",hi.yy2)),z(1e5)||z(2e5)||z(3e5)){const Zt=new xe.YF(7521*cn+Math.round(ui.integral)),dn=!z(1e5),vn=z(3e5);for(let Fn=0;Fn<ht.length;++Fn){const ai=ht[Fn],$n=(Fe[Fn]+Fe[Fn+1])/2;let kn=_e,Rn=0;if(ai&&!(!dn&&$n>=Mr&&$n<=Sr))for(let ei=0;ei<ai;ei++)vn&&(kn=_e+Math.round((Zt.random()-.5)*W)),Rn=1!==ai||vn?Math.round(Et(Fe[Fn]+Zt.random()*(Fe[Fn+1]-Fe[Fn]))):Math.round(Et($n)),kt(kn,Rn)}}if((z(2e6)||z(1e6)||z(3e6))&&ui.max>0&&ui.first>=0){const Zt=[],dn=(ve?-.5:.5)*me/ui.max;if(Ln=Math.max(Ln,ui.first),Zn=Math.min(Zn-1,ui.last),z(2e6)||z(3e6)){let vn=_e,Fn=Math.round(Et(Fe[Ln]));Zt.push(vn,Fn);for(let ai=Ln;ai<=Zn;ai++){const $n=Math.round(_e+dn*ht[ai]),kn=Math.round(Et(Fe[ai+1]));$n!==vn&&(ai!==Ln&&Zt.push("V",Fn),Zt.push("H",$n)),vn=$n,Fn=kn}Zt.push("V",Fn)}if(z(1e6)||z(3e6)){let vn=_e,Fn=Math.round(Et(Fe[Zn+1]));0===Zt.length&&Zt.push(vn,Fn);for(let ai=Zn;ai>=Ln;ai--){const $n=Math.round(_e-dn*ht[ai]),kn=Math.round(Et(Fe[ai]));$n!==vn&&(ai!==Zn&&Zt.push("V",Fn),Zt.push("H",$n)),vn=$n,Fn=kn}Zt.push("V",Fn)}Zt.push("H",_e),ct+=Yt(Zt,"array"),this.fillatt.empty()||(ct+="Z")}R.candle.push(hi)};if(ve){Fe=new Array(this.nbinsx+1),ht=new Array(this.nbinsx);for(let cn=0;cn<this.nbinsx+1;++cn)Fe[cn]=A.fXaxis.GetBinLowEdge(cn+1);if(dt)for(let cn=0;cn<this.nbinsy;++cn){let gn=0;for(let Cn=0;Cn<this.nbinsx;++Cn)gn+=A.getBinContent(Cn+1,cn+1);_t=Math.max(_t,gn)}for(let cn=R.j1;cn<R.j2;++cn){for(let gn=0;gn<this.nbinsx;++gn)ht[gn]=A.getBinContent(gn+1,cn+1);jt(cn,R.gry[cn+1],R.gry[cn],R.i1,R.i2)}}else{Fe=new Array(this.nbinsy+1),ht=new Array(this.nbinsy);for(let cn=0;cn<this.nbinsy+1;++cn)Fe[cn]=A.fYaxis.GetBinLowEdge(cn+1);if(dt)for(let cn=0;cn<this.nbinsx;++cn){let gn=0;for(let Cn=0;Cn<this.nbinsy;++Cn)gn+=A.getBinContent(cn+1,Cn+1);_t=Math.max(_t,gn)}for(let cn=R.i1;cn<R.i2;++cn){for(let gn=0;gn<this.nbinsy;++gn)ht[gn]=A.getBinContent(cn+1,gn+1);jt(cn,R.grx[cn],R.grx[cn+1],R.j1,R.j2)}}$&&A.fFillColor>0&&this.draw_g.append("svg:path").attr("d",$).style("stroke",this.getColor(A.fFillColor));const Sn=z(1e7)&&0!==A.fFillStyle?this.fillatt.color:this.lineatt.color;if(ct&&(!this.fillatt.empty()||"none"!==Sn)&&this.draw_g.append("svg:path").attr("d",ct).style("stroke","none"!==Sn?Sn:null).style("pointer-events",this.isBatchMode()?null:"visibleFill").call(this.fillatt.func),Se&&this.draw_g.append("svg:path").attr("d",Se).call(this.lineatt.func).call(this.fillatt.func),De&&this.draw_g.append("svg:path").attr("d",De).call(this.lineatt.func).style("fill","none"),Xe){const cn=this.createAttLine({attr:A,style:2,std:!1,color:Le.tA});this.draw_g.append("svg:path").attr("d",Xe).call(cn.func).style("fill","none")}return We&&this.draw_g.append("svg:path").attr("d",We).call(Ne.func),tt&&this.draw_g.append("svg:path").attr("d",tt).call(this.markeratt.func),R}drawBinsScatter(){const L=this.getObject(),he=this.prepareDraw({rounding:!0,pixel_density:!0}),re=this.options.cutg,fe=[],de=[],pe=[],ce=[],K=[],G=this.options.ScatCoef*(this.gmaxbin>2e3?2e3/this.gmaxbin:1),D=new xe.YF(he.sumz);let x,P,w,b,g,C,N,O,H=1;if(he.ScatterPlot=!0,G*he.sumz<1e5){this.createAttMarker({attr:L}),this.markeratt.resetPos();let I="";for(b=he.i1;b<he.i2;++b)for(N=he.grx[b+1]-he.grx[b],g=he.j1;g<he.j2;++g){O=he.gry[g]-he.gry[g+1],C=L.getBinContent(b+1,g+1);const A=Math.round(G*C);if(!(A<=0)&&(!re||re.IsInside(L.fXaxis.GetBinCoord(b+.5),L.fYaxis.GetBinCoord(g+.5))))for(let R=0;R<A;++R)I+=this.markeratt.create(Math.round(he.grx[b]+N*D.random()),Math.round(he.gry[g+1]+O*D.random()))}return this.draw_g.append("svg:path").attr("d",I).call(this.markeratt.func),he}this.maxbin>.7&&(H=.7/this.maxbin);const X=Math.round(he.max-he.min),ie=this.createContour(X>50?50:X,this.minposbin,this.maxbin,this.minposbin);for(b=he.i1;b<he.i2;++b)for(g=he.j1;g<he.j2;++g)C=L.getBinContent(b+1,g+1),!(C<=0||C<this.minbin)&&(N=he.grx[b+1]-he.grx[b],O=he.gry[g]-he.gry[g+1],!(N*O<=0)&&(x=ie.getContourIndex(C/N/O),!(x<0)&&(re&&!re.IsInside(L.fXaxis.GetBinCoord(b+.5),L.fYaxis.GetBinCoord(g+.5))||(P=`M${he.grx[b]},${he.gry[g+1]}`,void 0===fe[x]?(fe[x]=P,ce[x]=N,K[x]=O):(w=`m${he.grx[b]-de[x]},${he.gry[g+1]-pe[x]}`,fe[x]+=w.length<P.length?w:P,ce[x]=Math.max(ce[x],N),K[x]=Math.max(K[x],O)),de[x]=he.grx[b],pe[x]=he.gry[g+1],fe[x]+=`v${O}h${N}v${-O}z`))));const z=this.getFrameSvg().selectChild(".main_layer");let m=z.selectChild("defs");for(m.empty()&&fe.length>0&&(m=z.insert("svg:defs",":first-child")),this.createAttMarker({attr:L}),x=0;x<fe.length;++x)if(void 0!==fe[x]&&x<ie.arr.length){const I=(this.pad_name||"canv")+`_scatter_${x}`;let A=m.selectChild(`#${I}`);A.empty()?A=m.append("svg:pattern").attr("id",I).attr("patternUnits","userSpaceOnUse"):A.selectAll("*").remove();let R=Math.round(H*ie.arr[x]*ce[x]*K[x]);R<1&&(R=1);const k=new Float32Array(R),ee=new Float32Array(R);if(1===R)k[0]=ee[0]=.5;else for(let ve=0;ve<R;++ve)k[ve]=D.random(),ee[ve]=D.random();this.markeratt.resetPos();let ge="";for(let ve=0;ve<R;++ve)ge+=this.markeratt.create(k[ve]*ce[x],ee[ve]*K[x]);A.attr("width",ce[x]).attr("height",K[x]).append("svg:path").attr("d",ge).call(this.markeratt.func),this.draw_g.append("svg:path").attr("scatter-index",x).style("fill",`url(#${I})`).attr("d",fe[x])}return he}draw2DBins(){if(this._hide_frame&&this.isMainPainter()&&(this.getFrameSvg().style("display",null),delete this._hide_frame),!this.draw_content)return this.removeG();let L,he;if(this.createHistDrawAttributes(),this.createG(!0),this.isTH2Poly()?he=this.drawPolyBins():(this.options.Scat&&(L=this.drawBinsScatter()),this.options.Color?L=this.drawBinsColor():this.options.Box?L=this.drawBinsBox():this.options.Arrow?L=this.drawBinsArrow():this.options.Proj?L=this.drawBinsProjected():this.options.Contour?L=this.drawBinsContour():(this.options.Candle||this.options.Violin)&&(L=this.drawBinsCandle()),this.options.Text&&(he=this.drawBinsText(L)),!L&&!he&&(L=this.drawBinsColor())),L)this.tt_handle=L;else if(he)return he.then(re=>{this.tt_handle=re})}drawBinsCircular(){this.getFrameSvg().style("display","none"),this._hide_frame=!0;const L=this.getPadPainter().getFrameRect(),he=this.getHisto(),re=this.options.Circular>10?this.getHistPalette():null,pe=he.fXaxis,ce=w=>{if(pe.fLabels)for(let b=0;b<pe.fLabels.arr.length;++b){const g=pe.fLabels.arr[b];if(g.fUniqueID===w+1)return g.fString}return w.toString()};this.createG(),(0,xe.bk)(this.draw_g,Math.round(L.x+L.width/2),Math.round(L.y+L.height/2));const K=Math.min(this.nbinsx,this.nbinsy);this.startTextDrawing(42,20,this.draw_g);const G=[];for(let w=0;w<K;w++){const b=(.5-w/K)*Math.PI*2,g=Math.round((.9*L.width/2-32)*Math.cos(b)),C=Math.round((.9*L.height/2-32)*Math.sin(b)),N=Math.round(.9*L.width/2*Math.cos(b)),O=Math.round(.9*L.height/2*Math.sin(b)),H=re?.calcColor(w,K)??"black";let X=Math.round(b/Math.PI*180),ie=12;G.push({x:g,y:C,a:b,color:H}),(X<-90||X>90)&&(X+=180,ie=32);const z=Math.round(10),m=2*z;this.draw_g.append("path").attr("d",`M${g-z},${C} a${z},${z},0,1,0,${m},0a${z},${z},0,1,0,${-m},0z`).style("stroke",H).style("fill","none"),this.drawText({align:ie,rotate:X,x:N,y:O,text:ce(w)})}let x=0,P=0;if(this.options.Circular>11)for(let w=0;w<K-1;++w)for(let b=w+1;b<K;++b){const g=he.getBinContent(w+1,b+1);g>0&&(x=Math.max(x,g),(!P||g<P)&&(P=g))}for(let w=0;w<K-1;++w){const b=G[w];let g="";for(let C=w+1;C<K;++C){const N=he.getBinContent(w+1,C+1);if(N<=0)continue;const O=G[C],H=(b.a+O.a)/2,X=.5*(1-Math.abs(b.a-O.a)/Math.PI),ie=Math.round(X*L.width/2*Math.cos(H)),z=Math.round(X*L.height/2*Math.sin(H));if(g+=`M${b.x},${b.y}Q${ie},${z},${O.x},${O.y}`,this.options.Circular>11&&x>P){const m=Math.round((N-P)/(x-P)*7+1);this.draw_g.append("path").attr("d",g).style("stroke",b.color).style("stroke-width",m).style("fill","none"),g=""}}g&&this.draw_g.append("path").attr("d",g).style("stroke",b.color).style("fill","none")}return this.finishTextDrawing()}drawBinsChord(){var L=this;return(0,be.A)(function*(){L.getFrameSvg().style("display","none"),L._hide_frame=!0;const he=[],re=Math.min(L.nbinsx,L.nbinsy),fe=L.getHisto();let de=0,pe=!0;for(let R=0;R<re;++R){let k=0;for(let ee=0;ee<re;++ee){const ge=fe.getBinContent(R+1,ee+1);ge>0&&(k+=ge,pe&&Math.round(ge)!==ge&&(pe=!1))}k>0&&he.push(R),de+=k}if(he.length<2)return!0;let ce=0,K=1;const G=L.getPadPainter().getFrameRect(),D=L.getHistPalette(),x=Math.max(10,.5*Math.min(G.width,G.height)-60),P=Math.max(2,x-10),w=[],b=[],g=R=>D.calcColor(R,he.length),C=R=>R.toString(),O=(R,k)=>k<R?-1:k>R?1:k>=R?0:Number.NaN;if(!pe&&de<10){const R=Math.round(Math.log10(de)-2.3);ce=-R,K=Math.pow(10,R)}else if(de>200){const R=Math.round(Math.log10(de)-2.3);K=Math.pow(10,R)}250*K<de?K*=5:100*K<de&&(K*=2);for(let R=0;R<he.length;++R){w[R]=[];for(let ge=0;ge<he.length;++ge)w[R].push(fe.getBinContent(he[R]+1,he[ge]+1));const k=fe.fXaxis;let ee="indx_"+he[R].toString();if(k.fLabels)for(let ge=0;ge<k.fLabels.arr.length;++ge){const ve=k.fLabels.arr[ge];if(ve.fUniqueID===he[R]+1){ee=ve.fString;break}}b.push(ee)}L.createG(),(0,xe.bk)(L.draw_g,Math.round(G.x+G.width/2),Math.round(G.y+G.height/2));const X=(0,V.JQ)().padAngle(10/P).sortSubgroups(O).sortChords(O)(w),ie=L.draw_g.append("g").attr("font-size",10).attr("font-family","sans-serif").selectAll("g").data(X.groups).join("g"),z=(0,V.JL)().innerRadius(P).outerRadius(x),m=(0,V.F6)().radius(P-1).padAngle(1/P);ie.append("path").attr("fill",R=>g(R.index)).attr("d",z),ie.append("title").text(R=>`${b[R.index]} ${C(R.value)}`);const A=ie.append("g").selectAll("g").data(function I({startAngle:R,endAngle:k,value:ee}){const ge=(k-R)/ee,ve=[];for(let Se=0;Se<=ee;Se+=K)ve.push({value:Se,angle:Se*ge+R});return ve}).join("g").attr("transform",R=>`rotate(${Math.round(180*R.angle/Math.PI-90)}) translate(${x})`);return A.append("line").attr("stroke","currentColor").attr("x2",6),A.append("text").attr("x",8).attr("dy","0.35em").attr("transform",R=>R.angle>Math.PI?"rotate(180) translate(-16)":null).attr("text-anchor",R=>R.angle>Math.PI?"end":null).text(R=>(R=>ce>3?R.toExponential(0):R.toFixed(ce))(R.value)),ie.select("text").attr("font-weight","bold").text(function(R){return"end"===this.getAttribute("text-anchor")?`\u2191 ${b[R.index]}`:`${b[R.index]} \u2193`}),L.draw_g.append("g").attr("fill-opacity",.8).selectAll("path").data(X).join("path").style("mix-blend-mode","multiply").attr("fill",R=>g(R.source.index)).attr("d",m).append("title").text(R=>`${C(R.source.value)} ${b[R.target.index]} \u2192 ${b[R.source.index]}${R.source.index===R.target.index?"":`\n${C(R.target.value)} ${b[R.source.index]} \u2192 ${b[R.target.index]}`}`),!0})()}getBinTooltips(L,he){const re=this.getHisto();let fe=re.getBinContent(L+1,he+1);re.$baseh&&(fe-=re.$baseh.getBinContent(L+1,he+1));const de=[this.getObjectHint(),"x = "+this.getAxisBinTip("x",re.fXaxis,L),"y = "+this.getAxisBinTip("y",re.fYaxis,he),`bin = ${re.getBin(L+1,he+1)}  x: ${L+1}  y: ${he+1}`,"entries = "+(fe===Math.round(fe)?fe:(0,xe.lg)(fe,v.gStyle.fStatFormat))];if("E"===this.options.TextKind||this.matchObjectType(v.clTProfile2D)){const pe=re.getBinError(re.getBin(L+1,he+1));de.push("error = "+(pe===Math.round(pe)?pe.toString():(0,xe.lg)(pe,v.gStyle.fPaintTextFormat)))}return de}getCandleTooltips(L){const re=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),fe=this.getHisto();return[this.getObjectHint(),L.swapXY?"y = "+re.axisAsText("y",fe.fYaxis.GetBinLowEdge(L.bin+1)):"x = "+re.axisAsText("x",fe.fXaxis.GetBinLowEdge(L.bin+1)),"m-25%  = "+(0,xe.lg)(L.fBoxDown,v.gStyle.fStatFormat),"median = "+(0,xe.lg)(L.fMedian,v.gStyle.fStatFormat),"m+25%  = "+(0,xe.lg)(L.fBoxUp,v.gStyle.fStatFormat)]}getPolyBinTooltips(L,he,re){const de=this.getHisto().fBins.arr[L],ce=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),K=[];let G=de.fPoly.fName,D=0;if("Graph"===G&&(G=""),0===G.length&&(G=de.fNumber),void 0===he&&void 0===re){he=re=0;let x=de.fPoly,P=1;x._typename===v.clTMultiGraph&&(P=de.fPoly.fGraphs.arr.length,x=null);for(let w=0;w<P;++w){(!x||w>0)&&(x=de.fPoly.fGraphs.arr[w]);for(let b=0;b<x.fNpoints;++b)++D,he+=x.fX[b],re+=x.fY[b]}D>1&&(he/=D,re/=D)}return K.push(this.getObjectHint(),"x = "+ce.axisAsText("x",he),"y = "+ce.axisAsText("y",re)),D>0&&K.push("npnts = "+D),K.push(`bin = ${G}`),de.fContent===Math.round(de.fContent)?K.push("content = "+de.fContent):K.push("content = "+(0,xe.lg)(de.fContent,v.gStyle.fStatFormat)),K}processTooltipEvent(L){const he=this.getHisto(),re=this.tt_handle;let fe=this.draw_g?.selectChild(".tooltip_bin");if(!L||!this.draw_content||!this.draw_g||!re||this.options.Proj)return fe?.remove(),null;if(re.poly){const X=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),ie=X.revertAxis("x",L.x),z=X.revertAxis("y",L.y);let I,m=-1;if(void 0!==ie&&void 0!==z){const R=he.fBins.arr.length;for(let k=0;k<R&&m<0;++k){if(I=he.fBins.arr[k],ie<I.fXmin||ie>I.fXmax||z<I.fYmin||z>I.fYmax||!I.fContent&&!this.options.Zero)continue;let ee=I.fPoly,ge=1;ee._typename===v.clTMultiGraph&&(ge=I.fPoly.fGraphs.arr.length,ee=null);for(let ve=0;ve<ge;++ve)if((!ee||ve>0)&&(ee=I.fPoly.fGraphs.arr[ve]),ee.IsInside(ie,z)){m=k;break}}}if(m<0)return fe.remove(),null;const A={name:he.fName,title:he.fTitle,x:L.x,y:L.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",exact:!0,menu:!0,lines:this.getPolyBinTooltips(m,ie,z)};return L.disabled?(fe.remove(),A.changed=!0):(fe.empty()&&(fe=this.draw_g.append("svg:path").attr("class","tooltip_bin").style("pointer-events","none").call(xe.Ru)),A.changed=fe.property("current_bin")!==m,A.changed&&fe.attr("d",this.createPolyBin(X,I)).style("opacity","0.7").property("current_bin",m)),A.changed&&(A.user_info={obj:he,name:he.fName,bin:m,cont:I.fContent,grx:L.x,gry:L.y}),A}if(re.candle){let H,X,ie;for(H=0;H<re.candle.length&&(X=re.candle[H],ie=X.swapXY?X.x1<=L.y&&L.y<=X.x2&&X.yy1>=L.x&&L.x>=X.yy2:X.x1<=L.x&&L.x<=X.x2&&X.yy1<=L.y&&L.y<=X.yy2,!ie);++H);if(!ie)return fe.remove(),null;const z={name:he.fName,title:he.fTitle,x:L.x,y:L.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getCandleTooltips(X),exact:!0,menu:!0};return L.disabled?(fe.remove(),z.changed=!0):(fe.empty()&&(fe=this.draw_g.append("svg:path").attr("class","tooltip_bin").style("pointer-events","none").call(xe.Ru).style("opacity","0.7")),z.changed=fe.property("current_bin")!==H,z.changed&&fe.attr("d",X.swapXY?`M${X.yy1},${X.x1}H${X.yy2}V${X.x2}H${X.yy1}Z`:`M${X.x1},${X.yy1}H${X.x2}V${X.yy2}H${X.x1}Z`).property("current_bin",H)),z.changed&&(z.user_info={obj:he,name:he.fName,bin:H+1,cont:X.fMedian,binx:H+1,biny:1,grx:L.x,gry:L.y}),z}const de=this.getFramePainter();let pe,ce,D,x,P,w,b,g,C,N,K=0,G=null;if(de.reverse_x)for(pe=re.i1;pe<re.i2&&!(L.x<=re.grx[pe]&&L.x>=re.grx[pe+1]);++pe);else for(pe=re.i1;pe<re.i2&&!(L.x>=re.grx[pe]&&L.x<=re.grx[pe+1]);++pe);if(de.reverse_y)for(ce=re.j1;ce<re.j2&&!(L.y<=re.gry[ce+1]&&L.y>=re.gry[ce]);++ce);else for(ce=re.j1;ce<re.j2&&!(L.y>=re.gry[ce+1]&&L.y<=re.gry[ce]);++ce);if(pe<re.i2&&ce<re.j2){D=pe,x=pe+1,P=ce,w=ce+1,b=re.grx[D],g=re.grx[x],C=re.gry[w],N=re.gry[P];let H=!0;if(this.options.Color){const X=g-b,ie=N-C;g=Math.round(b+X*re.xbar2),b=Math.round(b+X*re.xbar1),N=Math.round(C+ie*re.ybar2),C=Math.round(C+ie*re.ybar1),de.reverse_x?(L.x>b||L.x<=g)&&(H=!1):(L.x<b||L.x>=g)&&(H=!1),de.reverse_y?(L.y>C||L.y<=N)&&(H=!1):(L.y<C||L.y>=N)&&(H=!1)}K=he.getBinContent(pe+1,ce+1),this.is_projection?G=0:H?re.hide_only_zeros?G=0!==K||this._show_empty_bins?0:null:(G=this.getContour().getPaletteIndex(this.getHistPalette(),K),null===G&&0===K&&this._show_empty_bins&&(G=0)):G=null}if(null===G)return fe.remove(),null;const O={name:he.fName,title:he.fTitle,x:L.x,y:L.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getBinTooltips(pe,ce),exact:!0,menu:!0};if(this.options.Color&&(O.color2=this.getHistPalette().getColor(G)),L.disabled&&!this.is_projection)fe.remove(),O.changed=!0;else{fe.empty()&&(fe=this.draw_g.append("svg:path").attr("class","tooltip_bin").style("pointer-events","none").call(xe.Ru));let X,H=1e4*pe+ce;if(this.is_projection){const ie=this.projection_widthX||1,z=(ie-1)/2;this.is_projection.indexOf("X")>=0&&ie>1&&(w+z>=re.j2?(w=Math.min(Math.round(w+z),re.j2),P=Math.max(w-ie,re.j1)):(P=Math.max(Math.round(P-z),re.j1),w=Math.min(P+ie,re.j2)));const m=this.projection_widthY||1,I=(m-1)/2;this.is_projection.indexOf("Y")>=0&&m>1&&(x+I>=re.i2?(x=Math.min(Math.round(x+I),re.i2),D=Math.max(x-m,re.i1)):(D=Math.max(Math.round(D-I),re.i1),x=Math.min(D+m,re.i2)))}"X"===this.is_projection?(b=0,g=de.getFrameWidth(),C=re.gry[w],N=re.gry[P],H=777*P+333*w):"Y"===this.is_projection?(C=0,N=de.getFrameHeight(),b=re.grx[D],g=re.grx[x],H=777*D+333*x):"XY"===this.is_projection&&(C=re.gry[w],N=re.gry[P],b=re.grx[D],g=re.grx[x],H=789*D+653*x+12345*P+654321*w,X=`M${b},0H${g}V${C}H${de.getFrameWidth()}V${N}H${g}V${de.getFrameHeight()}H${b}V${N}H0V${C}H${b}Z`),O.changed=fe.property("current_bin")!==H,O.changed&&fe.attr("d",X||`M${b},${C}H${g}V${N}H${b}Z`).style("opacity","0.7").property("current_bin",H),this.is_projection&&O.changed&&this.redrawProjection(D,x,P,w)}return O.changed&&(O.user_info={obj:he,name:he.fName,bin:he.getBin(pe+1,ce+1),cont:K,binx:pe+1,biny:ce+1,grx:L.x,gry:L.y}),O}canZoomInside(L,he,re){if("z"===L||this.options.Proj)return!0;let fe=this.getHisto();return fe&&(fe="y"===L?fe.fYaxis:fe.fXaxis),!fe||fe.FindBin(re,.5)-fe.FindBin(he,0)>1}completePalette(L){return!L||(L.$main_painter=this,this.options.Zvert=L._palette_vertical,L.drawPave(this.options.Cjust?"cjust":""))}draw2D(){var L=this;return(0,be.A)(function*(){L.clear3DScene();const he=L.options.Zscale&&L.options.canHavePalette();return L.drawColorPalette(he,!0).then(function(){var re=(0,be.A)(function*(fe){let de;return de=L.options.Circular&&L.isMainPainter()?L.drawBinsCircular():L.options.Chord&&L.isMainPainter()?L.drawBinsChord():L.drawAxes().then(()=>L.draw2DBins()),de.then(()=>L.completePalette(fe))});return function(fe){return re.apply(this,arguments)}}()).then(()=>L.updateFunctions()).then(()=>L.updateHistTitle()).then(()=>(L.updateStatWebCanvas(),L.addInteractivity()))})()}draw3D(L){var he=this;return(0,be.A)(function*(){return console.log("3D drawing is disabled, load ./hist/TH2Painter.mjs"),he.draw2D(L)})()}callDrawFunc(L){var he=this;return(0,be.A)(function*(){const re=he.getMainPainter(),fe=he.getFramePainter();return re!==he&&fe&&fe.mode3d!==he.options.Mode3D&&he.copyOptionsFrom(re),he.options.Mode3D?he.draw3D(L):he.draw2D(L)})()}redraw(L){var he=this;return(0,be.A)(function*(){return he.callDrawFunc(L)})()}static draw(L,he,re){return(0,be.A)(function*(){return st.mf._drawHist(new Qe(L,he),re)})()}}},2105:(Gr,xt,Te)=>{"use strict";Te.d(xt,{Ee:()=>ot,Z8:()=>he,ZE:()=>Qe,eP:()=>re,ef:()=>Re,kH:()=>Ie,m:()=>Ke,mf:()=>ce});var be=Te(5774),v=Te(4186),V=Te(139),Le=Te(165),xe=Te(2481),Je=Te(6673),st=Te(2725);const Ke=1,ot=2,Re=3,Qe=4,Ie=5;class L{constructor(){this.reset()}reset(){Object.assign(this,{Axis:0,RevX:!1,RevY:!1,SymlogX:0,SymlogY:0,Bar:!1,BarStyle:0,Curve:!1,Hist:1,Line:!1,Fill:!1,Error:0,ErrorKind:-1,errorX:v.gStyle.fErrorX,Mark:!1,Same:!1,Scat:!1,ScatCoef:1,Func:!0,AllFunc:!1,Arrow:!1,Box:!1,BoxStyle:0,Text:!1,TextAngle:0,TextKind:"",Char:0,Color:!1,Contour:0,Cjust:!1,Lego:0,Surf:0,Off:0,Tri:0,Proj:0,AxisPos:0,Ortho:v.gStyle.fOrthoCamera,Spec:!1,Pie:!1,List:!1,Zscale:!1,Zvert:!0,PadPalette:!1,Candle:"",Violin:"",Scaled:null,Circular:0,GLBox:0,GLColor:!1,Project:"",System:Ke,AutoColor:!1,NoStat:!1,ForceStat:!1,PadStats:!1,PadTitle:!1,AutoZoom:!1,HighRes:0,Zero:1,Palette:0,BaseLine:!1,Optimize:v.settings.OptimizeDraw,adjustFrame:!1,Mode3D:!1,x3dscale:1,y3dscale:1,Render3D:v.constants.Render3D.Default,FrontBox:!0,BackBox:!0,need_fillcol:!1,minimum:v.kNoZoom,maximum:v.kNoZoom,ymin:0,ymax:0,cutg:null,IgnoreMainScale:!1,IgnorePalette:!1})}isCartesian(){return this.System===Ke}is3d(){return this.Lego||this.Surf}decodeSumw2(G,D){const x=G.fSumw2?.length??0;let P=!1;for(let w=0;w<x;++w)if(G.fSumw2[w]>0){P=!0;break}(Number.isInteger(this.Error)||D)&&(this.Error=P?1:0),(Number.isInteger(this.Hist)||D)&&(this.Hist=P?0:1),(Number.isInteger(this.Zero)||D)&&(this.Zero=P?0:1)}canHavePalette(){return 2===this.ndim&&(this.Mode3D?12===this.Lego||14===this.Lego||11===this.Surf||12===this.Surf:!!(this.Color||this.Contour||this.Hist||this.Axis)||!(this.Scat||this.Box||this.Arrow||this.Proj||this.Candle||this.Violin||this.Text))}decode(G,D,x,P,w,b){if(this.orginal=G,this.cutg_name="",(0,v.isStr)(G)&&2===D){const ie=G.lastIndexOf("["),z=G.lastIndexOf("]");ie>=0&&z>ie+1&&(this.cutg_name=G.slice(ie+1,z),G=G.slice(0,ie)+G.slice(z+1),this.cutg=P?.findInPrimitives(this.cutg_name,v.clTCutG),this.cutg&&(this.cutg.$redraw_pad=!0))}const g=new Le.nC(G);1===D&&this.decodeSumw2(x,!0),this.ndim=D||1,g.check("USE_PAD_TITLE"),g.check("USE_PAD_PALETTE"),g.check("USE_PAD_STATS"),g.check("IGNORE_PALETTE")&&(this.IgnorePalette=!0),g.check("PAL",!0)&&(this.Palette=g.partAsInt()),g.check("MINIMUM:",!0)?(this.ominimum=!0,this.minimum=parseFloat(g.part)):(this.ominimum=!1,this.minimum=x.fMinimum),g.check("MAXIMUM:",!0)?(this.omaximum=!0,this.maximum=parseFloat(g.part)):(this.omaximum=!1,this.maximum=x.fMaximum),g.check("HMIN:",!0)?(this.ohmin=!0,this.hmin=parseFloat(g.part)):(this.ohmin=!1,delete this.hmin),g.check("HMAX:",!0)?(this.ohmax=!0,this.hmax=parseFloat(g.part)):(this.ohmax=!1,delete this.hmax),this.ignore_min_max=g.check("IGNORE_MIN_MAX"),g.check("HTITLE:",!0)&&(x.fTitle=decodeURIComponent(g.part.toLowerCase())),g.check("XTITLE:",!0)&&(x.fXaxis.fTitle=decodeURIComponent(g.part.toLowerCase())),g.check("YTITLE:",!0)&&(x.fYaxis.fTitle=decodeURIComponent(g.part.toLowerCase())),g.check("ZTITLE:",!0)&&(x.fZaxis.fTitle=decodeURIComponent(g.part.toLowerCase())),g.check("_ADJUST_FRAME_")&&(this.adjustFrame=!0),g.check("NOOPTIMIZE")&&(this.Optimize=0),g.check("OPTIMIZE")&&(this.Optimize=2),g.check("AUTOCOL")&&(this.AutoColor=!0),g.check("AUTOZOOM")&&(this.AutoZoom=!0),g.check("OPTSTAT",!0)&&(this.optstat=g.partAsInt()),g.check("OPTFIT",!0)&&(this.optfit=g.partAsInt()),(this.optstat||this.optstat)&&x?.TestBit(v.kNoStats)&&x?.InvertBit(v.kNoStats),g.check("NOSTAT")&&(this.NoStat=!0),g.check("STAT")&&(this.ForceStat=!0),g.check("NOTOOLTIP")&&b&&b.setTooltipAllowed(!1),g.check("TOOLTIP")&&b&&b.setTooltipAllowed(!0),g.check("SYMLOGX",!0)&&(this.SymlogX=g.partAsInt(0,3)),g.check("SYMLOGY",!0)&&(this.SymlogY=g.partAsInt(0,3)),g.check("X3DSC",!0)&&(this.x3dscale=g.partAsInt(0,100)/100),g.check("Y3DSC",!0)&&(this.y3dscale=g.partAsInt(0,100)/100),(g.check("PERSPECTIVE")||g.check("PERSP"))&&(this.Ortho=!1),g.check("ORTHO")&&(this.Ortho=!0);let C=0,N=0,O="";g.check("LOG2XY")&&(C=N=2),g.check("LOGXY")&&(C=N=1),g.check("LOG2X")&&(C=2),g.check("LOGX")&&(C=1),g.check("LOG2Y")&&(N=2),g.check("LOGY")&&(N=1),C&&w&&(w.fLogx=C,w.fUxmin=0,w.fUxmax=1,w.fX1=0,w.fX2=1),N&&w&&(w.fLogy=N,w.fUymin=0,w.fUymax=1,w.fY1=0,w.fY2=1),g.check("LOG2Z")&&w&&(w.fLogz=2),g.check("LOGZ")&&w&&(w.fLogz=1),g.check("LOGV")&&w&&(w.fLogv=1),g.check("GRIDXY")&&w&&(w.fGridx=w.fGridy=1),g.check("GRIDX")&&w&&(w.fGridx=1),g.check("GRIDY")&&w&&(w.fGridy=1),g.check("TICKXY")&&w&&(w.fTickx=w.fTicky=1),g.check("TICKX")&&w&&(w.fTickx=1),g.check("TICKY")&&w&&(w.fTicky=1),g.check("TICKZ")&&w&&(w.fTickz=1),g.check("GRAYSCALE")&&P?.setGrayscale(!0),g.check("FILL_","color")&&(this.histoFillColor=g.color,this.histoFillPattern=1001),g.check("LINE_","color")&&(this.histoLineColor=(0,V.oU)(g.color)),g.check("XAXIS_","color")&&(x.fXaxis.fAxisColor=x.fXaxis.fLabelColor=x.fXaxis.fTitleColor=g.color),g.check("YAXIS_","color")&&(x.fYaxis.fAxisColor=x.fYaxis.fLabelColor=x.fYaxis.fTitleColor=g.color);const H=!!b&&!!b.getMainPainter();g.check("X+")&&(this.AxisPos=10,this.second_x=H),g.check("Y+")&&(this.AxisPos+=1,this.second_y=H),g.check("SAME0")&&(this.Same=!0,this.IgnoreMainScale=!0),g.check("SAMES")&&(this.Same=!0,this.ForceStat=!0),g.check("SAME")&&(this.Same=!0,this.Func=!0),g.check("SPEC")&&(this.Spec=!0),(g.check("BASE0")||g.check("MIN0")||v.gStyle.fHistMinimumZero)&&(this.BaseLine=0),g.check("PIE")&&(this.Pie=!0),g.check("CANDLE",!0)&&(this.Candle=g.part||"1"),g.check("VIOLIN",!0)&&(this.Violin=g.part||"1",delete this.Candle),g.check("NOSCALED")&&(this.Scaled=!1),g.check("SCALED")&&(this.Scaled=!0),g.check("GLBOX",!0)&&(this.GLBox=10+g.partAsInt()),g.check("GLCOL")&&(this.GLColor=!0),g.check("GL"),(g.check("CIRCULAR",!0)||g.check("CIRC",!0))&&(this.Circular=11,g.part.indexOf("0")>=0&&(this.Circular=10),g.part.indexOf("1")>=0&&(this.Circular=11),g.part.indexOf("2")>=0&&(this.Circular=12)),this.Chord=g.check("CHORD"),g.check("LEGO",!0)&&(this.Lego=1,g.part.indexOf("0")>=0&&(this.Zero=!1),g.part.indexOf("1")>=0&&(this.Lego=11),g.part.indexOf("2")>=0&&(this.Lego=12),g.part.indexOf("3")>=0&&(this.Lego=13),g.part.indexOf("4")>=0&&(this.Lego=14),O=g.part,g.part.indexOf("Z")>=0&&(this.Zscale=!0),g.part.indexOf("H")>=0&&(this.Zvert=!1)),g.check("R3D_",!0)&&(this.Render3D=v.constants.Render3D.fromString(g.part.toLowerCase())),g.check("POL")&&(this.System=ot),g.check("CYL")&&(this.System=Re),g.check("SPH")&&(this.System=Qe),g.check("PSR")&&(this.System=Ie),g.check("SURF",!0)&&(this.Surf=g.partAsInt(10,1),O=g.part,g.part.indexOf("Z")>=0&&(this.Zscale=!0),g.part.indexOf("H")>=0&&(this.Zvert=!1)),g.check("TF3",!0)&&(O=g.part),g.check("ISO",!0)&&(O=g.part),g.check("LIST")&&(this.List=!0),g.check("CONT",!0)&&D>1&&(this.Contour=1,g.part.indexOf("Z")>=0&&(this.Zscale=!0),g.part.indexOf("H")>=0&&(this.Zvert=!1),g.part.indexOf("1")>=0?this.Contour=11:g.part.indexOf("2")>=0?this.Contour=12:g.part.indexOf("3")>=0?this.Contour=13:g.part.indexOf("4")>=0&&(this.Contour=14)),g.check("HBAR",!0)?this.BarStyle=20:g.check("BAR",!0)&&(this.BarStyle=10),this.BarStyle>0&&(this.Hist=!1,this.need_fillcol=!0,this.BarStyle+=g.partAsInt()),g.check("ARR")&&(this.Arrow=!0),g.check("BOX",!0)&&(this.BoxStyle=10,g.part.indexOf("1")>=0?this.BoxStyle=11:g.part.indexOf("2")>=0?this.BoxStyle=12:g.part.indexOf("3")>=0&&(this.BoxStyle=13),g.part.indexOf("Z")>=0&&(this.Zscale=!0),g.part.indexOf("H")>=0&&(this.Zvert=!1)),this.Box=this.BoxStyle>0,g.check("CJUST")&&(this.Cjust=!0),g.check("COL")&&(this.Color=!0),g.check("CHAR")&&(this.Char=1),g.check("ALLFUNC")&&(this.AllFunc=!0),g.check("FUNC")&&(this.Func=!0,this.Hist=!1),g.check("AXIS")&&(this.Axis=1),g.check("AXIG")&&(this.Axis=2),g.check("TEXT",!0)&&(this.Text=!0,this.Hist=!1,this.TextAngle=Math.min(g.partAsInt(),90),g.part.indexOf("N")>=0&&(this.TextKind="N"),g.part.indexOf("E0")>=0&&(this.TextLine=!0),g.part.indexOf("E")>=0&&(this.TextKind="E")),g.check("SCAT=",!0)&&(this.Scat=!0,this.ScatCoef=parseFloat(g.part),(!Number.isFinite(this.ScatCoef)||this.ScatCoef<=0)&&(this.ScatCoef=1)),g.check("SCAT")&&(this.Scat=!0),g.check("TRI",!0)&&(this.Color=!1,this.Tri=1,O=g.part,g.part.indexOf("ERR")>=0&&(this.Error=!0)),g.check("AITOFF")&&(this.Proj=1),g.check("MERCATOR")&&(this.Proj=2),g.check("SINUSOIDAL")&&(this.Proj=3),g.check("PARABOLIC")&&(this.Proj=4),g.check("MOLLWEIDE")&&(this.Proj=5),this.Proj>0&&(this.Contour=14),g.check("PROJXY",!0)&&(this.Project="XY"+g.partAsInt(0,1)),g.check("PROJX",!0)&&(this.Project="X"+g.part),g.check("PROJY",!0)&&(this.Project="Y"+g.part),g.check("PROJ")&&(this.Project="Y1"),O&&(O.indexOf("FB")>=0&&(this.FrontBox=!1),O.indexOf("BB")>=0&&(this.BackBox=!1)),3===D&&g.check("FB")&&(this.FrontBox=!1),3===D&&g.check("BB")&&(this.BackBox=!1),g.check("PFC")&&!this._pfc&&(this._pfc=2),(g.check("PLC")||this.AutoColor)&&!this._plc&&(this._plc=2),g.check("PMC")&&!this._pmc&&(this._pmc=2);const X=(ie,z,m)=>{if("fZaxis"===z&&D<3&&!this.Lego&&!this.Surf)return;let I=g.check(ie);w&&w["$"+ie]&&(I=!0,w["$"+ie]=void 0),I&&x&&(x[z].TestBit(m)||x[z].InvertBit(m))};if(X("OTX","fXaxis",xe.rb.kOppositeTitle),X("OTY","fYaxis",xe.rb.kOppositeTitle),X("OTZ","fZaxis",xe.rb.kOppositeTitle),X("CTX","fXaxis",xe.rb.kCenterTitle),X("CTY","fYaxis",xe.rb.kCenterTitle),X("CTZ","fZaxis",xe.rb.kCenterTitle),X("MLX","fXaxis",xe.rb.kMoreLogLabels),X("MLY","fYaxis",xe.rb.kMoreLogLabels),X("MLZ","fZaxis",xe.rb.kMoreLogLabels),(g.check("RX")||w?.$RX)&&(this.RevX=!0),(g.check("RY")||w?.$RY)&&(this.RevY=!0),g.check("L")&&(this.Line=!0,this.Hist=!1),g.check("F")&&(this.Fill=!0,this.need_fillcol=!0),g.check("A")&&(this.Axis=-1),"up"===w?.$ratio_pad)this.Same||(this.Axis=0),x.fXaxis.fLabelSize=0,x.fXaxis.fTitle="",x.fYaxis.$use_top_pad=!0;else if("low"===w?.$ratio_pad){this.Same||(this.Axis=0),x.fXaxis.$use_top_pad=!0,x.fYaxis.$use_top_pad=!0,x.fXaxis.fTitle="x";const ie=b?.getCanvPainter().findPainterFor(null,"upper_pad",v.clTPad)?.getFramePainter();ie&&(b.zoom_xmin=ie.scale_xmin,b.zoom_xmax=ie.scale_xmax)}g.check("B1")&&(this.BarStyle=1,this.BaseLine=0,this.Hist=!1,this.need_fillcol=!0),g.check("B")&&(this.BarStyle=1,this.Hist=!1,this.need_fillcol=!0),g.check("C")&&(this.Curve=!0,this.Hist=!1),g.check("][")&&(this.Off=1,this.Hist=!0),g.check("HIST")&&(this.Hist=!0,this.Func=!0,this.Error=!1),this.Bar=this.BarStyle>0,delete this.MarkStyle,g.check("P0")&&(this.Mark=!0,this.Hist=!1,this.Zero=!0),g.check("P")&&(this.Mark=!0,this.Hist=!1,this.Zero=!1),g.check("HZ")&&(this.Zscale=!0,this.Zvert=!1),g.check("Z")&&(this.Zscale=!0),g.check("*")&&(this.Mark=!0,this.MarkStyle=3,this.Hist=!1),g.check("H")&&(this.Hist=!0),g.check("E",!0)&&(this.Error=!0,1===D&&(this.Zero=!1,1===this.Hist&&(this.Hist=!1),Number.isInteger(parseInt(g.part[0]))&&(this.ErrorKind=parseInt(g.part[0])),(3===this.ErrorKind||4===this.ErrorKind)&&(this.need_fillcol=!0),0===this.ErrorKind&&(this.Zero=!0),g.part.indexOf("X0")>=0&&(this.errorX=0))),g.check("9")&&(this.HighRes=1),g.check("0")&&(this.Zero=!1),this.Color&&g.check("1")&&(this.Zero=!1),(this.Lego>0||3===D||(this.Surf>0||this.Error)&&2===D)&&(this.Mode3D=!0),b?.isTF1()&&1===D&&1===this.Hist&&!this.Line&&!this.Fill&&!this.Curve&&!this.Mark&&(this.Hist=!1,this.Curve=v.settings.FuncAsCurve,this.Line=!this.Curve,this.Fill=!0),15===this.Surf&&(this.System===ot||this.System===Ke)&&(this.Surf=13)}asString(G,D){let x="",P="";return this.Zscale&&(P=this.Zvert?"Z":"HZ"),this.Mode3D?(this.Lego?(x="LEGO",this.Zero||(x+="0"),this.Lego>10&&(x+=this.Lego-10),x+=P):this.Surf&&(x="SURF"+(this.Surf-10),x+=P),this.FrontBox||(x+="FB"),this.BackBox||(x+="BB"),1!==this.x3dscale&&(x+=`_X3DSC${Math.round(100*this.x3dscale)}`),1!==this.y3dscale&&(x+=`_Y3DSC${Math.round(100*this.y3dscale)}`)):(this.Candle?x="CANDLE"+this.Candle:this.Violin?x="VIOLIN"+this.Violin:this.Scat?x="SCAT":this.Color?(x="COL",this.Zero||(x+="0"),x+=P,this.Axis<0&&(x+="A")):this.Contour?(x="CONT",this.Contour>10&&(x+=this.Contour-10),x+=P):this.Bar?x=!1===this.BaseLine?"B":"B1":this.Mark?x=this.Zero?"P0":"P":this.Line?(x+="L",this.Fill&&(x+="F")):this.Off&&(x="]["),this.Error&&(x+="E",this.ErrorKind>=0&&(x+=this.ErrorKind),0===this.errorX&&(x+="X0")),this.Cjust&&(x+=" CJUST"),!0===this.Hist&&(x+="HIST"),this.Text&&(x+="TEXT",this.TextAngle&&(x+=this.TextAngle),x+=this.TextKind)),this.Palette&&this.canHavePalette()&&(x+=`_PAL${this.Palette}`),this.is3d()&&this.Ortho&&G&&(x+="_ORTHO"),this.Same?x+=this.ForceStat?"SAMES":"SAME":G&&x&&(this.ForceStat||!0===this.StatEnabled?x+="_STAT":(this.NoStat||!1===this.StatEnabled)&&(x+="_NOSTAT")),G&&D&&x&&(2===D.fLogx?x+="_LOG2X":D.fLogx&&(x+="_LOGX"),2===D.fLogy?x+="_LOG2Y":D.fLogy&&(x+="_LOGY"),2===D.fLogz?x+="_LOG2Z":D.fLogz&&(x+="_LOGZ"),D.fGridx&&(x+="_GRIDX"),D.fGridy&&(x+="_GRIDY"),D.fTickx&&(x+="_TICKX"),D.fTicky&&(x+="_TICKY"),D.fTickz&&(x+="_TICKZ")),this.cutg_name&&(x+=` [${this.cutg_name}]`),x}}class he{constructor(G,D){this.arr=[],this.colzmin=G,this.colzmax=D,this.below_min_indx=-1,this.exact_min_indx=0}getLevels(){return this.arr}createNormal(G,D,x){if(D){this.colzmax<=0&&(this.colzmax=1),this.colzmin<=0&&(this.colzmin=void 0===x||x<=0?1e-4*this.colzmax:x<3||x>100?.3*x:1),this.colzmin>=this.colzmax&&(this.colzmin=1e-4*this.colzmax);const P=Math.log(this.colzmin)/Math.log(10),b=(Math.log(this.colzmax)/Math.log(10)-P)/G;this.arr.push(this.colzmin);for(let g=1;g<G;g++)this.arr.push(Math.exp((P+b*g)*Math.log(10)));this.arr.push(this.colzmax),this.custom=!0}else{this.colzmin===this.colzmax&&0!==this.colzmin&&(this.colzmax+=.01*Math.abs(this.colzmax),this.colzmin-=.01*Math.abs(this.colzmin));const P=(this.colzmax-this.colzmin)/G;for(let w=0;w<=G;w++)this.arr.push(this.colzmin+P*w)}}createCustom(G){this.custom=!0;for(let D=0;D<G.length;++D)this.arr.push(G[D]);this.colzmax>this.arr[this.arr.length-1]&&this.arr.push(this.colzmax)}configIndicies(G,D){this.below_min_indx=G,this.exact_min_indx=D}getContourIndex(G){if(G<this.colzmin)return this.below_min_indx;if(G===this.colzmin)return this.exact_min_indx;if(!this.custom)return Math.floor(.01+(G-this.colzmin)*(this.arr.length-1)/(this.colzmax-this.colzmin));let D=0,x=this.arr.length-1;if(G<this.arr[0])return-1;if(G>=this.arr[x])return x;for(;D<x-1;){const P=Math.round((D+x)/2);this.arr[P]>G?x=P:D=P}return D}getPaletteColor(G,D){const x=this.getContourIndex(D);if(x<0)return null;const P=G.calcColorIndex(x,this.arr.length);return G.getColor(P)}getPaletteIndex(G,D){const x=this.getContourIndex(D);return x<0?null:G.calcColorIndex(x,this.arr.length)}}class re{constructor(G,D,x,P){this.painter=G,this.pp=D;const w=[],b=[],g=!0===P;this.newfuncs=[],this.newopts=[],g||D?.forEachPainterInPad(C=>{C.isSecondary(G)&&C._secondary_id?.match(/^func_|^indx_/)&&w.push(C)},"objects");for(let C=0;C<x?.arr.length;++C){const N=x.arr[C],O=x.opt[C];if(!N?._typename||(0,v.isFunc)(G.needDrawFunc)&&!G.needDrawFunc(G.getObject(),N))continue;let H=null,X=-1;if(!g){for(let ie=0;ie<w.length;++ie)if(w[ie].matchObjectType(N._typename)&&w[ie].getObjectName()===N.fName){H=w[ie],X=ie;break}!H&&N.fName&&(H=D?.findPainterFor(null,N.fName,N._typename))}H?(H.updateObject(N,O),X>=0&&(w.splice(X,1),b.push(H))):(this.newfuncs[C]=N,this.newopts[C]=O)}if((0,v.isObject)(P)){const C=w.indexOf(P);C>=0&&w.splice(C,1)}w.length>0&&D?.cleanPrimitives(C=>w.indexOf(C)>=0),b.length>0&&(this._extraPainters=b)}drawNext(G){if(this._extraPainters){const b=this._extraPainters.shift();return 0===this._extraPainters.length&&delete this._extraPainters,(0,v.getPromise)(b.redraw()).then(()=>this.drawNext(0))}if(!this.newfuncs||G>=this.newfuncs.length)return delete this.newfuncs,delete this.newopts,Promise.resolve(this.painter);const D=this.newfuncs[G],x=this.newopts[G];if(!D||this.pp?.findPainterFor(D))return this.drawNext(G+1);const P=D?.fName?`func_${D.fName}`:`indx_${G}`;return D.$main_painter=this.painter,(Je.TPavePainter.canDraw(D)?Je.TPavePainter.draw(this.painter.getDom(),D,x):this.pp.drawObject(this.painter.getDom(),D,x)).then(b=>(b.setSecondaryId(this.painter,P),this.drawNext(G+1)))}}const fe=(0,v.BIT)(10),de=(0,v.BIT)(16),pe=(0,v.BIT)(17);class ce extends xe.JW{constructor(G,D){super(G,D),this.draw_content=!0,this.nbinsx=this.nbinsy=0,this.accept_drops=!0,this.mode3d=!1}getHisto(){return this.getObject()}getAxis(G){const D=this.getObject();switch(G){case"x":return D?.fXaxis;case"y":return D?.fYaxis;case"z":return D?.fZaxis}return null}isTProfile(){return this.matchObjectType(v.clTProfile)}isTF1(){return!1}isTH1K(){return this.matchObjectType("TH1K")}isTH2Poly(){return this.matchObjectType(/^TH2Poly/)||this.matchObjectType(/^TProfile2Poly/)}clear3DScene(){const G=this.getFramePainter();(0,v.isFunc)(G?.create3DScene)&&G.create3DScene(-1),this.mode3d=!1}cleanup(){this.clear3DScene(),delete this._color_palette,delete this.fContour,delete this.options,super.cleanup()}getDimension(){const G=this.getHisto();return G?G._typename.match(/^TH2/)||G._typename===v.clTProfile2D?2:G._typename.match(/^TH3/)||G._typename===v.clTProfile3D?3:this.isTH2Poly()?2:1:0}decodeOptions(G){const D=this.getHisto(),x=this.getDimension(),P=this.getPadPainter(),w=P?.getRootPad(!0);this.options?this.options.reset():this.options=new L,this.lineatt?.setUsed(!1),this.fillatt?.setUsed(!1),this.markeratt?.setUsed(!1),this.options.decode(G||D.fOption,x,D,P,w,this),this.storeDrawOpt(G)}copyOptionsFrom(G){if(G===this)return;const D=this.options,x=G.options;D.Mode3D=x.Mode3D,D.Zero=x.Zero,x.Mode3D?(D.Lego=x.Lego,D.Surf=x.Surf):(D.Color=x.Color,D.Contour=x.Contour)}copyOptionsToOthers(){this.forEachPainter(G=>{G!==this&&(0,v.isFunc)(G.copyOptionsFrom)&&G.copyOptionsFrom(this)},"objects")}scanContent(){}checkPadRange(){this.isMainPainter()&&(this.check_pad_range=!this.options.Same||"pad_range")}createHistDrawAttributes(G){const D=this.getHisto(),x=this.options;if(x._pfc>1||x._plc>1||x._pmc>1){const P=this.getPadPainter();if((0,v.isFunc)(P?.getAutoColor)){const w=P.getAutoColor(D.$num_histos);this._auto_exec="",x._pfc>1&&(x._pfc=1,D.fFillColor=w,this._auto_exec+=`SetFillColor(${w});;`,delete this.fillatt),x._plc>1&&(x._plc=1,D.fLineColor=w,this._auto_exec+=`SetLineColor(${w});;`,delete this.lineatt),x._pmc>1&&(x._pmc=1,D.fMarkerColor=w,this._auto_exec+=`SetMarkerColor(${w});;`,delete this.markeratt)}}G?this.deleteAttr():(this.createAttFill({attr:D,color:this.options.histoFillColor,pattern:this.options.histoFillPattern,kind:1}),this.createAttLine({attr:D,color0:this.options.histoLineColor}))}updateAxes(G,D,x){const P=(w,b,g)=>{w.fTitle=b.fTitle,w.fLabels=b.fLabels,w.fXmin=b.fXmin,w.fXmax=b.fXmax,w.fTimeDisplay=b.fTimeDisplay,w.fTimeFormat=b.fTimeFormat,w.fAxisColor=b.fAxisColor,w.fLabelColor=b.fLabelColor,w.fLabelFont=b.fLabelFont,w.fLabelOffset=b.fLabelOffset,w.fLabelSize=b.fLabelSize,w.fNdivisions=b.fNdivisions,w.fTickLength=b.fTickLength,w.fTitleColor=b.fTitleColor,w.fTitleFont=b.fTitleFont,w.fTitleOffset=b.fTitleOffset,w.fTitleSize=b.fTitleSize,g&&(w.fFirst=b.fFirst,w.fLast=b.fLast,w.fBits=b.fBits)};P(G.fXaxis,D.fXaxis,this.snapid&&!x?.zoomChangedInteractive("x")),P(G.fYaxis,D.fYaxis,this.snapid&&!x?.zoomChangedInteractive("y")),P(G.fZaxis,D.fZaxis,this.snapid&&!x?.zoomChangedInteractive("z"))}updateObject(G,D){const x=this.getHisto(),P=this.getFramePainter(),w=this.getPadPainter(),b=this.options;if(G!==x){if(!this.matchObjectType(G))return!1;const g=w?.findPainterFor(this.findStat());x.TestBit(v.kNoStats)!==G.TestBit(v.kNoStats)&&(x.InvertBit(v.kNoStats),g&&(g.Enabled=!x.TestBit(v.kNoStats)&&!this.options.NoStat)),x.TestBit(de)!==G.TestBit(de)&&x.InvertBit(de),void 0!==this.snapid&&(x.fName=G.fName,b._pfc=b._plc=b._pmc=0),b._pfc||(x.fFillColor=G.fFillColor),x.fFillStyle=G.fFillStyle,b._plc||(x.fLineColor=G.fLineColor),x.fLineStyle=G.fLineStyle,x.fLineWidth=G.fLineWidth,b._pmc||(x.fMarkerColor=G.fMarkerColor),x.fMarkerSize=G.fMarkerSize,x.fMarkerStyle=G.fMarkerStyle,x.fEntries=G.fEntries,x.fTsumw=G.fTsumw,x.fTsumwx=G.fTsumwx,x.fTsumwx2=G.fTsumwx2,x.fXaxis.fNbins=G.fXaxis.fNbins,this.getDimension()>1&&(x.fTsumwy=G.fTsumwy,x.fTsumwy2=G.fTsumwy2,x.fTsumwxy=G.fTsumwxy,x.fYaxis.fNbins=G.fYaxis.fNbins,this.getDimension()>2&&(x.fTsumwz=G.fTsumwz,x.fTsumwz2=G.fTsumwz2,x.fTsumwxz=G.fTsumwxz,x.fTsumwyz=G.fTsumwyz,x.fZaxis.fNbins=G.fZaxis.fNbins)),this.updateAxes(x,G,P),x.fArray=G.fArray,x.fNcells=G.fNcells,x.fTitle=G.fTitle,x.fMinimum=G.fMinimum,x.fMaximum=G.fMaximum,x.fSumw2=G.fSumw2,b.ominimum||(b.minimum=x.fMinimum),b.omaximum||(b.maximum=x.fMaximum),1===this.getDimension()&&b.decodeSumw2(x),this.isTProfile()?x.fBinEntries=G.fBinEntries:this.isTH1K()?(x.fNIn=G.fNIn,x.fReady=0):this.isTH2Poly()&&(x.fBins=G.fBins),this._funcHandler=new re(this,w,G.fFunctions,g);const C=x.fOption!==G.fOption;x.fOption=G.fOption,(void 0!==D&&b.original!==D||C)&&this.decodeOptions(D||x.fOption)}return b.ominimum||(b.minimum=x.fMinimum),b.omaximum||(b.maximum=x.fMaximum),(!P||!P.zoomChangedInteractive())&&this.checkPadRange(),this.scanContent(),this.histogram_updated=!0,!0}extractAxesProperties(G){const D=P=>{P.fXbins.length>=P.fNbins?(P.GetBinCoord=function(w){const b=Math.round(w);if(b<=0)return this.fXmin;if(b>this.fNbins)return this.fXmax;if(b===w)return this.fXbins[b];const g=w<b?b-1:b+1;return this.fXbins[b]*Math.abs(w-g)+this.fXbins[g]*Math.abs(w-b)},P.FindBin=function(w,b){for(let g=1;g<this.fXbins.length;++g)if(w<this.fXbins[g])return Math.floor(g-1+b);return this.fNbins}):(P.$binwidth=(P.fXmax-P.fXmin)/(P.fNbins||1),P.GetBinCoord=function(w){return this.fXmin+w*this.$binwidth},P.FindBin=function(w,b){return Math.floor((w-this.fXmin)/this.$binwidth+b)})};this.nbinsx=this.nbinsy=this.nbinsz=0;const x=this.getHisto();this.nbinsx=x.fXaxis.fNbins,this.xmin=x.fXaxis.fXmin,this.xmax=x.fXaxis.fXmax,D(x.fXaxis),this.ymin=x.fYaxis.fXmin,this.ymax=x.fYaxis.fXmax,this._exact_y_range=1===G&&this.options.ohmin&&this.options.ohmax,this._exact_y_range&&(this.ymin=this.options.hmin,this.ymax=this.options.hmax),G>1&&(this.nbinsy=x.fYaxis.fNbins,D(x.fYaxis),this.zmin=x.fZaxis.fXmin,this.zmax=x.fZaxis.fXmax,2===G&&this.options.ohmin&&this.options.ohmax&&(this.zmin=this.options.hmin,this.zmax=this.options.hmax)),G>2&&(this.nbinsz=x.fZaxis.fNbins,D(x.fZaxis))}drawAxes(){var G=this;return(0,be.A)(function*(){const D=G.getFramePainter();if(!D)return!1;const x=G.getHisto();if(G.ymin===G.ymax&&(G.ymax+=1),!G.isMainPainter()){const w={second_x:G.options.AxisPos>=10,second_y:G.options.AxisPos%10==1,hist_painter:G};return!(!w.second_x&&!w.second_y||D.hasDrawnAxes(w.second_x,w.second_y))&&(D.setAxes2Ranges(w.second_x,x.fXaxis,G.xmin,G.xmax,w.second_y,x.fYaxis,G.ymin,G.ymax),D.createXY2(w),D.drawAxes2(w.second_x,w.second_y))}if(G.options.adjustFrame){const w=G.getPadPainter().getRootPad();w&&(w.fUxmin<w.fUxmax&&(D.fX1NDC=(G.xmin-w.fUxmin)/(w.fUxmax-w.fUxmin),D.fX2NDC=(G.xmax-w.fUxmin)/(w.fUxmax-w.fUxmin)),w.fUymin<w.fUymax&&(D.fY1NDC=(G.ymin-w.fUymin)/(w.fUymax-w.fUymin),D.fY2NDC=(G.ymax-w.fUymin)/(w.fUymax-w.fUymin)),w.fLeftMargin=D.fX1NDC,w.fRightMargin=1-D.fX2NDC,w.fBottomMargin=D.fY1NDC,w.fTopMargin=1-D.fY2NDC,w.fFrameLineColor=0,w.fFrameLineWidth=0,D.setRootPadRange(w),D.fillatt.setSolidColor("none"),D.redraw()),G.options.adjustFrame=!1}if(D.setAxesRanges(x.fXaxis,G.xmin,G.xmax,x.fYaxis,G.ymin,G.ymax,x.fZaxis,0,0),D.createXY({ndim:G.getDimension(),check_pad_range:G.check_pad_range,zoom_xmin:G.zoom_xmin,zoom_xmax:G.zoom_xmax,zoom_ymin:G.zoom_ymin,zoom_ymax:G.zoom_ymax,ymin_nz:G.ymin_nz,swap_xy:G.options.BarStyle>=20,reverse_x:G.options.RevX,reverse_y:G.options.RevY,symlog_x:G.options.SymlogX,symlog_y:G.options.SymlogY,Proj:G.options.Proj,extra_y_space:G.options.Text&&G.options.BarStyle>0,hist_painter:G}),delete G.check_pad_range,delete G.zoom_xmin,delete G.zoom_xmax,delete G.zoom_ymin,delete G.zoom_ymax,G.options.Same)return!1;const P=G.options.Axis<0||2===G.options.Axis;return D.drawAxes(!1,P,P,G.options.AxisPos,G.options.Zscale&&G.options.Zvert,G.options.Zscale&&!G.options.Zvert,1!==G.options.Axis)})()}processOnlineChange(G){const D=this.getCanvPainter();(0,v.isFunc)(D?.processChanges)&&D.processChanges(G,this)}fillWebObjectOptions(G){this._auto_exec&&G&&(G.fcust="auto_exec:"+this._auto_exec,delete this._auto_exec)}toggleTitle(G){const D=this.getHisto();return!(!this.isMainPainter()||!D)&&("only-check"===G?!D.TestBit(pe):(D.InvertBit(pe),void this.updateHistTitle().then(()=>this.processOnlineChange(`exec:SetBit(TH1::kNoTitle,${D.TestBit(pe)?1:0})`))))}updateHistTitle(){var G=this;return(0,be.A)(function*(){if(!G.isMainPainter()||G.options.Same||G.options.Axis>0)return G;const D=G.getPadPainter()?.findPainterFor(null,v.kTitle,v.clTPaveText),x=D?.getObject();if(!D||!x)return G;const P=G.getHisto(),w=v.gStyle,b=!P.TestBit(pe)&&w.fOptTitle>0;return x.Clear(),b&&x.AddText(P.fTitle),D.redraw().then(()=>G)})()}drawHistTitle(){var G=this;return(0,be.A)(function*(){if(!G.isMainPainter()||G.options.Same||G.options.Axis>0)return G;const D=G.getHisto(),x=v.gStyle,P=!D.TestBit(pe)&&x.fOptTitle>0;let w=G.getPadPainter()?.findInPrimitives(v.kTitle,v.clTPaveText);return w?(w.Clear(),P&&w.AddText(D.fTitle),G):(w=(0,v.create)(v.clTPaveText),Object.assign(w,{fName:v.kTitle,fFillColor:x.fTitleColor,fFillStyle:x.fTitleStyle,fBorderSize:x.fTitleBorderSize,fTextFont:x.fTitleFont,fTextSize:x.fTitleFontSize,fTextColor:x.fTitleTextColor,fTextAlign:x.fTitleAlign}),P&&w.AddText(D.fTitle),Je.TPavePainter.draw(G.getDom(),w,"postitle"))})()}processTitleChange(G){const D=this.getHisto(),x=this.getPadPainter()?.findPainterFor(null,v.kTitle);return D&&x?"check"===G?!this.isMainPainter()||this.options.Same?null:D:(x.clearPave(),x.addText(D.fTitle),x.redraw(),void this.submitCanvExec(`SetTitle("${D.fTitle}")`)):null}updateStatWebCanvas(){if(!this.snapid)return;const G=this.findStat(),D=this.getPadPainter()?.findPainterFor(G);D&&!D.snapid&&D.redraw()}findStat(){return this.findFunction(v.clTPaveStats,"stats")}toggleStat(G){let x,P,D=this.findStat();if(G||(G=""),D)x=this.getPadPainter()?.findPainterFor(D);else{if(G.indexOf("-check")>0)return!1;D=this.createStat(!0)}if("only-check"===G)return x?.Enabled||!1;if("fitpar-check"===G)return D?.fOptFit||!1;if("fitpar-toggle"===G)return!!D&&(D.fOptFit=D.fOptFit?0:1111,x?.redraw(),!0);if(x)x.Enabled=!x.Enabled,this.options.StatEnabled=x.Enabled,x.redraw(),P=x.Enabled;else{const w=this.selectCurrentPad(this.getPadName());P=Je.TPavePainter.draw(this.getDom(),D).then(()=>this.selectCurrentPad(w))}return this.processOnlineChange(`exec:SetBit(TH1::kNoStats,${P?0:1})`,this),P}isIgnoreStatsFill(){return!this.getObject()||!this.draw_content&&!this.create_stats&&!this.snapid}createStat(G){const D=this.getHisto();if(!D||!G&&!this.options.ForceStat&&(this.options.NoStat||D.TestBit(v.kNoStats)||!v.settings.AutoStat||!this.isMainPainter()))return null;const x=v.gStyle;let P=this.findStat(),w=this.options.optstat,b=this.options.optfit;return void 0!==w?(P&&(P.fOptStat=w),delete this.options.optstat):w=D.$custom_stat||x.fOptStat,void 0!==b?(P&&(P.fOptFit=b),delete this.options.optfit):b=x.fOptFit,P||w||b?(this.create_stats=!0,P||(P=(0,v.create)(v.clTPaveStats),Object.assign(P,{fName:"stats",fOptStat:w,fOptFit:b,fX1NDC:x.fStatX-x.fStatW,fY1NDC:x.fStatY-x.fStatH,fX2NDC:x.fStatX,fY2NDC:x.fStatY,fTextAlign:12}),P.AddText(D.fName),this.addFunction(P),P)):null}findFunction(G,D){const x=this.getHisto()?.fFunctions?.arr;if(!x)return null;for(let P=0;P<x.length;++P){const w=x[P];if((!D||w.fName===D)&&w._typename===G)return w}return null}addFunction(G,D){const x=this.getHisto();!x||!G||(x.fFunctions||(x.fFunctions=(0,v.create)(v.clTList)),D?x.fFunctions.AddFirst(G):x.fFunctions.Add(G))}needDrawFunc(G,D){return D._typename===v.clTPaveStats?"stats"!==D.fName||!G.TestBit(v.kNoStats)&&!this.options.NoStat:D._typename===v.clTF1||D._typename===v.clTF2?this.options.AllFunc||!D.TestBit((0,v.BIT)(9)):"TGraphDelaunay"!==D._typename&&"TGraphDelaunay2D"!==D._typename&&D._typename!==v.clTPaletteAxis}drawFunctions(){var G=this;return(0,be.A)(function*(){return new re(G,G.getPadPainter(),G.getHisto().fFunctions,!0).drawNext(0)})()}updateFunctions(){var G=this;return(0,be.A)(function*(){const D=G._funcHandler?.drawNext(0)??G;return delete G._funcHandler,D})()}getSelectIndex(G,D,x){let P=0,w=this.getAxis(G);const b=this[`nbins${G}`]??0;this.options.second_x&&"x"===G&&(G="x2"),this.options.second_y&&"y"===G&&(G="y2");const g=this.getFramePainter(),C=g?g[`zoom_${G}min`]:0,N=g?g[`zoom_${G}max`]:0;return C!==N&&w?(P="left"===D?w.FindBin(C,x||0):w.FindBin(N,(x||0)+.5),P<0?P=0:P>b&&(P=b)):P="left"===D?0:b,w&&(w.fFirst===w.fLast||!w.TestBit(xe.rb.kAxisRange)||w.fFirst<=1&&w.fLast>=b)&&(w=void 0),"left"===D?(P<0&&(P=0),w&&w.fFirst>1&&P<w.fFirst&&(P=w.fFirst-1)):(P>b&&(P=b),w&&w.fLast<=b&&P>w.fLast&&(P=w.fLast)),P}unzoomUserRange(G,D,x){const P=this.getHisto();if(!P)return!1;let w=!1;const b=C=>!(!C||!C.TestBit(xe.rb.kAxisRange)||C.fFirst===C.fLast||C.fFirst<=1&&C.fLast>=C.fNbins||(C.InvertBit(xe.rb.kAxisRange),0)),g=C=>!(this.getDimension()!==C||this.options.minimum===v.kNoZoom&&this.options.maximum===v.kNoZoom||!this.draw_content||(this.options.minimum=this.options.maximum=v.kNoZoom,this.scanContent(!0),0));return G&&b(P.fXaxis)&&(w=!0),D&&(b(P.fYaxis)||g(1))&&(w=!0),x&&(b(P.fZaxis)||g(2))&&(w=!0),w}addInteractivity(){var G=this;return(0,be.A)(function*(){const D=G.isMainPainter(),x=G.options.AxisPos>0;return(D||x?G.getFramePainter():null)?.addInteractivity(!D&&x)??!1})()}changeUserRange(G,D){const x=this.getHisto(),P=x?x[`f${D}axis`]:null;if(!P)return;let w=`[1,${P.fNbins}]`;P.TestBit(xe.rb.kAxisRange)&&(w=`[${P.fFirst},${P.fLast}]`),G.input(`Enter user range for axis ${D} like [1,${P.fNbins}]`,w).then(b=>{if(!b||!(b=JSON.parse(b))||2!==b.length)return;const g=parseInt(b[0]),C=parseInt(b[1]);Number.isInteger(g)&&Number.isInteger(C)&&(P.fFirst=g,P.fLast=C,(P.fFirst<P.fLast&&P.fFirst>=1&&P.fLast<=P.fNbins)!==P.TestBit(xe.rb.kAxisRange)&&P.InvertBit(xe.rb.kAxisRange),this.interactiveRedraw())})}changeValuesRange(G){let D;D=this.options.minimum!==v.kNoZoom&&this.options.maximum!==v.kNoZoom?`[${this.options.minimum},${this.options.maximum}]`:`[${this.gminbin},${this.gmaxbin}]`,G.input("Enter min/max hist values or empty string to reset",D).then(x=>{x=x?JSON.parse(x):[],(0,v.isObject)(x)&&2===x.length&&Number.isFinite(x[0])&&Number.isFinite(x[1])?(this.options.minimum=x[0],this.options.maximum=x[1]):this.options.minimum=this.options.maximum=v.kNoZoom,this.interactiveRedraw()})}executeMenuCommand(G,D){if(super.executeMenuCommand(G,D))return!0;if(G.fClassName===v.clTAxis){const x=(0,v.isStr)(G.$execid)?G.$execid.indexOf("#"):-1,P=x>0?G.$execid.slice(x+1):"x",w=this.getFramePainter();if("UnZoom"===G.fName)return w?.unzoom(P),!0;if("SetRange"===G.fName){const b=w?.getAxis(P),g=JSON.parse(`[${D}]`);b&&2===g?.length&&w?.zoom(P,b.GetBinLowEdge(g[0]),b.GetBinLowEdge(g[1]+1))}else if("SetRangeUser"===G.fName){const b=JSON.parse(`[${D}]`);2===b?.length&&w?.zoom(P,b[0],b[1])}}return!1}fillContextMenuItems(G){const D=this.getHisto(),x=this.getFramePainter();if(D){if(this.options.Axis<=0&&!this.isTF1()&&G.addchk(this.toggleStat("only-check"),"Show statbox",()=>this.toggleStat()),D.fTitle&&this.isMainPainter()&&G.addchk(this.toggleTitle("only-check"),"Show title",()=>this.toggleTitle()),this.draw_content&&(1===this.getDimension()?G.add("User range X",()=>this.changeUserRange(G,"X")):(G.add("sub:User ranges"),G.add("X",()=>this.changeUserRange(G,"X")),G.add("Y",()=>this.changeUserRange(G,"Y")),this.getDimension()>2?G.add("Z",()=>this.changeUserRange(G,"Z")):G.add("Values",()=>this.changeValuesRange(G)),G.add("endsub:")),(0,v.isFunc)(this.fillHistContextMenu)&&this.fillHistContextMenu(G)),this.options.Mode3D){G.size()>0&&G.add("separator");const P=this.getMainPainter()||this;G.addchk(P.isTooltipAllowed(),"Show tooltips",()=>P.setTooltipAllowed("toggle")),G.addchk(x?.enable_highlight,"Highlight bins",()=>{x.enable_highlight=!x.enable_highlight,!x.enable_highlight&&x.mode3d&&(0,v.isFunc)(x.highlightBin3D)&&x.highlightBin3D(null)}),(0,v.isFunc)(x?.render3D)&&(G.addchk(P.options.FrontBox,"Front box",()=>{P.options.FrontBox=!P.options.FrontBox,x.render3D()}),G.addchk(P.options.BackBox,"Back box",()=>{P.options.BackBox=!P.options.BackBox,x.render3D()}),G.addchk(x.camera?.isOrthographicCamera,"Orthographic camera",w=>{P.options.Ortho=w,x.change3DCamera(w)})),this.draw_content&&(G.addchk(!this.options.Zero,"Suppress zeros",()=>{this.options.Zero=!this.options.Zero,this.interactiveRedraw("pad")}),(12===this.options.Lego||14===this.options.Lego)&&(G.addchk(this.options.Zscale,"Z scale",()=>this.toggleColz()),this.fillPaletteMenu(G,!0))),(0,v.isFunc)(P.control?.reset)&&G.add("Reset camera",()=>P.control.reset())}this.histogram_updated&&x.zoomChangedInteractive()&&G.add("Let update zoom",()=>x.zoomChangedInteractive("reset"))}}getSnapId(G){if(!this.snapid)return"";let D=this.snapid.toString();return G&&(D+="#",this.isTF1()&&("x"===G||"y"===G||"z"===G)&&(D+="hist#"),D+=G),D}autoZoom(){}clickButton(G){const D=this.getFramePainter();if(!this.isMainPainter()||!D)return!1;switch(G){case"ToggleZoom":if(D.zoom_xmin!==D.zoom_xmax||D.zoom_ymin!==D.zoom_ymax||D.zoom_zmin!==D.zoom_zmax){const x=D.unzoom();return D.zoomChangedInteractive("reset"),x}if(this.draw_content)return this.autoZoom();break;case"ToggleLogX":return D.toggleAxisLog("x");case"ToggleLogY":return D.toggleAxisLog("y");case"ToggleLogZ":return D.toggleAxisLog("z");case"ToggleStatBox":return(0,v.getPromise)(this.toggleStat())}return!1}fillToolbar(G){const D=this.getPadPainter();D&&(D.addPadButton("auto_zoom","Toggle between unzoom and autozoom-in","ToggleZoom","Ctrl *"),D.addPadButton("arrow_right","Toggle log x","ToggleLogX","PageDown"),D.addPadButton("arrow_up","Toggle log y","ToggleLogY","PageUp"),this.getDimension()>1&&D.addPadButton("arrow_diag","Toggle log z","ToggleLogZ"),D.addPadButton("statbox","Toggle stat box","ToggleStatBox"),G||D.showPadButtons())}get3DToolTip(G){const D=this.getHisto(),x={bin:G,name:D.fName,title:D.fTitle};switch(this.getDimension()){case 1:x.ix=G,x.iy=1,x.value=D.getBinContent(x.ix),x.error=D.getBinError(G),x.lines=this.getBinTooltips(G-1);break;case 2:x.ix=G%(this.nbinsx+2),x.iy=(G-x.ix)/(this.nbinsx+2),x.value=D.getBinContent(x.ix,x.iy),x.error=D.getBinError(G),x.lines=this.getBinTooltips(x.ix-1,x.iy-1);break;case 3:x.ix=G%(this.nbinsx+2),x.iy=(G-x.ix)/(this.nbinsx+2)%(this.nbinsy+2),x.iz=(G-x.ix-x.iy*(this.nbinsx+2))/(this.nbinsx+2)/(this.nbinsy+2),x.value=D.getBinContent(x.ix,x.iy,x.iz),x.error=D.getBinError(G),x.lines=this.getBinTooltips(x.ix-1,x.iy-1,x.iz-1)}return x}createContour(G,D,x,P,w){const b=new he(D,x),g=this.getDimension();if(w)b.createCustom(w);else{G<2&&(G=v.gStyle.fNumberContours);const N=this.getPadPainter().getRootPad(!0);b.createNormal(G,N?.fLogv??(2===g&&N?.fLogz)??0,P)}b.configIndicies(this.options.Zero?-1:0,0!==b.colzmin||!this.options.Zero||this.isTH2Poly()?0:-1);const C=this.getFramePainter();return C&&g<3&&!C.mode3d&&(C.zmin=b.colzmin,C.zmax=b.colzmax),this.fContour=b,b}getContour(G){if(this.fContour&&!G)return this.fContour;const D=this.getMainPainter(),x=this.getFramePainter();if(D?.fContour&&D!==this&&!this.options.IgnoreMainScale)return this.fContour=D.fContour,this.fContour;const P=this.getObject(),w=this===D||void 0===D?.minbin||this.options.IgnoreMainScale||D?.tt_handle?.ScatterPlot?this:D;let g,H,b=0,C=w.minbin,N=w.maxbin,O=w.minposbin;C===N&&(C=w.gminbin,N=w.gmaxbin,O=w.gminposbin);let X=C,ie=N;this.options.minimum!==v.kNoZoom&&(C=this.options.minimum,X=Math.min(X,C),g=!0),this.options.maximum!==v.kNoZoom&&(N=this.options.maximum,ie=Math.max(ie,N),g=!1),C>=N&&(g?N=C+1:C=N-1),x&&x.zoom_zmin!==x.zoom_zmax&&(C=x.zoom_zmin,N=x.zoom_zmax),P.fContour?.length>1&&(P.TestBit(fe)?H=P.fContour:b=P.fContour.length);const z=this.createContour(b,C,N,O,H);return this.getDimension()<3&&x&&(x.zmin=X,x.zmax=ie,X!==z.colzmin||ie!==z.colzmax?(x.zoom_zmin=z.colzmin,x.zoom_zmax=z.colzmax):x.zoom_zmin=x.zoom_zmax=void 0),z}getContourLevels(G){return this.getContour(G).getLevels()}getHistPalette(G){G&&(this._color_palette=null);const D=this.getPadPainter();return!this._color_palette&&!this.options.Palette&&(0,v.isFunc)(D?.getCustomPalette)&&(this._color_palette=D.getCustomPalette()),this._color_palette||(this._color_palette=(0,V.jh)(this.options.Palette,D?.isGrayscale())),this._color_palette}fillPaletteMenu(G,D){if(G.addPaletteMenu(this.options.Palette||v.settings.Palette,x=>{this.options.Palette=parseInt(x),this.getHistPalette(!0),this.redraw()}),!D){G.add("Default position",()=>{this.drawColorPalette(this.options.Zscale,!1,!0).then(()=>this.processOnlineChange("drawopt"))},"Set default position for palette");const x=this.findFunction(v.clTPaletteAxis);G.addchk(!x||x.fX2NDC-x.fX1NDC<x.fY2NDC-x.fY1NDC,"Vertical",w=>{this.options.Zvert=w,this.drawColorPalette(this.options.Zscale,!1,"toggle").then(()=>this.processOnlineChange("drawopt"))},"Toggle palette vertical/horizontal flag"),G.add("Bring to front",()=>this.getPadPainter()?.findPainterFor(x)?.bringToFront())}}drawColorPalette(G,D,x){var P=this;return(0,be.A)(function*(){if(P.options.IgnorePalette)return null;const w=P.getMainPainter(),b=P.getPadPainter();if(w!==P&&w&&!1!==w.draw_content&&w.options.Zscale)return null;let g=P.findFunction(v.clTPaletteAxis),C=b?.findPainterFor(g);const N=!!g;if(P._can_move_colz&&(delete P._can_move_colz,x||(x=!0)),!C&&!g&&!P.options.Axis&&(C=b?.findPainterFor(void 0,void 0,v.clTPaletteAxis),C&&(g=C.getObject(),P.addFunction(g,!0))),!G)return C&&(P.options.Zvert=C._palette_vertical,C.Enabled=!1,C.removeG()),null;if(g)void 0!==b?._palette_vertical&&(P.options.Zvert=b._palette_vertical);else{if(g=(0,v.create)(v.clTPaletteAxis),g.fInit=1,g.$can_move=!0,g.$generated=!0,Object.assign(g,P.options.Zvert?{fX1NDC:1.005-v.gStyle.fPadRightMargin,fX2NDC:1.045-v.gStyle.fPadRightMargin,fY1NDC:v.gStyle.fPadBottomMargin,fY2NDC:1-v.gStyle.fPadTopMargin}:{fX1NDC:v.gStyle.fPadLeftMargin,fX2NDC:1-v.gStyle.fPadRightMargin,fY1NDC:1.005-v.gStyle.fPadTopMargin,fY2NDC:1.045-v.gStyle.fPadTopMargin}),Object.assign(g.fAxis,{fChopt:"+",fLineSyle:1,fLineWidth:1,fTextAngle:0,fTextAlign:11}),2===P.getDimension()){const ie=P.getHisto().fZaxis;Object.assign(g.fAxis,{fTitle:ie.fTitle,fTitleSize:ie.fTitleSize,fTitleOffset:ie.fTitleOffset,fTitleColor:ie.fTitleColor,fLineColor:ie.fAxisColor,fTextSize:ie.fLabelSize,fTextColor:ie.fLabelColor,fTextFont:ie.fLabelFont,fLabelOffset:ie.fLabelOffset})}P.addFunction(g,!0),x=!0}const O=P.getFramePainter();if(x&&O&&g.$can_move)if(P.options.Zvert){if("toggle"===x){const ie=g.fY2NDC-g.fY1NDC;g.fX1NDC=O.fX2NDC+.005,g.fX2NDC=g.fX1NDC+ie}g.fX1NDC>.5*(O.fX1NDC+O.fX2NDC)?(g.fX2NDC=O.fX2NDC+.005+(g.fX2NDC-g.fX1NDC),g.fX1NDC=O.fX2NDC+.005):(g.fX1NDC=O.fX1NDC-.03-(g.fX2NDC-g.fX1NDC),g.fX2NDC=O.fX1NDC-.03),g.fY1NDC=O.fY1NDC,g.fY2NDC=O.fY2NDC}else{if("toggle"===x){const ie=g.fX2NDC-g.fX1NDC;g.fY1NDC=O.fY2NDC+.005,g.fY2NDC=g.fY1NDC+ie}g.fX1NDC=O.fX1NDC,g.fX2NDC=O.fX2NDC,g.fY2NDC>.5*(O.fY1NDC+O.fY2NDC)?(g.fY2NDC=O.fY2NDC+.005+(g.fY2NDC-g.fY1NDC),g.fY1NDC=O.fY2NDC+.005):(g.fY1NDC=O.fY1NDC-.05-(g.fY2NDC-g.fY1NDC),g.fY2NDC=O.fY1NDC-.05)}g.$main_painter=P;let X,H="";if(D&&(H+=";postpone"),x&&!P.do_redraw_palette&&(H+=";can_move"),P.options.Cjust&&(H+=";cjust"),C){if(C.Enabled=!0,D)return C;X=C.drawPave(H)}else{const ie=P.selectCurrentPad(P.getPadName());X=Je.TPavePainter.draw(P.getDom(),g,H).then(z=>{C=z,P.selectCurrentPad(ie),C.setSecondaryId(P,N&&!g.$generated?`func_${g.fName}`:void 0)})}return X.then(()=>{P.options.Zvert=C._palette_vertical,C.redraw=()=>{};let ie=!1;if(x&&O&&!P.do_redraw_palette){const m=b?.getRootPad(!0);P.options.Zvert?(g.fX1NDC>.5&&O.fX2NDC>g.fX1NDC?(ie=!0,O.fX2NDC=g.fX1NDC-.01,O.fX1NDC>O.fX2NDC-.1&&(O.fX1NDC=Math.max(0,O.fX2NDC-.1))):g.fX2NDC<.5&&O.fX1NDC<g.fX2NDC&&(ie=!0,O.fX1NDC=g.fX2NDC+.05,O.fX2NDC<O.fX1NDC+.1&&(O.fX2NDC=Math.min(1,O.fX1NDC+.1))),ie&&m&&(m.fLeftMargin=O.fX1NDC,m.fRightMargin=1-O.fX2NDC)):(g.fY1NDC>.5&&O.fY2NDC>g.fY1NDC?(ie=!0,O.fY2NDC=g.fY1NDC-.01,O.fY1NDC>O.fY2NDC-.1&&(O.fY1NDC=Math.max(0,O.fXYNDC-.1))):g.fY2NDC<.5&&O.fY1NDC<g.fY2NDC&&(ie=!0,O.fY1NDC=g.fY2NDC+.05,O.fXYNDC<O.fY1NDC+.1&&(O.fY2NDC=Math.min(1,O.fY1NDC+.1))),ie&&m&&(m.fTopMargin=O.fY1NDC,m.fBottomMargin=1-O.fY2NDC))}return ie?(P.do_redraw_palette=!0,O.redraw(),(D?Promise.resolve(!0):P.redraw()).then(()=>(delete P.do_redraw_palette,C))):C})})()}toggleColz(){if(this.options.canHavePalette())return this.options.Zscale=!this.options.Zscale,this.drawColorPalette(this.options.Zscale,!1,!0).then(()=>this.processOnlineChange("drawopt"))}toggleMode3D(){return this.options.Mode3D=!this.options.Mode3D,this.options.Mode3D&&!this.options.Surf&&!this.options.Lego&&!this.options.Error&&(this.options.Lego=this.nbinsx>=50||this.nbinsy>=50?this.options.Scat?13:14:this.options.Scat?1:12,this.options.Zero=!1),this.copyOptionsToOthers(),this.interactiveRedraw("pad","drawopt")}prepareDraw(G){G||(G={rounding:!0,extra:0,middle:0}),void 0===G.extra&&(G.extra=0),void 0===G.middle&&(G.middle=0);const D=this.getHisto(),x=D.fXaxis,P=D.fYaxis,w=this.getFramePainter(),b=this.getDimension(),g={i1:G.nozoom?0:this.getSelectIndex("x","left",0-G.extra),i2:G.nozoom?this.nbinsx:this.getSelectIndex("x","right",1+G.extra),j1:1===b||G.nozoom?0:this.getSelectIndex("y","left",0-G.extra),j2:1===b?1:G.nozoom?this.nbinsy:this.getSelectIndex("y","right",1+G.extra),min:0,max:0,sumz:0,xbar1:0,xbar2:1,ybar1:0,ybar2:1};if(G.cutg){let m=g.i2,I=g.i1,A=g.j2,R=g.j1;for(let k=g.i1;k<g.i2;++k)for(let ee=g.j1;ee<g.j2;++ee)G.cutg.IsInside(x.GetBinCoord(k+G.middle),P.GetBinCoord(ee+G.middle))&&(m=Math.min(m,k),I=Math.max(I,k+1),A=Math.min(A,ee),R=Math.max(R,ee+1));g.i1=m,g.i2=I,g.j1=A,g.j2=R}let C,N,O,H,X,ie;if(g.grx=new Float32Array(g.i2+1),g.gry=new Float32Array(g.j2+1),"number"==typeof D.fBarOffset&&"number"==typeof D.fBarWidth&&(D.fBarOffset||1e3!==D.fBarWidth)&&(D.fBarOffset<=1e3?g.xbar1=g.ybar1=.001*D.fBarOffset:D.fBarOffset<=3e3?g.xbar1=.001*(D.fBarOffset-2e3):D.fBarOffset<=5e3&&(g.ybar1=.001*(D.fBarOffset-4e3)),D.fBarWidth<=1e3?(g.xbar2=Math.min(1,g.xbar1+.001*D.fBarWidth),g.ybar2=Math.min(1,g.ybar1+.001*D.fBarWidth)):D.fBarWidth<=3e3?g.xbar2=Math.min(1,g.xbar1+.001*(D.fBarWidth-2e3)):D.fBarWidth<=5e3&&(g.ybar2=Math.min(1,g.ybar1+.001*(D.fBarWidth-4e3)))),G.original&&(g.original=!0,g.origx=new Float32Array(g.i2+1),g.origy=new Float32Array(g.j2+1)),G.pixel_density&&(G.rounding=!0),!w)return console.warn("cannot draw histogram without frame"),g;const z=w.getGrFuncs(this.options.second_x,this.options.second_y);for(C=g.i1;C<=g.i2;++C)O=x.GetBinCoord(C+G.middle),z.logx&&O<=0?g.i1=C+1:(g.origx&&(g.origx[C]=O),g.grx[C]=z.grx(O),G.rounding&&(g.grx[C]=Math.round(g.grx[C])),G.use3d&&(g.grx[C]<-w.size_x3d&&(g.grx[C]=-w.size_x3d,this.options.RevX?g.i2=C:g.i1=C),g.grx[C]>w.size_x3d&&(g.grx[C]=w.size_x3d,this.options.RevX?g.i1=C:g.i2=C)));if(1===b)g.gry[0]=z.gry(0),g.gry[1]=z.gry(1);else for(N=g.j1;N<=g.j2;++N)H=P.GetBinCoord(N+G.middle),z.logy&&H<=0?g.j1=N+1:(g.origy&&(g.origy[N]=H),g.gry[N]=z.gry(H),G.rounding&&(g.gry[N]=Math.round(g.gry[N])),G.use3d&&(g.gry[N]<-w.size_y3d&&(g.gry[N]=-w.size_y3d,this.options.RevY?g.j2=N:g.j1=N),g.gry[N]>w.size_y3d&&(g.gry[N]=w.size_y3d,this.options.RevY?g.j1=N:g.j2=N)));for(this.maxbin=this.minbin=this.minposbin=null,C=g.i1;C<g.i2;++C)for(N=g.j1;N<g.j2;++N){if(X=D.getBinContent(C+1,N+1),g.sumz+=X,G.pixel_density){if(ie=(g.grx[C+1]-g.grx[C])*(g.gry[N]-g.gry[N+1]),ie<=0)continue;g.max=Math.max(g.max,X),X>0&&(X<g.min||0===g.min)&&(g.min=X),X/=ie}null===this.maxbin?this.maxbin=this.minbin=X:(this.maxbin=Math.max(this.maxbin,X),this.minbin=Math.min(this.minbin,X)),X>0&&(null===this.minposbin||X<this.minposbin)&&(this.minposbin=X)}return this.fContour=null,g}getAxisBinTip(G,D,x){const w=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),b=w[`${G}_handle`],g=D.GetBinLowEdge(x+1);if(b.kind===xe.ei)return w.axisAsText(G,g);const C=D.GetBinLowEdge(x+2);return b.kind===xe.Yu||this.isTF1()?w.axisAsText(G,(g+C)/2):`[${w.axisAsText(G,g)}, ${w.axisAsText(G,C)})`}static _drawHist(G,D){return(0,be.A)(function*(){return(0,st.ensureTCanvas)(G).then(()=>(G.setAsMainPainter(),G.decodeOptions(D),G.isTH2Poly()&&G.options.Mode3D&&(G.options.Lego=12),G.checkPadRange(),G.scanContent(),G.createStat(),G.callDrawFunc())).then(()=>G.drawFunctions()).then(()=>G.drawHistTitle()).then(()=>{if(!G.Mode3D&&G.options.AutoZoom)return G.autoZoom()}).then(()=>{if(G.options.Project&&!G.mode3d&&(0,v.isFunc)(G.toggleProjection))return G.toggleProjection(G.options.Project)}).then(()=>(G.fillToolbar(),G))})()}}},9907:(Gr,xt,Te)=>{"use strict";Te.d(xt,{$o:()=>Xe,D1:()=>Ie,FF:()=>A,Fk:()=>st,Hg:()=>K,Mx:()=>Mr,N8:()=>ct,NE:()=>N,PI:()=>H,Ph:()=>m,Pk:()=>z,Q_:()=>G,Ql:()=>Se,Qu:()=>O,R0:()=>Je,Tq:()=>Ue,Ub:()=>Cn,V$:()=>k,_T:()=>hi,aM:()=>he,bP:()=>P,bm:()=>ie,c4:()=>w,h0:()=>x,k:()=>ce,k1:()=>de,lW:()=>Zt,lZ:()=>Ke,mU:()=>$,nc:()=>re,ry:()=>Nt,s4:()=>C,v5:()=>De,w1:()=>I,yd:()=>L,ym:()=>Re});var be=Te(5774),v=Te(4186);const V="TStreamerElement",Le="TStreamerObject",xe="TStreamerSTL",Je="TStreamerInfoList",st="TDirectory",Ke="TDirectoryFile",Re="TBasket",Qe="TDatime",Ie="StreamerInfo",L=1,he=2,re=3,fe=4,de=5,pe=6,ce=7,K=8,G=9,D=10,x=11,P=12,w=13,b=14,g=15,C=16,N=17,O=18,H=19,X=0,ie=20,z=40,m=61,I=62,A=63,R=64,k=65,ee=66,ge=67,ve=68,Se=69,De=71,Xe=300,ct=500,$=501,We=1073741824,Ne=4294967295,Fe=2147483648,ht=(0,v.BIT)(14),pt=0,dt=1,rt=2,_t=3,Yt=4,kt=5,Tt=6,fn=7,ln=8,mn=["BASE","char","short","int","long","float","int","const char*","double","Double32_t","char","unsigned  char","unsigned short","unsigned","unsigned long","unsigned","Long64_t","ULong64_t","bool","Float16_t"],jt=["","vector","list","deque","map","multimap","set","multiset","bitset"],Sn=(0,v.BIT)(4),cn=(0,v.BIT)(5),gn={TObject(Y,E){E.fUniqueID=Y.ntou4(),E.fBits=Y.ntou4(),E.fBits&Sn&&Y.ntou2()},TNamed:[{basename:v.clTObject,base:1,func(Y,E){E._typename||(E._typename=v.clTNamed),Y.classStreamer(E,v.clTObject)}},{name:"fName",func(Y,E){E.fName=Y.readTString()}},{name:"fTitle",func(Y,E){E.fTitle=Y.readTString()}}],TObjString:[{basename:v.clTObject,base:1,func(Y,E){E._typename||(E._typename=v.clTObjString),Y.classStreamer(E,v.clTObject)}},{name:"fString",func(Y,E){E.fString=Y.readTString()}}],TClonesArray(Y,E){E._typename||(E._typename=v.clTClonesArray),E.$kind=v.clTClonesArray,E.name="";const J=Y.last_read_version;J>2&&Y.classStreamer(E,v.clTObject),J>1&&(E.name=Y.readTString());let Ae=Y.readTString(),Ce=0;const He=Ae.lastIndexOf(";");He>0&&(Ce=Number.parseInt(Ae.slice(He+1)),Ae=Ae.slice(0,He));let nt=Y.ntou4();nt<0&&(nt=-nt),E.arr=new Array(nt),E.fLast=nt-1,E.fLowerBound=Y.ntou4();let it=Y.fFile.getStreamer(Ae,{val:Ce});if(it=Y.fFile.getSplittedStreamer(it),it){for(let lt=0;lt<nt;++lt)E.arr[lt]={_typename:Ae};for(let lt=0;lt<it.length;++lt)for(let qt=0;qt<nt;++qt)it[lt].func(Y,E.arr[qt])}else console.log(`Cannot get member-wise streamer for ${Ae}:${Ce}`)},TMap(Y,E){E._typename||(E._typename=v.clTMap),E.name="",E.arr=[];const J=Y.last_read_version;J>2&&Y.classStreamer(E,v.clTObject),J>1&&(E.name=Y.readTString());const Ae=Y.ntou4();for(let Ce=0;Ce<Ae;++Ce){const He={_typename:"TPair"};He.first=Y.readObjectAny(),He.second=Y.readObjectAny(),He.first&&E.arr.push(He)}},TTreeIndex(Y,E){const J=Y.last_read_version;E._typename="TTreeIndex",Y.classStreamer(E,"TVirtualIndex"),E.fMajorName=Y.readTString(),E.fMinorName=Y.readTString(),E.fN=Y.ntoi8(),E.fIndexValues=Y.readFastArray(E.fN,C),J>1&&(E.fIndexValuesMinor=Y.readFastArray(E.fN,C)),E.fIndex=Y.readFastArray(E.fN,C)},TRefArray(Y,E){E._typename="TRefArray",Y.classStreamer(E,v.clTObject),E.name=Y.readTString();const J=Y.ntoi4();E.fLast=J-1,E.fLowerBound=Y.ntoi4(),Y.ntou2(),E.fUIDs=Y.readFastArray(J,w)},TCanvas(Y,E){E._typename=v.clTCanvas,Y.classStreamer(E,v.clTPad),E.fDISPLAY=Y.readTString(),E.fDoubleBuffer=Y.ntoi4(),E.fRetained=0!==Y.ntou1(),E.fXsizeUser=Y.ntoi4(),E.fYsizeUser=Y.ntoi4(),E.fXsizeReal=Y.ntoi4(),E.fYsizeReal=Y.ntoi4(),E.fWindowTopX=Y.ntoi4(),E.fWindowTopY=Y.ntoi4(),E.fWindowWidth=Y.ntoi4(),E.fWindowHeight=Y.ntoi4(),E.fCw=Y.ntou4(),E.fCh=Y.ntou4(),E.fCatt=Y.classStreamer({},v.clTAttCanvas),Y.ntou1(),Y.ntou1(),E.fHighLightColor=Y.ntoi2(),E.fBatch=0!==Y.ntou1(),Y.ntou1(),Y.ntou1(),Y.ntou1()},TObjArray(Y,E){E._typename||(E._typename=v.clTObjArray),E.$kind=v.clTObjArray,E.name="";const J=Y.last_read_version;J>2&&Y.classStreamer(E,v.clTObject),J>1&&(E.name=Y.readTString());const Ae=Y.ntou4();let Ce=0;for(E.arr=new Array(Ae),E.fLast=Ae-1,E.fLowerBound=Y.ntou4();Ce<Ae;)E.arr[Ce++]=Y.readObjectAny()},TPolyMarker3D(Y,E){const J=Y.last_read_version;Y.classStreamer(E,v.clTObject),Y.classStreamer(E,v.clTAttMarker),E.fN=Y.ntoi4(),E.fP=Y.readFastArray(3*E.fN,de),E.fOption=Y.readTString(),E.fName=J>1?Y.readTString():v.clTPolyMarker3D},TPolyLine3D(Y,E){Y.classStreamer(E,v.clTObject),Y.classStreamer(E,v.clTAttLine),E.fN=Y.ntoi4(),E.fP=Y.readFastArray(3*E.fN,de),E.fOption=Y.readTString()},TStreamerInfo(Y,E){Y.classStreamer(E,v.clTNamed),E.fCheckSum=Y.ntou4(),E.fClassVersion=Y.ntou4(),E.fElements=Y.readObjectAny()},TStreamerElement(Y,E){const J=Y.last_read_version;if(Y.classStreamer(E,v.clTNamed),E.fType=Y.ntou4(),E.fSize=Y.ntou4(),E.fArrayLength=Y.ntou4(),E.fArrayDim=Y.ntou4(),E.fMaxIndex=Y.readFastArray(1===J?Y.ntou4():5,w),E.fTypeName=Y.readTString(),E.fType===x&&("Bool_t"===E.fTypeName||"bool"===E.fTypeName)&&(E.fType=O),E.fXmin=E.fXmax=E.fFactor=0,3===J)E.fXmin=Y.ntod(),E.fXmax=Y.ntod(),E.fFactor=Y.ntod();else if(J>3&&E.fBits&(0,v.BIT)(6)){let Ae=E.fTitle.indexOf("[");Ae>=0&&E.fType>z&&(Ae=E.fTitle.indexOf("[",Ae+1));const Ce=E.fTitle.indexOf("]",Ae+1);if(Ae>=0&&Ce>=Ae+2){const He=E.fTitle.slice(Ae+1,Ce).split(",");let nt=32;if(!He||He.length<2)throw new Error(`Problem to decode range setting from streamer element title ${E.fTitle}`);3===He.length&&(nt=parseInt(He[2])),(!Number.isInteger(nt)||nt<2||nt>32)&&(nt=32);const it=qt=>{if(!qt)return 0;if(qt.indexOf("pi")<0)return parseFloat(qt);let at=1;switch("-"===(qt=qt.trim())[0]&&(at=-1,qt=qt.slice(1)),qt){case"2pi":case"2*pi":case"twopi":return 2*at*Math.PI;case"pi/2":return at*Math.PI/2;case"pi/4":return at*Math.PI/4}return at*Math.PI};E.fXmin=it(He[0]),E.fXmax=it(He[1]);const lt=nt>=0&&nt<32?Math.pow(2,nt):4294967295;E.fXmin<E.fXmax?E.fFactor=lt/(E.fXmax-E.fXmin):nt<15&&(E.fXmin=nt)}}},TStreamerBase(Y,E){const J=Y.last_read_version;Y.classStreamer(E,V),J>2&&(E.fBaseVersion=Y.ntou4())},TStreamerSTL(Y,E){Y.classStreamer(E,V),E.fSTLtype=Y.ntou4(),E.fCtype=Y.ntou4(),E.fSTLtype===kt&&(0===E.fTypeName.indexOf("std::set")||0===E.fTypeName.indexOf("set"))&&(E.fSTLtype=Tt),E.fSTLtype===Tt&&(0===E.fTypeName.indexOf("std::multimap")||0===E.fTypeName.indexOf("multimap"))&&(E.fSTLtype=kt)},TStreamerSTLstring(Y,E){Y.last_read_version>0&&Y.classStreamer(E,xe)},TList(Y,E){if(E._typename||(E._typename=this.typename),E.$kind=v.clTList,Y.last_read_version>3){Y.classStreamer(E,v.clTObject),E.name=Y.readTString();const J=Y.ntou4();E.arr=new Array(J),E.opt=new Array(J);for(let Ae=0;Ae<J;++Ae)E.arr[Ae]=Y.readObjectAny(),E.opt[Ae]=Y.readTString()}else E.name="",E.arr=[],E.opt=[]},THashList:v.clTList,TStreamerLoop(Y,E){Y.last_read_version>1&&(Y.classStreamer(E,V),E.fCountVersion=Y.ntou4(),E.fCountName=Y.readTString(),E.fCountClass=Y.readTString())},TStreamerBasicPointer:"TStreamerLoop",TStreamerObject(Y,E){Y.last_read_version>1&&Y.classStreamer(E,V)},TStreamerBasicType:Le,TStreamerObjectAny:Le,TStreamerString:Le,TStreamerObjectPointer:Le,TStreamerObjectAnyPointer(Y,E){Y.last_read_version>0&&Y.classStreamer(E,V)},TTree:{name:"$file",func(Y,E){E.$kind="TTree",E.$file=Y.fFile}},RooRealVar(Y,E){const J=Y.last_read_version;Y.classStreamer(E,"RooAbsRealLValue"),1===J&&(Y.ntod(),Y.ntod(),Y.ntoi4()),E._error=Y.ntod(),E._asymErrLo=Y.ntod(),E._asymErrHi=Y.ntod(),J>=2&&(E._binning=Y.readObjectAny()),3===J&&(E._sharedProp=Y.readObjectAny()),J>=4&&(E._sharedProp=Y.classStreamer({},"RooRealVarSharedProperties"))},RooAbsBinning(Y,E){Y.classStreamer(E,1===Y.last_read_version?v.clTObject:v.clTNamed),Y.classStreamer(E,"RooPrintable")},RooCategory(Y,E){const J=Y.last_read_version;Y.classStreamer(E,"RooAbsCategoryLValue"),E._sharedProp=1===J?Y.readObjectAny():Y.classStreamer({},"RooCategorySharedProperties")},"RooWorkspace::CodeRepo":Y=>{const E=2===Y.last_read_version?3:2;for(let J=0;J<E;++J){let Ae=Y.ntoi4()*(0===J?4:3);for(;Ae--;)Y.readTString()}},RooLinkedList(Y,E){const J=Y.last_read_version;Y.classStreamer(E,v.clTObject);let Ae=Y.ntoi4();for(E.arr=(0,v.create)(v.clTList);Ae--;)E.arr.Add(Y.readObjectAny());J>1&&(E._name=Y.readTString())},TImagePalette:[{basename:v.clTObject,base:1,func(Y,E){E._typename||(E._typename=v.clTImagePalette),Y.classStreamer(E,v.clTObject)}},{name:"fNumPoints",func(Y,E){E.fNumPoints=Y.ntou4()}},{name:"fPoints",func(Y,E){E.fPoints=Y.readFastArray(E.fNumPoints,K)}},{name:"fColorRed",func(Y,E){E.fColorRed=Y.readFastArray(E.fNumPoints,P)}},{name:"fColorGreen",func(Y,E){E.fColorGreen=Y.readFastArray(E.fNumPoints,P)}},{name:"fColorBlue",func(Y,E){E.fColorBlue=Y.readFastArray(E.fNumPoints,P)}},{name:"fColorAlpha",func(Y,E){E.fColorAlpha=Y.readFastArray(E.fNumPoints,P)}}],TAttImage:[{name:"fImageQuality",func(Y,E){E.fImageQuality=Y.ntoi4()}},{name:"fImageCompression",func(Y,E){E.fImageCompression=Y.ntou4()}},{name:"fConstRatio",func(Y,E){E.fConstRatio=0!==Y.ntou1()}},{name:"fPalette",func(Y,E){E.fPalette=Y.classStreamer({},v.clTImagePalette)}}],TASImage(Y,E){if(1===Y.last_read_version&&Y.fFile.fVersion>0&&Y.fFile.fVersion<5e4)return console.warn("old TASImage version - not yet supported");if(Y.classStreamer(E,v.clTNamed),0!==Y.ntou1()){const J=Y.ntoi4();E.fPngBuf=Y.readFastArray(J,x)}else Y.classStreamer(E,"TAttImage"),E.fWidth=Y.ntoi4(),E.fHeight=Y.ntoi4(),E.fImgBuf=Y.readFastArray(E.fWidth*E.fHeight,K)},TMaterial(Y,E){const J=Y.last_read_version;Y.classStreamer(E,v.clTNamed),E.fNumber=Y.ntoi4(),E.fA=Y.ntof(),E.fZ=Y.ntof(),E.fDensity=Y.ntof(),J>2?(Y.classStreamer(E,v.clTAttFill),E.fRadLength=Y.ntof(),E.fInterLength=Y.ntof()):E.fRadLength=E.fInterLength=0},TMixture(Y,E){Y.classStreamer(E,"TMaterial"),E.fNmixt=Y.ntoi4(),E.fAmixt=Y.readFastArray(Y.ntoi4(),de),E.fZmixt=Y.readFastArray(Y.ntoi4(),de),E.fWmixt=Y.readFastArray(Y.ntoi4(),de)},TVirtualPerfStats:v.clTObject,TMethodCall:v.clTObject};function Cn(Y,E){gn[Y]=E}function Ln(){const Y=new Date;return Y.setFullYear(1995+(this.fDatime>>>26)),Y.setMonth((this.fDatime<<6>>>28)-1),Y.setDate(this.fDatime<<10>>>27),Y.setHours(this.fDatime<<15>>>27),Y.setMinutes(this.fDatime<<20>>>26),Y.setSeconds(this.fDatime<<26>>>26),Y.setMilliseconds(0),Y}const Zn={TQObject(){},TGraphStruct(){},TGraphNode(){},TGraphEdge(){},TDatime(Y,E){E.fDatime=Y.ntou4(),E.getDate=Ln},TKey(Y,E){E.fNbytes=Y.ntoi4(),E.fVersion=Y.ntoi2(),E.fObjlen=Y.ntou4(),E.fDatime=Y.classStreamer({},Qe),E.fKeylen=Y.ntou2(),E.fCycle=Y.ntou2(),E.fVersion>1e3?(E.fSeekKey=Y.ntou8(),Y.shift(8)):(E.fSeekKey=Y.ntou4(),Y.shift(4)),E.fClassName=Y.readTString(),E.fName=Y.readTString(),E.fTitle=Y.readTString()},TDirectory(Y,E){const J=Y.ntou2();E.fDatimeC=Y.classStreamer({},Qe),E.fDatimeM=Y.classStreamer({},Qe),E.fNbytesKeys=Y.ntou4(),E.fNbytesName=Y.ntou4(),E.fSeekDir=J>1e3?Y.ntou8():Y.ntou4(),E.fSeekParent=J>1e3?Y.ntou8():Y.ntou4(),E.fSeekKeys=J>1e3?Y.ntou8():Y.ntou4()},TBasket(Y,E){Y.classStreamer(E,v.clTKey);const J=Y.readVersion();E.fBufferSize=Y.ntoi4(),E.fNevBufSize=Y.ntoi4(),E.fNevBuf=Y.ntoi4(),E.fLast=Y.ntoi4(),E.fLast>E.fBufferSize&&(E.fBufferSize=E.fLast);const Ae=Y.ntoi1();if(0!==Ae){if(Ae%10!=2){if(E.fNevBuf&&(E.fEntryOffset=Y.readFastArray(Y.ntoi4(),re),Ae>20&&Ae<40))for(let Ce=0,He=4278190080;Ce<E.fNevBuf;++Ce)E.fEntryOffset[Ce]&=~He;Ae>40&&(E.fDisplacement=Y.readFastArray(Y.ntoi4(),re))}if(1===Ae||Ae>10){const Ce=J.val<=1?Y.ntoi4():E.fLast;if(Ce>E.fKeylen){const He=Y.extract([Y.o+E.fKeylen,Ce-E.fKeylen]);E.fBufferRef=new Zt(He,0,Y.fFile,Ce-E.fKeylen),E.fBufferRef.fTagOffset=E.fKeylen}Y.shift(Ce)}}},TRef(Y,E){Y.classStreamer(E,v.clTObject),E.fBits&cn?E.fUUID=Y.readTString():E.fPID=Y.ntou2()},"TMatrixTSym<float>":(Y,E)=>{Y.classStreamer(E,"TMatrixTBase<float>"),E.fElements=new Float32Array(E.fNelems);const J=Y.readFastArray(E.fNrows*(E.fNcols+1)/2,de);for(let Ae=0,Ce=0;Ae<E.fNrows;++Ae)for(let He=Ae;He<E.fNcols;++He)E.fElements[He*E.fNcols+Ae]=E.fElements[Ae*E.fNcols+He]=J[Ce++]},"TMatrixTSym<double>":(Y,E)=>{Y.classStreamer(E,"TMatrixTBase<double>"),E.fElements=new Float64Array(E.fNelems);const J=Y.readFastArray(E.fNrows*(E.fNcols+1)/2,K);for(let Ae=0,Ce=0;Ae<E.fNrows;++Ae)for(let He=Ae;He<E.fNcols;++He)E.fElements[He*E.fNcols+Ae]=E.fElements[Ae*E.fNcols+He]=J[Ce++]}};function ui(Y,E){switch(Y){case"bool":case"Bool_t":return O;case"char":case"signed char":case"Char_t":return L;case"Color_t":case"Style_t":case"Width_t":case"short":case"Short_t":return he;case"int":case"EErrorType":case"Int_t":return re;case"long":case"Long_t":return fe;case"float":case"Float_t":return de;case"double":case"Double_t":return K;case"unsigned char":case"UChar_t":return x;case"unsigned short":case"UShort_t":return P;case"unsigned":case"unsigned int":case"UInt_t":return w;case"unsigned long":case"ULong_t":return b;case"int64_t":case"long long":case"Long64_t":return C;case"uint64_t":case"unsigned long long":case"ULong64_t":return N;case"Double32_t":return G;case"Float16_t":return H;case"char*":case"const char*":case"const Char_t*":return ce}if(!E){const J=gn[Y];if((0,v.isStr)(J))return ui(J,!0)}return-1}function hi(Y,E,J){const Ae={_typename:V,fName:Y,fTypeName:E,fType:0,fSize:0,fArrayLength:0,fArrayDim:0,fMaxIndex:[0,0,0,0,0],fXmin:0,fXmax:0,fFactor:0};if((0,v.isStr)(E)?(Ae.fType=ui(E),Ae.fType<0&&J&&J.fBasicTypes[E]&&(Ae.fType=J.fBasicTypes[E])):(Ae.fType=E,E=Ae.fTypeName=mn[Ae.fType]||"int"),Ae.fType>0)return Ae;const Ce=E.indexOf("<");let He=pt;if(Ce>0&&E.indexOf(">")>Ce+2)for(let it=1;it<jt.length;++it)if(E.slice(0,Ce)===jt[it]){He=it;break}if(He!==pt)return Ae._typename=xe,Ae.fType=ct,Ae.fSTLtype=He,Ae.fCtype=0,Ae;const nt=E.lastIndexOf("*")===E.length-1;return nt&&(Ae.fTypeName=E=E.slice(0,E.length-1)),0===Sr(E)?(Ae.fType=k,Ae):(Ae.fType=nt?Se:I,Ae)}function qi(Y,E,J){if(!Y){if(0!==E.indexOf("pair"))return null;if(!(Y=J.findStreamerInfo(E))){let nt=function(){let it="",lt=Ce+1,qt=0;for(;lt<He&&qt>=0;){switch(E[lt]){case"<":qt++;break;case",":0===qt&&qt--;break;case">":qt--}qt>=0&&(it+=E[lt]),lt++}return Ce=lt-1,it.trim()},Ce=E.indexOf("<");const He=E.lastIndexOf(">");(Y={_typename:"TStreamerInfo",fVersion:1,fName:E,fElements:(0,v.create)(v.clTList)}).fElements.Add(hi("first",nt(),J)),Y.fElements.Add(hi("second",nt(),J))}}const Ae=J.getStreamer(E,null,Y);if(!Ae)return null;if(2!==Ae.length)return console.error(`Streamer for pair class contains ${Ae.length} elements`),null;for(let Ce=0;Ce<2;++Ce)Ae[Ce].readelem&&!Ae[Ce].pair_name&&(Ae[Ce].pair_name=0===Ce?"first":"second",Ae[Ce].func=function(He,nt){nt[this.pair_name]=this.readelem(He)});return Ae}function Mr(Y,E){const J={name:Y.fName,type:Y.fType,fArrayLength:Y.fArrayLength,fArrayDim:Y.fArrayDim,fMaxIndex:Y.fMaxIndex};switch("BASE"===Y.fTypeName&&(Sr(J.name)>0?(J.name="fArray",J.type=I):J.type=X),J.type){case X:J.base=Y.fBaseVersion,J.basename=Y.fName,J.func=function(Ae,Ce){Ae.classStreamer(Ce,this.basename)};break;case he:J.func=function(Ae,Ce){Ce[this.name]=Ae.ntoi2()};break;case re:case pe:J.func=function(Ae,Ce){Ce[this.name]=Ae.ntoi4()};break;case fe:case C:J.func=function(Ae,Ce){Ce[this.name]=Ae.ntoi8()};break;case K:J.func=function(Ae,Ce){Ce[this.name]=Ae.ntod()};break;case de:J.func=function(Ae,Ce){Ce[this.name]=Ae.ntof()};break;case D:case x:J.func=function(Ae,Ce){Ce[this.name]=Ae.ntou1()};break;case P:J.func=function(Ae,Ce){Ce[this.name]=Ae.ntou2()};break;case g:case w:J.func=function(Ae,Ce){Ce[this.name]=Ae.ntou4()};break;case N:case b:J.func=function(Ae,Ce){Ce[this.name]=Ae.ntou8()};break;case O:J.func=function(Ae,Ce){Ce[this.name]=0!==Ae.ntou1()};break;case ie+O:case ie+re:case ie+pe:case ie+K:case ie+x:case ie+he:case ie+P:case ie+g:case ie+w:case ie+b:case ie+N:case ie+fe:case ie+C:case ie+de:Y.fArrayDim<2?(J.arrlength=Y.fArrayLength,J.func=function(Ae,Ce){Ce[this.name]=Ae.readFastArray(this.arrlength,this.type-ie)}):(J.arrlength=Y.fMaxIndex[Y.fArrayDim-1],J.minus1=!0,J.func=function(Ae,Ce){Ce[this.name]=Ae.readNdimArray(this,(He,nt)=>He.readFastArray(nt.arrlength,nt.type-ie))});break;case ie+L:Y.fArrayDim<2?(J.arrlength=Y.fArrayLength,J.func=function(Ae,Ce){Ce[this.name]=Ae.readFastString(this.arrlength)}):(J.minus1=!0,J.arrlength=Y.fMaxIndex[Y.fArrayDim-1],J.func=function(Ae,Ce){Ce[this.name]=Ae.readNdimArray(this,(He,nt)=>He.readFastString(nt.arrlength))});break;case z+O:case z+re:case z+K:case z+x:case z+he:case z+P:case z+g:case z+w:case z+b:case z+N:case z+fe:case z+C:case z+de:J.cntname=Y.fCountName,J.func=function(Ae,Ce){Ce[this.name]=1===Ae.ntou1()?Ae.readFastArray(Ce[this.cntname],this.type-z):[]};break;case z+L:J.cntname=Y.fCountName,J.func=function(Ae,Ce){Ce[this.name]=1===Ae.ntou1()?Ae.readFastString(Ce[this.cntname]):null};break;case G:case ie+G:case z+G:J.double32=!0;case H:case ie+H:case z+H:0!==Y.fFactor?(J.factor=1/Y.fFactor,J.min=Y.fXmin,J.read=function(Ae){return Ae.ntou4()*this.factor+this.min}):0===Y.fXmin&&J.double32?J.read=function(Ae){return Ae.ntof()}:(J.nbits=Math.round(Y.fXmin),0===J.nbits&&(J.nbits=12),J.dv=new DataView(new ArrayBuffer(8),0),J.read=function(Ae){const Ce=Ae.ntou1(),He=Ae.ntou2();return this.dv.setUint32(0,Ce<<23|(He&(1<<this.nbits+1)-1)<<23-this.nbits),(1<<this.nbits+1&He?-1:1)*this.dv.getFloat32(0)}),J.readarr=function(Ae,Ce){const He=this.double32?new Float64Array(Ce):new Float32Array(Ce);for(let nt=0;nt<Ce;++nt)He[nt]=this.read(Ae);return He},J.type<ie?J.func=function(Ae,Ce){Ce[this.name]=this.read(Ae)}:J.type>z?(J.cntname=Y.fCountName,J.func=function(Ae,Ce){Ce[this.name]=1===Ae.ntou1()?this.readarr(Ae,Ce[this.cntname]):null}):Y.fArrayDim<2?(J.arrlength=Y.fArrayLength,J.func=function(Ae,Ce){Ce[this.name]=this.readarr(Ae,this.arrlength)}):(J.arrlength=Y.fMaxIndex[Y.fArrayDim-1],J.minus1=!0,J.func=function(Ae,Ce){Ce[this.name]=Ae.readNdimArray(this,(He,nt)=>nt.readarr(He,nt.arrlength))});break;case Se:case R:J.func=function(Ae,Ce){Ce[this.name]=Ae.readNdimArray(this,He=>He.readObjectAny())};break;case I:case ve:case A:case m:{let Ae="BASE"===Y.fTypeName?Y.fName:Y.fTypeName;"*"===Ae[Ae.length-1]&&(Ae=Ae.slice(0,Ae.length-1));const Ce=Sr(Ae);Ce>0?(J.arrkind=Ce,J.func=function(He,nt){nt[this.name]=He.readFastArray(He.ntou4(),this.arrkind)}):0===Ce?J.func=function(He,nt){nt[this.name]=He.readTString()}:(J.classname=Ae,J.func=Y.fArrayLength>1?function(He,nt){nt[this.name]=He.readNdimArray(this,(it,lt)=>it.classStreamer({},lt.classname))}:function(He,nt){nt[this.name]=He.classStreamer({},this.classname)});break}case ie+m:case ie+I:case ie+ve:case ie+A:{let Ae=Y.fTypeName;"*"===Ae[Ae.length-1]&&(Ae=Ae.slice(0,Ae.length-1)),J.arrkind=Sr(Ae),J.arrkind<0&&(J.classname=Ae),J.func=function(Ce,He){He[this.name]=Ce.readNdimArray(this,(nt,it)=>it.arrkind>0?nt.readFastArray(nt.ntou4(),it.arrkind):0===it.arrkind?nt.readTString():nt.classStreamer({},it.classname))};break}case L:J.func=function(Ae,Ce){Ce[this.name]=Ae.ntoi1()};break;case ce:J.func=function(Ae,Ce){const He=Ae.ntoi4();Ce[this.name]=Ae.substring(Ae.o,Ae.o+He),Ae.o+=He};break;case k:J.func=function(Ae,Ce){Ce[this.name]=Ae.readTString()};break;case ee:case ge:J.typename=Y.fTypeName,J.func=function(Ae,Ce){Ce[this.name]=Ae.classStreamer({},this.typename)};break;case ie+k:case ie+ee:case ie+ge:J.typename=Y.fTypeName,J.func=function(Ae,Ce){const He=Ae.readVersion();Ce[this.name]=Ae.readNdimArray(this,(nt,it)=>it.typename===v.clTString?nt.readTString():nt.classStreamer({},it.typename)),Ae.checkByteCount(He,this.typename+"[]")};break;case $:case ie+$:J.typename=Y.fTypeName,J.cntname=Y.fCountName,J.typename.lastIndexOf("**")>0?(J.typename=J.typename.slice(0,J.typename.lastIndexOf("**")),J.isptrptr=!0):(J.typename=J.typename.slice(0,J.typename.lastIndexOf("*")),J.isptrptr=!1),J.isptrptr?J.readitem=function(Ae){return Ae.readObjectAny()}:(J.arrkind=Sr(J.typename),J.readitem=J.arrkind>0?function(Ae){return Ae.readFastArray(Ae.ntou4(),this.arrkind)}:0===J.arrkind?function(Ae){return Ae.readTString()}:function(Ae){return Ae.classStreamer({},this.typename)}),void 0!==J.readitem?(J.read_loop=function(Ae,Ce){return Ae.readNdimArray(this,(He,nt)=>{const it=new Array(Ce);for(let lt=0;lt<Ce;++lt)it[lt]=nt.readitem(He);return it})},J.func=function(Ae,Ce){const He=Ae.readVersion(),nt=this.read_loop(Ae,Ce[this.cntname]);Ce[this.name]=Ae.checkByteCount(He,this.typename)?nt:null},J.branch_func=function(Ae,Ce){const He=Ae.readVersion(),nt=Ce[this.stl_size],it=new Array(nt);for(let lt=0;lt<nt;++lt)it[lt]=this.read_loop(Ae,Ce[this.cntname][lt]);Ce[this.name]=Ae.checkByteCount(He,this.typename)?it:null},J.objs_branch_func=function(Ae,Ce){const He=Ae.readVersion(),nt=Ce[this.name0];for(let it=0;it<nt.length;++it){const lt=this.get(nt,it);lt[this.name]=this.read_loop(Ae,lt[this.cntname])}Ae.checkByteCount(He,this.typename)}):(console.error(`fail to provide function for ${Y.fName} (${Y.fTypeName})  typ = ${Y.fType}`),J.func=function(Ae,Ce){const He=Ae.readVersion();Ae.checkByteCount(He),Ce[this.name]=null});break;case ct:{J.typename=Y.fTypeName;const Ae=(Y.fSTLtype||0)%40;if("TStreamerSTLstring"===Y._typename||"string"===J.typename||"string*"===J.typename)J.readelem=Ce=>Ce.readTString();else if(Ae===dt||Ae===rt||Ae===_t||Ae===Tt||Ae===fn){const Ce=J.typename.indexOf("<"),He=J.typename.lastIndexOf(">");if(J.conttype=J.typename.slice(Ce+1,He).trim(),J.typeid=ui(J.conttype),J.typeid<0&&E.fBasicTypes[J.conttype]&&(J.typeid=E.fBasicTypes[J.conttype],console.log(`!!! Reuse basic type ${J.conttype} from file streamer infos`)),Y.fCtype&&Y.fCtype<20&&Y.fCtype!==J.typeid&&(console.warn(`Contained type ${J.conttype} not recognized as basic type ${Y.fCtype} FORCE`),J.typeid=Y.fCtype),J.typeid>0)J.readelem=function(nt){return nt.readFastArray(nt.ntoi4(),this.typeid)};else if(J.isptr=!1,J.conttype.lastIndexOf("*")===J.conttype.length-1&&(J.isptr=!0,J.conttype=J.conttype.slice(0,J.conttype.length-1)),Y.fCtype===A&&(J.isptr=!0),J.arrkind=Sr(J.conttype),J.readelem=ai,!J.isptr&&J.arrkind<0){const nt=hi("temp",J.conttype);nt.fType===ct&&(nt.$fictional=!0,J.submember=Mr(nt,E))}}else if(Ae===Yt||Ae===kt){const Ce=J.typename.indexOf("<"),He=J.typename.lastIndexOf(">");J.pairtype="pair<"+J.typename.slice(Ce+1,He)+">",J.si=E.findStreamerInfo(J.pairtype),J.streamer=qi(J.si,J.pairtype,E),(!J.streamer||2!==J.streamer.length)&&(console.error(`Fail to build streamer for pair ${J.pairtype}`),delete J.streamer),J.streamer&&(J.readelem=$n)}else Ae===ln&&(J.readelem=Ce=>Ce.readFastArray(Ce.ntou4(),O));J.readelem?Y.$fictional||(J.read_version=function(Ce,He){if(0===He)return null;const nt=Ce.readVersion();return this.member_wise=!!(nt.val&ht),this.stl_version=void 0,this.member_wise&&(nt.val=nt.val&~ht,this.stl_version={val:Ce.ntoi2()},this.stl_version.val<=0&&(this.stl_version.checksum=Ce.ntou4())),nt},J.func=function(Ce,He){const nt=this.read_version(Ce);let it=Ce.readNdimArray(this,(lt,qt)=>qt.readelem(lt));Ce.checkByteCount(nt,this.typename)||(it=null),He[this.name]=it},J.branch_func=function(Ce,He){const nt=He[this.stl_size],it=this.read_version(Ce,nt),lt=new Array(nt);for(let qt=0;qt<nt;++qt)lt[qt]=Ce.readNdimArray(this,(at,Jt)=>Jt.readelem(at));it&&Ce.checkByteCount(it,`branch ${this.typename}`),He[this.name]=lt},J.split_func=function(Ce,He,nt){const it=this.read_version(Ce);for(let lt=0;lt<nt;++lt)He[lt][this.name]=Ce.readNdimArray(this,(qt,at)=>at.readelem(qt));Ce.checkByteCount(it,this.typename)},J.objs_branch_func=function(Ce,He){const nt=He[this.name0],it=this.read_version(Ce,nt.length);for(let lt=0;lt<nt.length;++lt)this.get(nt,lt)[this.name]=Ce.readNdimArray(this,(at,Jt)=>Jt.readelem(at));it&&Ce.checkByteCount(it,`branch ${this.typename}`)}):(console.error(`failed to create streamer for element ${J.typename} ${J.name} element ${Y._typename} STL type ${Y.fSTLtype}`),J.func=function(Ce,He){const nt=Ce.readVersion();Ce.checkByteCount(nt),He[this.name]=null});break}default:console.error(`fail to provide function for ${Y.fName} (${Y.fTypeName})  typ = ${Y.fType}`),J.func=function(){}}return J}function Sr(Y){if(Y===v.clTString||"string"===Y||gn[Y]===v.clTString)return 0;if(Y.length<7||0!==Y.indexOf("TArray"))return-1;if(7===Y.length)switch(Y[6]){case"I":return re;case"D":return K;case"F":return de;case"S":return he;case"C":return L;case"L":return fe;default:return-1}return"TArrayL64"===Y?C:-1}function ms(Y,E){if(null===E)return E;const J=(0,v.getMethods)(Y);if(J)for(const Ae in J)((0,v.isFunc)(J[Ae])||0===Ae.indexOf("_"))&&E.push({name:Ae,method:J[Ae],func(Ce,He){He[this.name]=this.method}});return E}const fs=32768,wt=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],me=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Be=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],gt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function Et(Y,E){const J=new Array(2*fs),Ae=Y,Ce=Y.byteLength;let it,lt,qt,bt,Ot,_n,He=0,nt=null,at=0,Jt=0,tn=-1,An=!1,ze=0,$e=0,ut=null,en=0;function rn(_s){for(;Jt<_s;)en<Ce&&(at|=Ae[en++]<<Jt),Jt+=8}function Tn(_s){return at&wt[_s]}function In(_s){at>>=_s,Jt-=_s}function Xn(_s,Ls,pn,Hn,Vt,Gi){const Nn={status:0,root:null,m:0},tr=Array(17).fill(0),ws=Array(17).fill(0),jr=Array(16).fill(null),bs=Array(288).fill(0),ks=Array(17).fill(0),Zo={e:0,b:0,n:0,t:null},Va=Ls>256?_s[256]:16;let Vu,cd,Da,Aa,Gu,Yc,Xa,fh,qu,ph,Md,Th=null,bc=_s,lc=0,Ga=null,No=Ls;do{tr[bc[lc++]]++}while(--No>0);if(tr[0]===Ls)return Nn;for(Aa=1;Aa<=16&&0===tr[Aa];++Aa);for(Gu=Aa,Gi<Aa&&(Gi=Aa),No=16;0!==No&&0===tr[No];--No);const nf=No;for(Gi>No&&(Gi=No),qu=1<<Aa;Aa<No;++Aa,qu<<=1)if((qu-=tr[Aa])<0)return Nn.status=2,Nn.m=Gi,Nn;if((qu-=tr[No])<0)return Nn.status=2,Nn.m=Gi,Nn;for(tr[No]+=qu,ks[1]=Aa=0,bc=tr,lc=1,fh=2;--No>0;)ks[fh++]=Aa+=bc[lc++];bc=_s,lc=0,No=0;do{0!==(Aa=bc[lc++])&&(bs[ks[Aa]++]=No)}while(++No<Ls);for(Ls=ks[nf],ks[0]=No=0,bc=bs,lc=0,Da=-1,Xa=ws[0]=0,Yc=null,ph=0;Gu<=nf;++Gu)for(Vu=tr[Gu];Vu-- >0;){for(;Gu>Xa+ws[1+Da];){if(Xa+=ws[1+Da++],ph=(ph=nf-Xa)>Gi?Gi:ph,(cd=1<<(Aa=Gu-Xa))>Vu+1)for(cd-=Vu+1,fh=Gu;++Aa<ph&&!((cd<<=1)<=tr[++fh]);)cd-=tr[fh];for(Xa+Aa>Va&&Xa<Va&&(Aa=Va-Xa),ph=1<<Aa,ws[1+Da]=Aa,Yc=new Array(ph),Md=0;Md<ph;++Md)Yc[Md]={e:0,b:0,n:0,t:null};Ga=null==Ga?Nn.root={next:null,list:null}:Ga.next={next:null,list:null},Ga.next=null,Ga.list=Yc,jr[Da]=Yc,Da>0&&(ks[Da]=No,Zo.b=ws[Da],Zo.e=16+Aa,Zo.t=Yc,Aa=(No&(1<<Xa)-1)>>Xa-ws[Da],Th=jr[Da-1][Aa],Th.e=Zo.e,Th.b=Zo.b,Th.n=Zo.n,Th.t=Zo.t)}for(Zo.b=Gu-Xa,lc>=Ls?Zo.e=99:bc[lc]<pn?(Zo.e=bc[lc]<256?16:15,Zo.n=bc[lc++]):(Zo.e=Vt[bc[lc]-pn],Zo.n=Hn[bc[lc++]-pn]),cd=1<<Gu-Xa,Aa=No>>Xa;Aa<ph;Aa+=cd)Th=Yc[Aa],Th.e=Zo.e,Th.b=Zo.b,Th.n=Zo.n,Th.t=Zo.t;for(Aa=1<<Gu-1;No&Aa;Aa>>=1)No^=Aa;for(No^=Aa;(No&(1<<Xa)-1)!==ks[Da];)Xa-=ws[Da--]}return Nn.m=ws[1],Nn.status=0!==qu&&1!==nf?1:0,Nn}function Ri(_s,Ls,pn){if(0===pn)return 0;let Hn,Vt,Gi=0;for(;;){for(rn(Ot),Vt=ut.list[Tn(Ot)],Hn=Vt.e;Hn>16;){if(99===Hn)return-1;In(Vt.b),Hn-=16,rn(Hn),Vt=Vt.t[Tn(Hn)],Hn=Vt.e}if(In(Vt.b),16!==Hn){if(15===Hn)break;for(rn(Hn),ze=Vt.n+Tn(Hn),In(Hn),rn(_n),Vt=bt.list[Tn(_n)],Hn=Vt.e;Hn>16;){if(99===Hn)return-1;In(Vt.b),Hn-=16,rn(Hn),Vt=Vt.t[Tn(Hn)],Hn=Vt.e}for(In(Vt.b),rn(Hn),$e=He-Vt.n-Tn(Hn),In(Hn);ze>0&&Gi<pn;)--ze,$e&=fs-1,He&=fs-1,_s[Ls+Gi++]=J[He++]=J[$e++];if(Gi===pn)return pn}else if(He&=fs-1,_s[Ls+Gi++]=J[He++]=Vt.n,Gi===pn)return pn}return tn=-1,Gi}function Wi(_s,Ls,pn){let Hn=7&Jt;if(In(Hn),rn(16),Hn=Tn(16),In(16),rn(16),Hn!==(65535&~at))return-1;for(In(16),ze=Hn,Hn=0;ze>0&&Hn<pn;)--ze,He&=fs-1,rn(8),_s[Ls+Hn++]=J[He++]=Tn(8),In(8);return 0===ze&&(tn=-1),Hn}function Ti(_s,Ls,pn){if(null==nt){const Hn=Array(288).fill(8,0,144).fill(9,144,256).fill(7,256,280).fill(8,280,288);lt=7;let Vt=Xn(Hn,288,257,W,me,lt);if(0!==Vt.status)throw new Error("HufBuild error: "+Vt.status);if(nt=Vt.root,lt=Vt.m,Hn.fill(5,0,30),qt=5,Vt=Xn(Hn,30,0,_e,Be,qt),Vt.status>1)throw nt=null,new Error("HufBuild error: "+Vt.status);it=Vt.root,qt=Vt.m}return ut=nt,bt=it,Ot=lt,_n=qt,Ri(_s,Ls,pn)}function Tr(_s,Ls,pn){let Hn,Vt,Gi,Nn,zn;const dr=new Array(316).fill(0);rn(5);const tr=257+Tn(5);In(5),rn(5);const ws=1+Tn(5);In(5),rn(4);const jr=4+Tn(4);if(In(4),tr>286||ws>30)return-1;for(Vt=0;Vt<jr;++Vt)rn(3),dr[gt[Vt]]=Tn(3),In(3);for(;Vt<19;++Vt)dr[gt[Vt]]=0;if(Ot=7,zn=Xn(dr,19,19,null,null,Ot),0!==zn.status)return-1;ut=zn.root,Ot=zn.m;const bs=tr+ws;for(Hn=Gi=0;Hn<bs;)if(rn(Ot),Nn=ut.list[Tn(Ot)],Vt=Nn.b,In(Vt),Vt=Nn.n,Vt<16)dr[Hn++]=Gi=Vt;else if(16===Vt){if(rn(2),Vt=3+Tn(2),In(2),Hn+Vt>bs)return-1;for(;Vt-- >0;)dr[Hn++]=Gi}else if(17===Vt){if(rn(3),Vt=3+Tn(3),In(3),Hn+Vt>bs)return-1;for(;Vt-- >0;)dr[Hn++]=0;Gi=0}else{if(rn(7),Vt=11+Tn(7),In(7),Hn+Vt>bs)return-1;for(;Vt-- >0;)dr[Hn++]=0;Gi=0}if(Ot=9,zn=Xn(dr,tr,257,W,me,Ot),0===Ot&&(zn.status=1),0!==zn.status)return-1;for(ut=zn.root,Ot=zn.m,Hn=0;Hn<ws;++Hn)dr[Hn]=dr[Hn+tr];return _n=6,zn=Xn(dr,ws,0,_e,Be,_n),bt=zn.root,_n=zn.m,0===_n&&tr>257||0!==zn.status?-1:Ri(_s,Ls,pn)}function Qr(_s,Ls,pn){let Vt,Hn=0;for(;Hn<pn;){if(An&&-1===tn)return Hn;if(ze>0){if(0!==tn)for(;ze>0&&Hn<pn;)--ze,$e&=fs-1,He&=fs-1,_s[Ls+Hn++]=J[He++]=J[$e++];else{for(;ze>0&&Hn<pn;)--ze,He&=fs-1,rn(8),_s[Ls+Hn++]=J[He++]=Tn(8),In(8);0===ze&&(tn=-1)}if(Hn===pn)return Hn}if(-1===tn){if(An)break;rn(1),0!==Tn(1)&&(An=!0),In(1),rn(2),tn=Tn(2),In(2),ut=null,ze=0}switch(tn){case 0:Vt=Wi(_s,Ls+Hn,pn-Hn);break;case 1:Vt=null!=ut?Ri(_s,Ls+Hn,pn-Hn):Ti(_s,Ls+Hn,pn-Hn);break;case 2:Vt=null!=ut?Ri(_s,Ls+Hn,pn-Hn):Tr(_s,Ls+Hn,pn-Hn);break;default:Vt=-1}if(-1===Vt)return An?0:-1;Hn+=Vt}return Hn}let yo,Go=0;for(;(yo=Qr(E,Go,Math.min(1024,E.byteLength-Go)))>0;)Go+=yo;return Go}function Mt(Y,E,J,Ae){let Ce=0;for(let He=J=J||0,nt=Ae=Ae||Y.length-J;He<nt;){const it=Y[He++];let lt=it>>4;if(lt>0){let ze=lt+240;for(;255===ze;)ze=Y[He++],lt+=ze;const $e=He+lt;for(;He<$e;)E[Ce++]=Y[He++];if(He===nt)return Ce}const qt=Y[He++]|Y[He++]<<8;if(0===qt||qt>Ce)return-(He-2);let at=15&it,Jt=at+240;for(;255===Jt;)Jt=Y[He++],at+=Jt;let tn=Ce-qt;const An=Ce+at+4;for(;Ce<An;)E[Ce++]=E[tn++]}return Ce}function Nt(Y,E,J,Ae){return Qt.apply(this,arguments)}function Qt(){return(Qt=(0,be.A)(function*(Y,E,J,Ae){const He=Y.byteLength,nt=(tn,An)=>String.fromCharCode(Y.getUint8(tn))===An,it=tn=>Y.getUint8(tn);let lt=Ae||0,qt=0,at=null;const Jt=()=>{for(;qt<E;){let tn="unknown",An=0,ze=0;if(lt+9>=He)return J||console.error("Error R__unzip: header size exceeds buffer size"),Promise.resolve(null);if(nt(lt,"Z")&&nt(lt+1,"L")&&8===it(lt+2)?(tn="new",An=2):nt(lt,"C")&&nt(lt+1,"S")&&8===it(lt+2)?(tn="old",An=0):nt(lt,"X")&&nt(lt+1,"Z")&&0===it(lt+2)?(tn="LZMA",An=0):nt(lt,"Z")&&nt(lt+1,"S")&&1===it(lt+2)?tn="ZSTD":nt(lt,"L")&&nt(lt+1,"4")&&(tn="LZ4",An=0,ze=8),"new"!==tn&&"old"!==tn&&"LZ4"!==tn&&"ZSTD"!==tn&&"LZMA"!==tn)return J||console.error(`R__unzip: ${tn} format is not supported!`),Promise.resolve(null);const $e=9+(255&it(lt+3)|(255&it(lt+4))<<8|(255&it(lt+5))<<16),ut=new Uint8Array(Y.buffer,Y.byteOffset+lt+9+An+ze,Math.min(Y.byteLength-lt-9-An-ze,$e-9-ze));at||(at=new ArrayBuffer(E));const bt=new Uint8Array(at,qt);if("ZSTD"===tn){let _n;return v.internals._ZstdStream?_n=Promise.resolve(v.internals._ZstdStream):void 0!==v.internals._ZstdInit?_n=new Promise(en=>{v.internals._ZstdInit.push(en)}):(v.internals._ZstdInit=[],_n=((0,v.isNodeJs)()?Te.e(817).then(Te.t.bind(Te,9817,19)):Te.e(786).then(Te.bind(Te,7786))).then(({ZstdInit:en})=>en()).then(({ZstdStream:en})=>(v.internals._ZstdStream=en,v.internals._ZstdInit.forEach(rn=>rn(en)),delete v.internals._ZstdInit,en))),_n.then(en=>{const rn=en.decompress(ut),Tn=rn.length;for(let In=0;In<Tn;++In)bt[In]=rn[In];return qt+=Tn,lt+=$e,Jt()})}if("LZMA"===tn)return Te.e(947).then(Te.bind(Te,5947)).then(_n=>{const en=255&it(lt+6)|(255&it(lt+7))<<8|(255&it(lt+8))<<16,rn=_n.decompress(ut,bt,en);return qt+=rn,lt+=$e,Jt()});const Ot="LZ4"===tn?Mt(ut,bt):Et(ut,bt);if(Ot<=0)break;qt+=Ot,lt+=$e}return qt!==E?(J||console.error(`R__unzip: fail to unzip data expects ${E}, got ${qt}`),Promise.resolve(null)):Promise.resolve(new DataView(at))};return Jt()})).apply(this,arguments)}class Zt{constructor(E,J,Ae,Ce){this._typename="TBuffer",this.arr=E,this.o=J||0,this.fFile=Ae,this.length=Ce||(E?E.byteLength:0),this.clearObjectMap(),this.fTagOffset=0,this.last_read_version=0}locate(E){this.o=E}shift(E){this.o+=E}remain(){return this.length-this.o}getMappedObject(E){return this.fObjectMap[E]}mapObject(E,J){null!==J&&(this.fObjectMap[E]=J)}mapClass(E,J){this.fClassMap[E]=J}getMappedClass(E){return E in this.fClassMap?this.fClassMap[E]:-1}clearObjectMap(){this.fObjectMap={},this.fClassMap={},this.fObjectMap[0]=null,this.fDisplacement=0}readVersion(){const E={},J=this.ntou4();return J&We?E.bytecnt=J-We-2:this.o-=4,this.last_read_version=E.val=this.ntoi2(),this.last_read_checksum=0,E.off=this.o,E.val<=0&&E.bytecnt&&E.bytecnt>=4&&(E.checksum=this.ntou4(),this.fFile.findStreamerInfo(void 0,void 0,E.checksum)?this.last_read_checksum=E.checksum:(this.o-=4,delete E.checksum)),E}checkByteCount(E,J){return void 0===E.bytecnt||E.off+E.bytecnt===this.o||(J&&console.log(`Missmatch in ${J} bytecount expected = ${E.bytecnt}  got = ${this.o-E.off}`),this.o=E.off+E.bytecnt,!1)}readTString(){let E=this.ntou1();if(255===E&&(E=this.ntou4()),0===E)return"";const J=this.o;return this.o+=E,0===this.codeAt(J)?"":this.substring(J,J+E)}readFastString(E){let Ae,J="",Ce=!1;for(let He=0;(E<0||He<E)&&(Ae=this.ntou1(),!(0===Ae&&(Ce=!0,E<0)));++He)Ce||(J+=String.fromCharCode(Ae));return J}ntou1(){return this.arr.getUint8(this.o++)}ntou2(){const E=this.o;return this.o+=2,this.arr.getUint16(E)}ntou4(){const E=this.o;return this.o+=4,this.arr.getUint32(E)}ntou8(){const E=this.arr.getUint32(this.o);this.o+=4;const J=this.arr.getUint32(this.o);return this.o+=4,E<2097152?4294967296*E+J:BigInt(E)*BigInt(4294967296)+BigInt(J)}ntoi1(){return this.arr.getInt8(this.o++)}ntoi2(){const E=this.o;return this.o+=2,this.arr.getInt16(E)}ntoi4(){const E=this.o;return this.o+=4,this.arr.getInt32(E)}ntoi8(){const E=this.arr.getUint32(this.o);this.o+=4;const J=this.arr.getUint32(this.o);return this.o+=4,E<2147483648?E<2097152?4294967296*E+J:BigInt(E)*BigInt(4294967296)+BigInt(J):~E<2097152?-1-(4294967296*~E+~J):BigInt(-1)-(BigInt(~E)*BigInt(4294967296)+BigInt(~J))}ntof(){const E=this.o;return this.o+=4,this.arr.getFloat32(E)}ntod(){const E=this.o;return this.o+=8,this.arr.getFloat64(E)}readFastArray(E,J){let Ae,Ce=0,He=this.o;const nt=this.arr;switch(J){case K:for(Ae=new Float64Array(E);Ce<E;++Ce,He+=8)Ae[Ce]=nt.getFloat64(He);break;case de:for(Ae=new Float32Array(E);Ce<E;++Ce,He+=4)Ae[Ce]=nt.getFloat32(He);break;case fe:case C:for(Ae=new Array(E);Ce<E;++Ce)Ae[Ce]=this.ntoi8();return Ae;case b:case N:for(Ae=new Array(E);Ce<E;++Ce)Ae[Ce]=this.ntou8();return Ae;case re:case pe:for(Ae=new Int32Array(E);Ce<E;++Ce,He+=4)Ae[Ce]=nt.getInt32(He);break;case he:for(Ae=new Int16Array(E);Ce<E;++Ce,He+=2)Ae[Ce]=nt.getInt16(He);break;case P:for(Ae=new Uint16Array(E);Ce<E;++Ce,He+=2)Ae[Ce]=nt.getUint16(He);break;case L:for(Ae=new Int8Array(E);Ce<E;++Ce)Ae[Ce]=nt.getInt8(He++);break;case O:case x:for(Ae=new Uint8Array(E);Ce<E;++Ce)Ae[Ce]=nt.getUint8(He++);break;case k:for(Ae=new Array(E);Ce<E;++Ce)Ae[Ce]=this.readTString();return Ae;case G:throw new Error("kDouble32 should not be used in readFastArray");case H:throw new Error("kFloat16 should not be used in readFastArray");default:for(Ae=new Uint32Array(E);Ce<E;++Ce,He+=4)Ae[Ce]=nt.getUint32(He)}return this.o=He,Ae}canExtract(E){for(let J=0;J<E.length;J+=2)if(E[J]+E[J+1]>this.length)return!1;return!0}extract(E){if(!this.arr||!this.arr.buffer||!this.canExtract(E))return null;if(2===E.length)return new DataView(this.arr.buffer,this.arr.byteOffset+E[0],E[1]);const J=new Array(E.length/2);for(let Ae=0;Ae<E.length;Ae+=2)J[Ae/2]=new DataView(this.arr.buffer,this.arr.byteOffset+E[Ae],E[Ae+1]);return J}codeAt(E){return this.arr.getUint8(E)}substring(E,J){let Ae="";for(let Ce=E;Ce<J;++Ce)Ae+=String.fromCharCode(this.arr.getUint8(Ce));return Ae}readNdimArray(E,J){let He,Ae=E.fArrayDim,Ce=E.fMaxIndex;if(Ae<1&&E.fArrayLength>0&&(Ae=1,Ce=[E.fArrayLength]),E.minus1&&--Ae,Ae<1)return J(this,E);if(1===Ae){He=new Array(Ce[0]);for(let nt=0;nt<Ce[0];++nt)He[nt]=J(this,E)}else if(2===Ae){He=new Array(Ce[0]);for(let nt=0;nt<Ce[0];++nt){const it=new Array(Ce[1]);for(let lt=0;lt<Ce[1];++lt)it[lt]=J(this,E);He[nt]=it}}else{const nt=new Array(Ae).fill(0),it=new Array(Ae);for(let lt=0;lt<Ae;++lt)it[lt]=[];for(He=it[0];nt[0]<Ce[0];){let lt=Ae-1;for(it[lt].push(J(this,E)),++nt[lt];nt[lt]===Ce[lt]&&lt>0;)nt[lt]=0,it[lt-1].push(it[lt]),it[lt]=[],++nt[--lt]}}return He}readTKey(E){E||(E={}),this.classStreamer(E,v.clTKey);const J=E.fName.replace(/['"]/g,"");return J!==E.fName&&(E.fRealName=E.fName,E.fName=J),E}readBasketEntryOffset(E,J){if(this.locate(E.fLast-J),this.remain()<=0)return!E.fEntryOffset&&E.fNevBuf<=1&&(E.fEntryOffset=[E.fKeylen]),void(E.fEntryOffset||console.warn(`No fEntryOffset when expected for basket with ${E.fNevBuf} entries`));const Ae=this.ntoi4();if(Ae<0||Ae>4*this.remain())return console.error(`Error when reading entries offset from basket fNevBuf ${E.fNevBuf} remains ${this.remain()} want to read ${Ae}`),void(E.fNevBuf<=1&&(E.fEntryOffset=[E.fKeylen]));E.fEntryOffset=this.readFastArray(Ae,re),E.fEntryOffset||(E.fEntryOffset=[E.fKeylen]),E.fDisplacement=this.remain()>0?this.readFastArray(this.ntoi4(),re):void 0}readClass(){const E={name:-1},J=this.ntou4(),Ae=this.o;let Ce;if(Ce=J&We&&J!==Ne?this.ntou4():J,!(Ce&Fe))return E.objtag=Ce+this.fDisplacement,E;if(Ce===Ne)E.name=this.readFastString(-1),-1===this.getMappedClass(this.fTagOffset+Ae+2)&&this.mapClass(this.fTagOffset+Ae+2,E.name);else{const He=(Ce&~Fe)+this.fDisplacement;E.name=this.getMappedClass(He),-1===E.name&&console.error(`Did not found class with tag ${He}`)}return E}readObjectAny(){const E=this.fTagOffset+this.o+2,J=this.readClass();if("objtag"in J)return this.getMappedObject(J.objtag);if(-1===J.name)return null;const Ae=Sr(J.name);let Ce;return 0===Ae?Ce=this.readTString():Ae>0?(Ce=this.readFastArray(this.ntou4(),Ae),this.mapObject(E,Ce)):(Ce={},this.mapObject(E,Ce),this.classStreamer(Ce,J.name)),Ce}classStreamer(E,J){void 0===E._typename&&(E._typename=J);const Ae=Zn[J];if(Ae)return Ae(this,E),E;const Ce=this.readVersion(),He=this.fFile.getStreamer(J,Ce);if(null!==He){const nt=He.length;for(let it=0;it<nt;++it)He[it].func(this,E)}else(0,v.addMethods)(E);return this.checkByteCount(Ce,J),E}}class dn{constructor(E,J,Ae){this.fFile=E,this._typename=st,this.dir_name=J,this.dir_cycle=Ae,this.fKeys=[]}getKey(E,J,Ae){"number"!=typeof J&&(J=-1);let Ce=null;for(let nt=0;nt<this.fKeys.length;++nt){const it=this.fKeys[nt];if(it&&it.fName===E){if(it.fCycle===J){Ce=it;break}J<0&&(!Ce||it.fCycle>Ce.fCycle)&&(Ce=it)}}if(Ce)return Ae?Ce:Promise.resolve(Ce);let He=E.lastIndexOf("/");for(;He>0;){const nt=E.slice(0,He),it=E.slice(He+1),lt=this.getKey(nt,void 0,!0);if(lt&&!Ae&&0===lt.fClassName.indexOf(st))return this.fFile.readObject(this.dir_name+"/"+nt,1).then(qt=>qt.getKey(it,J));He=E.lastIndexOf("/",He-1)}return Ae?null:Promise.reject(Error(`Key not found ${E}`))}readObject(E,J){return this.fFile.readObject(this.dir_name+"/"+E,J)}readKeys(E){var J=this;return(0,be.A)(function*(){return E.classStreamer(J,st),J.fSeekKeys<=0||J.fNbytesKeys<=0?J:J.fFile.readBuffer([J.fSeekKeys,J.fNbytesKeys]).then(Ae=>{const Ce=new Zt(Ae,0,J.fFile);Ce.readTKey();const He=Ce.ntoi4();for(let nt=0;nt<He;++nt)J.fKeys.push(Ce.readTKey());return J.fFile.fDirectories.push(J),J})})()}}class vn{constructor(E){if(this._typename=v.clTFile,this.fEND=0,this.fFullURL=E,this.fURL=E,this.fAcceptRanges=!0,this.fUseStampPar=!!v.settings.UseStamp&&"stamp="+(new Date).getTime(),this.fFileContent=null,this.fMaxRanges=v.settings.MaxRanges||200,this.fDirectories=[],this.fKeys=[],this.fSeekInfo=0,this.fNbytesInfo=0,this.fTagOffset=0,this.fStreamers=0,this.fStreamerInfos=null,this.fFileName="",this.fStreamers=[],this.fBasicTypes={},!(0,v.isStr)(this.fURL))return this;"+"===this.fURL[this.fURL.length-1]&&(this.fURL=this.fURL.slice(0,this.fURL.length-1),this.fAcceptRanges=!1),"^"===this.fURL[this.fURL.length-1]&&(this.fURL=this.fURL.slice(0,this.fURL.length-1),this.fSkipHeadRequest=!0),"-"===this.fURL[this.fURL.length-1]&&(this.fURL=this.fURL.slice(0,this.fURL.length-1),this.fUseStampPar=!1),0===this.fURL.indexOf("file://")&&(this.fUseStampPar=!1,this.fAcceptRanges=!1);const J=Math.max(this.fURL.lastIndexOf("/"),this.fURL.lastIndexOf("\\"));this.fFileName=J>=0?this.fURL.slice(J+1):this.fURL}assignFileContent(E){this.fFileContent=new Zt(new DataView(E)),this.fAcceptRanges=!1,this.fUseStampPar=!1,this.fEND=this.fFileContent.length}_open(){var E=this;return(0,be.A)(function*(){return E.readKeys()})()}readBuffer(E,J,Ae){var Ce=this;return(0,be.A)(function*(){if(null!==Ce.fFileContent&&!J&&(!Ce.fAcceptRanges||Ce.fFileContent.canExtract(E)))return Ce.fFileContent.extract(E);let He,nt;const it=Ce,lt=0===E[0]&&2===E.length,qt=[],at=new Promise((Ot,_n)=>{He=Ot,nt=_n});let ze,$e,Jt=it.fURL,tn=0,An=0,ut=!1;if((0,v.isStr)(J)&&J){const Ot=Jt.lastIndexOf("/");Jt=Ot<0?J:Jt.slice(0,Ot+1)+J}function bt(Ot){if(Ot&&(tn=An,An=Math.min(tn+2*it.fMaxRanges,E.length),tn>=E.length))return He(qt);let _n=Jt,en="bytes",rn=0;it.fUseStampPar&&(_n+=(_n.indexOf("?")<0?"?":"&")+it.fUseStampPar);for(let Tn=tn;Tn<An;Tn+=2)en+=(Tn>tn?",":"=")+`${E[Tn]}-${E[Tn]+E[Tn+1]-1}`,rn+=E[Tn+1];return An-tn>2&&(rn+=60*(An-tn)),it.fAcceptRanges&&lt&&(rn=Math.max(rn,1e7)),(0,v.createHttpRequest)(_n,"buf",ze,void 0,!0).then(Tn=>{if(it.fAcceptRanges&&(Tn.setRequestHeader("Range",en),Tn.expected_size=Math.max(Math.round(1.1*rn),rn+200)),(0,v.isFunc)(Ae)&&(0,v.isFunc)(Tn.addEventListener)){let In=0,Xn=0,Ri=0;for(let Tr=1;Tr<E.length;Tr+=2)Ri+=E[Tr],Tr<tn&&(In+=E[Tr]),Tr<An&&(Xn+=E[Tr]);Ri||(Ri=1);const Wi=In/Ri,Ti=(Xn-In)/Ri;Tn.addEventListener("progress",Tr=>{Tr.lengthComputable&&"break"===Ae(Wi+Ti*Tr.loaded/Tr.total)&&Tn.abort()})}else ut&&(0,v.isFunc)(Tn.addEventListener)&&Tn.addEventListener("progress",In=>{In.total?In.total>5e7&&(console.error(`Try to load very large file ${In.total} at once - abort`),Tn.abort()):console.warn("Fail to get file size information")});$e=lt?Tn:null,Tn.send(null)})}return ze=function(Ot){if(!Ot&&lt){if(it.fUseStampPar)return it.fUseStampPar=!1,bt();if(it.fAcceptRanges)return it.fAcceptRanges=!1,ut=!0,bt()}if(Ot&&$e){it.fAcceptRanges&&206===$e.status&&Ot?.byteLength===E[1]&&!$e.getResponseHeader("Content-Range")&&it.fMaxRanges>1&&(console.warn('Server response with 206 code but browser does not provide access to Content-Range header - setting fMaxRanges = 1, consider to load full file with "filename.root+" argument or adjust server configurations'),it.fMaxRanges=1);const Wi=v.browser.isFirefox?$e.getResponseHeader("Server"):"";(0,v.isStr)(Wi)&&0===Wi.indexOf("SimpleHTTP")&&(it.fMaxRanges=1,it.fUseStampPar=!1)}if(Ot&&lt&&!it.fFileContent)return it.fFileContent=new Zt((0,v.isStr)(Ot)?Ot:new DataView(Ot)),it.fAcceptRanges||(it.fEND=it.fFileContent.length),He(it.fFileContent.extract(E));if(!Ot)return 0===tn&&An>2&&it.fMaxRanges>1?(it.fMaxRanges=An/2>200?200:An/2>50?50:An/2>20?20:An/2>5?5:1,An=Math.min(An,2*it.fMaxRanges),bt()):nt(Error("Fail to read with several ranges"));if(An-tn==2){const Wi=new DataView(Ot);return 2===E.length?He(Wi):(qt.push(Wi),bt(!0))}const _n=this.getResponseHeader("Content-Type"),en=(0,v.isStr)(_n)&&_n.indexOf("multipart")>=0,rn=new DataView(Ot);if(!en){const Wi=this.getResponseHeader("Content-Range");let Ti=0,Tr=-1;if((0,v.isStr)(Wi)&&Wi.indexOf("bytes")>=0){const yo=Wi.slice(Wi.indexOf("bytes")+6).split(/[\s-/]+/);3===yo.length&&(Ti=Number.parseInt(yo[0]),Tr=Number.parseInt(yo[1]),(!Number.isInteger(Ti)||!Number.isInteger(Tr)||Ti>Tr)&&(Ti=0,Tr=-1))}let Qr=Ti<=Tr;for(let yo=tn;yo<An;yo+=2)(E[yo]<Ti||E[yo]+E[yo+1]-1>Tr)&&(Qr=!1);if(Qr){for(let yo=tn;yo<An;yo+=2)qt.push(new DataView(Ot,E[yo]-Ti,E[yo+1]));return bt(!0)}return 1===it.fMaxRanges||0!==tn?nt(Error("Server returns normal response when multipart was requested, disable multirange support")):(it.fMaxRanges=1,An=Math.min(An,2*it.fMaxRanges),bt())}const Tn=_n.indexOf("boundary=");let In="",Xn=tn,Ri=0;for(Tn>0?(In=_n.slice(Tn+9),'"'===In[0]&&'"'===In[In.length-1]&&(In=In.slice(1,In.length-1)),In="--"+In):console.error("Did not found boundary id in the response header");Xn<An;){let Wi,Ti=rn.getUint8(Ri),Tr=0,Qr="",yo=!1,Go=0,_s=-1;for(;Ri<rn.byteLength-1&&!yo&&Tr<5;){if(Wi=Ti,Ti=rn.getUint8(Ri+1),13===Wi&&10===Ti||10===Wi){if(Qr.length>2&&"--"===Qr.slice(0,2)&&Qr!==In)return nt(Error(`Decode multipart message, expect boundary ${In} got ${Qr}`));if(Qr=Qr.toLowerCase(),Qr.indexOf("content-range")>=0&&Qr.indexOf("bytes")>0){const Ls=Qr.slice(Qr.indexOf("bytes")+6).split(/[\s-/]+/);3===Ls.length?(Go=Number.parseInt(Ls[0]),_s=Number.parseInt(Ls[1]),(!Number.isInteger(Go)||!Number.isInteger(_s)||Go>_s)&&(Go=0,_s=-1)):console.error(`Fail to decode content-range ${Qr} ${Ls}`)}Tr>1&&0===Qr.length&&(yo=!0),Tr++,Qr="",10!==Wi&&(Ri++,Ti=rn.getUint8(Ri+1))}else Qr+=String.fromCharCode(Wi);Ri++}if(!yo)return nt(Error("Cannot decode header in multipart message"));if(Go>_s)qt.push(new DataView(Ot,Ri,E[Xn+1])),Ri+=E[Xn+1],Xn+=2;else{for(;Xn<An&&E[Xn]>=Go&&E[Xn]+E[Xn+1]-1<=_s;)qt.push(new DataView(Ot,Ri+E[Xn]-Go,E[Xn+1])),Xn+=2;Ri+=_s-Go+1}}bt(!0)},bt(!0).then(()=>at)})()}getFileName(){return this.fFileName}getDir(E,J){if(void 0===J&&(0,v.isStr)(E)){const Ae=E.lastIndexOf(";");Ae>0&&(J=Number.parseInt(E.slice(Ae+1)),E=E.slice(0,Ae))}for(let Ae=0;Ae<this.fDirectories.length;++Ae){const Ce=this.fDirectories[Ae];if(Ce.dir_name===E&&(void 0===J||Ce.dir_cycle===J))return Ce}return null}getKey(E,J,Ae){"number"!=typeof J&&(J=-1);let Ce=null;for(let nt=0;nt<this.fKeys.length;++nt){const it=this.fKeys[nt];if(it&&it.fName===E){if(it.fCycle===J){Ce=it;break}J<0&&(!Ce||it.fCycle>Ce.fCycle)&&(Ce=it)}}if(Ce)return Ae?Ce:Promise.resolve(Ce);let He=E.lastIndexOf("/");for(;He>0;){const nt=E.slice(0,He),it=E.slice(He+1),lt=this.getDir(nt);if(lt)return lt.getKey(it,J,Ae);const qt=this.getKey(nt,void 0,!0);if(qt&&!Ae&&0===qt.fClassName.indexOf(st))return this.readObject(nt).then(at=>at.getKey(it,J));He=E.lastIndexOf("/",He-1)}return Ae?null:Promise.reject(Error(`Key not found ${E}`))}readObjBuffer(E){var J=this;return(0,be.A)(function*(){return J.readBuffer([E.fSeekKey+E.fKeylen,E.fNbytes-E.fKeylen]).then(Ae=>{if(E.fObjlen<=E.fNbytes-E.fKeylen){const Ce=new Zt(Ae,0,J);return Ce.fTagOffset=E.fKeylen,Ce}return Nt(Ae,E.fObjlen).then(Ce=>{if(!Ce)return Promise.reject(Error(`Fail to UNZIP buffer for ${E.fName}`));const He=new Zt(Ce,0,J);return He.fTagOffset=E.fKeylen,He})})})()}readObject(E,J,Ae){var Ce=this;return(0,be.A)(function*(){const He=E.lastIndexOf(";");for(He>=0&&(J=Number.parseInt(E.slice(He+1)),E=E.slice(0,He)),"number"!=typeof J&&(J=-1);E.length&&"/"===E[0];)E=E.slice(1);return Ce.getKey(E,J).then(nt=>{if(E===Ie&&nt.fClassName===v.clTList)return Ce.fStreamerInfos;let it=!1;if(nt.fClassName===st||nt.fClassName===Ke){const lt=Ce.getDir(E,J);if(lt)return lt;it=!0}return!it&&Ae?Promise.reject(Error(`Key ${E} is not directory}`)):Ce.readObjBuffer(nt).then(lt=>{if(it){const at=new dn(Ce,E,J);return at.fTitle=nt.fTitle,at.readKeys(lt)}const qt={};return lt.mapObject(1,qt),lt.classStreamer(qt,nt.fClassName),nt.fClassName===v.clTF1||nt.fClassName===v.clTF2?Ce._readFormulas(qt):qt})})})()}_readFormulas(E){var J=this;return(0,be.A)(function*(){const Ae=[];for(let Ce=0;Ce<J.fKeys.length;++Ce)"TFormula"===J.fKeys[Ce].fClassName&&Ae.push(J.readObject(J.fKeys[Ce].fName,J.fKeys[Ce].fCycle));return Promise.all(Ae).then(Ce=>(Ce.forEach(He=>E.addFormula(He)),E))})()}extractStreamerInfos(E){if(!E)return;const J={};E.mapObject(1,J);try{E.classStreamer(J,v.clTList)}catch(Ae){return void console.error("Fail extract streamer infos",Ae)}J._typename=Je,this.fStreamerInfos=J,(0,v.isFunc)(v.internals.addStreamerInfosForPainter)&&v.internals.addStreamerInfosForPainter(J);for(let Ae=0;Ae<J.arr.length;++Ae){const Ce=J.arr[Ae];if(Ce.fElements)for(let He=0;He<Ce.fElements.arr.length;++He){const nt=Ce.fElements.arr[He];if(!nt.fTypeName||!nt.fType)continue;let it=nt.fType,lt=nt.fTypeName;if(it>=60){if(it===ct&&nt._typename===xe&&nt.fSTLtype&&nt.fCtype&&nt.fCtype<20){const at=(jt[nt.fSTLtype]||"undef")+"<";if(0===lt.indexOf(at)&&">"===lt[lt.length-1]&&(it=nt.fCtype,lt=lt.slice(at.length,lt.length-1).trim(),nt.fSTLtype===Yt||nt.fSTLtype===kt)){if(!(lt.indexOf(",")>0))continue;lt=lt.slice(0,lt.indexOf(",")).trim()}}if(it>=60)continue}else it>20&&"*"===lt[lt.length-1]&&(lt=lt.slice(0,lt.length-1)),it%=20;const qt=ui(lt);qt!==it&&(it===g&&qt===w||it===pe&&qt===re||lt&&it&&this.fBasicTypes[lt]!==it&&(this.fBasicTypes[lt]=it))}}}readKeys(){var E=this;return(0,be.A)(function*(){return E.readBuffer([0,400]).then(J=>{const Ae=new Zt(J,0,E);if("root"!==Ae.substring(0,4))return Promise.reject(Error(`Not a ROOT file ${E.fURL}`));if(Ae.shift(4),E.fVersion=Ae.ntou4(),E.fBEGIN=Ae.ntou4(),E.fVersion<1e6?(E.fEND=Ae.ntou4(),E.fSeekFree=Ae.ntou4(),E.fNbytesFree=Ae.ntou4(),Ae.shift(4),E.fNbytesName=Ae.ntou4(),E.fUnits=Ae.ntou1(),E.fCompress=Ae.ntou4(),E.fSeekInfo=Ae.ntou4(),E.fNbytesInfo=Ae.ntou4()):(E.fEND=Ae.ntou8(),E.fSeekFree=Ae.ntou8(),E.fNbytesFree=Ae.ntou4(),Ae.shift(4),E.fNbytesName=Ae.ntou4(),E.fUnits=Ae.ntou1(),E.fCompress=Ae.ntou4(),E.fSeekInfo=Ae.ntou8(),E.fNbytesInfo=Ae.ntou4()),!E.fSeekInfo||!E.fNbytesInfo)return Promise.reject(Error(`File ${E.fURL} does not provide streamer infos`));if(!E.fNbytesName||E.fNbytesName>1e5)return Promise.reject(Error(`Cannot read directory info of the file ${E.fURL}`));let Ce=E.fNbytesName+22;return Ce+=4,Ce+=4,Ce+=18,E.fVersion>=4e4&&(Ce+=12),E.readBuffer([E.fBEGIN,Math.max(300,Ce)])}).then(J=>{const Ae=new Zt(J,0,E);return E.fTitle=Ae.readTKey().fTitle,Ae.locate(E.fNbytesName),Ae.classStreamer(E,st),E.fSeekKeys?E.readBuffer([E.fSeekKeys,E.fNbytesKeys,E.fSeekInfo,E.fNbytesInfo]):Promise.reject(Error(`Empty keys list in ${E.fURL}`))}).then(J=>{const Ae=new Zt(J[0],0,E);Ae.readTKey();const Ce=Ae.ntoi4();for(let it=0;it<Ce;++it)E.fKeys.push(Ae.readTKey());const nt=new Zt(J[1],0,E).readTKey();return nt?(E.fKeys.push(nt),E.readObjBuffer(nt)):Promise.reject(Error(`Fail to read StreamerInfo data in ${E.fURL}`))}).then(J=>(E.extractStreamerInfos(J),E))})()}readDirectory(E,J){var Ae=this;return(0,be.A)(function*(){return Ae.readObject(E,J,!0)})()}findStreamerInfo(E,J,Ae){if(!this.fStreamerInfos)return null;const Ce=this.fStreamerInfos.arr,He=Ce.length;if(void 0!==Ae){let nt=this.fStreamerInfos.cache;nt||(nt=this.fStreamerInfos.cache={});let it=nt[Ae];if(void 0!==it)return it;for(let lt=0;lt<He;++lt)if(it=Ce[lt],it.fCheckSum===Ae)return nt[Ae]=it,it;nt[Ae]=null}else for(let nt=0;nt<He;++nt){const it=Ce[nt];if(it.fName===E&&(it.fClassVersion===J||void 0===J))return it}return null}getStreamer(E,J,Ae){if("TQObject"===E||E===Re)return null;let Ce,He=E;if(J&&(He+=J.checksum?`$chksum${J.checksum}`:`$ver${J.val}`,Ce=this.fStreamers[He],void 0!==Ce))return Ce;const nt=gn[E];if((0,v.isStr)(nt))return this.getStreamer(nt,J,Ae);if((0,v.isFunc)(nt))return Ce=[{typename:E,func:nt}],ms(E,Ce);if(Ce=[],(0,v.isObject)(nt)){if(!nt.name&&!nt.func)return nt;Ce.push(nt)}if(Ae||(Ae=this.findStreamerInfo(E,J.val,J.checksum)),!Ae)return delete this.fStreamers[He],J.nowarning||console.warn(`Not found streamer for ${E} ver ${J.val} checksum ${J.checksum} full ${He}`),null;if(Ae.fName===v.clTStyle&&Ae.fElements&&Ae.fElements.arr.forEach(it=>{"fLineStyle"===it.fName&&(it.fName="fLineStyles")}),Ae.fElements)for(let it=0;it<Ae.fElements.arr.length;++it)Ce.push(Mr(Ae.fElements.arr[it],this));return this.fStreamers[He]=Ce,ms(E,Ce)}getSplittedStreamer(E,J){if(!E)return J;J||(J=[]);for(let Ae=0;Ae<E.length;++Ae){const Ce=E[Ae];if(void 0===Ce.base){J.push(Ce);continue}if(Ce.basename===v.clTObject){J.push({func(it,lt){it.ntoi2(),lt.fUniqueID=it.ntou4(),lt.fBits=it.ntou4(),lt.fBits&Sn&&it.ntou2()}});continue}const He={val:Ce.base};4294967295===He.val&&(He.val=1);const nt=this.getStreamer(Ce.basename,He);nt&&this.getSplittedStreamer(nt,J)}return J}delete(){this.fDirectories=null,this.fKeys=null,this.fStreamers=null,this.fSeekInfo=0,this.fNbytesInfo=0,this.fTagOffset=0}}function ai(Y){if(this.member_wise){const Ce=Y.ntou4(),He=this.stl_version;let nt=null;if(0===Ce)return[];if(Ce>1e6)throw new Error(`member-wise streaming of ${this.conttype} num ${Ce} member ${this.name}`);He.val===this.member_ver&&He.checksum===this.member_checksum?nt=this.member_streamer:(nt=Y.fFile.getStreamer(this.conttype,He),this.member_streamer=nt=Y.fFile.getSplittedStreamer(nt),this.member_ver=He.val,this.member_checksum=He.checksum);const it=new Array(Ce);let lt,qt,at;for(lt=0;lt<Ce;++lt)it[lt]={_typename:this.conttype};if(nt)for(qt=0;qt<nt.length;++qt)if(at=nt[qt],at.split_func)at.split_func(Y,it,Ce);else for(lt=0;lt<Ce;++lt)at.func(Y,it[lt]);else console.error(`Fail to create split streamer for ${this.conttype} need to read ${Ce} objects version ${He}`);return it}const E=Y.ntou4(),J=new Array(E);let Ae=0;if(E>2e5)return console.error(`vector streaming for ${this.conttype} at ${E}`),J;if(this.arrkind>0)for(;Ae<E;)J[Ae++]=Y.readFastArray(Y.ntou4(),this.arrkind);else if(0===this.arrkind)for(;Ae<E;)J[Ae++]=Y.readTString();else if(this.isptr)for(;Ae<E;)J[Ae++]=Y.readObjectAny();else if(this.submember)for(;Ae<E;)J[Ae++]=this.submember.readelem(Y);else for(;Ae<E;)J[Ae++]=Y.classStreamer({},this.conttype);return J}function $n(Y){let E=this.streamer;if(this.member_wise){const Ce=this.stl_version;if(this.si){const He=Y.fFile.findStreamerInfo(this.pairtype,Ce.val,Ce.checksum);if(this.si!==He&&(E=qi(He,this.pairtype,Y.fFile),!E||2!==E.length))return console.log(`Fail to produce streamer for ${this.pairtype}`),null}}const J=Y.ntoi4(),Ae=new Array(J);if(0===J)return Ae;this.member_wise&&Y.remain()>=6&&(Y.ntoi2()===ht?Y.shift(4):Y.shift(-2));for(let Ce=0;Ce<J;++Ce)Ae[Ce]={_typename:this.pairtype},E[0].func(Y,Ae[Ce]),this.member_wise||E[1].func(Y,Ae[Ce]);if(this.member_wise){Y.remain()>=6&&(Y.ntoi2()===ht?Y.shift(4):Y.shift(-2));for(let Ce=0;Ce<J;++Ce)E[1].func(Y,Ae[Ce])}return Ae}class kn extends vn{constructor(E){super(null),this.fUseStampPar=!1,this.fLocalFile=E,this.fEND=E.size,this.fFullURL=E.name,this.fURL=E.name,this.fFileName=E.name}_open(){var E=this;return(0,be.A)(function*(){return E.readKeys()})()}readBuffer(E,J){var Ae=this;return(0,be.A)(function*(){const Ce=Ae.fLocalFile;return new Promise((He,nt)=>{if(J)return nt(Error(`Cannot access other local file ${J}`));const it=new FileReader,lt=[];let qt=0;it.onload=function(at){const Jt=new DataView(at.target.result);return 2===E.length?He(Jt):(lt.push(Jt),qt+=2,qt>=E.length?He(lt):void it.readAsArrayBuffer(Ce.slice(E[qt],E[qt]+E[qt+1])))},it.readAsArrayBuffer(Ce.slice(E[0],E[0]+E[1]))})})()}}class Rn extends vn{constructor(E){super(null),this.fUseStampPar=!1,this.fEND=0,this.fFullURL=E,this.fURL=E,this.fFileName=E}_open(){var E=this;return(0,be.A)(function*(){return Te.e(424).then(Te.t.bind(Te,9424,19)).then(J=>(E.fs=J,new Promise((Ae,Ce)=>E.fs.open(E.fFileName,"r",(He,nt)=>{if(He)return console.log(He.message),Ce(Error(`Not possible to open ${E.fFileName} inside node.js`));const it=E.fs.fstatSync(nt);E.fEND=it.size,E.fd=nt,E.readKeys().then(Ae).catch(Ce)}))))})()}readBuffer(E,J){var Ae=this;return(0,be.A)(function*(){return new Promise((Ce,He)=>{if(J)return He(Error(`Cannot access other local file ${J}`));if(!Ae.fs||!Ae.fd)return He(Error(`File is not opened ${Ae.fFileName}`));const nt=[];let it=0;const lt=(qt,at,Jt)=>{const tn=new DataView(Jt.buffer,Jt.byteOffset,E[it+1]);return 2===E.length?Ce(tn):(nt.push(tn),it+=2,it>=E.length?Ce(nt):void Ae.fs.read(Ae.fd,Buffer.alloc(E[it+1]),0,E[it+1],E[it],lt))};Ae.fs.read(Ae.fd,Buffer.alloc(E[1]),0,E[1],E[0],lt)})})()}}class ei{openFile(){return(0,be.A)(function*(){return!1})()}getFileName(){return""}getFileSize(){return 0}readBuffer(){return(0,be.A)(function*(){return null})()}}class Yi extends vn{constructor(E){super(null),this.fUseStampPar=!1,this.proxy=E}_open(){var E=this;return(0,be.A)(function*(){return E.proxy.openFile().then(J=>{if(!J)return!1;if(E.fEND=E.proxy.getFileSize(),E.fFullURL=E.fURL=E.fFileName=E.proxy.getFileName(),(0,v.isStr)(E.fFileName)){const Ae=E.fFileName.lastIndexOf("/");Ae>0&&Ae<E.fFileName.length-4&&(E.fFileName=E.fFileName.slice(Ae+1))}return E.readKeys()})})()}readBuffer(E,J){var Ae=this;return(0,be.A)(function*(){if(J)return Promise.reject(Error(`Cannot access other file ${J}`));if(!Ae.proxy)return Promise.reject(Error(`File is not opened ${Ae.fFileName}`));if(2===E.length)return Ae.proxy.readBuffer(E[0],E[1]);const Ce=[];for(let He=0;He<E.length;He+=2)Ce.push(Ae.proxy.readBuffer(E[He],E[He+1]));return Promise.all(Ce)})()}}function Ue(Y){let E;return(0,v.isNodeJs)()&&(0,v.isStr)(Y)&&(0===Y.indexOf("file://")?E=new Rn(Y.slice(7)):0!==Y.indexOf("http")&&(E=new Rn(Y))),!E&&(0,v.isObject)(Y)&&Y instanceof ei&&(E=new Yi(Y)),!E&&(0,v.isObject)(Y)&&Y instanceof ArrayBuffer&&(E=new vn("localfile.root"),E.assignFileContent(Y)),!E&&(0,v.isObject)(Y)&&Y.size&&Y.name&&(E=new kn(Y)),E||(E=new vn(Y)),E._open()}ms(v.clTNamed,gn[v.clTNamed]),ms(v.clTObjString,gn[v.clTObjString])},5225:(Gr,xt,Te)=>{"use strict";Te.d(xt,{$EB:()=>re,$p8:()=>sE,B69:()=>Vl,BH$:()=>h3,BKk:()=>jc,CSG:()=>wl,DXC:()=>LM,Df:()=>WM,EZo:()=>pe,FNr:()=>g0,Fvt:()=>k3,GOR:()=>d3,G_z:()=>XM,Gu$:()=>Jv,I9Y:()=>Ki,IUQ:()=>Ya,JeP:()=>QP,Ld9:()=>xR,LlO:()=>Zl,LoY:()=>ol,NRn:()=>Pc,O9p:()=>kc,ONl:()=>NM,PPD:()=>ff,PTz:()=>$i,Pq0:()=>Mn,Q1f:()=>io,QCA:()=>Kv,Qev:()=>Ca,RlV:()=>Wp,THS:()=>tl,Tap:()=>O3,UtB:()=>_E,V9B:()=>$h,XIg:()=>fe,YHV:()=>Yw,YJl:()=>r1,Z58:()=>ro,ZLX:()=>OM,ZM4:()=>Kw,Zcv:()=>Dd,ZyN:()=>rE,_4j:()=>R3,cZY:()=>yE,cj9:()=>Lp,dth:()=>Q3,dwI:()=>Cs,eaF:()=>Jl,er$:()=>Xa,hB5:()=>L,i7d:()=>Sf,iNn:()=>Af,ix0:()=>vn,jUj:()=>lg,kBv:()=>V,kn4:()=>mo,mrM:()=>w_,nWS:()=>Hl,qBx:()=>$M,qUd:()=>Zh,qtW:()=>Wn,sPf:()=>v,tBo:()=>eD,tXL:()=>Ow,tcD:()=>uA,uSd:()=>nb,ubm:()=>gi,wtR:()=>Le,xJ6:()=>dA,zD7:()=>mE});var be=Te(5774);const v="162",V={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Le={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Re=1,Qe=2,Ie=3,L=0,he=1,re=2,fe=0,pe=2,D=100,x=101,P=102,g=200,C=201,N=202,O=203,H=204,X=205,ie=206,z=207,m=208,I=209,A=210,R=211,k=212,ee=213,ge=214,Ne=0,Fe=1,ht=2,pt=0,dt=1,rt=2,_t=3,Yt=4,kt=5,Tt=6,fn=7,Sn=301,cn=302,Ln=306,Zn=1e3,ui=1001,hi=1002,qi=1003,Mr=1004,ms=1005,wt=1006,W=1007,_e=1008,gt=1009,Zt=1014,dn=1015,vn=1016,$n=1020,Rn=1023,Ue=1026,Y=1027,Xa="srgb",fh="srgb-linear",qu="display-p3",ph="display-p3-linear",Md="linear",Ga="srgb",No="rec709",nf="p3",Fp=7680,j0=512,by=513,xy=514,PA=515,yv=516,Hx=517,vv=518,Vx=519,W0="300 es",Qu=2e3;class Ca{addEventListener(a,c){void 0===this._listeners&&(this._listeners={});const d=this._listeners;void 0===d[a]&&(d[a]=[]),-1===d[a].indexOf(c)&&d[a].push(c)}hasEventListener(a,c){if(void 0===this._listeners)return!1;const d=this._listeners;return void 0!==d[a]&&-1!==d[a].indexOf(c)}removeEventListener(a,c){if(void 0===this._listeners)return;const p=this._listeners[a];if(void 0!==p){const S=p.indexOf(c);-1!==S&&p.splice(S,1)}}dispatchEvent(a){if(void 0===this._listeners)return;const d=this._listeners[a.type];if(void 0!==d){a.target=this;const p=d.slice(0);for(let S=0,U=p.length;S<U;S++)p[S].call(this,a);a.target=null}}}const Gc=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Qg=1234567;const sf=Math.PI/180,ju=180/Math.PI;function Ul(){const M=4294967295*Math.random()|0,a=4294967295*Math.random()|0,c=4294967295*Math.random()|0,d=4294967295*Math.random()|0;return(Gc[255&M]+Gc[M>>8&255]+Gc[M>>16&255]+Gc[M>>24&255]+"-"+Gc[255&a]+Gc[a>>8&255]+"-"+Gc[a>>16&15|64]+Gc[a>>24&255]+"-"+Gc[63&c|128]+Gc[c>>8&255]+"-"+Gc[c>>16&255]+Gc[c>>24&255]+Gc[255&d]+Gc[d>>8&255]+Gc[d>>16&255]+Gc[d>>24&255]).toLowerCase()}function Yl(M,a,c){return Math.max(a,Math.min(c,M))}function Sd(M,a){return(M%a+a)%a}function xc(M,a,c,d,p){return d+(M-a)*(p-d)/(c-a)}function Cy(M,a,c){return M!==a?(c-M)/(a-M):0}function cc(M,a,c){return(1-c)*M+c*a}function $0(M,a,c,d){return cc(M,a,1-Math.exp(-c*d))}function af(M,a=1){return a-Math.abs(Sd(M,2*a)-a)}function RA(M,a,c){return M<=a?0:M>=c?1:(M=(M-a)/(c-a))*M*(3-2*M)}function rl(M,a,c){return M<=a?0:M>=c?1:(M=(M-a)/(c-a))*M*M*(M*(6*M-15)+10)}function xi(M,a){return M+Math.floor(Math.random()*(a-M+1))}function Jf(M,a){return M+Math.random()*(a-M)}function ep(M){return M*(.5-Math.random())}function qc(M){void 0!==M&&(Qg=M);let a=Qg+=1831565813;return a=Math.imul(a^a>>>15,1|a),a^=a+Math.imul(a^a>>>7,61|a),((a^a>>>14)>>>0)/4294967296}function lf(M){return M*sf}function My(M){return M*ju}function hd(M){return!(M&M-1)&&0!==M}function wc(M){return Math.pow(2,Math.ceil(Math.log(M)/Math.LN2))}function Kc(M){return Math.pow(2,Math.floor(Math.log(M)/Math.LN2))}function Hh(M,a,c,d,p){const S=Math.cos,U=Math.sin,F=S(c/2),ue=U(c/2),Q=S((a+d)/2),Me=U((a+d)/2),ke=S((a-d)/2),Oe=U((a-d)/2),Ge=S((d-a)/2),et=U((d-a)/2);switch(p){case"XYX":M.set(F*Me,ue*ke,ue*Oe,F*Q);break;case"YZY":M.set(ue*Oe,F*Me,ue*ke,F*Q);break;case"ZXZ":M.set(ue*ke,ue*Oe,F*Me,F*Q);break;case"XZX":M.set(F*Me,ue*et,ue*Ge,F*Q);break;case"YXY":M.set(ue*Ge,F*Me,ue*et,F*Q);break;case"ZYZ":M.set(ue*et,ue*Ge,F*Me,F*Q);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+p)}}function Jo(M,a){switch(a.constructor){case Float32Array:return M;case Uint32Array:return M/4294967295;case Uint16Array:return M/65535;case Uint8Array:return M/255;case Int32Array:return Math.max(M/2147483647,-1);case Int16Array:return Math.max(M/32767,-1);case Int8Array:return Math.max(M/127,-1);default:throw new Error("Invalid component type.")}}function co(M,a){switch(a.constructor){case Float32Array:return M;case Uint32Array:return Math.round(4294967295*M);case Uint16Array:return Math.round(65535*M);case Uint8Array:return Math.round(255*M);case Int32Array:return Math.round(2147483647*M);case Int16Array:return Math.round(32767*M);case Int8Array:return Math.round(127*M);default:throw new Error("Invalid component type.")}}var Lp=Object.freeze({__proto__:null,DEG2RAD:sf,MathUtils:{DEG2RAD:sf,RAD2DEG:ju,generateUUID:Ul,clamp:Yl,euclideanModulo:Sd,mapLinear:xc,inverseLerp:Cy,lerp:cc,damp:$0,pingpong:af,smoothstep:RA,smootherstep:rl,randInt:xi,randFloat:Jf,randFloatSpread:ep,seededRandom:qc,degToRad:lf,radToDeg:My,isPowerOfTwo:hd,ceilPowerOfTwo:wc,floorPowerOfTwo:Kc,setQuaternionFromProperEuler:Hh,normalize:co,denormalize:Jo},RAD2DEG:ju,ceilPowerOfTwo:wc,clamp:Yl,damp:$0,degToRad:lf,denormalize:Jo,euclideanModulo:Sd,floorPowerOfTwo:Kc,generateUUID:Ul,inverseLerp:Cy,isPowerOfTwo:hd,lerp:cc,mapLinear:xc,normalize:co,pingpong:af,radToDeg:My,randFloat:Jf,randFloatSpread:ep,randInt:xi,seededRandom:qc,setQuaternionFromProperEuler:Hh,smootherstep:rl,smoothstep:RA});class Ki{constructor(a=0,c=0){Ki.prototype.isVector2=!0,this.x=a,this.y=c}get width(){return this.x}set width(a){this.x=a}get height(){return this.y}set height(a){this.y=a}set(a,c){return this.x=a,this.y=c,this}setScalar(a){return this.x=a,this.y=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setComponent(a,c){switch(a){case 0:this.x=c;break;case 1:this.y=c;break;default:throw new Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y)}copy(a){return this.x=a.x,this.y=a.y,this}add(a){return this.x+=a.x,this.y+=a.y,this}addScalar(a){return this.x+=a,this.y+=a,this}addVectors(a,c){return this.x=a.x+c.x,this.y=a.y+c.y,this}addScaledVector(a,c){return this.x+=a.x*c,this.y+=a.y*c,this}sub(a){return this.x-=a.x,this.y-=a.y,this}subScalar(a){return this.x-=a,this.y-=a,this}subVectors(a,c){return this.x=a.x-c.x,this.y=a.y-c.y,this}multiply(a){return this.x*=a.x,this.y*=a.y,this}multiplyScalar(a){return this.x*=a,this.y*=a,this}divide(a){return this.x/=a.x,this.y/=a.y,this}divideScalar(a){return this.multiplyScalar(1/a)}applyMatrix3(a){const c=this.x,d=this.y,p=a.elements;return this.x=p[0]*c+p[3]*d+p[6],this.y=p[1]*c+p[4]*d+p[7],this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this}clamp(a,c){return this.x=Math.max(a.x,Math.min(c.x,this.x)),this.y=Math.max(a.y,Math.min(c.y,this.y)),this}clampScalar(a,c){return this.x=Math.max(a,Math.min(c,this.x)),this.y=Math.max(a,Math.min(c,this.y)),this}clampLength(a,c){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(a,Math.min(c,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(a){return this.x*a.x+this.y*a.y}cross(a){return this.x*a.y-this.y*a.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(a){const c=Math.sqrt(this.lengthSq()*a.lengthSq());if(0===c)return Math.PI/2;const d=this.dot(a)/c;return Math.acos(Yl(d,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const c=this.x-a.x,d=this.y-a.y;return c*c+d*d}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,c){return this.x+=(a.x-this.x)*c,this.y+=(a.y-this.y)*c,this}lerpVectors(a,c,d){return this.x=a.x+(c.x-a.x)*d,this.y=a.y+(c.y-a.y)*d,this}equals(a){return a.x===this.x&&a.y===this.y}fromArray(a,c=0){return this.x=a[c],this.y=a[c+1],this}toArray(a=[],c=0){return a[c]=this.x,a[c+1]=this.y,a}fromBufferAttribute(a,c){return this.x=a.getX(c),this.y=a.getY(c),this}rotateAround(a,c){const d=Math.cos(c),p=Math.sin(c),S=this.x-a.x,U=this.y-a.y;return this.x=S*d-U*p+a.x,this.y=S*p+U*d+a.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Cs{constructor(a,c,d,p,S,U,F,ue,Q){Cs.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==a&&this.set(a,c,d,p,S,U,F,ue,Q)}set(a,c,d,p,S,U,F,ue,Q){const Me=this.elements;return Me[0]=a,Me[1]=p,Me[2]=F,Me[3]=c,Me[4]=S,Me[5]=ue,Me[6]=d,Me[7]=U,Me[8]=Q,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(a){const c=this.elements,d=a.elements;return c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],this}extractBasis(a,c,d){return a.setFromMatrix3Column(this,0),c.setFromMatrix3Column(this,1),d.setFromMatrix3Column(this,2),this}setFromMatrix4(a){const c=a.elements;return this.set(c[0],c[4],c[8],c[1],c[5],c[9],c[2],c[6],c[10]),this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,c){const d=a.elements,p=c.elements,S=this.elements,U=d[0],F=d[3],ue=d[6],Q=d[1],Me=d[4],ke=d[7],Oe=d[2],Ge=d[5],et=d[8],vt=p[0],Ye=p[3],je=p[6],Rt=p[1],At=p[4],Ht=p[7],Pn=p[2],yn=p[5],xn=p[8];return S[0]=U*vt+F*Rt+ue*Pn,S[3]=U*Ye+F*At+ue*yn,S[6]=U*je+F*Ht+ue*xn,S[1]=Q*vt+Me*Rt+ke*Pn,S[4]=Q*Ye+Me*At+ke*yn,S[7]=Q*je+Me*Ht+ke*xn,S[2]=Oe*vt+Ge*Rt+et*Pn,S[5]=Oe*Ye+Ge*At+et*yn,S[8]=Oe*je+Ge*Ht+et*xn,this}multiplyScalar(a){const c=this.elements;return c[0]*=a,c[3]*=a,c[6]*=a,c[1]*=a,c[4]*=a,c[7]*=a,c[2]*=a,c[5]*=a,c[8]*=a,this}determinant(){const a=this.elements,c=a[0],d=a[1],p=a[2],S=a[3],U=a[4],F=a[5],ue=a[6],Q=a[7],Me=a[8];return c*U*Me-c*F*Q-d*S*Me+d*F*ue+p*S*Q-p*U*ue}invert(){const a=this.elements,c=a[0],d=a[1],p=a[2],S=a[3],U=a[4],F=a[5],ue=a[6],Q=a[7],Me=a[8],ke=Me*U-F*Q,Oe=F*ue-Me*S,Ge=Q*S-U*ue,et=c*ke+d*Oe+p*Ge;if(0===et)return this.set(0,0,0,0,0,0,0,0,0);const vt=1/et;return a[0]=ke*vt,a[1]=(p*Q-Me*d)*vt,a[2]=(F*d-p*U)*vt,a[3]=Oe*vt,a[4]=(Me*c-p*ue)*vt,a[5]=(p*S-F*c)*vt,a[6]=Ge*vt,a[7]=(d*ue-Q*c)*vt,a[8]=(U*c-d*S)*vt,this}transpose(){let a;const c=this.elements;return a=c[1],c[1]=c[3],c[3]=a,a=c[2],c[2]=c[6],c[6]=a,a=c[5],c[5]=c[7],c[7]=a,this}getNormalMatrix(a){return this.setFromMatrix4(a).invert().transpose()}transposeIntoArray(a){const c=this.elements;return a[0]=c[0],a[1]=c[3],a[2]=c[6],a[3]=c[1],a[4]=c[4],a[5]=c[7],a[6]=c[2],a[7]=c[5],a[8]=c[8],this}setUvTransform(a,c,d,p,S,U,F){const ue=Math.cos(S),Q=Math.sin(S);return this.set(d*ue,d*Q,-d*(ue*U+Q*F)+U+a,-p*Q,p*ue,-p*(-Q*U+ue*F)+F+c,0,0,1),this}scale(a,c){return this.premultiply(km.makeScale(a,c)),this}rotate(a){return this.premultiply(km.makeRotation(-a)),this}translate(a,c){return this.premultiply(km.makeTranslation(a,c)),this}makeTranslation(a,c){return a.isVector2?this.set(1,0,a.x,0,1,a.y,0,0,1):this.set(1,0,a,0,1,c,0,0,1),this}makeRotation(a){const c=Math.cos(a),d=Math.sin(a);return this.set(c,-d,0,d,c,0,0,0,1),this}makeScale(a,c){return this.set(a,0,0,0,c,0,0,0,1),this}equals(a){const c=this.elements,d=a.elements;for(let p=0;p<9;p++)if(c[p]!==d[p])return!1;return!0}fromArray(a,c=0){for(let d=0;d<9;d++)this.elements[d]=a[d+c];return this}toArray(a=[],c=0){const d=this.elements;return a[c]=d[0],a[c+1]=d[1],a[c+2]=d[2],a[c+3]=d[3],a[c+4]=d[4],a[c+5]=d[5],a[c+6]=d[6],a[c+7]=d[7],a[c+8]=d[8],a}clone(){return(new this.constructor).fromArray(this.elements)}}const km=new Cs;function Np(M){for(let a=M.length-1;a>=0;--a)if(M[a]>=65535)return!0;return!1}function zl(M){return document.createElementNS("http://www.w3.org/1999/xhtml",M)}function cf(){const M=zl("canvas");return M.style.display="block",M}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const jg={};const Ma=(new Cs).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Us=(new Cs).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),tp={[fh]:{transfer:Md,primaries:No,toReference:M=>M,fromReference:M=>M},[Xa]:{transfer:Ga,primaries:No,toReference:M=>M.convertSRGBToLinear(),fromReference:M=>M.convertLinearToSRGB()},[ph]:{transfer:Md,primaries:nf,toReference:M=>M.applyMatrix3(Us),fromReference:M=>M.applyMatrix3(Ma)},[qu]:{transfer:Ga,primaries:nf,toReference:M=>M.convertSRGBToLinear().applyMatrix3(Us),fromReference:M=>M.applyMatrix3(Ma).convertLinearToSRGB()}},gu=new Set([fh,ph]),Ia={enabled:!0,_workingColorSpace:fh,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(M){if(!gu.has(M))throw new Error(`Unsupported working color space, "${M}".`);this._workingColorSpace=M},convert:function(M,a,c){return!1!==this.enabled&&a!==c&&a&&c?(0,tp[c].fromReference)((0,tp[a].toReference)(M)):M},fromWorkingColorSpace:function(M,a){return this.convert(M,this._workingColorSpace,a)},toWorkingColorSpace:function(M,a){return this.convert(M,a,this._workingColorSpace)},getPrimaries:function(M){return tp[M].primaries},getTransfer:function(M){return""===M?Md:tp[M].transfer}};function hf(M){return M<.04045?.0773993808*M:Math.pow(.9478672986*M+.0521327014,2.4)}function Wg(M){return M<.0031308?12.92*M:1.055*Math.pow(M,.41666)-.055}let Vh;class X0{static getDataURL(a){if(/^data:/i.test(a.src)||typeof HTMLCanvasElement>"u")return a.src;let c;if(a instanceof HTMLCanvasElement)c=a;else{void 0===Vh&&(Vh=zl("canvas")),Vh.width=a.width,Vh.height=a.height;const d=Vh.getContext("2d");a instanceof ImageData?d.putImageData(a,0,0):d.drawImage(a,0,0,a.width,a.height),c=Vh}return c.width>2048||c.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",a),c.toDataURL("image/jpeg",.6)):c.toDataURL("image/png")}static sRGBToLinear(a){if(typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&a instanceof ImageBitmap){const c=zl("canvas");c.width=a.width,c.height=a.height;const d=c.getContext("2d");d.drawImage(a,0,0,a.width,a.height);const p=d.getImageData(0,0,a.width,a.height),S=p.data;for(let U=0;U<S.length;U++)S[U]=255*hf(S[U]/255);return d.putImageData(p,0,0),c}if(a.data){const c=a.data.slice(0);for(let d=0;d<c.length;d++)c[d]=c instanceof Uint8Array||c instanceof Uint8ClampedArray?Math.floor(255*hf(c[d]/255)):hf(c[d]);return{data:c,width:a.width,height:a.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),a}}let bv=0;class kA{constructor(a=null){this.isSource=!0,Object.defineProperty(this,"id",{value:bv++}),this.uuid=Ul(),this.data=a,this.dataReady=!0,this.version=0}set needsUpdate(a){!0===a&&this.version++}toJSON(a){const c=void 0===a||"string"==typeof a;if(!c&&void 0!==a.images[this.uuid])return a.images[this.uuid];const d={uuid:this.uuid,url:""},p=this.data;if(null!==p){let S;if(Array.isArray(p)){S=[];for(let U=0,F=p.length;U<F;U++)S.push(Y0(p[U].isDataTexture?p[U].image:p[U]))}else S=Y0(p);d.url=S}return c||(a.images[this.uuid]=d),d}}function Y0(M){return typeof HTMLImageElement<"u"&&M instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&M instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&M instanceof ImageBitmap?X0.getDataURL(M):M.data?{data:Array.from(M.data),width:M.width,height:M.height,type:M.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Om=0,_u=(()=>{class M extends Ca{constructor(c=M.DEFAULT_IMAGE,d=M.DEFAULT_MAPPING,p=ui,S=ui,U=wt,F=_e,ue=Rn,Q=gt,Me=M.DEFAULT_ANISOTROPY,ke=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Om++}),this.uuid=Ul(),this.name="",this.source=new kA(c),this.mipmaps=[],this.mapping=d,this.channel=0,this.wrapS=p,this.wrapT=S,this.magFilter=U,this.minFilter=F,this.anisotropy=Me,this.format=ue,this.internalFormat=null,this.type=Q,this.offset=new Ki(0,0),this.repeat=new Ki(1,1),this.center=new Ki(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Cs,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=ke,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(c=null){this.source.data=c}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(c){return this.name=c.name,this.source=c.source,this.mipmaps=c.mipmaps.slice(0),this.mapping=c.mapping,this.channel=c.channel,this.wrapS=c.wrapS,this.wrapT=c.wrapT,this.magFilter=c.magFilter,this.minFilter=c.minFilter,this.anisotropy=c.anisotropy,this.format=c.format,this.internalFormat=c.internalFormat,this.type=c.type,this.offset.copy(c.offset),this.repeat.copy(c.repeat),this.center.copy(c.center),this.rotation=c.rotation,this.matrixAutoUpdate=c.matrixAutoUpdate,this.matrix.copy(c.matrix),this.generateMipmaps=c.generateMipmaps,this.premultiplyAlpha=c.premultiplyAlpha,this.flipY=c.flipY,this.unpackAlignment=c.unpackAlignment,this.colorSpace=c.colorSpace,this.userData=JSON.parse(JSON.stringify(c.userData)),this.needsUpdate=!0,this}toJSON(c){const d=void 0===c||"string"==typeof c;if(!d&&void 0!==c.textures[this.uuid])return c.textures[this.uuid];const p={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(c).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(p.userData=this.userData),d||(c.textures[this.uuid]=p),p}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(c){if(300!==this.mapping)return c;if(c.applyMatrix3(this.matrix),c.x<0||c.x>1)switch(this.wrapS){case 1e3:c.x=c.x-Math.floor(c.x);break;case ui:c.x=c.x<0?0:1;break;case 1002:c.x=1===Math.abs(Math.floor(c.x)%2)?Math.ceil(c.x)-c.x:c.x-Math.floor(c.x)}if(c.y<0||c.y>1)switch(this.wrapT){case 1e3:c.y=c.y-Math.floor(c.y);break;case ui:c.y=c.y<0?0:1;break;case 1002:c.y=1===Math.abs(Math.floor(c.y)%2)?Math.ceil(c.y)-c.y:c.y-Math.floor(c.y)}return this.flipY&&(c.y=1-c.y),c}set needsUpdate(c){!0===c&&(this.version++,this.source.needsUpdate=!0)}}return M.DEFAULT_IMAGE=null,M.DEFAULT_MAPPING=300,M.DEFAULT_ANISOTROPY=1,M})();class Ya{constructor(a=0,c=0,d=0,p=1){Ya.prototype.isVector4=!0,this.x=a,this.y=c,this.z=d,this.w=p}get width(){return this.z}set width(a){this.z=a}get height(){return this.w}set height(a){this.w=a}set(a,c,d,p){return this.x=a,this.y=c,this.z=d,this.w=p,this}setScalar(a){return this.x=a,this.y=a,this.z=a,this.w=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}setW(a){return this.w=a,this}setComponent(a,c){switch(a){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;case 3:this.w=c;break;default:throw new Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=void 0!==a.w?a.w:1,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this}addScalar(a){return this.x+=a,this.y+=a,this.z+=a,this.w+=a,this}addVectors(a,c){return this.x=a.x+c.x,this.y=a.y+c.y,this.z=a.z+c.z,this.w=a.w+c.w,this}addScaledVector(a,c){return this.x+=a.x*c,this.y+=a.y*c,this.z+=a.z*c,this.w+=a.w*c,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this}subScalar(a){return this.x-=a,this.y-=a,this.z-=a,this.w-=a,this}subVectors(a,c){return this.x=a.x-c.x,this.y=a.y-c.y,this.z=a.z-c.z,this.w=a.w-c.w,this}multiply(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this.w*=a.w,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this}applyMatrix4(a){const c=this.x,d=this.y,p=this.z,S=this.w,U=a.elements;return this.x=U[0]*c+U[4]*d+U[8]*p+U[12]*S,this.y=U[1]*c+U[5]*d+U[9]*p+U[13]*S,this.z=U[2]*c+U[6]*d+U[10]*p+U[14]*S,this.w=U[3]*c+U[7]*d+U[11]*p+U[15]*S,this}divideScalar(a){return this.multiplyScalar(1/a)}setAxisAngleFromQuaternion(a){this.w=2*Math.acos(a.w);const c=Math.sqrt(1-a.w*a.w);return c<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=a.x/c,this.y=a.y/c,this.z=a.z/c),this}setAxisAngleFromRotationMatrix(a){let c,d,p,S;const ue=a.elements,Q=ue[0],Me=ue[4],ke=ue[8],Oe=ue[1],Ge=ue[5],et=ue[9],vt=ue[2],Ye=ue[6],je=ue[10];if(Math.abs(Me-Oe)<.01&&Math.abs(ke-vt)<.01&&Math.abs(et-Ye)<.01){if(Math.abs(Me+Oe)<.1&&Math.abs(ke+vt)<.1&&Math.abs(et+Ye)<.1&&Math.abs(Q+Ge+je-3)<.1)return this.set(1,0,0,0),this;c=Math.PI;const At=(Q+1)/2,Ht=(Ge+1)/2,Pn=(je+1)/2,yn=(Me+Oe)/4,xn=(ke+vt)/4,qn=(et+Ye)/4;return At>Ht&&At>Pn?At<.01?(d=0,p=.707106781,S=.707106781):(d=Math.sqrt(At),p=yn/d,S=xn/d):Ht>Pn?Ht<.01?(d=.707106781,p=0,S=.707106781):(p=Math.sqrt(Ht),d=yn/p,S=qn/p):Pn<.01?(d=.707106781,p=.707106781,S=0):(S=Math.sqrt(Pn),d=xn/S,p=qn/S),this.set(d,p,S,c),this}let Rt=Math.sqrt((Ye-et)*(Ye-et)+(ke-vt)*(ke-vt)+(Oe-Me)*(Oe-Me));return Math.abs(Rt)<.001&&(Rt=1),this.x=(Ye-et)/Rt,this.y=(ke-vt)/Rt,this.z=(Oe-Me)/Rt,this.w=Math.acos((Q+Ge+je-1)/2),this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this.w=Math.min(this.w,a.w),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this.w=Math.max(this.w,a.w),this}clamp(a,c){return this.x=Math.max(a.x,Math.min(c.x,this.x)),this.y=Math.max(a.y,Math.min(c.y,this.y)),this.z=Math.max(a.z,Math.min(c.z,this.z)),this.w=Math.max(a.w,Math.min(c.w,this.w)),this}clampScalar(a,c){return this.x=Math.max(a,Math.min(c,this.x)),this.y=Math.max(a,Math.min(c,this.y)),this.z=Math.max(a,Math.min(c,this.z)),this.w=Math.max(a,Math.min(c,this.w)),this}clampLength(a,c){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(a,Math.min(c,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,c){return this.x+=(a.x-this.x)*c,this.y+=(a.y-this.y)*c,this.z+=(a.z-this.z)*c,this.w+=(a.w-this.w)*c,this}lerpVectors(a,c,d){return this.x=a.x+(c.x-a.x)*d,this.y=a.y+(c.y-a.y)*d,this.z=a.z+(c.z-a.z)*d,this.w=a.w+(c.w-a.w)*d,this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w}fromArray(a,c=0){return this.x=a[c],this.y=a[c+1],this.z=a[c+2],this.w=a[c+3],this}toArray(a=[],c=0){return a[c]=this.x,a[c+1]=this.y,a[c+2]=this.z,a[c+3]=this.w,a}fromBufferAttribute(a,c){return this.x=a.getX(c),this.y=a.getY(c),this.z=a.getZ(c),this.w=a.getW(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class $x extends Ca{constructor(a=1,c=1,d={}){super(),this.isRenderTarget=!0,this.width=a,this.height=c,this.depth=1,this.scissor=new Ya(0,0,a,c),this.scissorTest=!1,this.viewport=new Ya(0,0,a,c);const p={width:a,height:c,depth:1};d=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:wt,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0,count:1},d);const S=new _u(p,d.mapping,d.wrapS,d.wrapT,d.magFilter,d.minFilter,d.format,d.type,d.anisotropy,d.colorSpace);S.flipY=!1,S.generateMipmaps=d.generateMipmaps,S.internalFormat=d.internalFormat,this.textures=[];const U=d.count;for(let F=0;F<U;F++)this.textures[F]=S.clone(),this.textures[F].isRenderTargetTexture=!0;this.depthBuffer=d.depthBuffer,this.stencilBuffer=d.stencilBuffer,this.depthTexture=d.depthTexture,this.samples=d.samples}get texture(){return this.textures[0]}set texture(a){this.textures[0]=a}setSize(a,c,d=1){if(this.width!==a||this.height!==c||this.depth!==d){this.width=a,this.height=c,this.depth=d;for(let p=0,S=this.textures.length;p<S;p++)this.textures[p].image.width=a,this.textures[p].image.height=c,this.textures[p].image.depth=d;this.dispose()}this.viewport.set(0,0,a,c),this.scissor.set(0,0,a,c)}clone(){return(new this.constructor).copy(this)}copy(a){this.width=a.width,this.height=a.height,this.depth=a.depth,this.scissor.copy(a.scissor),this.scissorTest=a.scissorTest,this.viewport.copy(a.viewport),this.textures.length=0;for(let d=0,p=a.textures.length;d<p;d++)this.textures[d]=a.textures[d].clone(),this.textures[d].isRenderTargetTexture=!0;const c=Object.assign({},a.texture.image);return this.texture.source=new kA(c),this.depthBuffer=a.depthBuffer,this.stencilBuffer=a.stencilBuffer,null!==a.depthTexture&&(this.depthTexture=a.depthTexture.clone()),this.samples=a.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Hl extends $x{constructor(a=1,c=1,d={}){super(a,c,d),this.isWebGLRenderTarget=!0}}const ho={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Up={h:0,s:0,l:0},Lm={h:0,s:0,l:0};function Sy(M,a,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?M+6*(a-M)*c:c<.5?a:c<2/3?M+6*(a-M)*(2/3-c):M}class io{constructor(a,c,d){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(a,c,d)}set(a,c,d){if(void 0===c&&void 0===d){const p=a;p&&p.isColor?this.copy(p):"number"==typeof p?this.setHex(p):"string"==typeof p&&this.setStyle(p)}else this.setRGB(a,c,d);return this}setScalar(a){return this.r=a,this.g=a,this.b=a,this}setHex(a,c=Xa){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=(255&a)/255,Ia.toWorkingColorSpace(this,c),this}setRGB(a,c,d,p=Ia.workingColorSpace){return this.r=a,this.g=c,this.b=d,Ia.toWorkingColorSpace(this,p),this}setHSL(a,c,d,p=Ia.workingColorSpace){if(a=Sd(a,1),c=Yl(c,0,1),d=Yl(d,0,1),0===c)this.r=this.g=this.b=d;else{const S=d<=.5?d*(1+c):d+c-d*c,U=2*d-S;this.r=Sy(U,S,a+1/3),this.g=Sy(U,S,a),this.b=Sy(U,S,a-1/3)}return Ia.toWorkingColorSpace(this,p),this}setStyle(a,c=Xa){function d(S){void 0!==S&&parseFloat(S)<1&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}let p;if(p=/^(\w+)\(([^\)]*)\)/.exec(a)){let S;const F=p[2];switch(p[1]){case"rgb":case"rgba":if(S=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(F))return d(S[4]),this.setRGB(Math.min(255,parseInt(S[1],10))/255,Math.min(255,parseInt(S[2],10))/255,Math.min(255,parseInt(S[3],10))/255,c);if(S=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(F))return d(S[4]),this.setRGB(Math.min(100,parseInt(S[1],10))/100,Math.min(100,parseInt(S[2],10))/100,Math.min(100,parseInt(S[3],10))/100,c);break;case"hsl":case"hsla":if(S=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(F))return d(S[4]),this.setHSL(parseFloat(S[1])/360,parseFloat(S[2])/100,parseFloat(S[3])/100,c);break;default:console.warn("THREE.Color: Unknown color model "+a)}}else if(p=/^\#([A-Fa-f\d]+)$/.exec(a)){const S=p[1],U=S.length;if(3===U)return this.setRGB(parseInt(S.charAt(0),16)/15,parseInt(S.charAt(1),16)/15,parseInt(S.charAt(2),16)/15,c);if(6===U)return this.setHex(parseInt(S,16),c);console.warn("THREE.Color: Invalid hex color "+a)}else if(a&&a.length>0)return this.setColorName(a,c);return this}setColorName(a,c=Xa){const d=ho[a.toLowerCase()];return void 0!==d?this.setHex(d,c):console.warn("THREE.Color: Unknown color "+a),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(a){return this.r=a.r,this.g=a.g,this.b=a.b,this}copySRGBToLinear(a){return this.r=hf(a.r),this.g=hf(a.g),this.b=hf(a.b),this}copyLinearToSRGB(a){return this.r=Wg(a.r),this.g=Wg(a.g),this.b=Wg(a.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(a=Xa){return Ia.fromWorkingColorSpace(Dh.copy(this),a),65536*Math.round(Yl(255*Dh.r,0,255))+256*Math.round(Yl(255*Dh.g,0,255))+Math.round(Yl(255*Dh.b,0,255))}getHexString(a=Xa){return("000000"+this.getHex(a).toString(16)).slice(-6)}getHSL(a,c=Ia.workingColorSpace){Ia.fromWorkingColorSpace(Dh.copy(this),c);const d=Dh.r,p=Dh.g,S=Dh.b,U=Math.max(d,p,S),F=Math.min(d,p,S);let ue,Q;const Me=(F+U)/2;if(F===U)ue=0,Q=0;else{const ke=U-F;switch(Q=Me<=.5?ke/(U+F):ke/(2-U-F),U){case d:ue=(p-S)/ke+(p<S?6:0);break;case p:ue=(S-d)/ke+2;break;case S:ue=(d-p)/ke+4}ue/=6}return a.h=ue,a.s=Q,a.l=Me,a}getRGB(a,c=Ia.workingColorSpace){return Ia.fromWorkingColorSpace(Dh.copy(this),c),a.r=Dh.r,a.g=Dh.g,a.b=Dh.b,a}getStyle(a=Xa){Ia.fromWorkingColorSpace(Dh.copy(this),a);const c=Dh.r,d=Dh.g,p=Dh.b;return a!==Xa?`color(${a} ${c.toFixed(3)} ${d.toFixed(3)} ${p.toFixed(3)})`:`rgb(${Math.round(255*c)},${Math.round(255*d)},${Math.round(255*p)})`}offsetHSL(a,c,d){return this.getHSL(Up),this.setHSL(Up.h+a,Up.s+c,Up.l+d)}add(a){return this.r+=a.r,this.g+=a.g,this.b+=a.b,this}addColors(a,c){return this.r=a.r+c.r,this.g=a.g+c.g,this.b=a.b+c.b,this}addScalar(a){return this.r+=a,this.g+=a,this.b+=a,this}sub(a){return this.r=Math.max(0,this.r-a.r),this.g=Math.max(0,this.g-a.g),this.b=Math.max(0,this.b-a.b),this}multiply(a){return this.r*=a.r,this.g*=a.g,this.b*=a.b,this}multiplyScalar(a){return this.r*=a,this.g*=a,this.b*=a,this}lerp(a,c){return this.r+=(a.r-this.r)*c,this.g+=(a.g-this.g)*c,this.b+=(a.b-this.b)*c,this}lerpColors(a,c,d){return this.r=a.r+(c.r-a.r)*d,this.g=a.g+(c.g-a.g)*d,this.b=a.b+(c.b-a.b)*d,this}lerpHSL(a,c){this.getHSL(Up),a.getHSL(Lm);const d=cc(Up.h,Lm.h,c),p=cc(Up.s,Lm.s,c),S=cc(Up.l,Lm.l,c);return this.setHSL(d,p,S),this}setFromVector3(a){return this.r=a.x,this.g=a.y,this.b=a.z,this}applyMatrix3(a){const c=this.r,d=this.g,p=this.b,S=a.elements;return this.r=S[0]*c+S[3]*d+S[6]*p,this.g=S[1]*c+S[4]*d+S[7]*p,this.b=S[2]*c+S[5]*d+S[8]*p,this}equals(a){return a.r===this.r&&a.g===this.g&&a.b===this.b}fromArray(a,c=0){return this.r=a[c],this.g=a[c+1],this.b=a[c+2],this}toArray(a=[],c=0){return a[c]=this.r,a[c+1]=this.g,a[c+2]=this.b,a}fromBufferAttribute(a,c){return this.r=a.getX(c),this.g=a.getY(c),this.b=a.getZ(c),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Dh=new io;io.NAMES=ho;class $i{constructor(a=0,c=0,d=0,p=1){this.isQuaternion=!0,this._x=a,this._y=c,this._z=d,this._w=p}static slerpFlat(a,c,d,p,S,U,F){let ue=d[p+0],Q=d[p+1],Me=d[p+2],ke=d[p+3];const Oe=S[U+0],Ge=S[U+1],et=S[U+2],vt=S[U+3];if(0===F)return a[c+0]=ue,a[c+1]=Q,a[c+2]=Me,void(a[c+3]=ke);if(1===F)return a[c+0]=Oe,a[c+1]=Ge,a[c+2]=et,void(a[c+3]=vt);if(ke!==vt||ue!==Oe||Q!==Ge||Me!==et){let Ye=1-F;const je=ue*Oe+Q*Ge+Me*et+ke*vt,Rt=je>=0?1:-1,At=1-je*je;if(At>Number.EPSILON){const Pn=Math.sqrt(At),yn=Math.atan2(Pn,je*Rt);Ye=Math.sin(Ye*yn)/Pn,F=Math.sin(F*yn)/Pn}const Ht=F*Rt;if(ue=ue*Ye+Oe*Ht,Q=Q*Ye+Ge*Ht,Me=Me*Ye+et*Ht,ke=ke*Ye+vt*Ht,Ye===1-F){const Pn=1/Math.sqrt(ue*ue+Q*Q+Me*Me+ke*ke);ue*=Pn,Q*=Pn,Me*=Pn,ke*=Pn}}a[c]=ue,a[c+1]=Q,a[c+2]=Me,a[c+3]=ke}static multiplyQuaternionsFlat(a,c,d,p,S,U){const F=d[p],ue=d[p+1],Q=d[p+2],Me=d[p+3],ke=S[U],Oe=S[U+1],Ge=S[U+2],et=S[U+3];return a[c]=F*et+Me*ke+ue*Ge-Q*Oe,a[c+1]=ue*et+Me*Oe+Q*ke-F*Ge,a[c+2]=Q*et+Me*Ge+F*Oe-ue*ke,a[c+3]=Me*et-F*ke-ue*Oe-Q*Ge,a}get x(){return this._x}set x(a){this._x=a,this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a,this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a,this._onChangeCallback()}get w(){return this._w}set w(a){this._w=a,this._onChangeCallback()}set(a,c,d,p){return this._x=a,this._y=c,this._z=d,this._w=p,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(a){return this._x=a.x,this._y=a.y,this._z=a.z,this._w=a.w,this._onChangeCallback(),this}setFromEuler(a,c=!0){const d=a._x,p=a._y,S=a._z,U=a._order,F=Math.cos,ue=Math.sin,Q=F(d/2),Me=F(p/2),ke=F(S/2),Oe=ue(d/2),Ge=ue(p/2),et=ue(S/2);switch(U){case"XYZ":this._x=Oe*Me*ke+Q*Ge*et,this._y=Q*Ge*ke-Oe*Me*et,this._z=Q*Me*et+Oe*Ge*ke,this._w=Q*Me*ke-Oe*Ge*et;break;case"YXZ":this._x=Oe*Me*ke+Q*Ge*et,this._y=Q*Ge*ke-Oe*Me*et,this._z=Q*Me*et-Oe*Ge*ke,this._w=Q*Me*ke+Oe*Ge*et;break;case"ZXY":this._x=Oe*Me*ke-Q*Ge*et,this._y=Q*Ge*ke+Oe*Me*et,this._z=Q*Me*et+Oe*Ge*ke,this._w=Q*Me*ke-Oe*Ge*et;break;case"ZYX":this._x=Oe*Me*ke-Q*Ge*et,this._y=Q*Ge*ke+Oe*Me*et,this._z=Q*Me*et-Oe*Ge*ke,this._w=Q*Me*ke+Oe*Ge*et;break;case"YZX":this._x=Oe*Me*ke+Q*Ge*et,this._y=Q*Ge*ke+Oe*Me*et,this._z=Q*Me*et-Oe*Ge*ke,this._w=Q*Me*ke-Oe*Ge*et;break;case"XZY":this._x=Oe*Me*ke-Q*Ge*et,this._y=Q*Ge*ke-Oe*Me*et,this._z=Q*Me*et+Oe*Ge*ke,this._w=Q*Me*ke+Oe*Ge*et;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+U)}return!0===c&&this._onChangeCallback(),this}setFromAxisAngle(a,c){const d=c/2,p=Math.sin(d);return this._x=a.x*p,this._y=a.y*p,this._z=a.z*p,this._w=Math.cos(d),this._onChangeCallback(),this}setFromRotationMatrix(a){const c=a.elements,d=c[0],p=c[4],S=c[8],U=c[1],F=c[5],ue=c[9],Q=c[2],Me=c[6],ke=c[10],Oe=d+F+ke;if(Oe>0){const Ge=.5/Math.sqrt(Oe+1);this._w=.25/Ge,this._x=(Me-ue)*Ge,this._y=(S-Q)*Ge,this._z=(U-p)*Ge}else if(d>F&&d>ke){const Ge=2*Math.sqrt(1+d-F-ke);this._w=(Me-ue)/Ge,this._x=.25*Ge,this._y=(p+U)/Ge,this._z=(S+Q)/Ge}else if(F>ke){const Ge=2*Math.sqrt(1+F-d-ke);this._w=(S-Q)/Ge,this._x=(p+U)/Ge,this._y=.25*Ge,this._z=(ue+Me)/Ge}else{const Ge=2*Math.sqrt(1+ke-d-F);this._w=(U-p)/Ge,this._x=(S+Q)/Ge,this._y=(ue+Me)/Ge,this._z=.25*Ge}return this._onChangeCallback(),this}setFromUnitVectors(a,c){let d=a.dot(c)+1;return d<Number.EPSILON?(d=0,Math.abs(a.x)>Math.abs(a.z)?(this._x=-a.y,this._y=a.x,this._z=0,this._w=d):(this._x=0,this._y=-a.z,this._z=a.y,this._w=d)):(this._x=a.y*c.z-a.z*c.y,this._y=a.z*c.x-a.x*c.z,this._z=a.x*c.y-a.y*c.x,this._w=d),this.normalize()}angleTo(a){return 2*Math.acos(Math.abs(Yl(this.dot(a),-1,1)))}rotateTowards(a,c){const d=this.angleTo(a);if(0===d)return this;const p=Math.min(1,c/d);return this.slerp(a,p),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let a=this.length();return 0===a?(this._x=0,this._y=0,this._z=0,this._w=1):(a=1/a,this._x=this._x*a,this._y=this._y*a,this._z=this._z*a,this._w=this._w*a),this._onChangeCallback(),this}multiply(a){return this.multiplyQuaternions(this,a)}premultiply(a){return this.multiplyQuaternions(a,this)}multiplyQuaternions(a,c){const d=a._x,p=a._y,S=a._z,U=a._w,F=c._x,ue=c._y,Q=c._z,Me=c._w;return this._x=d*Me+U*F+p*Q-S*ue,this._y=p*Me+U*ue+S*F-d*Q,this._z=S*Me+U*Q+d*ue-p*F,this._w=U*Me-d*F-p*ue-S*Q,this._onChangeCallback(),this}slerp(a,c){if(0===c)return this;if(1===c)return this.copy(a);const d=this._x,p=this._y,S=this._z,U=this._w;let F=U*a._w+d*a._x+p*a._y+S*a._z;if(F<0?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,F=-F):this.copy(a),F>=1)return this._w=U,this._x=d,this._y=p,this._z=S,this;const ue=1-F*F;if(ue<=Number.EPSILON){const Ge=1-c;return this._w=Ge*U+c*this._w,this._x=Ge*d+c*this._x,this._y=Ge*p+c*this._y,this._z=Ge*S+c*this._z,this.normalize(),this}const Q=Math.sqrt(ue),Me=Math.atan2(Q,F),ke=Math.sin((1-c)*Me)/Q,Oe=Math.sin(c*Me)/Q;return this._w=U*ke+this._w*Oe,this._x=d*ke+this._x*Oe,this._y=p*ke+this._y*Oe,this._z=S*ke+this._z*Oe,this._onChangeCallback(),this}slerpQuaternions(a,c,d){return this.copy(a).slerp(c,d)}random(){const a=2*Math.PI*Math.random(),c=2*Math.PI*Math.random(),d=Math.random(),p=Math.sqrt(1-d),S=Math.sqrt(d);return this.set(p*Math.sin(a),p*Math.cos(a),S*Math.sin(c),S*Math.cos(c))}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w}fromArray(a,c=0){return this._x=a[c],this._y=a[c+1],this._z=a[c+2],this._w=a[c+3],this._onChangeCallback(),this}toArray(a=[],c=0){return a[c]=this._x,a[c+1]=this._y,a[c+2]=this._z,a[c+3]=this._w,a}fromBufferAttribute(a,c){return this._x=a.getX(c),this._y=a.getY(c),this._z=a.getZ(c),this._w=a.getW(c),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(a){return this._onChangeCallback=a,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Mn{constructor(a=0,c=0,d=0){Mn.prototype.isVector3=!0,this.x=a,this.y=c,this.z=d}set(a,c,d){return void 0===d&&(d=this.z),this.x=a,this.y=c,this.z=d,this}setScalar(a){return this.x=a,this.y=a,this.z=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}setComponent(a,c){switch(a){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;default:throw new Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this}addScalar(a){return this.x+=a,this.y+=a,this.z+=a,this}addVectors(a,c){return this.x=a.x+c.x,this.y=a.y+c.y,this.z=a.z+c.z,this}addScaledVector(a,c){return this.x+=a.x*c,this.y+=a.y*c,this.z+=a.z*c,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this}subScalar(a){return this.x-=a,this.y-=a,this.z-=a,this}subVectors(a,c){return this.x=a.x-c.x,this.y=a.y-c.y,this.z=a.z-c.z,this}multiply(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this}multiplyVectors(a,c){return this.x=a.x*c.x,this.y=a.y*c.y,this.z=a.z*c.z,this}applyEuler(a){return this.applyQuaternion(zp.setFromEuler(a))}applyAxisAngle(a,c){return this.applyQuaternion(zp.setFromAxisAngle(a,c))}applyMatrix3(a){const c=this.x,d=this.y,p=this.z,S=a.elements;return this.x=S[0]*c+S[3]*d+S[6]*p,this.y=S[1]*c+S[4]*d+S[7]*p,this.z=S[2]*c+S[5]*d+S[8]*p,this}applyNormalMatrix(a){return this.applyMatrix3(a).normalize()}applyMatrix4(a){const c=this.x,d=this.y,p=this.z,S=a.elements,U=1/(S[3]*c+S[7]*d+S[11]*p+S[15]);return this.x=(S[0]*c+S[4]*d+S[8]*p+S[12])*U,this.y=(S[1]*c+S[5]*d+S[9]*p+S[13])*U,this.z=(S[2]*c+S[6]*d+S[10]*p+S[14])*U,this}applyQuaternion(a){const c=this.x,d=this.y,p=this.z,S=a.x,U=a.y,F=a.z,ue=a.w,Q=2*(U*p-F*d),Me=2*(F*c-S*p),ke=2*(S*d-U*c);return this.x=c+ue*Q+U*ke-F*Me,this.y=d+ue*Me+F*Q-S*ke,this.z=p+ue*ke+S*Me-U*Q,this}project(a){return this.applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix)}unproject(a){return this.applyMatrix4(a.projectionMatrixInverse).applyMatrix4(a.matrixWorld)}transformDirection(a){const c=this.x,d=this.y,p=this.z,S=a.elements;return this.x=S[0]*c+S[4]*d+S[8]*p,this.y=S[1]*c+S[5]*d+S[9]*p,this.z=S[2]*c+S[6]*d+S[10]*p,this.normalize()}divide(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this}divideScalar(a){return this.multiplyScalar(1/a)}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this}clamp(a,c){return this.x=Math.max(a.x,Math.min(c.x,this.x)),this.y=Math.max(a.y,Math.min(c.y,this.y)),this.z=Math.max(a.z,Math.min(c.z,this.z)),this}clampScalar(a,c){return this.x=Math.max(a,Math.min(c,this.x)),this.y=Math.max(a,Math.min(c,this.y)),this.z=Math.max(a,Math.min(c,this.z)),this}clampLength(a,c){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(a,Math.min(c,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,c){return this.x+=(a.x-this.x)*c,this.y+=(a.y-this.y)*c,this.z+=(a.z-this.z)*c,this}lerpVectors(a,c,d){return this.x=a.x+(c.x-a.x)*d,this.y=a.y+(c.y-a.y)*d,this.z=a.z+(c.z-a.z)*d,this}cross(a){return this.crossVectors(this,a)}crossVectors(a,c){const d=a.x,p=a.y,S=a.z,U=c.x,F=c.y,ue=c.z;return this.x=p*ue-S*F,this.y=S*U-d*ue,this.z=d*F-p*U,this}projectOnVector(a){const c=a.lengthSq();if(0===c)return this.set(0,0,0);const d=a.dot(this)/c;return this.copy(a).multiplyScalar(d)}projectOnPlane(a){return oa.copy(this).projectOnVector(a),this.sub(oa)}reflect(a){return this.sub(oa.copy(a).multiplyScalar(2*this.dot(a)))}angleTo(a){const c=Math.sqrt(this.lengthSq()*a.lengthSq());if(0===c)return Math.PI/2;const d=this.dot(a)/c;return Math.acos(Yl(d,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const c=this.x-a.x,d=this.y-a.y,p=this.z-a.z;return c*c+d*d+p*p}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)}setFromSpherical(a){return this.setFromSphericalCoords(a.radius,a.phi,a.theta)}setFromSphericalCoords(a,c,d){const p=Math.sin(c)*a;return this.x=p*Math.sin(d),this.y=Math.cos(c)*a,this.z=p*Math.cos(d),this}setFromCylindrical(a){return this.setFromCylindricalCoords(a.radius,a.theta,a.y)}setFromCylindricalCoords(a,c,d){return this.x=a*Math.sin(c),this.y=d,this.z=a*Math.cos(c),this}setFromMatrixPosition(a){const c=a.elements;return this.x=c[12],this.y=c[13],this.z=c[14],this}setFromMatrixScale(a){const c=this.setFromMatrixColumn(a,0).length(),d=this.setFromMatrixColumn(a,1).length(),p=this.setFromMatrixColumn(a,2).length();return this.x=c,this.y=d,this.z=p,this}setFromMatrixColumn(a,c){return this.fromArray(a.elements,4*c)}setFromMatrix3Column(a,c){return this.fromArray(a.elements,3*c)}setFromEuler(a){return this.x=a._x,this.y=a._y,this.z=a._z,this}setFromColor(a){return this.x=a.r,this.y=a.g,this.z=a.b,this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z}fromArray(a,c=0){return this.x=a[c],this.y=a[c+1],this.z=a[c+2],this}toArray(a=[],c=0){return a[c]=this.x,a[c+1]=this.y,a[c+2]=this.z,a}fromBufferAttribute(a,c){return this.x=a.getX(c),this.y=a.getY(c),this.z=a.getZ(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const a=Math.random()*Math.PI*2,c=2*Math.random()-1,d=Math.sqrt(1-c*c);return this.x=d*Math.cos(a),this.y=c,this.z=d*Math.sin(a),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const oa=new Mn,zp=new $i;class Pc{constructor(a=new Mn(1/0,1/0,1/0),c=new Mn(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=a,this.max=c}set(a,c){return this.min.copy(a),this.max.copy(c),this}setFromArray(a){this.makeEmpty();for(let c=0,d=a.length;c<d;c+=3)this.expandByPoint(Wu.fromArray(a,c));return this}setFromBufferAttribute(a){this.makeEmpty();for(let c=0,d=a.count;c<d;c++)this.expandByPoint(Wu.fromBufferAttribute(a,c));return this}setFromPoints(a){this.makeEmpty();for(let c=0,d=a.length;c<d;c++)this.expandByPoint(a[c]);return this}setFromCenterAndSize(a,c){const d=Wu.copy(c).multiplyScalar(.5);return this.min.copy(a).sub(d),this.max.copy(a).add(d),this}setFromObject(a,c=!1){return this.makeEmpty(),this.expandByObject(a,c)}clone(){return(new this.constructor).copy(this)}copy(a){return this.min.copy(a.min),this.max.copy(a.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(a){return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)}expandByPoint(a){return this.min.min(a),this.max.max(a),this}expandByVector(a){return this.min.sub(a),this.max.add(a),this}expandByScalar(a){return this.min.addScalar(-a),this.max.addScalar(a),this}expandByObject(a,c=!1){a.updateWorldMatrix(!1,!1);const d=a.geometry;if(void 0!==d){const S=d.getAttribute("position");if(!0===c&&void 0!==S&&!0!==a.isInstancedMesh)for(let U=0,F=S.count;U<F;U++)!0===a.isMesh?a.getVertexPosition(U,Wu):Wu.fromBufferAttribute(S,U),Wu.applyMatrix4(a.matrixWorld),this.expandByPoint(Wu);else void 0!==a.boundingBox?(null===a.boundingBox&&a.computeBoundingBox(),Gh.copy(a.boundingBox)):(null===d.boundingBox&&d.computeBoundingBox(),Gh.copy(d.boundingBox)),Gh.applyMatrix4(a.matrixWorld),this.union(Gh)}const p=a.children;for(let S=0,U=p.length;S<U;S++)this.expandByObject(p[S],c);return this}containsPoint(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z)}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z}getParameter(a,c){return c.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z)}intersectsSphere(a){return this.clampPoint(a.center,Wu),Wu.distanceToSquared(a.center)<=a.radius*a.radius}intersectsPlane(a){let c,d;return a.normal.x>0?(c=a.normal.x*this.min.x,d=a.normal.x*this.max.x):(c=a.normal.x*this.max.x,d=a.normal.x*this.min.x),a.normal.y>0?(c+=a.normal.y*this.min.y,d+=a.normal.y*this.max.y):(c+=a.normal.y*this.max.y,d+=a.normal.y*this.min.y),a.normal.z>0?(c+=a.normal.z*this.min.z,d+=a.normal.z*this.max.z):(c+=a.normal.z*this.max.z,d+=a.normal.z*this.min.z),c<=-a.constant&&d>=-a.constant}intersectsTriangle(a){if(this.isEmpty())return!1;this.getCenter(ip),Nm.subVectors(this.max,ip),uf.subVectors(a.a,ip),np.subVectors(a.b,ip),Hp.subVectors(a.c,ip),Rc.subVectors(np,uf),Ai.subVectors(Hp,np),Td.subVectors(uf,Hp);let c=[0,-Rc.z,Rc.y,0,-Ai.z,Ai.y,0,-Td.z,Td.y,Rc.z,0,-Rc.x,Ai.z,0,-Ai.x,Td.z,0,-Td.x,-Rc.y,Rc.x,0,-Ai.y,Ai.x,0,-Td.y,Td.x,0];return!(!Gp(c,uf,np,Hp,Nm)||(c=[1,0,0,0,1,0,0,0,1],!Gp(c,uf,np,Hp,Nm)))&&(Vp.crossVectors(Rc,Ai),c=[Vp.x,Vp.y,Vp.z],Gp(c,uf,np,Hp,Nm))}clampPoint(a,c){return c.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,Wu).distanceTo(a)}getBoundingSphere(a){return this.isEmpty()?a.makeEmpty():(this.getCenter(a.center),a.radius=.5*this.getSize(Wu).length()),a}intersect(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this}union(a){return this.min.min(a.min),this.max.max(a.max),this}applyMatrix4(a){return this.isEmpty()||(ud[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a),ud[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a),ud[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a),ud[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a),ud[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a),ud[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a),ud[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a),ud[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a),this.setFromPoints(ud)),this}translate(a){return this.min.add(a),this.max.add(a),this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}const ud=[new Mn,new Mn,new Mn,new Mn,new Mn,new Mn,new Mn,new Mn],Wu=new Mn,Gh=new Pc,uf=new Mn,np=new Mn,Hp=new Mn,Rc=new Mn,Ai=new Mn,Td=new Mn,ip=new Mn,Nm=new Mn,Vp=new Mn,df=new Mn;function Gp(M,a,c,d,p){for(let S=0,U=M.length-3;S<=U;S+=3){df.fromArray(M,S);const F=p.x*Math.abs(df.x)+p.y*Math.abs(df.y)+p.z*Math.abs(df.z),ue=a.dot(df),Q=c.dot(df),Me=d.dot(df);if(Math.max(-Math.max(ue,Q,Me),Math.min(ue,Q,Me))>F)return!1}return!0}const Xx=new Pc,$g=new Mn,Ty=new Mn;class Qc{constructor(a=new Mn,c=-1){this.isSphere=!0,this.center=a,this.radius=c}set(a,c){return this.center.copy(a),this.radius=c,this}setFromPoints(a,c){const d=this.center;void 0!==c?d.copy(c):Xx.setFromPoints(a).getCenter(d);let p=0;for(let S=0,U=a.length;S<U;S++)p=Math.max(p,d.distanceToSquared(a[S]));return this.radius=Math.sqrt(p),this}copy(a){return this.center.copy(a.center),this.radius=a.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(a){return a.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(a){return a.distanceTo(this.center)-this.radius}intersectsSphere(a){const c=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=c*c}intersectsBox(a){return a.intersectsSphere(this)}intersectsPlane(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius}clampPoint(a,c){const d=this.center.distanceToSquared(a);return c.copy(a),d>this.radius*this.radius&&(c.sub(this.center).normalize(),c.multiplyScalar(this.radius).add(this.center)),c}getBoundingBox(a){return this.isEmpty()?(a.makeEmpty(),a):(a.set(this.center,this.center),a.expandByScalar(this.radius),a)}applyMatrix4(a){return this.center.applyMatrix4(a),this.radius=this.radius*a.getMaxScaleOnAxis(),this}translate(a){return this.center.add(a),this}expandByPoint(a){if(this.isEmpty())return this.center.copy(a),this.radius=0,this;$g.subVectors(a,this.center);const c=$g.lengthSq();if(c>this.radius*this.radius){const d=Math.sqrt(c),p=.5*(d-this.radius);this.center.addScaledVector($g,p/d),this.radius+=p}return this}union(a){return a.isEmpty()?this:this.isEmpty()?(this.copy(a),this):(!0===this.center.equals(a.center)?this.radius=Math.max(this.radius,a.radius):(Ty.subVectors(a.center,this.center).setLength(a.radius),this.expandByPoint($g.copy(a.center).add(Ty)),this.expandByPoint($g.copy(a.center).sub(Ty))),this)}equals(a){return a.center.equals(this.center)&&a.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const rp=new Mn,FA=new Mn,K0=new Cs;class Dd{constructor(a=new Mn(1,0,0),c=0){this.isPlane=!0,this.normal=a,this.constant=c}set(a,c){return this.normal.copy(a),this.constant=c,this}setComponents(a,c,d,p){return this.normal.set(a,c,d),this.constant=p,this}setFromNormalAndCoplanarPoint(a,c){return this.normal.copy(a),this.constant=-c.dot(this.normal),this}setFromCoplanarPoints(a,c,d){const p=rp.subVectors(d,c).cross(FA.subVectors(a,c)).normalize();return this.setFromNormalAndCoplanarPoint(p,a),this}copy(a){return this.normal.copy(a.normal),this.constant=a.constant,this}normalize(){const a=1/this.normal.length();return this.normal.multiplyScalar(a),this.constant*=a,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(a){return this.normal.dot(a)+this.constant}distanceToSphere(a){return this.distanceToPoint(a.center)-a.radius}projectPoint(a,c){return c.copy(a).addScaledVector(this.normal,-this.distanceToPoint(a))}intersectLine(a,c){const d=a.delta(rp),p=this.normal.dot(d);if(0===p)return 0===this.distanceToPoint(a.start)?c.copy(a.start):null;const S=-(a.start.dot(this.normal)+this.constant)/p;return S<0||S>1?null:c.copy(a.start).addScaledVector(d,S)}intersectsLine(a){const c=this.distanceToPoint(a.start),d=this.distanceToPoint(a.end);return c<0&&d>0||d<0&&c>0}intersectsBox(a){return a.intersectsPlane(this)}intersectsSphere(a){return a.intersectsPlane(this)}coplanarPoint(a){return a.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(a,c){const d=c||K0.getNormalMatrix(a),p=this.coplanarPoint(rp).applyMatrix4(a),S=this.normal.applyMatrix3(d).normalize();return this.constant=-p.dot(S),this}translate(a){return this.constant-=a.dot(this.normal),this}equals(a){return a.normal.equals(this.normal)&&a.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const sp=new Qc,Kl=new Mn;class ff{constructor(a=new Dd,c=new Dd,d=new Dd,p=new Dd,S=new Dd,U=new Dd){this.planes=[a,c,d,p,S,U]}set(a,c,d,p,S,U){const F=this.planes;return F[0].copy(a),F[1].copy(c),F[2].copy(d),F[3].copy(p),F[4].copy(S),F[5].copy(U),this}copy(a){const c=this.planes;for(let d=0;d<6;d++)c[d].copy(a.planes[d]);return this}setFromProjectionMatrix(a,c=Qu){const d=this.planes,p=a.elements,S=p[0],U=p[1],F=p[2],ue=p[3],Q=p[4],Me=p[5],ke=p[6],Oe=p[7],Ge=p[8],et=p[9],vt=p[10],Ye=p[11],je=p[12],Rt=p[13],At=p[14],Ht=p[15];if(d[0].setComponents(ue-S,Oe-Q,Ye-Ge,Ht-je).normalize(),d[1].setComponents(ue+S,Oe+Q,Ye+Ge,Ht+je).normalize(),d[2].setComponents(ue+U,Oe+Me,Ye+et,Ht+Rt).normalize(),d[3].setComponents(ue-U,Oe-Me,Ye-et,Ht-Rt).normalize(),d[4].setComponents(ue-F,Oe-ke,Ye-vt,Ht-At).normalize(),c===Qu)d[5].setComponents(ue+F,Oe+ke,Ye+vt,Ht+At).normalize();else{if(2001!==c)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+c);d[5].setComponents(F,ke,vt,At).normalize()}return this}intersectsObject(a){if(void 0!==a.boundingSphere)null===a.boundingSphere&&a.computeBoundingSphere(),sp.copy(a.boundingSphere).applyMatrix4(a.matrixWorld);else{const c=a.geometry;null===c.boundingSphere&&c.computeBoundingSphere(),sp.copy(c.boundingSphere).applyMatrix4(a.matrixWorld)}return this.intersectsSphere(sp)}intersectsSprite(a){return sp.center.set(0,0,0),sp.radius=.7071067811865476,sp.applyMatrix4(a.matrixWorld),this.intersectsSphere(sp)}intersectsSphere(a){const c=this.planes,d=a.center,p=-a.radius;for(let S=0;S<6;S++)if(c[S].distanceToPoint(d)<p)return!1;return!0}intersectsBox(a){const c=this.planes;for(let d=0;d<6;d++){const p=c[d];if(Kl.x=p.normal.x>0?a.max.x:a.min.x,Kl.y=p.normal.y>0?a.max.y:a.min.y,Kl.z=p.normal.z>0?a.max.z:a.min.z,p.distanceToPoint(Kl)<0)return!1}return!0}containsPoint(a){const c=this.planes;for(let d=0;d<6;d++)if(c[d].distanceToPoint(a)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class mo{constructor(a,c,d,p,S,U,F,ue,Q,Me,ke,Oe,Ge,et,vt,Ye){mo.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==a&&this.set(a,c,d,p,S,U,F,ue,Q,Me,ke,Oe,Ge,et,vt,Ye)}set(a,c,d,p,S,U,F,ue,Q,Me,ke,Oe,Ge,et,vt,Ye){const je=this.elements;return je[0]=a,je[4]=c,je[8]=d,je[12]=p,je[1]=S,je[5]=U,je[9]=F,je[13]=ue,je[2]=Q,je[6]=Me,je[10]=ke,je[14]=Oe,je[3]=Ge,je[7]=et,je[11]=vt,je[15]=Ye,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new mo).fromArray(this.elements)}copy(a){const c=this.elements,d=a.elements;return c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],this}copyPosition(a){const c=this.elements,d=a.elements;return c[12]=d[12],c[13]=d[13],c[14]=d[14],this}setFromMatrix3(a){const c=a.elements;return this.set(c[0],c[3],c[6],0,c[1],c[4],c[7],0,c[2],c[5],c[8],0,0,0,0,1),this}extractBasis(a,c,d){return a.setFromMatrixColumn(this,0),c.setFromMatrixColumn(this,1),d.setFromMatrixColumn(this,2),this}makeBasis(a,c,d){return this.set(a.x,c.x,d.x,0,a.y,c.y,d.y,0,a.z,c.z,d.z,0,0,0,0,1),this}extractRotation(a){const c=this.elements,d=a.elements,p=1/uo.setFromMatrixColumn(a,0).length(),S=1/uo.setFromMatrixColumn(a,1).length(),U=1/uo.setFromMatrixColumn(a,2).length();return c[0]=d[0]*p,c[1]=d[1]*p,c[2]=d[2]*p,c[3]=0,c[4]=d[4]*S,c[5]=d[5]*S,c[6]=d[6]*S,c[7]=0,c[8]=d[8]*U,c[9]=d[9]*U,c[10]=d[10]*U,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromEuler(a){const c=this.elements,d=a.x,p=a.y,S=a.z,U=Math.cos(d),F=Math.sin(d),ue=Math.cos(p),Q=Math.sin(p),Me=Math.cos(S),ke=Math.sin(S);if("XYZ"===a.order){const Oe=U*Me,Ge=U*ke,et=F*Me,vt=F*ke;c[0]=ue*Me,c[4]=-ue*ke,c[8]=Q,c[1]=Ge+et*Q,c[5]=Oe-vt*Q,c[9]=-F*ue,c[2]=vt-Oe*Q,c[6]=et+Ge*Q,c[10]=U*ue}else if("YXZ"===a.order){const Oe=ue*Me,Ge=ue*ke,et=Q*Me,vt=Q*ke;c[0]=Oe+vt*F,c[4]=et*F-Ge,c[8]=U*Q,c[1]=U*ke,c[5]=U*Me,c[9]=-F,c[2]=Ge*F-et,c[6]=vt+Oe*F,c[10]=U*ue}else if("ZXY"===a.order){const Oe=ue*Me,Ge=ue*ke,et=Q*Me,vt=Q*ke;c[0]=Oe-vt*F,c[4]=-U*ke,c[8]=et+Ge*F,c[1]=Ge+et*F,c[5]=U*Me,c[9]=vt-Oe*F,c[2]=-U*Q,c[6]=F,c[10]=U*ue}else if("ZYX"===a.order){const Oe=U*Me,Ge=U*ke,et=F*Me,vt=F*ke;c[0]=ue*Me,c[4]=et*Q-Ge,c[8]=Oe*Q+vt,c[1]=ue*ke,c[5]=vt*Q+Oe,c[9]=Ge*Q-et,c[2]=-Q,c[6]=F*ue,c[10]=U*ue}else if("YZX"===a.order){const Oe=U*ue,Ge=U*Q,et=F*ue,vt=F*Q;c[0]=ue*Me,c[4]=vt-Oe*ke,c[8]=et*ke+Ge,c[1]=ke,c[5]=U*Me,c[9]=-F*Me,c[2]=-Q*Me,c[6]=Ge*ke+et,c[10]=Oe-vt*ke}else if("XZY"===a.order){const Oe=U*ue,Ge=U*Q,et=F*ue,vt=F*Q;c[0]=ue*Me,c[4]=-ke,c[8]=Q*Me,c[1]=Oe*ke+vt,c[5]=U*Me,c[9]=Ge*ke-et,c[2]=et*ke-Ge,c[6]=F*Me,c[10]=vt*ke+Oe}return c[3]=0,c[7]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromQuaternion(a){return this.compose(Dy,a,Iy)}lookAt(a,c,d){const p=this.elements;return qh.subVectors(a,c),0===qh.lengthSq()&&(qh.z=1),qh.normalize(),yu.crossVectors(d,qh),0===yu.lengthSq()&&(1===Math.abs(d.z)?qh.x+=1e-4:qh.z+=1e-4,qh.normalize(),yu.crossVectors(d,qh)),yu.normalize(),Um.crossVectors(qh,yu),p[0]=yu.x,p[4]=Um.x,p[8]=qh.x,p[1]=yu.y,p[5]=Um.y,p[9]=qh.y,p[2]=yu.z,p[6]=Um.z,p[10]=qh.z,this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,c){const d=a.elements,p=c.elements,S=this.elements,U=d[0],F=d[4],ue=d[8],Q=d[12],Me=d[1],ke=d[5],Oe=d[9],Ge=d[13],et=d[2],vt=d[6],Ye=d[10],je=d[14],Rt=d[3],At=d[7],Ht=d[11],Pn=d[15],yn=p[0],xn=p[4],qn=p[8],wi=p[12],Ut=p[1],En=p[5],rr=p[9],lr=p[13],Yn=p[2],Qi=p[6],Oi=p[10],er=p[14],Xi=p[3],Vi=p[7],Vr=p[11],Hr=p[15];return S[0]=U*yn+F*Ut+ue*Yn+Q*Xi,S[4]=U*xn+F*En+ue*Qi+Q*Vi,S[8]=U*qn+F*rr+ue*Oi+Q*Vr,S[12]=U*wi+F*lr+ue*er+Q*Hr,S[1]=Me*yn+ke*Ut+Oe*Yn+Ge*Xi,S[5]=Me*xn+ke*En+Oe*Qi+Ge*Vi,S[9]=Me*qn+ke*rr+Oe*Oi+Ge*Vr,S[13]=Me*wi+ke*lr+Oe*er+Ge*Hr,S[2]=et*yn+vt*Ut+Ye*Yn+je*Xi,S[6]=et*xn+vt*En+Ye*Qi+je*Vi,S[10]=et*qn+vt*rr+Ye*Oi+je*Vr,S[14]=et*wi+vt*lr+Ye*er+je*Hr,S[3]=Rt*yn+At*Ut+Ht*Yn+Pn*Xi,S[7]=Rt*xn+At*En+Ht*Qi+Pn*Vi,S[11]=Rt*qn+At*rr+Ht*Oi+Pn*Vr,S[15]=Rt*wi+At*lr+Ht*er+Pn*Hr,this}multiplyScalar(a){const c=this.elements;return c[0]*=a,c[4]*=a,c[8]*=a,c[12]*=a,c[1]*=a,c[5]*=a,c[9]*=a,c[13]*=a,c[2]*=a,c[6]*=a,c[10]*=a,c[14]*=a,c[3]*=a,c[7]*=a,c[11]*=a,c[15]*=a,this}determinant(){const a=this.elements,c=a[0],d=a[4],p=a[8],S=a[12],U=a[1],F=a[5],ue=a[9],Q=a[13],Me=a[2],ke=a[6],Oe=a[10],Ge=a[14];return a[3]*(+S*ue*ke-p*Q*ke-S*F*Oe+d*Q*Oe+p*F*Ge-d*ue*Ge)+a[7]*(+c*ue*Ge-c*Q*Oe+S*U*Oe-p*U*Ge+p*Q*Me-S*ue*Me)+a[11]*(+c*Q*ke-c*F*Ge-S*U*ke+d*U*Ge+S*F*Me-d*Q*Me)+a[15]*(-p*F*Me-c*ue*ke+c*F*Oe+p*U*ke-d*U*Oe+d*ue*Me)}transpose(){const a=this.elements;let c;return c=a[1],a[1]=a[4],a[4]=c,c=a[2],a[2]=a[8],a[8]=c,c=a[6],a[6]=a[9],a[9]=c,c=a[3],a[3]=a[12],a[12]=c,c=a[7],a[7]=a[13],a[13]=c,c=a[11],a[11]=a[14],a[14]=c,this}setPosition(a,c,d){const p=this.elements;return a.isVector3?(p[12]=a.x,p[13]=a.y,p[14]=a.z):(p[12]=a,p[13]=c,p[14]=d),this}invert(){const a=this.elements,c=a[0],d=a[1],p=a[2],S=a[3],U=a[4],F=a[5],ue=a[6],Q=a[7],Me=a[8],ke=a[9],Oe=a[10],Ge=a[11],et=a[12],vt=a[13],Ye=a[14],je=a[15],Rt=ke*Ye*Q-vt*Oe*Q+vt*ue*Ge-F*Ye*Ge-ke*ue*je+F*Oe*je,At=et*Oe*Q-Me*Ye*Q-et*ue*Ge+U*Ye*Ge+Me*ue*je-U*Oe*je,Ht=Me*vt*Q-et*ke*Q+et*F*Ge-U*vt*Ge-Me*F*je+U*ke*je,Pn=et*ke*ue-Me*vt*ue-et*F*Oe+U*vt*Oe+Me*F*Ye-U*ke*Ye,yn=c*Rt+d*At+p*Ht+S*Pn;if(0===yn)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const xn=1/yn;return a[0]=Rt*xn,a[1]=(vt*Oe*S-ke*Ye*S-vt*p*Ge+d*Ye*Ge+ke*p*je-d*Oe*je)*xn,a[2]=(F*Ye*S-vt*ue*S+vt*p*Q-d*Ye*Q-F*p*je+d*ue*je)*xn,a[3]=(ke*ue*S-F*Oe*S-ke*p*Q+d*Oe*Q+F*p*Ge-d*ue*Ge)*xn,a[4]=At*xn,a[5]=(Me*Ye*S-et*Oe*S+et*p*Ge-c*Ye*Ge-Me*p*je+c*Oe*je)*xn,a[6]=(et*ue*S-U*Ye*S-et*p*Q+c*Ye*Q+U*p*je-c*ue*je)*xn,a[7]=(U*Oe*S-Me*ue*S+Me*p*Q-c*Oe*Q-U*p*Ge+c*ue*Ge)*xn,a[8]=Ht*xn,a[9]=(et*ke*S-Me*vt*S-et*d*Ge+c*vt*Ge+Me*d*je-c*ke*je)*xn,a[10]=(U*vt*S-et*F*S+et*d*Q-c*vt*Q-U*d*je+c*F*je)*xn,a[11]=(Me*F*S-U*ke*S-Me*d*Q+c*ke*Q+U*d*Ge-c*F*Ge)*xn,a[12]=Pn*xn,a[13]=(Me*vt*p-et*ke*p+et*d*Oe-c*vt*Oe-Me*d*Ye+c*ke*Ye)*xn,a[14]=(et*F*p-U*vt*p-et*d*ue+c*vt*ue+U*d*Ye-c*F*Ye)*xn,a[15]=(U*ke*p-Me*F*p+Me*d*ue-c*ke*ue-U*d*Oe+c*F*Oe)*xn,this}scale(a){const c=this.elements,d=a.x,p=a.y,S=a.z;return c[0]*=d,c[4]*=p,c[8]*=S,c[1]*=d,c[5]*=p,c[9]*=S,c[2]*=d,c[6]*=p,c[10]*=S,c[3]*=d,c[7]*=p,c[11]*=S,this}getMaxScaleOnAxis(){const a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))}makeTranslation(a,c,d){return a.isVector3?this.set(1,0,0,a.x,0,1,0,a.y,0,0,1,a.z,0,0,0,1):this.set(1,0,0,a,0,1,0,c,0,0,1,d,0,0,0,1),this}makeRotationX(a){const c=Math.cos(a),d=Math.sin(a);return this.set(1,0,0,0,0,c,-d,0,0,d,c,0,0,0,0,1),this}makeRotationY(a){const c=Math.cos(a),d=Math.sin(a);return this.set(c,0,d,0,0,1,0,0,-d,0,c,0,0,0,0,1),this}makeRotationZ(a){const c=Math.cos(a),d=Math.sin(a);return this.set(c,-d,0,0,d,c,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(a,c){const d=Math.cos(c),p=Math.sin(c),S=1-d,U=a.x,F=a.y,ue=a.z,Q=S*U,Me=S*F;return this.set(Q*U+d,Q*F-p*ue,Q*ue+p*F,0,Q*F+p*ue,Me*F+d,Me*ue-p*U,0,Q*ue-p*F,Me*ue+p*U,S*ue*ue+d,0,0,0,0,1),this}makeScale(a,c,d){return this.set(a,0,0,0,0,c,0,0,0,0,d,0,0,0,0,1),this}makeShear(a,c,d,p,S,U){return this.set(1,d,S,0,a,1,U,0,c,p,1,0,0,0,0,1),this}compose(a,c,d){const p=this.elements,S=c._x,U=c._y,F=c._z,ue=c._w,Q=S+S,Me=U+U,ke=F+F,Oe=S*Q,Ge=S*Me,et=S*ke,vt=U*Me,Ye=U*ke,je=F*ke,Rt=ue*Q,At=ue*Me,Ht=ue*ke,Pn=d.x,yn=d.y,xn=d.z;return p[0]=(1-(vt+je))*Pn,p[1]=(Ge+Ht)*Pn,p[2]=(et-At)*Pn,p[3]=0,p[4]=(Ge-Ht)*yn,p[5]=(1-(Oe+je))*yn,p[6]=(Ye+Rt)*yn,p[7]=0,p[8]=(et+At)*xn,p[9]=(Ye-Rt)*xn,p[10]=(1-(Oe+vt))*xn,p[11]=0,p[12]=a.x,p[13]=a.y,p[14]=a.z,p[15]=1,this}decompose(a,c,d){const p=this.elements;let S=uo.set(p[0],p[1],p[2]).length();const U=uo.set(p[4],p[5],p[6]).length(),F=uo.set(p[8],p[9],p[10]).length();this.determinant()<0&&(S=-S),a.x=p[12],a.y=p[13],a.z=p[14],$o.copy(this);const Q=1/S,Me=1/U,ke=1/F;return $o.elements[0]*=Q,$o.elements[1]*=Q,$o.elements[2]*=Q,$o.elements[4]*=Me,$o.elements[5]*=Me,$o.elements[6]*=Me,$o.elements[8]*=ke,$o.elements[9]*=ke,$o.elements[10]*=ke,c.setFromRotationMatrix($o),d.x=S,d.y=U,d.z=F,this}makePerspective(a,c,d,p,S,U,F=Qu){const ue=this.elements,Q=2*S/(c-a),Me=2*S/(d-p),ke=(c+a)/(c-a),Oe=(d+p)/(d-p);let Ge,et;if(F===Qu)Ge=-(U+S)/(U-S),et=-2*U*S/(U-S);else{if(2001!==F)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+F);Ge=-U/(U-S),et=-U*S/(U-S)}return ue[0]=Q,ue[4]=0,ue[8]=ke,ue[12]=0,ue[1]=0,ue[5]=Me,ue[9]=Oe,ue[13]=0,ue[2]=0,ue[6]=0,ue[10]=Ge,ue[14]=et,ue[3]=0,ue[7]=0,ue[11]=-1,ue[15]=0,this}makeOrthographic(a,c,d,p,S,U,F=Qu){const ue=this.elements,Q=1/(c-a),Me=1/(d-p),ke=1/(U-S),Oe=(c+a)*Q,Ge=(d+p)*Me;let et,vt;if(F===Qu)et=(U+S)*ke,vt=-2*ke;else{if(2001!==F)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+F);et=S*ke,vt=-1*ke}return ue[0]=2*Q,ue[4]=0,ue[8]=0,ue[12]=-Oe,ue[1]=0,ue[5]=2*Me,ue[9]=0,ue[13]=-Ge,ue[2]=0,ue[6]=0,ue[10]=vt,ue[14]=-et,ue[3]=0,ue[7]=0,ue[11]=0,ue[15]=1,this}equals(a){const c=this.elements,d=a.elements;for(let p=0;p<16;p++)if(c[p]!==d[p])return!1;return!0}fromArray(a,c=0){for(let d=0;d<16;d++)this.elements[d]=a[d+c];return this}toArray(a=[],c=0){const d=this.elements;return a[c]=d[0],a[c+1]=d[1],a[c+2]=d[2],a[c+3]=d[3],a[c+4]=d[4],a[c+5]=d[5],a[c+6]=d[6],a[c+7]=d[7],a[c+8]=d[8],a[c+9]=d[9],a[c+10]=d[10],a[c+11]=d[11],a[c+12]=d[12],a[c+13]=d[13],a[c+14]=d[14],a[c+15]=d[15],a}}const uo=new Mn,$o=new mo,Dy=new Mn(0,0,0),Iy=new Mn(1,1,1),yu=new Mn,Um=new Mn,qh=new Mn;function zm(){let M=null,a=!1,c=null,d=null;function p(S,U){c(S,U),d=M.requestAnimationFrame(p)}return{start:function(){!0!==a&&null!==c&&(d=M.requestAnimationFrame(p),a=!0)},stop:function(){M.cancelAnimationFrame(d),a=!1},setAnimationLoop:function(S){c=S},setContext:function(S){M=S}}}function Xo(M,a){const c=a.isWebGL2,d=new WeakMap;return{get:function U(Q){return Q.isInterleavedBufferAttribute&&(Q=Q.data),d.get(Q)},remove:function F(Q){Q.isInterleavedBufferAttribute&&(Q=Q.data);const Me=d.get(Q);Me&&(M.deleteBuffer(Me.buffer),d.delete(Q))},update:function ue(Q,Me){if(Q.isGLBufferAttribute){const Oe=d.get(Q);return void((!Oe||Oe.version<Q.version)&&d.set(Q,{buffer:Q.buffer,type:Q.type,bytesPerElement:Q.elementSize,version:Q.version}))}Q.isInterleavedBufferAttribute&&(Q=Q.data);const ke=d.get(Q);if(void 0===ke)d.set(Q,function p(Q,Me){const ke=Q.array,Oe=Q.usage,Ge=ke.byteLength,et=M.createBuffer();let vt;if(M.bindBuffer(Me,et),M.bufferData(Me,ke,Oe),Q.onUploadCallback(),ke instanceof Float32Array)vt=M.FLOAT;else if(ke instanceof Uint16Array)if(Q.isFloat16BufferAttribute){if(!c)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");vt=M.HALF_FLOAT}else vt=M.UNSIGNED_SHORT;else if(ke instanceof Int16Array)vt=M.SHORT;else if(ke instanceof Uint32Array)vt=M.UNSIGNED_INT;else if(ke instanceof Int32Array)vt=M.INT;else if(ke instanceof Int8Array)vt=M.BYTE;else if(ke instanceof Uint8Array)vt=M.UNSIGNED_BYTE;else{if(!(ke instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+ke);vt=M.UNSIGNED_BYTE}return{buffer:et,type:vt,bytesPerElement:ke.BYTES_PER_ELEMENT,version:Q.version,size:Ge}}(Q,Me));else if(ke.version<Q.version){if(ke.size!==Q.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");(function S(Q,Me,ke){const Oe=Me.array,Ge=Me._updateRange,et=Me.updateRanges;if(M.bindBuffer(ke,Q),-1===Ge.count&&0===et.length&&M.bufferSubData(ke,0,Oe),0!==et.length){for(let vt=0,Ye=et.length;vt<Ye;vt++){const je=et[vt];c?M.bufferSubData(ke,je.start*Oe.BYTES_PER_ELEMENT,Oe,je.start,je.count):M.bufferSubData(ke,je.start*Oe.BYTES_PER_ELEMENT,Oe.subarray(je.start,je.start+je.count))}Me.clearUpdateRanges()}-1!==Ge.count&&(c?M.bufferSubData(ke,Ge.offset*Oe.BYTES_PER_ELEMENT,Oe,Ge.offset,Ge.count):M.bufferSubData(ke,Ge.offset*Oe.BYTES_PER_ELEMENT,Oe.subarray(Ge.offset,Ge.offset+Ge.count)),Ge.count=-1),Me.onUploadCallback()})(ke.buffer,Q,Me),ke.version=Q.version}}}}const Il=new Mn,pf=new Ki;class tl{constructor(a,c,d=!1){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=a,this.itemSize=c,this.count=void 0!==a?a.length/c:0,this.normalized=d,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=dn,this.version=0}onUploadCallback(){}set needsUpdate(a){!0===a&&this.version++}get updateRange(){return function Ey(M){M in jg||(jg[M]=!0,console.warn(M))}("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(a){return this.usage=a,this}addUpdateRange(a,c){this.updateRanges.push({start:a,count:c})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){return this.name=a.name,this.array=new a.array.constructor(a.array),this.itemSize=a.itemSize,this.count=a.count,this.normalized=a.normalized,this.usage=a.usage,this.gpuType=a.gpuType,this}copyAt(a,c,d){a*=this.itemSize,d*=c.itemSize;for(let p=0,S=this.itemSize;p<S;p++)this.array[a+p]=c.array[d+p];return this}copyArray(a){return this.array.set(a),this}applyMatrix3(a){if(2===this.itemSize)for(let c=0,d=this.count;c<d;c++)pf.fromBufferAttribute(this,c),pf.applyMatrix3(a),this.setXY(c,pf.x,pf.y);else if(3===this.itemSize)for(let c=0,d=this.count;c<d;c++)Il.fromBufferAttribute(this,c),Il.applyMatrix3(a),this.setXYZ(c,Il.x,Il.y,Il.z);return this}applyMatrix4(a){for(let c=0,d=this.count;c<d;c++)Il.fromBufferAttribute(this,c),Il.applyMatrix4(a),this.setXYZ(c,Il.x,Il.y,Il.z);return this}applyNormalMatrix(a){for(let c=0,d=this.count;c<d;c++)Il.fromBufferAttribute(this,c),Il.applyNormalMatrix(a),this.setXYZ(c,Il.x,Il.y,Il.z);return this}transformDirection(a){for(let c=0,d=this.count;c<d;c++)Il.fromBufferAttribute(this,c),Il.transformDirection(a),this.setXYZ(c,Il.x,Il.y,Il.z);return this}set(a,c=0){return this.array.set(a,c),this}getComponent(a,c){let d=this.array[a*this.itemSize+c];return this.normalized&&(d=Jo(d,this.array)),d}setComponent(a,c,d){return this.normalized&&(d=co(d,this.array)),this.array[a*this.itemSize+c]=d,this}getX(a){let c=this.array[a*this.itemSize];return this.normalized&&(c=Jo(c,this.array)),c}setX(a,c){return this.normalized&&(c=co(c,this.array)),this.array[a*this.itemSize]=c,this}getY(a){let c=this.array[a*this.itemSize+1];return this.normalized&&(c=Jo(c,this.array)),c}setY(a,c){return this.normalized&&(c=co(c,this.array)),this.array[a*this.itemSize+1]=c,this}getZ(a){let c=this.array[a*this.itemSize+2];return this.normalized&&(c=Jo(c,this.array)),c}setZ(a,c){return this.normalized&&(c=co(c,this.array)),this.array[a*this.itemSize+2]=c,this}getW(a){let c=this.array[a*this.itemSize+3];return this.normalized&&(c=Jo(c,this.array)),c}setW(a,c){return this.normalized&&(c=co(c,this.array)),this.array[a*this.itemSize+3]=c,this}setXY(a,c,d){return a*=this.itemSize,this.normalized&&(c=co(c,this.array),d=co(d,this.array)),this.array[a+0]=c,this.array[a+1]=d,this}setXYZ(a,c,d,p){return a*=this.itemSize,this.normalized&&(c=co(c,this.array),d=co(d,this.array),p=co(p,this.array)),this.array[a+0]=c,this.array[a+1]=d,this.array[a+2]=p,this}setXYZW(a,c,d,p,S){return a*=this.itemSize,this.normalized&&(c=co(c,this.array),d=co(d,this.array),p=co(p,this.array),S=co(S,this.array)),this.array[a+0]=c,this.array[a+1]=d,this.array[a+2]=p,this.array[a+3]=S,this}onUpload(a){return this.onUploadCallback=a,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const a={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(a.name=this.name),35044!==this.usage&&(a.usage=this.usage),a}}class qp extends tl{constructor(a,c,d){super(new Uint16Array(a),c,d)}}class vu extends tl{constructor(a,c,d){super(new Uint32Array(a),c,d)}}class Wn extends tl{constructor(a,c,d){super(new Float32Array(a),c,d)}}const J0=new mo,oi=new $i;let kc=(()=>{class M{constructor(c=0,d=0,p=0,S=M.DEFAULT_ORDER){this.isEuler=!0,this._x=c,this._y=d,this._z=p,this._order=S}get x(){return this._x}set x(c){this._x=c,this._onChangeCallback()}get y(){return this._y}set y(c){this._y=c,this._onChangeCallback()}get z(){return this._z}set z(c){this._z=c,this._onChangeCallback()}get order(){return this._order}set order(c){this._order=c,this._onChangeCallback()}set(c,d,p,S=this._order){return this._x=c,this._y=d,this._z=p,this._order=S,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(c){return this._x=c._x,this._y=c._y,this._z=c._z,this._order=c._order,this._onChangeCallback(),this}setFromRotationMatrix(c,d=this._order,p=!0){const S=c.elements,U=S[0],F=S[4],ue=S[8],Q=S[1],Me=S[5],ke=S[9],Oe=S[2],Ge=S[6],et=S[10];switch(d){case"XYZ":this._y=Math.asin(Yl(ue,-1,1)),Math.abs(ue)<.9999999?(this._x=Math.atan2(-ke,et),this._z=Math.atan2(-F,U)):(this._x=Math.atan2(Ge,Me),this._z=0);break;case"YXZ":this._x=Math.asin(-Yl(ke,-1,1)),Math.abs(ke)<.9999999?(this._y=Math.atan2(ue,et),this._z=Math.atan2(Q,Me)):(this._y=Math.atan2(-Oe,U),this._z=0);break;case"ZXY":this._x=Math.asin(Yl(Ge,-1,1)),Math.abs(Ge)<.9999999?(this._y=Math.atan2(-Oe,et),this._z=Math.atan2(-F,Me)):(this._y=0,this._z=Math.atan2(Q,U));break;case"ZYX":this._y=Math.asin(-Yl(Oe,-1,1)),Math.abs(Oe)<.9999999?(this._x=Math.atan2(Ge,et),this._z=Math.atan2(Q,U)):(this._x=0,this._z=Math.atan2(-F,Me));break;case"YZX":this._z=Math.asin(Yl(Q,-1,1)),Math.abs(Q)<.9999999?(this._x=Math.atan2(-ke,Me),this._y=Math.atan2(-Oe,U)):(this._x=0,this._y=Math.atan2(ue,et));break;case"XZY":this._z=Math.asin(-Yl(F,-1,1)),Math.abs(F)<.9999999?(this._x=Math.atan2(Ge,Me),this._y=Math.atan2(ue,U)):(this._x=Math.atan2(-ke,et),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+d)}return this._order=d,!0===p&&this._onChangeCallback(),this}setFromQuaternion(c,d,p){return J0.makeRotationFromQuaternion(c),this.setFromRotationMatrix(J0,d,p)}setFromVector3(c,d=this._order){return this.set(c.x,c.y,c.z,d)}reorder(c){return oi.setFromEuler(this),this.setFromQuaternion(oi,c)}equals(c){return c._x===this._x&&c._y===this._y&&c._z===this._z&&c._order===this._order}fromArray(c){return this._x=c[0],this._y=c[1],this._z=c[2],void 0!==c[3]&&(this._order=c[3]),this._onChangeCallback(),this}toArray(c=[],d=0){return c[d]=this._x,c[d+1]=this._y,c[d+2]=this._z,c[d+3]=this._order,c}_onChange(c){return this._onChangeCallback=c,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return M.DEFAULT_ORDER="XYZ",M})();class OA{constructor(){this.mask=1}set(a){this.mask=1<<a>>>0}enable(a){this.mask|=1<<a}enableAll(){this.mask=-1}toggle(a){this.mask^=1<<a}disable(a){this.mask&=~(1<<a)}disableAll(){this.mask=0}test(a){return!!(this.mask&a.mask)}isEnabled(a){return!!(this.mask&1<<a)}}let LA=0;const Ry=new Mn,bu=new $i,dd=new mo,Xg=new Mn,xu=new Mn,Cv=new Mn,Hm=new $i,e_=new Mn(1,0,0),mf=new Mn(0,1,0),t_=new Mn(0,0,1),Ih={type:"added"},Vm={type:"removed"},Qp={type:"childadded",child:null},Al={type:"childremoved",child:null};let Vl=(()=>{class M extends Ca{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:LA++}),this.uuid=Ul(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=M.DEFAULT_UP.clone();const c=new Mn,d=new kc,p=new $i,S=new Mn(1,1,1);d._onChange(function U(){p.setFromEuler(d,!1)}),p._onChange(function F(){d.setFromQuaternion(p,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:c},rotation:{configurable:!0,enumerable:!0,value:d},quaternion:{configurable:!0,enumerable:!0,value:p},scale:{configurable:!0,enumerable:!0,value:S},modelViewMatrix:{value:new mo},normalMatrix:{value:new Cs}}),this.matrix=new mo,this.matrixWorld=new mo,this.matrixAutoUpdate=M.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=M.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new OA,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(c){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(c),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(c){return this.quaternion.premultiply(c),this}setRotationFromAxisAngle(c,d){this.quaternion.setFromAxisAngle(c,d)}setRotationFromEuler(c){this.quaternion.setFromEuler(c,!0)}setRotationFromMatrix(c){this.quaternion.setFromRotationMatrix(c)}setRotationFromQuaternion(c){this.quaternion.copy(c)}rotateOnAxis(c,d){return bu.setFromAxisAngle(c,d),this.quaternion.multiply(bu),this}rotateOnWorldAxis(c,d){return bu.setFromAxisAngle(c,d),this.quaternion.premultiply(bu),this}rotateX(c){return this.rotateOnAxis(e_,c)}rotateY(c){return this.rotateOnAxis(mf,c)}rotateZ(c){return this.rotateOnAxis(t_,c)}translateOnAxis(c,d){return Ry.copy(c).applyQuaternion(this.quaternion),this.position.add(Ry.multiplyScalar(d)),this}translateX(c){return this.translateOnAxis(e_,c)}translateY(c){return this.translateOnAxis(mf,c)}translateZ(c){return this.translateOnAxis(t_,c)}localToWorld(c){return this.updateWorldMatrix(!0,!1),c.applyMatrix4(this.matrixWorld)}worldToLocal(c){return this.updateWorldMatrix(!0,!1),c.applyMatrix4(dd.copy(this.matrixWorld).invert())}lookAt(c,d,p){c.isVector3?Xg.copy(c):Xg.set(c,d,p);const S=this.parent;this.updateWorldMatrix(!0,!1),xu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?dd.lookAt(xu,Xg,this.up):dd.lookAt(Xg,xu,this.up),this.quaternion.setFromRotationMatrix(dd),S&&(dd.extractRotation(S.matrixWorld),bu.setFromRotationMatrix(dd),this.quaternion.premultiply(bu.invert()))}add(c){if(arguments.length>1){for(let d=0;d<arguments.length;d++)this.add(arguments[d]);return this}return c===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",c),this):(c&&c.isObject3D?(null!==c.parent&&c.parent.remove(c),c.parent=this,this.children.push(c),c.dispatchEvent(Ih),Qp.child=c,this.dispatchEvent(Qp),Qp.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",c),this)}remove(c){if(arguments.length>1){for(let p=0;p<arguments.length;p++)this.remove(arguments[p]);return this}const d=this.children.indexOf(c);return-1!==d&&(c.parent=null,this.children.splice(d,1),c.dispatchEvent(Vm),Al.child=c,this.dispatchEvent(Al),Al.child=null),this}removeFromParent(){const c=this.parent;return null!==c&&c.remove(this),this}clear(){return this.remove(...this.children)}attach(c){return this.updateWorldMatrix(!0,!1),dd.copy(this.matrixWorld).invert(),null!==c.parent&&(c.parent.updateWorldMatrix(!0,!1),dd.multiply(c.parent.matrixWorld)),c.applyMatrix4(dd),this.add(c),c.updateWorldMatrix(!1,!0),this}getObjectById(c){return this.getObjectByProperty("id",c)}getObjectByName(c){return this.getObjectByProperty("name",c)}getObjectByProperty(c,d){if(this[c]===d)return this;for(let p=0,S=this.children.length;p<S;p++){const F=this.children[p].getObjectByProperty(c,d);if(void 0!==F)return F}}getObjectsByProperty(c,d,p=[]){this[c]===d&&p.push(this);const S=this.children;for(let U=0,F=S.length;U<F;U++)S[U].getObjectsByProperty(c,d,p);return p}getWorldPosition(c){return this.updateWorldMatrix(!0,!1),c.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(c){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(xu,c,Cv),c}getWorldScale(c){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(xu,Hm,c),c}getWorldDirection(c){this.updateWorldMatrix(!0,!1);const d=this.matrixWorld.elements;return c.set(d[8],d[9],d[10]).normalize()}raycast(){}traverse(c){c(this);const d=this.children;for(let p=0,S=d.length;p<S;p++)d[p].traverse(c)}traverseVisible(c){if(!1===this.visible)return;c(this);const d=this.children;for(let p=0,S=d.length;p<S;p++)d[p].traverseVisible(c)}traverseAncestors(c){const d=this.parent;null!==d&&(c(d),d.traverseAncestors(c))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(c){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||c)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,c=!0);const d=this.children;for(let p=0,S=d.length;p<S;p++){const U=d[p];(!0===U.matrixWorldAutoUpdate||!0===c)&&U.updateMatrixWorld(c)}}updateWorldMatrix(c,d){const p=this.parent;if(!0===c&&null!==p&&!0===p.matrixWorldAutoUpdate&&p.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===d){const S=this.children;for(let U=0,F=S.length;U<F;U++){const ue=S[U];!0===ue.matrixWorldAutoUpdate&&ue.updateWorldMatrix(!1,!0)}}}toJSON(c){const d=void 0===c||"string"==typeof c,p={};d&&(c={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},p.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const S={};function U(ue,Q){return void 0===ue[Q.uuid]&&(ue[Q.uuid]=Q.toJSON(c)),Q.uuid}if(S.uuid=this.uuid,S.type=this.type,""!==this.name&&(S.name=this.name),!0===this.castShadow&&(S.castShadow=!0),!0===this.receiveShadow&&(S.receiveShadow=!0),!1===this.visible&&(S.visible=!1),!1===this.frustumCulled&&(S.frustumCulled=!1),0!==this.renderOrder&&(S.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(S.userData=this.userData),S.layers=this.layers.mask,S.matrix=this.matrix.toArray(),S.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(S.matrixAutoUpdate=!1),this.isInstancedMesh&&(S.type="InstancedMesh",S.count=this.count,S.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(S.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(S.type="BatchedMesh",S.perObjectFrustumCulled=this.perObjectFrustumCulled,S.sortObjects=this.sortObjects,S.drawRanges=this._drawRanges,S.reservedRanges=this._reservedRanges,S.visibility=this._visibility,S.active=this._active,S.bounds=this._bounds.map(ue=>({boxInitialized:ue.boxInitialized,boxMin:ue.box.min.toArray(),boxMax:ue.box.max.toArray(),sphereInitialized:ue.sphereInitialized,sphereRadius:ue.sphere.radius,sphereCenter:ue.sphere.center.toArray()})),S.maxGeometryCount=this._maxGeometryCount,S.maxVertexCount=this._maxVertexCount,S.maxIndexCount=this._maxIndexCount,S.geometryInitialized=this._geometryInitialized,S.geometryCount=this._geometryCount,S.matricesTexture=this._matricesTexture.toJSON(c),null!==this.boundingSphere&&(S.boundingSphere={center:S.boundingSphere.center.toArray(),radius:S.boundingSphere.radius}),null!==this.boundingBox&&(S.boundingBox={min:S.boundingBox.min.toArray(),max:S.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?S.background=this.background.toJSON():this.background.isTexture&&(S.background=this.background.toJSON(c).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(S.environment=this.environment.toJSON(c).uuid);else if(this.isMesh||this.isLine||this.isPoints){S.geometry=U(c.geometries,this.geometry);const ue=this.geometry.parameters;if(void 0!==ue&&void 0!==ue.shapes){const Q=ue.shapes;if(Array.isArray(Q))for(let Me=0,ke=Q.length;Me<ke;Me++)U(c.shapes,Q[Me]);else U(c.shapes,Q)}}if(this.isSkinnedMesh&&(S.bindMode=this.bindMode,S.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(U(c.skeletons,this.skeleton),S.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const ue=[];for(let Q=0,Me=this.material.length;Q<Me;Q++)ue.push(U(c.materials,this.material[Q]));S.material=ue}else S.material=U(c.materials,this.material);if(this.children.length>0){S.children=[];for(let ue=0;ue<this.children.length;ue++)S.children.push(this.children[ue].toJSON(c).object)}if(this.animations.length>0){S.animations=[];for(let ue=0;ue<this.animations.length;ue++)S.animations.push(U(c.animations,this.animations[ue]))}if(d){const ue=F(c.geometries),Q=F(c.materials),Me=F(c.textures),ke=F(c.images),Oe=F(c.shapes),Ge=F(c.skeletons),et=F(c.animations),vt=F(c.nodes);ue.length>0&&(p.geometries=ue),Q.length>0&&(p.materials=Q),Me.length>0&&(p.textures=Me),ke.length>0&&(p.images=ke),Oe.length>0&&(p.shapes=Oe),Ge.length>0&&(p.skeletons=Ge),et.length>0&&(p.animations=et),vt.length>0&&(p.nodes=vt)}return p.object=S,p;function F(ue){const Q=[];for(const Me in ue){const ke=ue[Me];delete ke.metadata,Q.push(ke)}return Q}}clone(c){return(new this.constructor).copy(this,c)}copy(c,d=!0){if(this.name=c.name,this.up.copy(c.up),this.position.copy(c.position),this.rotation.order=c.rotation.order,this.quaternion.copy(c.quaternion),this.scale.copy(c.scale),this.matrix.copy(c.matrix),this.matrixWorld.copy(c.matrixWorld),this.matrixAutoUpdate=c.matrixAutoUpdate,this.matrixWorldAutoUpdate=c.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=c.matrixWorldNeedsUpdate,this.layers.mask=c.layers.mask,this.visible=c.visible,this.castShadow=c.castShadow,this.receiveShadow=c.receiveShadow,this.frustumCulled=c.frustumCulled,this.renderOrder=c.renderOrder,this.animations=c.animations.slice(),this.userData=JSON.parse(JSON.stringify(c.userData)),!0===d)for(let p=0;p<c.children.length;p++)this.add(c.children[p].clone());return this}}return M.DEFAULT_UP=new Mn(0,1,0),M.DEFAULT_MATRIX_AUTO_UPDATE=!0,M.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,M})(),n_=0;const fd=new mo,Yg=new Vl,NA=new Mn,gl=new Pc,jh=new Pc,Bl=new Mn;class ol extends Ca{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:n_++}),this.uuid=Ul(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(a){return this.index=Array.isArray(a)?new(Np(a)?vu:qp)(a,1):a,this}getAttribute(a){return this.attributes[a]}setAttribute(a,c){return this.attributes[a]=c,this}deleteAttribute(a){return delete this.attributes[a],this}hasAttribute(a){return void 0!==this.attributes[a]}addGroup(a,c,d=0){this.groups.push({start:a,count:c,materialIndex:d})}clearGroups(){this.groups=[]}setDrawRange(a,c){this.drawRange.start=a,this.drawRange.count=c}applyMatrix4(a){const c=this.attributes.position;void 0!==c&&(c.applyMatrix4(a),c.needsUpdate=!0);const d=this.attributes.normal;if(void 0!==d){const S=(new Cs).getNormalMatrix(a);d.applyNormalMatrix(S),d.needsUpdate=!0}const p=this.attributes.tangent;return void 0!==p&&(p.transformDirection(a),p.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(a){return fd.makeRotationFromQuaternion(a),this.applyMatrix4(fd),this}rotateX(a){return fd.makeRotationX(a),this.applyMatrix4(fd),this}rotateY(a){return fd.makeRotationY(a),this.applyMatrix4(fd),this}rotateZ(a){return fd.makeRotationZ(a),this.applyMatrix4(fd),this}translate(a,c,d){return fd.makeTranslation(a,c,d),this.applyMatrix4(fd),this}scale(a,c,d){return fd.makeScale(a,c,d),this.applyMatrix4(fd),this}lookAt(a){return Yg.lookAt(a),Yg.updateMatrix(),this.applyMatrix4(Yg.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(NA).negate(),this.translate(NA.x,NA.y,NA.z),this}setFromPoints(a){const c=[];for(let d=0,p=a.length;d<p;d++){const S=a[d];c.push(S.x,S.y,S.z||0)}return this.setAttribute("position",new Wn(c,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Pc);const a=this.attributes.position,c=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new Mn(-1/0,-1/0,-1/0),new Mn(1/0,1/0,1/0));if(void 0!==a){if(this.boundingBox.setFromBufferAttribute(a),c)for(let d=0,p=c.length;d<p;d++)gl.setFromBufferAttribute(c[d]),this.morphTargetsRelative?(Bl.addVectors(this.boundingBox.min,gl.min),this.boundingBox.expandByPoint(Bl),Bl.addVectors(this.boundingBox.max,gl.max),this.boundingBox.expandByPoint(Bl)):(this.boundingBox.expandByPoint(gl.min),this.boundingBox.expandByPoint(gl.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Qc);const a=this.attributes.position,c=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new Mn,1/0);if(a){const d=this.boundingSphere.center;if(gl.setFromBufferAttribute(a),c)for(let S=0,U=c.length;S<U;S++)jh.setFromBufferAttribute(c[S]),this.morphTargetsRelative?(Bl.addVectors(gl.min,jh.min),gl.expandByPoint(Bl),Bl.addVectors(gl.max,jh.max),gl.expandByPoint(Bl)):(gl.expandByPoint(jh.min),gl.expandByPoint(jh.max));gl.getCenter(d);let p=0;for(let S=0,U=a.count;S<U;S++)Bl.fromBufferAttribute(a,S),p=Math.max(p,d.distanceToSquared(Bl));if(c)for(let S=0,U=c.length;S<U;S++){const F=c[S],ue=this.morphTargetsRelative;for(let Q=0,Me=F.count;Q<Me;Q++)Bl.fromBufferAttribute(F,Q),ue&&(NA.fromBufferAttribute(a,Q),Bl.add(NA)),p=Math.max(p,d.distanceToSquared(Bl))}this.boundingSphere.radius=Math.sqrt(p),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const a=this.index,c=this.attributes;if(null===a||void 0===c.position||void 0===c.normal||void 0===c.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const d=c.position,p=c.normal,S=c.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new tl(new Float32Array(4*d.count),4));const U=this.getAttribute("tangent"),F=[],ue=[];for(let qn=0;qn<d.count;qn++)F[qn]=new Mn,ue[qn]=new Mn;const Q=new Mn,Me=new Mn,ke=new Mn,Oe=new Ki,Ge=new Ki,et=new Ki,vt=new Mn,Ye=new Mn;function je(qn,wi,Ut){Q.fromBufferAttribute(d,qn),Me.fromBufferAttribute(d,wi),ke.fromBufferAttribute(d,Ut),Oe.fromBufferAttribute(S,qn),Ge.fromBufferAttribute(S,wi),et.fromBufferAttribute(S,Ut),Me.sub(Q),ke.sub(Q),Ge.sub(Oe),et.sub(Oe);const En=1/(Ge.x*et.y-et.x*Ge.y);isFinite(En)&&(vt.copy(Me).multiplyScalar(et.y).addScaledVector(ke,-Ge.y).multiplyScalar(En),Ye.copy(ke).multiplyScalar(Ge.x).addScaledVector(Me,-et.x).multiplyScalar(En),F[qn].add(vt),F[wi].add(vt),F[Ut].add(vt),ue[qn].add(Ye),ue[wi].add(Ye),ue[Ut].add(Ye))}let Rt=this.groups;0===Rt.length&&(Rt=[{start:0,count:a.count}]);for(let qn=0,wi=Rt.length;qn<wi;++qn){const Ut=Rt[qn],En=Ut.start;for(let lr=En,Yn=En+Ut.count;lr<Yn;lr+=3)je(a.getX(lr+0),a.getX(lr+1),a.getX(lr+2))}const At=new Mn,Ht=new Mn,Pn=new Mn,yn=new Mn;function xn(qn){Pn.fromBufferAttribute(p,qn),yn.copy(Pn);const wi=F[qn];At.copy(wi),At.sub(Pn.multiplyScalar(Pn.dot(wi))).normalize(),Ht.crossVectors(yn,wi);const En=Ht.dot(ue[qn])<0?-1:1;U.setXYZW(qn,At.x,At.y,At.z,En)}for(let qn=0,wi=Rt.length;qn<wi;++qn){const Ut=Rt[qn],En=Ut.start;for(let lr=En,Yn=En+Ut.count;lr<Yn;lr+=3)xn(a.getX(lr+0)),xn(a.getX(lr+1)),xn(a.getX(lr+2))}}computeVertexNormals(){const a=this.index,c=this.getAttribute("position");if(void 0!==c){let d=this.getAttribute("normal");if(void 0===d)d=new tl(new Float32Array(3*c.count),3),this.setAttribute("normal",d);else for(let Oe=0,Ge=d.count;Oe<Ge;Oe++)d.setXYZ(Oe,0,0,0);const p=new Mn,S=new Mn,U=new Mn,F=new Mn,ue=new Mn,Q=new Mn,Me=new Mn,ke=new Mn;if(a)for(let Oe=0,Ge=a.count;Oe<Ge;Oe+=3){const et=a.getX(Oe+0),vt=a.getX(Oe+1),Ye=a.getX(Oe+2);p.fromBufferAttribute(c,et),S.fromBufferAttribute(c,vt),U.fromBufferAttribute(c,Ye),Me.subVectors(U,S),ke.subVectors(p,S),Me.cross(ke),F.fromBufferAttribute(d,et),ue.fromBufferAttribute(d,vt),Q.fromBufferAttribute(d,Ye),F.add(Me),ue.add(Me),Q.add(Me),d.setXYZ(et,F.x,F.y,F.z),d.setXYZ(vt,ue.x,ue.y,ue.z),d.setXYZ(Ye,Q.x,Q.y,Q.z)}else for(let Oe=0,Ge=c.count;Oe<Ge;Oe+=3)p.fromBufferAttribute(c,Oe+0),S.fromBufferAttribute(c,Oe+1),U.fromBufferAttribute(c,Oe+2),Me.subVectors(U,S),ke.subVectors(p,S),Me.cross(ke),d.setXYZ(Oe+0,Me.x,Me.y,Me.z),d.setXYZ(Oe+1,Me.x,Me.y,Me.z),d.setXYZ(Oe+2,Me.x,Me.y,Me.z);this.normalizeNormals(),d.needsUpdate=!0}}normalizeNormals(){const a=this.attributes.normal;for(let c=0,d=a.count;c<d;c++)Bl.fromBufferAttribute(a,c),Bl.normalize(),a.setXYZ(c,Bl.x,Bl.y,Bl.z)}toNonIndexed(){function a(F,ue){const Q=F.array,Me=F.itemSize,ke=F.normalized,Oe=new Q.constructor(ue.length*Me);let Ge=0,et=0;for(let vt=0,Ye=ue.length;vt<Ye;vt++){Ge=F.isInterleavedBufferAttribute?ue[vt]*F.data.stride+F.offset:ue[vt]*Me;for(let je=0;je<Me;je++)Oe[et++]=Q[Ge++]}return new tl(Oe,Me,ke)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const c=new ol,d=this.index.array,p=this.attributes;for(const F in p){const Q=a(p[F],d);c.setAttribute(F,Q)}const S=this.morphAttributes;for(const F in S){const ue=[],Q=S[F];for(let Me=0,ke=Q.length;Me<ke;Me++){const Ge=a(Q[Me],d);ue.push(Ge)}c.morphAttributes[F]=ue}c.morphTargetsRelative=this.morphTargetsRelative;const U=this.groups;for(let F=0,ue=U.length;F<ue;F++){const Q=U[F];c.addGroup(Q.start,Q.count,Q.materialIndex)}return c}toJSON(){const a={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),Object.keys(this.userData).length>0&&(a.userData=this.userData),void 0!==this.parameters){const ue=this.parameters;for(const Q in ue)void 0!==ue[Q]&&(a[Q]=ue[Q]);return a}a.data={attributes:{}};const c=this.index;null!==c&&(a.data.index={type:c.array.constructor.name,array:Array.prototype.slice.call(c.array)});const d=this.attributes;for(const ue in d)a.data.attributes[ue]=d[ue].toJSON(a.data);const p={};let S=!1;for(const ue in this.morphAttributes){const Q=this.morphAttributes[ue],Me=[];for(let ke=0,Oe=Q.length;ke<Oe;ke++)Me.push(Q[ke].toJSON(a.data));Me.length>0&&(p[ue]=Me,S=!0)}S&&(a.data.morphAttributes=p,a.data.morphTargetsRelative=this.morphTargetsRelative);const U=this.groups;U.length>0&&(a.data.groups=JSON.parse(JSON.stringify(U)));const F=this.boundingSphere;return null!==F&&(a.data.boundingSphere={center:F.center.toArray(),radius:F.radius}),a}clone(){return(new this.constructor).copy(this)}copy(a){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const c={};this.name=a.name;const d=a.index;null!==d&&this.setIndex(d.clone(c));const p=a.attributes;for(const Q in p)this.setAttribute(Q,p[Q].clone(c));const S=a.morphAttributes;for(const Q in S){const Me=[],ke=S[Q];for(let Oe=0,Ge=ke.length;Oe<Ge;Oe++)Me.push(ke[Oe].clone(c));this.morphAttributes[Q]=Me}this.morphTargetsRelative=a.morphTargetsRelative;const U=a.groups;for(let Q=0,Me=U.length;Q<Me;Q++){const ke=U[Q];this.addGroup(ke.start,ke.count,ke.materialIndex)}const F=a.boundingBox;null!==F&&(this.boundingBox=F.clone());const ue=a.boundingSphere;return null!==ue&&(this.boundingSphere=ue.clone()),this.drawRange.start=a.drawRange.start,this.drawRange.count=a.drawRange.count,this.userData=a.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Af extends ol{constructor(a=1,c=1,d=1,p=1,S=1,U=1){super(),this.type="BoxGeometry",this.parameters={width:a,height:c,depth:d,widthSegments:p,heightSegments:S,depthSegments:U};const F=this;p=Math.floor(p),S=Math.floor(S),U=Math.floor(U);const ue=[],Q=[],Me=[],ke=[];let Oe=0,Ge=0;function et(vt,Ye,je,Rt,At,Ht,Pn,yn,xn,qn,wi){const Ut=Ht/xn,En=Pn/qn,rr=Ht/2,lr=Pn/2,Yn=yn/2,Qi=xn+1,Oi=qn+1;let er=0,Xi=0;const Vi=new Mn;for(let Vr=0;Vr<Oi;Vr++){const Hr=Vr*En-lr;for(let Ns=0;Ns<Qi;Ns++)Vi[vt]=(Ns*Ut-rr)*Rt,Vi[Ye]=Hr*At,Vi[je]=Yn,Q.push(Vi.x,Vi.y,Vi.z),Vi[vt]=0,Vi[Ye]=0,Vi[je]=yn>0?1:-1,Me.push(Vi.x,Vi.y,Vi.z),ke.push(Ns/xn),ke.push(1-Vr/qn),er+=1}for(let Vr=0;Vr<qn;Vr++)for(let Hr=0;Hr<xn;Hr++){const Yo=Oe+Hr+Qi*(Vr+1),Hi=Oe+(Hr+1)+Qi*(Vr+1),Or=Oe+(Hr+1)+Qi*Vr;ue.push(Oe+Hr+Qi*Vr,Yo,Or),ue.push(Yo,Hi,Or),Xi+=6}F.addGroup(Ge,Xi,wi),Ge+=Xi,Oe+=er}et("z","y","x",-1,-1,d,c,a,U,S,0),et("z","y","x",1,-1,d,c,-a,U,S,1),et("x","z","y",1,1,a,d,c,p,U,2),et("x","z","y",1,-1,a,d,-c,p,U,3),et("x","y","z",1,-1,a,c,d,p,S,4),et("x","y","z",-1,-1,a,c,-d,p,S,5),this.setIndex(ue),this.setAttribute("position",new Wn(Q,3)),this.setAttribute("normal",new Wn(Me,3)),this.setAttribute("uv",new Wn(ke,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new Af(a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments)}}class Bh extends ol{constructor(a=1,c=1,d=1,p=1){super(),this.type="PlaneGeometry",this.parameters={width:a,height:c,widthSegments:d,heightSegments:p};const S=a/2,U=c/2,F=Math.floor(d),ue=Math.floor(p),Q=F+1,Me=ue+1,ke=a/F,Oe=c/ue,Ge=[],et=[],vt=[],Ye=[];for(let je=0;je<Me;je++){const Rt=je*Oe-U;for(let At=0;At<Q;At++)et.push(At*ke-S,-Rt,0),vt.push(0,0,1),Ye.push(At/F),Ye.push(1-je/ue)}for(let je=0;je<ue;je++)for(let Rt=0;Rt<F;Rt++){const Ht=Rt+Q*(je+1),Pn=Rt+1+Q*(je+1),yn=Rt+1+Q*je;Ge.push(Rt+Q*je,Ht,yn),Ge.push(Ht,Pn,yn)}this.setIndex(Ge),this.setAttribute("position",new Wn(et,3)),this.setAttribute("normal",new Wn(vt,3)),this.setAttribute("uv",new Wn(Ye,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new Bh(a.width,a.height,a.widthSegments,a.heightSegments)}}let Ba=0;class _l extends Ca{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Ba++}),this.uuid=Ul(),this.name="",this.type="Material",this.blending=1,this.side=L,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=D,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new io(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Fp,this.stencilZFail=Fp,this.stencilZPass=Fp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(a){this._alphaTest>0!=a>0&&this.version++,this._alphaTest=a}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(a){if(void 0!==a)for(const c in a){const d=a[c];if(void 0===d){console.warn(`THREE.Material: parameter '${c}' has value of undefined.`);continue}const p=this[c];void 0!==p?p&&p.isColor?p.set(d):p&&p.isVector3&&d&&d.isVector3?p.copy(d):this[c]=d:console.warn(`THREE.Material: '${c}' is not a property of THREE.${this.type}.`)}}toJSON(a){const c=void 0===a||"string"==typeof a;c&&(a={textures:{},images:{}});const d={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function p(S){const U=[];for(const F in S){const ue=S[F];delete ue.metadata,U.push(ue)}return U}if(d.uuid=this.uuid,d.type=this.type,""!==this.name&&(d.name=this.name),this.color&&this.color.isColor&&(d.color=this.color.getHex()),void 0!==this.roughness&&(d.roughness=this.roughness),void 0!==this.metalness&&(d.metalness=this.metalness),void 0!==this.sheen&&(d.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(d.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(d.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(d.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(d.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(d.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(d.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(d.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(d.shininess=this.shininess),void 0!==this.clearcoat&&(d.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(d.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(d.clearcoatMap=this.clearcoatMap.toJSON(a).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(d.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(a).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(d.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,d.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(d.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(d.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(d.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(d.iridescenceMap=this.iridescenceMap.toJSON(a).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(d.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(a).uuid),void 0!==this.anisotropy&&(d.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(d.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(d.anisotropyMap=this.anisotropyMap.toJSON(a).uuid),this.map&&this.map.isTexture&&(d.map=this.map.toJSON(a).uuid),this.matcap&&this.matcap.isTexture&&(d.matcap=this.matcap.toJSON(a).uuid),this.alphaMap&&this.alphaMap.isTexture&&(d.alphaMap=this.alphaMap.toJSON(a).uuid),this.lightMap&&this.lightMap.isTexture&&(d.lightMap=this.lightMap.toJSON(a).uuid,d.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(d.aoMap=this.aoMap.toJSON(a).uuid,d.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(d.bumpMap=this.bumpMap.toJSON(a).uuid,d.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(d.normalMap=this.normalMap.toJSON(a).uuid,d.normalMapType=this.normalMapType,d.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(d.displacementMap=this.displacementMap.toJSON(a).uuid,d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(d.roughnessMap=this.roughnessMap.toJSON(a).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(d.metalnessMap=this.metalnessMap.toJSON(a).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(d.emissiveMap=this.emissiveMap.toJSON(a).uuid),this.specularMap&&this.specularMap.isTexture&&(d.specularMap=this.specularMap.toJSON(a).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(d.specularIntensityMap=this.specularIntensityMap.toJSON(a).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(d.specularColorMap=this.specularColorMap.toJSON(a).uuid),this.envMap&&this.envMap.isTexture&&(d.envMap=this.envMap.toJSON(a).uuid,void 0!==this.combine&&(d.combine=this.combine)),void 0!==this.envMapRotation&&(d.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(d.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(d.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(d.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(d.gradientMap=this.gradientMap.toJSON(a).uuid),void 0!==this.transmission&&(d.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(d.transmissionMap=this.transmissionMap.toJSON(a).uuid),void 0!==this.thickness&&(d.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(d.thicknessMap=this.thicknessMap.toJSON(a).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(d.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(d.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(d.size=this.size),null!==this.shadowSide&&(d.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(d.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(d.blending=this.blending),this.side!==L&&(d.side=this.side),!0===this.vertexColors&&(d.vertexColors=!0),this.opacity<1&&(d.opacity=this.opacity),!0===this.transparent&&(d.transparent=!0),204!==this.blendSrc&&(d.blendSrc=this.blendSrc),205!==this.blendDst&&(d.blendDst=this.blendDst),this.blendEquation!==D&&(d.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(d.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(d.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(d.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(d.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(d.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(d.depthFunc=this.depthFunc),!1===this.depthTest&&(d.depthTest=this.depthTest),!1===this.depthWrite&&(d.depthWrite=this.depthWrite),!1===this.colorWrite&&(d.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(d.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(d.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(d.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(d.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Fp&&(d.stencilFail=this.stencilFail),this.stencilZFail!==Fp&&(d.stencilZFail=this.stencilZFail),this.stencilZPass!==Fp&&(d.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(d.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(d.rotation=this.rotation),!0===this.polygonOffset&&(d.polygonOffset=!0),0!==this.polygonOffsetFactor&&(d.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(d.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(d.linewidth=this.linewidth),void 0!==this.dashSize&&(d.dashSize=this.dashSize),void 0!==this.gapSize&&(d.gapSize=this.gapSize),void 0!==this.scale&&(d.scale=this.scale),!0===this.dithering&&(d.dithering=!0),this.alphaTest>0&&(d.alphaTest=this.alphaTest),!0===this.alphaHash&&(d.alphaHash=!0),!0===this.alphaToCoverage&&(d.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(d.premultipliedAlpha=!0),!0===this.forceSinglePass&&(d.forceSinglePass=!0),!0===this.wireframe&&(d.wireframe=!0),this.wireframeLinewidth>1&&(d.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(d.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(d.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(d.flatShading=!0),!1===this.visible&&(d.visible=!1),!1===this.toneMapped&&(d.toneMapped=!1),!1===this.fog&&(d.fog=!1),Object.keys(this.userData).length>0&&(d.userData=this.userData),c){const S=p(a.textures),U=p(a.images);S.length>0&&(d.textures=S),U.length>0&&(d.images=U)}return d}clone(){return(new this.constructor).copy(this)}copy(a){this.name=a.name,this.blending=a.blending,this.side=a.side,this.vertexColors=a.vertexColors,this.opacity=a.opacity,this.transparent=a.transparent,this.blendSrc=a.blendSrc,this.blendDst=a.blendDst,this.blendEquation=a.blendEquation,this.blendSrcAlpha=a.blendSrcAlpha,this.blendDstAlpha=a.blendDstAlpha,this.blendEquationAlpha=a.blendEquationAlpha,this.blendColor.copy(a.blendColor),this.blendAlpha=a.blendAlpha,this.depthFunc=a.depthFunc,this.depthTest=a.depthTest,this.depthWrite=a.depthWrite,this.stencilWriteMask=a.stencilWriteMask,this.stencilFunc=a.stencilFunc,this.stencilRef=a.stencilRef,this.stencilFuncMask=a.stencilFuncMask,this.stencilFail=a.stencilFail,this.stencilZFail=a.stencilZFail,this.stencilZPass=a.stencilZPass,this.stencilWrite=a.stencilWrite;const c=a.clippingPlanes;let d=null;if(null!==c){const p=c.length;d=new Array(p);for(let S=0;S!==p;++S)d[S]=c[S].clone()}return this.clippingPlanes=d,this.clipIntersection=a.clipIntersection,this.clipShadows=a.clipShadows,this.shadowSide=a.shadowSide,this.colorWrite=a.colorWrite,this.precision=a.precision,this.polygonOffset=a.polygonOffset,this.polygonOffsetFactor=a.polygonOffsetFactor,this.polygonOffsetUnits=a.polygonOffsetUnits,this.dithering=a.dithering,this.alphaTest=a.alphaTest,this.alphaHash=a.alphaHash,this.alphaToCoverage=a.alphaToCoverage,this.premultipliedAlpha=a.premultipliedAlpha,this.forceSinglePass=a.forceSinglePass,this.visible=a.visible,this.toneMapped=a.toneMapped,this.userData=JSON.parse(JSON.stringify(a.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(a){!0===a&&this.version++}}function is(M){const a={};for(const c in M){a[c]={};for(const d in M[c]){const p=M[c][d];p&&(p.isColor||p.isMatrix3||p.isMatrix4||p.isVector2||p.isVector3||p.isVector4||p.isTexture||p.isQuaternion)?p.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),a[c][d]=null):a[c][d]=p.clone():a[c][d]=Array.isArray(p)?p.slice():p}}return a}function Jc(M){const a={};for(let c=0;c<M.length;c++){const d=is(M[c]);for(const p in d)a[p]=d[p]}return a}function jp(M){return null===M.getRenderTarget()?M.outputColorSpace:Ia.workingColorSpace}const Zl={clone:is,merge:Jc};class jc extends _l{constructor(a){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==a&&this.setValues(a)}copy(a){return super.copy(a),this.fragmentShader=a.fragmentShader,this.vertexShader=a.vertexShader,this.uniforms=is(a.uniforms),this.uniformsGroups=function Kg(M){const a=[];for(let c=0;c<M.length;c++)a.push(M[c].clone());return a}(a.uniformsGroups),this.defines=Object.assign({},a.defines),this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.fog=a.fog,this.lights=a.lights,this.clipping=a.clipping,this.extensions=Object.assign({},a.extensions),this.glslVersion=a.glslVersion,this}toJSON(a){const c=super.toJSON(a);c.glslVersion=this.glslVersion,c.uniforms={};for(const p in this.uniforms){const U=this.uniforms[p].value;c.uniforms[p]=U&&U.isTexture?{type:"t",value:U.toJSON(a).uuid}:U&&U.isColor?{type:"c",value:U.getHex()}:U&&U.isVector2?{type:"v2",value:U.toArray()}:U&&U.isVector3?{type:"v3",value:U.toArray()}:U&&U.isVector4?{type:"v4",value:U.toArray()}:U&&U.isMatrix3?{type:"m3",value:U.toArray()}:U&&U.isMatrix4?{type:"m4",value:U.toArray()}:{value:U}}Object.keys(this.defines).length>0&&(c.defines=this.defines),c.vertexShader=this.vertexShader,c.fragmentShader=this.fragmentShader,c.lights=this.lights,c.clipping=this.clipping;const d={};for(const p in this.extensions)!0===this.extensions[p]&&(d[p]=!0);return Object.keys(d).length>0&&(c.extensions=d),c}}const Wh=new Mn,Gm=new Mn,gf=new Mn,Bd=new Mn,Pd=new Mn,qm=new Mn,_f=new Mn;class Wp{constructor(a=new Mn,c=new Mn(0,0,-1)){this.origin=a,this.direction=c}set(a,c){return this.origin.copy(a),this.direction.copy(c),this}copy(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this}at(a,c){return c.copy(this.origin).addScaledVector(this.direction,a)}lookAt(a){return this.direction.copy(a).sub(this.origin).normalize(),this}recast(a){return this.origin.copy(this.at(a,Wh)),this}closestPointToPoint(a,c){c.subVectors(a,this.origin);const d=c.dot(this.direction);return d<0?c.copy(this.origin):c.copy(this.origin).addScaledVector(this.direction,d)}distanceToPoint(a){return Math.sqrt(this.distanceSqToPoint(a))}distanceSqToPoint(a){const c=Wh.subVectors(a,this.origin).dot(this.direction);return c<0?this.origin.distanceToSquared(a):(Wh.copy(this.origin).addScaledVector(this.direction,c),Wh.distanceToSquared(a))}distanceSqToSegment(a,c,d,p){Gm.copy(a).add(c).multiplyScalar(.5),gf.copy(c).sub(a).normalize(),Bd.copy(this.origin).sub(Gm);const S=.5*a.distanceTo(c),U=-this.direction.dot(gf),F=Bd.dot(this.direction),ue=-Bd.dot(gf),Q=Bd.lengthSq(),Me=Math.abs(1-U*U);let ke,Oe,Ge,et;if(Me>0)if(ke=U*ue-F,Oe=U*F-ue,et=S*Me,ke>=0)if(Oe>=-et)if(Oe<=et){const vt=1/Me;ke*=vt,Oe*=vt,Ge=ke*(ke+U*Oe+2*F)+Oe*(U*ke+Oe+2*ue)+Q}else Oe=S,ke=Math.max(0,-(U*Oe+F)),Ge=-ke*ke+Oe*(Oe+2*ue)+Q;else Oe=-S,ke=Math.max(0,-(U*Oe+F)),Ge=-ke*ke+Oe*(Oe+2*ue)+Q;else Oe<=-et?(ke=Math.max(0,-(-U*S+F)),Oe=ke>0?-S:Math.min(Math.max(-S,-ue),S),Ge=-ke*ke+Oe*(Oe+2*ue)+Q):Oe<=et?(ke=0,Oe=Math.min(Math.max(-S,-ue),S),Ge=Oe*(Oe+2*ue)+Q):(ke=Math.max(0,-(U*S+F)),Oe=ke>0?S:Math.min(Math.max(-S,-ue),S),Ge=-ke*ke+Oe*(Oe+2*ue)+Q);else Oe=U>0?-S:S,ke=Math.max(0,-(U*Oe+F)),Ge=-ke*ke+Oe*(Oe+2*ue)+Q;return d&&d.copy(this.origin).addScaledVector(this.direction,ke),p&&p.copy(Gm).addScaledVector(gf,Oe),Ge}intersectSphere(a,c){Wh.subVectors(a.center,this.origin);const d=Wh.dot(this.direction),p=Wh.dot(Wh)-d*d,S=a.radius*a.radius;if(p>S)return null;const U=Math.sqrt(S-p),F=d-U,ue=d+U;return ue<0?null:this.at(F<0?ue:F,c)}intersectsSphere(a){return this.distanceSqToPoint(a.center)<=a.radius*a.radius}distanceToPlane(a){const c=a.normal.dot(this.direction);if(0===c)return 0===a.distanceToPoint(this.origin)?0:null;const d=-(this.origin.dot(a.normal)+a.constant)/c;return d>=0?d:null}intersectPlane(a,c){const d=this.distanceToPlane(a);return null===d?null:this.at(d,c)}intersectsPlane(a){const c=a.distanceToPoint(this.origin);return 0===c||a.normal.dot(this.direction)*c<0}intersectBox(a,c){let d,p,S,U,F,ue;const Q=1/this.direction.x,Me=1/this.direction.y,ke=1/this.direction.z,Oe=this.origin;return Q>=0?(d=(a.min.x-Oe.x)*Q,p=(a.max.x-Oe.x)*Q):(d=(a.max.x-Oe.x)*Q,p=(a.min.x-Oe.x)*Q),Me>=0?(S=(a.min.y-Oe.y)*Me,U=(a.max.y-Oe.y)*Me):(S=(a.max.y-Oe.y)*Me,U=(a.min.y-Oe.y)*Me),d>U||S>p||((S>d||isNaN(d))&&(d=S),(U<p||isNaN(p))&&(p=U),ke>=0?(F=(a.min.z-Oe.z)*ke,ue=(a.max.z-Oe.z)*ke):(F=(a.max.z-Oe.z)*ke,ue=(a.min.z-Oe.z)*ke),d>ue||F>p)||((F>d||d!=d)&&(d=F),(ue<p||p!=p)&&(p=ue),p<0)?null:this.at(d>=0?d:p,c)}intersectsBox(a){return null!==this.intersectBox(a,Wh)}intersectTriangle(a,c,d,p,S){Pd.subVectors(c,a),qm.subVectors(d,a),_f.crossVectors(Pd,qm);let F,U=this.direction.dot(_f);if(U>0){if(p)return null;F=1}else{if(!(U<0))return null;F=-1,U=-U}Bd.subVectors(this.origin,a);const ue=F*this.direction.dot(qm.crossVectors(Bd,qm));if(ue<0)return null;const Q=F*this.direction.dot(Pd.cross(Bd));if(Q<0||ue+Q>U)return null;const Me=-F*Bd.dot(_f);return Me<0?null:this.at(Me/U,S)}applyMatrix4(a){return this.origin.applyMatrix4(a),this.direction.transformDirection(a),this}equals(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}const pd=new Mn,Cc=new Mn,UA=new Mn,Rd=new Mn,Qm=new Mn,jm=new Mn,ky=new Mn,zA=new Mn,Wm=new Mn,hc=new Mn;class Ph{constructor(a=new Mn,c=new Mn,d=new Mn){this.a=a,this.b=c,this.c=d}static getNormal(a,c,d,p){p.subVectors(d,c),pd.subVectors(a,c),p.cross(pd);const S=p.lengthSq();return S>0?p.multiplyScalar(1/Math.sqrt(S)):p.set(0,0,0)}static getBarycoord(a,c,d,p,S){pd.subVectors(p,c),Cc.subVectors(d,c),UA.subVectors(a,c);const U=pd.dot(pd),F=pd.dot(Cc),ue=pd.dot(UA),Q=Cc.dot(Cc),Me=Cc.dot(UA),ke=U*Q-F*F;if(0===ke)return S.set(0,0,0),null;const Oe=1/ke,Ge=(Q*ue-F*Me)*Oe,et=(U*Me-F*ue)*Oe;return S.set(1-Ge-et,et,Ge)}static containsPoint(a,c,d,p){return null!==this.getBarycoord(a,c,d,p,Rd)&&Rd.x>=0&&Rd.y>=0&&Rd.x+Rd.y<=1}static getInterpolation(a,c,d,p,S,U,F,ue){return null===this.getBarycoord(a,c,d,p,Rd)?(ue.x=0,ue.y=0,"z"in ue&&(ue.z=0),"w"in ue&&(ue.w=0),null):(ue.setScalar(0),ue.addScaledVector(S,Rd.x),ue.addScaledVector(U,Rd.y),ue.addScaledVector(F,Rd.z),ue)}static isFrontFacing(a,c,d,p){return pd.subVectors(d,c),Cc.subVectors(a,c),pd.cross(Cc).dot(p)<0}set(a,c,d){return this.a.copy(a),this.b.copy(c),this.c.copy(d),this}setFromPointsAndIndices(a,c,d,p){return this.a.copy(a[c]),this.b.copy(a[d]),this.c.copy(a[p]),this}setFromAttributeAndIndices(a,c,d,p){return this.a.fromBufferAttribute(a,c),this.b.fromBufferAttribute(a,d),this.c.fromBufferAttribute(a,p),this}clone(){return(new this.constructor).copy(this)}copy(a){return this.a.copy(a.a),this.b.copy(a.b),this.c.copy(a.c),this}getArea(){return pd.subVectors(this.c,this.b),Cc.subVectors(this.a,this.b),.5*pd.cross(Cc).length()}getMidpoint(a){return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(a){return Ph.getNormal(this.a,this.b,this.c,a)}getPlane(a){return a.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(a,c){return Ph.getBarycoord(a,this.a,this.b,this.c,c)}getInterpolation(a,c,d,p,S){return Ph.getInterpolation(a,this.a,this.b,this.c,c,d,p,S)}containsPoint(a){return Ph.containsPoint(a,this.a,this.b,this.c)}isFrontFacing(a){return Ph.isFrontFacing(this.a,this.b,this.c,a)}intersectsBox(a){return a.intersectsTriangle(this)}closestPointToPoint(a,c){const d=this.a,p=this.b,S=this.c;let U,F;Qm.subVectors(p,d),jm.subVectors(S,d),zA.subVectors(a,d);const ue=Qm.dot(zA),Q=jm.dot(zA);if(ue<=0&&Q<=0)return c.copy(d);Wm.subVectors(a,p);const Me=Qm.dot(Wm),ke=jm.dot(Wm);if(Me>=0&&ke<=Me)return c.copy(p);const Oe=ue*ke-Me*Q;if(Oe<=0&&ue>=0&&Me<=0)return U=ue/(ue-Me),c.copy(d).addScaledVector(Qm,U);hc.subVectors(a,S);const Ge=Qm.dot(hc),et=jm.dot(hc);if(et>=0&&Ge<=et)return c.copy(S);const vt=Ge*Q-ue*et;if(vt<=0&&Q>=0&&et<=0)return F=Q/(Q-et),c.copy(d).addScaledVector(jm,F);const Ye=Me*et-Ge*ke;if(Ye<=0&&ke-Me>=0&&Ge-et>=0)return ky.subVectors(S,p),F=(ke-Me)/(ke-Me+(Ge-et)),c.copy(p).addScaledVector(ky,F);const je=1/(Ye+vt+Oe);return U=vt*je,F=Oe*je,c.copy(d).addScaledVector(Qm,U).addScaledVector(jm,F)}equals(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}}class $h extends _l{constructor(a){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new io(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new kc,this.combine=Ne,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.fog=a.fog,this}}const wr=new mo,Rh=new Wp,$u=new Qc,ua=new Mn,ap=new Mn,mr=new Mn,yl=new Mn,Ro=new Mn,vl=new Mn,Gl=new Ki,Xh=new Ki,ql=new Ki,$p=new Mn,$m=new Mn,wu=new Mn,lp=new Mn,cp=new Mn;class Jl extends Vl{constructor(a=new ol,c=new $h){super(),this.isMesh=!0,this.type="Mesh",this.geometry=a,this.material=c,this.updateMorphTargets()}copy(a,c){return super.copy(a,c),void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice()),void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary)),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}updateMorphTargets(){const c=this.geometry.morphAttributes,d=Object.keys(c);if(d.length>0){const p=c[d[0]];if(void 0!==p){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,U=p.length;S<U;S++){const F=p[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[F]=S}}}}getVertexPosition(a,c){const d=this.geometry,S=d.morphAttributes.position,U=d.morphTargetsRelative;c.fromBufferAttribute(d.attributes.position,a);const F=this.morphTargetInfluences;if(S&&F){vl.set(0,0,0);for(let ue=0,Q=S.length;ue<Q;ue++){const Me=F[ue];0!==Me&&(Ro.fromBufferAttribute(S[ue],a),vl.addScaledVector(U?Ro:Ro.sub(c),Me))}c.add(vl)}return c}raycast(a,c){const d=this.geometry,S=this.matrixWorld;void 0!==this.material&&(null===d.boundingSphere&&d.computeBoundingSphere(),$u.copy(d.boundingSphere),$u.applyMatrix4(S),Rh.copy(a.ray).recast(a.near),(!1!==$u.containsPoint(Rh.origin)||!(null===Rh.intersectSphere($u,ua)||Rh.origin.distanceToSquared(ua)>(a.far-a.near)**2))&&(wr.copy(S).invert(),Rh.copy(a.ray).applyMatrix4(wr),(null===d.boundingBox||!1!==Rh.intersectsBox(d.boundingBox))&&this._computeIntersections(a,c,Rh)))}_computeIntersections(a,c,d){let p;const S=this.geometry,U=this.material,F=S.index,ue=S.attributes.position,Q=S.attributes.uv,Me=S.attributes.uv1,ke=S.attributes.normal,Oe=S.groups,Ge=S.drawRange;if(null!==F)if(Array.isArray(U))for(let et=0,vt=Oe.length;et<vt;et++){const Ye=Oe[et],je=U[Ye.materialIndex];for(let Ht=Math.max(Ye.start,Ge.start),Pn=Math.min(F.count,Math.min(Ye.start+Ye.count,Ge.start+Ge.count));Ht<Pn;Ht+=3)p=Cu(this,je,a,d,Q,Me,ke,F.getX(Ht),F.getX(Ht+1),F.getX(Ht+2)),p&&(p.faceIndex=Math.floor(Ht/3),p.face.materialIndex=Ye.materialIndex,c.push(p))}else for(let Ye=Math.max(0,Ge.start),je=Math.min(F.count,Ge.start+Ge.count);Ye<je;Ye+=3)p=Cu(this,U,a,d,Q,Me,ke,F.getX(Ye),F.getX(Ye+1),F.getX(Ye+2)),p&&(p.faceIndex=Math.floor(Ye/3),c.push(p));else if(void 0!==ue)if(Array.isArray(U))for(let et=0,vt=Oe.length;et<vt;et++){const Ye=Oe[et],je=U[Ye.materialIndex];for(let Ht=Math.max(Ye.start,Ge.start),Pn=Math.min(ue.count,Math.min(Ye.start+Ye.count,Ge.start+Ge.count));Ht<Pn;Ht+=3)p=Cu(this,je,a,d,Q,Me,ke,Ht,Ht+1,Ht+2),p&&(p.faceIndex=Math.floor(Ht/3),p.face.materialIndex=Ye.materialIndex,c.push(p))}else for(let Ye=Math.max(0,Ge.start),je=Math.min(ue.count,Ge.start+Ge.count);Ye<je;Ye+=3)p=Cu(this,U,a,d,Q,Me,ke,Ye,Ye+1,Ye+2),p&&(p.faceIndex=Math.floor(Ye/3),c.push(p))}}function Cu(M,a,c,d,p,S,U,F,ue,Q){M.getVertexPosition(F,ap),M.getVertexPosition(ue,mr),M.getVertexPosition(Q,yl);const Me=function Fy(M,a,c,d,p,S,U,F){let ue;if(ue=1===a.side?d.intersectTriangle(U,S,p,!0,F):d.intersectTriangle(p,S,U,a.side===L,F),null===ue)return null;cp.copy(F),cp.applyMatrix4(M.matrixWorld);const Q=c.ray.origin.distanceTo(cp);return Q<c.near||Q>c.far?null:{distance:Q,point:cp.clone(),object:M}}(M,a,c,d,ap,mr,yl,lp);if(Me){p&&(Gl.fromBufferAttribute(p,F),Xh.fromBufferAttribute(p,ue),ql.fromBufferAttribute(p,Q),Me.uv=Ph.getInterpolation(lp,ap,mr,yl,Gl,Xh,ql,new Ki)),S&&(Gl.fromBufferAttribute(S,F),Xh.fromBufferAttribute(S,ue),ql.fromBufferAttribute(S,Q),Me.uv1=Ph.getInterpolation(lp,ap,mr,yl,Gl,Xh,ql,new Ki)),U&&($p.fromBufferAttribute(U,F),$m.fromBufferAttribute(U,ue),wu.fromBufferAttribute(U,Q),Me.normal=Ph.getInterpolation(lp,ap,mr,yl,$p,$m,wu,new Mn),Me.normal.dot(d.direction)>0&&Me.normal.multiplyScalar(-1));const ke={a:F,b:ue,c:Q,normal:new Mn,materialIndex:0};Ph.getNormal(ap,mr,yl,ke.normal),Me.face=ke}return Me}const Br={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[MORPHTARGETS_COUNT];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t#endif\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\t#ifndef USE_INSTANCING_MORPH\n\t\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\t#endif\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tfloat startCompression = 0.8 - 0.04;\n\tfloat desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min(color.r, min(color.g, color.b));\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max(color.r, max(color.g, color.b));\n\tif (peak < startCompression) return color;\n\tfloat d = 1. - startCompression;\n\tfloat newPeak = 1. - d * d / (peak + d - startCompression);\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / (desaturation * (peak - newPeak) + 1.);\n\treturn mix(color, vec3(1, 1, 1), g);\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},zr={common:{diffuse:{value:new io(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Cs},alphaMap:{value:null},alphaMapTransform:{value:new Cs},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Cs}},envmap:{envMap:{value:null},envMapRotation:{value:new Cs},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Cs}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Cs}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Cs},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Cs},normalScale:{value:new Ki(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Cs},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Cs}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Cs}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Cs}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new io(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new io(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Cs},alphaTest:{value:0},uvTransform:{value:new Cs}},sprite:{diffuse:{value:new io(16777215)},opacity:{value:1},center:{value:new Ki(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Cs},alphaMap:{value:null},alphaMapTransform:{value:new Cs},alphaTest:{value:0}}},Mu={basic:{uniforms:Jc([zr.common,zr.specularmap,zr.envmap,zr.aomap,zr.lightmap,zr.fog]),vertexShader:Br.meshbasic_vert,fragmentShader:Br.meshbasic_frag},lambert:{uniforms:Jc([zr.common,zr.specularmap,zr.envmap,zr.aomap,zr.lightmap,zr.emissivemap,zr.bumpmap,zr.normalmap,zr.displacementmap,zr.fog,zr.lights,{emissive:{value:new io(0)}}]),vertexShader:Br.meshlambert_vert,fragmentShader:Br.meshlambert_frag},phong:{uniforms:Jc([zr.common,zr.specularmap,zr.envmap,zr.aomap,zr.lightmap,zr.emissivemap,zr.bumpmap,zr.normalmap,zr.displacementmap,zr.fog,zr.lights,{emissive:{value:new io(0)},specular:{value:new io(1118481)},shininess:{value:30}}]),vertexShader:Br.meshphong_vert,fragmentShader:Br.meshphong_frag},standard:{uniforms:Jc([zr.common,zr.envmap,zr.aomap,zr.lightmap,zr.emissivemap,zr.bumpmap,zr.normalmap,zr.displacementmap,zr.roughnessmap,zr.metalnessmap,zr.fog,zr.lights,{emissive:{value:new io(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Br.meshphysical_vert,fragmentShader:Br.meshphysical_frag},toon:{uniforms:Jc([zr.common,zr.aomap,zr.lightmap,zr.emissivemap,zr.bumpmap,zr.normalmap,zr.displacementmap,zr.gradientmap,zr.fog,zr.lights,{emissive:{value:new io(0)}}]),vertexShader:Br.meshtoon_vert,fragmentShader:Br.meshtoon_frag},matcap:{uniforms:Jc([zr.common,zr.bumpmap,zr.normalmap,zr.displacementmap,zr.fog,{matcap:{value:null}}]),vertexShader:Br.meshmatcap_vert,fragmentShader:Br.meshmatcap_frag},points:{uniforms:Jc([zr.points,zr.fog]),vertexShader:Br.points_vert,fragmentShader:Br.points_frag},dashed:{uniforms:Jc([zr.common,zr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Br.linedashed_vert,fragmentShader:Br.linedashed_frag},depth:{uniforms:Jc([zr.common,zr.displacementmap]),vertexShader:Br.depth_vert,fragmentShader:Br.depth_frag},normal:{uniforms:Jc([zr.common,zr.bumpmap,zr.normalmap,zr.displacementmap,{opacity:{value:1}}]),vertexShader:Br.meshnormal_vert,fragmentShader:Br.meshnormal_frag},sprite:{uniforms:Jc([zr.sprite,zr.fog]),vertexShader:Br.sprite_vert,fragmentShader:Br.sprite_frag},background:{uniforms:{uvTransform:{value:new Cs},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Br.background_vert,fragmentShader:Br.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Cs}},vertexShader:Br.backgroundCube_vert,fragmentShader:Br.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Br.cube_vert,fragmentShader:Br.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Br.equirect_vert,fragmentShader:Br.equirect_frag},distanceRGBA:{uniforms:Jc([zr.common,zr.displacementmap,{referencePosition:{value:new Mn},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Br.distanceRGBA_vert,fragmentShader:Br.distanceRGBA_frag},shadow:{uniforms:Jc([zr.lights,zr.fog,{color:{value:new io(0)},opacity:{value:1}}]),vertexShader:Br.shadow_vert,fragmentShader:Br.shadow_frag}};Mu.physical={uniforms:Jc([Mu.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Cs},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Cs},clearcoatNormalScale:{value:new Ki(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Cs},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Cs},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Cs},sheen:{value:0},sheenColor:{value:new io(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Cs},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Cs},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Cs},transmissionSamplerSize:{value:new Ki},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Cs},attenuationDistance:{value:0},attenuationColor:{value:new io(0)},specularColor:{value:new io(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Cs},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Cs},anisotropyVector:{value:new Ki},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Cs}}]),vertexShader:Br.meshphysical_vert,fragmentShader:Br.meshphysical_frag};const JA={r:0,b:0,g:0},rm=new kc,l0=new mo;function Lv(M,a,c,d,p,S,U){const F=new io(0);let Q,Me,ue=!0===S?0:1,ke=null,Oe=0,Ge=null;function vt(Ye,je){Ye.getRGB(JA,jp(M)),d.buffers.color.setClear(JA.r,JA.g,JA.b,je,U)}return{getClearColor:function(){return F},setClearColor:function(Ye,je=1){F.set(Ye),ue=je,vt(F,ue)},getClearAlpha:function(){return ue},setClearAlpha:function(Ye){ue=Ye,vt(F,ue)},render:function et(Ye,je){let Rt=!1,At=!0===je.isScene?je.background:null;At&&At.isTexture&&(At=(je.backgroundBlurriness>0?c:a).get(At)),null===At?vt(F,ue):At&&At.isColor&&(vt(At,1),Rt=!0);const Ht=M.xr.getEnvironmentBlendMode();"additive"===Ht?d.buffers.color.setClear(0,0,0,1,U):"alpha-blend"===Ht&&d.buffers.color.setClear(0,0,0,0,U),(M.autoClear||Rt)&&M.clear(M.autoClearColor,M.autoClearDepth,M.autoClearStencil),At&&(At.isCubeTexture||At.mapping===Ln)?(void 0===Me&&(Me=new Jl(new Af(1,1,1),new jc({name:"BackgroundCubeMaterial",uniforms:is(Mu.backgroundCube.uniforms),vertexShader:Mu.backgroundCube.vertexShader,fragmentShader:Mu.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),Me.geometry.deleteAttribute("normal"),Me.geometry.deleteAttribute("uv"),Me.onBeforeRender=function(Pn,yn,xn){this.matrixWorld.copyPosition(xn.matrixWorld)},Object.defineProperty(Me.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),p.update(Me)),rm.copy(je.backgroundRotation),rm.x*=-1,rm.y*=-1,rm.z*=-1,At.isCubeTexture&&!1===At.isRenderTargetTexture&&(rm.y*=-1,rm.z*=-1),Me.material.uniforms.envMap.value=At,Me.material.uniforms.flipEnvMap.value=At.isCubeTexture&&!1===At.isRenderTargetTexture?-1:1,Me.material.uniforms.backgroundBlurriness.value=je.backgroundBlurriness,Me.material.uniforms.backgroundIntensity.value=je.backgroundIntensity,Me.material.uniforms.backgroundRotation.value.setFromMatrix4(l0.makeRotationFromEuler(rm)),Me.material.toneMapped=Ia.getTransfer(At.colorSpace)!==Ga,(ke!==At||Oe!==At.version||Ge!==M.toneMapping)&&(Me.material.needsUpdate=!0,ke=At,Oe=At.version,Ge=M.toneMapping),Me.layers.enableAll(),Ye.unshift(Me,Me.geometry,Me.material,0,0,null)):At&&At.isTexture&&(void 0===Q&&(Q=new Jl(new Bh(2,2),new jc({name:"BackgroundMaterial",uniforms:is(Mu.background.uniforms),vertexShader:Mu.background.vertexShader,fragmentShader:Mu.background.fragmentShader,side:L,depthTest:!1,depthWrite:!1,fog:!1})),Q.geometry.deleteAttribute("normal"),Object.defineProperty(Q.material,"map",{get:function(){return this.uniforms.t2D.value}}),p.update(Q)),Q.material.uniforms.t2D.value=At,Q.material.uniforms.backgroundIntensity.value=je.backgroundIntensity,Q.material.toneMapped=Ia.getTransfer(At.colorSpace)!==Ga,!0===At.matrixAutoUpdate&&At.updateMatrix(),Q.material.uniforms.uvTransform.value.copy(At.matrix),(ke!==At||Oe!==At.version||Ge!==M.toneMapping)&&(Q.material.needsUpdate=!0,ke=At,Oe=At.version,Ge=M.toneMapping),Q.layers.enableAll(),Ye.unshift(Q,Q.geometry,Q.material,0,0,null))}}}function oA(M,a,c,d){const p=M.getParameter(M.MAX_VERTEX_ATTRIBS),S=d.isWebGL2?null:a.get("OES_vertex_array_object"),U=d.isWebGL2||null!==S,F={},ue=Ye(null);let Q=ue,Me=!1;function Ge(Yn){return d.isWebGL2?M.bindVertexArray(Yn):S.bindVertexArrayOES(Yn)}function et(Yn){return d.isWebGL2?M.deleteVertexArray(Yn):S.deleteVertexArrayOES(Yn)}function Ye(Yn){const Qi=[],Oi=[],er=[];for(let Xi=0;Xi<p;Xi++)Qi[Xi]=0,Oi[Xi]=0,er[Xi]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Qi,enabledAttributes:Oi,attributeDivisors:er,object:Yn,attributes:{},index:null}}function At(){const Yn=Q.newAttributes;for(let Qi=0,Oi=Yn.length;Qi<Oi;Qi++)Yn[Qi]=0}function Ht(Yn){Pn(Yn,0)}function Pn(Yn,Qi){const er=Q.enabledAttributes,Xi=Q.attributeDivisors;Q.newAttributes[Yn]=1,0===er[Yn]&&(M.enableVertexAttribArray(Yn),er[Yn]=1),Xi[Yn]!==Qi&&((d.isWebGL2?M:a.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Yn,Qi),Xi[Yn]=Qi)}function yn(){const Yn=Q.newAttributes,Qi=Q.enabledAttributes;for(let Oi=0,er=Qi.length;Oi<er;Oi++)Qi[Oi]!==Yn[Oi]&&(M.disableVertexAttribArray(Oi),Qi[Oi]=0)}function xn(Yn,Qi,Oi,er,Xi,Vi,Vr){!0===Vr?M.vertexAttribIPointer(Yn,Qi,Oi,Xi,Vi):M.vertexAttribPointer(Yn,Qi,Oi,er,Xi,Vi)}function rr(){lr(),Me=!0,Q!==ue&&(Q=ue,Ge(Q.object))}function lr(){ue.geometry=null,ue.program=null,ue.wireframe=!1}return{setup:function ke(Yn,Qi,Oi,er,Xi){let Vi=!1;if(U){const Vr=function vt(Yn,Qi,Oi){const er=!0===Oi.wireframe;let Xi=F[Yn.id];void 0===Xi&&(Xi={},F[Yn.id]=Xi);let Vi=Xi[Qi.id];void 0===Vi&&(Vi={},Xi[Qi.id]=Vi);let Vr=Vi[er];return void 0===Vr&&(Vr=Ye(function Oe(){return d.isWebGL2?M.createVertexArray():S.createVertexArrayOES()}()),Vi[er]=Vr),Vr}(er,Oi,Qi);Q!==Vr&&(Q=Vr,Ge(Q.object)),Vi=function je(Yn,Qi,Oi,er){const Xi=Q.attributes,Vi=Qi.attributes;let Vr=0;const Hr=Oi.getAttributes();for(const Ns in Hr)if(Hr[Ns].location>=0){const Hi=Xi[Ns];let Or=Vi[Ns];if(void 0===Or&&("instanceMatrix"===Ns&&Yn.instanceMatrix&&(Or=Yn.instanceMatrix),"instanceColor"===Ns&&Yn.instanceColor&&(Or=Yn.instanceColor)),void 0===Hi||Hi.attribute!==Or||Or&&Hi.data!==Or.data)return!0;Vr++}return Q.attributesNum!==Vr||Q.index!==er}(Yn,er,Oi,Xi),Vi&&function Rt(Yn,Qi,Oi,er){const Xi={},Vi=Qi.attributes;let Vr=0;const Hr=Oi.getAttributes();for(const Ns in Hr)if(Hr[Ns].location>=0){let Hi=Vi[Ns];void 0===Hi&&("instanceMatrix"===Ns&&Yn.instanceMatrix&&(Hi=Yn.instanceMatrix),"instanceColor"===Ns&&Yn.instanceColor&&(Hi=Yn.instanceColor));const Or={};Or.attribute=Hi,Hi&&Hi.data&&(Or.data=Hi.data),Xi[Ns]=Or,Vr++}Q.attributes=Xi,Q.attributesNum=Vr,Q.index=er}(Yn,er,Oi,Xi)}else{const Vr=!0===Qi.wireframe;(Q.geometry!==er.id||Q.program!==Oi.id||Q.wireframe!==Vr)&&(Q.geometry=er.id,Q.program=Oi.id,Q.wireframe=Vr,Vi=!0)}null!==Xi&&c.update(Xi,M.ELEMENT_ARRAY_BUFFER),(Vi||Me)&&(Me=!1,function qn(Yn,Qi,Oi,er){if(!1===d.isWebGL2&&(Yn.isInstancedMesh||er.isInstancedBufferGeometry)&&null===a.get("ANGLE_instanced_arrays"))return;At();const Xi=er.attributes,Vi=Oi.getAttributes(),Vr=Qi.defaultAttributeValues;for(const Hr in Vi){const Ns=Vi[Hr];if(Ns.location>=0){let Yo=Xi[Hr];if(void 0===Yo&&("instanceMatrix"===Hr&&Yn.instanceMatrix&&(Yo=Yn.instanceMatrix),"instanceColor"===Hr&&Yn.instanceColor&&(Yo=Yn.instanceColor)),void 0!==Yo){const Hi=Yo.normalized,Or=Yo.itemSize,Ds=c.get(Yo);if(void 0===Ds)continue;const bo=Ds.buffer,eo=Ds.type,Qs=Ds.bytesPerElement,fa=!0===d.isWebGL2&&(eo===M.INT||eo===M.UNSIGNED_INT||1013===Yo.gpuType);if(Yo.isInterleavedBufferAttribute){const Ao=Yo.data,On=Ao.stride,Zr=Yo.offset;if(Ao.isInstancedInterleavedBuffer){for(let Zi=0;Zi<Ns.locationSize;Zi++)Pn(Ns.location+Zi,Ao.meshPerAttribute);!0!==Yn.isInstancedMesh&&void 0===er._maxInstanceCount&&(er._maxInstanceCount=Ao.meshPerAttribute*Ao.count)}else for(let Zi=0;Zi<Ns.locationSize;Zi++)Ht(Ns.location+Zi);M.bindBuffer(M.ARRAY_BUFFER,bo);for(let Zi=0;Zi<Ns.locationSize;Zi++)xn(Ns.location+Zi,Or/Ns.locationSize,eo,Hi,On*Qs,(Zr+Or/Ns.locationSize*Zi)*Qs,fa)}else{if(Yo.isInstancedBufferAttribute){for(let Ao=0;Ao<Ns.locationSize;Ao++)Pn(Ns.location+Ao,Yo.meshPerAttribute);!0!==Yn.isInstancedMesh&&void 0===er._maxInstanceCount&&(er._maxInstanceCount=Yo.meshPerAttribute*Yo.count)}else for(let Ao=0;Ao<Ns.locationSize;Ao++)Ht(Ns.location+Ao);M.bindBuffer(M.ARRAY_BUFFER,bo);for(let Ao=0;Ao<Ns.locationSize;Ao++)xn(Ns.location+Ao,Or/Ns.locationSize,eo,Hi,Or*Qs,Or/Ns.locationSize*Ao*Qs,fa)}}else if(void 0!==Vr){const Hi=Vr[Hr];if(void 0!==Hi)switch(Hi.length){case 2:M.vertexAttrib2fv(Ns.location,Hi);break;case 3:M.vertexAttrib3fv(Ns.location,Hi);break;case 4:M.vertexAttrib4fv(Ns.location,Hi);break;default:M.vertexAttrib1fv(Ns.location,Hi)}}}}yn()}(Yn,Qi,Oi,er),null!==Xi&&M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,c.get(Xi).buffer))},reset:rr,resetDefaultState:lr,dispose:function wi(){rr();for(const Yn in F){const Qi=F[Yn];for(const Oi in Qi){const er=Qi[Oi];for(const Xi in er)et(er[Xi].object),delete er[Xi];delete Qi[Oi]}delete F[Yn]}},releaseStatesOfGeometry:function Ut(Yn){if(void 0===F[Yn.id])return;const Qi=F[Yn.id];for(const Oi in Qi){const er=Qi[Oi];for(const Xi in er)et(er[Xi].object),delete er[Xi];delete Qi[Oi]}delete F[Yn.id]},releaseStatesOfProgram:function En(Yn){for(const Qi in F){const Oi=F[Qi];if(void 0===Oi[Yn.id])continue;const er=Oi[Yn.id];for(const Xi in er)et(er[Xi].object),delete er[Xi];delete Oi[Yn.id]}},initAttributes:At,enableAttribute:Ht,disableUnusedAttributes:yn}}function Ef(M,a,c,d){const p=d.isWebGL2;let S;this.setMode=function U(Me){S=Me},this.render=function F(Me,ke){M.drawArrays(S,Me,ke),c.update(ke,S,1)},this.renderInstances=function ue(Me,ke,Oe){if(0===Oe)return;let Ge,et;if(p)Ge=M,et="drawArraysInstanced";else if(Ge=a.get("ANGLE_instanced_arrays"),et="drawArraysInstancedANGLE",null===Ge)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");Ge[et](S,Me,ke,Oe),c.update(ke,S,Oe)},this.renderMultiDraw=function Q(Me,ke,Oe){if(0===Oe)return;const Ge=a.get("WEBGL_multi_draw");if(null===Ge)for(let et=0;et<Oe;et++)this.render(Me[et],ke[et]);else{Ge.multiDrawArraysWEBGL(S,Me,0,ke,0,Oe);let et=0;for(let vt=0;vt<Oe;vt++)et+=ke[vt];c.update(et,S,1)}}}function nc(M,a,c){let d;function S(xn){if("highp"===xn){if(M.getShaderPrecisionFormat(M.VERTEX_SHADER,M.HIGH_FLOAT).precision>0&&M.getShaderPrecisionFormat(M.FRAGMENT_SHADER,M.HIGH_FLOAT).precision>0)return"highp";xn="mediump"}return"mediump"===xn&&M.getShaderPrecisionFormat(M.VERTEX_SHADER,M.MEDIUM_FLOAT).precision>0&&M.getShaderPrecisionFormat(M.FRAGMENT_SHADER,M.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const U=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===M.constructor.name;let F=void 0!==c.precision?c.precision:"highp";const ue=S(F);ue!==F&&(console.warn("THREE.WebGLRenderer:",F,"not supported, using",ue,"instead."),F=ue);const Q=U||a.has("WEBGL_draw_buffers"),Me=!0===c.logarithmicDepthBuffer,ke=M.getParameter(M.MAX_TEXTURE_IMAGE_UNITS),Oe=M.getParameter(M.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Ge=M.getParameter(M.MAX_TEXTURE_SIZE),et=M.getParameter(M.MAX_CUBE_MAP_TEXTURE_SIZE),vt=M.getParameter(M.MAX_VERTEX_ATTRIBS),Ye=M.getParameter(M.MAX_VERTEX_UNIFORM_VECTORS),je=M.getParameter(M.MAX_VARYING_VECTORS),Rt=M.getParameter(M.MAX_FRAGMENT_UNIFORM_VECTORS),At=Oe>0,Ht=U||a.has("OES_texture_float");return{isWebGL2:U,drawBuffers:Q,getMaxAnisotropy:function p(){if(void 0!==d)return d;if(!0===a.has("EXT_texture_filter_anisotropic")){const xn=a.get("EXT_texture_filter_anisotropic");d=M.getParameter(xn.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else d=0;return d},getMaxPrecision:S,precision:F,logarithmicDepthBuffer:Me,maxTextures:ke,maxVertexTextures:Oe,maxTextureSize:Ge,maxCubemapSize:et,maxAttributes:vt,maxVertexUniforms:Ye,maxVaryings:je,maxFragmentUniforms:Rt,vertexTextures:At,floatFragmentTextures:Ht,floatVertexTextures:At&&Ht,maxSamples:U?M.getParameter(M.MAX_SAMPLES):0}}function y_(M){const a=this;let c=null,d=0,p=!1,S=!1;const U=new Dd,F=new Cs,ue={value:null,needsUpdate:!1};function Me(ke,Oe,Ge,et){const vt=null!==ke?ke.length:0;let Ye=null;if(0!==vt){if(Ye=ue.value,!0!==et||null===Ye){const je=Ge+4*vt,Rt=Oe.matrixWorldInverse;F.getNormalMatrix(Rt),(null===Ye||Ye.length<je)&&(Ye=new Float32Array(je));for(let At=0,Ht=Ge;At!==vt;++At,Ht+=4)U.copy(ke[At]).applyMatrix4(Rt,F),U.normal.toArray(Ye,Ht),Ye[Ht+3]=U.constant}ue.value=Ye,ue.needsUpdate=!0}return a.numPlanes=vt,a.numIntersection=0,Ye}this.uniform=ue,this.numPlanes=0,this.numIntersection=0,this.init=function(ke,Oe){const Ge=0!==ke.length||Oe||0!==d||p;return p=Oe,d=ke.length,Ge},this.beginShadows=function(){S=!0,Me(null)},this.endShadows=function(){S=!1},this.setGlobalState=function(ke,Oe){c=Me(ke,Oe,0)},this.setState=function(ke,Oe,Ge){const et=ke.clippingPlanes,vt=ke.clipIntersection,Ye=ke.clipShadows,je=M.get(ke);if(!p||null===et||0===et.length||S&&!Ye)S?Me(null):function Q(){ue.value!==c&&(ue.value=c,ue.needsUpdate=d>0),a.numPlanes=d,a.numIntersection=0}();else{const Rt=S?0:d,At=4*Rt;let Ht=je.clippingState||null;ue.value=Ht,Ht=Me(et,Oe,At,Ge);for(let Pn=0;Pn!==At;++Pn)Ht[Pn]=c[Pn];je.clippingState=Ht,this.numIntersection=vt?this.numPlanes:0,this.numPlanes+=Rt}}}class Sf extends Vl{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new mo,this.projectionMatrix=new mo,this.projectionMatrixInverse=new mo,this.coordinateSystem=Qu}copy(a,c){return super.copy(a,c),this.matrixWorldInverse.copy(a.matrixWorldInverse),this.projectionMatrix.copy(a.projectionMatrix),this.projectionMatrixInverse.copy(a.projectionMatrixInverse),this.coordinateSystem=a.coordinateSystem,this}getWorldDirection(a){return super.getWorldDirection(a).negate()}updateMatrixWorld(a){super.updateMatrixWorld(a),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(a,c){super.updateWorldMatrix(a,c),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Ku=new Mn,eg=new Ki,Hd=new Ki;class gi extends Sf{constructor(a=50,c=1,d=.1,p=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=a,this.zoom=1,this.near=d,this.far=p,this.focus=10,this.aspect=c,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(a,c){return super.copy(a,c),this.fov=a.fov,this.zoom=a.zoom,this.near=a.near,this.far=a.far,this.focus=a.focus,this.aspect=a.aspect,this.view=null===a.view?null:Object.assign({},a.view),this.filmGauge=a.filmGauge,this.filmOffset=a.filmOffset,this}setFocalLength(a){const c=.5*this.getFilmHeight()/a;this.fov=2*ju*Math.atan(c),this.updateProjectionMatrix()}getFocalLength(){const a=Math.tan(.5*sf*this.fov);return.5*this.getFilmHeight()/a}getEffectiveFOV(){return 2*ju*Math.atan(Math.tan(.5*sf*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(a,c,d){Ku.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),c.set(Ku.x,Ku.y).multiplyScalar(-a/Ku.z),Ku.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),d.set(Ku.x,Ku.y).multiplyScalar(-a/Ku.z)}getViewSize(a,c){return this.getViewBounds(a,eg,Hd),c.subVectors(Hd,eg)}setViewOffset(a,c,d,p,S,U){this.aspect=a/c,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=c,this.view.offsetX=d,this.view.offsetY=p,this.view.width=S,this.view.height=U,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const a=this.near;let c=a*Math.tan(.5*sf*this.fov)/this.zoom,d=2*c,p=this.aspect*d,S=-.5*p;const U=this.view;if(null!==this.view&&this.view.enabled){const ue=U.fullWidth,Q=U.fullHeight;S+=U.offsetX*p/ue,c-=U.offsetY*d/Q,p*=U.width/ue,d*=U.height/Q}const F=this.filmOffset;0!==F&&(S+=a*F/this.getFilmWidth()),this.projectionMatrix.makePerspective(S,S+p,c,c-d,a,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){const c=super.toJSON(a);return c.object.fov=this.fov,c.object.zoom=this.zoom,c.object.near=this.near,c.object.far=this.far,c.object.focus=this.focus,c.object.aspect=this.aspect,null!==this.view&&(c.object.view=Object.assign({},this.view)),c.object.filmGauge=this.filmGauge,c.object.filmOffset=this.filmOffset,c}}class fi extends Vl{constructor(a,c,d){super(),this.type="CubeCamera",this.renderTarget=d,this.coordinateSystem=null,this.activeMipmapLevel=0;const p=new gi(-90,1,a,c);p.layers=this.layers,this.add(p);const S=new gi(-90,1,a,c);S.layers=this.layers,this.add(S);const U=new gi(-90,1,a,c);U.layers=this.layers,this.add(U);const F=new gi(-90,1,a,c);F.layers=this.layers,this.add(F);const ue=new gi(-90,1,a,c);ue.layers=this.layers,this.add(ue);const Q=new gi(-90,1,a,c);Q.layers=this.layers,this.add(Q)}updateCoordinateSystem(){const a=this.coordinateSystem,c=this.children.concat(),[d,p,S,U,F,ue]=c;for(const Q of c)this.remove(Q);if(a===Qu)d.up.set(0,1,0),d.lookAt(1,0,0),p.up.set(0,1,0),p.lookAt(-1,0,0),S.up.set(0,0,-1),S.lookAt(0,1,0),U.up.set(0,0,1),U.lookAt(0,-1,0),F.up.set(0,1,0),F.lookAt(0,0,1),ue.up.set(0,1,0),ue.lookAt(0,0,-1);else{if(2001!==a)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+a);d.up.set(0,-1,0),d.lookAt(-1,0,0),p.up.set(0,-1,0),p.lookAt(1,0,0),S.up.set(0,0,1),S.lookAt(0,1,0),U.up.set(0,0,-1),U.lookAt(0,-1,0),F.up.set(0,-1,0),F.lookAt(0,0,1),ue.up.set(0,-1,0),ue.lookAt(0,0,-1)}for(const Q of c)this.add(Q),Q.updateMatrixWorld()}update(a,c){null===this.parent&&this.updateMatrixWorld();const{renderTarget:d,activeMipmapLevel:p}=this;this.coordinateSystem!==a.coordinateSystem&&(this.coordinateSystem=a.coordinateSystem,this.updateCoordinateSystem());const[S,U,F,ue,Q,Me]=this.children,ke=a.getRenderTarget(),Oe=a.getActiveCubeFace(),Ge=a.getActiveMipmapLevel(),et=a.xr.enabled;a.xr.enabled=!1;const vt=d.texture.generateMipmaps;d.texture.generateMipmaps=!1,a.setRenderTarget(d,0,p),a.render(c,S),a.setRenderTarget(d,1,p),a.render(c,U),a.setRenderTarget(d,2,p),a.render(c,F),a.setRenderTarget(d,3,p),a.render(c,ue),a.setRenderTarget(d,4,p),a.render(c,Q),d.texture.generateMipmaps=vt,a.setRenderTarget(d,5,p),a.render(c,Me),a.setRenderTarget(ke,Oe,Ge),a.xr.enabled=et,d.texture.needsPMREMUpdate=!0}}class qa extends _u{constructor(a,c,d,p,S,U,F,ue,Q,Me){super(a=void 0!==a?a:[],c=void 0!==c?c:Sn,d,p,S,U,F,ue,Q,Me),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(a){this.image=a}}class tg extends Hl{constructor(a=1,c={}){super(a,a,c),this.isWebGLCubeRenderTarget=!0;const d={width:a,height:a,depth:1};this.texture=new qa([d,d,d,d,d,d],c.mapping,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==c.generateMipmaps&&c.generateMipmaps,this.texture.minFilter=void 0!==c.minFilter?c.minFilter:wt}fromEquirectangularTexture(a,c){this.texture.type=c.type,this.texture.colorSpace=c.colorSpace,this.texture.generateMipmaps=c.generateMipmaps,this.texture.minFilter=c.minFilter,this.texture.magFilter=c.magFilter;const d_uniforms={tEquirect:{value:null}},d_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",d_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",p=new Af(5,5,5),S=new jc({name:"CubemapFromEquirect",uniforms:is(d_uniforms),vertexShader:d_vertexShader,fragmentShader:d_fragmentShader,side:1,blending:fe});S.uniforms.tEquirect.value=c;const U=new Jl(p,S),F=c.minFilter;return c.minFilter===_e&&(c.minFilter=wt),new fi(1,10,this).update(a,U),c.minFilter=F,U.geometry.dispose(),U.material.dispose(),this}clear(a,c,d,p){const S=a.getRenderTarget();for(let U=0;U<6;U++)a.setRenderTarget(this,U),a.clear(c,d,p);a.setRenderTarget(S)}}function sm(M){let a=new WeakMap;function c(U,F){return 303===F?U.mapping=Sn:304===F&&(U.mapping=cn),U}function p(U){const F=U.target;F.removeEventListener("dispose",p);const ue=a.get(F);void 0!==ue&&(a.delete(F),ue.dispose())}return{get:function d(U){if(U&&U.isTexture){const F=U.mapping;if(303===F||304===F){if(a.has(U))return c(a.get(U).texture,U.mapping);{const ue=U.image;if(ue&&ue.height>0){const Q=new tg(ue.height);return Q.fromEquirectangularTexture(M,U),a.set(U,Q),U.addEventListener("dispose",p),c(Q.texture,U.mapping)}return null}}}return U},dispose:function S(){a=new WeakMap}}}class Zh extends Sf{constructor(a=-1,c=1,d=1,p=-1,S=.1,U=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=a,this.right=c,this.top=d,this.bottom=p,this.near=S,this.far=U,this.updateProjectionMatrix()}copy(a,c){return super.copy(a,c),this.left=a.left,this.right=a.right,this.top=a.top,this.bottom=a.bottom,this.near=a.near,this.far=a.far,this.zoom=a.zoom,this.view=null===a.view?null:Object.assign({},a.view),this}setViewOffset(a,c,d,p,S,U){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=c,this.view.offsetX=d,this.view.offsetY=p,this.view.width=S,this.view.height=U,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const a=(this.right-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),d=(this.right+this.left)/2,p=(this.top+this.bottom)/2;let S=d-a,U=d+a,F=p+c,ue=p-c;if(null!==this.view&&this.view.enabled){const Q=(this.right-this.left)/this.view.fullWidth/this.zoom,Me=(this.top-this.bottom)/this.view.fullHeight/this.zoom;S+=Q*this.view.offsetX,U=S+Q*this.view.width,F-=Me*this.view.offsetY,ue=F-Me*this.view.height}this.projectionMatrix.makeOrthographic(S,U,F,ue,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){const c=super.toJSON(a);return c.object.zoom=this.zoom,c.object.left=this.left,c.object.right=this.right,c.object.top=this.top,c.object.bottom=this.bottom,c.object.near=this.near,c.object.far=this.far,null!==this.view&&(c.object.view=Object.assign({},this.view)),c}}const c0=[.125,.215,.35,.446,.526,.582],h0=new Zh,Xy=new io;let u0=null,d0=0,ng=0;const jl=(1+Math.sqrt(5))/2,mh=1/jl,aA=[new Mn(1,1,1),new Mn(-1,1,1),new Mn(1,1,-1),new Mn(-1,1,-1),new Mn(0,jl,mh),new Mn(0,jl,-mh),new Mn(mh,0,jl),new Mn(-mh,0,jl),new Mn(jl,mh,0),new Mn(-jl,mh,0)];class Eu{constructor(a){this._renderer=a,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(a,c=0,d=.1,p=100){u0=this._renderer.getRenderTarget(),d0=this._renderer.getActiveCubeFace(),ng=this._renderer.getActiveMipmapLevel(),this._setSize(256);const S=this._allocateTargets();return S.depthBuffer=!0,this._sceneToCubeUV(a,d,p,S),c>0&&this._blur(S,0,0,c),this._applyPMREM(S),this._cleanup(S),S}fromEquirectangular(a,c=null){return this._fromTexture(a,c)}fromCubemap(a,c=null){return this._fromTexture(a,c)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=ae(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Z(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(a){this._lodMax=Math.floor(Math.log2(a)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let a=0;a<this._lodPlanes.length;a++)this._lodPlanes[a].dispose()}_cleanup(a){this._renderer.setRenderTarget(u0,d0,ng),a.scissorTest=!1,mp(a,0,0,a.width,a.height)}_fromTexture(a,c){this._setSize(a.mapping===Sn||a.mapping===cn?0===a.image.length?16:a.image[0].width||a.image[0].image.width:a.image.width/4),u0=this._renderer.getRenderTarget(),d0=this._renderer.getActiveCubeFace(),ng=this._renderer.getActiveMipmapLevel();const d=c||this._allocateTargets();return this._textureToCubeUV(a,d),this._applyPMREM(d),this._cleanup(d),d}_allocateTargets(){const a=3*Math.max(this._cubeSize,112),c=4*this._cubeSize,d={magFilter:wt,minFilter:wt,generateMipmaps:!1,type:vn,format:Rn,colorSpace:fh,depthBuffer:!1},p=ig(a,c,d);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==a||this._pingPongRenderTarget.height!==c){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=ig(a,c,d);const{_lodMax:S}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function gd(M){const a=[],c=[],d=[];let p=M;const S=M-4+1+c0.length;for(let U=0;U<S;U++){const F=Math.pow(2,p);c.push(F);let ue=1/F;U>M-4?ue=c0[U-M+4-1]:0===U&&(ue=0),d.push(ue);const Q=1/(F-2),Me=-Q,ke=1+Q,Oe=[Me,Me,ke,Me,ke,ke,Me,Me,ke,ke,Me,ke],Ge=6,et=6,vt=3,Ye=2,je=1,Rt=new Float32Array(vt*et*Ge),At=new Float32Array(Ye*et*Ge),Ht=new Float32Array(je*et*Ge);for(let yn=0;yn<Ge;yn++){const xn=yn%3*2/3-1,qn=yn>2?0:-1;Rt.set([xn,qn,0,xn+2/3,qn,0,xn+2/3,qn+1,0,xn,qn,0,xn+2/3,qn+1,0,xn,qn+1,0],vt*et*yn),At.set(Oe,Ye*et*yn),Ht.set([yn,yn,yn,yn,yn,yn],je*et*yn)}const Pn=new ol;Pn.setAttribute("position",new tl(Rt,vt)),Pn.setAttribute("uv",new tl(At,Ye)),Pn.setAttribute("faceIndex",new tl(Ht,je)),a.push(Pn),p>4&&p--}return{lodPlanes:a,sizeLods:c,sigmas:d}}(S)),this._blurMaterial=function te(M,a,c){const d=new Float32Array(20),p=new Mn(0,1,0);return new jc({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/a,CUBEUV_TEXEL_HEIGHT:1/c,CUBEUV_MAX_MIP:`${M}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:d},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:p}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:fe,depthTest:!1,depthWrite:!1})}(S,a,c)}return p}_compileMaterial(a){const c=new Jl(this._lodPlanes[0],a);this._renderer.compile(c,h0)}_sceneToCubeUV(a,c,d,p){const F=new gi(90,1,c,d),ue=[1,-1,1,1,1,1],Q=[1,1,1,-1,-1,-1],Me=this._renderer,ke=Me.autoClear,Oe=Me.toneMapping;Me.getClearColor(Xy),Me.toneMapping=pt,Me.autoClear=!1;const Ge=new $h({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),et=new Jl(new Af,Ge);let vt=!1;const Ye=a.background;Ye?Ye.isColor&&(Ge.color.copy(Ye),a.background=null,vt=!0):(Ge.color.copy(Xy),vt=!0);for(let je=0;je<6;je++){const Rt=je%3;0===Rt?(F.up.set(0,ue[je],0),F.lookAt(Q[je],0,0)):1===Rt?(F.up.set(0,0,ue[je]),F.lookAt(0,Q[je],0)):(F.up.set(0,ue[je],0),F.lookAt(0,0,Q[je]));const At=this._cubeSize;mp(p,Rt*At,je>2?At:0,At,At),Me.setRenderTarget(p),vt&&Me.render(et,F),Me.render(a,F)}et.geometry.dispose(),et.material.dispose(),Me.toneMapping=Oe,Me.autoClear=ke,a.background=Ye}_textureToCubeUV(a,c){const d=this._renderer,p=a.mapping===Sn||a.mapping===cn;p?(null===this._cubemapMaterial&&(this._cubemapMaterial=ae()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===a.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Z());const S=p?this._cubemapMaterial:this._equirectMaterial,U=new Jl(this._lodPlanes[0],S);S.uniforms.envMap.value=a;const ue=this._cubeSize;mp(c,0,0,3*ue,2*ue),d.setRenderTarget(c),d.render(U,h0)}_applyPMREM(a){const c=this._renderer,d=c.autoClear;c.autoClear=!1;for(let p=1;p<this._lodPlanes.length;p++){const S=Math.sqrt(this._sigmas[p]*this._sigmas[p]-this._sigmas[p-1]*this._sigmas[p-1]);this._blur(a,p-1,p,S,aA[(p-1)%aA.length])}c.autoClear=d}_blur(a,c,d,p,S){const U=this._pingPongRenderTarget;this._halfBlur(a,U,c,d,p,"latitudinal",S),this._halfBlur(U,a,d,d,p,"longitudinal",S)}_halfBlur(a,c,d,p,S,U,F){const ue=this._renderer,Q=this._blurMaterial;"latitudinal"!==U&&"longitudinal"!==U&&console.error("blur direction must be either latitudinal or longitudinal!");const ke=new Jl(this._lodPlanes[p],Q),Oe=Q.uniforms,Ge=this._sizeLods[d]-1,et=isFinite(S)?Math.PI/(2*Ge):2*Math.PI/39,vt=S/et,Ye=isFinite(S)?1+Math.floor(3*vt):20;Ye>20&&console.warn(`sigmaRadians, ${S}, is too large and will clip, as it requested ${Ye} samples when the maximum is set to 20`);const je=[];let Rt=0;for(let xn=0;xn<20;++xn){const qn=xn/vt,wi=Math.exp(-qn*qn/2);je.push(wi),0===xn?Rt+=wi:xn<Ye&&(Rt+=2*wi)}for(let xn=0;xn<je.length;xn++)je[xn]=je[xn]/Rt;Oe.envMap.value=a.texture,Oe.samples.value=Ye,Oe.weights.value=je,Oe.latitudinal.value="latitudinal"===U,F&&(Oe.poleAxis.value=F);const{_lodMax:At}=this;Oe.dTheta.value=et,Oe.mipInt.value=At-d;const Ht=this._sizeLods[p];mp(c,3*Ht*(p>At-4?p-At+4:0),4*(this._cubeSize-Ht),3*Ht,2*Ht),ue.setRenderTarget(c),ue.render(ke,h0)}}function ig(M,a,c){const d=new Hl(M,a,c);return d.texture.mapping=Ln,d.texture.name="PMREM.cubeUv",d.scissorTest=!0,d}function mp(M,a,c,d,p){M.viewport.set(a,c,d,p),M.scissor.set(a,c,d,p)}function Z(){return new jc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:fe,depthTest:!1,depthWrite:!1})}function ae(){return new jc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:fe,depthTest:!1,depthWrite:!1})}function qe(M){let a=new WeakMap,c=null;function S(F){const ue=F.target;ue.removeEventListener("dispose",S);const Q=a.get(ue);void 0!==Q&&(a.delete(ue),Q.dispose())}return{get:function d(F){if(F&&F.isTexture){const ue=F.mapping,Q=303===ue||304===ue,Me=ue===Sn||ue===cn;if(Q||Me){if(F.isRenderTargetTexture&&!0===F.needsPMREMUpdate){F.needsPMREMUpdate=!1;let ke=a.get(F);return null===c&&(c=new Eu(M)),ke=Q?c.fromEquirectangular(F,ke):c.fromCubemap(F,ke),a.set(F,ke),ke.texture}if(a.has(F))return a.get(F).texture;{const ke=F.image;if(Q&&ke&&ke.height>0||Me&&ke&&function p(F){let ue=0;for(let Me=0;Me<6;Me++)void 0!==F[Me]&&ue++;return 6===ue}(ke)){null===c&&(c=new Eu(M));const Oe=Q?c.fromEquirectangular(F):c.fromCubemap(F);return a.set(F,Oe),F.addEventListener("dispose",S),Oe.texture}return null}}}return F},dispose:function U(){a=new WeakMap,null!==c&&(c.dispose(),c=null)}}}function ft(M){const a={};function c(d){if(void 0!==a[d])return a[d];let p;switch(d){case"WEBGL_depth_texture":p=M.getExtension("WEBGL_depth_texture")||M.getExtension("MOZ_WEBGL_depth_texture")||M.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":p=M.getExtension("EXT_texture_filter_anisotropic")||M.getExtension("MOZ_EXT_texture_filter_anisotropic")||M.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":p=M.getExtension("WEBGL_compressed_texture_s3tc")||M.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||M.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":p=M.getExtension("WEBGL_compressed_texture_pvrtc")||M.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:p=M.getExtension(d)}return a[d]=p,p}return{has:function(d){return null!==c(d)},init:function(d){d.isWebGL2?(c("EXT_color_buffer_float"),c("WEBGL_clip_cull_distance")):(c("WEBGL_depth_texture"),c("OES_texture_float"),c("OES_texture_half_float"),c("OES_texture_half_float_linear"),c("OES_standard_derivatives"),c("OES_element_index_uint"),c("OES_vertex_array_object"),c("ANGLE_instanced_arrays")),c("OES_texture_float_linear"),c("EXT_color_buffer_half_float"),c("WEBGL_multisampled_render_to_texture")},get:function(d){const p=c(d);return null===p&&console.warn("THREE.WebGLRenderer: "+d+" extension not supported."),p}}}function Pt(M,a,c,d){const p={},S=new WeakMap;function U(ke){const Oe=ke.target;null!==Oe.index&&a.remove(Oe.index);for(const et in Oe.attributes)a.remove(Oe.attributes[et]);for(const et in Oe.morphAttributes){const vt=Oe.morphAttributes[et];for(let Ye=0,je=vt.length;Ye<je;Ye++)a.remove(vt[Ye])}Oe.removeEventListener("dispose",U),delete p[Oe.id];const Ge=S.get(Oe);Ge&&(a.remove(Ge),S.delete(Oe)),d.releaseStatesOfGeometry(Oe),!0===Oe.isInstancedBufferGeometry&&delete Oe._maxInstanceCount,c.memory.geometries--}function Q(ke){const Oe=[],Ge=ke.index,et=ke.attributes.position;let vt=0;if(null!==Ge){const Rt=Ge.array;vt=Ge.version;for(let At=0,Ht=Rt.length;At<Ht;At+=3){const Pn=Rt[At+0],yn=Rt[At+1],xn=Rt[At+2];Oe.push(Pn,yn,yn,xn,xn,Pn)}}else{if(void 0===et)return;vt=et.version;for(let At=0,Ht=et.array.length/3-1;At<Ht;At+=3){const Pn=At+0,yn=At+1,xn=At+2;Oe.push(Pn,yn,yn,xn,xn,Pn)}}const Ye=new(Np(Oe)?vu:qp)(Oe,1);Ye.version=vt;const je=S.get(ke);je&&a.remove(je),S.set(ke,Ye)}return{get:function F(ke,Oe){return!0===p[Oe.id]||(Oe.addEventListener("dispose",U),p[Oe.id]=!0,c.memory.geometries++),Oe},update:function ue(ke){const Oe=ke.attributes;for(const et in Oe)a.update(Oe[et],M.ARRAY_BUFFER);const Ge=ke.morphAttributes;for(const et in Ge){const vt=Ge[et];for(let Ye=0,je=vt.length;Ye<je;Ye++)a.update(vt[Ye],M.ARRAY_BUFFER)}},getWireframeAttribute:function Me(ke){const Oe=S.get(ke);if(Oe){const Ge=ke.index;null!==Ge&&Oe.version<Ge.version&&Q(ke)}else Q(ke);return S.get(ke)}}}function on(M,a,c,d){const p=d.isWebGL2;let S,F,ue;this.setMode=function U(Ge){S=Ge},this.setIndex=function Q(Ge){F=Ge.type,ue=Ge.bytesPerElement},this.render=function Me(Ge,et){M.drawElements(S,et,F,Ge*ue),c.update(et,S,1)},this.renderInstances=function ke(Ge,et,vt){if(0===vt)return;let Ye,je;if(p)Ye=M,je="drawElementsInstanced";else if(Ye=a.get("ANGLE_instanced_arrays"),je="drawElementsInstancedANGLE",null===Ye)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");Ye[je](S,et,F,Ge*ue,vt),c.update(et,S,vt)},this.renderMultiDraw=function Oe(Ge,et,vt){if(0===vt)return;const Ye=a.get("WEBGL_multi_draw");if(null===Ye)for(let je=0;je<vt;je++)this.render(Ge[je]/ue,et[je]);else{Ye.multiDrawElementsWEBGL(S,et,0,F,Ge,0,vt);let je=0;for(let Rt=0;Rt<vt;Rt++)je+=et[Rt];c.update(je,S,1)}}}function sn(M){const c={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:c,programs:null,autoReset:!0,reset:function p(){c.calls=0,c.triangles=0,c.points=0,c.lines=0},update:function d(S,U,F){switch(c.calls++,U){case M.TRIANGLES:c.triangles+=F*(S/3);break;case M.LINES:c.lines+=F*(S/2);break;case M.LINE_STRIP:c.lines+=F*(S-1);break;case M.LINE_LOOP:c.lines+=F*S;break;case M.POINTS:c.points+=F*S;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",U)}}}}class Vn extends _u{constructor(a=null,c=1,d=1,p=1){super(null),this.isDataArrayTexture=!0,this.image={data:a,width:c,height:d,depth:p},this.magFilter=qi,this.minFilter=qi,this.wrapR=ui,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}function Kn(M,a){return M[0]-a[0]}function li(M,a){return Math.abs(a[1])-Math.abs(M[1])}function Ni(M,a,c){const d={},p=new Float32Array(8),S=new WeakMap,U=new Ya,F=[];for(let Q=0;Q<8;Q++)F[Q]=[Q,0];return{update:function ue(Q,Me,ke){const Oe=Q.morphTargetInfluences;if(!0===a.isWebGL2){const Ge=Me.morphAttributes.position||Me.morphAttributes.normal||Me.morphAttributes.color,et=void 0!==Ge?Ge.length:0;let vt=S.get(Me);if(void 0===vt||vt.count!==et){let rr=function(){Ut.dispose(),S.delete(Me),Me.removeEventListener("dispose",rr)};void 0!==vt&&vt.texture.dispose();const Ye=void 0!==Me.morphAttributes.position,je=void 0!==Me.morphAttributes.normal,Rt=void 0!==Me.morphAttributes.color,At=Me.morphAttributes.position||[],Ht=Me.morphAttributes.normal||[],Pn=Me.morphAttributes.color||[];let yn=0;!0===Ye&&(yn=1),!0===je&&(yn=2),!0===Rt&&(yn=3);let xn=Me.attributes.position.count*yn,qn=1;xn>a.maxTextureSize&&(qn=Math.ceil(xn/a.maxTextureSize),xn=a.maxTextureSize);const wi=new Float32Array(xn*qn*4*et),Ut=new Vn(wi,xn,qn,et);Ut.type=dn,Ut.needsUpdate=!0;const En=4*yn;for(let lr=0;lr<et;lr++){const Yn=At[lr],Qi=Ht[lr],Oi=Pn[lr],er=xn*qn*4*lr;for(let Xi=0;Xi<Yn.count;Xi++){const Vi=Xi*En;!0===Ye&&(U.fromBufferAttribute(Yn,Xi),wi[er+Vi+0]=U.x,wi[er+Vi+1]=U.y,wi[er+Vi+2]=U.z,wi[er+Vi+3]=0),!0===je&&(U.fromBufferAttribute(Qi,Xi),wi[er+Vi+4]=U.x,wi[er+Vi+5]=U.y,wi[er+Vi+6]=U.z,wi[er+Vi+7]=0),!0===Rt&&(U.fromBufferAttribute(Oi,Xi),wi[er+Vi+8]=U.x,wi[er+Vi+9]=U.y,wi[er+Vi+10]=U.z,wi[er+Vi+11]=4===Oi.itemSize?U.w:1)}}vt={count:et,texture:Ut,size:new Ki(xn,qn)},S.set(Me,vt),Me.addEventListener("dispose",rr)}if(!0===Q.isInstancedMesh&&null!==Q.morphTexture)ke.getUniforms().setValue(M,"morphTexture",Q.morphTexture,c);else{let Ye=0;for(let Rt=0;Rt<Oe.length;Rt++)Ye+=Oe[Rt];const je=Me.morphTargetsRelative?1:1-Ye;ke.getUniforms().setValue(M,"morphTargetBaseInfluence",je),ke.getUniforms().setValue(M,"morphTargetInfluences",Oe)}ke.getUniforms().setValue(M,"morphTargetsTexture",vt.texture,c),ke.getUniforms().setValue(M,"morphTargetsTextureSize",vt.size)}else{const Ge=void 0===Oe?0:Oe.length;let et=d[Me.id];if(void 0===et||et.length!==Ge){et=[];for(let At=0;At<Ge;At++)et[At]=[At,0];d[Me.id]=et}for(let At=0;At<Ge;At++){const Ht=et[At];Ht[0]=At,Ht[1]=Oe[At]}et.sort(li);for(let At=0;At<8;At++)At<Ge&&et[At][1]?(F[At][0]=et[At][0],F[At][1]=et[At][1]):(F[At][0]=Number.MAX_SAFE_INTEGER,F[At][1]=0);F.sort(Kn);const vt=Me.morphAttributes.position,Ye=Me.morphAttributes.normal;let je=0;for(let At=0;At<8;At++){const Ht=F[At],Pn=Ht[0],yn=Ht[1];Pn!==Number.MAX_SAFE_INTEGER&&yn?(vt&&Me.getAttribute("morphTarget"+At)!==vt[Pn]&&Me.setAttribute("morphTarget"+At,vt[Pn]),Ye&&Me.getAttribute("morphNormal"+At)!==Ye[Pn]&&Me.setAttribute("morphNormal"+At,Ye[Pn]),p[At]=yn,je+=yn):(vt&&!0===Me.hasAttribute("morphTarget"+At)&&Me.deleteAttribute("morphTarget"+At),Ye&&!0===Me.hasAttribute("morphNormal"+At)&&Me.deleteAttribute("morphNormal"+At),p[At]=0)}const Rt=Me.morphTargetsRelative?1:1-je;ke.getUniforms().setValue(M,"morphTargetBaseInfluence",Rt),ke.getUniforms().setValue(M,"morphTargetInfluences",p)}}}}function us(M,a,c,d){let p=new WeakMap;function F(ue){const Q=ue.target;Q.removeEventListener("dispose",F),c.remove(Q.instanceMatrix),null!==Q.instanceColor&&c.remove(Q.instanceColor)}return{update:function S(ue){const Q=d.render.frame,ke=a.get(ue,ue.geometry);if(p.get(ke)!==Q&&(a.update(ke),p.set(ke,Q)),ue.isInstancedMesh&&(!1===ue.hasEventListener("dispose",F)&&ue.addEventListener("dispose",F),p.get(ue)!==Q&&(c.update(ue.instanceMatrix,M.ARRAY_BUFFER),null!==ue.instanceColor&&c.update(ue.instanceColor,M.ARRAY_BUFFER),p.set(ue,Q))),ue.isSkinnedMesh){const Oe=ue.skeleton;p.get(Oe)!==Q&&(Oe.update(),p.set(Oe,Q))}return ke},dispose:function U(){p=new WeakMap}}}class Pr extends _u{constructor(a=null,c=1,d=1,p=1){super(null),this.isData3DTexture=!0,this.image={data:a,width:c,height:d,depth:p},this.magFilter=qi,this.minFilter=qi,this.wrapR=ui,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Cr extends _u{constructor(a,c,d,p,S,U,F,ue,Q,Me){if((Me=void 0!==Me?Me:Ue)!==Ue&&Me!==Y)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===d&&Me===Ue&&(d=Zt),void 0===d&&Me===Y&&(d=$n),super(null,p,S,U,F,ue,Me,d,Q),this.isDepthTexture=!0,this.image={width:a,height:c},this.magFilter=void 0!==F?F:qi,this.minFilter=void 0!==ue?ue:qi,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(a){return super.copy(a),this.compareFunction=a.compareFunction,this}toJSON(a){const c=super.toJSON(a);return null!==this.compareFunction&&(c.compareFunction=this.compareFunction),c}}const Co=new _u,kr=new Cr(1,1);kr.compareFunction=515;const Fr=new Vn,Ua=new Pr,vo=new qa,Mo=[],as=[],ga=new Float32Array(16),aa=new Float32Array(9),Ks=new Float32Array(4);function El(M,a,c){const d=M[0];if(d<=0||d>0)return M;const p=a*c;let S=Mo[p];if(void 0===S&&(S=new Float32Array(p),Mo[p]=S),0!==a){d.toArray(S,0);for(let U=1,F=0;U!==a;++U)F+=c,M[U].toArray(S,F)}return S}function Ea(M,a){if(M.length!==a.length)return!1;for(let c=0,d=M.length;c<d;c++)if(M[c]!==a[c])return!1;return!0}function Ra(M,a){for(let c=0,d=a.length;c<d;c++)M[c]=a[c]}function ka(M,a){let c=as[a];void 0===c&&(c=new Int32Array(a),as[a]=c);for(let d=0;d!==a;++d)c[d]=M.allocateTextureUnit();return c}function Fc(M,a){const c=this.cache;c[0]!==a&&(M.uniform1f(this.addr,a),c[0]=a)}function Tf(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y)&&(M.uniform2f(this.addr,a.x,a.y),c[0]=a.x,c[1]=a.y);else{if(Ea(c,a))return;M.uniform2fv(this.addr,a),Ra(c,a)}}function kh(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y||c[2]!==a.z)&&(M.uniform3f(this.addr,a.x,a.y,a.z),c[0]=a.x,c[1]=a.y,c[2]=a.z);else if(void 0!==a.r)(c[0]!==a.r||c[1]!==a.g||c[2]!==a.b)&&(M.uniform3f(this.addr,a.r,a.g,a.b),c[0]=a.r,c[1]=a.g,c[2]=a.b);else{if(Ea(c,a))return;M.uniform3fv(this.addr,a),Ra(c,a)}}function Jh(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y||c[2]!==a.z||c[3]!==a.w)&&(M.uniform4f(this.addr,a.x,a.y,a.z,a.w),c[0]=a.x,c[1]=a.y,c[2]=a.z,c[3]=a.w);else{if(Ea(c,a))return;M.uniform4fv(this.addr,a),Ra(c,a)}}function Zu(M,a){const c=this.cache,d=a.elements;if(void 0===d){if(Ea(c,a))return;M.uniformMatrix2fv(this.addr,!1,a),Ra(c,a)}else{if(Ea(c,d))return;Ks.set(d),M.uniformMatrix2fv(this.addr,!1,Ks),Ra(c,d)}}function eu(M,a){const c=this.cache,d=a.elements;if(void 0===d){if(Ea(c,a))return;M.uniformMatrix3fv(this.addr,!1,a),Ra(c,a)}else{if(Ea(c,d))return;aa.set(d),M.uniformMatrix3fv(this.addr,!1,aa),Ra(c,d)}}function Ap(M,a){const c=this.cache,d=a.elements;if(void 0===d){if(Ea(c,a))return;M.uniformMatrix4fv(this.addr,!1,a),Ra(c,a)}else{if(Ea(c,d))return;ga.set(d),M.uniformMatrix4fv(this.addr,!1,ga),Ra(c,d)}}function Df(M,a){const c=this.cache;c[0]!==a&&(M.uniform1i(this.addr,a),c[0]=a)}function gp(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y)&&(M.uniform2i(this.addr,a.x,a.y),c[0]=a.x,c[1]=a.y);else{if(Ea(c,a))return;M.uniform2iv(this.addr,a),Ra(c,a)}}function If(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y||c[2]!==a.z)&&(M.uniform3i(this.addr,a.x,a.y,a.z),c[0]=a.x,c[1]=a.y,c[2]=a.z);else{if(Ea(c,a))return;M.uniform3iv(this.addr,a),Ra(c,a)}}function om(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y||c[2]!==a.z||c[3]!==a.w)&&(M.uniform4i(this.addr,a.x,a.y,a.z,a.w),c[0]=a.x,c[1]=a.y,c[2]=a.z,c[3]=a.w);else{if(Ea(c,a))return;M.uniform4iv(this.addr,a),Ra(c,a)}}function _p(M,a){const c=this.cache;c[0]!==a&&(M.uniform1ui(this.addr,a),c[0]=a)}function rg(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y)&&(M.uniform2ui(this.addr,a.x,a.y),c[0]=a.x,c[1]=a.y);else{if(Ea(c,a))return;M.uniform2uiv(this.addr,a),Ra(c,a)}}function am(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y||c[2]!==a.z)&&(M.uniform3ui(this.addr,a.x,a.y,a.z),c[0]=a.x,c[1]=a.y,c[2]=a.z);else{if(Ea(c,a))return;M.uniform3uiv(this.addr,a),Ra(c,a)}}function sg(M,a){const c=this.cache;if(void 0!==a.x)(c[0]!==a.x||c[1]!==a.y||c[2]!==a.z||c[3]!==a.w)&&(M.uniform4ui(this.addr,a.x,a.y,a.z,a.w),c[0]=a.x,c[1]=a.y,c[2]=a.z,c[3]=a.w);else{if(Ea(c,a))return;M.uniform4uiv(this.addr,a),Ra(c,a)}}function Yy(M,a,c){const d=this.cache,p=c.allocateTextureUnit();d[0]!==p&&(M.uniform1i(this.addr,p),d[0]=p),c.setTexture2D(a||(this.type===M.SAMPLER_2D_SHADOW?kr:Co),p)}function v_(M,a,c){const d=this.cache,p=c.allocateTextureUnit();d[0]!==p&&(M.uniform1i(this.addr,p),d[0]=p),c.setTexture3D(a||Ua,p)}function TM(M,a,c){const d=this.cache,p=c.allocateTextureUnit();d[0]!==p&&(M.uniform1i(this.addr,p),d[0]=p),c.setTextureCube(a||vo,p)}function b_(M,a,c){const d=this.cache,p=c.allocateTextureUnit();d[0]!==p&&(M.uniform1i(this.addr,p),d[0]=p),c.setTexture2DArray(a||Fr,p)}function Nv(M,a){M.uniform1fv(this.addr,a)}function Ky(M,a){const c=El(a,this.size,2);M.uniform2fv(this.addr,c)}function JT(M,a){const c=El(a,this.size,3);M.uniform3fv(this.addr,c)}function ew(M,a){const c=El(a,this.size,4);M.uniform4fv(this.addr,c)}function tw(M,a){const c=El(a,this.size,4);M.uniformMatrix2fv(this.addr,!1,c)}function IM(M,a){const c=El(a,this.size,9);M.uniformMatrix3fv(this.addr,!1,c)}function yp(M,a){const c=El(a,this.size,16);M.uniformMatrix4fv(this.addr,!1,c)}function BM(M,a){M.uniform1iv(this.addr,a)}function Zy(M,a){M.uniform2iv(this.addr,a)}function Uv(M,a){M.uniform3iv(this.addr,a)}function nw(M,a){M.uniform4iv(this.addr,a)}function Jy(M,a){M.uniform1uiv(this.addr,a)}function Gd(M,a){M.uniform2uiv(this.addr,a)}function PM(M,a){M.uniform3uiv(this.addr,a)}function zv(M,a){M.uniform4uiv(this.addr,a)}function vp(M,a,c){const d=this.cache,p=a.length,S=ka(c,p);Ea(d,S)||(M.uniform1iv(this.addr,S),Ra(d,S));for(let U=0;U!==p;++U)c.setTexture2D(a[U]||Co,S[U])}function iw(M,a,c){const d=this.cache,p=a.length,S=ka(c,p);Ea(d,S)||(M.uniform1iv(this.addr,S),Ra(d,S));for(let U=0;U!==p;++U)c.setTexture3D(a[U]||Ua,S[U])}function rw(M,a,c){const d=this.cache,p=a.length,S=ka(c,p);Ea(d,S)||(M.uniform1iv(this.addr,S),Ra(d,S));for(let U=0;U!==p;++U)c.setTextureCube(a[U]||vo,S[U])}function RM(M,a,c){const d=this.cache,p=a.length,S=ka(c,p);Ea(d,S)||(M.uniform1iv(this.addr,S),Ra(d,S));for(let U=0;U!==p;++U)c.setTexture2DArray(a[U]||Fr,S[U])}class og{constructor(a,c,d){this.id=a,this.addr=d,this.cache=[],this.type=c.type,this.setValue=function DM(M){switch(M){case 5126:return Fc;case 35664:return Tf;case 35665:return kh;case 35666:return Jh;case 35674:return Zu;case 35675:return eu;case 35676:return Ap;case 5124:case 35670:return Df;case 35667:case 35671:return gp;case 35668:case 35672:return If;case 35669:case 35673:return om;case 5125:return _p;case 36294:return rg;case 36295:return am;case 36296:return sg;case 35678:case 36198:case 36298:case 36306:case 35682:return Yy;case 35679:case 36299:case 36307:return v_;case 35680:case 36300:case 36308:case 36293:return TM;case 36289:case 36303:case 36311:case 36292:return b_}}(c.type)}}class e3{constructor(a,c,d){this.id=a,this.addr=d,this.cache=[],this.type=c.type,this.size=c.size,this.setValue=function e1(M){switch(M){case 5126:return Nv;case 35664:return Ky;case 35665:return JT;case 35666:return ew;case 35674:return tw;case 35675:return IM;case 35676:return yp;case 5124:case 35670:return BM;case 35667:case 35671:return Zy;case 35668:case 35672:return Uv;case 35669:case 35673:return nw;case 5125:return Jy;case 36294:return Gd;case 36295:return PM;case 36296:return zv;case 35678:case 36198:case 36298:case 36306:case 35682:return vp;case 35679:case 36299:case 36307:return iw;case 35680:case 36300:case 36308:case 36293:return rw;case 36289:case 36303:case 36311:case 36292:return RM}}(c.type)}}class _{constructor(a){this.id=a,this.seq=[],this.map={}}setValue(a,c,d){const p=this.seq;for(let S=0,U=p.length;S!==U;++S){const F=p[S];F.setValue(a,c[F.id],d)}}}const q=/(\w+)(\])?(\[|\.)?/g;function ye(M,a){M.seq.push(a),M.map[a.id]=a}function we(M,a,c){const d=M.name,p=d.length;for(q.lastIndex=0;;){const S=q.exec(d);let F=S[1];const Q=S[3];if("]"===S[2]&&(F|=0),void 0===Q||"["===Q&&q.lastIndex+2===p){ye(c,void 0===Q?new og(F,M,a):new e3(F,M,a));break}{let ke=c.map[F];void 0===ke&&(ke=new _(F),ye(c,ke)),c=ke}}}class Ze{constructor(a,c){this.seq=[],this.map={};const d=a.getProgramParameter(c,a.ACTIVE_UNIFORMS);for(let p=0;p<d;++p){const S=a.getActiveUniform(c,p);we(S,a.getUniformLocation(c,S.name),this)}}setValue(a,c,d,p){const S=this.map[c];void 0!==S&&S.setValue(a,d,p)}setOptional(a,c,d){const p=c[d];void 0!==p&&this.setValue(a,d,p)}static upload(a,c,d,p){for(let S=0,U=c.length;S!==U;++S){const F=c[S],ue=d[F.id];!1!==ue.needsUpdate&&F.setValue(a,ue.value,p)}}static seqWithValue(a,c){const d=[];for(let p=0,S=a.length;p!==S;++p){const U=a[p];U.id in c&&d.push(U)}return d}}function mt(M,a,c){const d=M.createShader(a);return M.shaderSource(d,c),M.compileShader(d),d}const yt=37297;let It=0;function an(M,a,c){const d=M.getShaderParameter(a,M.COMPILE_STATUS),p=M.getShaderInfoLog(a).trim();if(d&&""===p)return"";const S=/ERROR: 0:(\d+)/.exec(p);if(S){const U=parseInt(S[1]);return c.toUpperCase()+"\n\n"+p+"\n\n"+function $t(M,a){const c=M.split("\n"),d=[],p=Math.max(a-6,0),S=Math.min(a+6,c.length);for(let U=p;U<S;U++){const F=U+1;d.push(`${F===a?">":" "} ${F}: ${c[U]}`)}return d.join("\n")}(M.getShaderSource(a),U)}return p}function Qn(M,a){const c=function Xt(M){const a=Ia.getPrimaries(Ia.workingColorSpace),c=Ia.getPrimaries(M);let d;switch(a===c?d="":a===nf&&c===No?d="LinearDisplayP3ToLinearSRGB":a===No&&c===nf&&(d="LinearSRGBToLinearDisplayP3"),M){case fh:case ph:return[d,"LinearTransferOETF"];case Xa:case qu:return[d,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",M),[d,"LinearTransferOETF"]}}(a);return`vec4 ${M}( vec4 value ) { return ${c[0]}( ${c[1]}( value ) ); }`}function Gn(M,a){let c;switch(a){case dt:c="Linear";break;case rt:c="Reinhard";break;case _t:c="OptimizedCineon";break;case Yt:c="ACESFilmic";break;case Tt:c="AgX";break;case fn:c="Neutral";break;case kt:c="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",a),c="Linear"}return"vec3 "+M+"( vec3 color ) { return "+c+"ToneMapping( color ); }"}function ls(M){return""!==M}function Io(M,a){const c=a.numSpotLightShadows+a.numSpotLightMaps-a.numSpotLightShadowsWithMaps;return M.replace(/NUM_DIR_LIGHTS/g,a.numDirLights).replace(/NUM_SPOT_LIGHTS/g,a.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,a.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,c).replace(/NUM_RECT_AREA_LIGHTS/g,a.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,a.numPointLights).replace(/NUM_HEMI_LIGHTS/g,a.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,a.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,a.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,a.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,a.numPointLightShadows)}function xr(M,a){return M.replace(/NUM_CLIPPING_PLANES/g,a.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,a.numClippingPlanes-a.numClipIntersection)}const Ui=/^[ \t]*#include +<([\w\d./]+)>/gm;function zs(M){return M.replace(Ui,Uo)}const ss=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Uo(M,a){let c=Br[a];if(void 0===c){const d=ss.get(a);if(void 0===d)throw new Error("Can not resolve #include <"+a+">");c=Br[d],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',a,d)}return zs(c)}const xl=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function fc(M){return M.replace(xl,pc)}function pc(M,a,c,d){let p="";for(let S=parseInt(a);S<parseInt(c);S++)p+=d.replace(/\[\s*i\s*\]/g,"[ "+S+" ]").replace(/UNROLLED_LOOP_INDEX/g,S);return p}function Dr(M){let a=`precision ${M.precision} float;\n\tprecision ${M.precision} int;\n\tprecision ${M.precision} sampler2D;\n\tprecision ${M.precision} samplerCube;\n\t`;return M.isWebGL2&&(a+=`precision ${M.precision} sampler3D;\n\t\tprecision ${M.precision} sampler2DArray;\n\t\tprecision ${M.precision} sampler2DShadow;\n\t\tprecision ${M.precision} samplerCubeShadow;\n\t\tprecision ${M.precision} sampler2DArrayShadow;\n\t\tprecision ${M.precision} isampler2D;\n\t\tprecision ${M.precision} isampler3D;\n\t\tprecision ${M.precision} isamplerCube;\n\t\tprecision ${M.precision} isampler2DArray;\n\t\tprecision ${M.precision} usampler2D;\n\t\tprecision ${M.precision} usampler3D;\n\t\tprecision ${M.precision} usamplerCube;\n\t\tprecision ${M.precision} usampler2DArray;\n\t\t`),"highp"===M.precision?a+="\n#define HIGH_PRECISION":"mediump"===M.precision?a+="\n#define MEDIUM_PRECISION":"lowp"===M.precision&&(a+="\n#define LOW_PRECISION"),a}function Ah(M,a,c,d){const p=M.getContext(),S=c.defines;let U=c.vertexShader,F=c.fragmentShader;const ue=function ic(M){let a="SHADOWMAP_TYPE_BASIC";return M.shadowMapType===Re?a="SHADOWMAP_TYPE_PCF":M.shadowMapType===Qe?a="SHADOWMAP_TYPE_PCF_SOFT":M.shadowMapType===Ie&&(a="SHADOWMAP_TYPE_VSM"),a}(c),Q=function Ws(M){let a="ENVMAP_TYPE_CUBE";if(M.envMap)switch(M.envMapMode){case Sn:case cn:a="ENVMAP_TYPE_CUBE";break;case Ln:a="ENVMAP_TYPE_CUBE_UV"}return a}(c),Me=function ea(M){let a="ENVMAP_MODE_REFLECTION";return M.envMap&&M.envMapMode===cn&&(a="ENVMAP_MODE_REFRACTION"),a}(c),ke=function Su(M){let a="ENVMAP_BLENDING_NONE";if(M.envMap)switch(M.combine){case Ne:a="ENVMAP_BLENDING_MULTIPLY";break;case Fe:a="ENVMAP_BLENDING_MIX";break;case ht:a="ENVMAP_BLENDING_ADD"}return a}(c),Oe=function Ju(M){const a=M.envMapCubeUVHeight;if(null===a)return null;const c=Math.log2(a)-2,d=1/a;return{texelWidth:1/(3*Math.max(Math.pow(2,c),112)),texelHeight:d,maxMip:c}}(c),Ge=c.isWebGL2?"":function yi(M){return[M.extensionDerivatives||M.envMapCubeUVHeight||M.bumpMap||M.normalMapTangentSpace||M.clearcoatNormalMap||M.flatShading||M.alphaToCoverage||"physical"===M.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(M.extensionFragDepth||M.logarithmicDepthBuffer)&&M.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",M.extensionDrawBuffers&&M.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(M.extensionShaderTextureLOD||M.envMap||M.transmission)&&M.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ls).join("\n")}(c),et=function gr(M){return[M.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",M.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(ls).join("\n")}(c),vt=function Ji(M){const a=[];for(const c in M){const d=M[c];!1!==d&&a.push("#define "+c+" "+d)}return a.join("\n")}(S),Ye=p.createProgram();let je,Rt,At=c.glslVersion?"#version "+c.glslVersion+"\n":"";c.isRawShaderMaterial?(je=["#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,vt].filter(ls).join("\n"),je.length>0&&(je+="\n"),Rt=[Ge,"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,vt].filter(ls).join("\n"),Rt.length>0&&(Rt+="\n")):(je=[Dr(c),"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,vt,c.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",c.batching?"#define USE_BATCHING":"",c.instancing?"#define USE_INSTANCING":"",c.instancingColor?"#define USE_INSTANCING_COLOR":"",c.instancingMorph?"#define USE_INSTANCING_MORPH":"",c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+Me:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",c.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",c.displacementMap?"#define USE_DISPLACEMENTMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.anisotropy?"#define USE_ANISOTROPY":"",c.anisotropyMap?"#define USE_ANISOTROPYMAP":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",c.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",c.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaHash?"#define USE_ALPHAHASH":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",c.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",c.mapUv?"#define MAP_UV "+c.mapUv:"",c.alphaMapUv?"#define ALPHAMAP_UV "+c.alphaMapUv:"",c.lightMapUv?"#define LIGHTMAP_UV "+c.lightMapUv:"",c.aoMapUv?"#define AOMAP_UV "+c.aoMapUv:"",c.emissiveMapUv?"#define EMISSIVEMAP_UV "+c.emissiveMapUv:"",c.bumpMapUv?"#define BUMPMAP_UV "+c.bumpMapUv:"",c.normalMapUv?"#define NORMALMAP_UV "+c.normalMapUv:"",c.displacementMapUv?"#define DISPLACEMENTMAP_UV "+c.displacementMapUv:"",c.metalnessMapUv?"#define METALNESSMAP_UV "+c.metalnessMapUv:"",c.roughnessMapUv?"#define ROUGHNESSMAP_UV "+c.roughnessMapUv:"",c.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+c.anisotropyMapUv:"",c.clearcoatMapUv?"#define CLEARCOATMAP_UV "+c.clearcoatMapUv:"",c.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+c.clearcoatNormalMapUv:"",c.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+c.clearcoatRoughnessMapUv:"",c.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+c.iridescenceMapUv:"",c.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+c.iridescenceThicknessMapUv:"",c.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+c.sheenColorMapUv:"",c.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+c.sheenRoughnessMapUv:"",c.specularMapUv?"#define SPECULARMAP_UV "+c.specularMapUv:"",c.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+c.specularColorMapUv:"",c.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+c.specularIntensityMapUv:"",c.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+c.transmissionMapUv:"",c.thicknessMapUv?"#define THICKNESSMAP_UV "+c.thicknessMapUv:"",c.vertexTangents&&!1===c.flatShading?"#define USE_TANGENT":"",c.vertexColors?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUv1s?"#define USE_UV1":"",c.vertexUv2s?"#define USE_UV2":"",c.vertexUv3s?"#define USE_UV3":"",c.pointsUvs?"#define USE_POINTS_UV":"",c.flatShading?"#define FLAT_SHADED":"",c.skinning?"#define USE_SKINNING":"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals&&!1===c.flatShading?"#define USE_MORPHNORMALS":"",c.morphColors&&c.isWebGL2?"#define USE_MORPHCOLORS":"",c.morphTargetsCount>0&&c.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",c.morphTargetsCount>0&&c.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+c.morphTextureStride:"",c.morphTargetsCount>0&&c.isWebGL2?"#define MORPHTARGETS_COUNT "+c.morphTargetsCount:"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+ue:"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"",c.numLightProbes>0?"#define USE_LIGHT_PROBES":"",c.useLegacyLights?"#define LEGACY_LIGHTS":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ls).join("\n"),Rt=[Ge,Dr(c),"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,vt,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",c.map?"#define USE_MAP":"",c.matcap?"#define USE_MATCAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+Q:"",c.envMap?"#define "+Me:"",c.envMap?"#define "+ke:"",Oe?"#define CUBEUV_TEXEL_WIDTH "+Oe.texelWidth:"",Oe?"#define CUBEUV_TEXEL_HEIGHT "+Oe.texelHeight:"",Oe?"#define CUBEUV_MAX_MIP "+Oe.maxMip+".0":"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",c.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.anisotropy?"#define USE_ANISOTROPY":"",c.anisotropyMap?"#define USE_ANISOTROPYMAP":"",c.clearcoat?"#define USE_CLEARCOAT":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.iridescence?"#define USE_IRIDESCENCE":"",c.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",c.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",c.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaTest?"#define USE_ALPHATEST":"",c.alphaHash?"#define USE_ALPHAHASH":"",c.sheen?"#define USE_SHEEN":"",c.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",c.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.vertexTangents&&!1===c.flatShading?"#define USE_TANGENT":"",c.vertexColors||c.instancingColor?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUv1s?"#define USE_UV1":"",c.vertexUv2s?"#define USE_UV2":"",c.vertexUv3s?"#define USE_UV3":"",c.pointsUvs?"#define USE_POINTS_UV":"",c.gradientMap?"#define USE_GRADIENTMAP":"",c.flatShading?"#define FLAT_SHADED":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+ue:"",c.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",c.numLightProbes>0?"#define USE_LIGHT_PROBES":"",c.useLegacyLights?"#define LEGACY_LIGHTS":"",c.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",c.toneMapping!==pt?"#define TONE_MAPPING":"",c.toneMapping!==pt?Br.tonemapping_pars_fragment:"",c.toneMapping!==pt?Gn("toneMapping",c.toneMapping):"",c.dithering?"#define DITHERING":"",c.opaque?"#define OPAQUE":"",Br.colorspace_pars_fragment,Qn("linearToOutputTexel",c.outputColorSpace),c.useDepthPacking?"#define DEPTH_PACKING "+c.depthPacking:"","\n"].filter(ls).join("\n")),U=zs(U),U=Io(U,c),U=xr(U,c),F=zs(F),F=Io(F,c),F=xr(F,c),U=fc(U),F=fc(F),c.isWebGL2&&!0!==c.isRawShaderMaterial&&(At="#version 300 es\n",je=[et,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+je,Rt=["precision mediump sampler2DArray;","#define varying in",c.glslVersion===W0?"":"layout(location = 0) out highp vec4 pc_fragColor;",c.glslVersion===W0?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+Rt);const Pn=At+Rt+F,yn=mt(p,p.VERTEX_SHADER,At+je+U),xn=mt(p,p.FRAGMENT_SHADER,Pn);function qn(rr){if(M.debug.checkShaderErrors){const lr=p.getProgramInfoLog(Ye).trim(),Yn=p.getShaderInfoLog(yn).trim(),Qi=p.getShaderInfoLog(xn).trim();let Oi=!0,er=!0;if(!1===p.getProgramParameter(Ye,p.LINK_STATUS))if(Oi=!1,"function"==typeof M.debug.onShaderError)M.debug.onShaderError(p,Ye,yn,xn);else{const Xi=an(p,yn,"vertex"),Vi=an(p,xn,"fragment");console.error("THREE.WebGLProgram: Shader Error "+p.getError()+" - VALIDATE_STATUS "+p.getProgramParameter(Ye,p.VALIDATE_STATUS)+"\n\nMaterial Name: "+rr.name+"\nMaterial Type: "+rr.type+"\n\nProgram Info Log: "+lr+"\n"+Xi+"\n"+Vi)}else""!==lr?console.warn("THREE.WebGLProgram: Program Info Log:",lr):(""===Yn||""===Qi)&&(er=!1);er&&(rr.diagnostics={runnable:Oi,programLog:lr,vertexShader:{log:Yn,prefix:je},fragmentShader:{log:Qi,prefix:Rt}})}p.deleteShader(yn),p.deleteShader(xn),wi=new Ze(p,Ye),Ut=function ar(M,a){const c={},d=M.getProgramParameter(a,M.ACTIVE_ATTRIBUTES);for(let p=0;p<d;p++){const S=M.getActiveAttrib(a,p),U=S.name;let F=1;S.type===M.FLOAT_MAT2&&(F=2),S.type===M.FLOAT_MAT3&&(F=3),S.type===M.FLOAT_MAT4&&(F=4),c[U]={type:S.type,location:M.getAttribLocation(a,U),locationSize:F}}return c}(p,Ye)}let wi,Ut;p.attachShader(Ye,yn),p.attachShader(Ye,xn),void 0!==c.index0AttributeName?p.bindAttribLocation(Ye,0,c.index0AttributeName):!0===c.morphTargets&&p.bindAttribLocation(Ye,0,"position"),p.linkProgram(Ye),this.getUniforms=function(){return void 0===wi&&qn(this),wi},this.getAttributes=function(){return void 0===Ut&&qn(this),Ut};let En=!1===c.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===En&&(En=p.getProgramParameter(Ye,yt)),En},this.destroy=function(){d.releaseStatesOfProgram(this),p.deleteProgram(Ye),this.program=void 0},this.type=c.shaderType,this.name=c.shaderName,this.id=It++,this.cacheKey=a,this.usedTimes=1,this.program=Ye,this.vertexShader=yn,this.fragmentShader=xn,this}let tu=0;class mc{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(a){const d=a.fragmentShader,p=this._getShaderStage(a.vertexShader),S=this._getShaderStage(d),U=this._getShaderCacheForMaterial(a);return!1===U.has(p)&&(U.add(p),p.usedTimes++),!1===U.has(S)&&(U.add(S),S.usedTimes++),this}remove(a){const c=this.materialCache.get(a);for(const d of c)d.usedTimes--,0===d.usedTimes&&this.shaderCache.delete(d.code);return this.materialCache.delete(a),this}getVertexShaderID(a){return this._getShaderStage(a.vertexShader).id}getFragmentShaderID(a){return this._getShaderStage(a.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(a){const c=this.materialCache;let d=c.get(a);return void 0===d&&(d=new Set,c.set(a,d)),d}_getShaderStage(a){const c=this.shaderCache;let d=c.get(a);return void 0===d&&(d=new bp(a),c.set(a,d)),d}}class bp{constructor(a){this.id=tu++,this.code=a,this.usedTimes=0}}function f0(M,a,c,d,p,S,U){const F=new OA,ue=new mc,Q=new Set,Me=[],ke=p.isWebGL2,Oe=p.logarithmicDepthBuffer,Ge=p.vertexTextures;let et=p.precision;const vt={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function Ye(Ut){return Q.add(Ut),0===Ut?"uv":`uv${Ut}`}return{getParameters:function je(Ut,En,rr,lr,Yn){const Qi=lr.fog,Oi=Yn.geometry,Xi=(Ut.isMeshStandardMaterial?c:a).get(Ut.envMap||(Ut.isMeshStandardMaterial?lr.environment:null)),Vi=Xi&&Xi.mapping===Ln?Xi.image.height:null,Vr=vt[Ut.type];null!==Ut.precision&&(et=p.getMaxPrecision(Ut.precision),et!==Ut.precision&&console.warn("THREE.WebGLProgram.getParameters:",Ut.precision,"not supported, using",et,"instead."));const Hr=Oi.morphAttributes.position||Oi.morphAttributes.normal||Oi.morphAttributes.color,Ns=void 0!==Hr?Hr.length:0;let Hi,Or,Ds,bo,Yo=0;if(void 0!==Oi.morphAttributes.position&&(Yo=1),void 0!==Oi.morphAttributes.normal&&(Yo=2),void 0!==Oi.morphAttributes.color&&(Yo=3),Vr){const sc=Mu[Vr];Hi=sc.vertexShader,Or=sc.fragmentShader}else Hi=Ut.vertexShader,Or=Ut.fragmentShader,ue.update(Ut),Ds=ue.getVertexShaderID(Ut),bo=ue.getFragmentShaderID(Ut);const eo=M.getRenderTarget(),Qs=!0===Yn.isInstancedMesh,Ao=!!Ut.map,Zr=!!Xi,Zi=!!Ut.aoMap,$r=!!Ut.lightMap,fr=!!Ut.bumpMap,As=!!Ut.normalMap,Ms=!!Ut.displacementMap,Zs=!!Ut.emissiveMap,za=!!Ut.metalnessMap,wn=!!Ut.roughnessMap,Gt=Ut.anisotropy>0,zi=Ut.clearcoat>0,ji=Ut.iridescence>0,Lr=Ut.sheen>0,br=Ut.transmission>0,ta=Gt&&!!Ut.anisotropyMap,ko=zi&&!!Ut.clearcoatMap,Xr=zi&&!!Ut.clearcoatNormalMap,cs=zi&&!!Ut.clearcoatRoughnessMap,Eo=ji&&!!Ut.iridescenceMap,Yr=ji&&!!Ut.iridescenceThicknessMap,_h=Lr&&!!Ut.sheenColorMap,Sa=Lr&&!!Ut.sheenRoughnessMap,So=!!Ut.specularMap,$s=!!Ut.specularColorMap,po=!!Ut.specularIntensityMap,ya=br&&!!Ut.transmissionMap,Qo=br&&!!Ut.thicknessMap,Jn=!!Ut.alphaMap,ts=!!Ut.extensions;let Es=pt;Ut.toneMapped&&(null===eo||!0===eo.isXRRenderTarget)&&(Es=M.toneMapping);const Qa={isWebGL2:ke,shaderID:Vr,shaderType:Ut.type,shaderName:Ut.name,vertexShader:Hi,fragmentShader:Or,defines:Ut.defines,customVertexShaderID:Ds,customFragmentShaderID:bo,isRawShaderMaterial:!0===Ut.isRawShaderMaterial,glslVersion:Ut.glslVersion,precision:et,batching:!0===Yn.isBatchedMesh,instancing:Qs,instancingColor:Qs&&null!==Yn.instanceColor,instancingMorph:Qs&&null!==Yn.morphTexture,supportsVertexTextures:Ge,outputColorSpace:null===eo?M.outputColorSpace:!0===eo.isXRRenderTarget?eo.texture.colorSpace:fh,alphaToCoverage:!!Ut.alphaToCoverage,map:Ao,matcap:!!Ut.matcap,envMap:Zr,envMapMode:Zr&&Xi.mapping,envMapCubeUVHeight:Vi,aoMap:Zi,lightMap:$r,bumpMap:fr,normalMap:As,displacementMap:Ge&&Ms,emissiveMap:Zs,normalMapObjectSpace:As&&1===Ut.normalMapType,normalMapTangentSpace:As&&0===Ut.normalMapType,metalnessMap:za,roughnessMap:wn,anisotropy:Gt,anisotropyMap:ta,clearcoat:zi,clearcoatMap:ko,clearcoatNormalMap:Xr,clearcoatRoughnessMap:cs,iridescence:ji,iridescenceMap:Eo,iridescenceThicknessMap:Yr,sheen:Lr,sheenColorMap:_h,sheenRoughnessMap:Sa,specularMap:So,specularColorMap:$s,specularIntensityMap:po,transmission:br,transmissionMap:ya,thicknessMap:Qo,gradientMap:!!Ut.gradientMap,opaque:!1===Ut.transparent&&1===Ut.blending&&!1===Ut.alphaToCoverage,alphaMap:Jn,alphaTest:Ut.alphaTest>0,alphaHash:!!Ut.alphaHash,combine:Ut.combine,mapUv:Ao&&Ye(Ut.map.channel),aoMapUv:Zi&&Ye(Ut.aoMap.channel),lightMapUv:$r&&Ye(Ut.lightMap.channel),bumpMapUv:fr&&Ye(Ut.bumpMap.channel),normalMapUv:As&&Ye(Ut.normalMap.channel),displacementMapUv:Ms&&Ye(Ut.displacementMap.channel),emissiveMapUv:Zs&&Ye(Ut.emissiveMap.channel),metalnessMapUv:za&&Ye(Ut.metalnessMap.channel),roughnessMapUv:wn&&Ye(Ut.roughnessMap.channel),anisotropyMapUv:ta&&Ye(Ut.anisotropyMap.channel),clearcoatMapUv:ko&&Ye(Ut.clearcoatMap.channel),clearcoatNormalMapUv:Xr&&Ye(Ut.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:cs&&Ye(Ut.clearcoatRoughnessMap.channel),iridescenceMapUv:Eo&&Ye(Ut.iridescenceMap.channel),iridescenceThicknessMapUv:Yr&&Ye(Ut.iridescenceThicknessMap.channel),sheenColorMapUv:_h&&Ye(Ut.sheenColorMap.channel),sheenRoughnessMapUv:Sa&&Ye(Ut.sheenRoughnessMap.channel),specularMapUv:So&&Ye(Ut.specularMap.channel),specularColorMapUv:$s&&Ye(Ut.specularColorMap.channel),specularIntensityMapUv:po&&Ye(Ut.specularIntensityMap.channel),transmissionMapUv:ya&&Ye(Ut.transmissionMap.channel),thicknessMapUv:Qo&&Ye(Ut.thicknessMap.channel),alphaMapUv:Jn&&Ye(Ut.alphaMap.channel),vertexTangents:!!Oi.attributes.tangent&&(As||Gt),vertexColors:Ut.vertexColors,vertexAlphas:!0===Ut.vertexColors&&!!Oi.attributes.color&&4===Oi.attributes.color.itemSize,pointsUvs:!0===Yn.isPoints&&!!Oi.attributes.uv&&(Ao||Jn),fog:!!Qi,useFog:!0===Ut.fog,fogExp2:!!Qi&&Qi.isFogExp2,flatShading:!0===Ut.flatShading,sizeAttenuation:!0===Ut.sizeAttenuation,logarithmicDepthBuffer:Oe,skinning:!0===Yn.isSkinnedMesh,morphTargets:void 0!==Oi.morphAttributes.position,morphNormals:void 0!==Oi.morphAttributes.normal,morphColors:void 0!==Oi.morphAttributes.color,morphTargetsCount:Ns,morphTextureStride:Yo,numDirLights:En.directional.length,numPointLights:En.point.length,numSpotLights:En.spot.length,numSpotLightMaps:En.spotLightMap.length,numRectAreaLights:En.rectArea.length,numHemiLights:En.hemi.length,numDirLightShadows:En.directionalShadowMap.length,numPointLightShadows:En.pointShadowMap.length,numSpotLightShadows:En.spotShadowMap.length,numSpotLightShadowsWithMaps:En.numSpotLightShadowsWithMaps,numLightProbes:En.numLightProbes,numClippingPlanes:U.numPlanes,numClipIntersection:U.numIntersection,dithering:Ut.dithering,shadowMapEnabled:M.shadowMap.enabled&&rr.length>0,shadowMapType:M.shadowMap.type,toneMapping:Es,useLegacyLights:M._useLegacyLights,decodeVideoTexture:Ao&&!0===Ut.map.isVideoTexture&&Ia.getTransfer(Ut.map.colorSpace)===Ga,premultipliedAlpha:Ut.premultipliedAlpha,doubleSided:Ut.side===re,flipSided:1===Ut.side,useDepthPacking:Ut.depthPacking>=0,depthPacking:Ut.depthPacking||0,index0AttributeName:Ut.index0AttributeName,extensionDerivatives:ts&&!0===Ut.extensions.derivatives,extensionFragDepth:ts&&!0===Ut.extensions.fragDepth,extensionDrawBuffers:ts&&!0===Ut.extensions.drawBuffers,extensionShaderTextureLOD:ts&&!0===Ut.extensions.shaderTextureLOD,extensionClipCullDistance:ts&&!0===Ut.extensions.clipCullDistance&&d.has("WEBGL_clip_cull_distance"),extensionMultiDraw:ts&&!0===Ut.extensions.multiDraw&&d.has("WEBGL_multi_draw"),rendererExtensionFragDepth:ke||d.has("EXT_frag_depth"),rendererExtensionDrawBuffers:ke||d.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:ke||d.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:d.has("KHR_parallel_shader_compile"),customProgramCacheKey:Ut.customProgramCacheKey()};return Qa.vertexUv1s=Q.has(1),Qa.vertexUv2s=Q.has(2),Qa.vertexUv3s=Q.has(3),Q.clear(),Qa},getProgramCacheKey:function Rt(Ut){const En=[];if(Ut.shaderID?En.push(Ut.shaderID):(En.push(Ut.customVertexShaderID),En.push(Ut.customFragmentShaderID)),void 0!==Ut.defines)for(const rr in Ut.defines)En.push(rr),En.push(Ut.defines[rr]);return!1===Ut.isRawShaderMaterial&&(function At(Ut,En){Ut.push(En.precision),Ut.push(En.outputColorSpace),Ut.push(En.envMapMode),Ut.push(En.envMapCubeUVHeight),Ut.push(En.mapUv),Ut.push(En.alphaMapUv),Ut.push(En.lightMapUv),Ut.push(En.aoMapUv),Ut.push(En.bumpMapUv),Ut.push(En.normalMapUv),Ut.push(En.displacementMapUv),Ut.push(En.emissiveMapUv),Ut.push(En.metalnessMapUv),Ut.push(En.roughnessMapUv),Ut.push(En.anisotropyMapUv),Ut.push(En.clearcoatMapUv),Ut.push(En.clearcoatNormalMapUv),Ut.push(En.clearcoatRoughnessMapUv),Ut.push(En.iridescenceMapUv),Ut.push(En.iridescenceThicknessMapUv),Ut.push(En.sheenColorMapUv),Ut.push(En.sheenRoughnessMapUv),Ut.push(En.specularMapUv),Ut.push(En.specularColorMapUv),Ut.push(En.specularIntensityMapUv),Ut.push(En.transmissionMapUv),Ut.push(En.thicknessMapUv),Ut.push(En.combine),Ut.push(En.fogExp2),Ut.push(En.sizeAttenuation),Ut.push(En.morphTargetsCount),Ut.push(En.morphAttributeCount),Ut.push(En.numDirLights),Ut.push(En.numPointLights),Ut.push(En.numSpotLights),Ut.push(En.numSpotLightMaps),Ut.push(En.numHemiLights),Ut.push(En.numRectAreaLights),Ut.push(En.numDirLightShadows),Ut.push(En.numPointLightShadows),Ut.push(En.numSpotLightShadows),Ut.push(En.numSpotLightShadowsWithMaps),Ut.push(En.numLightProbes),Ut.push(En.shadowMapType),Ut.push(En.toneMapping),Ut.push(En.numClippingPlanes),Ut.push(En.numClipIntersection),Ut.push(En.depthPacking)}(En,Ut),function Ht(Ut,En){F.disableAll(),En.isWebGL2&&F.enable(0),En.supportsVertexTextures&&F.enable(1),En.instancing&&F.enable(2),En.instancingColor&&F.enable(3),En.instancingMorph&&F.enable(4),En.matcap&&F.enable(5),En.envMap&&F.enable(6),En.normalMapObjectSpace&&F.enable(7),En.normalMapTangentSpace&&F.enable(8),En.clearcoat&&F.enable(9),En.iridescence&&F.enable(10),En.alphaTest&&F.enable(11),En.vertexColors&&F.enable(12),En.vertexAlphas&&F.enable(13),En.vertexUv1s&&F.enable(14),En.vertexUv2s&&F.enable(15),En.vertexUv3s&&F.enable(16),En.vertexTangents&&F.enable(17),En.anisotropy&&F.enable(18),En.alphaHash&&F.enable(19),En.batching&&F.enable(20),Ut.push(F.mask),F.disableAll(),En.fog&&F.enable(0),En.useFog&&F.enable(1),En.flatShading&&F.enable(2),En.logarithmicDepthBuffer&&F.enable(3),En.skinning&&F.enable(4),En.morphTargets&&F.enable(5),En.morphNormals&&F.enable(6),En.morphColors&&F.enable(7),En.premultipliedAlpha&&F.enable(8),En.shadowMapEnabled&&F.enable(9),En.useLegacyLights&&F.enable(10),En.doubleSided&&F.enable(11),En.flipSided&&F.enable(12),En.useDepthPacking&&F.enable(13),En.dithering&&F.enable(14),En.transmission&&F.enable(15),En.sheen&&F.enable(16),En.opaque&&F.enable(17),En.pointsUvs&&F.enable(18),En.decodeVideoTexture&&F.enable(19),En.alphaToCoverage&&F.enable(20),Ut.push(F.mask)}(En,Ut),En.push(M.outputColorSpace)),En.push(Ut.customProgramCacheKey),En.join()},getUniforms:function Pn(Ut){const En=vt[Ut.type];let rr;return rr=En?Zl.clone(Mu[En].uniforms):Ut.uniforms,rr},acquireProgram:function yn(Ut,En){let rr;for(let lr=0,Yn=Me.length;lr<Yn;lr++){const Qi=Me[lr];if(Qi.cacheKey===En){rr=Qi,++rr.usedTimes;break}}return void 0===rr&&(rr=new Ah(M,En,Ut,S),Me.push(rr)),rr},releaseProgram:function xn(Ut){if(0==--Ut.usedTimes){const En=Me.indexOf(Ut);Me[En]=Me[Me.length-1],Me.pop(),Ut.destroy()}},releaseShaderCache:function qn(Ut){ue.remove(Ut)},programs:Me,dispose:function wi(){ue.dispose()}}}function ed(){let M=new WeakMap;return{get:function a(S){let U=M.get(S);return void 0===U&&(U={},M.set(S,U)),U},remove:function c(S){M.delete(S)},update:function d(S,U,F){M.get(S)[U]=F},dispose:function p(){M=new WeakMap}}}function t1(M,a){return M.groupOrder!==a.groupOrder?M.groupOrder-a.groupOrder:M.renderOrder!==a.renderOrder?M.renderOrder-a.renderOrder:M.material.id!==a.material.id?M.material.id-a.material.id:M.z!==a.z?M.z-a.z:M.id-a.id}function p0(M,a){return M.groupOrder!==a.groupOrder?M.groupOrder-a.groupOrder:M.renderOrder!==a.renderOrder?M.renderOrder-a.renderOrder:M.z!==a.z?a.z-M.z:M.id-a.id}function os(){const M=[];let a=0;const c=[],d=[],p=[];function U(ke,Oe,Ge,et,vt,Ye){let je=M[a];return void 0===je?(je={id:ke.id,object:ke,geometry:Oe,material:Ge,groupOrder:et,renderOrder:ke.renderOrder,z:vt,group:Ye},M[a]=je):(je.id=ke.id,je.object=ke,je.geometry=Oe,je.material=Ge,je.groupOrder=et,je.renderOrder=ke.renderOrder,je.z=vt,je.group=Ye),a++,je}return{opaque:c,transmissive:d,transparent:p,init:function S(){a=0,c.length=0,d.length=0,p.length=0},push:function F(ke,Oe,Ge,et,vt,Ye){const je=U(ke,Oe,Ge,et,vt,Ye);Ge.transmission>0?d.push(je):!0===Ge.transparent?p.push(je):c.push(je)},unshift:function ue(ke,Oe,Ge,et,vt,Ye){const je=U(ke,Oe,Ge,et,vt,Ye);Ge.transmission>0?d.unshift(je):!0===Ge.transparent?p.unshift(je):c.unshift(je)},finish:function Me(){for(let ke=a,Oe=M.length;ke<Oe;ke++){const Ge=M[ke];if(null===Ge.id)break;Ge.id=null,Ge.object=null,Ge.geometry=null,Ge.material=null,Ge.group=null}},sort:function Q(ke,Oe){c.length>1&&c.sort(ke||t1),d.length>1&&d.sort(Oe||p0),p.length>1&&p.sort(Oe||p0)}}}function lA(){let M=new WeakMap;return{get:function a(d,p){const S=M.get(d);let U;return void 0===S?(U=new os,M.set(d,[U])):p>=S.length?(U=new os,S.push(U)):U=S[p],U},dispose:function c(){M=new WeakMap}}}function m0(){const M={};return{get:function(a){if(void 0!==M[a.id])return M[a.id];let c;switch(a.type){case"DirectionalLight":c={direction:new Mn,color:new io};break;case"SpotLight":c={position:new Mn,direction:new Mn,color:new io,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":c={position:new Mn,color:new io,distance:0,decay:0};break;case"HemisphereLight":c={direction:new Mn,skyColor:new io,groundColor:new io};break;case"RectAreaLight":c={color:new io,position:new Mn,halfWidth:new Mn,halfHeight:new Mn}}return M[a.id]=c,c}}}let Ps=0;function la(M,a){return(a.castShadow?2:0)-(M.castShadow?2:0)+(a.map?1:0)-(M.map?1:0)}function _a(M,a){const c=new m0,d=function A0(){const M={};return{get:function(a){if(void 0!==M[a.id])return M[a.id];let c;switch(a.type){case"DirectionalLight":case"SpotLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ki};break;case"PointLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ki,shadowCameraNear:1,shadowCameraFar:1e3}}return M[a.id]=c,c}}}(),p={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let Me=0;Me<9;Me++)p.probe.push(new Mn);const S=new Mn,U=new mo,F=new mo;return{setup:function ue(Me,ke){let Oe=0,Ge=0,et=0;for(let rr=0;rr<9;rr++)p.probe[rr].set(0,0,0);let vt=0,Ye=0,je=0,Rt=0,At=0,Ht=0,Pn=0,yn=0,xn=0,qn=0,wi=0;Me.sort(la);const Ut=!0===ke?Math.PI:1;for(let rr=0,lr=Me.length;rr<lr;rr++){const Yn=Me[rr],Qi=Yn.color,Oi=Yn.intensity,er=Yn.distance,Xi=Yn.shadow&&Yn.shadow.map?Yn.shadow.map.texture:null;if(Yn.isAmbientLight)Oe+=Qi.r*Oi*Ut,Ge+=Qi.g*Oi*Ut,et+=Qi.b*Oi*Ut;else if(Yn.isLightProbe){for(let Vi=0;Vi<9;Vi++)p.probe[Vi].addScaledVector(Yn.sh.coefficients[Vi],Oi);wi++}else if(Yn.isDirectionalLight){const Vi=c.get(Yn);if(Vi.color.copy(Yn.color).multiplyScalar(Yn.intensity*Ut),Yn.castShadow){const Vr=Yn.shadow,Hr=d.get(Yn);Hr.shadowBias=Vr.bias,Hr.shadowNormalBias=Vr.normalBias,Hr.shadowRadius=Vr.radius,Hr.shadowMapSize=Vr.mapSize,p.directionalShadow[vt]=Hr,p.directionalShadowMap[vt]=Xi,p.directionalShadowMatrix[vt]=Yn.shadow.matrix,Ht++}p.directional[vt]=Vi,vt++}else if(Yn.isSpotLight){const Vi=c.get(Yn);Vi.position.setFromMatrixPosition(Yn.matrixWorld),Vi.color.copy(Qi).multiplyScalar(Oi*Ut),Vi.distance=er,Vi.coneCos=Math.cos(Yn.angle),Vi.penumbraCos=Math.cos(Yn.angle*(1-Yn.penumbra)),Vi.decay=Yn.decay,p.spot[je]=Vi;const Vr=Yn.shadow;if(Yn.map&&(p.spotLightMap[xn]=Yn.map,xn++,Vr.updateMatrices(Yn),Yn.castShadow&&qn++),p.spotLightMatrix[je]=Vr.matrix,Yn.castShadow){const Hr=d.get(Yn);Hr.shadowBias=Vr.bias,Hr.shadowNormalBias=Vr.normalBias,Hr.shadowRadius=Vr.radius,Hr.shadowMapSize=Vr.mapSize,p.spotShadow[je]=Hr,p.spotShadowMap[je]=Xi,yn++}je++}else if(Yn.isRectAreaLight){const Vi=c.get(Yn);Vi.color.copy(Qi).multiplyScalar(Oi),Vi.halfWidth.set(.5*Yn.width,0,0),Vi.halfHeight.set(0,.5*Yn.height,0),p.rectArea[Rt]=Vi,Rt++}else if(Yn.isPointLight){const Vi=c.get(Yn);if(Vi.color.copy(Yn.color).multiplyScalar(Yn.intensity*Ut),Vi.distance=Yn.distance,Vi.decay=Yn.decay,Yn.castShadow){const Vr=Yn.shadow,Hr=d.get(Yn);Hr.shadowBias=Vr.bias,Hr.shadowNormalBias=Vr.normalBias,Hr.shadowRadius=Vr.radius,Hr.shadowMapSize=Vr.mapSize,Hr.shadowCameraNear=Vr.camera.near,Hr.shadowCameraFar=Vr.camera.far,p.pointShadow[Ye]=Hr,p.pointShadowMap[Ye]=Xi,p.pointShadowMatrix[Ye]=Yn.shadow.matrix,Pn++}p.point[Ye]=Vi,Ye++}else if(Yn.isHemisphereLight){const Vi=c.get(Yn);Vi.skyColor.copy(Yn.color).multiplyScalar(Oi*Ut),Vi.groundColor.copy(Yn.groundColor).multiplyScalar(Oi*Ut),p.hemi[At]=Vi,At++}}Rt>0&&(a.isWebGL2?!0===M.has("OES_texture_float_linear")?(p.rectAreaLTC1=zr.LTC_FLOAT_1,p.rectAreaLTC2=zr.LTC_FLOAT_2):(p.rectAreaLTC1=zr.LTC_HALF_1,p.rectAreaLTC2=zr.LTC_HALF_2):!0===M.has("OES_texture_float_linear")?(p.rectAreaLTC1=zr.LTC_FLOAT_1,p.rectAreaLTC2=zr.LTC_FLOAT_2):!0===M.has("OES_texture_half_float_linear")?(p.rectAreaLTC1=zr.LTC_HALF_1,p.rectAreaLTC2=zr.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),p.ambient[0]=Oe,p.ambient[1]=Ge,p.ambient[2]=et;const En=p.hash;(En.directionalLength!==vt||En.pointLength!==Ye||En.spotLength!==je||En.rectAreaLength!==Rt||En.hemiLength!==At||En.numDirectionalShadows!==Ht||En.numPointShadows!==Pn||En.numSpotShadows!==yn||En.numSpotMaps!==xn||En.numLightProbes!==wi)&&(p.directional.length=vt,p.spot.length=je,p.rectArea.length=Rt,p.point.length=Ye,p.hemi.length=At,p.directionalShadow.length=Ht,p.directionalShadowMap.length=Ht,p.pointShadow.length=Pn,p.pointShadowMap.length=Pn,p.spotShadow.length=yn,p.spotShadowMap.length=yn,p.directionalShadowMatrix.length=Ht,p.pointShadowMatrix.length=Pn,p.spotLightMatrix.length=yn+xn-qn,p.spotLightMap.length=xn,p.numSpotLightShadowsWithMaps=qn,p.numLightProbes=wi,En.directionalLength=vt,En.pointLength=Ye,En.spotLength=je,En.rectAreaLength=Rt,En.hemiLength=At,En.numDirectionalShadows=Ht,En.numPointShadows=Pn,En.numSpotShadows=yn,En.numSpotMaps=xn,En.numLightProbes=wi,p.version=Ps++)},setupView:function Q(Me,ke){let Oe=0,Ge=0,et=0,vt=0,Ye=0;const je=ke.matrixWorldInverse;for(let Rt=0,At=Me.length;Rt<At;Rt++){const Ht=Me[Rt];if(Ht.isDirectionalLight){const Pn=p.directional[Oe];Pn.direction.setFromMatrixPosition(Ht.matrixWorld),S.setFromMatrixPosition(Ht.target.matrixWorld),Pn.direction.sub(S),Pn.direction.transformDirection(je),Oe++}else if(Ht.isSpotLight){const Pn=p.spot[et];Pn.position.setFromMatrixPosition(Ht.matrixWorld),Pn.position.applyMatrix4(je),Pn.direction.setFromMatrixPosition(Ht.matrixWorld),S.setFromMatrixPosition(Ht.target.matrixWorld),Pn.direction.sub(S),Pn.direction.transformDirection(je),et++}else if(Ht.isRectAreaLight){const Pn=p.rectArea[vt];Pn.position.setFromMatrixPosition(Ht.matrixWorld),Pn.position.applyMatrix4(je),F.identity(),U.copy(Ht.matrixWorld),U.premultiply(je),F.extractRotation(U),Pn.halfWidth.set(.5*Ht.width,0,0),Pn.halfHeight.set(0,.5*Ht.height,0),Pn.halfWidth.applyMatrix4(F),Pn.halfHeight.applyMatrix4(F),vt++}else if(Ht.isPointLight){const Pn=p.point[Ge];Pn.position.setFromMatrixPosition(Ht.matrixWorld),Pn.position.applyMatrix4(je),Ge++}else if(Ht.isHemisphereLight){const Pn=p.hemi[Ye];Pn.direction.setFromMatrixPosition(Ht.matrixWorld),Pn.direction.transformDirection(je),Ye++}}},state:p}}function Ir(M,a){const c=new _a(M,a),d=[],p=[];return{init:function S(){d.length=0,p.length=0},state:{lightsArray:d,shadowsArray:p,lights:c},setupLights:function ue(ke){c.setup(d,ke)},setupLightsView:function Q(ke){c.setupView(d,ke)},pushLight:function U(ke){d.push(ke)},pushShadow:function F(ke){p.push(ke)}}}function ns(M,a){let c=new WeakMap;return{get:function d(S,U=0){const F=c.get(S);let ue;return void 0===F?(ue=new Ir(M,a),c.set(S,[ue])):U>=F.length?(ue=new Ir(M,a),F.push(ue)):ue=F[U],ue},dispose:function p(){c=new WeakMap}}}class wl extends _l{constructor(a){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(a)}copy(a){return super.copy(a),this.depthPacking=a.depthPacking,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this}}class nu extends _l{constructor(a){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(a)}copy(a){return super.copy(a),this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this}}function n1(M,a,c){let d=new ff;const p=new Ki,S=new Ki,U=new Ya,F=new wl({depthPacking:3201}),ue=new nu,Q={},Me=c.maxTextureSize,ke={[L]:1,[he]:L,[re]:re},Oe=new jc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ki},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),Ge=Oe.clone();Ge.defines.HORIZONTAL_PASS=1;const et=new ol;et.setAttribute("position",new tl(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const vt=new Jl(et,Oe),Ye=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Re;let je=this.type;function Rt(yn,xn){const qn=a.update(vt);Oe.defines.VSM_SAMPLES!==yn.blurSamples&&(Oe.defines.VSM_SAMPLES=yn.blurSamples,Ge.defines.VSM_SAMPLES=yn.blurSamples,Oe.needsUpdate=!0,Ge.needsUpdate=!0),null===yn.mapPass&&(yn.mapPass=new Hl(p.x,p.y)),Oe.uniforms.shadow_pass.value=yn.map.texture,Oe.uniforms.resolution.value=yn.mapSize,Oe.uniforms.radius.value=yn.radius,M.setRenderTarget(yn.mapPass),M.clear(),M.renderBufferDirect(xn,null,qn,Oe,vt,null),Ge.uniforms.shadow_pass.value=yn.mapPass.texture,Ge.uniforms.resolution.value=yn.mapSize,Ge.uniforms.radius.value=yn.radius,M.setRenderTarget(yn.map),M.clear(),M.renderBufferDirect(xn,null,qn,Ge,vt,null)}function At(yn,xn,qn,wi){let Ut=null;const En=!0===qn.isPointLight?yn.customDistanceMaterial:yn.customDepthMaterial;if(void 0!==En)Ut=En;else if(Ut=!0===qn.isPointLight?ue:F,M.localClippingEnabled&&!0===xn.clipShadows&&Array.isArray(xn.clippingPlanes)&&0!==xn.clippingPlanes.length||xn.displacementMap&&0!==xn.displacementScale||xn.alphaMap&&xn.alphaTest>0||xn.map&&xn.alphaTest>0){const rr=Ut.uuid,lr=xn.uuid;let Yn=Q[rr];void 0===Yn&&(Yn={},Q[rr]=Yn);let Qi=Yn[lr];void 0===Qi&&(Qi=Ut.clone(),Yn[lr]=Qi,xn.addEventListener("dispose",Pn)),Ut=Qi}return Ut.visible=xn.visible,Ut.wireframe=xn.wireframe,Ut.side=wi===Ie?null!==xn.shadowSide?xn.shadowSide:xn.side:null!==xn.shadowSide?xn.shadowSide:ke[xn.side],Ut.alphaMap=xn.alphaMap,Ut.alphaTest=xn.alphaTest,Ut.map=xn.map,Ut.clipShadows=xn.clipShadows,Ut.clippingPlanes=xn.clippingPlanes,Ut.clipIntersection=xn.clipIntersection,Ut.displacementMap=xn.displacementMap,Ut.displacementScale=xn.displacementScale,Ut.displacementBias=xn.displacementBias,Ut.wireframeLinewidth=xn.wireframeLinewidth,Ut.linewidth=xn.linewidth,!0===qn.isPointLight&&!0===Ut.isMeshDistanceMaterial&&(M.properties.get(Ut).light=qn),Ut}function Ht(yn,xn,qn,wi,Ut){if(!1===yn.visible)return;if(yn.layers.test(xn.layers)&&(yn.isMesh||yn.isLine||yn.isPoints)&&(yn.castShadow||yn.receiveShadow&&Ut===Ie)&&(!yn.frustumCulled||d.intersectsObject(yn))){yn.modelViewMatrix.multiplyMatrices(qn.matrixWorldInverse,yn.matrixWorld);const lr=a.update(yn),Yn=yn.material;if(Array.isArray(Yn)){const Qi=lr.groups;for(let Oi=0,er=Qi.length;Oi<er;Oi++){const Xi=Qi[Oi],Vi=Yn[Xi.materialIndex];if(Vi&&Vi.visible){const Vr=At(yn,Vi,wi,Ut);yn.onBeforeShadow(M,yn,xn,qn,lr,Vr,Xi),M.renderBufferDirect(qn,null,lr,Vr,yn,Xi),yn.onAfterShadow(M,yn,xn,qn,lr,Vr,Xi)}}}else if(Yn.visible){const Qi=At(yn,Yn,wi,Ut);yn.onBeforeShadow(M,yn,xn,qn,lr,Qi,null),M.renderBufferDirect(qn,null,lr,Qi,yn,null),yn.onAfterShadow(M,yn,xn,qn,lr,Qi,null)}}const rr=yn.children;for(let lr=0,Yn=rr.length;lr<Yn;lr++)Ht(rr[lr],xn,qn,wi,Ut)}function Pn(yn){yn.target.removeEventListener("dispose",Pn);for(const qn in Q){const wi=Q[qn],Ut=yn.target.uuid;Ut in wi&&(wi[Ut].dispose(),delete wi[Ut])}}this.render=function(yn,xn,qn){if(!1===Ye.enabled||!1===Ye.autoUpdate&&!1===Ye.needsUpdate||0===yn.length)return;const wi=M.getRenderTarget(),Ut=M.getActiveCubeFace(),En=M.getActiveMipmapLevel(),rr=M.state;rr.setBlending(fe),rr.buffers.color.setClear(1,1,1,1),rr.buffers.depth.setTest(!0),rr.setScissorTest(!1);const lr=je!==Ie&&this.type===Ie,Yn=je===Ie&&this.type!==Ie;for(let Qi=0,Oi=yn.length;Qi<Oi;Qi++){const er=yn[Qi],Xi=er.shadow;if(void 0===Xi){console.warn("THREE.WebGLShadowMap:",er,"has no shadow.");continue}if(!1===Xi.autoUpdate&&!1===Xi.needsUpdate)continue;p.copy(Xi.mapSize);const Vi=Xi.getFrameExtents();if(p.multiply(Vi),S.copy(Xi.mapSize),(p.x>Me||p.y>Me)&&(p.x>Me&&(S.x=Math.floor(Me/Vi.x),p.x=S.x*Vi.x,Xi.mapSize.x=S.x),p.y>Me&&(S.y=Math.floor(Me/Vi.y),p.y=S.y*Vi.y,Xi.mapSize.y=S.y)),null===Xi.map||!0===lr||!0===Yn){const Hr=this.type!==Ie?{minFilter:qi,magFilter:qi}:{};null!==Xi.map&&Xi.map.dispose(),Xi.map=new Hl(p.x,p.y,Hr),Xi.map.texture.name=er.name+".shadowMap",Xi.camera.updateProjectionMatrix()}M.setRenderTarget(Xi.map),M.clear();const Vr=Xi.getViewportCount();for(let Hr=0;Hr<Vr;Hr++){const Ns=Xi.getViewport(Hr);U.set(S.x*Ns.x,S.y*Ns.y,S.x*Ns.z,S.y*Ns.w),rr.viewport(U),Xi.updateMatrices(er,Hr),d=Xi.getFrustum(),Ht(xn,qn,Xi.camera,er,this.type)}!0!==Xi.isPointLightShadow&&this.type===Ie&&Rt(Xi,qn),Xi.needsUpdate=!1}je=this.type,Ye.needsUpdate=!1,M.setRenderTarget(wi,Ut,En)}}function t3(M,a,c){const d=c.isWebGL2,F=new function p(){let Jn=!1;const gs=new Ya;let Bi=null;const ts=new Ya(0,0,0,0);return{setMask:function(Es){Bi!==Es&&!Jn&&(M.colorMask(Es,Es,Es,Es),Bi=Es)},setLocked:function(Es){Jn=Es},setClear:function(Es,Qa,sc,Tu,xp){!0===xp&&(Es*=Tu,Qa*=Tu,sc*=Tu),gs.set(Es,Qa,sc,Tu),!1===ts.equals(gs)&&(M.clearColor(Es,Qa,sc,Tu),ts.copy(gs))},reset:function(){Jn=!1,Bi=null,ts.set(-1,0,0,0)}}},ue=new function S(){let Jn=!1,gs=null,Bi=null,ts=null;return{setTest:function(Es){Es?Qs(M.DEPTH_TEST):fa(M.DEPTH_TEST)},setMask:function(Es){gs!==Es&&!Jn&&(M.depthMask(Es),gs=Es)},setFunc:function(Es){if(Bi!==Es){switch(Es){case 0:M.depthFunc(M.NEVER);break;case 1:M.depthFunc(M.ALWAYS);break;case 2:M.depthFunc(M.LESS);break;case 3:default:M.depthFunc(M.LEQUAL);break;case 4:M.depthFunc(M.EQUAL);break;case 5:M.depthFunc(M.GEQUAL);break;case 6:M.depthFunc(M.GREATER);break;case 7:M.depthFunc(M.NOTEQUAL)}Bi=Es}},setLocked:function(Es){Jn=Es},setClear:function(Es){ts!==Es&&(M.clearDepth(Es),ts=Es)},reset:function(){Jn=!1,gs=null,Bi=null,ts=null}}},Q=new function U(){let Jn=!1,gs=null,Bi=null,ts=null,Es=null,Qa=null,sc=null,Tu=null,xp=null;return{setTest:function(Wl){Jn||(Wl?Qs(M.STENCIL_TEST):fa(M.STENCIL_TEST))},setMask:function(Wl){gs!==Wl&&!Jn&&(M.stencilMask(Wl),gs=Wl)},setFunc:function(Wl,bd,Rf){(Bi!==Wl||ts!==bd||Es!==Rf)&&(M.stencilFunc(Wl,bd,Rf),Bi=Wl,ts=bd,Es=Rf)},setOp:function(Wl,bd,Rf){(Qa!==Wl||sc!==bd||Tu!==Rf)&&(M.stencilOp(Wl,bd,Rf),Qa=Wl,sc=bd,Tu=Rf)},setLocked:function(Wl){Jn=Wl},setClear:function(Wl){xp!==Wl&&(M.clearStencil(Wl),xp=Wl)},reset:function(){Jn=!1,gs=null,Bi=null,ts=null,Es=null,Qa=null,sc=null,Tu=null,xp=null}}},Me=new WeakMap,ke=new WeakMap;let Oe={},Ge={},et=new WeakMap,vt=[],Ye=null,je=!1,Rt=null,At=null,Ht=null,Pn=null,yn=null,xn=null,qn=null,wi=new io(0,0,0),Ut=0,En=!1,rr=null,lr=null,Yn=null,Qi=null,Oi=null;const er=M.getParameter(M.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Xi=!1,Vi=0;const Vr=M.getParameter(M.VERSION);-1!==Vr.indexOf("WebGL")?(Vi=parseFloat(/^WebGL (\d)/.exec(Vr)[1]),Xi=Vi>=1):-1!==Vr.indexOf("OpenGL ES")&&(Vi=parseFloat(/^OpenGL ES (\d)/.exec(Vr)[1]),Xi=Vi>=2);let Hr=null,Ns={};const Yo=M.getParameter(M.SCISSOR_BOX),Hi=M.getParameter(M.VIEWPORT),Or=(new Ya).fromArray(Yo),Ds=(new Ya).fromArray(Hi);function bo(Jn,gs,Bi,ts){const Es=new Uint8Array(4),Qa=M.createTexture();M.bindTexture(Jn,Qa),M.texParameteri(Jn,M.TEXTURE_MIN_FILTER,M.NEAREST),M.texParameteri(Jn,M.TEXTURE_MAG_FILTER,M.NEAREST);for(let sc=0;sc<Bi;sc++)!d||Jn!==M.TEXTURE_3D&&Jn!==M.TEXTURE_2D_ARRAY?M.texImage2D(gs+sc,0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,Es):M.texImage3D(gs,0,M.RGBA,1,1,ts,0,M.RGBA,M.UNSIGNED_BYTE,Es);return Qa}const eo={};function Qs(Jn){!0!==Oe[Jn]&&(M.enable(Jn),Oe[Jn]=!0)}function fa(Jn){!1!==Oe[Jn]&&(M.disable(Jn),Oe[Jn]=!1)}eo[M.TEXTURE_2D]=bo(M.TEXTURE_2D,M.TEXTURE_2D,1),eo[M.TEXTURE_CUBE_MAP]=bo(M.TEXTURE_CUBE_MAP,M.TEXTURE_CUBE_MAP_POSITIVE_X,6),d&&(eo[M.TEXTURE_2D_ARRAY]=bo(M.TEXTURE_2D_ARRAY,M.TEXTURE_2D_ARRAY,1,1),eo[M.TEXTURE_3D]=bo(M.TEXTURE_3D,M.TEXTURE_3D,1,1)),F.setClear(0,0,0,1),ue.setClear(1),Q.setClear(0),Qs(M.DEPTH_TEST),ue.setFunc(3),Ms(!1),Zs(1),Qs(M.CULL_FACE),fr(fe);const Zi={[D]:M.FUNC_ADD,[x]:M.FUNC_SUBTRACT,[P]:M.FUNC_REVERSE_SUBTRACT};if(d)Zi[103]=M.MIN,Zi[104]=M.MAX;else{const Jn=a.get("EXT_blend_minmax");null!==Jn&&(Zi[103]=Jn.MIN_EXT,Zi[104]=Jn.MAX_EXT)}const $r={[g]:M.ZERO,[C]:M.ONE,[N]:M.SRC_COLOR,[H]:M.SRC_ALPHA,[A]:M.SRC_ALPHA_SATURATE,[m]:M.DST_COLOR,[ie]:M.DST_ALPHA,[O]:M.ONE_MINUS_SRC_COLOR,[X]:M.ONE_MINUS_SRC_ALPHA,[I]:M.ONE_MINUS_DST_COLOR,[z]:M.ONE_MINUS_DST_ALPHA,[R]:M.CONSTANT_COLOR,[k]:M.ONE_MINUS_CONSTANT_COLOR,[ee]:M.CONSTANT_ALPHA,[ge]:M.ONE_MINUS_CONSTANT_ALPHA};function fr(Jn,gs,Bi,ts,Es,Qa,sc,Tu,xp,Wl){if(Jn!==fe){if(!1===je&&(Qs(M.BLEND),je=!0),5===Jn)Es=Es||gs,Qa=Qa||Bi,sc=sc||ts,(gs!==At||Es!==yn)&&(M.blendEquationSeparate(Zi[gs],Zi[Es]),At=gs,yn=Es),(Bi!==Ht||ts!==Pn||Qa!==xn||sc!==qn)&&(M.blendFuncSeparate($r[Bi],$r[ts],$r[Qa],$r[sc]),Ht=Bi,Pn=ts,xn=Qa,qn=sc),(!1===Tu.equals(wi)||xp!==Ut)&&(M.blendColor(Tu.r,Tu.g,Tu.b,xp),wi.copy(Tu),Ut=xp),Rt=Jn,En=!1;else if(Jn!==Rt||Wl!==En){if((At!==D||yn!==D)&&(M.blendEquation(M.FUNC_ADD),At=D,yn=D),Wl)switch(Jn){case 1:M.blendFuncSeparate(M.ONE,M.ONE_MINUS_SRC_ALPHA,M.ONE,M.ONE_MINUS_SRC_ALPHA);break;case pe:M.blendFunc(M.ONE,M.ONE);break;case 3:M.blendFuncSeparate(M.ZERO,M.ONE_MINUS_SRC_COLOR,M.ZERO,M.ONE);break;case 4:M.blendFuncSeparate(M.ZERO,M.SRC_COLOR,M.ZERO,M.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Jn)}else switch(Jn){case 1:M.blendFuncSeparate(M.SRC_ALPHA,M.ONE_MINUS_SRC_ALPHA,M.ONE,M.ONE_MINUS_SRC_ALPHA);break;case pe:M.blendFunc(M.SRC_ALPHA,M.ONE);break;case 3:M.blendFuncSeparate(M.ZERO,M.ONE_MINUS_SRC_COLOR,M.ZERO,M.ONE);break;case 4:M.blendFunc(M.ZERO,M.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Jn)}Ht=null,Pn=null,xn=null,qn=null,wi.set(0,0,0),Ut=0,Rt=Jn,En=Wl}}else!0===je&&(fa(M.BLEND),je=!1)}function Ms(Jn){rr!==Jn&&(M.frontFace(Jn?M.CW:M.CCW),rr=Jn)}function Zs(Jn){0!==Jn?(Qs(M.CULL_FACE),Jn!==lr&&M.cullFace(1===Jn?M.BACK:2===Jn?M.FRONT:M.FRONT_AND_BACK)):fa(M.CULL_FACE),lr=Jn}function wn(Jn,gs,Bi){Jn?(Qs(M.POLYGON_OFFSET_FILL),(Qi!==gs||Oi!==Bi)&&(M.polygonOffset(gs,Bi),Qi=gs,Oi=Bi)):fa(M.POLYGON_OFFSET_FILL)}return{buffers:{color:F,depth:ue,stencil:Q},enable:Qs,disable:fa,bindFramebuffer:function Ao(Jn,gs){return Ge[Jn]!==gs&&(M.bindFramebuffer(Jn,gs),Ge[Jn]=gs,d&&(Jn===M.DRAW_FRAMEBUFFER&&(Ge[M.FRAMEBUFFER]=gs),Jn===M.FRAMEBUFFER&&(Ge[M.DRAW_FRAMEBUFFER]=gs)),!0)},drawBuffers:function On(Jn,gs){let Bi=vt,ts=!1;if(Jn){Bi=et.get(gs),void 0===Bi&&(Bi=[],et.set(gs,Bi));const Es=Jn.textures;if(Bi.length!==Es.length||Bi[0]!==M.COLOR_ATTACHMENT0){for(let Qa=0,sc=Es.length;Qa<sc;Qa++)Bi[Qa]=M.COLOR_ATTACHMENT0+Qa;Bi.length=Es.length,ts=!0}}else Bi[0]!==M.BACK&&(Bi[0]=M.BACK,ts=!0);if(ts)if(c.isWebGL2)M.drawBuffers(Bi);else{if(!0!==a.has("WEBGL_draw_buffers"))throw new Error("THREE.WebGLState: Usage of gl.drawBuffers() require WebGL2 or WEBGL_draw_buffers extension");a.get("WEBGL_draw_buffers").drawBuffersWEBGL(Bi)}},useProgram:function Zr(Jn){return Ye!==Jn&&(M.useProgram(Jn),Ye=Jn,!0)},setBlending:fr,setMaterial:function As(Jn,gs){Jn.side===re?fa(M.CULL_FACE):Qs(M.CULL_FACE);let Bi=1===Jn.side;gs&&(Bi=!Bi),Ms(Bi),1===Jn.blending&&!1===Jn.transparent?fr(fe):fr(Jn.blending,Jn.blendEquation,Jn.blendSrc,Jn.blendDst,Jn.blendEquationAlpha,Jn.blendSrcAlpha,Jn.blendDstAlpha,Jn.blendColor,Jn.blendAlpha,Jn.premultipliedAlpha),ue.setFunc(Jn.depthFunc),ue.setTest(Jn.depthTest),ue.setMask(Jn.depthWrite),F.setMask(Jn.colorWrite);const ts=Jn.stencilWrite;Q.setTest(ts),ts&&(Q.setMask(Jn.stencilWriteMask),Q.setFunc(Jn.stencilFunc,Jn.stencilRef,Jn.stencilFuncMask),Q.setOp(Jn.stencilFail,Jn.stencilZFail,Jn.stencilZPass)),wn(Jn.polygonOffset,Jn.polygonOffsetFactor,Jn.polygonOffsetUnits),!0===Jn.alphaToCoverage?Qs(M.SAMPLE_ALPHA_TO_COVERAGE):fa(M.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Ms,setCullFace:Zs,setLineWidth:function za(Jn){Jn!==Yn&&(Xi&&M.lineWidth(Jn),Yn=Jn)},setPolygonOffset:wn,setScissorTest:function Gt(Jn){Jn?Qs(M.SCISSOR_TEST):fa(M.SCISSOR_TEST)},activeTexture:function zi(Jn){void 0===Jn&&(Jn=M.TEXTURE0+er-1),Hr!==Jn&&(M.activeTexture(Jn),Hr=Jn)},bindTexture:function ji(Jn,gs,Bi){void 0===Bi&&(Bi=null===Hr?M.TEXTURE0+er-1:Hr);let ts=Ns[Bi];void 0===ts&&(ts={type:void 0,texture:void 0},Ns[Bi]=ts),(ts.type!==Jn||ts.texture!==gs)&&(Hr!==Bi&&(M.activeTexture(Bi),Hr=Bi),M.bindTexture(Jn,gs||eo[Jn]),ts.type=Jn,ts.texture=gs)},unbindTexture:function Lr(){const Jn=Ns[Hr];void 0!==Jn&&void 0!==Jn.type&&(M.bindTexture(Jn.type,null),Jn.type=void 0,Jn.texture=void 0)},compressedTexImage2D:function br(){try{M.compressedTexImage2D.apply(M,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},compressedTexImage3D:function ta(){try{M.compressedTexImage3D.apply(M,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},texImage2D:function Sa(){try{M.texImage2D.apply(M,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},texImage3D:function So(){try{M.texImage3D.apply(M,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},updateUBOMapping:function ya(Jn,gs){let Bi=ke.get(gs);void 0===Bi&&(Bi=new WeakMap,ke.set(gs,Bi));let ts=Bi.get(Jn);void 0===ts&&(ts=M.getUniformBlockIndex(gs,Jn.name),Bi.set(Jn,ts))},uniformBlockBinding:function Qo(Jn,gs){const ts=ke.get(gs).get(Jn);Me.get(gs)!==ts&&(M.uniformBlockBinding(gs,ts,Jn.__bindingPointIndex),Me.set(gs,ts))},texStorage2D:function Yr(){try{M.texStorage2D.apply(M,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},texStorage3D:function _h(){try{M.texStorage3D.apply(M,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},texSubImage2D:function ko(){try{M.texSubImage2D.apply(M,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},texSubImage3D:function Xr(){try{M.texSubImage3D.apply(M,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},compressedTexSubImage2D:function cs(){try{M.compressedTexSubImage2D.apply(M,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},compressedTexSubImage3D:function Eo(){try{M.compressedTexSubImage3D.apply(M,arguments)}catch(Jn){console.error("THREE.WebGLState:",Jn)}},scissor:function $s(Jn){!1===Or.equals(Jn)&&(M.scissor(Jn.x,Jn.y,Jn.z,Jn.w),Or.copy(Jn))},viewport:function po(Jn){!1===Ds.equals(Jn)&&(M.viewport(Jn.x,Jn.y,Jn.z,Jn.w),Ds.copy(Jn))},reset:function rc(){M.disable(M.BLEND),M.disable(M.CULL_FACE),M.disable(M.DEPTH_TEST),M.disable(M.POLYGON_OFFSET_FILL),M.disable(M.SCISSOR_TEST),M.disable(M.STENCIL_TEST),M.disable(M.SAMPLE_ALPHA_TO_COVERAGE),M.blendEquation(M.FUNC_ADD),M.blendFunc(M.ONE,M.ZERO),M.blendFuncSeparate(M.ONE,M.ZERO,M.ONE,M.ZERO),M.blendColor(0,0,0,0),M.colorMask(!0,!0,!0,!0),M.clearColor(0,0,0,0),M.depthMask(!0),M.depthFunc(M.LESS),M.clearDepth(1),M.stencilMask(4294967295),M.stencilFunc(M.ALWAYS,0,4294967295),M.stencilOp(M.KEEP,M.KEEP,M.KEEP),M.clearStencil(0),M.cullFace(M.BACK),M.frontFace(M.CCW),M.polygonOffset(0,0),M.activeTexture(M.TEXTURE0),M.bindFramebuffer(M.FRAMEBUFFER,null),!0===d&&(M.bindFramebuffer(M.DRAW_FRAMEBUFFER,null),M.bindFramebuffer(M.READ_FRAMEBUFFER,null)),M.useProgram(null),M.lineWidth(1),M.scissor(0,0,M.canvas.width,M.canvas.height),M.viewport(0,0,M.canvas.width,M.canvas.height),Oe={},Hr=null,Ns={},Ge={},et=new WeakMap,vt=[],Ye=null,je=!1,Rt=null,At=null,Ht=null,Pn=null,yn=null,xn=null,qn=null,wi=new io(0,0,0),Ut=0,En=!1,rr=null,lr=null,Yn=null,Qi=null,Oi=null,Or.set(0,0,M.canvas.width,M.canvas.height),Ds.set(0,0,M.canvas.width,M.canvas.height),F.reset(),ue.reset(),Q.reset()}}}function n3(M,a,c,d,p,S,U){const F=p.isWebGL2,ue=a.has("WEBGL_multisampled_render_to_texture")?a.get("WEBGL_multisampled_render_to_texture"):null,Q=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),Me=new Ki,ke=new WeakMap;let Oe;const Ge=new WeakMap;let et=!1;try{et=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function vt(wn,Gt){return et?new OffscreenCanvas(wn,Gt):zl("canvas")}function Ye(wn,Gt,zi,ji){let Lr=1;const br=za(wn);if((br.width>ji||br.height>ji)&&(Lr=ji/Math.max(br.width,br.height)),Lr<1||!0===Gt){if(typeof HTMLImageElement<"u"&&wn instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&wn instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&wn instanceof ImageBitmap||typeof VideoFrame<"u"&&wn instanceof VideoFrame){const ta=Gt?Kc:Math.floor,ko=ta(Lr*br.width),Xr=ta(Lr*br.height);void 0===Oe&&(Oe=vt(ko,Xr));const cs=zi?vt(ko,Xr):Oe;return cs.width=ko,cs.height=Xr,cs.getContext("2d").drawImage(wn,0,0,ko,Xr),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+br.width+"x"+br.height+") to ("+ko+"x"+Xr+")."),cs}return"data"in wn&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+br.width+"x"+br.height+")."),wn}return wn}function je(wn){const Gt=za(wn);return hd(Gt.width)&&hd(Gt.height)}function At(wn,Gt){return wn.generateMipmaps&&Gt&&wn.minFilter!==qi&&wn.minFilter!==wt}function Ht(wn){M.generateMipmap(wn)}function Pn(wn,Gt,zi,ji,Lr=!1){if(!1===F)return Gt;if(null!==wn){if(void 0!==M[wn])return M[wn];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+wn+"'")}let br=Gt;if(Gt===M.RED&&(zi===M.FLOAT&&(br=M.R32F),zi===M.HALF_FLOAT&&(br=M.R16F),zi===M.UNSIGNED_BYTE&&(br=M.R8)),Gt===M.RED_INTEGER&&(zi===M.UNSIGNED_BYTE&&(br=M.R8UI),zi===M.UNSIGNED_SHORT&&(br=M.R16UI),zi===M.UNSIGNED_INT&&(br=M.R32UI),zi===M.BYTE&&(br=M.R8I),zi===M.SHORT&&(br=M.R16I),zi===M.INT&&(br=M.R32I)),Gt===M.RG&&(zi===M.FLOAT&&(br=M.RG32F),zi===M.HALF_FLOAT&&(br=M.RG16F),zi===M.UNSIGNED_BYTE&&(br=M.RG8)),Gt===M.RG_INTEGER&&(zi===M.UNSIGNED_BYTE&&(br=M.RG8UI),zi===M.UNSIGNED_SHORT&&(br=M.RG16UI),zi===M.UNSIGNED_INT&&(br=M.RG32UI),zi===M.BYTE&&(br=M.RG8I),zi===M.SHORT&&(br=M.RG16I),zi===M.INT&&(br=M.RG32I)),Gt===M.RGBA){const ta=Lr?Md:Ia.getTransfer(ji);zi===M.FLOAT&&(br=M.RGBA32F),zi===M.HALF_FLOAT&&(br=M.RGBA16F),zi===M.UNSIGNED_BYTE&&(br=ta===Ga?M.SRGB8_ALPHA8:M.RGBA8),zi===M.UNSIGNED_SHORT_4_4_4_4&&(br=M.RGBA4),zi===M.UNSIGNED_SHORT_5_5_5_1&&(br=M.RGB5_A1)}return(br===M.R16F||br===M.R32F||br===M.RG16F||br===M.RG32F||br===M.RGBA16F||br===M.RGBA32F)&&a.get("EXT_color_buffer_float"),br}function yn(wn,Gt,zi){return!0===At(wn,zi)||wn.isFramebufferTexture&&wn.minFilter!==qi&&wn.minFilter!==wt?Math.log2(Math.max(Gt.width,Gt.height))+1:void 0!==wn.mipmaps&&wn.mipmaps.length>0?wn.mipmaps.length:wn.isCompressedTexture&&Array.isArray(wn.image)?Gt.mipmaps.length:1}function xn(wn){return wn===qi||1004===wn||wn===ms?M.NEAREST:M.LINEAR}function qn(wn){const Gt=wn.target;Gt.removeEventListener("dispose",qn),function Ut(wn){const Gt=d.get(wn);if(void 0===Gt.__webglInit)return;const zi=wn.source,ji=Ge.get(zi);if(ji){const Lr=ji[Gt.__cacheKey];Lr.usedTimes--,0===Lr.usedTimes&&En(wn),0===Object.keys(ji).length&&Ge.delete(zi)}d.remove(wn)}(Gt),Gt.isVideoTexture&&ke.delete(Gt)}function wi(wn){const Gt=wn.target;Gt.removeEventListener("dispose",wi),function rr(wn){const Gt=d.get(wn);if(wn.depthTexture&&wn.depthTexture.dispose(),wn.isWebGLCubeRenderTarget)for(let ji=0;ji<6;ji++){if(Array.isArray(Gt.__webglFramebuffer[ji]))for(let Lr=0;Lr<Gt.__webglFramebuffer[ji].length;Lr++)M.deleteFramebuffer(Gt.__webglFramebuffer[ji][Lr]);else M.deleteFramebuffer(Gt.__webglFramebuffer[ji]);Gt.__webglDepthbuffer&&M.deleteRenderbuffer(Gt.__webglDepthbuffer[ji])}else{if(Array.isArray(Gt.__webglFramebuffer))for(let ji=0;ji<Gt.__webglFramebuffer.length;ji++)M.deleteFramebuffer(Gt.__webglFramebuffer[ji]);else M.deleteFramebuffer(Gt.__webglFramebuffer);if(Gt.__webglDepthbuffer&&M.deleteRenderbuffer(Gt.__webglDepthbuffer),Gt.__webglMultisampledFramebuffer&&M.deleteFramebuffer(Gt.__webglMultisampledFramebuffer),Gt.__webglColorRenderbuffer)for(let ji=0;ji<Gt.__webglColorRenderbuffer.length;ji++)Gt.__webglColorRenderbuffer[ji]&&M.deleteRenderbuffer(Gt.__webglColorRenderbuffer[ji]);Gt.__webglDepthRenderbuffer&&M.deleteRenderbuffer(Gt.__webglDepthRenderbuffer)}const zi=wn.textures;for(let ji=0,Lr=zi.length;ji<Lr;ji++){const br=d.get(zi[ji]);br.__webglTexture&&(M.deleteTexture(br.__webglTexture),U.memory.textures--),d.remove(zi[ji])}d.remove(wn)}(Gt)}function En(wn){const Gt=d.get(wn);M.deleteTexture(Gt.__webglTexture),delete Ge.get(wn.source)[Gt.__cacheKey],U.memory.textures--}let lr=0;function er(wn,Gt){const zi=d.get(wn);if(wn.isVideoTexture&&function Ms(wn){const Gt=U.render.frame;ke.get(wn)!==Gt&&(ke.set(wn,Gt),wn.update())}(wn),!1===wn.isRenderTargetTexture&&wn.version>0&&zi.__version!==wn.version){const ji=wn.image;if(null===ji)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==ji.complete)return void Ds(zi,wn,Gt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}c.bindTexture(M.TEXTURE_2D,zi.__webglTexture,M.TEXTURE0+Gt)}const Hr={[Zn]:M.REPEAT,[ui]:M.CLAMP_TO_EDGE,[hi]:M.MIRRORED_REPEAT},Ns={[qi]:M.NEAREST,[Mr]:M.NEAREST_MIPMAP_NEAREST,[ms]:M.NEAREST_MIPMAP_LINEAR,[wt]:M.LINEAR,[W]:M.LINEAR_MIPMAP_NEAREST,[_e]:M.LINEAR_MIPMAP_LINEAR},Yo={[j0]:M.NEVER,[Vx]:M.ALWAYS,[by]:M.LESS,[PA]:M.LEQUAL,[xy]:M.EQUAL,[vv]:M.GEQUAL,[yv]:M.GREATER,[Hx]:M.NOTEQUAL};function Hi(wn,Gt,zi){if(Gt.type===dn&&!1===a.has("OES_texture_float_linear")&&(Gt.magFilter===wt||Gt.magFilter===W||Gt.magFilter===ms||Gt.magFilter===_e||Gt.minFilter===wt||Gt.minFilter===W||Gt.minFilter===ms||Gt.minFilter===_e)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),zi?(M.texParameteri(wn,M.TEXTURE_WRAP_S,Hr[Gt.wrapS]),M.texParameteri(wn,M.TEXTURE_WRAP_T,Hr[Gt.wrapT]),(wn===M.TEXTURE_3D||wn===M.TEXTURE_2D_ARRAY)&&M.texParameteri(wn,M.TEXTURE_WRAP_R,Hr[Gt.wrapR]),M.texParameteri(wn,M.TEXTURE_MAG_FILTER,Ns[Gt.magFilter]),M.texParameteri(wn,M.TEXTURE_MIN_FILTER,Ns[Gt.minFilter])):(M.texParameteri(wn,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE),M.texParameteri(wn,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE),(wn===M.TEXTURE_3D||wn===M.TEXTURE_2D_ARRAY)&&M.texParameteri(wn,M.TEXTURE_WRAP_R,M.CLAMP_TO_EDGE),(Gt.wrapS!==ui||Gt.wrapT!==ui)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),M.texParameteri(wn,M.TEXTURE_MAG_FILTER,xn(Gt.magFilter)),M.texParameteri(wn,M.TEXTURE_MIN_FILTER,xn(Gt.minFilter)),Gt.minFilter!==qi&&Gt.minFilter!==wt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),Gt.compareFunction&&(M.texParameteri(wn,M.TEXTURE_COMPARE_MODE,M.COMPARE_REF_TO_TEXTURE),M.texParameteri(wn,M.TEXTURE_COMPARE_FUNC,Yo[Gt.compareFunction])),!0===a.has("EXT_texture_filter_anisotropic")){if(Gt.magFilter===qi||Gt.minFilter!==ms&&Gt.minFilter!==_e||Gt.type===dn&&!1===a.has("OES_texture_float_linear")||!1===F&&Gt.type===vn&&!1===a.has("OES_texture_half_float_linear"))return;if(Gt.anisotropy>1||d.get(Gt).__currentAnisotropy){const ji=a.get("EXT_texture_filter_anisotropic");M.texParameterf(wn,ji.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Gt.anisotropy,p.getMaxAnisotropy())),d.get(Gt).__currentAnisotropy=Gt.anisotropy}}}function Or(wn,Gt){let zi=!1;void 0===wn.__webglInit&&(wn.__webglInit=!0,Gt.addEventListener("dispose",qn));const ji=Gt.source;let Lr=Ge.get(ji);void 0===Lr&&(Lr={},Ge.set(ji,Lr));const br=function Oi(wn){const Gt=[];return Gt.push(wn.wrapS),Gt.push(wn.wrapT),Gt.push(wn.wrapR||0),Gt.push(wn.magFilter),Gt.push(wn.minFilter),Gt.push(wn.anisotropy),Gt.push(wn.internalFormat),Gt.push(wn.format),Gt.push(wn.type),Gt.push(wn.generateMipmaps),Gt.push(wn.premultiplyAlpha),Gt.push(wn.flipY),Gt.push(wn.unpackAlignment),Gt.push(wn.colorSpace),Gt.join()}(Gt);if(br!==wn.__cacheKey){void 0===Lr[br]&&(Lr[br]={texture:M.createTexture(),usedTimes:0},U.memory.textures++,zi=!0),Lr[br].usedTimes++;const ta=Lr[wn.__cacheKey];void 0!==ta&&(Lr[wn.__cacheKey].usedTimes--,0===ta.usedTimes&&En(Gt)),wn.__cacheKey=br,wn.__webglTexture=Lr[br].texture}return zi}function Ds(wn,Gt,zi){let ji=M.TEXTURE_2D;(Gt.isDataArrayTexture||Gt.isCompressedArrayTexture)&&(ji=M.TEXTURE_2D_ARRAY),Gt.isData3DTexture&&(ji=M.TEXTURE_3D);const Lr=Or(wn,Gt),br=Gt.source;c.bindTexture(ji,wn.__webglTexture,M.TEXTURE0+zi);const ta=d.get(br);if(br.version!==ta.__version||!0===Lr){c.activeTexture(M.TEXTURE0+zi);const ko=Ia.getPrimaries(Ia.workingColorSpace),Xr=""===Gt.colorSpace?null:Ia.getPrimaries(Gt.colorSpace),cs=""===Gt.colorSpace||ko===Xr?M.NONE:M.BROWSER_DEFAULT_WEBGL;M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,Gt.flipY),M.pixelStorei(M.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Gt.premultiplyAlpha),M.pixelStorei(M.UNPACK_ALIGNMENT,Gt.unpackAlignment),M.pixelStorei(M.UNPACK_COLORSPACE_CONVERSION_WEBGL,cs);const Eo=function Rt(wn){return!F&&(wn.wrapS!==ui||wn.wrapT!==ui||wn.minFilter!==qi&&wn.minFilter!==wt)}(Gt)&&!1===je(Gt.image);let Yr=Ye(Gt.image,Eo,!1,p.maxTextureSize);Yr=Zs(Gt,Yr);const _h=je(Yr)||F,Sa=S.convert(Gt.format,Gt.colorSpace);let po,So=S.convert(Gt.type),$s=Pn(Gt.internalFormat,Sa,So,Gt.colorSpace,Gt.isVideoTexture);Hi(ji,Gt,_h);const ya=Gt.mipmaps,Qo=F&&!0!==Gt.isVideoTexture&&36196!==$s,rc=void 0===ta.__version||!0===Lr,Jn=br.dataReady,gs=yn(Gt,Yr,_h);if(Gt.isDepthTexture)$s=M.DEPTH_COMPONENT,F?$s=Gt.type===dn?M.DEPTH_COMPONENT32F:Gt.type===Zt?M.DEPTH_COMPONENT24:Gt.type===$n?M.DEPTH24_STENCIL8:M.DEPTH_COMPONENT16:Gt.type===dn&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Gt.format===Ue&&$s===M.DEPTH_COMPONENT&&1012!==Gt.type&&Gt.type!==Zt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Gt.type=Zt,So=S.convert(Gt.type)),Gt.format===Y&&$s===M.DEPTH_COMPONENT&&($s=M.DEPTH_STENCIL,Gt.type!==$n&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Gt.type=$n,So=S.convert(Gt.type))),rc&&(Qo?c.texStorage2D(M.TEXTURE_2D,1,$s,Yr.width,Yr.height):c.texImage2D(M.TEXTURE_2D,0,$s,Yr.width,Yr.height,0,Sa,So,null));else if(Gt.isDataTexture)if(ya.length>0&&_h){Qo&&rc&&c.texStorage2D(M.TEXTURE_2D,gs,$s,ya[0].width,ya[0].height);for(let Bi=0,ts=ya.length;Bi<ts;Bi++)po=ya[Bi],Qo?Jn&&c.texSubImage2D(M.TEXTURE_2D,Bi,0,0,po.width,po.height,Sa,So,po.data):c.texImage2D(M.TEXTURE_2D,Bi,$s,po.width,po.height,0,Sa,So,po.data);Gt.generateMipmaps=!1}else Qo?(rc&&c.texStorage2D(M.TEXTURE_2D,gs,$s,Yr.width,Yr.height),Jn&&c.texSubImage2D(M.TEXTURE_2D,0,0,0,Yr.width,Yr.height,Sa,So,Yr.data)):c.texImage2D(M.TEXTURE_2D,0,$s,Yr.width,Yr.height,0,Sa,So,Yr.data);else if(Gt.isCompressedTexture)if(Gt.isCompressedArrayTexture){Qo&&rc&&c.texStorage3D(M.TEXTURE_2D_ARRAY,gs,$s,ya[0].width,ya[0].height,Yr.depth);for(let Bi=0,ts=ya.length;Bi<ts;Bi++)po=ya[Bi],Gt.format!==Rn?null!==Sa?Qo?Jn&&c.compressedTexSubImage3D(M.TEXTURE_2D_ARRAY,Bi,0,0,0,po.width,po.height,Yr.depth,Sa,po.data,0,0):c.compressedTexImage3D(M.TEXTURE_2D_ARRAY,Bi,$s,po.width,po.height,Yr.depth,0,po.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Qo?Jn&&c.texSubImage3D(M.TEXTURE_2D_ARRAY,Bi,0,0,0,po.width,po.height,Yr.depth,Sa,So,po.data):c.texImage3D(M.TEXTURE_2D_ARRAY,Bi,$s,po.width,po.height,Yr.depth,0,Sa,So,po.data)}else{Qo&&rc&&c.texStorage2D(M.TEXTURE_2D,gs,$s,ya[0].width,ya[0].height);for(let Bi=0,ts=ya.length;Bi<ts;Bi++)po=ya[Bi],Gt.format!==Rn?null!==Sa?Qo?Jn&&c.compressedTexSubImage2D(M.TEXTURE_2D,Bi,0,0,po.width,po.height,Sa,po.data):c.compressedTexImage2D(M.TEXTURE_2D,Bi,$s,po.width,po.height,0,po.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Qo?Jn&&c.texSubImage2D(M.TEXTURE_2D,Bi,0,0,po.width,po.height,Sa,So,po.data):c.texImage2D(M.TEXTURE_2D,Bi,$s,po.width,po.height,0,Sa,So,po.data)}else if(Gt.isDataArrayTexture)Qo?(rc&&c.texStorage3D(M.TEXTURE_2D_ARRAY,gs,$s,Yr.width,Yr.height,Yr.depth),Jn&&c.texSubImage3D(M.TEXTURE_2D_ARRAY,0,0,0,0,Yr.width,Yr.height,Yr.depth,Sa,So,Yr.data)):c.texImage3D(M.TEXTURE_2D_ARRAY,0,$s,Yr.width,Yr.height,Yr.depth,0,Sa,So,Yr.data);else if(Gt.isData3DTexture)Qo?(rc&&c.texStorage3D(M.TEXTURE_3D,gs,$s,Yr.width,Yr.height,Yr.depth),Jn&&c.texSubImage3D(M.TEXTURE_3D,0,0,0,0,Yr.width,Yr.height,Yr.depth,Sa,So,Yr.data)):c.texImage3D(M.TEXTURE_3D,0,$s,Yr.width,Yr.height,Yr.depth,0,Sa,So,Yr.data);else if(Gt.isFramebufferTexture){if(rc)if(Qo)c.texStorage2D(M.TEXTURE_2D,gs,$s,Yr.width,Yr.height);else{let Bi=Yr.width,ts=Yr.height;for(let Es=0;Es<gs;Es++)c.texImage2D(M.TEXTURE_2D,Es,$s,Bi,ts,0,Sa,So,null),Bi>>=1,ts>>=1}}else if(ya.length>0&&_h){if(Qo&&rc){const Bi=za(ya[0]);c.texStorage2D(M.TEXTURE_2D,gs,$s,Bi.width,Bi.height)}for(let Bi=0,ts=ya.length;Bi<ts;Bi++)po=ya[Bi],Qo?Jn&&c.texSubImage2D(M.TEXTURE_2D,Bi,0,0,Sa,So,po):c.texImage2D(M.TEXTURE_2D,Bi,$s,Sa,So,po);Gt.generateMipmaps=!1}else if(Qo){if(rc){const Bi=za(Yr);c.texStorage2D(M.TEXTURE_2D,gs,$s,Bi.width,Bi.height)}Jn&&c.texSubImage2D(M.TEXTURE_2D,0,0,0,Sa,So,Yr)}else c.texImage2D(M.TEXTURE_2D,0,$s,Sa,So,Yr);At(Gt,_h)&&Ht(ji),ta.__version=br.version,Gt.onUpdate&&Gt.onUpdate(Gt)}wn.__version=Gt.version}function eo(wn,Gt,zi,ji,Lr,br){const ta=S.convert(zi.format,zi.colorSpace),ko=S.convert(zi.type),Xr=Pn(zi.internalFormat,ta,ko,zi.colorSpace);if(!d.get(Gt).__hasExternalTextures){const Eo=Math.max(1,Gt.width>>br),Yr=Math.max(1,Gt.height>>br);Lr===M.TEXTURE_3D||Lr===M.TEXTURE_2D_ARRAY?c.texImage3D(Lr,br,Xr,Eo,Yr,Gt.depth,0,ta,ko,null):c.texImage2D(Lr,br,Xr,Eo,Yr,0,ta,ko,null)}c.bindFramebuffer(M.FRAMEBUFFER,wn),As(Gt)?ue.framebufferTexture2DMultisampleEXT(M.FRAMEBUFFER,ji,Lr,d.get(zi).__webglTexture,0,fr(Gt)):(Lr===M.TEXTURE_2D||Lr>=M.TEXTURE_CUBE_MAP_POSITIVE_X&&Lr<=M.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&M.framebufferTexture2D(M.FRAMEBUFFER,ji,Lr,d.get(zi).__webglTexture,br),c.bindFramebuffer(M.FRAMEBUFFER,null)}function Qs(wn,Gt,zi){if(M.bindRenderbuffer(M.RENDERBUFFER,wn),Gt.depthBuffer&&!Gt.stencilBuffer){let ji=!0===F?M.DEPTH_COMPONENT24:M.DEPTH_COMPONENT16;if(zi||As(Gt)){const Lr=Gt.depthTexture;Lr&&Lr.isDepthTexture&&(Lr.type===dn?ji=M.DEPTH_COMPONENT32F:Lr.type===Zt&&(ji=M.DEPTH_COMPONENT24));const br=fr(Gt);As(Gt)?ue.renderbufferStorageMultisampleEXT(M.RENDERBUFFER,br,ji,Gt.width,Gt.height):M.renderbufferStorageMultisample(M.RENDERBUFFER,br,ji,Gt.width,Gt.height)}else M.renderbufferStorage(M.RENDERBUFFER,ji,Gt.width,Gt.height);M.framebufferRenderbuffer(M.FRAMEBUFFER,M.DEPTH_ATTACHMENT,M.RENDERBUFFER,wn)}else if(Gt.depthBuffer&&Gt.stencilBuffer){const ji=fr(Gt);zi&&!1===As(Gt)?M.renderbufferStorageMultisample(M.RENDERBUFFER,ji,M.DEPTH24_STENCIL8,Gt.width,Gt.height):As(Gt)?ue.renderbufferStorageMultisampleEXT(M.RENDERBUFFER,ji,M.DEPTH24_STENCIL8,Gt.width,Gt.height):M.renderbufferStorage(M.RENDERBUFFER,M.DEPTH_STENCIL,Gt.width,Gt.height),M.framebufferRenderbuffer(M.FRAMEBUFFER,M.DEPTH_STENCIL_ATTACHMENT,M.RENDERBUFFER,wn)}else{const ji=Gt.textures;for(let Lr=0;Lr<ji.length;Lr++){const br=ji[Lr],ta=S.convert(br.format,br.colorSpace),ko=S.convert(br.type),Xr=Pn(br.internalFormat,ta,ko,br.colorSpace),cs=fr(Gt);zi&&!1===As(Gt)?M.renderbufferStorageMultisample(M.RENDERBUFFER,cs,Xr,Gt.width,Gt.height):As(Gt)?ue.renderbufferStorageMultisampleEXT(M.RENDERBUFFER,cs,Xr,Gt.width,Gt.height):M.renderbufferStorage(M.RENDERBUFFER,Xr,Gt.width,Gt.height)}}M.bindRenderbuffer(M.RENDERBUFFER,null)}function Ao(wn){const Gt=d.get(wn),zi=!0===wn.isWebGLCubeRenderTarget;if(wn.depthTexture&&!Gt.__autoAllocateDepthBuffer){if(zi)throw new Error("target.depthTexture not supported in Cube render targets");!function fa(wn,Gt){if(Gt&&Gt.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(c.bindFramebuffer(M.FRAMEBUFFER,wn),!Gt.depthTexture||!Gt.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!d.get(Gt.depthTexture).__webglTexture||Gt.depthTexture.image.width!==Gt.width||Gt.depthTexture.image.height!==Gt.height)&&(Gt.depthTexture.image.width=Gt.width,Gt.depthTexture.image.height=Gt.height,Gt.depthTexture.needsUpdate=!0),er(Gt.depthTexture,0);const ji=d.get(Gt.depthTexture).__webglTexture,Lr=fr(Gt);if(Gt.depthTexture.format===Ue)As(Gt)?ue.framebufferTexture2DMultisampleEXT(M.FRAMEBUFFER,M.DEPTH_ATTACHMENT,M.TEXTURE_2D,ji,0,Lr):M.framebufferTexture2D(M.FRAMEBUFFER,M.DEPTH_ATTACHMENT,M.TEXTURE_2D,ji,0);else{if(Gt.depthTexture.format!==Y)throw new Error("Unknown depthTexture format");As(Gt)?ue.framebufferTexture2DMultisampleEXT(M.FRAMEBUFFER,M.DEPTH_STENCIL_ATTACHMENT,M.TEXTURE_2D,ji,0,Lr):M.framebufferTexture2D(M.FRAMEBUFFER,M.DEPTH_STENCIL_ATTACHMENT,M.TEXTURE_2D,ji,0)}}(Gt.__webglFramebuffer,wn)}else if(zi){Gt.__webglDepthbuffer=[];for(let ji=0;ji<6;ji++)c.bindFramebuffer(M.FRAMEBUFFER,Gt.__webglFramebuffer[ji]),Gt.__webglDepthbuffer[ji]=M.createRenderbuffer(),Qs(Gt.__webglDepthbuffer[ji],wn,!1)}else c.bindFramebuffer(M.FRAMEBUFFER,Gt.__webglFramebuffer),Gt.__webglDepthbuffer=M.createRenderbuffer(),Qs(Gt.__webglDepthbuffer,wn,!1);c.bindFramebuffer(M.FRAMEBUFFER,null)}function fr(wn){return Math.min(p.maxSamples,wn.samples)}function As(wn){const Gt=d.get(wn);return F&&wn.samples>0&&!0===a.has("WEBGL_multisampled_render_to_texture")&&!1!==Gt.__useRenderToTexture}function Zs(wn,Gt){const zi=wn.colorSpace,ji=wn.format,Lr=wn.type;return!0===wn.isCompressedTexture||!0===wn.isVideoTexture||1035===wn.format||zi!==fh&&""!==zi&&(Ia.getTransfer(zi)===Ga?!1===F?!0===a.has("EXT_sRGB")&&ji===Rn?(wn.format=1035,wn.minFilter=wt,wn.generateMipmaps=!1):Gt=X0.sRGBToLinear(Gt):(ji!==Rn||Lr!==gt)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",zi)),Gt}function za(wn){return typeof HTMLImageElement<"u"&&wn instanceof HTMLImageElement?(Me.width=wn.naturalWidth||wn.width,Me.height=wn.naturalHeight||wn.height):typeof VideoFrame<"u"&&wn instanceof VideoFrame?(Me.width=wn.displayWidth,Me.height=wn.displayHeight):(Me.width=wn.width,Me.height=wn.height),Me}this.allocateTextureUnit=function Qi(){const wn=lr;return wn>=p.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+wn+" texture units while this GPU supports only "+p.maxTextures),lr+=1,wn},this.resetTextureUnits=function Yn(){lr=0},this.setTexture2D=er,this.setTexture2DArray=function Xi(wn,Gt){const zi=d.get(wn);wn.version>0&&zi.__version!==wn.version?Ds(zi,wn,Gt):c.bindTexture(M.TEXTURE_2D_ARRAY,zi.__webglTexture,M.TEXTURE0+Gt)},this.setTexture3D=function Vi(wn,Gt){const zi=d.get(wn);wn.version>0&&zi.__version!==wn.version?Ds(zi,wn,Gt):c.bindTexture(M.TEXTURE_3D,zi.__webglTexture,M.TEXTURE0+Gt)},this.setTextureCube=function Vr(wn,Gt){const zi=d.get(wn);wn.version>0&&zi.__version!==wn.version?function bo(wn,Gt,zi){if(6!==Gt.image.length)return;const ji=Or(wn,Gt),Lr=Gt.source;c.bindTexture(M.TEXTURE_CUBE_MAP,wn.__webglTexture,M.TEXTURE0+zi);const br=d.get(Lr);if(Lr.version!==br.__version||!0===ji){c.activeTexture(M.TEXTURE0+zi);const ta=Ia.getPrimaries(Ia.workingColorSpace),ko=""===Gt.colorSpace?null:Ia.getPrimaries(Gt.colorSpace),Xr=""===Gt.colorSpace||ta===ko?M.NONE:M.BROWSER_DEFAULT_WEBGL;M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,Gt.flipY),M.pixelStorei(M.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Gt.premultiplyAlpha),M.pixelStorei(M.UNPACK_ALIGNMENT,Gt.unpackAlignment),M.pixelStorei(M.UNPACK_COLORSPACE_CONVERSION_WEBGL,Xr);const cs=Gt.isCompressedTexture||Gt.image[0].isCompressedTexture,Eo=Gt.image[0]&&Gt.image[0].isDataTexture,Yr=[];for(let Bi=0;Bi<6;Bi++)Yr[Bi]=cs||Eo?Eo?Gt.image[Bi].image:Gt.image[Bi]:Ye(Gt.image[Bi],!1,!0,p.maxCubemapSize),Yr[Bi]=Zs(Gt,Yr[Bi]);const _h=Yr[0],Sa=je(_h)||F,So=S.convert(Gt.format,Gt.colorSpace),$s=S.convert(Gt.type),po=Pn(Gt.internalFormat,So,$s,Gt.colorSpace),ya=F&&!0!==Gt.isVideoTexture,Qo=void 0===br.__version||!0===ji,rc=Lr.dataReady;let gs,Jn=yn(Gt,_h,Sa);if(Hi(M.TEXTURE_CUBE_MAP,Gt,Sa),cs){ya&&Qo&&c.texStorage2D(M.TEXTURE_CUBE_MAP,Jn,po,_h.width,_h.height);for(let Bi=0;Bi<6;Bi++){gs=Yr[Bi].mipmaps;for(let ts=0;ts<gs.length;ts++){const Es=gs[ts];Gt.format!==Rn?null!==So?ya?rc&&c.compressedTexSubImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Bi,ts,0,0,Es.width,Es.height,So,Es.data):c.compressedTexImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Bi,ts,po,Es.width,Es.height,0,Es.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ya?rc&&c.texSubImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Bi,ts,0,0,Es.width,Es.height,So,$s,Es.data):c.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Bi,ts,po,Es.width,Es.height,0,So,$s,Es.data)}}}else{if(gs=Gt.mipmaps,ya&&Qo){gs.length>0&&Jn++;const Bi=za(Yr[0]);c.texStorage2D(M.TEXTURE_CUBE_MAP,Jn,po,Bi.width,Bi.height)}for(let Bi=0;Bi<6;Bi++)if(Eo){ya?rc&&c.texSubImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Bi,0,0,0,Yr[Bi].width,Yr[Bi].height,So,$s,Yr[Bi].data):c.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Bi,0,po,Yr[Bi].width,Yr[Bi].height,0,So,$s,Yr[Bi].data);for(let ts=0;ts<gs.length;ts++){const Qa=gs[ts].image[Bi].image;ya?rc&&c.texSubImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Bi,ts+1,0,0,Qa.width,Qa.height,So,$s,Qa.data):c.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Bi,ts+1,po,Qa.width,Qa.height,0,So,$s,Qa.data)}}else{ya?rc&&c.texSubImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Bi,0,0,0,So,$s,Yr[Bi]):c.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Bi,0,po,So,$s,Yr[Bi]);for(let ts=0;ts<gs.length;ts++){const Es=gs[ts];ya?rc&&c.texSubImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Bi,ts+1,0,0,So,$s,Es.image[Bi]):c.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+Bi,ts+1,po,So,$s,Es.image[Bi])}}}At(Gt,Sa)&&Ht(M.TEXTURE_CUBE_MAP),br.__version=Lr.version,Gt.onUpdate&&Gt.onUpdate(Gt)}wn.__version=Gt.version}(zi,wn,Gt):c.bindTexture(M.TEXTURE_CUBE_MAP,zi.__webglTexture,M.TEXTURE0+Gt)},this.rebindTextures=function On(wn,Gt,zi){const ji=d.get(wn);void 0!==Gt&&eo(ji.__webglFramebuffer,wn,wn.texture,M.COLOR_ATTACHMENT0,M.TEXTURE_2D,0),void 0!==zi&&Ao(wn)},this.setupRenderTarget=function Zr(wn){const Gt=wn.texture,zi=d.get(wn),ji=d.get(Gt);wn.addEventListener("dispose",wi);const Lr=wn.textures,br=!0===wn.isWebGLCubeRenderTarget,ta=Lr.length>1,ko=je(wn)||F;if(ta||(void 0===ji.__webglTexture&&(ji.__webglTexture=M.createTexture()),ji.__version=Gt.version,U.memory.textures++),br){zi.__webglFramebuffer=[];for(let Xr=0;Xr<6;Xr++)if(F&&Gt.mipmaps&&Gt.mipmaps.length>0){zi.__webglFramebuffer[Xr]=[];for(let cs=0;cs<Gt.mipmaps.length;cs++)zi.__webglFramebuffer[Xr][cs]=M.createFramebuffer()}else zi.__webglFramebuffer[Xr]=M.createFramebuffer()}else{if(F&&Gt.mipmaps&&Gt.mipmaps.length>0){zi.__webglFramebuffer=[];for(let Xr=0;Xr<Gt.mipmaps.length;Xr++)zi.__webglFramebuffer[Xr]=M.createFramebuffer()}else zi.__webglFramebuffer=M.createFramebuffer();if(ta)if(p.drawBuffers)for(let Xr=0,cs=Lr.length;Xr<cs;Xr++){const Eo=d.get(Lr[Xr]);void 0===Eo.__webglTexture&&(Eo.__webglTexture=M.createTexture(),U.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(F&&wn.samples>0&&!1===As(wn)){zi.__webglMultisampledFramebuffer=M.createFramebuffer(),zi.__webglColorRenderbuffer=[],c.bindFramebuffer(M.FRAMEBUFFER,zi.__webglMultisampledFramebuffer);for(let Xr=0;Xr<Lr.length;Xr++){const cs=Lr[Xr];zi.__webglColorRenderbuffer[Xr]=M.createRenderbuffer(),M.bindRenderbuffer(M.RENDERBUFFER,zi.__webglColorRenderbuffer[Xr]);const Eo=S.convert(cs.format,cs.colorSpace),Yr=S.convert(cs.type),_h=Pn(cs.internalFormat,Eo,Yr,cs.colorSpace,!0===wn.isXRRenderTarget),Sa=fr(wn);M.renderbufferStorageMultisample(M.RENDERBUFFER,Sa,_h,wn.width,wn.height),M.framebufferRenderbuffer(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0+Xr,M.RENDERBUFFER,zi.__webglColorRenderbuffer[Xr])}M.bindRenderbuffer(M.RENDERBUFFER,null),wn.depthBuffer&&(zi.__webglDepthRenderbuffer=M.createRenderbuffer(),Qs(zi.__webglDepthRenderbuffer,wn,!0)),c.bindFramebuffer(M.FRAMEBUFFER,null)}}if(br){c.bindTexture(M.TEXTURE_CUBE_MAP,ji.__webglTexture),Hi(M.TEXTURE_CUBE_MAP,Gt,ko);for(let Xr=0;Xr<6;Xr++)if(F&&Gt.mipmaps&&Gt.mipmaps.length>0)for(let cs=0;cs<Gt.mipmaps.length;cs++)eo(zi.__webglFramebuffer[Xr][cs],wn,Gt,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,cs);else eo(zi.__webglFramebuffer[Xr],wn,Gt,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,0);At(Gt,ko)&&Ht(M.TEXTURE_CUBE_MAP),c.unbindTexture()}else if(ta){for(let Xr=0,cs=Lr.length;Xr<cs;Xr++){const Eo=Lr[Xr],Yr=d.get(Eo);c.bindTexture(M.TEXTURE_2D,Yr.__webglTexture),Hi(M.TEXTURE_2D,Eo,ko),eo(zi.__webglFramebuffer,wn,Eo,M.COLOR_ATTACHMENT0+Xr,M.TEXTURE_2D,0),At(Eo,ko)&&Ht(M.TEXTURE_2D)}c.unbindTexture()}else{let Xr=M.TEXTURE_2D;if((wn.isWebGL3DRenderTarget||wn.isWebGLArrayRenderTarget)&&(F?Xr=wn.isWebGL3DRenderTarget?M.TEXTURE_3D:M.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),c.bindTexture(Xr,ji.__webglTexture),Hi(Xr,Gt,ko),F&&Gt.mipmaps&&Gt.mipmaps.length>0)for(let cs=0;cs<Gt.mipmaps.length;cs++)eo(zi.__webglFramebuffer[cs],wn,Gt,M.COLOR_ATTACHMENT0,Xr,cs);else eo(zi.__webglFramebuffer,wn,Gt,M.COLOR_ATTACHMENT0,Xr,0);At(Gt,ko)&&Ht(Xr),c.unbindTexture()}wn.depthBuffer&&Ao(wn)},this.updateRenderTargetMipmap=function Zi(wn){const Gt=je(wn)||F,zi=wn.textures;for(let ji=0,Lr=zi.length;ji<Lr;ji++){const br=zi[ji];if(At(br,Gt)){const ta=wn.isWebGLCubeRenderTarget?M.TEXTURE_CUBE_MAP:M.TEXTURE_2D,ko=d.get(br).__webglTexture;c.bindTexture(ta,ko),Ht(ta),c.unbindTexture()}}},this.updateMultisampleRenderTarget=function $r(wn){if(F&&wn.samples>0&&!1===As(wn)){const Gt=wn.textures,zi=wn.width,ji=wn.height;let Lr=M.COLOR_BUFFER_BIT;const br=[],ta=wn.stencilBuffer?M.DEPTH_STENCIL_ATTACHMENT:M.DEPTH_ATTACHMENT,ko=d.get(wn),Xr=Gt.length>1;if(Xr)for(let cs=0;cs<Gt.length;cs++)c.bindFramebuffer(M.FRAMEBUFFER,ko.__webglMultisampledFramebuffer),M.framebufferRenderbuffer(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0+cs,M.RENDERBUFFER,null),c.bindFramebuffer(M.FRAMEBUFFER,ko.__webglFramebuffer),M.framebufferTexture2D(M.DRAW_FRAMEBUFFER,M.COLOR_ATTACHMENT0+cs,M.TEXTURE_2D,null,0);c.bindFramebuffer(M.READ_FRAMEBUFFER,ko.__webglMultisampledFramebuffer),c.bindFramebuffer(M.DRAW_FRAMEBUFFER,ko.__webglFramebuffer);for(let cs=0;cs<Gt.length;cs++){br.push(M.COLOR_ATTACHMENT0+cs),wn.depthBuffer&&br.push(ta);const Eo=void 0!==ko.__ignoreDepthValues&&ko.__ignoreDepthValues;if(!1===Eo&&(wn.depthBuffer&&(Lr|=M.DEPTH_BUFFER_BIT),wn.stencilBuffer&&(Lr|=M.STENCIL_BUFFER_BIT)),Xr&&M.framebufferRenderbuffer(M.READ_FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.RENDERBUFFER,ko.__webglColorRenderbuffer[cs]),!0===Eo&&(M.invalidateFramebuffer(M.READ_FRAMEBUFFER,[ta]),M.invalidateFramebuffer(M.DRAW_FRAMEBUFFER,[ta])),Xr){const Yr=d.get(Gt[cs]).__webglTexture;M.framebufferTexture2D(M.DRAW_FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_2D,Yr,0)}M.blitFramebuffer(0,0,zi,ji,0,0,zi,ji,Lr,M.NEAREST),Q&&M.invalidateFramebuffer(M.READ_FRAMEBUFFER,br)}if(c.bindFramebuffer(M.READ_FRAMEBUFFER,null),c.bindFramebuffer(M.DRAW_FRAMEBUFFER,null),Xr)for(let cs=0;cs<Gt.length;cs++){c.bindFramebuffer(M.FRAMEBUFFER,ko.__webglMultisampledFramebuffer),M.framebufferRenderbuffer(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0+cs,M.RENDERBUFFER,ko.__webglColorRenderbuffer[cs]);const Eo=d.get(Gt[cs]).__webglTexture;c.bindFramebuffer(M.FRAMEBUFFER,ko.__webglFramebuffer),M.framebufferTexture2D(M.DRAW_FRAMEBUFFER,M.COLOR_ATTACHMENT0+cs,M.TEXTURE_2D,Eo,0)}c.bindFramebuffer(M.DRAW_FRAMEBUFFER,ko.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=Ao,this.setupFrameBufferTexture=eo,this.useMultisampledRTT=As}function kM(M,a,c){const d=c.isWebGL2;return{convert:function p(S,U=""){let F;const ue=Ia.getTransfer(U);if(S===gt)return M.UNSIGNED_BYTE;if(1017===S)return M.UNSIGNED_SHORT_4_4_4_4;if(1018===S)return M.UNSIGNED_SHORT_5_5_5_1;if(1010===S)return M.BYTE;if(1011===S)return M.SHORT;if(1012===S)return M.UNSIGNED_SHORT;if(1013===S)return M.INT;if(S===Zt)return M.UNSIGNED_INT;if(S===dn)return M.FLOAT;if(S===vn)return d?M.HALF_FLOAT:(F=a.get("OES_texture_half_float"),null!==F?F.HALF_FLOAT_OES:null);if(1021===S)return M.ALPHA;if(S===Rn)return M.RGBA;if(1024===S)return M.LUMINANCE;if(1025===S)return M.LUMINANCE_ALPHA;if(S===Ue)return M.DEPTH_COMPONENT;if(S===Y)return M.DEPTH_STENCIL;if(1035===S)return F=a.get("EXT_sRGB"),null!==F?F.SRGB_ALPHA_EXT:null;if(1028===S)return M.RED;if(1029===S)return M.RED_INTEGER;if(1030===S)return M.RG;if(1031===S)return M.RG_INTEGER;if(1033===S)return M.RGBA_INTEGER;if(33776===S||33777===S||33778===S||33779===S)if(ue===Ga){if(F=a.get("WEBGL_compressed_texture_s3tc_srgb"),null===F)return null;if(33776===S)return F.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===S)return F.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===S)return F.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===S)return F.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(F=a.get("WEBGL_compressed_texture_s3tc"),null===F)return null;if(33776===S)return F.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===S)return F.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===S)return F.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===S)return F.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===S||35841===S||35842===S||35843===S){if(F=a.get("WEBGL_compressed_texture_pvrtc"),null===F)return null;if(35840===S)return F.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===S)return F.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===S)return F.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===S)return F.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===S)return F=a.get("WEBGL_compressed_texture_etc1"),null!==F?F.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===S||37496===S){if(F=a.get("WEBGL_compressed_texture_etc"),null===F)return null;if(37492===S)return ue===Ga?F.COMPRESSED_SRGB8_ETC2:F.COMPRESSED_RGB8_ETC2;if(37496===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:F.COMPRESSED_RGBA8_ETC2_EAC}if(37808===S||37809===S||37810===S||37811===S||37812===S||37813===S||37814===S||37815===S||37816===S||37817===S||37818===S||37819===S||37820===S||37821===S){if(F=a.get("WEBGL_compressed_texture_astc"),null===F)return null;if(37808===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:F.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:F.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:F.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:F.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:F.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:F.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:F.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:F.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:F.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:F.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:F.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:F.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:F.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===S)return ue===Ga?F.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:F.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===S||36494===S||36495===S){if(F=a.get("EXT_texture_compression_bptc"),null===F)return null;if(36492===S)return ue===Ga?F.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:F.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===S)return F.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===S)return F.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===S||36284===S||36285===S||36286===S){if(F=a.get("EXT_texture_compression_rgtc"),null===F)return null;if(36492===S)return F.COMPRESSED_RED_RGTC1_EXT;if(36284===S)return F.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===S)return F.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===S)return F.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return S===$n?d?M.UNSIGNED_INT_24_8:(F=a.get("WEBGL_depth_texture"),null!==F?F.UNSIGNED_INT_24_8_WEBGL:null):void 0!==M[S]?M[S]:null}}}class GP extends gi{constructor(a=[]){super(),this.isArrayCamera=!0,this.cameras=a}}class r1 extends Vl{constructor(){super(),this.isGroup=!0,this.type="Group"}}const r3={type:"move"};class FM{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new r1,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new r1,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Mn,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Mn),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new r1,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Mn,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Mn),this._grip}dispatchEvent(a){return null!==this._targetRay&&this._targetRay.dispatchEvent(a),null!==this._grip&&this._grip.dispatchEvent(a),null!==this._hand&&this._hand.dispatchEvent(a),this}connect(a){if(a&&a.hand){const c=this._hand;if(c)for(const d of a.hand.values())this._getHandJoint(c,d)}return this.dispatchEvent({type:"connected",data:a}),this}disconnect(a){return this.dispatchEvent({type:"disconnected",data:a}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(a,c,d){let p=null,S=null,U=null;const F=this._targetRay,ue=this._grip,Q=this._hand;if(a&&"visible-blurred"!==c.session.visibilityState){if(Q&&a.hand){U=!0;for(const vt of a.hand.values()){const Ye=c.getJointPose(vt,d),je=this._getHandJoint(Q,vt);null!==Ye&&(je.matrix.fromArray(Ye.transform.matrix),je.matrix.decompose(je.position,je.rotation,je.scale),je.matrixWorldNeedsUpdate=!0,je.jointRadius=Ye.radius),je.visible=null!==Ye}const Oe=Q.joints["index-finger-tip"].position.distanceTo(Q.joints["thumb-tip"].position),Ge=.02,et=.005;Q.inputState.pinching&&Oe>Ge+et?(Q.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:a.handedness,target:this})):!Q.inputState.pinching&&Oe<=Ge-et&&(Q.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:a.handedness,target:this}))}else null!==ue&&a.gripSpace&&(S=c.getPose(a.gripSpace,d),null!==S&&(ue.matrix.fromArray(S.transform.matrix),ue.matrix.decompose(ue.position,ue.rotation,ue.scale),ue.matrixWorldNeedsUpdate=!0,S.linearVelocity?(ue.hasLinearVelocity=!0,ue.linearVelocity.copy(S.linearVelocity)):ue.hasLinearVelocity=!1,S.angularVelocity?(ue.hasAngularVelocity=!0,ue.angularVelocity.copy(S.angularVelocity)):ue.hasAngularVelocity=!1));null!==F&&(p=c.getPose(a.targetRaySpace,d),null===p&&null!==S&&(p=S),null!==p&&(F.matrix.fromArray(p.transform.matrix),F.matrix.decompose(F.position,F.rotation,F.scale),F.matrixWorldNeedsUpdate=!0,p.linearVelocity?(F.hasLinearVelocity=!0,F.linearVelocity.copy(p.linearVelocity)):F.hasLinearVelocity=!1,p.angularVelocity?(F.hasAngularVelocity=!0,F.angularVelocity.copy(p.angularVelocity)):F.hasAngularVelocity=!1,this.dispatchEvent(r3)))}return null!==F&&(F.visible=null!==p),null!==ue&&(ue.visible=null!==S),null!==Q&&(Q.visible=null!==U),this}_getHandJoint(a,c){if(void 0===a.joints[c.jointName]){const d=new r1;d.matrixAutoUpdate=!1,d.visible=!1,a.joints[c.jointName]=d,a.add(d)}return a.joints[c.jointName]}}class s3{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(a,c,d){if(null===this.texture){const p=new _u;a.properties.get(p).__webglTexture=c.texture,(c.depthNear!=d.depthNear||c.depthFar!=d.depthFar)&&(this.depthNear=c.depthNear,this.depthFar=c.depthFar),this.texture=p}}render(a,c){if(null!==this.texture){if(null===this.mesh){const d=c.cameras[0].viewport,p=new jc({extensions:{fragDepth:!0},vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:d.z},depthHeight:{value:d.w}}});this.mesh=new Jl(new Bh(20,20),p)}a.render(this.mesh,c)}}reset(){this.texture=null,this.mesh=null}}class u8 extends Ca{constructor(a,c){super();const d=this;let p=null,S=1,U=null,F="local-floor",ue=1,Q=null,Me=null,ke=null,Oe=null,Ge=null,et=null;const vt=new s3,Ye=c.getContextAttributes();let je=null,Rt=null;const At=[],Ht=[],Pn=new Ki;let yn=null;const xn=new gi;xn.layers.enable(1),xn.viewport=new Ya;const qn=new gi;qn.layers.enable(2),qn.viewport=new Ya;const wi=[xn,qn],Ut=new GP;Ut.layers.enable(1),Ut.layers.enable(2);let En=null,rr=null;function lr(Hi){const Or=Ht.indexOf(Hi.inputSource);if(-1===Or)return;const Ds=At[Or];void 0!==Ds&&(Ds.update(Hi.inputSource,Hi.frame,Q||U),Ds.dispatchEvent({type:Hi.type,data:Hi.inputSource}))}function Yn(){p.removeEventListener("select",lr),p.removeEventListener("selectstart",lr),p.removeEventListener("selectend",lr),p.removeEventListener("squeeze",lr),p.removeEventListener("squeezestart",lr),p.removeEventListener("squeezeend",lr),p.removeEventListener("end",Yn),p.removeEventListener("inputsourceschange",Qi);for(let Hi=0;Hi<At.length;Hi++){const Or=Ht[Hi];null!==Or&&(Ht[Hi]=null,At[Hi].disconnect(Or))}En=null,rr=null,vt.reset(),a.setRenderTarget(je),Ge=null,Oe=null,ke=null,p=null,Rt=null,Yo.stop(),d.isPresenting=!1,a.setPixelRatio(yn),a.setSize(Pn.width,Pn.height,!1),d.dispatchEvent({type:"sessionend"})}function Qi(Hi){for(let Or=0;Or<Hi.removed.length;Or++){const Ds=Hi.removed[Or],bo=Ht.indexOf(Ds);bo>=0&&(Ht[bo]=null,At[bo].disconnect(Ds))}for(let Or=0;Or<Hi.added.length;Or++){const Ds=Hi.added[Or];let bo=Ht.indexOf(Ds);if(-1===bo){for(let Qs=0;Qs<At.length;Qs++){if(Qs>=Ht.length){Ht.push(Ds),bo=Qs;break}if(null===Ht[Qs]){Ht[Qs]=Ds,bo=Qs;break}}if(-1===bo)break}const eo=At[bo];eo&&eo.connect(Ds)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Hi){let Or=At[Hi];return void 0===Or&&(Or=new FM,At[Hi]=Or),Or.getTargetRaySpace()},this.getControllerGrip=function(Hi){let Or=At[Hi];return void 0===Or&&(Or=new FM,At[Hi]=Or),Or.getGripSpace()},this.getHand=function(Hi){let Or=At[Hi];return void 0===Or&&(Or=new FM,At[Hi]=Or),Or.getHandSpace()},this.setFramebufferScaleFactor=function(Hi){S=Hi,!0===d.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Hi){F=Hi,!0===d.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return Q||U},this.setReferenceSpace=function(Hi){Q=Hi},this.getBaseLayer=function(){return null!==Oe?Oe:Ge},this.getBinding=function(){return ke},this.getFrame=function(){return et},this.getSession=function(){return p},this.setSession=function(){var Hi=(0,be.A)(function*(Or){if(p=Or,null!==p){if(je=a.getRenderTarget(),p.addEventListener("select",lr),p.addEventListener("selectstart",lr),p.addEventListener("selectend",lr),p.addEventListener("squeeze",lr),p.addEventListener("squeezestart",lr),p.addEventListener("squeezeend",lr),p.addEventListener("end",Yn),p.addEventListener("inputsourceschange",Qi),!0!==Ye.xrCompatible&&(yield c.makeXRCompatible()),yn=a.getPixelRatio(),a.getSize(Pn),void 0===p.renderState.layers||!1===a.capabilities.isWebGL2)Ge=new XRWebGLLayer(p,c,{antialias:void 0!==p.renderState.layers||Ye.antialias,alpha:!0,depth:Ye.depth,stencil:Ye.stencil,framebufferScaleFactor:S}),p.updateRenderState({baseLayer:Ge}),a.setPixelRatio(1),a.setSize(Ge.framebufferWidth,Ge.framebufferHeight,!1),Rt=new Hl(Ge.framebufferWidth,Ge.framebufferHeight,{format:Rn,type:gt,colorSpace:a.outputColorSpace,stencilBuffer:Ye.stencil});else{let Ds=null,bo=null,eo=null;Ye.depth&&(eo=Ye.stencil?c.DEPTH24_STENCIL8:c.DEPTH_COMPONENT24,Ds=Ye.stencil?Y:Ue,bo=Ye.stencil?$n:Zt);const Qs={colorFormat:c.RGBA8,depthFormat:eo,scaleFactor:S};ke=new XRWebGLBinding(p,c),Oe=ke.createProjectionLayer(Qs),p.updateRenderState({layers:[Oe]}),a.setPixelRatio(1),a.setSize(Oe.textureWidth,Oe.textureHeight,!1),Rt=new Hl(Oe.textureWidth,Oe.textureHeight,{format:Rn,type:gt,depthTexture:new Cr(Oe.textureWidth,Oe.textureHeight,bo,void 0,void 0,void 0,void 0,void 0,void 0,Ds),stencilBuffer:Ye.stencil,colorSpace:a.outputColorSpace,samples:Ye.antialias?4:0}),a.properties.get(Rt).__ignoreDepthValues=Oe.ignoreDepthValues}Rt.isXRRenderTarget=!0,this.setFoveation(ue),Q=null,U=yield p.requestReferenceSpace(F),Yo.setContext(p),Yo.start(),d.isPresenting=!0,d.dispatchEvent({type:"sessionstart"})}});return function(Or){return Hi.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==p)return p.environmentBlendMode};const Oi=new Mn,er=new Mn;function Vi(Hi,Or){null===Or?Hi.matrixWorld.copy(Hi.matrix):Hi.matrixWorld.multiplyMatrices(Or.matrixWorld,Hi.matrix),Hi.matrixWorldInverse.copy(Hi.matrixWorld).invert()}this.updateCamera=function(Hi){if(null===p)return;null!==vt.texture&&(Hi.near=vt.depthNear,Hi.far=vt.depthFar),Ut.near=qn.near=xn.near=Hi.near,Ut.far=qn.far=xn.far=Hi.far,(En!==Ut.near||rr!==Ut.far)&&(p.updateRenderState({depthNear:Ut.near,depthFar:Ut.far}),En=Ut.near,rr=Ut.far,xn.near=En,xn.far=rr,qn.near=En,qn.far=rr,xn.updateProjectionMatrix(),qn.updateProjectionMatrix(),Hi.updateProjectionMatrix());const Or=Hi.parent,Ds=Ut.cameras;Vi(Ut,Or);for(let bo=0;bo<Ds.length;bo++)Vi(Ds[bo],Or);2===Ds.length?function Xi(Hi,Or,Ds){Oi.setFromMatrixPosition(Or.matrixWorld),er.setFromMatrixPosition(Ds.matrixWorld);const bo=Oi.distanceTo(er),eo=Or.projectionMatrix.elements,Qs=Ds.projectionMatrix.elements,fa=eo[14]/(eo[10]-1),Ao=eo[14]/(eo[10]+1),On=(eo[9]+1)/eo[5],Zr=(eo[9]-1)/eo[5],Zi=(eo[8]-1)/eo[0],$r=(Qs[8]+1)/Qs[0],fr=fa*Zi,As=fa*$r,Ms=bo/(-Zi+$r),Zs=Ms*-Zi;Or.matrixWorld.decompose(Hi.position,Hi.quaternion,Hi.scale),Hi.translateX(Zs),Hi.translateZ(Ms),Hi.matrixWorld.compose(Hi.position,Hi.quaternion,Hi.scale),Hi.matrixWorldInverse.copy(Hi.matrixWorld).invert();const za=fa+Ms,wn=Ao+Ms;Hi.projectionMatrix.makePerspective(fr-Zs,As+(bo-Zs),On*Ao/wn*za,Zr*Ao/wn*za,za,wn),Hi.projectionMatrixInverse.copy(Hi.projectionMatrix).invert()}(Ut,xn,qn):Ut.projectionMatrix.copy(xn.projectionMatrix),function Vr(Hi,Or,Ds){null===Ds?Hi.matrix.copy(Or.matrixWorld):(Hi.matrix.copy(Ds.matrixWorld),Hi.matrix.invert(),Hi.matrix.multiply(Or.matrixWorld)),Hi.matrix.decompose(Hi.position,Hi.quaternion,Hi.scale),Hi.updateMatrixWorld(!0),Hi.projectionMatrix.copy(Or.projectionMatrix),Hi.projectionMatrixInverse.copy(Or.projectionMatrixInverse),Hi.isPerspectiveCamera&&(Hi.fov=2*ju*Math.atan(1/Hi.projectionMatrix.elements[5]),Hi.zoom=1)}(Hi,Ut,Or)},this.getCamera=function(){return Ut},this.getFoveation=function(){if(null!==Oe||null!==Ge)return ue},this.setFoveation=function(Hi){ue=Hi,null!==Oe&&(Oe.fixedFoveation=Hi),null!==Ge&&void 0!==Ge.fixedFoveation&&(Ge.fixedFoveation=Hi)},this.hasDepthSensing=function(){return null!==vt.texture};let Hr=null;const Yo=new zm;Yo.setAnimationLoop(function Ns(Hi,Or){if(Me=Or.getViewerPose(Q||U),et=Or,null!==Me){const Ds=Me.views;null!==Ge&&(a.setRenderTargetFramebuffer(Rt,Ge.framebuffer),a.setRenderTarget(Rt));let bo=!1;Ds.length!==Ut.cameras.length&&(Ut.cameras.length=0,bo=!0);for(let Qs=0;Qs<Ds.length;Qs++){const fa=Ds[Qs];let Ao=null;if(null!==Ge)Ao=Ge.getViewport(fa);else{const Zr=ke.getViewSubImage(Oe,fa);Ao=Zr.viewport,0===Qs&&(a.setRenderTargetTextures(Rt,Zr.colorTexture,Oe.ignoreDepthValues?void 0:Zr.depthStencilTexture),a.setRenderTarget(Rt))}let On=wi[Qs];void 0===On&&(On=new gi,On.layers.enable(Qs),On.viewport=new Ya,wi[Qs]=On),On.matrix.fromArray(fa.transform.matrix),On.matrix.decompose(On.position,On.quaternion,On.scale),On.projectionMatrix.fromArray(fa.projectionMatrix),On.projectionMatrixInverse.copy(On.projectionMatrix).invert(),On.viewport.set(Ao.x,Ao.y,Ao.width,Ao.height),0===Qs&&(Ut.matrix.copy(On.matrix),Ut.matrix.decompose(Ut.position,Ut.quaternion,Ut.scale)),!0===bo&&Ut.cameras.push(On)}const eo=p.enabledFeatures;if(eo&&eo.includes("depth-sensing")){const Qs=ke.getDepthInformation(Ds[0]);Qs&&Qs.isValid&&Qs.texture&&vt.init(a,Qs,p.renderState)}}for(let Ds=0;Ds<At.length;Ds++){const bo=Ht[Ds],eo=At[Ds];null!==bo&&void 0!==eo&&eo.update(bo,Or,Q||U)}vt.render(a,Ut),Hr&&Hr(Hi,Or),Or.detectedPlanes&&d.dispatchEvent({type:"planesdetected",data:Or}),et=null}),this.setAnimationLoop=function(Hi){Hr=Hi},this.dispose=function(){}}}const s1=new kc,d8=new mo;function f8(M,a){function c(Ye,je){!0===Ye.matrixAutoUpdate&&Ye.updateMatrix(),je.value.copy(Ye.matrix)}function S(Ye,je){Ye.opacity.value=je.opacity,je.color&&Ye.diffuse.value.copy(je.color),je.emissive&&Ye.emissive.value.copy(je.emissive).multiplyScalar(je.emissiveIntensity),je.map&&(Ye.map.value=je.map,c(je.map,Ye.mapTransform)),je.alphaMap&&(Ye.alphaMap.value=je.alphaMap,c(je.alphaMap,Ye.alphaMapTransform)),je.bumpMap&&(Ye.bumpMap.value=je.bumpMap,c(je.bumpMap,Ye.bumpMapTransform),Ye.bumpScale.value=je.bumpScale,1===je.side&&(Ye.bumpScale.value*=-1)),je.normalMap&&(Ye.normalMap.value=je.normalMap,c(je.normalMap,Ye.normalMapTransform),Ye.normalScale.value.copy(je.normalScale),1===je.side&&Ye.normalScale.value.negate()),je.displacementMap&&(Ye.displacementMap.value=je.displacementMap,c(je.displacementMap,Ye.displacementMapTransform),Ye.displacementScale.value=je.displacementScale,Ye.displacementBias.value=je.displacementBias),je.emissiveMap&&(Ye.emissiveMap.value=je.emissiveMap,c(je.emissiveMap,Ye.emissiveMapTransform)),je.specularMap&&(Ye.specularMap.value=je.specularMap,c(je.specularMap,Ye.specularMapTransform)),je.alphaTest>0&&(Ye.alphaTest.value=je.alphaTest);const Rt=a.get(je),At=Rt.envMap,Ht=Rt.envMapRotation;if(At&&(Ye.envMap.value=At,s1.copy(Ht),s1.x*=-1,s1.y*=-1,s1.z*=-1,At.isCubeTexture&&!1===At.isRenderTargetTexture&&(s1.y*=-1,s1.z*=-1),Ye.envMapRotation.value.setFromMatrix4(d8.makeRotationFromEuler(s1)),Ye.flipEnvMap.value=At.isCubeTexture&&!1===At.isRenderTargetTexture?-1:1,Ye.reflectivity.value=je.reflectivity,Ye.ior.value=je.ior,Ye.refractionRatio.value=je.refractionRatio),je.lightMap){Ye.lightMap.value=je.lightMap;const Pn=!0===M._useLegacyLights?Math.PI:1;Ye.lightMapIntensity.value=je.lightMapIntensity*Pn,c(je.lightMap,Ye.lightMapTransform)}je.aoMap&&(Ye.aoMap.value=je.aoMap,Ye.aoMapIntensity.value=je.aoMapIntensity,c(je.aoMap,Ye.aoMapTransform))}return{refreshFogUniforms:function d(Ye,je){je.color.getRGB(Ye.fogColor.value,jp(M)),je.isFog?(Ye.fogNear.value=je.near,Ye.fogFar.value=je.far):je.isFogExp2&&(Ye.fogDensity.value=je.density)},refreshMaterialUniforms:function p(Ye,je,Rt,At,Ht){je.isMeshBasicMaterial||je.isMeshLambertMaterial?S(Ye,je):je.isMeshToonMaterial?(S(Ye,je),function ke(Ye,je){je.gradientMap&&(Ye.gradientMap.value=je.gradientMap)}(Ye,je)):je.isMeshPhongMaterial?(S(Ye,je),function Me(Ye,je){Ye.specular.value.copy(je.specular),Ye.shininess.value=Math.max(je.shininess,1e-4)}(Ye,je)):je.isMeshStandardMaterial?(S(Ye,je),function Oe(Ye,je){Ye.metalness.value=je.metalness,je.metalnessMap&&(Ye.metalnessMap.value=je.metalnessMap,c(je.metalnessMap,Ye.metalnessMapTransform)),Ye.roughness.value=je.roughness,je.roughnessMap&&(Ye.roughnessMap.value=je.roughnessMap,c(je.roughnessMap,Ye.roughnessMapTransform)),a.get(je).envMap&&(Ye.envMapIntensity.value=je.envMapIntensity)}(Ye,je),je.isMeshPhysicalMaterial&&function Ge(Ye,je,Rt){Ye.ior.value=je.ior,je.sheen>0&&(Ye.sheenColor.value.copy(je.sheenColor).multiplyScalar(je.sheen),Ye.sheenRoughness.value=je.sheenRoughness,je.sheenColorMap&&(Ye.sheenColorMap.value=je.sheenColorMap,c(je.sheenColorMap,Ye.sheenColorMapTransform)),je.sheenRoughnessMap&&(Ye.sheenRoughnessMap.value=je.sheenRoughnessMap,c(je.sheenRoughnessMap,Ye.sheenRoughnessMapTransform))),je.clearcoat>0&&(Ye.clearcoat.value=je.clearcoat,Ye.clearcoatRoughness.value=je.clearcoatRoughness,je.clearcoatMap&&(Ye.clearcoatMap.value=je.clearcoatMap,c(je.clearcoatMap,Ye.clearcoatMapTransform)),je.clearcoatRoughnessMap&&(Ye.clearcoatRoughnessMap.value=je.clearcoatRoughnessMap,c(je.clearcoatRoughnessMap,Ye.clearcoatRoughnessMapTransform)),je.clearcoatNormalMap&&(Ye.clearcoatNormalMap.value=je.clearcoatNormalMap,c(je.clearcoatNormalMap,Ye.clearcoatNormalMapTransform),Ye.clearcoatNormalScale.value.copy(je.clearcoatNormalScale),1===je.side&&Ye.clearcoatNormalScale.value.negate())),je.iridescence>0&&(Ye.iridescence.value=je.iridescence,Ye.iridescenceIOR.value=je.iridescenceIOR,Ye.iridescenceThicknessMinimum.value=je.iridescenceThicknessRange[0],Ye.iridescenceThicknessMaximum.value=je.iridescenceThicknessRange[1],je.iridescenceMap&&(Ye.iridescenceMap.value=je.iridescenceMap,c(je.iridescenceMap,Ye.iridescenceMapTransform)),je.iridescenceThicknessMap&&(Ye.iridescenceThicknessMap.value=je.iridescenceThicknessMap,c(je.iridescenceThicknessMap,Ye.iridescenceThicknessMapTransform))),je.transmission>0&&(Ye.transmission.value=je.transmission,Ye.transmissionSamplerMap.value=Rt.texture,Ye.transmissionSamplerSize.value.set(Rt.width,Rt.height),je.transmissionMap&&(Ye.transmissionMap.value=je.transmissionMap,c(je.transmissionMap,Ye.transmissionMapTransform)),Ye.thickness.value=je.thickness,je.thicknessMap&&(Ye.thicknessMap.value=je.thicknessMap,c(je.thicknessMap,Ye.thicknessMapTransform)),Ye.attenuationDistance.value=je.attenuationDistance,Ye.attenuationColor.value.copy(je.attenuationColor)),je.anisotropy>0&&(Ye.anisotropyVector.value.set(je.anisotropy*Math.cos(je.anisotropyRotation),je.anisotropy*Math.sin(je.anisotropyRotation)),je.anisotropyMap&&(Ye.anisotropyMap.value=je.anisotropyMap,c(je.anisotropyMap,Ye.anisotropyMapTransform))),Ye.specularIntensity.value=je.specularIntensity,Ye.specularColor.value.copy(je.specularColor),je.specularColorMap&&(Ye.specularColorMap.value=je.specularColorMap,c(je.specularColorMap,Ye.specularColorMapTransform)),je.specularIntensityMap&&(Ye.specularIntensityMap.value=je.specularIntensityMap,c(je.specularIntensityMap,Ye.specularIntensityMapTransform))}(Ye,je,Ht)):je.isMeshMatcapMaterial?(S(Ye,je),function et(Ye,je){je.matcap&&(Ye.matcap.value=je.matcap)}(Ye,je)):je.isMeshDepthMaterial?S(Ye,je):je.isMeshDistanceMaterial?(S(Ye,je),function vt(Ye,je){const Rt=a.get(je).light;Ye.referencePosition.value.setFromMatrixPosition(Rt.matrixWorld),Ye.nearDistance.value=Rt.shadow.camera.near,Ye.farDistance.value=Rt.shadow.camera.far}(Ye,je)):je.isMeshNormalMaterial?S(Ye,je):je.isLineBasicMaterial?(function U(Ye,je){Ye.diffuse.value.copy(je.color),Ye.opacity.value=je.opacity,je.map&&(Ye.map.value=je.map,c(je.map,Ye.mapTransform))}(Ye,je),je.isLineDashedMaterial&&function F(Ye,je){Ye.dashSize.value=je.dashSize,Ye.totalSize.value=je.dashSize+je.gapSize,Ye.scale.value=je.scale}(Ye,je)):je.isPointsMaterial?function ue(Ye,je,Rt,At){Ye.diffuse.value.copy(je.color),Ye.opacity.value=je.opacity,Ye.size.value=je.size*Rt,Ye.scale.value=.5*At,je.map&&(Ye.map.value=je.map,c(je.map,Ye.uvTransform)),je.alphaMap&&(Ye.alphaMap.value=je.alphaMap,c(je.alphaMap,Ye.alphaMapTransform)),je.alphaTest>0&&(Ye.alphaTest.value=je.alphaTest)}(Ye,je,Rt,At):je.isSpriteMaterial?function Q(Ye,je){Ye.diffuse.value.copy(je.color),Ye.opacity.value=je.opacity,Ye.rotation.value=je.rotation,je.map&&(Ye.map.value=je.map,c(je.map,Ye.mapTransform)),je.alphaMap&&(Ye.alphaMap.value=je.alphaMap,c(je.alphaMap,Ye.alphaMapTransform)),je.alphaTest>0&&(Ye.alphaTest.value=je.alphaTest)}(Ye,je):je.isShadowMaterial?(Ye.color.value.copy(je.color),Ye.opacity.value=je.opacity):je.isShaderMaterial&&(je.uniformsNeedUpdate=!1)}}}function p8(M,a,c,d){let p={},S={},U=[];const F=c.isWebGL2?M.getParameter(M.MAX_UNIFORM_BUFFER_BINDINGS):0;function Ge(Rt,At,Ht,Pn){const yn=Rt.value,xn=At+"_"+Ht;if(void 0===Pn[xn])return Pn[xn]="number"==typeof yn||"boolean"==typeof yn?yn:yn.clone(),!0;{const qn=Pn[xn];if("number"==typeof yn||"boolean"==typeof yn){if(qn!==yn)return Pn[xn]=yn,!0}else if(!1===qn.equals(yn))return qn.copy(yn),!0}return!1}function vt(Rt){const At={boundary:0,storage:0};return"number"==typeof Rt||"boolean"==typeof Rt?(At.boundary=4,At.storage=4):Rt.isVector2?(At.boundary=8,At.storage=8):Rt.isVector3||Rt.isColor?(At.boundary=16,At.storage=12):Rt.isVector4?(At.boundary=16,At.storage=16):Rt.isMatrix3?(At.boundary=48,At.storage=48):Rt.isMatrix4?(At.boundary=64,At.storage=64):Rt.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",Rt),At}function Ye(Rt){const At=Rt.target;At.removeEventListener("dispose",Ye);const Ht=U.indexOf(At.__bindingPointIndex);U.splice(Ht,1),M.deleteBuffer(p[At.id]),delete p[At.id],delete S[At.id]}return{bind:function ue(Rt,At){d.uniformBlockBinding(Rt,At.program)},update:function Q(Rt,At){let Ht=p[Rt.id];void 0===Ht&&(function et(Rt){const At=Rt.uniforms;let Ht=0;for(let xn=0,qn=At.length;xn<qn;xn++){const wi=Array.isArray(At[xn])?At[xn]:[At[xn]];for(let Ut=0,En=wi.length;Ut<En;Ut++){const rr=wi[Ut],lr=Array.isArray(rr.value)?rr.value:[rr.value];for(let Yn=0,Qi=lr.length;Yn<Qi;Yn++){const er=vt(lr[Yn]),Xi=Ht%16;0!==Xi&&16-Xi<er.boundary&&(Ht+=16-Xi),rr.__data=new Float32Array(er.storage/Float32Array.BYTES_PER_ELEMENT),rr.__offset=Ht,Ht+=er.storage}}}const yn=Ht%16;yn>0&&(Ht+=16-yn),Rt.__size=Ht,Rt.__cache={}}(Rt),Ht=function Me(Rt){const At=function ke(){for(let Rt=0;Rt<F;Rt++)if(-1===U.indexOf(Rt))return U.push(Rt),Rt;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();Rt.__bindingPointIndex=At;const Ht=M.createBuffer(),Pn=Rt.__size,yn=Rt.usage;return M.bindBuffer(M.UNIFORM_BUFFER,Ht),M.bufferData(M.UNIFORM_BUFFER,Pn,yn),M.bindBuffer(M.UNIFORM_BUFFER,null),M.bindBufferBase(M.UNIFORM_BUFFER,At,Ht),Ht}(Rt),p[Rt.id]=Ht,Rt.addEventListener("dispose",Ye)),d.updateUBOMapping(Rt,At.program);const yn=a.render.frame;S[Rt.id]!==yn&&(function Oe(Rt){const Ht=Rt.uniforms,Pn=Rt.__cache;M.bindBuffer(M.UNIFORM_BUFFER,p[Rt.id]);for(let yn=0,xn=Ht.length;yn<xn;yn++){const qn=Array.isArray(Ht[yn])?Ht[yn]:[Ht[yn]];for(let wi=0,Ut=qn.length;wi<Ut;wi++){const En=qn[wi];if(!0===Ge(En,yn,wi,Pn)){const rr=En.__offset,lr=Array.isArray(En.value)?En.value:[En.value];let Yn=0;for(let Qi=0;Qi<lr.length;Qi++){const Oi=lr[Qi],er=vt(Oi);"number"==typeof Oi||"boolean"==typeof Oi?(En.__data[0]=Oi,M.bufferSubData(M.UNIFORM_BUFFER,rr+Yn,En.__data)):Oi.isMatrix3?(En.__data[0]=Oi.elements[0],En.__data[1]=Oi.elements[1],En.__data[2]=Oi.elements[2],En.__data[3]=0,En.__data[4]=Oi.elements[3],En.__data[5]=Oi.elements[4],En.__data[6]=Oi.elements[5],En.__data[7]=0,En.__data[8]=Oi.elements[6],En.__data[9]=Oi.elements[7],En.__data[10]=Oi.elements[8],En.__data[11]=0):(Oi.toArray(En.__data,Yn),Yn+=er.storage/Float32Array.BYTES_PER_ELEMENT)}M.bufferSubData(M.UNIFORM_BUFFER,rr,En.__data)}}}M.bindBuffer(M.UNIFORM_BUFFER,null)}(Rt),S[Rt.id]=yn)},dispose:function je(){for(const Rt in p)M.deleteBuffer(p[Rt]);U=[],p={},S={}}}}class QP{constructor(a={}){const{canvas:c=cf(),context:d=null,depth:p=!0,stencil:S=!0,alpha:U=!1,antialias:F=!1,premultipliedAlpha:ue=!0,preserveDrawingBuffer:Q=!1,powerPreference:Me="default",failIfMajorPerformanceCaveat:ke=!1}=a;let Oe;this.isWebGLRenderer=!0,Oe=null!==d?d.getContextAttributes().alpha:U;const Ge=new Uint32Array(4),et=new Int32Array(4);let vt=null,Ye=null;const je=[],Rt=[];this.domElement=c,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Xa,this._useLegacyLights=!1,this.toneMapping=pt,this.toneMappingExposure=1;const At=this;let Ht=!1,Pn=0,yn=0,xn=null,qn=-1,wi=null;const Ut=new Ya,En=new Ya;let rr=null;const lr=new io(0);let Yn=0,Qi=c.width,Oi=c.height,er=1,Xi=null,Vi=null;const Vr=new Ya(0,0,Qi,Oi),Hr=new Ya(0,0,Qi,Oi);let Ns=!1;const Yo=new ff;let Hi=!1,Or=!1,Ds=null;const bo=new mo,eo=new Ki,Qs=new Mn,fa={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ao(){return null===xn?er:1}let Zi,$r,fr,As,Ms,Zs,za,wn,Gt,zi,ji,Lr,br,ta,ko,Xr,cs,Eo,Yr,_h,Sa,So,$s,po,On=d;function Zr(hn,ni){for(let Pi=0;Pi<hn.length;Pi++){const Mi=c.getContext(hn[Pi],ni);if(null!==Mi)return Mi}return null}try{const hn={alpha:!0,depth:p,stencil:S,antialias:F,premultipliedAlpha:ue,preserveDrawingBuffer:Q,powerPreference:Me,failIfMajorPerformanceCaveat:ke};if("setAttribute"in c&&c.setAttribute("data-engine",`three.js r${v}`),c.addEventListener("webglcontextlost",rc,!1),c.addEventListener("webglcontextrestored",Jn,!1),c.addEventListener("webglcontextcreationerror",gs,!1),null===On){const ni=["webgl2","webgl","experimental-webgl"];if(!0===At.isWebGL1Renderer&&ni.shift(),On=Zr(ni,hn),null===On)throw Zr(ni)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&On instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===On.getShaderPrecisionFormat&&(On.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(hn){throw console.error("THREE.WebGLRenderer: "+hn.message),hn}function ya(){Zi=new ft(On),$r=new nc(On,Zi,a),Zi.init($r),So=new kM(On,Zi,$r),fr=new t3(On,Zi,$r),As=new sn(On),Ms=new ed,Zs=new n3(On,Zi,fr,Ms,$r,So,As),za=new sm(At),wn=new qe(At),Gt=new Xo(On,$r),$s=new oA(On,Zi,Gt,$r),zi=new Pt(On,Gt,As,$s),ji=new us(On,zi,Gt,As),Yr=new Ni(On,$r,Zs),Xr=new y_(Ms),Lr=new f0(At,za,wn,Zi,$r,$s,Xr),br=new f8(At,Ms),ta=new lA,ko=new ns(Zi,$r),Eo=new Lv(At,za,wn,fr,ji,Oe,ue),cs=new n1(At,ji,$r),po=new p8(On,As,$r,fr),_h=new Ef(On,Zi,As,$r),Sa=new on(On,Zi,As,$r),As.programs=Lr.programs,At.capabilities=$r,At.extensions=Zi,At.properties=Ms,At.renderLists=ta,At.shadowMap=cs,At.state=fr,At.info=As}ya();const Qo=new u8(At,On);function rc(hn){hn.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Ht=!0}function Jn(){console.log("THREE.WebGLRenderer: Context Restored."),Ht=!1;const hn=As.autoReset,ni=cs.enabled,Pi=cs.autoUpdate,Li=cs.needsUpdate,Mi=cs.type;ya(),As.autoReset=hn,cs.enabled=ni,cs.autoUpdate=Pi,cs.needsUpdate=Li,cs.type=Mi}function gs(hn){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",hn.statusMessage)}function Bi(hn){const ni=hn.target;ni.removeEventListener("dispose",Bi),function ts(hn){(function Es(hn){const ni=Ms.get(hn).programs;void 0!==ni&&(ni.forEach(function(Pi){Lr.releaseProgram(Pi)}),hn.isShaderMaterial&&Lr.releaseShaderCache(hn))})(hn),Ms.remove(hn)}(ni)}function Qa(hn,ni,Pi){!0===hn.transparent&&hn.side===re&&!1===hn.forceSinglePass?(hn.side=1,hn.needsUpdate=!0,Jw(hn,ni,Pi),hn.side=L,hn.needsUpdate=!0,Jw(hn,ni,Pi),hn.side=re):Jw(hn,ni,Pi)}this.xr=Qo,this.getContext=function(){return On},this.getContextAttributes=function(){return On.getContextAttributes()},this.forceContextLoss=function(){const hn=Zi.get("WEBGL_lose_context");hn&&hn.loseContext()},this.forceContextRestore=function(){const hn=Zi.get("WEBGL_lose_context");hn&&hn.restoreContext()},this.getPixelRatio=function(){return er},this.setPixelRatio=function(hn){void 0!==hn&&(er=hn,this.setSize(Qi,Oi,!1))},this.getSize=function(hn){return hn.set(Qi,Oi)},this.setSize=function(hn,ni,Pi=!0){Qo.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Qi=hn,Oi=ni,c.width=Math.floor(hn*er),c.height=Math.floor(ni*er),!0===Pi&&(c.style.width=hn+"px",c.style.height=ni+"px"),this.setViewport(0,0,hn,ni))},this.getDrawingBufferSize=function(hn){return hn.set(Qi*er,Oi*er).floor()},this.setDrawingBufferSize=function(hn,ni,Pi){Qi=hn,Oi=ni,er=Pi,c.width=Math.floor(hn*Pi),c.height=Math.floor(ni*Pi),this.setViewport(0,0,hn,ni)},this.getCurrentViewport=function(hn){return hn.copy(Ut)},this.getViewport=function(hn){return hn.copy(Vr)},this.setViewport=function(hn,ni,Pi,Li){hn.isVector4?Vr.set(hn.x,hn.y,hn.z,hn.w):Vr.set(hn,ni,Pi,Li),fr.viewport(Ut.copy(Vr).multiplyScalar(er).round())},this.getScissor=function(hn){return hn.copy(Hr)},this.setScissor=function(hn,ni,Pi,Li){hn.isVector4?Hr.set(hn.x,hn.y,hn.z,hn.w):Hr.set(hn,ni,Pi,Li),fr.scissor(En.copy(Hr).multiplyScalar(er).round())},this.getScissorTest=function(){return Ns},this.setScissorTest=function(hn){fr.setScissorTest(Ns=hn)},this.setOpaqueSort=function(hn){Xi=hn},this.setTransparentSort=function(hn){Vi=hn},this.getClearColor=function(hn){return hn.copy(Eo.getClearColor())},this.setClearColor=function(){Eo.setClearColor.apply(Eo,arguments)},this.getClearAlpha=function(){return Eo.getClearAlpha()},this.setClearAlpha=function(){Eo.setClearAlpha.apply(Eo,arguments)},this.clear=function(hn=!0,ni=!0,Pi=!0){let Li=0;if(hn){let Mi=!1;if(null!==xn){const Ts=xn.texture.format;Mi=1033===Ts||1031===Ts||1029===Ts}if(Mi){const Ts=xn.texture.type,ao=Ts===gt||Ts===Zt||1012===Ts||Ts===$n||1017===Ts||1018===Ts,Lo=Eo.getClearColor(),na=Eo.getClearAlpha(),Fa=Lo.r,da=Lo.g,pa=Lo.b;ao?(Ge[0]=Fa,Ge[1]=da,Ge[2]=pa,Ge[3]=na,On.clearBufferuiv(On.COLOR,0,Ge)):(et[0]=Fa,et[1]=da,et[2]=pa,et[3]=na,On.clearBufferiv(On.COLOR,0,et))}else Li|=On.COLOR_BUFFER_BIT}ni&&(Li|=On.DEPTH_BUFFER_BIT),Pi&&(Li|=On.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),On.clear(Li)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){c.removeEventListener("webglcontextlost",rc,!1),c.removeEventListener("webglcontextrestored",Jn,!1),c.removeEventListener("webglcontextcreationerror",gs,!1),ta.dispose(),ko.dispose(),Ms.dispose(),za.dispose(),wn.dispose(),ji.dispose(),$s.dispose(),po.dispose(),Lr.dispose(),Qo.dispose(),Qo.removeEventListener("sessionstart",xp),Qo.removeEventListener("sessionend",Wl),Ds&&(Ds.dispose(),Ds=null),bd.stop()},this.renderBufferDirect=function(hn,ni,Pi,Li,Mi,Ts){null===ni&&(ni=fa);const ao=Mi.isMesh&&Mi.matrixWorld.determinant()<0,Lo=function xE(hn,ni,Pi,Li,Mi){!0!==ni.isScene&&(ni=fa),Zs.resetTextureUnits();const Ts=ni.fog,Lo=null===xn?At.outputColorSpace:!0===xn.isXRRenderTarget?xn.texture.colorSpace:fh,na=(Li.isMeshStandardMaterial?wn:za).get(Li.envMap||(Li.isMeshStandardMaterial?ni.environment:null)),Fa=!0===Li.vertexColors&&!!Pi.attributes.color&&4===Pi.attributes.color.itemSize,da=!!Pi.attributes.tangent&&(!!Li.normalMap||Li.anisotropy>0),pa=!!Pi.morphAttributes.position,yh=!!Pi.morphAttributes.normal,kf=!!Pi.morphAttributes.color;let Du=pt;Li.toneMapped&&(null===xn||!0===xn.isXRRenderTarget)&&(Du=At.toneMapping);const Ag=Pi.morphAttributes.position||Pi.morphAttributes.normal||Pi.morphAttributes.color,Lc=void 0!==Ag?Ag.length:0,va=Ms.get(Li),pb=Ye.state.lights;!0!==Hi||!0!==Or&&hn===wi||Xr.setState(Li,hn,hn===wi&&Li.id===qn);let Rl=!1;Li.version===va.__version?(va.needsLights&&va.lightsStateVersion!==pb.state.version||va.outputColorSpace!==Lo||Mi.isBatchedMesh&&!1===va.batching||!Mi.isBatchedMesh&&!0===va.batching||Mi.isInstancedMesh&&!1===va.instancing||!Mi.isInstancedMesh&&!0===va.instancing||Mi.isSkinnedMesh&&!1===va.skinning||!Mi.isSkinnedMesh&&!0===va.skinning||Mi.isInstancedMesh&&!0===va.instancingColor&&null===Mi.instanceColor||Mi.isInstancedMesh&&!1===va.instancingColor&&null!==Mi.instanceColor||Mi.isInstancedMesh&&!0===va.instancingMorph&&null===Mi.morphTexture||Mi.isInstancedMesh&&!1===va.instancingMorph&&null!==Mi.morphTexture||va.envMap!==na||!0===Li.fog&&va.fog!==Ts||void 0!==va.numClippingPlanes&&(va.numClippingPlanes!==Xr.numPlanes||va.numIntersection!==Xr.numIntersection)||va.vertexAlphas!==Fa||va.vertexTangents!==da||va.morphTargets!==pa||va.morphNormals!==yh||va.morphColors!==kf||va.toneMapping!==Du||!0===$r.isWebGL2&&va.morphTargetsCount!==Lc)&&(Rl=!0):(Rl=!0,va.__version=Li.version);let gg=va.currentProgram;!0===Rl&&(gg=Jw(Li,ni,Mi));let mb=!1,D1=!1,k_=!1;const Iu=gg.getUniforms(),F_=va.uniforms;if(fr.useProgram(gg.program)&&(mb=!0,D1=!0,k_=!0),Li.id!==qn&&(qn=Li.id,D1=!0),mb||wi!==hn){Iu.setValue(On,"projectionMatrix",hn.projectionMatrix),Iu.setValue(On,"viewMatrix",hn.matrixWorldInverse);const Ff=Iu.map.cameraPosition;void 0!==Ff&&Ff.setValue(On,Qs.setFromMatrixPosition(hn.matrixWorld)),$r.logarithmicDepthBuffer&&Iu.setValue(On,"logDepthBufFC",2/(Math.log(hn.far+1)/Math.LN2)),(Li.isMeshPhongMaterial||Li.isMeshToonMaterial||Li.isMeshLambertMaterial||Li.isMeshBasicMaterial||Li.isMeshStandardMaterial||Li.isShaderMaterial)&&Iu.setValue(On,"isOrthographic",!0===hn.isOrthographicCamera),wi!==hn&&(wi=hn,D1=!0,k_=!0)}if(Mi.isSkinnedMesh){Iu.setOptional(On,Mi,"bindMatrix"),Iu.setOptional(On,Mi,"bindMatrixInverse");const Ff=Mi.skeleton;Ff&&($r.floatVertexTextures?(null===Ff.boneTexture&&Ff.computeBoneTexture(),Iu.setValue(On,"boneTexture",Ff.boneTexture,Zs)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}Mi.isBatchedMesh&&(Iu.setOptional(On,Mi,"batchingTexture"),Iu.setValue(On,"batchingTexture",Mi._matricesTexture,Zs));const O_=Pi.morphAttributes;if((void 0!==O_.position||void 0!==O_.normal||void 0!==O_.color&&!0===$r.isWebGL2)&&Yr.update(Mi,Pi,gg),(D1||va.receiveShadow!==Mi.receiveShadow)&&(va.receiveShadow=Mi.receiveShadow,Iu.setValue(On,"receiveShadow",Mi.receiveShadow)),Li.isMeshGouraudMaterial&&null!==Li.envMap&&(F_.envMap.value=na,F_.flipEnvMap.value=na.isCubeTexture&&!1===na.isRenderTargetTexture?-1:1),D1&&(Iu.setValue(On,"toneMappingExposure",At.toneMappingExposure),va.needsLights&&function rD(hn,ni){hn.ambientLightColor.needsUpdate=ni,hn.lightProbe.needsUpdate=ni,hn.directionalLights.needsUpdate=ni,hn.directionalLightShadows.needsUpdate=ni,hn.pointLights.needsUpdate=ni,hn.pointLightShadows.needsUpdate=ni,hn.spotLights.needsUpdate=ni,hn.spotLightShadows.needsUpdate=ni,hn.rectAreaLights.needsUpdate=ni,hn.hemisphereLights.needsUpdate=ni}(F_,k_),Ts&&!0===Li.fog&&br.refreshFogUniforms(F_,Ts),br.refreshMaterialUniforms(F_,Li,er,Oi,Ds),Ze.upload(On,iD(va),F_,Zs)),Li.isShaderMaterial&&!0===Li.uniformsNeedUpdate&&(Ze.upload(On,iD(va),F_,Zs),Li.uniformsNeedUpdate=!1),Li.isSpriteMaterial&&Iu.setValue(On,"center",Mi.center),Iu.setValue(On,"modelViewMatrix",Mi.modelViewMatrix),Iu.setValue(On,"normalMatrix",Mi.normalMatrix),Iu.setValue(On,"modelMatrix",Mi.matrixWorld),Li.isShaderMaterial||Li.isRawShaderMaterial){const Ff=Li.uniformsGroups;for(let e2=0,sD=Ff.length;e2<sD;e2++)if($r.isWebGL2){const wE=Ff[e2];po.update(wE,gg),po.bind(wE,gg)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return gg}(hn,ni,Pi,Li,Mi);fr.setMaterial(Li,ao);let na=Pi.index,Fa=1;if(!0===Li.wireframe){if(na=zi.getWireframeAttribute(Pi),void 0===na)return;Fa=2}const da=Pi.drawRange,pa=Pi.attributes.position;let yh=da.start*Fa,kf=(da.start+da.count)*Fa;null!==Ts&&(yh=Math.max(yh,Ts.start*Fa),kf=Math.min(kf,(Ts.start+Ts.count)*Fa)),null!==na?(yh=Math.max(yh,0),kf=Math.min(kf,na.count)):null!=pa&&(yh=Math.max(yh,0),kf=Math.min(kf,pa.count));const Du=kf-yh;if(Du<0||Du===1/0)return;$s.setup(Mi,Li,Lo,Pi,na);let Ag,Lc=_h;if(null!==na&&(Ag=Gt.get(na),Lc=Sa,Lc.setIndex(Ag)),Mi.isMesh)!0===Li.wireframe?(fr.setLineWidth(Li.wireframeLinewidth*Ao()),Lc.setMode(On.LINES)):Lc.setMode(On.TRIANGLES);else if(Mi.isLine){let va=Li.linewidth;void 0===va&&(va=1),fr.setLineWidth(va*Ao()),Lc.setMode(Mi.isLineSegments?On.LINES:Mi.isLineLoop?On.LINE_LOOP:On.LINE_STRIP)}else Mi.isPoints?Lc.setMode(On.POINTS):Mi.isSprite&&Lc.setMode(On.TRIANGLES);if(Mi.isBatchedMesh)Lc.renderMultiDraw(Mi._multiDrawStarts,Mi._multiDrawCounts,Mi._multiDrawCount);else if(Mi.isInstancedMesh)Lc.renderInstances(yh,Du,Mi.count);else if(Pi.isInstancedBufferGeometry){const pb=Math.min(Pi.instanceCount,void 0!==Pi._maxInstanceCount?Pi._maxInstanceCount:1/0);Lc.renderInstances(yh,Du,pb)}else Lc.render(yh,Du)},this.compile=function(hn,ni,Pi=null){null===Pi&&(Pi=hn),Ye=ko.get(Pi),Ye.init(),Rt.push(Ye),Pi.traverseVisible(function(Mi){Mi.isLight&&Mi.layers.test(ni.layers)&&(Ye.pushLight(Mi),Mi.castShadow&&Ye.pushShadow(Mi))}),hn!==Pi&&hn.traverseVisible(function(Mi){Mi.isLight&&Mi.layers.test(ni.layers)&&(Ye.pushLight(Mi),Mi.castShadow&&Ye.pushShadow(Mi))}),Ye.setupLights(At._useLegacyLights);const Li=new Set;return hn.traverse(function(Mi){const Ts=Mi.material;if(Ts)if(Array.isArray(Ts))for(let ao=0;ao<Ts.length;ao++){const Lo=Ts[ao];Qa(Lo,Pi,Mi),Li.add(Lo)}else Qa(Ts,Pi,Mi),Li.add(Ts)}),Rt.pop(),Ye=null,Li},this.compileAsync=function(hn,ni,Pi=null){const Li=this.compile(hn,ni,Pi);return new Promise(Mi=>{function Ts(){Li.forEach(function(ao){Ms.get(ao).currentProgram.isReady()&&Li.delete(ao)}),0!==Li.size?setTimeout(Ts,10):Mi(hn)}null!==Zi.get("KHR_parallel_shader_compile")?Ts():setTimeout(Ts,10)})};let sc=null;function xp(){bd.stop()}function Wl(){bd.start()}const bd=new zm;function Rf(hn,ni,Pi,Li){if(!1===hn.visible)return;if(hn.layers.test(ni.layers))if(hn.isGroup)Pi=hn.renderOrder;else if(hn.isLOD)!0===hn.autoUpdate&&hn.update(ni);else if(hn.isLight)Ye.pushLight(hn),hn.castShadow&&Ye.pushShadow(hn);else if(hn.isSprite){if(!hn.frustumCulled||Yo.intersectsSprite(hn)){Li&&Qs.setFromMatrixPosition(hn.matrixWorld).applyMatrix4(bo);const ao=ji.update(hn),Lo=hn.material;Lo.visible&&vt.push(hn,ao,Lo,Pi,Qs.z,null)}}else if((hn.isMesh||hn.isLine||hn.isPoints)&&(!hn.frustumCulled||Yo.intersectsObject(hn))){const ao=ji.update(hn),Lo=hn.material;if(Li&&(void 0!==hn.boundingSphere?(null===hn.boundingSphere&&hn.computeBoundingSphere(),Qs.copy(hn.boundingSphere.center)):(null===ao.boundingSphere&&ao.computeBoundingSphere(),Qs.copy(ao.boundingSphere.center)),Qs.applyMatrix4(hn.matrixWorld).applyMatrix4(bo)),Array.isArray(Lo)){const na=ao.groups;for(let Fa=0,da=na.length;Fa<da;Fa++){const pa=na[Fa],yh=Lo[pa.materialIndex];yh&&yh.visible&&vt.push(hn,ao,yh,Pi,Qs.z,pa)}}else Lo.visible&&vt.push(hn,ao,Lo,Pi,Qs.z,null)}const Ts=hn.children;for(let ao=0,Lo=Ts.length;ao<Lo;ao++)Rf(Ts[ao],ni,Pi,Li)}function tD(hn,ni,Pi,Li){const Mi=hn.opaque,Ts=hn.transmissive,ao=hn.transparent;Ye.setupLightsView(Pi),!0===Hi&&Xr.setGlobalState(At.clippingPlanes,Pi),Ts.length>0&&function nD(hn,ni,Pi,Li){if(null!==(!0===Pi.isScene?Pi.overrideMaterial:null))return;const Ts=$r.isWebGL2;null===Ds&&(Ds=new Hl(1,1,{generateMipmaps:!0,type:Zi.has("EXT_color_buffer_half_float")?vn:gt,minFilter:_e,samples:Ts?4:0})),At.getDrawingBufferSize(eo),Ts?Ds.setSize(eo.x,eo.y):Ds.setSize(Kc(eo.x),Kc(eo.y));const ao=At.getRenderTarget();At.setRenderTarget(Ds),At.getClearColor(lr),Yn=At.getClearAlpha(),Yn<1&&At.setClearColor(16777215,.5),At.clear();const Lo=At.toneMapping;At.toneMapping=pt,Zw(hn,Pi,Li),Zs.updateMultisampleRenderTarget(Ds),Zs.updateRenderTargetMipmap(Ds);let na=!1;for(let Fa=0,da=ni.length;Fa<da;Fa++){const pa=ni[Fa],yh=pa.object,kf=pa.geometry,Du=pa.material,Ag=pa.group;if(Du.side===re&&yh.layers.test(Li.layers)){const Lc=Du.side;Du.side=1,Du.needsUpdate=!0,vE(yh,Pi,Li,kf,Du,Ag),Du.side=Lc,Du.needsUpdate=!0,na=!0}}!0===na&&(Zs.updateMultisampleRenderTarget(Ds),Zs.updateRenderTargetMipmap(Ds)),At.setRenderTarget(ao),At.setClearColor(lr,Yn),At.toneMapping=Lo}(Mi,Ts,ni,Pi),Li&&fr.viewport(Ut.copy(Li)),Mi.length>0&&Zw(Mi,ni,Pi),Ts.length>0&&Zw(Ts,ni,Pi),ao.length>0&&Zw(ao,ni,Pi),fr.buffers.depth.setTest(!0),fr.buffers.depth.setMask(!0),fr.buffers.color.setMask(!0),fr.setPolygonOffset(!1)}function Zw(hn,ni,Pi){const Li=!0===ni.isScene?ni.overrideMaterial:null;for(let Mi=0,Ts=hn.length;Mi<Ts;Mi++){const ao=hn[Mi],Lo=ao.object,na=ao.geometry,Fa=null===Li?ao.material:Li,da=ao.group;Lo.layers.test(Pi.layers)&&vE(Lo,ni,Pi,na,Fa,da)}}function vE(hn,ni,Pi,Li,Mi,Ts){hn.onBeforeRender(At,ni,Pi,Li,Mi,Ts),hn.modelViewMatrix.multiplyMatrices(Pi.matrixWorldInverse,hn.matrixWorld),hn.normalMatrix.getNormalMatrix(hn.modelViewMatrix),Mi.onBeforeRender(At,ni,Pi,Li,hn,Ts),!0===Mi.transparent&&Mi.side===re&&!1===Mi.forceSinglePass?(Mi.side=1,Mi.needsUpdate=!0,At.renderBufferDirect(Pi,ni,Li,Mi,hn,Ts),Mi.side=L,Mi.needsUpdate=!0,At.renderBufferDirect(Pi,ni,Li,Mi,hn,Ts),Mi.side=re):At.renderBufferDirect(Pi,ni,Li,Mi,hn,Ts),hn.onAfterRender(At,ni,Pi,Li,Mi,Ts)}function Jw(hn,ni,Pi){!0!==ni.isScene&&(ni=fa);const Li=Ms.get(hn),Mi=Ye.state.lights,ao=Mi.state.version,Lo=Lr.getParameters(hn,Mi.state,Ye.state.shadowsArray,ni,Pi),na=Lr.getProgramCacheKey(Lo);let Fa=Li.programs;Li.environment=hn.isMeshStandardMaterial?ni.environment:null,Li.fog=ni.fog,Li.envMap=(hn.isMeshStandardMaterial?wn:za).get(hn.envMap||Li.environment),Li.envMapRotation=null!==Li.environment&&null===hn.envMap?ni.environmentRotation:hn.envMapRotation,void 0===Fa&&(hn.addEventListener("dispose",Bi),Fa=new Map,Li.programs=Fa);let da=Fa.get(na);if(void 0!==da){if(Li.currentProgram===da&&Li.lightsStateVersion===ao)return bE(hn,Lo),da}else Lo.uniforms=Lr.getUniforms(hn),hn.onBuild(Pi,Lo,At),hn.onBeforeCompile(Lo,At),da=Lr.acquireProgram(Lo,na),Fa.set(na,da),Li.uniforms=Lo.uniforms;const pa=Li.uniforms;return(!hn.isShaderMaterial&&!hn.isRawShaderMaterial||!0===hn.clipping)&&(pa.clippingPlanes=Xr.uniform),bE(hn,Lo),Li.needsLights=function fb(hn){return hn.isMeshLambertMaterial||hn.isMeshToonMaterial||hn.isMeshPhongMaterial||hn.isMeshStandardMaterial||hn.isShadowMaterial||hn.isShaderMaterial&&!0===hn.lights}(hn),Li.lightsStateVersion=ao,Li.needsLights&&(pa.ambientLightColor.value=Mi.state.ambient,pa.lightProbe.value=Mi.state.probe,pa.directionalLights.value=Mi.state.directional,pa.directionalLightShadows.value=Mi.state.directionalShadow,pa.spotLights.value=Mi.state.spot,pa.spotLightShadows.value=Mi.state.spotShadow,pa.rectAreaLights.value=Mi.state.rectArea,pa.ltc_1.value=Mi.state.rectAreaLTC1,pa.ltc_2.value=Mi.state.rectAreaLTC2,pa.pointLights.value=Mi.state.point,pa.pointLightShadows.value=Mi.state.pointShadow,pa.hemisphereLights.value=Mi.state.hemi,pa.directionalShadowMap.value=Mi.state.directionalShadowMap,pa.directionalShadowMatrix.value=Mi.state.directionalShadowMatrix,pa.spotShadowMap.value=Mi.state.spotShadowMap,pa.spotLightMatrix.value=Mi.state.spotLightMatrix,pa.spotLightMap.value=Mi.state.spotLightMap,pa.pointShadowMap.value=Mi.state.pointShadowMap,pa.pointShadowMatrix.value=Mi.state.pointShadowMatrix),Li.currentProgram=da,Li.uniformsList=null,da}function iD(hn){if(null===hn.uniformsList){const ni=hn.currentProgram.getUniforms();hn.uniformsList=Ze.seqWithValue(ni.seq,hn.uniforms)}return hn.uniformsList}function bE(hn,ni){const Pi=Ms.get(hn);Pi.outputColorSpace=ni.outputColorSpace,Pi.batching=ni.batching,Pi.instancing=ni.instancing,Pi.instancingColor=ni.instancingColor,Pi.instancingMorph=ni.instancingMorph,Pi.skinning=ni.skinning,Pi.morphTargets=ni.morphTargets,Pi.morphNormals=ni.morphNormals,Pi.morphColors=ni.morphColors,Pi.morphTargetsCount=ni.morphTargetsCount,Pi.numClippingPlanes=ni.numClippingPlanes,Pi.numIntersection=ni.numClipIntersection,Pi.vertexAlphas=ni.vertexAlphas,Pi.vertexTangents=ni.vertexTangents,Pi.toneMapping=ni.toneMapping}bd.setAnimationLoop(function Tu(hn){sc&&sc(hn)}),typeof self<"u"&&bd.setContext(self),this.setAnimationLoop=function(hn){sc=hn,Qo.setAnimationLoop(hn),null===hn?bd.stop():bd.start()},Qo.addEventListener("sessionstart",xp),Qo.addEventListener("sessionend",Wl),this.render=function(hn,ni){if(void 0===ni||!0===ni.isCamera){if(!0!==Ht){if(!0===hn.matrixWorldAutoUpdate&&hn.updateMatrixWorld(),null===ni.parent&&!0===ni.matrixWorldAutoUpdate&&ni.updateMatrixWorld(),!0===Qo.enabled&&!0===Qo.isPresenting&&(!0===Qo.cameraAutoUpdate&&Qo.updateCamera(ni),ni=Qo.getCamera()),!0===hn.isScene&&hn.onBeforeRender(At,hn,ni,xn),Ye=ko.get(hn,Rt.length),Ye.init(),Rt.push(Ye),bo.multiplyMatrices(ni.projectionMatrix,ni.matrixWorldInverse),Yo.setFromProjectionMatrix(bo),Or=this.localClippingEnabled,Hi=Xr.init(this.clippingPlanes,Or),vt=ta.get(hn,je.length),vt.init(),je.push(vt),Rf(hn,ni,0,At.sortObjects),vt.finish(),!0===At.sortObjects&&vt.sort(Xi,Vi),this.info.render.frame++,!0===Hi&&Xr.beginShadows(),cs.render(Ye.state.shadowsArray,hn,ni),!0===Hi&&Xr.endShadows(),!0===this.info.autoReset&&this.info.reset(),(!1===Qo.enabled||!1===Qo.isPresenting||!1===Qo.hasDepthSensing())&&Eo.render(vt,hn),Ye.setupLights(At._useLegacyLights),ni.isArrayCamera){const Li=ni.cameras;for(let Mi=0,Ts=Li.length;Mi<Ts;Mi++){const ao=Li[Mi];tD(vt,hn,ao,ao.viewport)}}else tD(vt,hn,ni);null!==xn&&(Zs.updateMultisampleRenderTarget(xn),Zs.updateRenderTargetMipmap(xn)),!0===hn.isScene&&hn.onAfterRender(At,hn,ni),$s.resetDefaultState(),qn=-1,wi=null,Rt.pop(),Ye=Rt.length>0?Rt[Rt.length-1]:null,je.pop(),vt=je.length>0?je[je.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return Pn},this.getActiveMipmapLevel=function(){return yn},this.getRenderTarget=function(){return xn},this.setRenderTargetTextures=function(hn,ni,Pi){Ms.get(hn.texture).__webglTexture=ni,Ms.get(hn.depthTexture).__webglTexture=Pi;const Li=Ms.get(hn);Li.__hasExternalTextures=!0,Li.__autoAllocateDepthBuffer=void 0===Pi,Li.__autoAllocateDepthBuffer||!0===Zi.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Li.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(hn,ni){const Pi=Ms.get(hn);Pi.__webglFramebuffer=ni,Pi.__useDefaultFramebuffer=void 0===ni},this.setRenderTarget=function(hn,ni=0,Pi=0){xn=hn,Pn=ni,yn=Pi;let Li=!0,Mi=null,Ts=!1,ao=!1;if(hn){const na=Ms.get(hn);void 0!==na.__useDefaultFramebuffer?(fr.bindFramebuffer(On.FRAMEBUFFER,null),Li=!1):void 0===na.__webglFramebuffer?Zs.setupRenderTarget(hn):na.__hasExternalTextures&&Zs.rebindTextures(hn,Ms.get(hn.texture).__webglTexture,Ms.get(hn.depthTexture).__webglTexture);const Fa=hn.texture;(Fa.isData3DTexture||Fa.isDataArrayTexture||Fa.isCompressedArrayTexture)&&(ao=!0);const da=Ms.get(hn).__webglFramebuffer;hn.isWebGLCubeRenderTarget?(Mi=Array.isArray(da[ni])?da[ni][Pi]:da[ni],Ts=!0):Mi=$r.isWebGL2&&hn.samples>0&&!1===Zs.useMultisampledRTT(hn)?Ms.get(hn).__webglMultisampledFramebuffer:Array.isArray(da)?da[Pi]:da,Ut.copy(hn.viewport),En.copy(hn.scissor),rr=hn.scissorTest}else Ut.copy(Vr).multiplyScalar(er).floor(),En.copy(Hr).multiplyScalar(er).floor(),rr=Ns;if(fr.bindFramebuffer(On.FRAMEBUFFER,Mi)&&$r.drawBuffers&&Li&&fr.drawBuffers(hn,Mi),fr.viewport(Ut),fr.scissor(En),fr.setScissorTest(rr),Ts){const na=Ms.get(hn.texture);On.framebufferTexture2D(On.FRAMEBUFFER,On.COLOR_ATTACHMENT0,On.TEXTURE_CUBE_MAP_POSITIVE_X+ni,na.__webglTexture,Pi)}else if(ao){const na=Ms.get(hn.texture);On.framebufferTextureLayer(On.FRAMEBUFFER,On.COLOR_ATTACHMENT0,na.__webglTexture,Pi||0,ni||0)}qn=-1},this.readRenderTargetPixels=function(hn,ni,Pi,Li,Mi,Ts,ao){if(!hn||!hn.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Lo=Ms.get(hn).__webglFramebuffer;if(hn.isWebGLCubeRenderTarget&&void 0!==ao&&(Lo=Lo[ao]),Lo){fr.bindFramebuffer(On.FRAMEBUFFER,Lo);try{const na=hn.texture,Fa=na.format,da=na.type;if(Fa!==Rn&&So.convert(Fa)!==On.getParameter(On.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const pa=da===vn&&(Zi.has("EXT_color_buffer_half_float")||$r.isWebGL2&&Zi.has("EXT_color_buffer_float"));if(!(da===gt||So.convert(da)===On.getParameter(On.IMPLEMENTATION_COLOR_READ_TYPE)||da===dn&&($r.isWebGL2||Zi.has("OES_texture_float")||Zi.has("WEBGL_color_buffer_float"))||pa))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ni>=0&&ni<=hn.width-Li&&Pi>=0&&Pi<=hn.height-Mi&&On.readPixels(ni,Pi,Li,Mi,So.convert(Fa),So.convert(da),Ts)}finally{const na=null!==xn?Ms.get(xn).__webglFramebuffer:null;fr.bindFramebuffer(On.FRAMEBUFFER,na)}}},this.copyFramebufferToTexture=function(hn,ni,Pi=0){const Li=Math.pow(2,-Pi),Mi=Math.floor(ni.image.width*Li),Ts=Math.floor(ni.image.height*Li);Zs.setTexture2D(ni,0),On.copyTexSubImage2D(On.TEXTURE_2D,Pi,0,0,hn.x,hn.y,Mi,Ts),fr.unbindTexture()},this.copyTextureToTexture=function(hn,ni,Pi,Li=0){const Mi=ni.image.width,Ts=ni.image.height,ao=So.convert(Pi.format),Lo=So.convert(Pi.type);Zs.setTexture2D(Pi,0),On.pixelStorei(On.UNPACK_FLIP_Y_WEBGL,Pi.flipY),On.pixelStorei(On.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Pi.premultiplyAlpha),On.pixelStorei(On.UNPACK_ALIGNMENT,Pi.unpackAlignment),ni.isDataTexture?On.texSubImage2D(On.TEXTURE_2D,Li,hn.x,hn.y,Mi,Ts,ao,Lo,ni.image.data):ni.isCompressedTexture?On.compressedTexSubImage2D(On.TEXTURE_2D,Li,hn.x,hn.y,ni.mipmaps[0].width,ni.mipmaps[0].height,ao,ni.mipmaps[0].data):On.texSubImage2D(On.TEXTURE_2D,Li,hn.x,hn.y,ao,Lo,ni.image),0===Li&&Pi.generateMipmaps&&On.generateMipmap(On.TEXTURE_2D),fr.unbindTexture()},this.copyTextureToTexture3D=function(hn,ni,Pi,Li,Mi=0){if(At.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ts=Math.round(hn.max.x-hn.min.x),ao=Math.round(hn.max.y-hn.min.y),Lo=hn.max.z-hn.min.z+1,na=So.convert(Li.format),Fa=So.convert(Li.type);let da;if(Li.isData3DTexture)Zs.setTexture3D(Li,0),da=On.TEXTURE_3D;else{if(!Li.isDataArrayTexture&&!Li.isCompressedArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Zs.setTexture2DArray(Li,0),da=On.TEXTURE_2D_ARRAY}On.pixelStorei(On.UNPACK_FLIP_Y_WEBGL,Li.flipY),On.pixelStorei(On.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Li.premultiplyAlpha),On.pixelStorei(On.UNPACK_ALIGNMENT,Li.unpackAlignment);const pa=On.getParameter(On.UNPACK_ROW_LENGTH),yh=On.getParameter(On.UNPACK_IMAGE_HEIGHT),kf=On.getParameter(On.UNPACK_SKIP_PIXELS),Du=On.getParameter(On.UNPACK_SKIP_ROWS),Ag=On.getParameter(On.UNPACK_SKIP_IMAGES),Lc=Pi.isCompressedTexture?Pi.mipmaps[Mi]:Pi.image;On.pixelStorei(On.UNPACK_ROW_LENGTH,Lc.width),On.pixelStorei(On.UNPACK_IMAGE_HEIGHT,Lc.height),On.pixelStorei(On.UNPACK_SKIP_PIXELS,hn.min.x),On.pixelStorei(On.UNPACK_SKIP_ROWS,hn.min.y),On.pixelStorei(On.UNPACK_SKIP_IMAGES,hn.min.z),Pi.isDataTexture||Pi.isData3DTexture?On.texSubImage3D(da,Mi,ni.x,ni.y,ni.z,Ts,ao,Lo,na,Fa,Lc.data):Li.isCompressedArrayTexture?On.compressedTexSubImage3D(da,Mi,ni.x,ni.y,ni.z,Ts,ao,Lo,na,Lc.data):On.texSubImage3D(da,Mi,ni.x,ni.y,ni.z,Ts,ao,Lo,na,Fa,Lc),On.pixelStorei(On.UNPACK_ROW_LENGTH,pa),On.pixelStorei(On.UNPACK_IMAGE_HEIGHT,yh),On.pixelStorei(On.UNPACK_SKIP_PIXELS,kf),On.pixelStorei(On.UNPACK_SKIP_ROWS,Du),On.pixelStorei(On.UNPACK_SKIP_IMAGES,Ag),0===Mi&&Li.generateMipmaps&&On.generateMipmap(da),fr.unbindTexture()},this.initTexture=function(hn){hn.isCubeTexture?Zs.setTextureCube(hn,0):hn.isData3DTexture?Zs.setTexture3D(hn,0):hn.isDataArrayTexture||hn.isCompressedArrayTexture?Zs.setTexture2DArray(hn,0):Zs.setTexture2D(hn,0),fr.unbindTexture()},this.resetState=function(){Pn=0,yn=0,xn=null,fr.reset(),$s.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Qu}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(a){this._outputColorSpace=a;const c=this.getContext();c.drawingBufferColorSpace=a===qu?"display-p3":"srgb",c.unpackColorSpace=Ia.workingColorSpace===ph?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(a){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=a}}class lg{constructor(a,c=1,d=1e3){this.isFog=!0,this.name="",this.color=new io(a),this.near=c,this.far=d}clone(){return new lg(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class ro extends Vl{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new kc,this.environmentRotation=new kc,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(a,c){return super.copy(a,c),null!==a.background&&(this.background=a.background.clone()),null!==a.environment&&(this.environment=a.environment.clone()),null!==a.fog&&(this.fog=a.fog.clone()),this.backgroundBlurriness=a.backgroundBlurriness,this.backgroundIntensity=a.backgroundIntensity,this.backgroundRotation.copy(a.backgroundRotation),this.environmentRotation.copy(a.environmentRotation),null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone()),this.matrixAutoUpdate=a.matrixAutoUpdate,this}toJSON(a){const c=super.toJSON(a);return null!==this.fog&&(c.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(c.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(c.object.backgroundIntensity=this.backgroundIntensity),c.object.backgroundRotation=this.backgroundRotation.toArray(),c.object.environmentRotation=this.environmentRotation.toArray(),c}}class o1 extends tl{constructor(a,c,d,p=1){super(a,c,d),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=p}copy(a){return super.copy(a),this.meshPerAttribute=a.meshPerAttribute,this}toJSON(){const a=super.toJSON();return a.meshPerAttribute=this.meshPerAttribute,a.isInstancedBufferAttribute=!0,a}}class x_ extends _u{constructor(a=null,c=1,d=1,p,S,U,F,ue,Q=qi,Me=qi,ke,Oe){super(null,U,F,ue,Q,Me,p,S,ke,Oe),this.isDataTexture=!0,this.image={data:a,width:c,height:d},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Bf=new mo,a1=new mo,sw=[],ow=new Pc,o3=new mo,cg=new Jl,hg=new Qc;class OM extends Jl{constructor(a,c,d){super(a,c),this.isInstancedMesh=!0,this.instanceMatrix=new o1(new Float32Array(16*d),16),this.instanceColor=null,this.morphTexture=null,this.count=d,this.boundingBox=null,this.boundingSphere=null;for(let p=0;p<d;p++)this.setMatrixAt(p,o3)}computeBoundingBox(){const a=this.geometry,c=this.count;null===this.boundingBox&&(this.boundingBox=new Pc),null===a.boundingBox&&a.computeBoundingBox(),this.boundingBox.makeEmpty();for(let d=0;d<c;d++)this.getMatrixAt(d,Bf),ow.copy(a.boundingBox).applyMatrix4(Bf),this.boundingBox.union(ow)}computeBoundingSphere(){const a=this.geometry,c=this.count;null===this.boundingSphere&&(this.boundingSphere=new Qc),null===a.boundingSphere&&a.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let d=0;d<c;d++)this.getMatrixAt(d,Bf),hg.copy(a.boundingSphere).applyMatrix4(Bf),this.boundingSphere.union(hg)}copy(a,c){return super.copy(a,c),this.instanceMatrix.copy(a.instanceMatrix),null!==a.instanceColor&&(this.instanceColor=a.instanceColor.clone()),this.count=a.count,null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone()),null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone()),this}getColorAt(a,c){c.fromArray(this.instanceColor.array,3*a)}getMatrixAt(a,c){c.fromArray(this.instanceMatrix.array,16*a)}getMorphAt(a,c){const d=c.morphTargetInfluences,p=this.morphTexture.source.data.data,U=a*(d.length+1)+1;for(let F=0;F<d.length;F++)d[F]=p[U+F]}raycast(a,c){const d=this.matrixWorld,p=this.count;if(cg.geometry=this.geometry,cg.material=this.material,void 0!==cg.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),hg.copy(this.boundingSphere),hg.applyMatrix4(d),!1!==a.ray.intersectsSphere(hg)))for(let S=0;S<p;S++){this.getMatrixAt(S,Bf),a1.multiplyMatrices(d,Bf),cg.matrixWorld=a1,cg.raycast(a,sw);for(let U=0,F=sw.length;U<F;U++){const ue=sw[U];ue.instanceId=S,ue.object=this,c.push(ue)}sw.length=0}}setColorAt(a,c){null===this.instanceColor&&(this.instanceColor=new o1(new Float32Array(3*this.instanceMatrix.count),3)),c.toArray(this.instanceColor.array,3*a)}setMatrixAt(a,c){c.toArray(this.instanceMatrix.array,16*a)}setMorphAt(a,c){const d=c.morphTargetInfluences,p=d.length+1;null===this.morphTexture&&(this.morphTexture=new x_(new Float32Array(p*this.count),p,this.count,1028,dn));const S=this.morphTexture.source.data.data;let U=0;for(let Q=0;Q<d.length;Q++)U+=d[Q];const ue=p*a;S[ue]=this.geometry.morphTargetsRelative?1:1-U,S.set(d,ue+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class w_ extends _l{constructor(a){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new io(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.linewidth=a.linewidth,this.linecap=a.linecap,this.linejoin=a.linejoin,this.fog=a.fog,this}}const a3=new Mn,l3=new Mn,c3=new mo,aw=new Wp,l1=new Qc;class lw extends Vl{constructor(a=new ol,c=new w_){super(),this.isLine=!0,this.type="Line",this.geometry=a,this.material=c,this.updateMorphTargets()}copy(a,c){return super.copy(a,c),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}computeLineDistances(){const a=this.geometry;if(null===a.index){const c=a.attributes.position,d=[0];for(let p=1,S=c.count;p<S;p++)a3.fromBufferAttribute(c,p-1),l3.fromBufferAttribute(c,p),d[p]=d[p-1],d[p]+=a3.distanceTo(l3);a.setAttribute("lineDistance",new Wn(d,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(a,c){const d=this.geometry,p=this.matrixWorld,S=a.params.Line.threshold,U=d.drawRange;if(null===d.boundingSphere&&d.computeBoundingSphere(),l1.copy(d.boundingSphere),l1.applyMatrix4(p),l1.radius+=S,!1===a.ray.intersectsSphere(l1))return;c3.copy(p).invert(),aw.copy(a.ray).applyMatrix4(c3);const F=S/((this.scale.x+this.scale.y+this.scale.z)/3),ue=F*F,Q=new Mn,Me=new Mn,ke=new Mn,Oe=new Mn,Ge=this.isLineSegments?2:1,et=d.index,Ye=d.attributes.position;if(null!==et)for(let At=Math.max(0,U.start),Ht=Math.min(et.count,U.start+U.count)-1;At<Ht;At+=Ge){const Pn=et.getX(At),yn=et.getX(At+1);if(Q.fromBufferAttribute(Ye,Pn),Me.fromBufferAttribute(Ye,yn),aw.distanceSqToSegment(Q,Me,Oe,ke)>ue)continue;Oe.applyMatrix4(this.matrixWorld);const qn=a.ray.origin.distanceTo(Oe);qn<a.near||qn>a.far||c.push({distance:qn,point:ke.clone().applyMatrix4(this.matrixWorld),index:At,face:null,faceIndex:null,object:this})}else for(let At=Math.max(0,U.start),Ht=Math.min(Ye.count,U.start+U.count)-1;At<Ht;At+=Ge){if(Q.fromBufferAttribute(Ye,At),Me.fromBufferAttribute(Ye,At+1),aw.distanceSqToSegment(Q,Me,Oe,ke)>ue)continue;Oe.applyMatrix4(this.matrixWorld);const yn=a.ray.origin.distanceTo(Oe);yn<a.near||yn>a.far||c.push({distance:yn,point:ke.clone().applyMatrix4(this.matrixWorld),index:At,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const c=this.geometry.morphAttributes,d=Object.keys(c);if(d.length>0){const p=c[d[0]];if(void 0!==p){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,U=p.length;S<U;S++){const F=p[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[F]=S}}}}}const yd=new Mn,cw=new Mn;class LM extends lw{constructor(a,c){super(a,c),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const a=this.geometry;if(null===a.index){const c=a.attributes.position,d=[];for(let p=0,S=c.count;p<S;p+=2)yd.fromBufferAttribute(c,p),cw.fromBufferAttribute(c,p+1),d[p]=0===p?0:d[p-1],d[p+1]=d[p]+yd.distanceTo(cw);a.setAttribute("lineDistance",new Wn(d,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class h3 extends _l{constructor(a){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new io(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.size=a.size,this.sizeAttenuation=a.sizeAttenuation,this.fog=a.fog,this}}const jP=new mo,iu=new Wp,ug=new Qc,Hv=new Mn;class NM extends Vl{constructor(a=new ol,c=new h3){super(),this.isPoints=!0,this.type="Points",this.geometry=a,this.material=c,this.updateMorphTargets()}copy(a,c){return super.copy(a,c),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}raycast(a,c){const d=this.geometry,p=this.matrixWorld,S=a.params.Points.threshold,U=d.drawRange;if(null===d.boundingSphere&&d.computeBoundingSphere(),ug.copy(d.boundingSphere),ug.applyMatrix4(p),ug.radius+=S,!1===a.ray.intersectsSphere(ug))return;jP.copy(p).invert(),iu.copy(a.ray).applyMatrix4(jP);const F=S/((this.scale.x+this.scale.y+this.scale.z)/3),ue=F*F,Q=d.index,ke=d.attributes.position;if(null!==Q)for(let et=Math.max(0,U.start),vt=Math.min(Q.count,U.start+U.count);et<vt;et++){const Ye=Q.getX(et);Hv.fromBufferAttribute(ke,Ye),u3(Hv,Ye,ue,p,a,c,this)}else for(let et=Math.max(0,U.start),vt=Math.min(ke.count,U.start+U.count);et<vt;et++)Hv.fromBufferAttribute(ke,et),u3(Hv,et,ue,p,a,c,this)}updateMorphTargets(){const c=this.geometry.morphAttributes,d=Object.keys(c);if(d.length>0){const p=c[d[0]];if(void 0!==p){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,U=p.length;S<U;S++){const F=p[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[F]=S}}}}}function u3(M,a,c,d,p,S,U){const F=iu.distanceSqToPoint(M);if(F<c){const ue=new Mn;iu.closestPointToPoint(M,ue),ue.applyMatrix4(d);const Q=p.ray.origin.distanceTo(ue);if(Q<p.near||Q>p.far)return;S.push({distance:Q,distanceToRay:Math.sqrt(F),point:ue,index:a,face:null,object:U})}}class d3 extends _u{constructor(a,c,d,p,S,U,F,ue,Q){super(a,c,d,p,S,U,F,ue,Q),this.isCanvasTexture=!0,this.needsUpdate=!0}}class cA{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(a,c){const d=this.getUtoTmapping(a);return this.getPoint(d,c)}getPoints(a=5){const c=[];for(let d=0;d<=a;d++)c.push(this.getPoint(d/a));return c}getSpacedPoints(a=5){const c=[];for(let d=0;d<=a;d++)c.push(this.getPointAt(d/a));return c}getLength(){const a=this.getLengths();return a[a.length-1]}getLengths(a=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const c=[];let d,p=this.getPoint(0),S=0;c.push(0);for(let U=1;U<=a;U++)d=this.getPoint(U/a),S+=d.distanceTo(p),c.push(S),p=d;return this.cacheArcLengths=c,c}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(a,c){const d=this.getLengths();let p=0;const S=d.length;let U;U=c||a*d[S-1];let Q,F=0,ue=S-1;for(;F<=ue;)if(p=Math.floor(F+(ue-F)/2),Q=d[p]-U,Q<0)F=p+1;else{if(!(Q>0)){ue=p;break}ue=p-1}if(p=ue,d[p]===U)return p/(S-1);const Me=d[p];return(p+(U-Me)/(d[p+1]-Me))/(S-1)}getTangent(a,c){let p=a-1e-4,S=a+1e-4;p<0&&(p=0),S>1&&(S=1);const U=this.getPoint(p),F=this.getPoint(S),ue=c||(U.isVector2?new Ki:new Mn);return ue.copy(F).sub(U).normalize(),ue}getTangentAt(a,c){const d=this.getUtoTmapping(a);return this.getTangent(d,c)}computeFrenetFrames(a,c){const d=new Mn,p=[],S=[],U=[],F=new Mn,ue=new mo;for(let Ge=0;Ge<=a;Ge++)p[Ge]=this.getTangentAt(Ge/a,new Mn);S[0]=new Mn,U[0]=new Mn;let Q=Number.MAX_VALUE;const Me=Math.abs(p[0].x),ke=Math.abs(p[0].y),Oe=Math.abs(p[0].z);Me<=Q&&(Q=Me,d.set(1,0,0)),ke<=Q&&(Q=ke,d.set(0,1,0)),Oe<=Q&&d.set(0,0,1),F.crossVectors(p[0],d).normalize(),S[0].crossVectors(p[0],F),U[0].crossVectors(p[0],S[0]);for(let Ge=1;Ge<=a;Ge++){if(S[Ge]=S[Ge-1].clone(),U[Ge]=U[Ge-1].clone(),F.crossVectors(p[Ge-1],p[Ge]),F.length()>Number.EPSILON){F.normalize();const et=Math.acos(Yl(p[Ge-1].dot(p[Ge]),-1,1));S[Ge].applyMatrix4(ue.makeRotationAxis(F,et))}U[Ge].crossVectors(p[Ge],S[Ge])}if(!0===c){let Ge=Math.acos(Yl(S[0].dot(S[a]),-1,1));Ge/=a,p[0].dot(F.crossVectors(S[0],S[a]))>0&&(Ge=-Ge);for(let et=1;et<=a;et++)S[et].applyMatrix4(ue.makeRotationAxis(p[et],Ge*et)),U[et].crossVectors(p[et],S[et])}return{tangents:p,normals:S,binormals:U}}clone(){return(new this.constructor).copy(this)}copy(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}toJSON(){const a={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return a.arcLengthDivisions=this.arcLengthDivisions,a.type=this.type,a}fromJSON(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}}class uw extends cA{constructor(a=0,c=0,d=1,p=1,S=0,U=2*Math.PI,F=!1,ue=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=a,this.aY=c,this.xRadius=d,this.yRadius=p,this.aStartAngle=S,this.aEndAngle=U,this.aClockwise=F,this.aRotation=ue}getPoint(a,c=new Ki){const d=c,p=2*Math.PI;let S=this.aEndAngle-this.aStartAngle;const U=Math.abs(S)<Number.EPSILON;for(;S<0;)S+=p;for(;S>p;)S-=p;S<Number.EPSILON&&(S=U?0:p),!0===this.aClockwise&&!U&&(S===p?S=-p:S-=p);const F=this.aStartAngle+a*S;let ue=this.aX+this.xRadius*Math.cos(F),Q=this.aY+this.yRadius*Math.sin(F);if(0!==this.aRotation){const Me=Math.cos(this.aRotation),ke=Math.sin(this.aRotation),Oe=ue-this.aX,Ge=Q-this.aY;ue=Oe*Me-Ge*ke+this.aX,Q=Oe*ke+Ge*Me+this.aY}return d.set(ue,Q)}copy(a){return super.copy(a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this}toJSON(){const a=super.toJSON();return a.aX=this.aX,a.aY=this.aY,a.xRadius=this.xRadius,a.yRadius=this.yRadius,a.aStartAngle=this.aStartAngle,a.aEndAngle=this.aEndAngle,a.aClockwise=this.aClockwise,a.aRotation=this.aRotation,a}fromJSON(a){return super.fromJSON(a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this}}function dw(){let M=0,a=0,c=0,d=0;function p(S,U,F,ue){M=S,a=F,c=-3*S+3*U-2*F-ue,d=2*S-2*U+F+ue}return{initCatmullRom:function(S,U,F,ue,Q){p(U,F,Q*(F-S),Q*(ue-U))},initNonuniformCatmullRom:function(S,U,F,ue,Q,Me,ke){let Oe=(U-S)/Q-(F-S)/(Q+Me)+(F-U)/Me,Ge=(F-U)/Me-(ue-U)/(Me+ke)+(ue-F)/ke;Oe*=Me,Ge*=Me,p(U,F,Oe,Ge)},calc:function(S){const U=S*S;return M+a*S+c*U+d*(U*S)}}}const fw=new Mn,UM=new dw,zM=new dw,HM=new dw;function VM(M,a,c,d,p){const S=.5*(d-a),U=.5*(p-c),F=M*M;return(2*c-2*d+S+U)*(M*F)+(-3*c+3*d-2*S-U)*F+S*M+c}function c1(M,a,c,d){return function p3(M,a){const c=1-M;return c*c*a}(M,a)+function pw(M,a){return 2*(1-M)*M*a}(M,c)+function m3(M,a){return M*M*a}(M,d)}function Vv(M,a,c,d,p){return function A3(M,a){const c=1-M;return c*c*c*a}(M,a)+function g3(M,a){const c=1-M;return 3*c*c*M*a}(M,c)+function $P(M,a){return 3*(1-M)*M*M*a}(M,d)+function XP(M,a){return M*M*M*a}(M,p)}class _3 extends cA{constructor(a=new Ki,c=new Ki,d=new Ki,p=new Ki){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=a,this.v1=c,this.v2=d,this.v3=p}getPoint(a,c=new Ki){const d=c,p=this.v0,S=this.v1,U=this.v2,F=this.v3;return d.set(Vv(a,p.x,S.x,U.x,F.x),Vv(a,p.y,S.y,U.y,F.y)),d}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this}toJSON(){const a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this}}class YP extends cA{constructor(a=new Ki,c=new Ki){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=a,this.v2=c}getPoint(a,c=new Ki){const d=c;return 1===a?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(a).add(this.v1)),d}getPointAt(a,c){return this.getPoint(a,c)}getTangent(a,c=new Ki){return c.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,c){return this.getTangent(a,c)}copy(a){return super.copy(a),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){const a=super.toJSON();return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class b3 extends cA{constructor(a=new Ki,c=new Ki,d=new Ki){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=a,this.v1=c,this.v2=d}getPoint(a,c=new Ki){const d=c,p=this.v0,S=this.v1,U=this.v2;return d.set(c1(a,p.x,S.x,U.x),c1(a,p.y,S.y,U.y)),d}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){const a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class KP extends cA{constructor(a=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=a}getPoint(a,c=new Ki){const d=c,p=this.points,S=(p.length-1)*a,U=Math.floor(S),F=S-U,ue=p[0===U?U:U-1],Q=p[U],Me=p[U>p.length-2?p.length-1:U+1],ke=p[U>p.length-3?p.length-1:U+2];return d.set(VM(F,ue.x,Q.x,Me.x,ke.x),VM(F,ue.y,Q.y,Me.y,ke.y)),d}copy(a){super.copy(a),this.points=[];for(let c=0,d=a.points.length;c<d;c++)this.points.push(a.points[c].clone());return this}toJSON(){const a=super.toJSON();a.points=[];for(let c=0,d=this.points.length;c<d;c++)a.points.push(this.points[c].toArray());return a}fromJSON(a){super.fromJSON(a),this.points=[];for(let c=0,d=a.points.length;c<d;c++){const p=a.points[c];this.points.push((new Ki).fromArray(p))}return this}}var mw=Object.freeze({__proto__:null,ArcCurve:class WP extends uw{constructor(a,c,d,p,S,U){super(a,c,d,d,p,S,U),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class f3 extends cA{constructor(a=[],c=!1,d="centripetal",p=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=a,this.closed=c,this.curveType=d,this.tension=p}getPoint(a,c=new Mn){const d=c,p=this.points,S=p.length,U=(S-(this.closed?0:1))*a;let Q,Me,F=Math.floor(U),ue=U-F;this.closed?F+=F>0?0:(Math.floor(Math.abs(F)/S)+1)*S:0===ue&&F===S-1&&(F=S-2,ue=1),this.closed||F>0?Q=p[(F-1)%S]:(fw.subVectors(p[0],p[1]).add(p[0]),Q=fw);const ke=p[F%S],Oe=p[(F+1)%S];if(this.closed||F+2<S?Me=p[(F+2)%S]:(fw.subVectors(p[S-1],p[S-2]).add(p[S-1]),Me=fw),"centripetal"===this.curveType||"chordal"===this.curveType){const Ge="chordal"===this.curveType?.5:.25;let et=Math.pow(Q.distanceToSquared(ke),Ge),vt=Math.pow(ke.distanceToSquared(Oe),Ge),Ye=Math.pow(Oe.distanceToSquared(Me),Ge);vt<1e-4&&(vt=1),et<1e-4&&(et=vt),Ye<1e-4&&(Ye=vt),UM.initNonuniformCatmullRom(Q.x,ke.x,Oe.x,Me.x,et,vt,Ye),zM.initNonuniformCatmullRom(Q.y,ke.y,Oe.y,Me.y,et,vt,Ye),HM.initNonuniformCatmullRom(Q.z,ke.z,Oe.z,Me.z,et,vt,Ye)}else"catmullrom"===this.curveType&&(UM.initCatmullRom(Q.x,ke.x,Oe.x,Me.x,this.tension),zM.initCatmullRom(Q.y,ke.y,Oe.y,Me.y,this.tension),HM.initCatmullRom(Q.z,ke.z,Oe.z,Me.z,this.tension));return d.set(UM.calc(ue),zM.calc(ue),HM.calc(ue)),d}copy(a){super.copy(a),this.points=[];for(let c=0,d=a.points.length;c<d;c++)this.points.push(a.points[c].clone());return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this}toJSON(){const a=super.toJSON();a.points=[];for(let c=0,d=this.points.length;c<d;c++)a.points.push(this.points[c].toArray());return a.closed=this.closed,a.curveType=this.curveType,a.tension=this.tension,a}fromJSON(a){super.fromJSON(a),this.points=[];for(let c=0,d=a.points.length;c<d;c++){const p=a.points[c];this.points.push((new Mn).fromArray(p))}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this}},CubicBezierCurve:_3,CubicBezierCurve3:class y3 extends cA{constructor(a=new Mn,c=new Mn,d=new Mn,p=new Mn){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=a,this.v1=c,this.v2=d,this.v3=p}getPoint(a,c=new Mn){const d=c,p=this.v0,S=this.v1,U=this.v2,F=this.v3;return d.set(Vv(a,p.x,S.x,U.x,F.x),Vv(a,p.y,S.y,U.y,F.y),Vv(a,p.z,S.z,U.z,F.z)),d}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this}toJSON(){const a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this}},EllipseCurve:uw,LineCurve:YP,LineCurve3:class v3 extends cA{constructor(a=new Mn,c=new Mn){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=a,this.v2=c}getPoint(a,c=new Mn){const d=c;return 1===a?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(a).add(this.v1)),d}getPointAt(a,c){return this.getPoint(a,c)}getTangent(a,c=new Mn){return c.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,c){return this.getTangent(a,c)}copy(a){return super.copy(a),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){const a=super.toJSON();return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}},QuadraticBezierCurve:b3,QuadraticBezierCurve3:class x3 extends cA{constructor(a=new Mn,c=new Mn,d=new Mn){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=a,this.v1=c,this.v2=d}getPoint(a,c=new Mn){const d=c,p=this.v0,S=this.v1,U=this.v2;return d.set(c1(a,p.x,S.x,U.x),c1(a,p.y,S.y,U.y),c1(a,p.z,S.z,U.z)),d}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){const a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}},SplineCurve:KP});class w3 extends cA{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(a){this.curves.push(a)}closePath(){const a=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);return a.equals(c)||this.curves.push(new mw[!0===a.isVector2?"LineCurve":"LineCurve3"](c,a)),this}getPoint(a,c){const d=a*this.getLength(),p=this.getCurveLengths();let S=0;for(;S<p.length;){if(p[S]>=d){const U=p[S]-d,F=this.curves[S],ue=F.getLength();return F.getPointAt(0===ue?0:1-U/ue,c)}S++}return null}getLength(){const a=this.getCurveLengths();return a[a.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const a=[];let c=0;for(let d=0,p=this.curves.length;d<p;d++)c+=this.curves[d].getLength(),a.push(c);return this.cacheLengths=a,a}getSpacedPoints(a=40){const c=[];for(let d=0;d<=a;d++)c.push(this.getPoint(d/a));return this.autoClose&&c.push(c[0]),c}getPoints(a=12){const c=[];let d;for(let p=0,S=this.curves;p<S.length;p++){const U=S[p],ue=U.getPoints(U.isEllipseCurve?2*a:U.isLineCurve||U.isLineCurve3?1:U.isSplineCurve?a*U.points.length:a);for(let Q=0;Q<ue.length;Q++){const Me=ue[Q];d&&d.equals(Me)||(c.push(Me),d=Me)}}return this.autoClose&&c.length>1&&!c[c.length-1].equals(c[0])&&c.push(c[0]),c}copy(a){super.copy(a),this.curves=[];for(let c=0,d=a.curves.length;c<d;c++)this.curves.push(a.curves[c].clone());return this.autoClose=a.autoClose,this}toJSON(){const a=super.toJSON();a.autoClose=this.autoClose,a.curves=[];for(let c=0,d=this.curves.length;c<d;c++)a.curves.push(this.curves[c].toJSON());return a}fromJSON(a){super.fromJSON(a),this.autoClose=a.autoClose,this.curves=[];for(let c=0,d=a.curves.length;c<d;c++){const p=a.curves[c];this.curves.push((new mw[p.type]).fromJSON(p))}return this}}class h1 extends w3{constructor(a){super(),this.type="Path",this.currentPoint=new Ki,a&&this.setFromPoints(a)}setFromPoints(a){this.moveTo(a[0].x,a[0].y);for(let c=1,d=a.length;c<d;c++)this.lineTo(a[c].x,a[c].y);return this}moveTo(a,c){return this.currentPoint.set(a,c),this}lineTo(a,c){const d=new YP(this.currentPoint.clone(),new Ki(a,c));return this.curves.push(d),this.currentPoint.set(a,c),this}quadraticCurveTo(a,c,d,p){const S=new b3(this.currentPoint.clone(),new Ki(a,c),new Ki(d,p));return this.curves.push(S),this.currentPoint.set(d,p),this}bezierCurveTo(a,c,d,p,S,U){const F=new _3(this.currentPoint.clone(),new Ki(a,c),new Ki(d,p),new Ki(S,U));return this.curves.push(F),this.currentPoint.set(S,U),this}splineThru(a){const c=[this.currentPoint.clone()].concat(a),d=new KP(c);return this.curves.push(d),this.currentPoint.copy(a[a.length-1]),this}arc(a,c,d,p,S,U){return this.absarc(a+this.currentPoint.x,c+this.currentPoint.y,d,p,S,U),this}absarc(a,c,d,p,S,U){return this.absellipse(a,c,d,d,p,S,U),this}ellipse(a,c,d,p,S,U,F,ue){return this.absellipse(a+this.currentPoint.x,c+this.currentPoint.y,d,p,S,U,F,ue),this}absellipse(a,c,d,p,S,U,F,ue){const Q=new uw(a,c,d,p,S,U,F,ue);if(this.curves.length>0){const ke=Q.getPoint(0);ke.equals(this.currentPoint)||this.lineTo(ke.x,ke.y)}this.curves.push(Q);const Me=Q.getPoint(1);return this.currentPoint.copy(Me),this}copy(a){return super.copy(a),this.currentPoint.copy(a.currentPoint),this}toJSON(){const a=super.toJSON();return a.currentPoint=this.currentPoint.toArray(),a}fromJSON(a){return super.fromJSON(a),this.currentPoint.fromArray(a.currentPoint),this}}class uA extends ol{constructor(a=1,c=32,d=0,p=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:a,segments:c,thetaStart:d,thetaLength:p},c=Math.max(3,c);const S=[],U=[],F=[],ue=[],Q=new Mn,Me=new Ki;U.push(0,0,0),F.push(0,0,1),ue.push(.5,.5);for(let ke=0,Oe=3;ke<=c;ke++,Oe+=3){const Ge=d+ke/c*p;Q.x=a*Math.cos(Ge),Q.y=a*Math.sin(Ge),U.push(Q.x,Q.y,Q.z),F.push(0,0,1),Me.x=(U[Oe]/a+1)/2,Me.y=(U[Oe+1]/a+1)/2,ue.push(Me.x,Me.y)}for(let ke=1;ke<=c;ke++)S.push(ke,ke+1,0);this.setIndex(S),this.setAttribute("position",new Wn(U,3)),this.setAttribute("normal",new Wn(F,3)),this.setAttribute("uv",new Wn(ue,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new uA(a.radius,a.segments,a.thetaStart,a.thetaLength)}}class Gv extends h1{constructor(a){super(a),this.uuid=Ul(),this.type="Shape",this.holes=[]}getPointsHoles(a){const c=[];for(let d=0,p=this.holes.length;d<p;d++)c[d]=this.holes[d].getPoints(a);return c}extractPoints(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}}copy(a){super.copy(a),this.holes=[];for(let c=0,d=a.holes.length;c<d;c++)this.holes.push(a.holes[c].clone());return this}toJSON(){const a=super.toJSON();a.uuid=this.uuid,a.holes=[];for(let c=0,d=this.holes.length;c<d;c++)a.holes.push(this.holes[c].toJSON());return a}fromJSON(a){super.fromJSON(a),this.uuid=a.uuid,this.holes=[];for(let c=0,d=a.holes.length;c<d;c++){const p=a.holes[c];this.holes.push((new h1).fromJSON(p))}return this}}function M3(M,a,c,d,p){let S,U;if(p===function Xv(M,a,c,d){let p=0;for(let S=a,U=c-d;S<c;S+=d)p+=(M[U]-M[S])*(M[S+1]+M[U+1]),U=S;return p}(M,a,c,d)>0)for(S=a;S<c;S+=d)U=T3(S,M[S],M[S+1],U);else for(S=c-d;S>=a;S-=d)U=T3(S,M[S],M[S+1],U);return U&&Cw(U,U.next)&&(Tw(U),U=U.next),U}function dg(M,a){if(!M)return M;a||(a=M);let d,c=M;do{if(d=!1,c.steiner||!Cw(c,c.next)&&0!==Oc(c.prev,c,c.next))c=c.next;else{if(Tw(c),c=a=c.prev,c===c.next)break;d=!0}}while(d||c!==a);return a}function C_(M,a,c,d,p,S,U){if(!M)return;!U&&S&&function jM(M,a,c,d){let p=M;do{0===p.z&&(p.z=jv(p.x,p.y,a,c,d)),p.prevZ=p.prev,p.nextZ=p.next,p=p.next}while(p!==M);p.prevZ.nextZ=null,p.prevZ=null,function A8(M){let a,c,d,p,S,U,F,ue,Q=1;do{for(c=M,M=null,S=null,U=0;c;){for(U++,d=c,F=0,a=0;a<Q&&(F++,d=d.nextZ,d);a++);for(ue=Q;F>0||ue>0&&d;)0!==F&&(0===ue||!d||c.z<=d.z)?(p=c,c=c.nextZ,F--):(p=d,d=d.nextZ,ue--),S?S.nextZ=p:M=p,p.prevZ=S,S=p;c=d}S.nextZ=null,Q*=2}while(U>1)}(p)}(M,d,p,S);let ue,Q,F=M;for(;M.prev!==M.next;)if(ue=M.prev,Q=M.next,S?bw(M,d,p,S):d1(M))a.push(ue.i/c|0),a.push(M.i/c|0),a.push(Q.i/c|0),Tw(M),M=Q.next,F=Q.next;else if((M=Q)===F){U?1===U?C_(M=qM(dg(M),a,c),a,c,d,p,S,2):2===U&&qv(M,a,c,d,p,S):C_(dg(M),a,c,d,p,S,1);break}}function d1(M){const a=M.prev,c=M,d=M.next;if(Oc(a,c,d)>=0)return!1;const p=a.x,S=c.x,U=d.x,F=a.y,ue=c.y,Q=d.y,Me=p<S?p<U?p:U:S<U?S:U,ke=F<ue?F<Q?F:Q:ue<Q?ue:Q,Oe=p>S?p>U?p:U:S>U?S:U,Ge=F>ue?F>Q?F:Q:ue>Q?ue:Q;let et=d.next;for(;et!==a;){if(et.x>=Me&&et.x<=Oe&&et.y>=ke&&et.y<=Ge&&p1(p,F,S,ue,U,Q,et.x,et.y)&&Oc(et.prev,et,et.next)>=0)return!1;et=et.next}return!0}function bw(M,a,c,d){const p=M.prev,S=M,U=M.next;if(Oc(p,S,U)>=0)return!1;const F=p.x,ue=S.x,Q=U.x,Me=p.y,ke=S.y,Oe=U.y,Ge=F<ue?F<Q?F:Q:ue<Q?ue:Q,et=Me<ke?Me<Oe?Me:Oe:ke<Oe?ke:Oe,vt=F>ue?F>Q?F:Q:ue>Q?ue:Q,Ye=Me>ke?Me>Oe?Me:Oe:ke>Oe?ke:Oe,je=jv(Ge,et,a,c,d),Rt=jv(vt,Ye,a,c,d);let At=M.prevZ,Ht=M.nextZ;for(;At&&At.z>=je&&Ht&&Ht.z<=Rt;){if(At.x>=Ge&&At.x<=vt&&At.y>=et&&At.y<=Ye&&At!==p&&At!==U&&p1(F,Me,ue,ke,Q,Oe,At.x,At.y)&&Oc(At.prev,At,At.next)>=0||(At=At.prevZ,Ht.x>=Ge&&Ht.x<=vt&&Ht.y>=et&&Ht.y<=Ye&&Ht!==p&&Ht!==U&&p1(F,Me,ue,ke,Q,Oe,Ht.x,Ht.y)&&Oc(Ht.prev,Ht,Ht.next)>=0))return!1;Ht=Ht.nextZ}for(;At&&At.z>=je;){if(At.x>=Ge&&At.x<=vt&&At.y>=et&&At.y<=Ye&&At!==p&&At!==U&&p1(F,Me,ue,ke,Q,Oe,At.x,At.y)&&Oc(At.prev,At,At.next)>=0)return!1;At=At.prevZ}for(;Ht&&Ht.z<=Rt;){if(Ht.x>=Ge&&Ht.x<=vt&&Ht.y>=et&&Ht.y<=Ye&&Ht!==p&&Ht!==U&&p1(F,Me,ue,ke,Q,Oe,Ht.x,Ht.y)&&Oc(Ht.prev,Ht,Ht.next)>=0)return!1;Ht=Ht.nextZ}return!0}function qM(M,a,c){let d=M;do{const p=d.prev,S=d.next.next;!Cw(p,S)&&Mw(p,d,d.next,S)&&fg(p,S)&&fg(S,p)&&(a.push(p.i/c|0),a.push(d.i/c|0),a.push(S.i/c|0),Tw(d),Tw(d.next),d=M=S),d=d.next}while(d!==M);return dg(d)}function qv(M,a,c,d,p,S){let U=M;do{let F=U.next.next;for(;F!==U.prev;){if(U.i!==F.i&&E3(U,F)){let ue=Sw(U,F);return U=dg(U,U.next),ue=dg(ue,ue.next),C_(U,a,c,d,p,S,0),void C_(ue,a,c,d,p,S,0)}F=F.next}U=U.next}while(U!==M)}function f1(M,a){return M.x-a.x}function QM(M,a){const c=function ww(M,a){let p,c=a,d=-1/0;const S=M.x,U=M.y;do{if(U<=c.y&&U>=c.next.y&&c.next.y!==c.y){const Oe=c.x+(U-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(Oe<=S&&Oe>d&&(d=Oe,p=c.x<c.next.x?c:c.next,Oe===S))return p}c=c.next}while(c!==a);if(!p)return null;const F=p,ue=p.x,Q=p.y;let ke,Me=1/0;c=p;do{S>=c.x&&c.x>=ue&&S!==c.x&&p1(U<Q?S:d,U,ue,Q,U<Q?d:S,U,c.x,c.y)&&(ke=Math.abs(U-c.y)/(S-c.x),fg(c,M)&&(ke<Me||ke===Me&&(c.x>p.x||c.x===p.x&&Qv(p,c)))&&(p=c,Me=ke)),c=c.next}while(c!==F);return p}(M,a);if(!c)return a;const d=Sw(c,M);return dg(d,d.next),dg(c,c.next)}function Qv(M,a){return Oc(M.prev,M,a.prev)<0&&Oc(a.next,M,M.next)<0}function jv(M,a,c,d,p){return(M=1431655765&((M=858993459&((M=252645135&((M=16711935&((M=(M-c)*p|0)|M<<8))|M<<4))|M<<2))|M<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-d)*p|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function Wv(M){let a=M,c=M;do{(a.x<c.x||a.x===c.x&&a.y<c.y)&&(c=a),a=a.next}while(a!==M);return c}function p1(M,a,c,d,p,S,U,F){return(p-U)*(a-F)>=(M-U)*(S-F)&&(M-U)*(d-F)>=(c-U)*(a-F)&&(c-U)*(S-F)>=(p-U)*(d-F)}function E3(M,a){return M.next.i!==a.i&&M.prev.i!==a.i&&!function ZP(M,a){let c=M;do{if(c.i!==M.i&&c.next.i!==M.i&&c.i!==a.i&&c.next.i!==a.i&&Mw(c,c.next,M,a))return!0;c=c.next}while(c!==M);return!1}(M,a)&&(fg(M,a)&&fg(a,M)&&function S3(M,a){let c=M,d=!1;const p=(M.x+a.x)/2,S=(M.y+a.y)/2;do{c.y>S!=c.next.y>S&&c.next.y!==c.y&&p<(c.next.x-c.x)*(S-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next}while(c!==M);return d}(M,a)&&(Oc(M.prev,M,a.prev)||Oc(M,a.prev,a))||Cw(M,a)&&Oc(M.prev,M,M.next)>0&&Oc(a.prev,a,a.next)>0)}function Oc(M,a,c){return(a.y-M.y)*(c.x-a.x)-(a.x-M.x)*(c.y-a.y)}function Cw(M,a){return M.x===a.x&&M.y===a.y}function Mw(M,a,c,d){const p=Ew(Oc(M,a,c)),S=Ew(Oc(M,a,d)),U=Ew(Oc(c,d,M)),F=Ew(Oc(c,d,a));return!!(p!==S&&U!==F||0===p&&$v(M,c,a)||0===S&&$v(M,d,a)||0===U&&$v(c,M,d)||0===F&&$v(c,a,d))}function $v(M,a,c){return a.x<=Math.max(M.x,c.x)&&a.x>=Math.min(M.x,c.x)&&a.y<=Math.max(M.y,c.y)&&a.y>=Math.min(M.y,c.y)}function Ew(M){return M>0?1:M<0?-1:0}function fg(M,a){return Oc(M.prev,M,M.next)<0?Oc(M,a,M.next)>=0&&Oc(M,M.prev,a)>=0:Oc(M,a,M.prev)<0||Oc(M,M.next,a)<0}function Sw(M,a){const c=new D3(M.i,M.x,M.y),d=new D3(a.i,a.x,a.y),p=M.next,S=a.prev;return M.next=a,a.prev=M,c.next=p,p.prev=c,d.next=c,c.prev=d,S.next=d,d.prev=S,d}function T3(M,a,c,d){const p=new D3(M,a,c);return d?(p.next=d.next,p.prev=d,d.next.prev=p,d.next=p):(p.prev=p,p.next=p),p}function Tw(M){M.next.prev=M.prev,M.prev.next=M.next,M.prevZ&&(M.prevZ.nextZ=M.nextZ),M.nextZ&&(M.nextZ.prevZ=M.prevZ)}function D3(M,a,c){this.i=M,this.x=a,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class dA{static area(a){const c=a.length;let d=0;for(let p=c-1,S=0;S<c;p=S++)d+=a[p].x*a[S].y-a[S].x*a[p].y;return.5*d}static isClockWise(a){return dA.area(a)<0}static triangulateShape(a,c){const d=[],p=[],S=[];Yv(a),Dw(d,a);let U=a.length;c.forEach(Yv);for(let ue=0;ue<c.length;ue++)p.push(U),U+=c[ue].length,Dw(d,c[ue]);const F=function(M,a,c=2){const d=a&&a.length,p=d?a[0]*c:M.length;let S=M3(M,0,p,c,!0);const U=[];if(!S||S.next===S.prev)return U;let F,ue,Q,Me,ke,Oe,Ge;if(d&&(S=function xw(M,a,c,d){const p=[];let S,U,F,ue,Q;for(S=0,U=a.length;S<U;S++)F=a[S]*d,ue=S<U-1?a[S+1]*d:M.length,Q=M3(M,F,ue,d,!1),Q===Q.next&&(Q.steiner=!0),p.push(Wv(Q));for(p.sort(f1),S=0;S<p.length;S++)c=QM(p[S],c);return c}(M,a,S,c)),M.length>80*c){F=Q=M[0],ue=Me=M[1];for(let et=c;et<p;et+=c)ke=M[et],Oe=M[et+1],ke<F&&(F=ke),Oe<ue&&(ue=Oe),ke>Q&&(Q=ke),Oe>Me&&(Me=Oe);Ge=Math.max(Q-F,Me-ue),Ge=0!==Ge?32767/Ge:0}return C_(S,U,c,F,ue,Ge,0),U}(d,p);for(let ue=0;ue<F.length;ue+=3)S.push(F.slice(ue,ue+3));return S}}function Yv(M){const a=M.length;a>2&&M[a-1].equals(M[0])&&M.pop()}function Dw(M,a){for(let c=0;c<a.length;c++)M.push(a[c].x),M.push(a[c].y)}class Kv extends ol{constructor(a=new Gv([new Ki(.5,.5),new Ki(-.5,.5),new Ki(-.5,-.5),new Ki(.5,-.5)]),c={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:a,options:c},a=Array.isArray(a)?a:[a];const d=this,p=[],S=[];for(let F=0,ue=a.length;F<ue;F++)U(a[F]);function U(F){const ue=[],Q=void 0!==c.curveSegments?c.curveSegments:12,Me=void 0!==c.steps?c.steps:1,ke=void 0!==c.depth?c.depth:1;let Oe=void 0===c.bevelEnabled||c.bevelEnabled,Ge=void 0!==c.bevelThickness?c.bevelThickness:.2,et=void 0!==c.bevelSize?c.bevelSize:Ge-.1,vt=void 0!==c.bevelOffset?c.bevelOffset:0,Ye=void 0!==c.bevelSegments?c.bevelSegments:3;const je=c.extrudePath,Rt=void 0!==c.UVGenerator?c.UVGenerator:JP;let At,Pn,yn,xn,qn,Ht=!1;je&&(At=je.getSpacedPoints(Me),Ht=!0,Oe=!1,Pn=je.computeFrenetFrames(Me,!1),yn=new Mn,xn=new Mn,qn=new Mn),Oe||(Ye=0,Ge=0,et=0,vt=0);const wi=F.extractPoints(Q);let Ut=wi.shape;const En=wi.holes;if(!dA.isClockWise(Ut)){Ut=Ut.reverse();for(let On=0,Zr=En.length;On<Zr;On++){const Zi=En[On];dA.isClockWise(Zi)&&(En[On]=Zi.reverse())}}const lr=dA.triangulateShape(Ut,En),Yn=Ut;for(let On=0,Zr=En.length;On<Zr;On++)Ut=Ut.concat(En[On]);function Qi(On,Zr,Zi){return Zr||console.error("THREE.ExtrudeGeometry: vec does not exist"),On.clone().addScaledVector(Zr,Zi)}const Oi=Ut.length,er=lr.length;function Xi(On,Zr,Zi){let $r,fr,As;const Ms=On.x-Zr.x,Zs=On.y-Zr.y,za=Zi.x-On.x,wn=Zi.y-On.y,Gt=Ms*Ms+Zs*Zs;if(Math.abs(Ms*wn-Zs*za)>Number.EPSILON){const ji=Math.sqrt(Gt),Lr=Math.sqrt(za*za+wn*wn),br=Zr.x-Zs/ji,ta=Zr.y+Ms/ji,cs=((Zi.x-wn/Lr-br)*wn-(Zi.y+za/Lr-ta)*za)/(Ms*wn-Zs*za);$r=br+Ms*cs-On.x,fr=ta+Zs*cs-On.y;const Eo=$r*$r+fr*fr;if(Eo<=2)return new Ki($r,fr);As=Math.sqrt(Eo/2)}else{let ji=!1;Ms>Number.EPSILON?za>Number.EPSILON&&(ji=!0):Ms<-Number.EPSILON?za<-Number.EPSILON&&(ji=!0):Math.sign(Zs)===Math.sign(wn)&&(ji=!0),ji?($r=-Zs,fr=Ms,As=Math.sqrt(Gt)):($r=Ms,fr=Zs,As=Math.sqrt(Gt/2))}return new Ki($r/As,fr/As)}const Vi=[];for(let On=0,Zr=Yn.length,Zi=Zr-1,$r=On+1;On<Zr;On++,Zi++,$r++)Zi===Zr&&(Zi=0),$r===Zr&&($r=0),Vi[On]=Xi(Yn[On],Yn[Zi],Yn[$r]);const Vr=[];let Hr,Ns=Vi.concat();for(let On=0,Zr=En.length;On<Zr;On++){const Zi=En[On];Hr=[];for(let $r=0,fr=Zi.length,As=fr-1,Ms=$r+1;$r<fr;$r++,As++,Ms++)As===fr&&(As=0),Ms===fr&&(Ms=0),Hr[$r]=Xi(Zi[$r],Zi[As],Zi[Ms]);Vr.push(Hr),Ns=Ns.concat(Hr)}for(let On=0;On<Ye;On++){const Zr=On/Ye,Zi=Ge*Math.cos(Zr*Math.PI/2),$r=et*Math.sin(Zr*Math.PI/2)+vt;for(let fr=0,As=Yn.length;fr<As;fr++){const Ms=Qi(Yn[fr],Vi[fr],$r);bo(Ms.x,Ms.y,-Zi)}for(let fr=0,As=En.length;fr<As;fr++){const Ms=En[fr];Hr=Vr[fr];for(let Zs=0,za=Ms.length;Zs<za;Zs++){const wn=Qi(Ms[Zs],Hr[Zs],$r);bo(wn.x,wn.y,-Zi)}}}const Yo=et+vt;for(let On=0;On<Oi;On++){const Zr=Oe?Qi(Ut[On],Ns[On],Yo):Ut[On];Ht?(xn.copy(Pn.normals[0]).multiplyScalar(Zr.x),yn.copy(Pn.binormals[0]).multiplyScalar(Zr.y),qn.copy(At[0]).add(xn).add(yn),bo(qn.x,qn.y,qn.z)):bo(Zr.x,Zr.y,0)}for(let On=1;On<=Me;On++)for(let Zr=0;Zr<Oi;Zr++){const Zi=Oe?Qi(Ut[Zr],Ns[Zr],Yo):Ut[Zr];Ht?(xn.copy(Pn.normals[On]).multiplyScalar(Zi.x),yn.copy(Pn.binormals[On]).multiplyScalar(Zi.y),qn.copy(At[On]).add(xn).add(yn),bo(qn.x,qn.y,qn.z)):bo(Zi.x,Zi.y,ke/Me*On)}for(let On=Ye-1;On>=0;On--){const Zr=On/Ye,Zi=Ge*Math.cos(Zr*Math.PI/2),$r=et*Math.sin(Zr*Math.PI/2)+vt;for(let fr=0,As=Yn.length;fr<As;fr++){const Ms=Qi(Yn[fr],Vi[fr],$r);bo(Ms.x,Ms.y,ke+Zi)}for(let fr=0,As=En.length;fr<As;fr++){const Ms=En[fr];Hr=Vr[fr];for(let Zs=0,za=Ms.length;Zs<za;Zs++){const wn=Qi(Ms[Zs],Hr[Zs],$r);Ht?bo(wn.x,wn.y+At[Me-1].y,At[Me-1].x+Zi):bo(wn.x,wn.y,ke+Zi)}}}function Ds(On,Zr){let Zi=On.length;for(;--Zi>=0;){const $r=Zi;let fr=Zi-1;fr<0&&(fr=On.length-1);for(let As=0,Ms=Me+2*Ye;As<Ms;As++){const Zs=Oi*As,za=Oi*(As+1);Qs(Zr+$r+Zs,Zr+fr+Zs,Zr+fr+za,Zr+$r+za)}}}function bo(On,Zr,Zi){ue.push(On),ue.push(Zr),ue.push(Zi)}function eo(On,Zr,Zi){fa(On),fa(Zr),fa(Zi);const $r=p.length/3,fr=Rt.generateTopUV(d,p,$r-3,$r-2,$r-1);Ao(fr[0]),Ao(fr[1]),Ao(fr[2])}function Qs(On,Zr,Zi,$r){fa(On),fa(Zr),fa($r),fa(Zr),fa(Zi),fa($r);const fr=p.length/3,As=Rt.generateSideWallUV(d,p,fr-6,fr-3,fr-2,fr-1);Ao(As[0]),Ao(As[1]),Ao(As[3]),Ao(As[1]),Ao(As[2]),Ao(As[3])}function fa(On){p.push(ue[3*On+0]),p.push(ue[3*On+1]),p.push(ue[3*On+2])}function Ao(On){S.push(On.x),S.push(On.y)}(function Hi(){const On=p.length/3;if(Oe){let Zr=0,Zi=Oi*Zr;for(let $r=0;$r<er;$r++){const fr=lr[$r];eo(fr[2]+Zi,fr[1]+Zi,fr[0]+Zi)}Zr=Me+2*Ye,Zi=Oi*Zr;for(let $r=0;$r<er;$r++){const fr=lr[$r];eo(fr[0]+Zi,fr[1]+Zi,fr[2]+Zi)}}else{for(let Zr=0;Zr<er;Zr++){const Zi=lr[Zr];eo(Zi[2],Zi[1],Zi[0])}for(let Zr=0;Zr<er;Zr++){const Zi=lr[Zr];eo(Zi[0]+Oi*Me,Zi[1]+Oi*Me,Zi[2]+Oi*Me)}}d.addGroup(On,p.length/3-On,0)})(),function Or(){const On=p.length/3;let Zr=0;Ds(Yn,Zr),Zr+=Yn.length;for(let Zi=0,$r=En.length;Zi<$r;Zi++){const fr=En[Zi];Ds(fr,Zr),Zr+=fr.length}d.addGroup(On,p.length/3-On,1)}()}this.setAttribute("position",new Wn(p,3)),this.setAttribute("uv",new Wn(S,2)),this.computeVertexNormals()}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}toJSON(){const a=super.toJSON();return function I3(M,a,c){if(c.shapes=[],Array.isArray(M))for(let d=0,p=M.length;d<p;d++)c.shapes.push(M[d].uuid);else c.shapes.push(M.uuid);return c.options=Object.assign({},a),void 0!==a.extrudePath&&(c.options.extrudePath=a.extrudePath.toJSON()),c}(this.parameters.shapes,this.parameters.options,a)}static fromJSON(a,c){const d=[];for(let S=0,U=a.shapes.length;S<U;S++)d.push(c[a.shapes[S]]);const p=a.options.extrudePath;return void 0!==p&&(a.options.extrudePath=(new mw[p.type]).fromJSON(p)),new Kv(d,a.options)}}const JP={generateTopUV:function(M,a,c,d,p){const F=a[3*d],ue=a[3*d+1],Q=a[3*p],Me=a[3*p+1];return[new Ki(a[3*c],a[3*c+1]),new Ki(F,ue),new Ki(Q,Me)]},generateSideWallUV:function(M,a,c,d,p,S){const U=a[3*c],F=a[3*c+1],ue=a[3*c+2],Q=a[3*d],Me=a[3*d+1],ke=a[3*d+2],Oe=a[3*p],Ge=a[3*p+1],et=a[3*p+2],vt=a[3*S],Ye=a[3*S+1],je=a[3*S+2];return Math.abs(F-Me)<Math.abs(U-Q)?[new Ki(U,1-ue),new Ki(Q,1-ke),new Ki(Oe,1-et),new Ki(vt,1-je)]:[new Ki(F,1-ue),new Ki(Me,1-ke),new Ki(Ge,1-et),new Ki(Ye,1-je)]}};class Jv extends ol{constructor(a=1,c=32,d=16,p=0,S=2*Math.PI,U=0,F=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:a,widthSegments:c,heightSegments:d,phiStart:p,phiLength:S,thetaStart:U,thetaLength:F},c=Math.max(3,Math.floor(c)),d=Math.max(2,Math.floor(d));const ue=Math.min(U+F,Math.PI);let Q=0;const Me=[],ke=new Mn,Oe=new Mn,Ge=[],et=[],vt=[],Ye=[];for(let je=0;je<=d;je++){const Rt=[],At=je/d;let Ht=0;0===je&&0===U?Ht=.5/c:je===d&&ue===Math.PI&&(Ht=-.5/c);for(let Pn=0;Pn<=c;Pn++){const yn=Pn/c;ke.x=-a*Math.cos(p+yn*S)*Math.sin(U+At*F),ke.y=a*Math.cos(U+At*F),ke.z=a*Math.sin(p+yn*S)*Math.sin(U+At*F),et.push(ke.x,ke.y,ke.z),Oe.copy(ke).normalize(),vt.push(Oe.x,Oe.y,Oe.z),Ye.push(yn+Ht,1-At),Rt.push(Q++)}Me.push(Rt)}for(let je=0;je<d;je++)for(let Rt=0;Rt<c;Rt++){const Ht=Me[je][Rt],Pn=Me[je+1][Rt],yn=Me[je+1][Rt+1];(0!==je||U>0)&&Ge.push(Me[je][Rt+1],Ht,yn),(je!==d-1||ue<Math.PI)&&Ge.push(Ht,Pn,yn)}this.setIndex(Ge),this.setAttribute("position",new Wn(et,3)),this.setAttribute("normal",new Wn(vt,3)),this.setAttribute("uv",new Wn(Ye,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new Jv(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength)}}class R3 extends _l{constructor(a){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new io(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new io(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ki(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new kc,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.defines={STANDARD:""},this.color.copy(a.color),this.roughness=a.roughness,this.metalness=a.metalness,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.roughnessMap=a.roughnessMap,this.metalnessMap=a.metalnessMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.envMapIntensity=a.envMapIntensity,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class nb extends R3{constructor(a){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ki(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Yl(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(c){this.ior=(1+.4*c)/(1-.4*c)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new io(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new io(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new io(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(a)}get anisotropy(){return this._anisotropy}set anisotropy(a){this._anisotropy>0!=a>0&&this.version++,this._anisotropy=a}get clearcoat(){return this._clearcoat}set clearcoat(a){this._clearcoat>0!=a>0&&this.version++,this._clearcoat=a}get iridescence(){return this._iridescence}set iridescence(a){this._iridescence>0!=a>0&&this.version++,this._iridescence=a}get sheen(){return this._sheen}set sheen(a){this._sheen>0!=a>0&&this.version++,this._sheen=a}get transmission(){return this._transmission}set transmission(a){this._transmission>0!=a>0&&this.version++,this._transmission=a}copy(a){return super.copy(a),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=a.anisotropy,this.anisotropyRotation=a.anisotropyRotation,this.anisotropyMap=a.anisotropyMap,this.clearcoat=a.clearcoat,this.clearcoatMap=a.clearcoatMap,this.clearcoatRoughness=a.clearcoatRoughness,this.clearcoatRoughnessMap=a.clearcoatRoughnessMap,this.clearcoatNormalMap=a.clearcoatNormalMap,this.clearcoatNormalScale.copy(a.clearcoatNormalScale),this.ior=a.ior,this.iridescence=a.iridescence,this.iridescenceMap=a.iridescenceMap,this.iridescenceIOR=a.iridescenceIOR,this.iridescenceThicknessRange=[...a.iridescenceThicknessRange],this.iridescenceThicknessMap=a.iridescenceThicknessMap,this.sheen=a.sheen,this.sheenColor.copy(a.sheenColor),this.sheenColorMap=a.sheenColorMap,this.sheenRoughness=a.sheenRoughness,this.sheenRoughnessMap=a.sheenRoughnessMap,this.transmission=a.transmission,this.transmissionMap=a.transmissionMap,this.thickness=a.thickness,this.thicknessMap=a.thicknessMap,this.attenuationDistance=a.attenuationDistance,this.attenuationColor.copy(a.attenuationColor),this.specularIntensity=a.specularIntensity,this.specularIntensityMap=a.specularIntensityMap,this.specularColor.copy(a.specularColor),this.specularColorMap=a.specularColorMap,this}}class Ow extends _l{constructor(a){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new io(16777215),this.specular=new io(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new io(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ki(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new kc,this.combine=Ne,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.specular.copy(a.specular),this.shininess=a.shininess,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class WM extends _l{constructor(a){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new io(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new io(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ki(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.gradientMap=a.gradientMap,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.fog=a.fog,this}}class $M extends _l{constructor(a){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ki(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(a)}copy(a){return super.copy(a),this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.flatShading=a.flatShading,this}}class XM extends _l{constructor(a){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new io(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new io(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ki(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new kc,this.combine=Ne,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class g0 extends _l{constructor(a){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new io(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ki(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.defines={MATCAP:""},this.color.copy(a.color),this.matcap=a.matcap,this.map=a.map,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.flatShading=a.flatShading,this.fog=a.fog,this}}class k3 extends w_{constructor(a){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(a)}copy(a){return super.copy(a),this.scale=a.scale,this.dashSize=a.dashSize,this.gapSize=a.gapSize,this}}const _0={enabled:!1,files:{},add:function(M,a){!1!==this.enabled&&(this.files[M]=a)},get:function(M){if(!1!==this.enabled)return this.files[M]},remove:function(M){delete this.files[M]},clear:function(){this.files={}}};class F3{constructor(a,c,d){const p=this;let ue,S=!1,U=0,F=0;const Q=[];this.onStart=void 0,this.onLoad=a,this.onProgress=c,this.onError=d,this.itemStart=function(Me){F++,!1===S&&void 0!==p.onStart&&p.onStart(Me,U,F),S=!0},this.itemEnd=function(Me){U++,void 0!==p.onProgress&&p.onProgress(Me,U,F),U===F&&(S=!1,void 0!==p.onLoad&&p.onLoad())},this.itemError=function(Me){void 0!==p.onError&&p.onError(Me)},this.resolveURL=function(Me){return ue?ue(Me):Me},this.setURLModifier=function(Me){return ue=Me,this},this.addHandler=function(Me,ke){return Q.push(Me,ke),this},this.removeHandler=function(Me){const ke=Q.indexOf(Me);return-1!==ke&&Q.splice(ke,2),this},this.getHandler=function(Me){for(let ke=0,Oe=Q.length;ke<Oe;ke+=2){const Ge=Q[ke],et=Q[ke+1];if(Ge.global&&(Ge.lastIndex=0),Ge.test(Me))return et}return null}}}const tR=new F3;let lm=(()=>{class M{constructor(c){this.manager=void 0!==c?c:tR,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(c,d){const p=this;return new Promise(function(S,U){p.load(c,S,d,U)})}parse(){}setCrossOrigin(c){return this.crossOrigin=c,this}setWithCredentials(c){return this.withCredentials=c,this}setPath(c){return this.path=c,this}setResourcePath(c){return this.resourcePath=c,this}setRequestHeader(c){return this.requestHeader=c,this}}return M.DEFAULT_MATERIAL_NAME="__DEFAULT",M})();Error;class Lw extends lm{constructor(a){super(a)}load(a,c,d,p){void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);const S=this,U=_0.get(a);if(void 0!==U)return S.manager.itemStart(a),setTimeout(function(){c&&c(U),S.manager.itemEnd(a)},0),U;const F=zl("img");function ue(){Me(),_0.add(a,this),c&&c(this),S.manager.itemEnd(a)}function Q(ke){Me(),p&&p(ke),S.manager.itemError(a),S.manager.itemEnd(a)}function Me(){F.removeEventListener("load",ue,!1),F.removeEventListener("error",Q,!1)}return F.addEventListener("load",ue,!1),F.addEventListener("error",Q,!1),"data:"!==a.slice(0,5)&&void 0!==this.crossOrigin&&(F.crossOrigin=this.crossOrigin),S.manager.itemStart(a),F.src=a,F}}class O3 extends lm{constructor(a){super(a)}load(a,c,d,p){const S=new _u,U=new Lw(this.manager);return U.setCrossOrigin(this.crossOrigin),U.setPath(this.path),U.load(a,function(F){S.image=F,S.needsUpdate=!0,void 0!==c&&c(S)},d,p),S}}class I_ extends Vl{constructor(a,c=1){super(),this.isLight=!0,this.type="Light",this.color=new io(a),this.intensity=c}dispose(){}copy(a,c){return super.copy(a,c),this.color.copy(a.color),this.intensity=a.intensity,this}toJSON(a){const c=super.toJSON(a);return c.object.color=this.color.getHex(),c.object.intensity=this.intensity,void 0!==this.groundColor&&(c.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(c.object.distance=this.distance),void 0!==this.angle&&(c.object.angle=this.angle),void 0!==this.decay&&(c.object.decay=this.decay),void 0!==this.penumbra&&(c.object.penumbra=this.penumbra),void 0!==this.shadow&&(c.object.shadow=this.shadow.toJSON()),c}}class Q3 extends I_{constructor(a,c,d){super(a,d),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Vl.DEFAULT_UP),this.updateMatrix(),this.groundColor=new io(c)}copy(a,c){return super.copy(a,c),this.groundColor.copy(a.groundColor),this}}const cb=new mo,uR=new Mn,dR=new Mn;class hb{constructor(a){this.camera=a,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ki(512,512),this.map=null,this.mapPass=null,this.matrix=new mo,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ff,this._frameExtents=new Ki(1,1),this._viewportCount=1,this._viewports=[new Ya(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(a){const c=this.camera,d=this.matrix;uR.setFromMatrixPosition(a.matrixWorld),c.position.copy(uR),dR.setFromMatrixPosition(a.target.matrixWorld),c.lookAt(dR),c.updateMatrixWorld(),cb.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),this._frustum.setFromProjectionMatrix(cb),d.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),d.multiply(cb)}getViewport(a){return this._viewports[a]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(a){return this.camera=a.camera.clone(),this.bias=a.bias,this.radius=a.radius,this.mapSize.copy(a.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const a={};return 0!==this.bias&&(a.bias=this.bias),0!==this.normalBias&&(a.normalBias=this.normalBias),1!==this.radius&&(a.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(a.mapSize=this.mapSize.toArray()),a.camera=this.camera.toJSON(!1).object,delete a.camera.matrix,a}}class Qw extends hb{constructor(){super(new Zh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class rE extends I_{constructor(a,c){super(a,c),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Vl.DEFAULT_UP),this.updateMatrix(),this.target=new Vl,this.shadow=new Qw}dispose(){this.shadow.dispose()}copy(a){return super.copy(a),this.target=a.target.clone(),this.shadow=a.shadow.clone(),this}}class sE extends I_{constructor(a,c){super(a,c),this.isAmbientLight=!0,this.type="AmbientLight"}}function ub(M,a,c){return!M||!c&&M.constructor===a?M:"number"==typeof a.BYTES_PER_ELEMENT?new a(M):Array.prototype.slice.call(M)}class aE{constructor(a,c,d,p){this.parameterPositions=a,this._cachedIndex=0,this.resultBuffer=void 0!==p?p:new c.constructor(d),this.sampleValues=c,this.valueSize=d,this.settings=null,this.DefaultSettings_={}}evaluate(a){const c=this.parameterPositions;let d=this._cachedIndex,p=c[d],S=c[d-1];e:{t:{let U;n:{i:if(!(a<p)){for(let F=d+2;;){if(void 0===p){if(a<S)break i;return d=c.length,this._cachedIndex=d,this.copySampleValue_(d-1)}if(d===F)break;if(S=p,p=c[++d],a<p)break t}U=c.length;break n}if(a>=S)break e;{const F=c[1];a<F&&(d=2,S=F);for(let ue=d-2;;){if(void 0===S)return this._cachedIndex=0,this.copySampleValue_(0);if(d===ue)break;if(p=S,S=c[--d-1],a>=S)break t}U=d,d=0}}for(;d<U;){const F=d+U>>>1;a<c[F]?U=F:d=F+1}if(p=c[d],S=c[d-1],void 0===S)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===p)return d=c.length,this._cachedIndex=d,this.copySampleValue_(d-1)}this._cachedIndex=d,this.intervalChanged_(d,S,p)}return this.interpolate_(d,S,a,p)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(a){const c=this.resultBuffer,d=this.sampleValues,p=this.valueSize,S=a*p;for(let U=0;U!==p;++U)c[U]=d[S+U];return c}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class gR extends aE{constructor(a,c,d,p){super(a,c,d,p),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(a,c,d){const p=this.parameterPositions;let S=a-2,U=a+1,F=p[S],ue=p[U];if(void 0===F)switch(this.getSettings_().endingStart){case 2401:S=a,F=2*c-d;break;case 2402:S=p.length-2,F=c+p[S]-p[S+1];break;default:S=a,F=d}if(void 0===ue)switch(this.getSettings_().endingEnd){case 2401:U=a,ue=2*d-c;break;case 2402:U=1,ue=d+p[1]-p[0];break;default:U=a-1,ue=c}const Q=.5*(d-c),Me=this.valueSize;this._weightPrev=Q/(c-F),this._weightNext=Q/(ue-d),this._offsetPrev=S*Me,this._offsetNext=U*Me}interpolate_(a,c,d,p){const S=this.resultBuffer,U=this.sampleValues,F=this.valueSize,ue=a*F,Q=ue-F,Me=this._offsetPrev,ke=this._offsetNext,Oe=this._weightPrev,Ge=this._weightNext,et=(d-c)/(p-c),vt=et*et,Ye=vt*et,je=-Oe*Ye+2*Oe*vt-Oe*et,Rt=(1+Oe)*Ye+(-1.5-2*Oe)*vt+(-.5+Oe)*et+1,At=(-1-Ge)*Ye+(1.5+Ge)*vt+.5*et,Ht=Ge*Ye-Ge*vt;for(let Pn=0;Pn!==F;++Pn)S[Pn]=je*U[Me+Pn]+Rt*U[Q+Pn]+At*U[ue+Pn]+Ht*U[ke+Pn];return S}}class C8 extends aE{constructor(a,c,d,p){super(a,c,d,p)}interpolate_(a,c,d,p){const S=this.resultBuffer,U=this.sampleValues,F=this.valueSize,ue=a*F,Q=ue-F,Me=(d-c)/(p-c),ke=1-Me;for(let Oe=0;Oe!==F;++Oe)S[Oe]=U[Q+Oe]*ke+U[ue+Oe]*Me;return S}}class M8 extends aE{constructor(a,c,d,p){super(a,c,d,p)}interpolate_(a){return this.copySampleValue_(a-1)}}class hm{constructor(a,c,d,p){if(void 0===a)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===c||0===c.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a,this.times=ub(c,this.TimeBufferType),this.values=ub(d,this.ValueBufferType),this.setInterpolation(p||this.DefaultInterpolation)}static toJSON(a){const c=a.constructor;let d;if(c.toJSON!==this.toJSON)d=c.toJSON(a);else{d={name:a.name,times:ub(a.times,Array),values:ub(a.values,Array)};const p=a.getInterpolation();p!==a.DefaultInterpolation&&(d.interpolation=p)}return d.type=a.ValueTypeName,d}InterpolantFactoryMethodDiscrete(a){return new M8(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodLinear(a){return new C8(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodSmooth(a){return new gR(this.times,this.values,this.getValueSize(),a)}setInterpolation(a){let c;switch(a){case 2300:c=this.InterpolantFactoryMethodDiscrete;break;case 2301:c=this.InterpolantFactoryMethodLinear;break;case 2302:c=this.InterpolantFactoryMethodSmooth}if(void 0===c){const d="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(a===this.DefaultInterpolation)throw new Error(d);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",d),this}return this.createInterpolant=c,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(a){if(0!==a){const c=this.times;for(let d=0,p=c.length;d!==p;++d)c[d]+=a}return this}scale(a){if(1!==a){const c=this.times;for(let d=0,p=c.length;d!==p;++d)c[d]*=a}return this}trim(a,c){const d=this.times,p=d.length;let S=0,U=p-1;for(;S!==p&&d[S]<a;)++S;for(;-1!==U&&d[U]>c;)--U;if(++U,0!==S||U!==p){S>=U&&(U=Math.max(U,1),S=U-1);const F=this.getValueSize();this.times=d.slice(S,U),this.values=this.values.slice(S*F,U*F)}return this}validate(){let a=!0;const c=this.getValueSize();c-Math.floor(c)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1);const d=this.times,p=this.values,S=d.length;0===S&&(console.error("THREE.KeyframeTrack: Track is empty.",this),a=!1);let U=null;for(let F=0;F!==S;F++){const ue=d[F];if("number"==typeof ue&&isNaN(ue)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,F,ue),a=!1;break}if(null!==U&&U>ue){console.error("THREE.KeyframeTrack: Out of order keys.",this,F,ue,U),a=!1;break}U=ue}if(void 0!==p&&function w1(M){return ArrayBuffer.isView(M)&&!(M instanceof DataView)}(p))for(let F=0,ue=p.length;F!==ue;++F){const Q=p[F];if(isNaN(Q)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,F,Q),a=!1;break}}return a}optimize(){const a=this.times.slice(),c=this.values.slice(),d=this.getValueSize(),p=2302===this.getInterpolation(),S=a.length-1;let U=1;for(let F=1;F<S;++F){let ue=!1;const Q=a[F];if(Q!==a[F+1]&&(1!==F||Q!==a[0]))if(p)ue=!0;else{const ke=F*d,Oe=ke-d,Ge=ke+d;for(let et=0;et!==d;++et){const vt=c[ke+et];if(vt!==c[Oe+et]||vt!==c[Ge+et]){ue=!0;break}}}if(ue){if(F!==U){a[U]=a[F];const ke=F*d,Oe=U*d;for(let Ge=0;Ge!==d;++Ge)c[Oe+Ge]=c[ke+Ge]}++U}}if(S>0){a[U]=a[S];for(let F=S*d,ue=U*d,Q=0;Q!==d;++Q)c[ue+Q]=c[F+Q];++U}return U!==a.length?(this.times=a.slice(0,U),this.values=c.slice(0,U*d)):(this.times=a,this.values=c),this}clone(){const a=this.times.slice(),c=this.values.slice(),p=new(0,this.constructor)(this.name,a,c);return p.createInterpolant=this.createInterpolant,p}}hm.prototype.TimeBufferType=Float32Array,hm.prototype.ValueBufferType=Float32Array,hm.prototype.DefaultInterpolation=2301;class B_ extends hm{}B_.prototype.ValueTypeName="bool",B_.prototype.ValueBufferType=Array,B_.prototype.DefaultInterpolation=2300,B_.prototype.InterpolantFactoryMethodLinear=void 0,B_.prototype.InterpolantFactoryMethodSmooth=void 0;(class _R extends hm{}).prototype.ValueTypeName="color";(class um extends hm{}).prototype.ValueTypeName="number";class lE extends aE{constructor(a,c,d,p){super(a,c,d,p)}interpolate_(a,c,d,p){const S=this.resultBuffer,U=this.sampleValues,F=this.valueSize,ue=(d-c)/(p-c);let Q=a*F;for(let Me=Q+F;Q!==Me;Q+=4)$i.slerpFlat(S,0,U,Q-F,U,Q,ue);return S}}class P_ extends hm{InterpolantFactoryMethodLinear(a){return new lE(this.times,this.values,this.getValueSize(),a)}}P_.prototype.ValueTypeName="quaternion",P_.prototype.DefaultInterpolation=2301,P_.prototype.InterpolantFactoryMethodSmooth=void 0;class C1 extends hm{}C1.prototype.ValueTypeName="string",C1.prototype.ValueBufferType=Array,C1.prototype.DefaultInterpolation=2300,C1.prototype.InterpolantFactoryMethodLinear=void 0,C1.prototype.InterpolantFactoryMethodSmooth=void 0;(class mg extends hm{}).prototype.ValueTypeName="vector";const J3=new mo;class eD{constructor(a,c,d=0,p=1/0){this.ray=new Wp(a,c),this.near=d,this.far=p,this.camera=null,this.layers=new OA,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(a,c){this.ray.set(a,c)}setFromCamera(a,c){c.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),this.ray.direction.set(a.x,a.y,.5).unproject(c).sub(this.ray.origin).normalize(),this.camera=c):c.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(c.near+c.far)/(c.near-c.far)).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld),this.camera=c):console.error("THREE.Raycaster: Unsupported camera type: "+c.type)}setFromXRController(a){return J3.identity().extractRotation(a.matrixWorld),this.ray.origin.setFromMatrixPosition(a.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(J3),this}intersectObject(a,c=!0,d=[]){return Xw(a,this,d,c),d.sort(pE),d}intersectObjects(a,c=!0,d=[]){for(let p=0,S=a.length;p<S;p++)Xw(a[p],this,d,c);return d.sort(pE),d}}function pE(M,a){return M.distance-a.distance}function Xw(M,a,c,d){if(M.layers.test(a.layers)&&M.raycast(a,c),!0===d){const p=M.children;for(let S=0,U=p.length;S<U;S++)Xw(p[S],a,c,!0)}}class mE{constructor(a=!0){this.autoStart=a,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=AE(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const c=AE();a=(c-this.oldTime)/1e3,this.oldTime=c,this.elapsedTime+=a}return a}}function AE(){return(typeof performance>"u"?Date:performance).now()}class Yw{constructor(a=1,c=0,d=0){return this.radius=a,this.phi=c,this.theta=d,this}set(a,c,d){return this.radius=a,this.phi=c,this.theta=d,this}copy(a){return this.radius=a.radius,this.phi=a.phi,this.theta=a.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(a){return this.setFromCartesianCoords(a.x,a.y,a.z)}setFromCartesianCoords(a,c,d){return this.radius=Math.sqrt(a*a+c*c+d*d),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(a,d),this.phi=Math.acos(Yl(c/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const gE=new Ki;class _E{constructor(a=new Ki(1/0,1/0),c=new Ki(-1/0,-1/0)){this.isBox2=!0,this.min=a,this.max=c}set(a,c){return this.min.copy(a),this.max.copy(c),this}setFromPoints(a){this.makeEmpty();for(let c=0,d=a.length;c<d;c++)this.expandByPoint(a[c]);return this}setFromCenterAndSize(a,c){const d=gE.copy(c).multiplyScalar(.5);return this.min.copy(a).sub(d),this.max.copy(a).add(d),this}clone(){return(new this.constructor).copy(this)}copy(a){return this.min.copy(a.min),this.max.copy(a.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(a){return this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)}expandByPoint(a){return this.min.min(a),this.max.max(a),this}expandByVector(a){return this.min.sub(a),this.max.add(a),this}expandByScalar(a){return this.min.addScalar(-a),this.max.addScalar(a),this}containsPoint(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y}getParameter(a,c){return c.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)}clampPoint(a,c){return c.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,gE).distanceTo(a)}intersect(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this}union(a){return this.min.min(a.min),this.max.max(a.max),this}translate(a){return this.min.add(a),this.max.add(a),this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}const T1=new Mn,db=new Mn;class yE{constructor(a=new Mn,c=new Mn){this.start=a,this.end=c}set(a,c){return this.start.copy(a),this.end.copy(c),this}copy(a){return this.start.copy(a.start),this.end.copy(a.end),this}getCenter(a){return a.addVectors(this.start,this.end).multiplyScalar(.5)}delta(a){return a.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(a,c){return this.delta(c).multiplyScalar(a).add(this.start)}closestPointToPointParameter(a,c){T1.subVectors(a,this.start),db.subVectors(this.end,this.start);const d=db.dot(db);let S=db.dot(T1)/d;return c&&(S=Yl(S,0,1)),S}closestPointToPoint(a,c,d){const p=this.closestPointToPointParameter(a,c);return this.delta(d).multiplyScalar(p).add(this.start)}applyMatrix4(a){return this.start.applyMatrix4(a),this.end.applyMatrix4(a),this}equals(a){return a.start.equals(this.start)&&a.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}class Kw extends lw{constructor(a,c=1,d=16776960){const p=d,U=new ol;U.setAttribute("position",new Wn([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),U.computeBoundingSphere(),super(U,new w_({color:p,toneMapped:!1})),this.type="PlaneHelper",this.plane=a,this.size=c;const ue=new ol;ue.setAttribute("position",new Wn([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),ue.computeBoundingSphere(),this.add(new Jl(ue,new $h({color:p,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(a){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(a)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}class xR{constructor(){this.type="ShapePath",this.color=new io,this.subPaths=[],this.currentPath=null}moveTo(a,c){return this.currentPath=new h1,this.subPaths.push(this.currentPath),this.currentPath.moveTo(a,c),this}lineTo(a,c){return this.currentPath.lineTo(a,c),this}quadraticCurveTo(a,c,d,p){return this.currentPath.quadraticCurveTo(a,c,d,p),this}bezierCurveTo(a,c,d,p,S,U){return this.currentPath.bezierCurveTo(a,c,d,p,S,U),this}splineThru(a){return this.currentPath.splineThru(a),this}toShapes(a){function d(je,Rt){const At=Rt.length;let Ht=!1;for(let Pn=At-1,yn=0;yn<At;Pn=yn++){let xn=Rt[Pn],qn=Rt[yn],wi=qn.x-xn.x,Ut=qn.y-xn.y;if(Math.abs(Ut)>Number.EPSILON){if(Ut<0&&(xn=Rt[yn],wi=-wi,qn=Rt[Pn],Ut=-Ut),je.y<xn.y||je.y>qn.y)continue;if(je.y===xn.y){if(je.x===xn.x)return!0}else{const En=Ut*(je.x-xn.x)-wi*(je.y-xn.y);if(0===En)return!0;if(En<0)continue;Ht=!Ht}}else{if(je.y!==xn.y)continue;if(qn.x<=je.x&&je.x<=xn.x||xn.x<=je.x&&je.x<=qn.x)return!0}}return Ht}const p=dA.isClockWise,S=this.subPaths;if(0===S.length)return[];let U,F,ue;const Q=[];if(1===S.length)return F=S[0],ue=new Gv,ue.curves=F.curves,Q.push(ue),Q;let Me=!p(S[0].getPoints());Me=a?!Me:Me;const ke=[],Oe=[];let vt,Ye,Ge=[],et=0;Oe[et]=void 0,Ge[et]=[];for(let je=0,Rt=S.length;je<Rt;je++)F=S[je],vt=F.getPoints(),U=p(vt),U=a?!U:U,U?(!Me&&Oe[et]&&et++,Oe[et]={s:new Gv,p:vt},Oe[et].s.curves=F.curves,Me&&et++,Ge[et]=[]):Ge[et].push({h:F,p:vt[0]});if(!Oe[0])return function c(je){const Rt=[];for(let At=0,Ht=je.length;At<Ht;At++){const Pn=je[At],yn=new Gv;yn.curves=Pn.curves,Rt.push(yn)}return Rt}(S);if(Oe.length>1){let je=!1,Rt=0;for(let At=0,Ht=Oe.length;At<Ht;At++)ke[At]=[];for(let At=0,Ht=Oe.length;At<Ht;At++){const Pn=Ge[At];for(let yn=0;yn<Pn.length;yn++){const xn=Pn[yn];let qn=!0;for(let wi=0;wi<Oe.length;wi++)d(xn.p,Oe[wi].p)&&(At!==wi&&Rt++,qn?(qn=!1,ke[wi].push(xn)):je=!0);qn&&ke[At].push(xn)}}Rt>0&&!1===je&&(Ge=ke)}for(let je=0,Rt=Oe.length;je<Rt;je++){ue=Oe[je].s,Q.push(ue),Ye=Ge[je];for(let At=0,Ht=Ye.length;At<Ht;At++)ue.holes.push(Ye[At].h)}return Q}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:v}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=v)},541:(Gr,xt,Te)=>{"use strict";Te.d(xt,{AH:()=>x,Cg:()=>b,KQ:()=>V,NU:()=>Ie,_l:()=>v,s0:()=>D,w4:()=>ie});var be=Te(5225);class v extends be.QCA{constructor(m,I={}){const A=I.font;if(void 0===A)super();else{const R=A.generateShapes(m,I.size);I.depth=void 0!==I.height?I.height:50,void 0===I.bevelThickness&&(I.bevelThickness=10),void 0===I.bevelSize&&(I.bevelSize=8),void 0===I.bevelEnabled&&(I.bevelEnabled=!1),super(R,I)}this.type="TextGeometry"}}class V{constructor(m){this.isFont=!0,this.type="Font",this.data=m}generateShapes(m,I=100){const A=[],R=function Le(z,m,I){const A=Array.from(z),R=m/I.resolution,k=(I.boundingBox.yMax-I.boundingBox.yMin+I.underlineThickness)*R,ee=[];let ge=0,ve=0;for(let Se=0;Se<A.length;Se++){const De=A[Se];if("\n"===De)ge=0,ve-=k;else{const Xe=xe(De,R,ge,ve,I);ge+=Xe.offsetX,ee.push(Xe.path)}}return ee}(m,I,this.data);for(let k=0,ee=R.length;k<ee;k++)A.push(...R[k].toShapes());return A}}function xe(z,m,I,A,R){const k=R.glyphs[z]||R.glyphs["?"];if(!k)return void console.error('THREE.Font: character "'+z+'" does not exists in font family '+R.familyName+".");const ee=new be.Ld9;let ge,ve,Se,De,Xe,ct,$,tt;if(k.o){const We=k._cachedOutline||(k._cachedOutline=k.o.split(" "));for(let Ne=0,Fe=We.length;Ne<Fe;)switch(We[Ne++]){case"m":ge=We[Ne++]*m+I,ve=We[Ne++]*m+A,ee.moveTo(ge,ve);break;case"l":ge=We[Ne++]*m+I,ve=We[Ne++]*m+A,ee.lineTo(ge,ve);break;case"q":Se=We[Ne++]*m+I,De=We[Ne++]*m+A,Xe=We[Ne++]*m+I,ct=We[Ne++]*m+A,ee.quadraticCurveTo(Xe,ct,Se,De);break;case"b":Se=We[Ne++]*m+I,De=We[Ne++]*m+A,Xe=We[Ne++]*m+I,ct=We[Ne++]*m+A,$=We[Ne++]*m+I,tt=We[Ne++]*m+A,ee.bezierCurveTo(Xe,ct,$,tt,Se,De)}}return{offsetX:k.ha*m,path:ee}}const Je={type:"change"},st={type:"start"},Ke={type:"end"},ot=new be.RlV,Re=new be.Zcv,Qe=Math.cos(70*be.cj9.DEG2RAD);class Ie extends be.Qev{constructor(m,I){super(),this.object=m,this.domElement=I,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new be.Pq0,this.cursor=new be.Pq0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:be.kBv.ROTATE,MIDDLE:be.kBv.DOLLY,RIGHT:be.kBv.PAN},this.touches={ONE:be.wtR.ROTATE,TWO:be.wtR.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return ge.phi},this.getAzimuthalAngle=function(){return ge.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(at){at.addEventListener("keydown",Y),this._domElementKeyEvents=at},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",Y),this._domElementKeyEvents=null},this.saveState=function(){A.target0.copy(A.target),A.position0.copy(A.object.position),A.zoom0=A.object.zoom},this.reset=function(){A.target.copy(A.target0),A.object.position.copy(A.position0),A.object.zoom=A.zoom0,A.object.updateProjectionMatrix(),A.dispatchEvent(Je),A.update(),k=R.NONE},this.resetOrthoPanZoom=function(){De.set(0,0,0),A.object.zoom=1,A.object.updateProjectionMatrix()},this.update=function(){const at=new be.Pq0,Jt=(new be.PTz).setFromUnitVectors(m.up,new be.Pq0(0,1,0)),tn=Jt.clone().invert(),An=new be.Pq0,ze=new be.PTz,$e=new be.Pq0,ut=2*Math.PI;return function(Ot=null){const _n=A.object.position;at.copy(_n).sub(A.target),at.applyQuaternion(Jt),ge.setFromVector3(at),A.autoRotate&&k===R.NONE&&mn(function fn(at){return null!==at?2*Math.PI/60*A.autoRotateSpeed*at:2*Math.PI/60/60*A.autoRotateSpeed}(Ot)),A.enableDamping?(ge.theta+=ve.theta*A.dampingFactor,ge.phi+=ve.phi*A.dampingFactor):(ge.theta+=ve.theta,ge.phi+=ve.phi);let en=A.minAzimuthAngle,rn=A.maxAzimuthAngle;isFinite(en)&&isFinite(rn)&&(en<-Math.PI?en+=ut:en>Math.PI&&(en-=ut),rn<-Math.PI?rn+=ut:rn>Math.PI&&(rn-=ut),ge.theta=en<=rn?Math.max(en,Math.min(rn,ge.theta)):ge.theta>(en+rn)/2?Math.max(en,ge.theta):Math.min(rn,ge.theta)),ge.phi=Math.max(A.minPolarAngle,Math.min(A.maxPolarAngle,ge.phi)),ge.makeSafe(),!0===A.enableDamping?A.target.addScaledVector(De,A.dampingFactor):A.target.add(De),A.target.sub(A.cursor),A.target.clampLength(A.minTargetRadius,A.maxTargetRadius),A.target.add(A.cursor);let Tn=!1;if(A.zoomToCursor&&_t||A.object.isOrthographicCamera)ge.radius=ui(ge.radius);else{const In=ge.radius;ge.radius=ui(ge.radius*Se),Tn=In!=ge.radius}if(at.setFromSpherical(ge),at.applyQuaternion(tn),_n.copy(A.target).add(at),A.object.lookAt(A.target),!0===A.enableDamping?(ve.theta*=1-A.dampingFactor,ve.phi*=1-A.dampingFactor,De.multiplyScalar(1-A.dampingFactor)):(ve.set(0,0,0),De.set(0,0,0)),A.zoomToCursor&&_t){let In=null;if(A.object.isPerspectiveCamera){const Xn=at.length();In=ui(Xn*Se);const Ri=Xn-In;A.object.position.addScaledVector(dt,Ri),A.object.updateMatrixWorld(),Tn=!!Ri}else if(A.object.isOrthographicCamera){const Xn=new be.Pq0(rt.x,rt.y,0);Xn.unproject(A.object);const Ri=A.object.zoom;A.object.zoom=Math.max(A.minZoom,Math.min(A.maxZoom,A.object.zoom/Se)),A.object.updateProjectionMatrix(),Tn=Ri!==A.object.zoom;const Wi=new be.Pq0(rt.x,rt.y,0);Wi.unproject(A.object),A.object.position.sub(Wi).add(Xn),A.object.updateMatrixWorld(),In=at.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),A.zoomToCursor=!1;null!==In&&(this.screenSpacePanning?A.target.set(0,0,-1).transformDirection(A.object.matrix).multiplyScalar(In).add(A.object.position):(ot.origin.copy(A.object.position),ot.direction.set(0,0,-1).transformDirection(A.object.matrix),Math.abs(A.object.up.dot(ot.direction))<Qe?m.lookAt(A.target):(Re.setFromNormalAndCoplanarPoint(A.object.up,A.target),ot.intersectPlane(Re,A.target))))}else if(A.object.isOrthographicCamera){const In=A.object.zoom;A.object.zoom=Math.max(A.minZoom,Math.min(A.maxZoom,A.object.zoom/Se)),In!==A.object.zoom&&(A.object.updateProjectionMatrix(),Tn=!0)}return Se=1,_t=!1,!!(Tn||An.distanceToSquared(A.object.position)>ee||8*(1-ze.dot(A.object.quaternion))>ee||$e.distanceToSquared(A.target)>ee)&&(A.dispatchEvent(Je),An.copy(A.object.position),ze.copy(A.object.quaternion),$e.copy(A.target),!0)}}(),this.dispose=function(){A.domElement.removeEventListener("contextmenu",Ae),A.domElement.removeEventListener("pointerdown",vn),A.domElement.removeEventListener("pointercancel",ai),A.domElement.removeEventListener("wheel",Rn),A.domElement.removeEventListener("pointermove",Fn),A.domElement.removeEventListener("pointerup",ai),A.domElement.getRootNode().removeEventListener("keydown",Yi,{capture:!0}),null!==A._domElementKeyEvents&&(A._domElementKeyEvents.removeEventListener("keydown",Y),A._domElementKeyEvents=null)};const A=this,R={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let k=R.NONE;const ee=1e-6,ge=new be.YHV,ve=new be.YHV;let Se=1;const De=new be.Pq0,Xe=new be.I9Y,ct=new be.I9Y,$=new be.I9Y,tt=new be.I9Y,We=new be.I9Y,Ne=new be.I9Y,Fe=new be.I9Y,ht=new be.I9Y,pt=new be.I9Y,dt=new be.Pq0,rt=new be.I9Y;let _t=!1;const Yt=[],kt={};let Tt=!1;function ln(at){const Jt=Math.abs(.01*at);return Math.pow(.95,A.zoomSpeed*Jt)}function mn(at){ve.theta-=at}function jt(at){ve.phi-=at}const Sn=function(){const at=new be.Pq0;return function(tn,An){at.setFromMatrixColumn(An,0),at.multiplyScalar(-tn),De.add(at)}}(),cn=function(){const at=new be.Pq0;return function(tn,An){!0===A.screenSpacePanning?at.setFromMatrixColumn(An,1):(at.setFromMatrixColumn(An,0),at.crossVectors(A.object.up,at)),at.multiplyScalar(tn),De.add(at)}}(),gn=function(){const at=new be.Pq0;return function(tn,An){const ze=A.domElement;if(A.object.isPerspectiveCamera){at.copy(A.object.position).sub(A.target);let ut=at.length();ut*=Math.tan(A.object.fov/2*Math.PI/180),Sn(2*tn*ut/ze.clientHeight,A.object.matrix),cn(2*An*ut/ze.clientHeight,A.object.matrix)}else A.object.isOrthographicCamera?(Sn(tn*(A.object.right-A.object.left)/A.object.zoom/ze.clientWidth,A.object.matrix),cn(An*(A.object.top-A.object.bottom)/A.object.zoom/ze.clientHeight,A.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),A.enablePan=!1)}}();function Cn(at){A.object.isPerspectiveCamera||A.object.isOrthographicCamera?Se/=at:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),A.enableZoom=!1)}function Ln(at){A.object.isPerspectiveCamera||A.object.isOrthographicCamera?Se*=at:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),A.enableZoom=!1)}function Zn(at,Jt){if(!A.zoomToCursor)return;_t=!0;const tn=A.domElement.getBoundingClientRect(),ze=Jt-tn.top,ut=tn.height;rt.x=(at-tn.left)/tn.width*2-1,rt.y=-ze/ut*2+1,dt.set(rt.x,rt.y,1).unproject(A.object).sub(A.object.position).normalize()}function ui(at){return Math.max(A.minDistance,Math.min(A.maxDistance,at))}function hi(at){Xe.set(at.clientX,at.clientY)}function Mr(at){tt.set(at.clientX,at.clientY)}function me(at){if(1===Yt.length)Xe.set(at.pageX,at.pageY);else{const Jt=lt(at);Xe.set(.5*(at.pageX+Jt.x),.5*(at.pageY+Jt.y))}}function _e(at){if(1===Yt.length)tt.set(at.pageX,at.pageY);else{const Jt=lt(at);tt.set(.5*(at.pageX+Jt.x),.5*(at.pageY+Jt.y))}}function Be(at){const Jt=lt(at),tn=at.pageX-Jt.x,An=at.pageY-Jt.y,ze=Math.sqrt(tn*tn+An*An);Fe.set(0,ze)}function Mt(at){if(1==Yt.length)ct.set(at.pageX,at.pageY);else{const tn=lt(at);ct.set(.5*(at.pageX+tn.x),.5*(at.pageY+tn.y))}$.subVectors(ct,Xe).multiplyScalar(A.rotateSpeed);const Jt=A.domElement;mn(2*Math.PI*$.x/Jt.clientHeight),jt(2*Math.PI*$.y/Jt.clientHeight),Xe.copy(ct)}function Nt(at){if(1===Yt.length)We.set(at.pageX,at.pageY);else{const Jt=lt(at);We.set(.5*(at.pageX+Jt.x),.5*(at.pageY+Jt.y))}Ne.subVectors(We,tt).multiplyScalar(A.panSpeed),gn(Ne.x,Ne.y),tt.copy(We)}function Qt(at){const Jt=lt(at),tn=at.pageX-Jt.x,An=at.pageY-Jt.y,ze=Math.sqrt(tn*tn+An*An);ht.set(0,ze),pt.set(0,Math.pow(ht.y/Fe.y,A.zoomSpeed)),Cn(pt.y),Fe.copy(ht),Zn(.5*(at.pageX+Jt.x),.5*(at.pageY+Jt.y))}function vn(at){!1!==A.enabled&&(0===Yt.length&&(A.domElement.setPointerCapture(at.pointerId),A.domElement.addEventListener("pointermove",Fn),A.domElement.addEventListener("pointerup",ai)),!function nt(at){for(let Jt=0;Jt<Yt.length;Jt++)if(Yt[Jt]==at.pointerId)return!0;return!1}(at)&&(function Ce(at){Yt.push(at.pointerId)}(at),"touch"===at.pointerType?E(at):function $n(at){let Jt;switch(at.button){case 0:Jt=A.mouseButtons.LEFT;break;case 1:Jt=A.mouseButtons.MIDDLE;break;case 2:Jt=A.mouseButtons.RIGHT;break;default:Jt=-1}switch(Jt){case be.kBv.DOLLY:if(!1===A.enableZoom)return;(function qi(at){Zn(at.clientX,at.clientX),Fe.set(at.clientX,at.clientY)})(at),k=R.DOLLY;break;case be.kBv.ROTATE:if(at.ctrlKey||at.metaKey||at.shiftKey){if(!1===A.enablePan)return;Mr(at),k=R.PAN}else{if(!1===A.enableRotate)return;hi(at),k=R.ROTATE}break;case be.kBv.PAN:if(at.ctrlKey||at.metaKey||at.shiftKey){if(!1===A.enableRotate)return;hi(at),k=R.ROTATE}else{if(!1===A.enablePan)return;Mr(at),k=R.PAN}break;default:k=R.NONE}k!==R.NONE&&A.dispatchEvent(st)}(at)))}function Fn(at){!1!==A.enabled&&("touch"===at.pointerType?function J(at){switch(it(at),k){case R.TOUCH_ROTATE:if(!1===A.enableRotate)return;Mt(at),A.update();break;case R.TOUCH_PAN:if(!1===A.enablePan)return;Nt(at),A.update();break;case R.TOUCH_DOLLY_PAN:if(!1===A.enableZoom&&!1===A.enablePan)return;(function Zt(at){A.enableZoom&&Qt(at),A.enablePan&&Nt(at)})(at),A.update();break;case R.TOUCH_DOLLY_ROTATE:if(!1===A.enableZoom&&!1===A.enableRotate)return;(function dn(at){A.enableZoom&&Qt(at),A.enableRotate&&Mt(at)})(at),A.update();break;default:k=R.NONE}}(at):function kn(at){switch(k){case R.ROTATE:if(!1===A.enableRotate)return;!function Sr(at){ct.set(at.clientX,at.clientY),$.subVectors(ct,Xe).multiplyScalar(A.rotateSpeed);const Jt=A.domElement;mn(2*Math.PI*$.x/Jt.clientHeight),jt(2*Math.PI*$.y/Jt.clientHeight),Xe.copy(ct),A.update()}(at);break;case R.DOLLY:if(!1===A.enableZoom)return;!function ms(at){ht.set(at.clientX,at.clientY),pt.subVectors(ht,Fe),pt.y>0?Cn(ln(pt.y)):pt.y<0&&Ln(ln(pt.y)),Fe.copy(ht),A.update()}(at);break;case R.PAN:if(!1===A.enablePan)return;!function fs(at){We.set(at.clientX,at.clientY),Ne.subVectors(We,tt).multiplyScalar(A.panSpeed),gn(Ne.x,Ne.y),tt.copy(We),A.update()}(at)}}(at))}function ai(at){switch(function He(at){delete kt[at.pointerId];for(let Jt=0;Jt<Yt.length;Jt++)if(Yt[Jt]==at.pointerId)return void Yt.splice(Jt,1)}(at),Yt.length){case 0:A.domElement.releasePointerCapture(at.pointerId),A.domElement.removeEventListener("pointermove",Fn),A.domElement.removeEventListener("pointerup",ai),A.dispatchEvent(Ke),k=R.NONE;break;case 1:const Jt=Yt[0],tn=kt[Jt];E({pointerId:Jt,pageX:tn.x,pageY:tn.y})}}function Rn(at){!1===A.enabled||!1===A.enableZoom||k!==R.NONE||(at.preventDefault(),A.dispatchEvent(st),function wt(at){Zn(at.clientX,at.clientY),at.deltaY<0?Ln(ln(at.deltaY)):at.deltaY>0&&Cn(ln(at.deltaY)),A.update()}(function ei(at){const tn={clientX:at.clientX,clientY:at.clientY,deltaY:at.deltaY};switch(at.deltaMode){case 1:tn.deltaY*=16;break;case 2:tn.deltaY*=100}return at.ctrlKey&&!Tt&&(tn.deltaY*=10),tn}(at)),A.dispatchEvent(Ke))}function Yi(at){"Control"===at.key&&(Tt=!0,A.domElement.getRootNode().addEventListener("keyup",Ue,{passive:!0,capture:!0}))}function Ue(at){"Control"===at.key&&(Tt=!1,A.domElement.getRootNode().removeEventListener("keyup",Ue,{passive:!0,capture:!0}))}function Y(at){!1===A.enabled||!1===A.enablePan||function W(at){let Jt=!1;switch(at.code){case A.keys.UP:at.ctrlKey||at.metaKey||at.shiftKey?jt(2*Math.PI*A.rotateSpeed/A.domElement.clientHeight):gn(0,A.keyPanSpeed),Jt=!0;break;case A.keys.BOTTOM:at.ctrlKey||at.metaKey||at.shiftKey?jt(-2*Math.PI*A.rotateSpeed/A.domElement.clientHeight):gn(0,-A.keyPanSpeed),Jt=!0;break;case A.keys.LEFT:at.ctrlKey||at.metaKey||at.shiftKey?mn(2*Math.PI*A.rotateSpeed/A.domElement.clientHeight):gn(A.keyPanSpeed,0),Jt=!0;break;case A.keys.RIGHT:at.ctrlKey||at.metaKey||at.shiftKey?mn(-2*Math.PI*A.rotateSpeed/A.domElement.clientHeight):gn(-A.keyPanSpeed,0),Jt=!0}Jt&&(at.preventDefault(),A.update())}(at)}function E(at){switch(it(at),Yt.length){case 1:switch(A.touches.ONE){case be.wtR.ROTATE:if(!1===A.enableRotate)return;me(at),k=R.TOUCH_ROTATE;break;case be.wtR.PAN:if(!1===A.enablePan)return;_e(at),k=R.TOUCH_PAN;break;default:k=R.NONE}break;case 2:switch(A.touches.TWO){case be.wtR.DOLLY_PAN:if(!1===A.enableZoom&&!1===A.enablePan)return;(function gt(at){A.enableZoom&&Be(at),A.enablePan&&_e(at)})(at),k=R.TOUCH_DOLLY_PAN;break;case be.wtR.DOLLY_ROTATE:if(!1===A.enableZoom&&!1===A.enableRotate)return;(function Et(at){A.enableZoom&&Be(at),A.enableRotate&&me(at)})(at),k=R.TOUCH_DOLLY_ROTATE;break;default:k=R.NONE}break;default:k=R.NONE}k!==R.NONE&&A.dispatchEvent(st)}function Ae(at){!1!==A.enabled&&at.preventDefault()}function it(at){let Jt=kt[at.pointerId];void 0===Jt&&(Jt=new be.I9Y,kt[at.pointerId]=Jt),Jt.set(at.pageX,at.pageY)}function lt(at){return kt[at.pointerId===Yt[0]?Yt[1]:Yt[0]]}A.domElement.addEventListener("contextmenu",Ae),A.domElement.addEventListener("pointerdown",vn),A.domElement.addEventListener("pointercancel",ai),A.domElement.addEventListener("wheel",Rn,{passive:!1}),A.domElement.getRootNode().addEventListener("keydown",Yi,{passive:!0,capture:!0}),this.update()}}const L={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}"};class he{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const re=new be.qUd(-1,1,1,-1,0,1),de=new class fe extends be.LoY{constructor(){super(),this.setAttribute("position",new be.qtW([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new be.qtW([0,2,0,0,2,0],2))}};class pe{constructor(m){this._mesh=new be.eaF(de,m)}dispose(){this._mesh.geometry.dispose()}render(m){m.render(this._mesh,re)}get material(){return this._mesh.material}set material(m){this._mesh.material=m}}class ce extends he{constructor(m,I){super(),this.textureID=void 0!==I?I:"tDiffuse",m instanceof be.BKk?(this.uniforms=m.uniforms,this.material=m):m&&(this.uniforms=be.LlO.clone(m.uniforms),this.material=new be.BKk({name:void 0!==m.name?m.name:"unspecified",defines:Object.assign({},m.defines),uniforms:this.uniforms,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader})),this.fsQuad=new pe(this.material)}render(m,I,A){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=A.texture),this.fsQuad.material=this.material,this.renderToScreen?(m.setRenderTarget(null),this.fsQuad.render(m)):(m.setRenderTarget(I),this.clear&&m.clear(m.autoClearColor,m.autoClearDepth,m.autoClearStencil),this.fsQuad.render(m))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class K extends he{constructor(m,I){super(),this.scene=m,this.camera=I,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(m,I,A){const R=m.getContext(),k=m.state;let ee,ge;k.buffers.color.setMask(!1),k.buffers.depth.setMask(!1),k.buffers.color.setLocked(!0),k.buffers.depth.setLocked(!0),this.inverse?(ee=0,ge=1):(ee=1,ge=0),k.buffers.stencil.setTest(!0),k.buffers.stencil.setOp(R.REPLACE,R.REPLACE,R.REPLACE),k.buffers.stencil.setFunc(R.ALWAYS,ee,4294967295),k.buffers.stencil.setClear(ge),k.buffers.stencil.setLocked(!0),m.setRenderTarget(A),this.clear&&m.clear(),m.render(this.scene,this.camera),m.setRenderTarget(I),this.clear&&m.clear(),m.render(this.scene,this.camera),k.buffers.color.setLocked(!1),k.buffers.depth.setLocked(!1),k.buffers.color.setMask(!0),k.buffers.depth.setMask(!0),k.buffers.stencil.setLocked(!1),k.buffers.stencil.setFunc(R.EQUAL,1,4294967295),k.buffers.stencil.setOp(R.KEEP,R.KEEP,R.KEEP),k.buffers.stencil.setLocked(!0)}}class G extends he{constructor(){super(),this.needsSwap=!1}render(m){m.state.buffers.stencil.setLocked(!1),m.state.buffers.stencil.setTest(!1)}}class D{constructor(m,I){if(this.renderer=m,this._pixelRatio=m.getPixelRatio(),void 0===I){const A=m.getSize(new be.I9Y);this._width=A.width,this._height=A.height,(I=new be.nWS(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:be.ix0})).texture.name="EffectComposer.rt1"}else this._width=I.width,this._height=I.height;this.renderTarget1=I,this.renderTarget2=I.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new ce(L),this.copyPass.material.blending=be.XIg,this.clock=new be.zD7}swapBuffers(){const m=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=m}addPass(m){this.passes.push(m),m.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(m,I){this.passes.splice(I,0,m),m.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(m){const I=this.passes.indexOf(m);-1!==I&&this.passes.splice(I,1)}isLastEnabledPass(m){for(let I=m+1;I<this.passes.length;I++)if(this.passes[I].enabled)return!1;return!0}render(m){void 0===m&&(m=this.clock.getDelta());const I=this.renderer.getRenderTarget();let A=!1;for(let R=0,k=this.passes.length;R<k;R++){const ee=this.passes[R];if(!1!==ee.enabled){if(ee.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(R),ee.render(this.renderer,this.writeBuffer,this.readBuffer,m,A),ee.needsSwap){if(A){const ge=this.renderer.getContext(),ve=this.renderer.state.buffers.stencil;ve.setFunc(ge.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,m),ve.setFunc(ge.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==K&&(ee instanceof K?A=!0:ee instanceof G&&(A=!1))}}this.renderer.setRenderTarget(I)}reset(m){if(void 0===m){const I=this.renderer.getSize(new be.I9Y);this._pixelRatio=this.renderer.getPixelRatio(),this._width=I.width,this._height=I.height,(m=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=m,this.renderTarget2=m.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(m,I){this._width=m,this._height=I;const A=this._width*this._pixelRatio,R=this._height*this._pixelRatio;this.renderTarget1.setSize(A,R),this.renderTarget2.setSize(A,R);for(let k=0;k<this.passes.length;k++)this.passes[k].setSize(A,R)}setPixelRatio(m){this._pixelRatio=m,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class x extends he{constructor(m,I,A=null,R=null,k=null){super(),this.scene=m,this.camera=I,this.overrideMaterial=A,this.clearColor=R,this.clearAlpha=k,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new be.Q1f}render(m,I,A){const R=m.autoClear;let k,ee;m.autoClear=!1,null!==this.overrideMaterial&&(ee=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),null!==this.clearColor&&(m.getClearColor(this._oldClearColor),m.setClearColor(this.clearColor)),null!==this.clearAlpha&&(k=m.getClearAlpha(),m.setClearAlpha(this.clearAlpha)),1==this.clearDepth&&m.clearDepth(),m.setRenderTarget(this.renderToScreen?null:A),!0===this.clear&&m.clear(m.autoClearColor,m.autoClearDepth,m.autoClearStencil),m.render(this.scene,this.camera),null!==this.clearColor&&m.setClearColor(this._oldClearColor),null!==this.clearAlpha&&m.setClearAlpha(k),null!==this.overrideMaterial&&(this.scene.overrideMaterial=ee),m.autoClear=R}}const w={name:"LuminosityHighPassShader",shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new be.Q1f(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class b extends he{constructor(m,I,A,R){super(),this.strength=void 0!==I?I:1,this.radius=A,this.threshold=R,this.resolution=void 0!==m?new be.I9Y(m.x,m.y):new be.I9Y(256,256),this.clearColor=new be.Q1f(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let k=Math.round(this.resolution.x/2),ee=Math.round(this.resolution.y/2);this.renderTargetBright=new be.nWS(k,ee,{type:be.ix0}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let Xe=0;Xe<this.nMips;Xe++){const ct=new be.nWS(k,ee,{type:be.ix0});ct.texture.name="UnrealBloomPass.h"+Xe,ct.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(ct);const $=new be.nWS(k,ee,{type:be.ix0});$.texture.name="UnrealBloomPass.v"+Xe,$.texture.generateMipmaps=!1,this.renderTargetsVertical.push($),k=Math.round(k/2),ee=Math.round(ee/2)}const ge=w;this.highPassUniforms=be.LlO.clone(ge.uniforms),this.highPassUniforms.luminosityThreshold.value=R,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new be.BKk({uniforms:this.highPassUniforms,vertexShader:ge.vertexShader,fragmentShader:ge.fragmentShader}),this.separableBlurMaterials=[];const ve=[3,5,7,9,11];k=Math.round(this.resolution.x/2),ee=Math.round(this.resolution.y/2);for(let Xe=0;Xe<this.nMips;Xe++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(ve[Xe])),this.separableBlurMaterials[Xe].uniforms.invSize.value=new be.I9Y(1/k,1/ee),k=Math.round(k/2),ee=Math.round(ee/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=I,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new be.Pq0(1,1,1),new be.Pq0(1,1,1),new be.Pq0(1,1,1),new be.Pq0(1,1,1),new be.Pq0(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const De=L;this.copyUniforms=be.LlO.clone(De.uniforms),this.blendMaterial=new be.BKk({uniforms:this.copyUniforms,vertexShader:De.vertexShader,fragmentShader:De.fragmentShader,blending:be.EZo,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new be.Q1f,this.oldClearAlpha=1,this.basic=new be.V9B,this.fsQuad=new pe(null)}dispose(){for(let m=0;m<this.renderTargetsHorizontal.length;m++)this.renderTargetsHorizontal[m].dispose();for(let m=0;m<this.renderTargetsVertical.length;m++)this.renderTargetsVertical[m].dispose();this.renderTargetBright.dispose();for(let m=0;m<this.separableBlurMaterials.length;m++)this.separableBlurMaterials[m].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(m,I){let A=Math.round(m/2),R=Math.round(I/2);this.renderTargetBright.setSize(A,R);for(let k=0;k<this.nMips;k++)this.renderTargetsHorizontal[k].setSize(A,R),this.renderTargetsVertical[k].setSize(A,R),this.separableBlurMaterials[k].uniforms.invSize.value=new be.I9Y(1/A,1/R),A=Math.round(A/2),R=Math.round(R/2)}render(m,I,A,R,k){m.getClearColor(this._oldClearColor),this.oldClearAlpha=m.getClearAlpha();const ee=m.autoClear;m.autoClear=!1,m.setClearColor(this.clearColor,0),k&&m.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=A.texture,m.setRenderTarget(null),m.clear(),this.fsQuad.render(m)),this.highPassUniforms.tDiffuse.value=A.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,m.setRenderTarget(this.renderTargetBright),m.clear(),this.fsQuad.render(m);let ge=this.renderTargetBright;for(let ve=0;ve<this.nMips;ve++)this.fsQuad.material=this.separableBlurMaterials[ve],this.separableBlurMaterials[ve].uniforms.colorTexture.value=ge.texture,this.separableBlurMaterials[ve].uniforms.direction.value=b.BlurDirectionX,m.setRenderTarget(this.renderTargetsHorizontal[ve]),m.clear(),this.fsQuad.render(m),this.separableBlurMaterials[ve].uniforms.colorTexture.value=this.renderTargetsHorizontal[ve].texture,this.separableBlurMaterials[ve].uniforms.direction.value=b.BlurDirectionY,m.setRenderTarget(this.renderTargetsVertical[ve]),m.clear(),this.fsQuad.render(m),ge=this.renderTargetsVertical[ve];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,m.setRenderTarget(this.renderTargetsHorizontal[0]),m.clear(),this.fsQuad.render(m),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,k&&m.state.buffers.stencil.setTest(!0),this.renderToScreen?(m.setRenderTarget(null),this.fsQuad.render(m)):(m.setRenderTarget(A),this.fsQuad.render(m)),m.setClearColor(this._oldClearColor,this.oldClearAlpha),m.autoClear=ee}getSeperableBlurMaterial(m){const I=[];for(let A=0;A<m;A++)I.push(.39894*Math.exp(-.5*A*A/(m*m))/m);return new be.BKk({defines:{KERNEL_RADIUS:m},uniforms:{colorTexture:{value:null},invSize:{value:new be.I9Y(.5,.5)},direction:{value:new be.I9Y(.5,.5)},gaussianCoefficients:{value:I}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 invSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float gaussianCoefficients[KERNEL_RADIUS];\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tfloat weightSum = gaussianCoefficients[0];\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianCoefficients[i];\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(m){return new be.BKk({defines:{NUM_MIPS:m},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}b.BlurDirectionX=new be.I9Y(1,0),b.BlurDirectionY=new be.I9Y(0,1);class g{constructor(){this.id=0,this.object=null,this.z=0,this.renderOrder=0}}class C{constructor(){this.id=0,this.v1=new N,this.v2=new N,this.v3=new N,this.normalModel=new be.Pq0,this.vertexNormalsModel=[new be.Pq0,new be.Pq0,new be.Pq0],this.vertexNormalsLength=0,this.color=new be.Q1f,this.material=null,this.uvs=[new be.I9Y,new be.I9Y,new be.I9Y],this.z=0,this.renderOrder=0}}class N{constructor(){this.position=new be.Pq0,this.positionWorld=new be.Pq0,this.positionScreen=new be.IUQ,this.visible=!0}copy(m){this.positionWorld.copy(m.positionWorld),this.positionScreen.copy(m.positionScreen)}}class O{constructor(){this.id=0,this.v1=new N,this.v2=new N,this.vertexColors=[new be.Q1f,new be.Q1f],this.material=null,this.z=0,this.renderOrder=0}}class H{constructor(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new be.I9Y,this.material=null,this.renderOrder=0}}class X{constructor(){let m,I,R,k,ge,ve,De,Xe,$,tt,Ne,A=0,ee=0,Se=0,ct=0,We=0;const Fe={objects:[],lights:[],elements:[]},ht=new be.Pq0,pt=new be.IUQ,dt=new be.NRn(new be.Pq0(-1,-1,-1),new be.Pq0(1,1,1)),rt=new be.NRn,_t=new Array(3),Yt=new be.kn4,kt=new be.kn4,Tt=new be.kn4,fn=new be.PPD,ln=[],mn=[],jt=[],Sn=[],cn=[],Cn=new function gn(){const W=[],me=[],_e=[];let Be=null;const gt=new be.dwI;function Mt(kn){const ei=kn.positionWorld,Yi=kn.positionScreen;ei.copy(kn.position).applyMatrix4(Ne),Yi.copy(ei).applyMatrix4(kt);const Ue=1/Yi.w;Yi.x*=Ue,Yi.y*=Ue,Yi.z*=Ue,kn.visible=Yi.x>=-1&&Yi.x<=1&&Yi.y>=-1&&Yi.y<=1&&Yi.z>=-1&&Yi.z<=1}function vn(kn,Rn,ei){return!0===kn.visible||!0===Rn.visible||!0===ei.visible||(_t[0]=kn.positionScreen,_t[1]=Rn.positionScreen,_t[2]=ei.positionScreen,dt.intersectsBox(rt.setFromPoints(_t)))}function Fn(kn,Rn,ei){return(ei.positionScreen.x-kn.positionScreen.x)*(Rn.positionScreen.y-kn.positionScreen.y)-(ei.positionScreen.y-kn.positionScreen.y)*(Rn.positionScreen.x-kn.positionScreen.x)<0}return{setObject:function Et(kn){Be=kn,gt.getNormalMatrix(Be.matrixWorld),W.length=0,me.length=0,_e.length=0},projectVertex:Mt,checkTriangleVisibility:vn,checkBackfaceCulling:Fn,pushVertex:function Nt(kn,Rn,ei){R=function qi(){if(k===ee){const W=new N;return mn.push(W),ee++,k++,W}return mn[k++]}(),R.position.set(kn,Rn,ei),Mt(R)},pushNormal:function Qt(kn,Rn,ei){W.push(kn,Rn,ei)},pushColor:function Zt(kn,Rn,ei){me.push(kn,Rn,ei)},pushUv:function dn(kn,Rn){_e.push(kn,Rn)},pushLine:function ai(kn,Rn){const ei=mn[kn],Yi=mn[Rn];ei.positionScreen.copy(ei.position).applyMatrix4(Tt),Yi.positionScreen.copy(Yi.position).applyMatrix4(Tt),!0===function wt(W,me){let _e=0,Be=1;const gt=W.z+W.w,Et=me.z+me.w,Mt=-W.z+W.w,Nt=-me.z+me.w;return gt>=0&&Et>=0&&Mt>=0&&Nt>=0||!(gt<0&&Et<0||Mt<0&&Nt<0)&&(gt<0?_e=Math.max(_e,gt/(gt-Et)):Et<0&&(Be=Math.min(Be,gt/(gt-Et))),Mt<0?_e=Math.max(_e,Mt/(Mt-Nt)):Nt<0&&(Be=Math.min(Be,Mt/(Mt-Nt))),!(Be<_e||(W.lerp(me,_e),me.lerp(W,1-Be),0)))}(ei.positionScreen,Yi.positionScreen)&&(ei.positionScreen.multiplyScalar(1/ei.positionScreen.w),Yi.positionScreen.multiplyScalar(1/Yi.positionScreen.w),De=function Sr(){if(Xe===ct){const W=new O;return Sn.push(W),ct++,Xe++,W}return Sn[Xe++]}(),De.id=Be.id,De.v1.copy(ei),De.v2.copy(Yi),De.z=Math.max(ei.positionScreen.z,Yi.positionScreen.z),De.renderOrder=Be.renderOrder,De.material=Be.material,Be.material.vertexColors&&(De.vertexColors[0].fromArray(me,3*kn),De.vertexColors[1].fromArray(me,3*Rn)),Fe.elements.push(De))},pushTriangle:function $n(kn,Rn,ei,Yi){const Ue=mn[kn],Y=mn[Rn],E=mn[ei];if(!1!==vn(Ue,Y,E)&&(Yi.side===be.$EB||!0===Fn(Ue,Y,E))){ge=function Mr(){if(ve===Se){const W=new C;return jt.push(W),Se++,ve++,W}return jt[ve++]}(),ge.id=Be.id,ge.v1.copy(Ue),ge.v2.copy(Y),ge.v3.copy(E),ge.z=(Ue.positionScreen.z+Y.positionScreen.z+E.positionScreen.z)/3,ge.renderOrder=Be.renderOrder,ht.subVectors(E.position,Y.position),pt.subVectors(Ue.position,Y.position),ht.cross(pt),ge.normalModel.copy(ht),ge.normalModel.applyMatrix3(gt).normalize();for(let J=0;J<3;J++){const Ae=ge.vertexNormalsModel[J];Ae.fromArray(W,3*arguments[J]),Ae.applyMatrix3(gt).normalize(),ge.uvs[J].fromArray(_e,2*arguments[J])}ge.vertexNormalsLength=3,ge.material=Yi,Yi.vertexColors&&ge.color.fromArray(me,3*kn),Fe.elements.push(ge)}}}};function Ln(W){if(!1===W.visible)return;if(W.isLight)Fe.lights.push(W);else if(W.isMesh||W.isLine||W.isPoints){if(!1===W.material.visible||!0===W.frustumCulled&&!1===fn.intersectsObject(W))return;Zn(W)}else if(W.isSprite){if(!1===W.material.visible||!0===W.frustumCulled&&!1===fn.intersectsSprite(W))return;Zn(W)}const me=W.children;for(let _e=0,Be=me.length;_e<Be;_e++)Ln(me[_e])}function Zn(W){m=function hi(){if(I===A){const W=new g;return ln.push(W),A++,I++,W}return ln[I++]}(),m.id=W.id,m.object=W,ht.setFromMatrixPosition(W.matrixWorld),ht.applyMatrix4(kt),m.z=ht.z,m.renderOrder=W.renderOrder,Fe.objects.push(m)}function ui(W,me,_e){const Be=1/W.w;W.z*=Be,W.z>=-1&&W.z<=1&&($=function ms(){if(tt===We){const W=new H;return cn.push(W),We++,tt++,W}return cn[tt++]}(),$.id=me.id,$.x=W.x*Be,$.y=W.y*Be,$.z=W.z,$.renderOrder=me.renderOrder,$.object=me,$.rotation=me.rotation,$.scale.x=me.scale.x*Math.abs($.x-(W.x+_e.projectionMatrix.elements[0])/(W.w+_e.projectionMatrix.elements[12])),$.scale.y=me.scale.y*Math.abs($.y-(W.y+_e.projectionMatrix.elements[5])/(W.w+_e.projectionMatrix.elements[13])),$.material=me.material,Fe.elements.push($))}function fs(W,me){return W.renderOrder!==me.renderOrder?W.renderOrder-me.renderOrder:W.z!==me.z?me.z-W.z:W.id!==me.id?W.id-me.id:0}this.projectScene=function(W,me,_e,Be){ve=0,Xe=0,tt=0,Fe.elements.length=0,!0===W.matrixWorldAutoUpdate&&W.updateMatrixWorld(),null===me.parent&&!0===me.matrixWorldAutoUpdate&&me.updateMatrixWorld(),Yt.copy(me.matrixWorldInverse),kt.multiplyMatrices(me.projectionMatrix,Yt),fn.setFromProjectionMatrix(kt),I=0,Fe.objects.length=0,Fe.lights.length=0,Ln(W),!0===_e&&Fe.objects.sort(fs);const gt=Fe.objects;for(let Et=0,Mt=gt.length;Et<Mt;Et++){const Nt=gt[Et].object,Qt=Nt.geometry;if(Cn.setObject(Nt),Ne=Nt.matrixWorld,k=0,Nt.isMesh){let Zt=Nt.material;const dn=Array.isArray(Zt),vn=Qt.attributes,Fn=Qt.groups;if(void 0===vn.position)continue;const ai=vn.position.array;for(let $n=0,kn=ai.length;$n<kn;$n+=3){let Rn=ai[$n],ei=ai[$n+1],Yi=ai[$n+2];const Ue=Qt.morphAttributes.position;if(void 0!==Ue){const Y=Qt.morphTargetsRelative,E=Nt.morphTargetInfluences;for(let J=0,Ae=Ue.length;J<Ae;J++){const Ce=E[J];if(0===Ce)continue;const He=Ue[J];Y?(Rn+=He.getX($n/3)*Ce,ei+=He.getY($n/3)*Ce,Yi+=He.getZ($n/3)*Ce):(Rn+=(He.getX($n/3)-ai[$n])*Ce,ei+=(He.getY($n/3)-ai[$n+1])*Ce,Yi+=(He.getZ($n/3)-ai[$n+2])*Ce)}}Cn.pushVertex(Rn,ei,Yi)}if(void 0!==vn.normal){const $n=vn.normal.array;for(let kn=0,Rn=$n.length;kn<Rn;kn+=3)Cn.pushNormal($n[kn],$n[kn+1],$n[kn+2])}if(void 0!==vn.color){const $n=vn.color.array;for(let kn=0,Rn=$n.length;kn<Rn;kn+=3)Cn.pushColor($n[kn],$n[kn+1],$n[kn+2])}if(void 0!==vn.uv){const $n=vn.uv.array;for(let kn=0,Rn=$n.length;kn<Rn;kn+=2)Cn.pushUv($n[kn],$n[kn+1])}if(null!==Qt.index){const $n=Qt.index.array;if(Fn.length>0)for(let kn=0;kn<Fn.length;kn++){const Rn=Fn[kn];if(Zt=!0===dn?Nt.material[Rn.materialIndex]:Nt.material,void 0!==Zt)for(let ei=Rn.start,Yi=Rn.start+Rn.count;ei<Yi;ei+=3)Cn.pushTriangle($n[ei],$n[ei+1],$n[ei+2],Zt)}else for(let kn=0,Rn=$n.length;kn<Rn;kn+=3)Cn.pushTriangle($n[kn],$n[kn+1],$n[kn+2],Zt)}else if(Fn.length>0)for(let $n=0;$n<Fn.length;$n++){const kn=Fn[$n];if(Zt=!0===dn?Nt.material[kn.materialIndex]:Nt.material,void 0!==Zt)for(let Rn=kn.start,ei=kn.start+kn.count;Rn<ei;Rn+=3)Cn.pushTriangle(Rn,Rn+1,Rn+2,Zt)}else for(let $n=0,kn=ai.length/3;$n<kn;$n+=3)Cn.pushTriangle($n,$n+1,$n+2,Zt)}else if(Nt.isLine){Tt.multiplyMatrices(kt,Ne);const Zt=Qt.attributes;if(void 0!==Zt.position){const dn=Zt.position.array;for(let vn=0,Fn=dn.length;vn<Fn;vn+=3)Cn.pushVertex(dn[vn],dn[vn+1],dn[vn+2]);if(void 0!==Zt.color){const vn=Zt.color.array;for(let Fn=0,ai=vn.length;Fn<ai;Fn+=3)Cn.pushColor(vn[Fn],vn[Fn+1],vn[Fn+2])}if(null!==Qt.index){const vn=Qt.index.array;for(let Fn=0,ai=vn.length;Fn<ai;Fn+=2)Cn.pushLine(vn[Fn],vn[Fn+1])}else{const vn=Nt.isLineSegments?2:1;for(let Fn=0,ai=dn.length/3-1;Fn<ai;Fn+=vn)Cn.pushLine(Fn,Fn+1)}}}else if(Nt.isPoints){Tt.multiplyMatrices(kt,Ne);const Zt=Qt.attributes;if(void 0!==Zt.position){const dn=Zt.position.array;for(let vn=0,Fn=dn.length;vn<Fn;vn+=3)pt.set(dn[vn],dn[vn+1],dn[vn+2],1),pt.applyMatrix4(Tt),ui(pt,Nt,me)}}else Nt.isSprite&&(Nt.modelViewMatrix.multiplyMatrices(me.matrixWorldInverse,Nt.matrixWorld),pt.set(Ne.elements[12],Ne.elements[13],Ne.elements[14],1),pt.applyMatrix4(kt),ui(pt,Nt,me))}return!0===Be&&Fe.elements.sort(fs),Fe}}}class ie{constructor(){let m,I,A,R,k,ee,ge,ve,Se,De,Xe,We,Ne,ct=0,$=null,tt=1;const Fe=this,ht=new be.UtB,pt=new be.UtB,dt=new be.Q1f,rt=new be.Q1f,_t=new be.Q1f,Yt=new be.Q1f,kt=new be.Q1f,Tt=new be.Q1f,fn=new be.Pq0,ln=new be.Pq0,mn=new be.Pq0,jt=new be.dwI,Sn=new be.kn4,cn=new be.kn4,gn=[],Cn=new X,Ln=document.createElementNS("http://www.w3.org/2000/svg","svg");function Zn(){for(ct=0;Ln.childNodes.length>0;)Ln.removeChild(Ln.childNodes[0])}function ui(_e){return null!==$?_e.toFixed($):_e}function Mr(_e,Be,gt){let Et=Be.scale.x*ee,Mt=Be.scale.y*ge;gt.isPointsMaterial&&(Et*=gt.size,Mt*=gt.size);const Nt="M"+ui(_e.x-.5*Et)+","+ui(_e.y-.5*Mt)+"h"+ui(Et)+"v"+ui(Mt)+"h"+ui(-Et)+"z";let Qt="";(gt.isSpriteMaterial||gt.isPointsMaterial)&&(Qt="fill:"+gt.color.getStyle(Fe.outputColorSpace)+";fill-opacity:"+gt.opacity),wt(Qt,Nt)}function Sr(_e,Be,gt){const Et="M"+ui(_e.positionScreen.x)+","+ui(_e.positionScreen.y)+"L"+ui(Be.positionScreen.x)+","+ui(Be.positionScreen.y);if(gt.isLineBasicMaterial){let Mt="fill:none;stroke:"+gt.color.getStyle(Fe.outputColorSpace)+";stroke-opacity:"+gt.opacity+";stroke-width:"+gt.linewidth+";stroke-linecap:"+gt.linecap;gt.isLineDashedMaterial&&(Mt=Mt+";stroke-dasharray:"+gt.dashSize+","+gt.gapSize),wt(Mt,Et)}}function ms(_e,Be,gt,Et,Mt){Fe.info.render.vertices+=3,Fe.info.render.faces++;const Nt="M"+ui(_e.positionScreen.x)+","+ui(_e.positionScreen.y)+"L"+ui(Be.positionScreen.x)+","+ui(Be.positionScreen.y)+"L"+ui(gt.positionScreen.x)+","+ui(gt.positionScreen.y)+"z";let Qt="";Mt.isMeshBasicMaterial?(dt.copy(Mt.color),Mt.vertexColors&&dt.multiply(Et.color)):Mt.isMeshLambertMaterial||Mt.isMeshPhongMaterial||Mt.isMeshStandardMaterial?(rt.copy(Mt.color),Mt.vertexColors&&rt.multiply(Et.color),dt.copy(_t),ln.copy(_e.positionWorld).add(Be.positionWorld).add(gt.positionWorld).divideScalar(3),function qi(_e,Be,gt,Et){for(let Mt=0,Nt=_e.length;Mt<Nt;Mt++){const Qt=_e[Mt],Zt=Qt.color;if(Qt.isDirectionalLight){const dn=fn.setFromMatrixPosition(Qt.matrixWorld).normalize();let vn=gt.dot(dn);if(vn<=0)continue;vn*=Qt.intensity,Et.r+=Zt.r*vn,Et.g+=Zt.g*vn,Et.b+=Zt.b*vn}else if(Qt.isPointLight){const dn=fn.setFromMatrixPosition(Qt.matrixWorld);let vn=gt.dot(fn.subVectors(dn,Be).normalize());if(vn<=0||(vn*=0==Qt.distance?1:1-Math.min(Be.distanceTo(dn)/Qt.distance,1),0==vn))continue;vn*=Qt.intensity,Et.r+=Zt.r*vn,Et.g+=Zt.g*vn,Et.b+=Zt.b*vn}}}(A,ln,Et.normalModel,dt),dt.multiply(rt).add(Mt.emissive)):Mt.isMeshNormalMaterial&&(mn.copy(Et.normalModel).applyMatrix3(jt).normalize(),dt.setRGB(mn.x,mn.y,mn.z).multiplyScalar(.5).addScalar(.5)),Qt=Mt.wireframe?"fill:none;stroke:"+dt.getStyle(Fe.outputColorSpace)+";stroke-opacity:"+Mt.opacity+";stroke-width:"+Mt.wireframeLinewidth+";stroke-linecap:"+Mt.wireframeLinecap+";stroke-linejoin:"+Mt.wireframeLinejoin:"fill:"+dt.getStyle(Fe.outputColorSpace)+";fill-opacity:"+Mt.opacity,wt(Qt,Nt)}function fs(_e,Be,gt){let Et=Be.x-_e.x,Mt=Be.y-_e.y;const Nt=Et*Et+Mt*Mt;if(0===Nt)return;const Qt=gt/Math.sqrt(Nt);Et*=Qt,Mt*=Qt,Be.x+=Et,Be.y+=Mt,_e.x-=Et,_e.y-=Mt}function wt(_e,Be){Ne===_e?We+=Be:(W(),Ne=_e,We=Be)}function W(){We&&(Xe=function me(_e){return null==gn[_e]&&(gn[_e]=document.createElementNS("http://www.w3.org/2000/svg","path"),0==tt&&gn[_e].setAttribute("shape-rendering","crispEdges")),gn[_e]}(ct++),Xe.setAttribute("d",We),Xe.setAttribute("style",Ne),Ln.appendChild(Xe)),We="",Ne=""}this.domElement=Ln,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.overdraw=.5,this.outputColorSpace=be.er$,this.info={render:{vertices:0,faces:0}},this.setQuality=function(_e){switch(_e){case"high":tt=1;break;case"low":tt=0}},this.setClearColor=function(_e){Tt.set(_e)},this.setPixelRatio=function(){},this.setSize=function(_e,Be){R=_e,k=Be,ee=R/2,ge=k/2,Ln.setAttribute("viewBox",-ee+" "+-ge+" "+R+" "+k),Ln.setAttribute("width",R),Ln.setAttribute("height",k),ht.min.set(-ee,-ge),ht.max.set(ee,ge)},this.getSize=function(){return{width:R,height:k}},this.setPrecision=function(_e){$=_e},this.clear=function(){Zn(),Ln.style.backgroundColor=Tt.getStyle(Fe.outputColorSpace)},this.render=function(_e,Be){if(!(Be instanceof be.i7d))return void console.error("THREE.SVGRenderer.render: camera is not an instance of Camera.");const gt=_e.background;gt&&gt.isColor?(Zn(),Ln.style.backgroundColor=gt.getStyle(Fe.outputColorSpace)):!0===this.autoClear&&this.clear(),Fe.info.render.vertices=0,Fe.info.render.faces=0,Sn.copy(Be.matrixWorldInverse),cn.multiplyMatrices(Be.projectionMatrix,Sn),m=Cn.projectScene(_e,Be,this.sortObjects,this.sortElements),I=m.elements,A=m.lights,jt.getNormalMatrix(Be.matrixWorldInverse),function hi(_e){_t.setRGB(0,0,0),Yt.setRGB(0,0,0),kt.setRGB(0,0,0);for(let Be=0,gt=_e.length;Be<gt;Be++){const Et=_e[Be],Mt=Et.color;Et.isAmbientLight?(_t.r+=Mt.r,_t.g+=Mt.g,_t.b+=Mt.b):Et.isDirectionalLight?(Yt.r+=Mt.r,Yt.g+=Mt.g,Yt.b+=Mt.b):Et.isPointLight&&(kt.r+=Mt.r,kt.g+=Mt.g,kt.b+=Mt.b)}}(A),We="",Ne="";for(let Et=0,Mt=I.length;Et<Mt;Et++){const Nt=I[Et],Qt=Nt.material;if(void 0!==Qt&&0!==Qt.opacity)if(pt.makeEmpty(),Nt instanceof H)ve=Nt,ve.x*=ee,ve.y*=-ge,Mr(ve,Nt,Qt);else if(Nt instanceof O)ve=Nt.v1,Se=Nt.v2,ve.positionScreen.x*=ee,ve.positionScreen.y*=-ge,Se.positionScreen.x*=ee,Se.positionScreen.y*=-ge,pt.setFromPoints([ve.positionScreen,Se.positionScreen]),!0===ht.intersectsBox(pt)&&Sr(ve,Se,Qt);else if(Nt instanceof C){if(ve=Nt.v1,Se=Nt.v2,De=Nt.v3,ve.positionScreen.z<-1||ve.positionScreen.z>1||Se.positionScreen.z<-1||Se.positionScreen.z>1||De.positionScreen.z<-1||De.positionScreen.z>1)continue;ve.positionScreen.x*=ee,ve.positionScreen.y*=-ge,Se.positionScreen.x*=ee,Se.positionScreen.y*=-ge,De.positionScreen.x*=ee,De.positionScreen.y*=-ge,this.overdraw>0&&(fs(ve.positionScreen,Se.positionScreen,this.overdraw),fs(Se.positionScreen,De.positionScreen,this.overdraw),fs(De.positionScreen,ve.positionScreen,this.overdraw)),pt.setFromPoints([ve.positionScreen,Se.positionScreen,De.positionScreen]),!0===ht.intersectsBox(pt)&&ms(ve,Se,De,Nt,Qt)}}W(),_e.traverseVisible(function(Et){if(Et.isSVGObject){if(fn.setFromMatrixPosition(Et.matrixWorld),fn.applyMatrix4(cn),fn.z<-1||fn.z>1)return;const Qt=Et.node;Qt.setAttribute("transform","translate("+fn.x*ee+","+-fn.y*ge+")"),Ln.appendChild(Qt)}})}}}},6119:(Gr,xt,Te)=>{"use strict";Te.r(xt),Te.d(xt,{TDrawSelector:()=>x,TDrawVariable:()=>D,TSelector:()=>re,clTBranchFunc:()=>he,kClonesNode:()=>Ke,kSTLNode:()=>ot,treeDraw:()=>O,treeHierarchy:()=>ie,treeIOTest:()=>X,treeProcess:()=>C});var be=Te(5774),v=Te(4186),V=Te(9907),Le=Te(1085);const xe=0,Je=1,st=2,Ke=3,ot=4,Re=31,Qe=41,Ie=(0,v.BIT)(22),L="TBranchElement",he="TBranchFunc";class re{constructor(){this._branches=[],this._names=[],this._directs=[],this._break=0,this.tgtobj={}}addBranch(m,I,A){return I||(I=(0,v.isStr)(m)?m:`br${this._branches.length}`),this._branches.push(m),this._names.push(I),this._directs.push(A),this._branches.length-1}numBranches(){return this._branches.length}getBranch(m){return this._branches[m]}indexOfBranch(m){return this._branches.indexOf(m)}nameOfBranch(m){return this._names[m]}ShowProgress(){}Abort(){this._break=-1111}Begin(){}Process(){}Terminate(){}}function fe(z,m){if(!(0,v.isObject)(z))return 0;const I=(0,v.isArrayProto)(Object.prototype.toString.apply(z));if(!m||1!==I)return I;let A,R=!0;for(let k=0;k<z.length;++k){const ee=typeof z[k];if(A||(A=ee),ee!==A){R=!1;break}if((0,v.isObject)(ee)&&fe(z[k])){R=!1;break}}return R?2:1}class de{constructor(m,I,A){this.object=m,this.value=0,this.arr=[],this.indx=[],this.cnt=-1,this.tgtobj=A,this.select=(0,v.isObject)(I)?I:[]}next(){let m,I,A=this.cnt;if(A>=0){if(++this.fastindx<this.fastlimit)return this.value=this.fastarr[this.fastindx],!0;for(;--A>=0&&!(void 0===this.select[A]&&++this.indx[A]<this.arr[A].length););if(A<0)return!1}for(;;){if(m=A<0?this.object:this.arr[A][this.indx[A]],I=m?typeof m:"any","object"===I&&(void 0!==m._typename?(0,v.isRootCollection)(m)?(m=m.arr,I="array"):I="any":I=Number.isInteger(m.length)&&fe(m)>0?"array":"any"),"$self$"===this.select[A+1])return this.value=m,this.fastindx=this.fastlimit=0,this.cnt=A+1,!0;if("any"===I&&(0,v.isStr)(this.select[A+1]))this.arr[++A]=m,this.indx[A]=this.select[A];else{if("array"!==I||!(m.length>0||"$size$"===this.select[A+1]))return!(A<0||(this.value=m,void 0===this.select[A]?(this.fastarr=this.arr[A],this.fastindx=this.indx[A],this.fastlimit=this.fastarr.length):this.fastindx=this.fastlimit=0,this.cnt=A,0));switch(this.arr[++A]=m,this.select[A]){case void 0:this.indx[A]=0;break;case"$last$":this.indx[A]=m.length-1;break;case"$size$":return this.value=m.length,this.fastindx=this.fastlimit=0,this.cnt=A,!0;default:Number.isInteger(this.select[A])?(this.indx[A]=this.select[A],this.indx[A]<0&&(this.indx[A]=m.length-1)):(this.select[A].produce(this.tgtobj),this.indx[A]=Math.round(this.select[A].get(0)))}}}}reset(){this.arr=[],this.indx=[],delete this.fastarr,this.cnt=-1,this.value=0}}function pe(z,m,I=!1,A=!1){if(!z||z._typename!==L)return"";if(z.fType===xe&&-2===z.fID&&-1===z.fStreamerType)return z.fClassName;if(I&&z.fClonesName&&(z.fType===Ke||z.fType===ot))return z.fClonesName;const R=P(z,m.$file);if(z.fType===Je&&R&&"BASE"===R.fTypeName)return R.fName;if(z.fType===st)return!R||R.fType!==V.Ph&&R.fType!==V.w1?v.clTObject:R.fTypeName;if(z.fType===xe&&R&&A){if(R.fType===V.Ph||R.fType===V.w1)return R.fTypeName;if(R.fType===V.FF)return R.fTypeName.slice(0,R.fTypeName.length-1)}return""}function K(z,m,I=void 0,A=!1){let R=!1,k=m,ee=null;if(!I){R=!0,I=z.fBranches;const ge=k.indexOf("[");ge>0&&(k=k.slice(0,ge))}if(!I||0===I.arr.length)return null;for(let ge=0;ge<I.arr.length;++ge){let ve=I.arr[ge].fName;if("]"===ve[ve.length-1]&&(ve=ve.slice(0,ve.indexOf("["))),0!==k.indexOf(ve)&&ve.indexOf("<")>0){const De=ve.indexOf("<"),Xe=ve.lastIndexOf(">");ve=ve.slice(0,De)+ve.slice(Xe+1)}if(ve===k){ee={branch:I.arr[ge],rest:""};break}if(0!==k.indexOf(ve))continue;let Se=ve.length;if("."===ve[Se-1]&&Se--,"."===k[Se]){ee=K(z,k,I.arr[ge].fBranches),ee||(ee=K(z,k.slice(Se+1),I.arr[ge].fBranches)),ee||(ee={branch:I.arr[ge],rest:k.slice(Se)});break}}if(R&&!A&&!ee&&0===k.indexOf("br_")){let ge=3;for(;ge<k.length&&k[ge]>="0"&&k[ge]<="9";)++ge;const ve=ge>3?function ce(z,m){if(!Number.isInteger(m))return;let I,A=0;return function R(k){k?.fBranches?.arr.forEach(ee=>{A++===m&&(I=ee),I||R(ee)})}(z),I}(z,parseInt(k.slice(3,ge))):null;ve&&(ee={branch:ve,rest:k.slice(ge)})}return!R||!ee||m.length>k.length&&(ee.rest+=m.slice(k.length)),ee}function G(z,m){const I=K(z,m,z.fBranches,!0);return!I||I.rest?null:I.branch}class D{constructor(m){this.globals=m,this.code="",this.brindex=[],this.branches=[],this.brarray=[],this.func=null,this.kind=void 0,this.buf=[]}parse(m,I,A,R,k){const ee=Xe=>Xe>="A"&&Xe<="Z"||Xe>="a"&&Xe<="z"||"_"===Xe,ge=Xe=>!!(ee(Xe)||Xe>="0"&&Xe<="9");A||(A=""),this.code=(R?.fName??"")+A;let ve=0,Se=0,De=null;for(;ve<A.length||R;){let Xe=[];if(R)De=R,R=void 0;else{for(Se=ve;Se<A.length&&(ge(A[Se])||"."===A[Se]);)Se++;if("$"===A[Se]){let tt="";switch(A.slice(ve,Se)){case"LocalEntry":case"Entry":tt="arg.$globals.entry";break;case"Entries":tt="arg.$globals.entries"}if(tt){A=A.slice(0,ve)+tt+A.slice(Se+1),ve+=tt.length;continue}}if(De=K(m,A.slice(ve,Se)),!De){ve=Se+1;continue}De.branch&&void 0!==De.rest&&(Se-=De.rest.length,k=void 0,De=De.branch),Se>=A.length-1&&"."===A[A.length-1]&&(Xe.push("$self$"),Se=A.length)}for(;Se<A.length;){if("@"===A[Se]&&"@size"===A.slice(Se,Se+5)&&0===Xe.length){Se+=5,k=!0;break}if("."===A[Se]){const Fe=++Se;if("@"===A[Fe]&&"@size"===A.slice(Fe,Fe+5)){Xe.push("$size$"),Se+=5;break}if(!ee(A[Fe])){Xe.push("$self$");break}for(;Se<A.length&&ge(A[Se]);)Se++;if("("===A[Se]){Se=Fe-1;break}if(0===Xe.length)if(De.fType===Ke||De.fType===ot)Xe.push(void 0);else{const ht=pe(De,m,!1,!0);ht&&(0,v.isRootCollection)(null,ht)&&Xe.push(void 0)}Xe.push(A.slice(Fe,Se));continue}if("["!==A[Se])break;if("]"===A[Se+1]){Xe.push(void 0),Se+=2;continue}const tt=Se++;let We=0;for(;Se<A.length&&("]"!==A[Se]||We>0);)"["===A[Se]?We++:"]"===A[Se]&&We--,Se++;const Ne=A.slice(tt+1,Se);switch(Ne){case"":case"$all$":Xe.push(void 0);break;case"$last$":Xe.push("$last$");break;case"$size$":Xe.push("$size$");break;case"$first$":Xe.push(0);break;default:if(Number.isInteger(parseInt(Ne)))Xe.push(parseInt(Ne));else{const Fe=new D(this.globals);if(!Fe.parse(m,I,Ne))return!1;Xe.push(Fe)}}Se++}0===Xe.length?Xe=void 0:1===Xe.length&&void 0===Xe[0]&&(Xe=!0);let ct=I.indexOfBranch(De);if(ct<0&&(ct=I.addBranch(De,void 0,k)),k=void 0,this.brindex.push(ct),this.branches.push(I.nameOfBranch(ct)),this.brarray.push(Xe),0===ve&&Se===A.length&&1===this.branches.length)return this.direct_branch=!0,!0;const $="arg.var"+(this.branches.length-1);A=A.slice(0,ve)+$+A.slice(Se),ve+=$.length}return A=A.replace(/TMath::Exp\(/g,"Math.exp(").replace(/TMath::Abs\(/g,"Math.abs(").replace(/TMath::Prob\(/g,"arg.$math.Prob(").replace(/TMath::Gaus\(/g,"arg.$math.Gaus("),this.func=new Function("arg",`return (${A})`),!0}is_dummy(){return 0===this.branches.length&&!this.func}produce(m){if(this.length=1,this.isarray=!1,this.is_dummy())return this.value=1,void(this.kind="number");const I={$globals:this.globals,$math:Le},A=[];let R=-1;for(let k=0;k<this.branches.length;++k){const ee=`var${k}`;if(I[ee]=m[this.branches[k]],void 0===this.brarray[k]&&(this.brarray[k]=fe(I[ee])>0||(0,v.isRootCollection)(I[ee])),!1!==this.brarray[k]){if(!0===this.brarray[k]&&2===fe(I[ee],!0))A[k]=I[ee];else{const ge=new de(I[ee],this.brarray[k],m);for(A[k]=[];ge.next();)A[k].push(ge.value)}(R<0||R<A[k].length)&&(R=A[k].length)}}if(R<0)return this.value=this.direct_branch?I.var0:this.func(I),void(this.kind||(this.kind=typeof this.value));if(0===R)return this.length=0,void(this.value=0);if(this.length=R,this.isarray=!0,this.direct_branch)this.value=A[0];else{this.value=new Array(R);for(let k=0;k<R;++k){for(let ee=0;ee<this.branches.length;++ee)A[ee]&&(I[`var${ee}`]=A[ee][k]);this.value[k]=this.func(I)}}this.kind||(this.kind=typeof this.value[0])}get(m){return this.isarray?this.value[m]:this.value}appendArray(m){this.buf=this.buf.concat(m[this.branches[0]])}}class x extends re{constructor(){super(),this.ndim=0,this.vars=[],this.cut=null,this.hist=null,this.histo_drawopt="",this.hist_name="$htemp",this.hist_title="Result of TTree::Draw",this.graph=!1,this.hist_args=[],this.arr_limit=1e3,this.htype="F",this.monitoring=0,this.globals={},this.last_progress=0,this.aver_diff=0}setCallback(m,I){this.result_callback=m,this.progress_callback=I}parseParameters(m,I,A){if(!A||!(0,v.isStr)(A))return"";let R=A.lastIndexOf(";");for(;R>=0;){let ee,k=A.slice(R+1);R=(A=A.slice(0,R)).lastIndexOf(";");const ge=k.indexOf(":");ge>0&&(ee=k.slice(ge+1),k=k.slice(0,ge));let ve=parseInt(ee);switch((!ee||!Number.isInteger(ve))&&(ve=void 0),k){case"num":case"entries":case"numentries":"all"===ee?I.numentries=m.fEntries:"half"===ee?I.numentries=Math.round(m.fEntries/2):void 0!==ve&&(I.numentries=ve);break;case"first":void 0!==ve&&(I.firstentry=ve);break;case"mon":case"monitor":I.monitoring=void 0!==ve?ve:5e3;break;case"player":I.player=!0;break;case"dump":I.dump=!0;break;case"maxseg":case"maxrange":ve&&(m.$file.fMaxRanges=ve);break;case"accum":ve&&(this.arr_limit=ve);break;case"htype":ee&&1===ee.length&&(this.htype=ee.toUpperCase(),["C","S","I","F","L","D"].indexOf(this.htype)<0&&(this.htype="F"));break;case"hbins":this.hist_nbins=parseInt(ee),!Number.isInteger(this.hist_nbins)||this.hist_nbins<=3?delete this.hist_nbins:this.want_hist=!0;break;case"drawopt":I.drawopt=ee;break;case"graph":I.graph=ve||!0}}if(R=A.lastIndexOf(">>"),R>=0){let k=A.slice(R+2).trim();if(A=A.slice(0,R).trim(),R=k.indexOf("("),R>0&&(this.hist_name=k.slice(0,R),k=k.slice(R)),"dump"===k)I.dump=!0;else if(0===k.indexOf("Graph"))I.graph=!0;else if(R<0)this.want_hist=!0,this.hist_name=k;else if("("===k[0]&&")"===k[k.length-1]){this.want_hist=!0,k=k.slice(1,k.length-1).split(",");let ee=!0;for(let ge=0;ge<k.length;++ge)k[ge]=ge%3==0?parseInt(k[ge]):parseFloat(k[ge]),Number.isFinite(k[ge])||(ee=!1);ee&&(this.hist_args=k)}}return I.dump&&(this.dump_values=!0,I.reallocate_objects=!0,void 0===I.numentries&&(I.numentries=10)),A}parseDrawExpression(m,I){let A=this.parseParameters(m,I,I.expr),R="";this.hist_title=`drawing '${A}' from ${m.fName}`;let k=0;I.cut?R=I.cut:(k=A.replace(/TMath::/g,"TMath__").lastIndexOf("::"),k>0&&(R=A.slice(k+2).trim(),A=A.slice(0,k).trim())),I.parse_expr=A,I.parse_cut=R;const ee=[];let ge=0,ve=0,Se=0;for(k=0;k<A.length;++k)switch(A[k]){case"(":ge++;break;case")":ge--;break;case"[":ve++;break;case"]":ve--;break;case":":if(":"===A[k+1]){k++;continue}!ge&&!ve&&k>Se&&ee.push(A.slice(Se,k)),Se=k+1}if(!ge&&!ve&&k>Se&&ee.push(A.slice(Se,k)),ee.length<1||ee.length>3)return!1;this.ndim=ee.length;let De=!R;for(let Xe=0;Xe<this.ndim;++Xe){if(this.vars[Xe]=new D(this.globals),!this.vars[Xe].parse(m,this,ee[Xe]))return!1;this.vars[Xe].direct_branch||(De=!1)}return this.cut=new D(this.globals),!(R&&!this.cut.parse(m,this,R)||(this.numBranches()?(De&&(this.ProcessArrays=this.ProcessArraysFunc),this.monitoring=I.monitoring,3===this.ndim&&!this.want_hist&&!I.dump&&(I.graph=!0),this.graph=I.graph,this.histo_drawopt=void 0!==I.drawopt?I.drawopt:2===this.ndim?"col":"",0):(console.warn("no any branch is selected"),1)))}drawOnlyBranch(m,I,A,R){return this.ndim=1,0===A.indexOf("dump")&&(A=";"+A),A=this.parseParameters(m,R,A),this.monitoring=R.monitoring,R.dump&&(this.dump_values=!0,R.reallocate_objects=!0),this.dump_values?(this.hist=[],this.leaf=R.leaf,this.copy_fields=(R.branch.fLeaves&&R.branch.fLeaves.arr.length>1||R.branch.fBranches&&R.branch.fBranches.arr.length>0)&&!R.leaf,this.addBranch(I,"br0",R.direct_branch),this.Process=this.ProcessDump,!0):(this.vars[0]=new D(this.globals),!!this.vars[0].parse(m,this,A,I,R.direct_branch)&&(this.hist_title=`drawing branch ${I.fName} ${A?" expr:"+A:""} from ${m.fName}`,this.cut=new D(this.globals),this.vars[0].direct_branch&&(this.ProcessArrays=this.ProcessArraysFunc),!0))}Begin(m){this.globals.entries=m.fEntries,this.monitoring&&(this.lasttm=(new Date).getTime())}ShowProgress(){}getBitsBins(m,I){I.nbins=I.max=m,I.fLabels=(0,v.create)(v.clTHashList);for(let A=0;A<m;++A){const R=(0,v.create)(v.clTObjString);R.fString=A.toString(),R.fUniqueID=A+1,I.fLabels.Add(R)}return I}getMinMaxBins(m,I){const A={min:0,max:0,nbins:I,k:1,fLabels:null,title:""};if(m>=this.ndim)return A;const R=this.vars[m].buf;if(A.title=this.vars[m].code||"","object"===this.vars[m].kind){let k,ee=!0,ge=8;for(let ve=0;ve<R.length;++ve)R[ve]&&(k||(k=R[ve]._typename),k!==R[ve]._typename&&(ee=!1),R[ve].fNbits&&(ge=Math.max(ge,R[ve].fNbits+1)));if(k&&ee&&"TBits"===k&&0===m)return this.fill1DHistogram=this.fillTBitsHistogram,ge%8&&(ge=8+(65520&ge)),"bits"===this.hist_name&&1===this.hist_args.length&&this.hist_args[0]&&(ge=this.hist_args[0]),this.getBitsBins(ge,A)}if("string"===this.vars[m].kind){A.lbls=[];for(let k=0;k<R.length;++k)A.lbls.indexOf(R[k])<0&&A.lbls.push(R[k]);A.lbls.sort(),A.max=A.nbins=A.lbls.length,A.fLabels=(0,v.create)(v.clTHashList);for(let k=0;k<A.lbls.length;++k){const ee=(0,v.create)(v.clTObjString);ee.fString=A.lbls[k],ee.fUniqueID=k+1,""===ee.fString&&(ee.fString="<empty>"),A.fLabels.Add(ee)}}else{if(0===m&&"bits"===this.hist_name&&this.hist_args.length<=1)return this.fill1DHistogram=this.FillBitsHistogram,this.getBitsBins(this.hist_args[0]||32,A);if(3*m+2<this.hist_args.length)A.nbins=this.hist_args[3*m],A.min=this.hist_args[3*m+1],A.max=this.hist_args[3*m+2];else{let k=!1;for(let ee=1;ee<R.length;++ee){const ge=R[ee];Number.isFinite(ge)&&(k?(A.min=Math.min(A.min,ge),A.max=Math.max(A.max,ge)):(A.min=A.max=ge,k=!0))}if(k||(A.min=0,A.max=1),this.hist_nbins&&(I=A.nbins=this.hist_nbins),A.isinteger=Math.round(A.min)===A.min&&Math.round(A.max)===A.max,A.isinteger)for(let ee=0;ee<R.length;++ee)if(R[ee]!==Math.round(R[ee])){A.isinteger=!1;break}if(A.isinteger)if(A.min=Math.round(A.min),A.max=Math.round(A.max),A.max-A.min<5*I)A.min-=1,A.max+=2,A.nbins=Math.round(A.max-A.min);else{const ee=A.max-A.min+2;let ge=Math.floor(ee/I);for(;ge*I<ee;)ge++;A.max=A.min+I*ge}else A.min>=A.max?(A.max=A.min,Math.abs(A.min)<100?(A.min-=1,A.max+=1):A.min>0?(A.min*=.9,A.max*=1.1):(A.min*=1.1,A.max*=.9)):A.max+=(A.max-A.min)/A.nbins}}return A.k=A.nbins/(A.max-A.min),A.GetBin=function(k){const ee=this.lbls?.indexOf(k)??Number.isFinite(k)?Math.floor((k-this.min)*this.k):this.nbins+1;return ee<0?0:ee>this.nbins?this.nbins+1:ee+1},A}createHistogram(m,I=!1){m||(m=20);const A=this.getMinMaxBins(0,m),R=this.getMinMaxBins(1,m),k=this.getMinMaxBins(2,m);let ee=null;switch(this.ndim){case 1:ee=(0,v.createHistogram)(v.clTH1+this.htype,A.nbins);break;case 2:ee=(0,v.createHistogram)(v.clTH2+this.htype,A.nbins,R.nbins);break;case 3:ee=(0,v.createHistogram)(v.clTH3+this.htype,A.nbins,R.nbins,k.nbins)}return ee.fXaxis.fTitle=A.title,ee.fXaxis.fXmin=A.min,ee.fXaxis.fXmax=A.max,ee.fXaxis.fLabels=A.fLabels,this.ndim>1&&(ee.fYaxis.fTitle=R.title),ee.fYaxis.fXmin=R.min,ee.fYaxis.fXmax=R.max,ee.fYaxis.fLabels=R.fLabels,this.ndim>2&&(ee.fZaxis.fTitle=k.title),ee.fZaxis.fXmin=k.min,ee.fZaxis.fXmax=k.max,ee.fZaxis.fLabels=k.fLabels,ee.fName=this.hist_name,ee.fTitle=this.hist_title,ee.fOption=this.histo_drawopt,ee.$custom_stat="$htemp"===this.hist_name?111110:111111,I?(this.hist=ee,this.x=A,this.y=R,this.z=k):ee.fBits=ee.fBits|v.kNoStats,ee}createOutputObject(){if(this.hist||!this.vars[0].buf)return;if(this.dump_values)this.hist=[],this.fill1DHistogram=this.fill2DHistogram=this.fill3DHistogram=this.dumpValues;else if(this.graph){const R=this.vars[0].buf.length;let k=null;if(1===this.ndim)k=(0,v.createTGraph)(R,Array.from(Array(R).keys()),this.vars[0].buf),k.fName="Graph",k.fTitle=this.hist_title;else if(2===this.ndim)k=(0,v.createTGraph)(R,this.vars[0].buf,this.vars[1].buf),k.fName="Graph",k.fTitle=this.hist_title,delete this.vars[1].buf;else if(3===this.ndim){k=(0,v.create)(v.clTPolyMarker3D),k.fN=R,k.fLastPoint=R-1;const ee=new Array(3*R);for(let ge=0;ge<R;++ge)ee[3*ge]=this.vars[0].buf[ge],ee[3*ge+1]=this.vars[1].buf[ge],ee[3*ge+2]=this.vars[2].buf[ge];k.fP=ee,k.$hist=this.createHistogram(10),delete this.vars[1].buf,delete this.vars[2].buf,k.fName="Points"}this.hist=k}else this.createHistogram([200,50,20][this.ndim],!0);const m=this.vars[0].buf,I=this.cut.buf,A=m.length;if(!this.graph)switch(this.ndim){case 1:for(let R=0;R<A;++R)this.fill1DHistogram(m[R],I?I[R]:1);break;case 2:{const R=this.vars[1].buf;for(let k=0;k<A;++k)this.fill2DHistogram(m[k],R[k],I?I[k]:1);delete this.vars[1].buf;break}case 3:{const R=this.vars[1].buf,k=this.vars[2].buf;for(let ee=0;ee<A;++ee)this.fill3DHistogram(m[ee],R[ee],k[ee],I?I[ee]:1);delete this.vars[1].buf,delete this.vars[2].buf;break}}delete this.vars[0].buf,delete this.cut.buf}fillTBitsHistogram(m,I){if(!(I&&m&&m.fNbits&&m.fAllBits))return;const A=Math.min(m.fNbits+1,8*m.fNbytes);for(let R=0,k=1,ee=0;R<A;++R)m.fAllBits[ee]&&k&&(R<=this.x.nbins?this.hist.fArray[R+1]+=I:this.hist.fArray[this.x.nbins+1]+=I),k*=2,k>=256&&(k=1,++ee)}FillBitsHistogram(m,I){if(I)for(let A=0,R=1;A<this.x.nbins;++A)m&R&&(this.hist.fArray[A+1]+=I),R*=2}fill1DHistogram(m,I){const A=this.x.GetBin(m);this.hist.fArray[A]+=I,!this.x.lbls&&Number.isFinite(m)&&(this.hist.fTsumw+=I,this.hist.fTsumwx+=I*m,this.hist.fTsumwx2+=I*m*m)}fill2DHistogram(m,I,A){const R=this.x.GetBin(m),k=this.y.GetBin(I);this.hist.fArray[R+(this.x.nbins+2)*k]+=A,!this.x.lbls&&!this.y.lbls&&Number.isFinite(m)&&Number.isFinite(I)&&(this.hist.fTsumw+=A,this.hist.fTsumwx+=A*m,this.hist.fTsumwy+=A*I,this.hist.fTsumwx2+=A*m*m,this.hist.fTsumwxy+=A*m*I,this.hist.fTsumwy2+=A*I*I)}fill3DHistogram(m,I,A,R){const k=this.x.GetBin(m),ee=this.y.GetBin(I),ge=this.z.GetBin(A);this.hist.fArray[k+(this.x.nbins+2)*(ee+(this.y.nbins+2)*ge)]+=R,!this.x.lbls&&!this.y.lbls&&!this.z.lbls&&Number.isFinite(m)&&Number.isFinite(I)&&Number.isFinite(A)&&(this.hist.fTsumw+=R,this.hist.fTsumwx+=R*m,this.hist.fTsumwy+=R*I,this.hist.fTsumwz+=R*A,this.hist.fTsumwx2+=R*m*m,this.hist.fTsumwy2+=R*I*I,this.hist.fTsumwz2+=R*A*A,this.hist.fTsumwxy+=R*m*I,this.hist.fTsumwxz+=R*m*A,this.hist.fTsumwyz+=R*I*A)}dumpValues(m,I,A,R){let k;switch(this.ndim){case 1:k={x:m,weight:I};break;case 2:k={x:m,y:I,weight:A};break;case 3:k={x:m,y:I,z:A,weight:R}}this.cut.is_dummy()&&(1===this.ndim?k=m:delete k.weight),this.hist.push(k)}ProcessArraysFunc(){if(this.arr_limit||this.graph){const m=this.vars[0],I=this.vars[1],A=this.vars[2],R=this.tgtarr.br0.length;if(0===m.buf.length&&R>=this.arr_limit&&!this.graph)m.buf=this.tgtarr.br0,I&&(I.buf=this.tgtarr.br1),A&&(A.buf=this.tgtarr.br2);else for(let k=0;k<R;++k)m.buf.push(this.tgtarr.br0[k]),I&&I.buf.push(this.tgtarr.br1[k]),A&&A.buf.push(this.tgtarr.br2[k]);m.kind="number",I&&(I.kind="number"),A&&(A.kind="number"),this.cut.buf=null,!this.graph&&m.buf.length>=this.arr_limit&&(this.createOutputObject(),this.arr_limit=0)}else{const m=this.tgtarr.br0,I=m.length;switch(this.ndim){case 1:for(let A=0;A<I;++A)this.fill1DHistogram(m[A],1);break;case 2:{const A=this.tgtarr.br1;for(let R=0;R<I;++R)this.fill2DHistogram(m[R],A[R],1);break}case 3:{const A=this.tgtarr.br1,R=this.tgtarr.br2;for(let k=0;k<I;++k)this.fill3DHistogram(m[k],A[k],R[k],1);break}}}}ProcessDump(){const m=this.leaf?this.tgtobj.br0[this.leaf]:this.tgtobj.br0;m&&this.copy_fields&&0===fe(m)?this.hist.push(Object.assign({},m)):this.hist.push(m)}Process(m){if(this.globals.entry=m,this.cut.produce(this.tgtobj),!this.dump_values&&!this.cut.value)return;for(let ee=0;ee<this.ndim;++ee)this.vars[ee].produce(this.tgtobj);const I=this.vars[0],A=this.vars[1],R=this.vars[2],k=this.cut;if(this.graph||this.arr_limit){switch(this.ndim){case 1:for(let ee=0;ee<I.length;++ee)I.buf.push(I.get(ee)),k.buf?.push(k.value);break;case 2:for(let ee=0;ee<I.length;++ee)for(let ge=0;ge<A.length;++ge)I.buf.push(I.get(ee)),A.buf.push(A.get(ge)),k.buf?.push(k.value);break;case 3:for(let ee=0;ee<I.length;++ee)for(let ge=0;ge<A.length;++ge)for(let ve=0;ve<R.length;++ve)I.buf.push(I.get(ee)),A.buf.push(A.get(ge)),R.buf.push(R.get(ve)),k.buf?.push(k.value)}!this.graph&&I.buf.length>=this.arr_limit&&(this.createOutputObject(),this.arr_limit=0)}else if(this.hist)switch(this.ndim){case 1:for(let ee=0;ee<I.length;++ee)this.fill1DHistogram(I.get(ee),k.value);break;case 2:for(let ee=0;ee<I.length;++ee)for(let ge=0;ge<A.length;++ge)this.fill2DHistogram(I.get(ee),A.get(ge),k.value);break;case 3:for(let ee=0;ee<I.length;++ee)for(let ge=0;ge<A.length;++ge)for(let ve=0;ve<R.length;++ve)this.fill3DHistogram(I.get(ee),A.get(ge),R.get(ve),k.value)}if(this.monitoring&&this.hist&&!this.dump_values){const ee=(new Date).getTime();ee-this.lasttm>this.monitoring&&(this.lasttm=ee,(0,v.isFunc)(this.progress_callback)&&this.progress_callback(this.hist))}}Terminate(m){m&&!this.hist&&this.createOutputObject(),this.ShowProgress(),(0,v.isFunc)(this.result_callback)&&this.result_callback(this.hist)}}function P(z,m){if(!z||!m||z._typename!==L||z.fID<0||z.fStreamerType<0)return null;const I=m.findStreamerInfo(z.fClassName,z.fClassVersion,z.fCheckSum),A=I&&I.fElements?I.fElements.arr:null;if(!A)return null;let R=z.fName,k=R.indexOf("[");function ee(ge){return!(!ge||ge.fName!==R||ge.fType!==z.fStreamerType&&(ge.fType!==V.Qu||z.fStreamerType!==V.h0)&&(z.fStreamerType!==V.$o&&z.fStreamerType!==V.$o+V.bm&&z.fStreamerType!==V.v5&&z.fStreamerType!==V.v5+V.bm||ge.fType!==V.N8)&&(console.warn(`Should match element ${ge.fType} with branch ${z.fStreamerType}`),1))}if(k>0&&(R=R.slice(0,k)),k=R.lastIndexOf("."),k>0&&(R=R.slice(k+1)),ee(A[z.fID]))return A[z.fID];for(let ge=0;ge<A.length;++ge)if(ge!==z.fID&&ee(A[ge]))return A[ge];return console.error(`Did not found/match element for branch ${z.fName} class ${z.fClassName}`),null}function w(z,m,I){const A=z.findStreamerInfo(m),R=A?.fElements?.arr;if(!R)return"";let k=null;for(let ge=0;ge<R.length;++ge)if("BASE"===R[ge].fTypeName){const ve=w(z,R[ge].fName,I);if(ve)return ve}else if(R[ge].fName===I){k=R[ge];break}if(!k)return"";let ee=k.fTypeName;return"*"===ee[ee.length-1]&&(ee=ee.slice(0,ee.length-1)),ee}function b(z){const m=(0,v.getMethods)(z),I={names:[],values:[],Create(){const A={};for(let R=0;R<this.names.length;++R)A[this.names[R]]=this.values[R];return A}};I.names.push("_typename"),I.values.push(z);for(const A in m)I.names.push(A),I.values.push(m[A]);return I}function g(z,m,I){let A="";for(let R=I||0;R<z.arr.length;++R)0===z.arr[R].fName.indexOf(m)&&z.arr[R].fClassName&&(A=z.arr[R].fClassName);return A}function C(z,m,I){return N.apply(this,arguments)}function N(){return(N=(0,be.A)(function*(z,m,I){if(I||(I={}),!m||!z.$file||!m.numBranches())return m?.Terminate(!1),Promise.reject(Error("required parameter missing for TTree::Process"));const A={tree:z,file:z.$file,selector:m,arr:[],curr:-1,current_entry:-1,simple_read:!0,process_arrays:!0},R=($,tt)=>{let We=0;switch($._typename){case"TLeafF":We=V.k1;break;case"TLeafD":We=V.Hg;break;case"TLeafO":We=V.Qu;break;case"TLeafB":We=$.fIsUnsigned?V.h0:V.yd;break;case"TLeafS":We=$.fIsUnsigned?V.bP:V.aM;break;case"TLeafI":We=$.fIsUnsigned?V.c4:V.nc;break;case"TLeafL":We=$.fIsUnsigned?V.NE:V.s4;break;case"TLeafC":We=V.V$;break;default:return null}const Ne=(0,V._T)(tt||$.fName,We);return $.fLen>1&&(Ne.fType+=V.bm,Ne.fArrayLength=$.fLen),Ne},k=$=>{for(let tt=0;tt<A.arr.length;++tt)if(A.arr[tt].branch===$)return A.arr[tt];return null};let ve,Se,ee=0;function ge($,tt,We,Ne){if((0,v.isStr)($)&&($=G(A.tree,$)),!$)return console.error("Did not found branch"),null;let Fe=k($);if(Fe)return console.error(`Branch ${$.fName} already configured for reading`),Fe.tgt!==tt&&console.error("Target object differs"),null;if(!$.fEntries)return console.warn(`Branch ${$.fName} does not have entries`),null;for(Fe={branch:$,tgt:tt,name:We,index:-1,member:null,type:0,curr_entry:-1,raw:null,basket:null,curr_basket:0,read_entry:-1,staged_entry:-1,first_readentry:-1,staged_basket:0,numentries:$.fEntries,numbaskets:$.fWriteBasket,counters:null,ascounter:[],baskets:[],staged_prev:0,staged_now:0,progress_showtm:0,getBasketEntry(mn){if(!this.branch||mn>this.branch.fMaxBaskets)return 0;const jt=mn<this.branch.fMaxBaskets?this.branch.fBasketEntry[mn]:0;if(jt)return jt;const Sn=mn>0?this.branch.fBaskets.arr[mn-1]:null;return Sn?this.branch.fBasketEntry[mn-1]+Sn.fNevBuf:0},getTarget(mn){if(!this.tgt)return mn;for(let jt=0;jt<this.tgt.length;++jt){const Sn=this.tgt[jt];mn[Sn.name]||(mn[Sn.name]=Sn.lst.Create()),mn=mn[Sn.name]}return mn},getEntry(mn){const jt=mn-this.first_entry;let Sn;this.branch.TestBit(Ie)||this.raw.clearObjectMap(),this.basket.fEntryOffset?(Sn=this.basket.fEntryOffset[jt],this.basket.fDisplacement&&(this.raw.fDisplacement=this.basket.fDisplacement[jt])):Sn=this.basket.fKeylen+this.basket.fNevBufSize*jt,this.raw.locate(Sn-this.raw.raw_shift)}};Fe.getBasketEntry(Fe.numbaskets+1);)Fe.numbaskets++;const ht=$.fLeaves?.arr?.length??0,pt=ht>0?$.fLeaves.arr[0]:null,dt=$._typename===L;let rt=null,_t=null,Yt=0,kt=null,Tt=null,fn="";if($.fBranchCount){if(kt=k($.fBranchCount),kt||(kt=ge($.fBranchCount,tt,"$counter"+ee++,!0)),!kt)return console.error(`Cannot add counter branch ${$.fBranchCount.fName}`),null;let mn=$.fBranchCount2;if(!mn&&$.fBranchCount.fStreamerType===V.$o&&($.fStreamerType===V.mU||$.fStreamerType===V.bm+V.mU)){const jt=P($,A.file),Sn=$.fBranchCount.fBranches.arr;if(jt?.fCountName&&Sn)for(let cn=0;cn<Sn.length;++cn)if(Sn[cn].fName===$.fBranchCount.fName+"."+jt.fCountName){mn=Sn[cn];break}mn||console.error("Did not found branch for second counter of kStreamLoop element")}if(mn&&(Tt=k(mn),Tt||(Tt=ge(mn,tt,"$counter"+ee++,!0)),!Tt))return console.error(`Cannot add counter branch2 ${mn.fName}`),null}else if(1===ht&&pt&&pt.fLeafCount){const mn=G(A.tree,pt.fLeafCount.fName);if(mn&&(kt=k(mn),kt||(kt=ge(mn,tt,"$counter"+ee++,!0)),!kt))return console.error(`Cannot add counter branch ${mn.fName}`),null}function ln(mn,jt,Sn){if(!mn||!mn.arr.length)return!0;let cn=$.fName;"."===cn[cn.length-1]&&(cn=cn.slice(0,cn.length-1)),(0,v.isStr)(Ne)&&"."===Ne[0]&&(cn+=Ne),cn+=".";for(let gn=0;gn<mn.arr.length;++gn){const Cn=mn.arr[gn];if(Sn>0&&Cn.fType!==Sn)continue;if(Cn.fType===Je){if(!ln(Cn.fBranches,jt,Sn))return!1;continue}if("BASE"===P(Cn,A.file)?.fTypeName){if(Cn.fTotBytes&&!ge(Cn,tt,We,Ne)||!ln(Cn.fBranches,jt,Sn))return!1;continue}let Zn=Cn.fName,ui=1;if(0===Cn.fName.indexOf(cn))Zn=Zn.slice(cn.length);else if(Sn>0)continue;let hi=Zn.indexOf("[");if(hi>0&&(Zn=Zn.slice(0,hi)),hi=Zn.indexOf("<"),hi>0&&(Zn=Zn.slice(0,hi)),Sn>0){ui="$child$";const qi=Zn.indexOf(".");qi>0&&(ui=g(mn,$.fName+"."+Zn.slice(0,qi+1),gn)||v.clTObject)}if(!ge(Cn,jt,Zn,ui))return!1}return!0}if("TBranchObject"===$._typename)_t={name:We,typename:$.fClassName,virtual:pt.fVirtual,func(mn,jt){let Sn=this.typename;this.virtual&&(Sn=mn.readFastString(mn.ntou1()+1)),jt[this.name]=mn.classStreamer({},Sn)}};else if($.fType===Ke||$.fType===ot){if(rt=(0,V._T)(We,V.nc),!Ne||(0,v.isStr)(Ne)&&"."===Ne[0]||1===Ne){if(A.process_arrays=!1,_t={name:We,conttype:$.fClonesName||v.clTObject,reallocate:I.reallocate_objects,func(mn,jt){const Sn=mn.ntoi4();let cn=0,gn=jt[this.name];for(!gn||this.reallocate?gn=jt[this.name]=new Array(Sn):(cn=gn.length,gn.length=Sn);cn<Sn;)gn[cn++]=this.methods.Create()}},(0,v.isStr)(Ne)&&"."===Ne[0]&&(_t.conttype=g($.fBranches,$.fName+Ne),!_t.conttype))return console.error(`Cannot select object ${Ne} in the branch ${$.fName}`),null;_t.methods=b(_t.conttype),Yt=$.fType===Ke?Re:Qe}}else{if(fn=pe($,A.tree)){if(!0===Ne)return console.warn(`Object branch ${fn} can not have data to be read directly`),null;A.process_arrays=!1;const mn=new Array(tt?tt.length+1:1);for(let jt=0;jt<mn.length-1;++jt)mn[jt]=tt[jt];return mn[mn.length-1]={name:We,lst:b(fn)},ln($.fBranches,mn,0)?Fe:null}if(dt&&1===ht&&pt.fName===$.fName&&-1===$.fID){if(rt=(0,V._T)(We,$.fClassName),rt.fType===V.w1){const mn=A.file.getStreamer($.fClassName,{val:$.fClassVersion,checksum:$.fCheckSum});mn?_t={name:We,typename:$.fClassName,streamer:mn,func(jt,Sn){const cn={_typename:this.typename};for(let gn=0;gn<this.streamer.length;++gn)this.streamer[gn].func(jt,cn);Sn[this.name]=cn}}:(rt=null,console.warn("not found streamer!"))}}else if(dt&&ht<=1)rt=P($,A.file),!rt&&$.fStreamerType&&$.fStreamerType<20&&(rt=(0,V._T)(We,$.fStreamerType));else if(1===ht)rt=R(pt,We);else if("TBranch"===$._typename&&ht>1){const mn=new Array(ht);let jt=!0;for(let Sn=0;Sn<ht;++Sn)mn[Sn]=(0,V.Mx)(R($.fLeaves.arr[Sn]),A.file),mn[Sn]||(jt=!1);jt&&(_t={name:We,leaves:mn,func(Sn,cn){let gn=cn[this.name],Cn=0;for(gn||(cn[this.name]=gn={});Cn<this.leaves.length;)this.leaves[Cn++].func(Sn,gn)}})}}if(!rt&&!_t)return console.warn(`Not supported branch ${$.fName} type ${$._typename}`),null;if(_t||(_t=(0,V.Mx)(rt,A.file),void 0!==_t.base&&_t.basename&&(_t.func=function(mn,jt){jt[this.name]||(jt[this.name]={_typename:this.basename}),mn.classStreamer(jt[this.name],this.basename)})),kt&&(0,v.isStr)(Ne)){_t.name0=kt.name;const mn=We.split(".");if(1===mn.length)_t.get=(jt,Sn)=>jt[Sn];else{if("$child$"===Ne)return console.error(`target name ${We} contains point, but suppose to be direct child`),null;if(2===mn.length)We=_t.name=mn[1],_t.name1=mn[0],_t.subtype1=Ne,_t.methods1=b(_t.subtype1),_t.get=function(jt,Sn){let cn=jt[Sn][this.name1];return cn||(cn=jt[Sn][this.name1]=this.methods1.Create()),cn};else{if(!$.fParentName)return console.error(`Not possible to provide more than 2 parts in the target name ${We}`),null;We=_t.name=mn.pop(),_t.snames=mn,_t.smethods=[];let jt=$.fParentName;for(let Sn=0;Sn<mn.length;++Sn){const cn=w(A.file,jt,mn[Sn]);_t.smethods[Sn]=b(cn||"AbstractClass"),jt=cn}_t.get=function(Sn,cn){let gn=Sn[cn][this.snames[0]];gn||(gn=Sn[cn][this.snames[0]]=this.smethods[0].Create());for(let Cn=1;Cn<this.snames.length;++Cn){let Ln=gn[this.snames[Cn]];Ln||(Ln=gn[this.snames[Cn]]=this.smethods[Cn].Create()),gn=Ln}return gn}}}_t.objs_branch_func?_t.func=_t.objs_branch_func:(_t.func0=_t.func,_t.func=function(jt,Sn){const cn=Sn[this.name0];let gn=0;for(;gn<cn.length;)this.func0(jt,this.get(cn,gn++))})}else if(kt)if(A.process_arrays=!1,rt.fType===V.Q_||rt.fType===V.PI)_t.stl_size=kt.name,_t.func=function(mn,jt){jt[this.name]=this.readarr(mn,jt[this.stl_size])};else if(rt.fType!==V.Pk+V.Q_&&rt.fType!==V.Pk+V.PI||!$.fBranchCount2)if(rt.fType>0&&rt.fType<V.bm||rt.fType===V.V$||rt.fType>V.Pk&&rt.fType<V.Pk+V.bm&&$.fBranchCount2)_t={name:We,stl_size:kt.name,type:rt.fType,func(mn,jt){jt[this.name]=mn.readFastArray(jt[this.stl_size],this.type)}},$.fBranchCount2&&(_t.type-=V.Pk,_t.arr_size=Tt.name,_t.func=function(mn,jt){const Sn=jt[this.stl_size],cn=jt[this.arr_size],gn=new Array(Sn);for(let Cn=0;Cn<Sn;++Cn)gn[Cn]=1===mn.ntou1()?mn.readFastArray(cn[Cn],this.type):[];jt[this.name]=gn});else if(rt.fType>V.Pk&&rt.fType<V.Pk+V.bm&&_t.cntname)_t.cntname=kt.name;else if(rt.fType===V.N8){if(Tt)throw new Error("Second branch counter not supported yet with kStreamer");_t.func=_t.branch_func,_t.stl_size=kt.name}else if(rt.fType===V.mU||rt.fType===V.bm+V.mU)Tt?(_t.stl_size=kt.name,_t.cntname=Tt.name,_t.func=_t.branch_func):_t.cntname=kt.name;else{let mn;if(_t.name="$stl_member",Tt){if(!_t.cntname)throw new Error("Second branch counter not used - very BAD");mn=Tt.name,_t.cntname="$loop_size"}_t={name:We,stl_size:kt.name,loop_size:mn,member0:_t,func(Sn,cn){const gn=cn[this.stl_size],Cn=new Array(gn);for(let Ln=0;Ln<gn;++Ln)this.loop_size&&(cn.$loop_size=cn[this.loop_size][Ln]),this.member0.func(Sn,cn),Cn[Ln]=cn.$stl_member;delete cn.$stl_member,delete cn.$loop_size,cn[this.name]=Cn}}}else _t.stl_size=kt.name,_t.arr_size=Tt.name,_t.func=function(mn,jt){const Sn=jt[this.stl_size],cn=jt[this.arr_size],gn=new Array(Sn);for(let Cn=0;Cn<Sn;++Cn)gn[Cn]=1===mn.ntou1()?this.readarr(mn,cn[Cn]):[];jt[this.name]=gn};return _t.name=We,Fe.member=_t,rt&&(Fe.type=rt.fType),Fe.index=A.arr.length,kt&&(Fe.counters=[kt.index],kt.ascounter.push(Fe.index),Tt&&(Fe.counters.push(Tt.index),Tt.ascounter.push(Fe.index))),A.arr.push(Fe),Yt&&!ln($.fBranches,tt,Yt)?null:Fe}for(let $=0;$<m.numBranches();++$)if(!ge(m.getBranch($),void 0,m.nameOfBranch($),m._directs[$]))return m.Terminate(!1),Promise.reject(Error(`Fail to add branch ${m.nameOfBranch($)}`));for(let $=1;$<A.arr.length&&A.simple_read;++$){const tt=A.arr[$],We=A.arr[0];(tt.numentries!==We.numentries||tt.numbaskets!==We.numbaskets)&&(A.simple_read=!1);for(let Ne=0;Ne<tt.numbaskets;++Ne)tt.getBasketEntry(Ne)!==We.getBasketEntry(Ne)&&(A.simple_read=!1)}A.firstentry=A.lastentry=0;for(let $=0;$<A.arr.length;++$){const tt=A.arr[$].branch,We=tt.fFirstEntry??(tt.fBasketBytes[0]?tt.fBasketEntry[0]:0);A.firstentry=Math.max(A.firstentry,We),A.lastentry=0===$?We+tt.fEntries:Math.min(A.lastentry,We+tt.fEntries)}if(A.firstentry>=A.lastentry)return m.Terminate(!1),Promise.reject(Error("No any common events for selected branches"));if(A.process_min=A.firstentry,A.process_max=A.lastentry,Number.isInteger(I.firstentry)&&I.firstentry>A.firstentry&&I.firstentry<A.lastentry&&(A.process_min=I.firstentry),A.current_entry=A.staged_now=A.process_min,Number.isInteger(I.numentries)&&I.numentries>0){const $=A.process_min+I.numentries;$<A.process_max&&(A.process_max=$)}if((0,v.isFunc)(m.ProcessArrays)&&A.simple_read){for(let $=0;$<A.arr.length;++$){const tt=A.arr[$];(tt.type<=0||tt.type>=V.bm||tt.type===V.k)&&(A.process_arrays=!1)}if(A.process_arrays){m.tgtarr={};for(let $=0;$<A.arr.length;++$){const tt=A.arr[$],We=(0,V._T)(tt.name,tt.type);We.fType=tt.type+V.bm,We.fArrayLength=10,We.fArrayDim=1,We.fMaxIndex[0]=10,tt.arrmember=(0,V.Mx)(We,A.file)}}}else A.process_arrays=!1;function De($){function tt(){const ht=[];let pt="";for(let dt=0;dt<$.length;++dt){if($[dt].done)continue;const rt=$[dt].branch;if(0===ht.length)pt=rt.fFileName;else if(pt!==rt.fFileName)continue;$[dt].selected=!0,ht.push(rt.fBasketSeek[$[dt].basket],rt.fBasketBytes[$[dt].basket])}return ht.length>0?{places:ht,filename:pt}:null}function We(ht){if(A.staged_prev===A.staged_now||A.process_max<=A.process_min)return;const pt=(new Date).getTime();return pt-A.progress_showtm<500?void 0:(A.progress_showtm=pt,A.selector.ShowProgress((A.staged_prev+ht*(A.staged_now-A.staged_prev))/(A.process_max-A.process_min)))}function Ne(ht,pt){return!ht||pt.length>2&&2*ht.length!==pt.length?Promise.resolve(null):(2===pt.length&&(ht=[ht]),function dt(rt){for(;rt<$.length;++rt){if(!$[rt].selected)continue;$[rt].selected=!1,$[rt].done=!0;const Yt=ht.shift();let kt=new V.lW(Yt,0,A.file);const Tt=kt.classStreamer({},V.ym);if(Tt.fNbytes!==$[rt].branch.fBasketBytes[$[rt].basket]&&console.error(`mismatch in read basket sizes ${Tt.fNbytes} != ${$[rt].branch.fBasketBytes[$[rt].basket]}`),$[rt].bskt_obj=Tt,Tt.fKeylen+Tt.fObjlen!==Tt.fNbytes)return(0,V.ry)(Yt,Tt.fObjlen,!1,kt.o).then(fn=>{if(!fn)throw new Error("FAIL TO UNPACK");return kt=new V.lW(fn,0,A.file),kt.raw_shift=Tt.fKeylen,kt.fTagOffset=Tt.fKeylen,$[rt].raw=kt,$[rt].branch.fEntryOffsetLen>0&&kt.readBasketEntryOffset(Tt,kt.raw_shift),dt(rt+1)});kt.raw_shift=0,$[rt].raw=kt,$[rt].branch.fEntryOffsetLen>0&&kt.readBasketEntryOffset(Tt,kt.raw_shift)}const _t=tt();return _t?A.file.readBuffer(_t.places,_t.filename,We).then(Yt=>Ne(Yt)).catch(()=>null):Promise.resolve($)}(0))}const Fe=tt();return Fe?A.file.readBuffer(Fe.places,Fe.filename,We).then(ht=>Ne(ht,Fe.places)).catch(()=>null):Promise.resolve(null)}function Xe(){const $=[];let tt=0,We=!0,Ne=!1,Fe=A.process_max;for(;tt<1e6&&We;){We=!1;for(let pt=A.arr.length-1;pt>=0;--pt){const dt=A.arr[pt];for(;dt.staged_basket<dt.numbaskets;){const rt=dt.staged_basket++;if(dt.getBasketEntry(rt)>=A.process_max)break;if(dt.first_readentry<0){if(dt.getBasketEntry(rt+1)<=A.process_min)continue;dt.curr_basket=rt,dt.first_readentry=dt.getBasketEntry(rt)}const _t={id:pt,branch:dt.branch,basket:rt,raw:null},Yt=dt.branch.fBaskets.arr[rt];Yt?(_t.raw=Yt.fBufferRef,_t.raw?_t.raw.locate(0):_t.raw=new V.lW(null,0,A.file),_t.raw.raw_shift=Yt.fKeylen,Yt.fBufferRef&&dt.branch.fEntryOffsetLen>0&&_t.raw.readBasketEntryOffset(Yt,_t.raw.raw_shift),_t.bskt_obj=Yt,Ne=!0,dt.baskets[rt]=_t):($.push(_t),tt+=dt.branch.fBasketBytes[rt],We=!0),dt.staged_entry=dt.getBasketEntry(rt+1),Fe=Math.min(Fe,dt.staged_entry);break}}}if(0===tt&&!Ne)return A.selector.Terminate(!0),ve(A.selector);A.staged_prev=A.staged_now,A.staged_now=Fe;let ht=0;if(A.process_max>A.process_min&&(ht=(A.staged_prev-A.process_min)/(A.process_max-A.process_min)),"break"===A.selector.ShowProgress(ht))return A.selector.Terminate(!0),ve(A.selector);if(A.progress_showtm=(new Date).getTime(),tt>0)return De($).then(ct);if(Ne)return ct([]);throw new Error("No any data is requested - never come here")}function ct($){if(0!==A.selector._break||null===$)return A.selector.Terminate(!1),ve(A.selector);for(let We=0;We<$.length;++We)A.arr[$[We].id].baskets[$[We].basket]=$[We];let tt=!1;for(;;){let Ne,Fe,We=1e8;for(Ne=0;Ne<A.arr.length;++Ne){if(Fe=A.arr[Ne],!Fe.raw||!Fe.basket||Fe.first_entry+Fe.basket.fNevBuf<=A.current_entry){if(delete Fe.raw,delete Fe.basket,Fe.curr_basket>=Fe.numbaskets){if(0===Ne)return A.selector.Terminate(!0),ve(A.selector);continue}const ht=Fe.baskets[Fe.curr_basket];if(!ht)return tt?Xe():(A.selector.Terminate(!1),Se(Error(`no data for ${Fe.branch.fName} basket ${Fe.curr_basket}`)));Fe.raw=ht.raw,Fe.basket=ht.bskt_obj,Fe.first_entry=Fe.getBasketEntry(ht.basket),ht.raw=null,ht.branch=null,ht.bskt_obj=null,Fe.baskets[Fe.curr_basket++]=void 0}We=Math.min(We,Fe.first_entry+Fe.basket.fNevBuf-A.current_entry)}if(A.current_entry+We>A.process_max&&(We=A.process_max-A.current_entry),A.process_arrays&&We>1){for(Ne=0;Ne<A.arr.length;++Ne)Fe=A.arr[Ne],Fe.getEntry(A.current_entry),Fe.arrmember.arrlength=We,Fe.arrmember.func(Fe.raw,A.selector.tgtarr),Fe.raw=null;A.selector.ProcessArrays(A.current_entry),A.current_entry+=We,tt=!0}else for(;We--;){for(Ne=0;Ne<A.arr.length;++Ne)Fe=A.arr[Ne],Fe.getEntry(A.current_entry),Fe.member.func(Fe.raw,Fe.getTarget(A.selector.tgtobj));A.selector.Process(A.current_entry),A.current_entry++,tt=!0}if(A.current_entry>=A.process_max)return A.selector.Terminate(!0),ve(A.selector)}}return new Promise(($,tt)=>{ve=$,Se=tt,A.selector.Begin(z),Xe()})})).apply(this,arguments)}function O(z,m){return H.apply(this,arguments)}function H(){return(H=(0,be.A)(function*(z,m){(0,v.isStr)(m)&&(m={expr:m}),(0,v.isStr)(m.expr)||(m.expr="");const I=new x;if(m.branch){if(!I.drawOnlyBranch(z,m.branch,m.expr,m))return Promise.reject(Error(`Fail to create draw expression ${m.expr} for branch ${m.branch.fName}`))}else if(!I.parseDrawExpression(z,m))return Promise.reject(Error(`Fail to create draw expression ${m.expr}`));return I.setCallback(null,m.progress),C(z,I,m).then(()=>I.hist)})).apply(this,arguments)}function X(z,m){const I=[],A=[],R=[],ee=function k(Se,De=""){if(!Se?.fBranches)return 0;let Xe=0;for(let ct=0;ct<Se.fBranches.arr.length;++ct){const $=Se.fBranches.arr[ct],tt=(De?De+"/":"")+$.fName;I.push($),A.push(tt),R.push(0);const We=R.length-1;Xe+=$.fLeaves?.arr?.length??0;const Ne=k($,tt);Xe+=Ne,R[We]=Ne}return Xe}(z);let ge;return A.push(`Total are ${I.length} branches with ${ee} leaves`),function ve(Se){if(Se>=I.length||ge?._break||m._break)return Promise.resolve(!0);ge=new re,ge.addBranch(I[Se],"br0"),ge.Process=function(){void 0===this.tgtobj.br0&&(this.fail=!0)},ge.Terminate=function(Fe){(0,v.isStr)(Fe)||(Fe=!Fe||this.fails?"FAIL":"ok"),A[Se]=Fe+" "+A[Se]};const De=I[Se],Xe=pe(De,z),ct=De.fEntries;if((Xe?R[Se]>100:!De.fLeaves?.arr?.length)||ct<=0)return ve(Se+1);const tt={numentries:10},We=De.fFirstEntry||0,Ne=De.fEntryNumber||We+ct;return ct<tt.numentries?tt.numentries=ct:tt.firstentry=We+Math.round((Ne-We-tt.numentries)*Math.random()),console.log(`test branch ${De.fName} first ${tt.firstentry||0} num ${tt.numentries}`),(0,v.isFunc)(m.showProgress)&&m.showProgress(`br ${Se}/${I.length} ${De.fName}`),C(z,ge,tt).then(()=>ve(Se+1))}(0).then(()=>((0,v.isFunc)(m.showProgress)&&m.showProgress(),A))}function ie(z,m){function I(A,R,k,ee){if(!A||!R)return!1;const ge=R.fBranches?.arr?.length??0,ve=R.fLeaves?.arr?.length??0;function Se(Xe){const ct=Xe.indexOf("[");return ct>0&&(Xe=Xe.slice(0,ct)),ee&&0===Xe.indexOf(ee.fName)&&"."===(Xe=Xe.slice(ee.fName.length))[0]&&(Xe=Xe.slice(1)),Xe}R.$tree=k;const De={_name:Se(R.fName),_kind:v.prROOT+R._typename,_title:R.fTitle,_obj:R};if(A._childs||(A._childs=[]),A._childs.push(De),R._typename===L&&(De._title+=` from ${R.fClassName};${R.fClassVersion}`),ge>0)return De._more=!0,De._expand=function(Xe,ct){if(!ct)return!1;Xe._childs||(Xe._childs=[]),1===ct.fLeaves?.arr?.length&&(ct.fType===Ke||ct.fType===ot)&&(ct.fLeaves.arr[0].$branch=ct,Xe._childs.push({_name:"@size",_title:"container size",_kind:v.prROOT+"TLeafElement",_icon:"img_leaf",_obj:ct.fLeaves.arr[0],_more:!1}));for(let We=0;We<ct.fBranches.arr.length;++We)I(Xe,ct.fBranches.arr[We],ct.$tree,ct);const $=pe(ct,ct.$tree,!0),tt=$?(0,v.getMethods)($):null;if(tt&&ct.fBranches.arr.length>0)for(const We in tt){if(!(0,v.isFunc)(tt[We]))continue;const Ne=tt[We].toString();Ne.indexOf("return")>0&&0===Ne.indexOf("function ()")&&Xe._childs.push({_name:We+"()",_title:`function ${We} of class ${$}`,_kind:v.prROOT+he,_obj:{_typename:he,branch:ct,func:We},_more:!1})}return!0},!0;if(1===ve)De._icon="img_leaf",De._more=!1;else if(ve>1){De._childs=[];for(let Xe=0;Xe<ve;++Xe){R.fLeaves.arr[Xe].$branch=R;const ct={_name:Se(R.fLeaves.arr[Xe].fName),_kind:v.prROOT+R.fLeaves.arr[Xe]._typename,_obj:R.fLeaves.arr[Xe]};De._childs.push(ct)}}return!0}if(void 0===m.fBranches)return!1;z._childs=[],z._tree=m;for(let A=0;A<m.fBranches.arr?.length;++A)I(z,m.fBranches.arr[A],m);return!0}},5774:(Gr,xt,Te)=>{"use strict";function be(V,Le,xe,Je,st,Ke,ot){try{var Re=V[Ke](ot),Qe=Re.value}catch(Ie){return void xe(Ie)}Re.done?Le(Qe):Promise.resolve(Qe).then(Je,st)}function v(V){return function(){var Le=this,xe=arguments;return new Promise(function(Je,st){var Ke=V.apply(Le,xe);function ot(Qe){be(Ke,Je,st,ot,Re,"next",Qe)}function Re(Qe){be(Ke,Je,st,ot,Re,"throw",Qe)}ot(void 0)})}}Te.d(xt,{A:()=>v})}},Gr=>{Gr(Gr.s=8096)}]);
//# sourceMappingURL=main.46156344ed4dc2fc.js.map