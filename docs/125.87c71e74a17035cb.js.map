{"version":3,"file":"125.87c71e74a17035cb.js","mappings":"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","names":["RH2Painter","RHistPainter","constructor","dom","histo","super","this","wheel_zoomy","cleanup","tt_handle","getDimension","toggleProjection","kind","width","widthX","widthY","isStr","indexOf","ws","length","slice","parseInt","ps","is_projection","projection_widthX","projection_widthY","proj_hist","new_proj","provideSpecialDrawArea","then","redrawProjection","executeMenuCommand","method","args","fName","fillHistContextMenu","menu","getPadPainter","iscan","kinds","unshift","sub","input","val","k","addchk","arg","endsub","add","autoZoom","opts","getSupportedDrawOptions","addDrawMenu","kInspect","showInspector","decodeOptions","interactiveRedraw","options","Color","fillPaletteMenu","clickButton","funcname","res","toggleColor","toggleMode3D","fillToolbar","pp","addPadButton","showPadButtons","Mode3D","redraw","i1","getSelectIndex","i2","j1","j2","getHisto","xaxis","getAxis","yaxis","min","getBinContent","i","j","Math","ileft","iright","jleft","jright","xmin","xmax","ymin","ymax","isany","GetBinCoord","getFramePainter","zoom","scanContent","when_axis_changed","nbinsx","nbinsy","extractAxesProperties","isDisplayItem","gminbin","fContMin","gminposbin","fContMinPos","gmaxbin","fContMax","bin_content","zmin","zmax","draw_content","Axis","countStat","cond","name","entries","integral","meanx","meany","rmsx","rmsy","matrix","wmax","xleft","xright","yleft","yright","xside","yside","xx","yy","zz","xi","yi","stat_sum0","stat_sumx1","stat_sumy1","stat_sumx2","stat_sumy2","abs","sqrt","fillStatistic","stat","dostat","data","print_name","floor","print_entries","print_mean","print_rms","print_under","print_over","print_integral","print_skew","print_kurt","clearStat","addText","format","m","toFixed","drawBinsColor","handle","prepareDraw","di","stepi","dj","stepj","colindx","cmd1","cmd2","binz","dx","dy","entry","last_entry","flush_last_entry","path","y2","y","grx","palette","getContourIndex","Zero","_show_empty_bins","gry","undefined","x","forEach","draw_g","append","attr","style","getColor","updatePaletteDraw","drawBinsContour","funcs","frame_w","frame_h","rounding","extra","main","getHistPalette","levels","getContour","func","getProjectionFunc","Contour","buildHist2dContour","xp","yp","iminus","iplus","icol","lineatt","fillcolor","createAttLine","color","std","dd","BuildPath","do_close","last","pnt","first","cmd","round","elem","call","hide_only_zeros","createPolyBin","drawBinsText","_this","_asyncToGenerator","textFont","v7EvalFont","size","align","text_offset","BarOffset","text_g","startTextDrawingAsync","binw","binh","text","toString","floatToString","gStyle","fPaintTextFormat","height","angle","drawText","latex","finishTextDrawing","drawBinsArrow","scale_x","scale_y","makeLine","xc","yc","dxn","dyn","x1","x2","y1","anr","si","co","dn","loop","max","drawBinsBox","maxbin","minbin","minposbin","absmax","absmin","absz","zdiff","dgrx","dgry","ww","hh","xyfactor","cross","btn1","btn2","uselogz","logmin","logz","logmax","log","BoxStyle","pww","phh","side1","side2","fillatt","empty","hasColor","d3_rgb","brighter","formatRgb","darker","drawBinsScatter","pixel_density","scatter_plot","colPaths","currx","curry","cell_w","cell_h","scale","ScatCoef","rnd","TRandom","sumz","cw","ch","factor","createv7AttMarker","markeratt","resetPos","npix","create","random","layer","getFrameSvg","selectChild","defs","insert","cntr","pattern_id","pad_name","pattern","selectAll","remove","arrx","Float32Array","arry","n","draw2DBins","_this2","removeG","createHistDrawAttributes","createG","pmain","rect","getFrameRect","getGrFuncs","second_x","second_y","pr","Scat","Box","Arrow","Text","Promise","resolve","h","getBinTooltips","lines","stepx","stepy","push","getObjectHint","getAxisBinTip","$baseh","lbl","fStatFormat","getPolyBinTooltips","processTooltipEvent","ttrect","Proj","poly","title","fTitle","color1","color2","getFillColorAlt","exact","disabled","changed","addHighlightStyle","binid","pwx","ddx","pwy","ddy","getFrameWidth","getFrameHeight","property","user_info","obj","bin","getBin","cont","binx","biny","canZoomInside","axis","FindBin","draw2D","reason","_this3","clear3DScene","drawFrameAxes","drawingBins","addInteractivity","draw3D","_this4","console","callDrawFunc","_this5","mode3d","isMainPainter","_this6","_draw","painter","ensureRCanvas","setAsMainPainter","Hist","Error","Mark","Line","Fill","Lego","Surf","TextAngle","TextKind","BaseLine","AutoColor","BarWidth","minimum","kNoZoom","maximum","FrontBox","BackBox","v7EvalAttr","o","draw","opt","RH2Painter2D","draw3DBins","drawBinsSurf3D","drawBinsError3D","drawBinsContour3D","drawBinsLego","is_main","resize3D","render3D","zmult","fHistTopMargin","deleteAttr","assignFrame3DMethods","create3DScene","Render3D","setAxesRanges","set3DOptions","drawXYZ","toplevel","RAxisPainter","settings","Zooming","ndim","v7","addKeysHandler"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["../node_modules/jsroot/modules/hist2d/RH2Painter.mjs","../node_modules/jsroot/modules/hist/RH2Painter.mjs"],"sourcesContent":["import { gStyle, isStr, kNoZoom, kInspect } from '../core.mjs';\nimport { rgb as d3_rgb } from '../d3.mjs';\nimport { floatToString, TRandom, addHighlightStyle } from '../base/BasePainter.mjs';\nimport { RHistPainter } from './RHistPainter.mjs';\nimport { ensureRCanvas } from '../gpad/RCanvasPainter.mjs';\nimport { buildHist2dContour } from '../hist2d/TH2Painter.mjs';\n\n/**\n * @summary Painter for RH2 classes\n *\n * @private\n */\n\nclass RH2Painter extends RHistPainter {\n\n   /** @summary constructor\n     * @param {object|string} dom - DOM element or id\n     * @param {object} histo - histogram object */\n   constructor(dom, histo) {\n      super(dom, histo);\n      this.wheel_zoomy = true;\n   }\n\n   /** @summary Cleanup painter */\n   cleanup() {\n      delete this.tt_handle;\n      super.cleanup();\n   }\n\n   /** @summary Returns histogram dimension */\n   getDimension() { return 2; }\n\n   /** @summary Toggle projection */\n   toggleProjection(kind, width) {\n      if ((kind === 'Projections') || (kind === 'Off'))\n         kind = '';\n\n      let widthX = width, widthY = width;\n\n      if (isStr(kind) && (kind.indexOf('XY') === 0)) {\n         const ws = kind.length > 2 ? kind.slice(2) : '';\n         kind = 'XY';\n         widthX = widthY = parseInt(ws);\n      } else if (isStr(kind) && (kind.length > 1)) {\n         const ps = kind.indexOf('_');\n         if ((ps > 0) && (kind[0] === 'X') && (kind[ps+1] === 'Y')) {\n            widthX = parseInt(kind.slice(1, ps)) || 1;\n            widthY = parseInt(kind.slice(ps+2)) || 1;\n            kind = 'XY';\n         } else if ((ps > 0) && (kind[0] === 'Y') && (kind[ps+1] === 'X')) {\n            widthY = parseInt(kind.slice(1, ps)) || 1;\n            widthX = parseInt(kind.slice(ps+2)) || 1;\n            kind = 'XY';\n         } else {\n            widthX = widthY = parseInt(kind.slice(1)) || 1;\n            kind = kind[0];\n         }\n      }\n\n      if (!widthX && !widthY)\n         widthX = widthY = 1;\n\n      if (kind && (this.is_projection === kind)) {\n         if ((this.projection_widthX === widthX) && (this.projection_widthY === widthY))\n            kind = '';\n          else {\n            this.projection_widthX = widthX;\n            this.projection_widthY = widthY;\n            return;\n         }\n      }\n\n      delete this.proj_hist;\n\n      const new_proj = (this.is_projection === kind) ? '' : kind;\n      this.projection_widthX = widthX;\n      this.projection_widthY = widthY;\n      this.is_projection = ''; // avoid projection handling until area is created\n\n      this.provideSpecialDrawArea(new_proj).then(() => { this.is_projection = new_proj; return this.redrawProjection(); });\n   }\n\n   /** @summary Redraw projections */\n   redrawProjection(/* ii1, ii2, jj1, jj2 */) {\n      // do nothing for the moment\n      // if (!this.is_projection) return;\n   }\n\n   /** @summary Execute menu command */\n   executeMenuCommand(method, args) {\n      if (super.executeMenuCommand(method, args)) return true;\n\n      if ((method.fName === 'SetShowProjectionX') || (method.fName === 'SetShowProjectionY')) {\n         this.toggleProjection(method.fName[17], args && parseInt(args) ? parseInt(args) : 1);\n         return true;\n      }\n\n      return false;\n   }\n\n   /** @summary Fill histogram context menu */\n   fillHistContextMenu(menu) {\n      if (this.getPadPainter()?.iscan) {\n         let kind = this.is_projection || '';\n         if (kind) kind += this.projection_widthX;\n         if ((this.projection_widthX !== this.projection_widthY) && (this.is_projection === 'XY'))\n            kind = `X${this.projection_widthX}_Y${this.projection_widthY}`;\n         const kinds = ['X1', 'X2', 'X3', 'X5', 'X10', 'Y1', 'Y2', 'Y3', 'Y5', 'Y10', 'XY1', 'XY2', 'XY3', 'XY5', 'XY10'];\n         if (kind) kinds.unshift('Off');\n\n         menu.sub('Projections', () => menu.input('Input projection kind X1 or XY2 or X3_Y4', kind, 'string').then(val => this.toggleProjection(val)));\n         for (let k = 0; k < kinds.length; ++k)\n            menu.addchk(kind === kinds[k], kinds[k], kinds[k], arg => this.toggleProjection(arg));\n         menu.endsub();\n      }\n\n      menu.add('Auto zoom-in', () => this.autoZoom());\n\n      const opts = this.getSupportedDrawOptions();\n\n      menu.addDrawMenu('Draw with', opts, arg => {\n         if (arg.indexOf(kInspect) === 0)\n            return this.showInspector(arg);\n         this.decodeOptions(arg);\n         this.interactiveRedraw('pad', 'drawopt');\n      });\n\n      if (this.options.Color)\n         this.fillPaletteMenu(menu);\n   }\n\n   /** @summary Process click on histogram-defined buttons */\n   clickButton(funcname) {\n      const res = super.clickButton(funcname);\n      if (res) return res;\n\n      switch (funcname) {\n         case 'ToggleColor': return this.toggleColor();\n         case 'Toggle3D': return this.toggleMode3D();\n      }\n\n      // all methods here should not be processed further\n      return false;\n   }\n\n   /** @summary Fill pad toolbar with RH2-related functions */\n   fillToolbar() {\n      super.fillToolbar(true);\n\n      const pp = this.getPadPainter();\n      if (!pp) return;\n\n      pp.addPadButton('th2color', 'Toggle color', 'ToggleColor');\n      pp.addPadButton('th2colorz', 'Toggle color palette', 'ToggleColorZ');\n      pp.addPadButton('th2draw3d', 'Toggle 3D mode', 'Toggle3D');\n      pp.showPadButtons();\n   }\n\n   /** @summary Toggle color drawing mode */\n   toggleColor() {\n      if (this.options.Mode3D) {\n         this.options.Mode3D = false;\n         this.options.Color = true;\n      } else\n         this.options.Color = !this.options.Color;\n\n      return this.redraw();\n   }\n\n   /** @summary Perform automatic zoom inside non-zero region of histogram */\n   autoZoom() {\n      const i1 = this.getSelectIndex('x', 'left', -1),\n            i2 = this.getSelectIndex('x', 'right', 1),\n            j1 = this.getSelectIndex('y', 'left', -1),\n            j2 = this.getSelectIndex('y', 'right', 1),\n            histo = this.getHisto(), xaxis = this.getAxis('x'), yaxis = this.getAxis('y');\n\n      if ((i1 === i2) || (j1 === j2)) return;\n\n      // first find minimum\n      let min = histo.getBinContent(i1 + 1, j1 + 1);\n      for (let i = i1; i < i2; ++i) {\n         for (let j = j1; j < j2; ++j)\n            min = Math.min(min, histo.getBinContent(i+1, j+1));\n      }\n      if (min > 0) return; // if all points positive, no chance for auto-scale\n\n      let ileft = i2, iright = i1, jleft = j2, jright = j1;\n\n      for (let i = i1; i < i2; ++i) {\n         for (let j = j1; j < j2; ++j) {\n            if (histo.getBinContent(i + 1, j + 1) > min) {\n               if (i < ileft) ileft = i;\n               if (i >= iright) iright = i + 1;\n               if (j < jleft) jleft = j;\n               if (j >= jright) jright = j + 1;\n            }\n         }\n      }\n\n      let xmin, xmax, ymin, ymax, isany = false;\n\n      if ((ileft === iright-1) && (ileft > i1+1) && (iright < i2-1)) { ileft--; iright++; }\n      if ((jleft === jright-1) && (jleft > j1+1) && (jright < j2-1)) { jleft--; jright++; }\n\n      if ((ileft > i1 || iright < i2) && (ileft < iright - 1)) {\n         xmin = xaxis.GetBinCoord(ileft);\n         xmax = xaxis.GetBinCoord(iright);\n         isany = true;\n      }\n\n      if ((jleft > j1 || jright < j2) && (jleft < jright - 1)) {\n         ymin = yaxis.GetBinCoord(jleft);\n         ymax = yaxis.GetBinCoord(jright);\n         isany = true;\n      }\n\n      if (isany)\n         return this.getFramePainter().zoom(xmin, xmax, ymin, ymax);\n   }\n\n   /** @summary Scan content of 2-dim histogram */\n   scanContent(when_axis_changed) {\n      // no need to re-scan histogram while result does not depend from axis selection\n      if (when_axis_changed && this.nbinsx && this.nbinsy) return;\n\n      const histo = this.getHisto();\n\n      this.extractAxesProperties(2);\n\n      if (this.isDisplayItem()) {\n         // take min/max values from the display item\n         this.gminbin = histo.fContMin;\n         this.gminposbin = histo.fContMinPos > 0 ? histo.fContMinPos : null;\n         this.gmaxbin = histo.fContMax;\n      } else {\n         // global min/max, used at the moment in 3D drawing\n         this.gminbin = this.gmaxbin = histo.getBinContent(1, 1);\n         this.gminposbin = null;\n         for (let i = 0; i < this.nbinsx; ++i) {\n            for (let j = 0; j < this.nbinsy; ++j) {\n               const bin_content = histo.getBinContent(i+1, j+1);\n               if (bin_content < this.gminbin) this.gminbin = bin_content; else\n                  if (bin_content > this.gmaxbin) this.gmaxbin = bin_content;\n               if (bin_content > 0)\n                  if ((this.gminposbin === null) || (this.gminposbin > bin_content)) this.gminposbin = bin_content;\n            }\n         }\n      }\n\n      this.zmin = this.gminbin;\n      this.zmax = this.gmaxbin;\n\n      // this value used for logz scale drawing\n      if ((this.gminposbin === null) && (this.gmaxbin > 0))\n         this.gminposbin = this.gmaxbin*1e-4;\n\n      if (this.options.Axis > 0)  // Paint histogram axis only\n         this.draw_content = false;\n      else\n         this.draw_content = (this.gmaxbin !== 0) || (this.gminbin !== 0);\n   }\n\n   /** @summary Count statistic */\n   countStat(cond) {\n      const histo = this.getHisto(),\n            res = { name: 'histo', entries: 0, integral: 0, meanx: 0, meany: 0, rmsx: 0, rmsy: 0, matrix: [0, 0, 0, 0, 0, 0, 0, 0, 0], xmax: 0, ymax: 0, wmax: null },\n            xleft = this.getSelectIndex('x', 'left'),\n            xright = this.getSelectIndex('x', 'right'),\n            yleft = this.getSelectIndex('y', 'left'),\n            yright = this.getSelectIndex('y', 'right'),\n            xaxis = this.getAxis('x'), yaxis = this.getAxis('y');\n      let stat_sum0 = 0, stat_sumx1 = 0, stat_sumy1 = 0,\n          stat_sumx2 = 0, stat_sumy2 = 0,\n          xside, yside, xx, yy, zz,\n          xi, yi;\n\n      // TODO: account underflow/overflow bins, now stored in different array and only by histogram itself\n      for (xi = 1; xi <= this.nbinsx; ++xi) {\n         xside = (xi <= xleft+1) ? 0 : (xi > xright+1 ? 2 : 1);\n         xx = xaxis.GetBinCoord(xi - 0.5);\n\n         for (yi = 1; yi <= this.nbinsy; ++yi) {\n            yside = (yi <= yleft+1) ? 0 : (yi > yright+1 ? 2 : 1);\n            yy = yaxis.GetBinCoord(yi - 0.5);\n\n            zz = histo.getBinContent(xi, yi);\n\n            res.entries += zz;\n\n            res.matrix[yside * 3 + xside] += zz;\n\n            if ((xside !== 1) || (yside !== 1)) continue;\n\n            if (cond && !cond(xx, yy)) continue;\n\n            if ((res.wmax === null) || (zz > res.wmax)) { res.wmax = zz; res.xmax = xx; res.ymax = yy; }\n\n            stat_sum0 += zz;\n            stat_sumx1 += xx * zz;\n            stat_sumy1 += yy * zz;\n            stat_sumx2 += xx**2 * zz;\n            stat_sumy2 += yy**2 * zz;\n         }\n      }\n\n      if (Math.abs(stat_sum0) > 1e-300) {\n         res.meanx = stat_sumx1 / stat_sum0;\n         res.meany = stat_sumy1 / stat_sum0;\n         res.rmsx = Math.sqrt(Math.abs(stat_sumx2 / stat_sum0 - res.meanx**2));\n         res.rmsy = Math.sqrt(Math.abs(stat_sumy2 / stat_sum0 - res.meany**2));\n      }\n\n      if (res.wmax === null) res.wmax = 0;\n      res.integral = stat_sum0;\n      return res;\n   }\n\n   /** @summary Fill statistic into statistic box */\n   fillStatistic(stat, dostat /* , dofit */) {\n      const data = this.countStat(),\n          print_name = Math.floor(dostat % 10),\n          print_entries = Math.floor(dostat / 10) % 10,\n          print_mean = Math.floor(dostat / 100) % 10,\n          print_rms = Math.floor(dostat / 1000) % 10,\n          print_under = Math.floor(dostat / 10000) % 10,\n          print_over = Math.floor(dostat / 100000) % 10,\n          print_integral = Math.floor(dostat / 1000000) % 10,\n          print_skew = Math.floor(dostat / 10000000) % 10,\n          print_kurt = Math.floor(dostat / 100000000) % 10;\n\n      stat.clearStat();\n\n      if (print_name > 0)\n         stat.addText(data.name);\n\n      if (print_entries > 0)\n         stat.addText('Entries = ' + stat.format(data.entries, 'entries'));\n\n      if (print_mean > 0) {\n         stat.addText('Mean x = ' + stat.format(data.meanx));\n         stat.addText('Mean y = ' + stat.format(data.meany));\n      }\n\n      if (print_rms > 0) {\n         stat.addText('Std Dev x = ' + stat.format(data.rmsx));\n         stat.addText('Std Dev y = ' + stat.format(data.rmsy));\n      }\n\n      if (print_integral > 0)\n         stat.addText('Integral = ' + stat.format(data.matrix[4], 'entries'));\n\n      if (print_skew > 0) {\n         stat.addText('Skewness x = <undef>');\n         stat.addText('Skewness y = <undef>');\n      }\n\n      if (print_kurt > 0)\n         stat.addText('Kurt = <undef>');\n\n      if ((print_under > 0) || (print_over > 0)) {\n         const m = data.matrix;\n\n         stat.addText('' + m[6].toFixed(0) + ' | ' + m[7].toFixed(0) + ' | ' + m[7].toFixed(0));\n         stat.addText('' + m[3].toFixed(0) + ' | ' + m[4].toFixed(0) + ' | ' + m[5].toFixed(0));\n         stat.addText('' + m[0].toFixed(0) + ' | ' + m[1].toFixed(0) + ' | ' + m[2].toFixed(0));\n      }\n\n      return true;\n   }\n\n   /** @summary Draw histogram bins as color */\n   drawBinsColor() {\n      const histo = this.getHisto(),\n            handle = this.prepareDraw(),\n            di = handle.stepi, dj = handle.stepj,\n            entries = [],\n            can_merge = true;\n      let colindx, cmd1, cmd2, i, j, binz, dx, dy, entry, last_entry;\n\n      const flush_last_entry = () => {\n         last_entry.path += `h${dx}v${last_entry.y2-last_entry.y}h${-dx}z`;\n         last_entry.dy = 0;\n         last_entry = null;\n      };\n\n      // now start build\n      for (i = handle.i1; i < handle.i2; i += di) {\n         dx = (handle.grx[i+di] - handle.grx[i]) || 1;\n\n         for (j = handle.j1; j < handle.j2; j += dj) {\n            binz = histo.getBinContent(i+1, j+1);\n            colindx = handle.palette.getContourIndex(binz);\n            if (binz === 0) {\n               if (!this.options.Zero)\n                  colindx = null;\n               else if ((colindx === null) && this._show_empty_bins)\n                  colindx = 0;\n            }\n            if (colindx === null) {\n               if (last_entry) flush_last_entry();\n               continue;\n            }\n\n            cmd1 = `M${handle.grx[i]},${handle.gry[j]}`;\n\n            dy = (handle.gry[j+dj] - handle.gry[j]) || -1;\n\n            entry = entries[colindx];\n\n            if (entry === undefined)\n               entry = entries[colindx] = { path: cmd1 };\n             else if (can_merge && (entry === last_entry)) {\n               entry.y2 = handle.gry[j] + dy;\n               continue;\n            } else {\n               cmd2 = `m${handle.grx[i]-entry.x},${handle.gry[j]-entry.y}`;\n               entry.path += (cmd2.length < cmd1.length) ? cmd2 : cmd1;\n            }\n            if (last_entry) flush_last_entry();\n            entry.x = handle.grx[i];\n            entry.y = handle.gry[j];\n            if (can_merge) {\n               entry.y2 = handle.gry[j] + dy;\n               last_entry = entry;\n            } else\n               entry.path += `h${dx}v${dy}h${-dx}z`;\n         }\n         if (last_entry) flush_last_entry();\n      }\n\n      entries.forEach((entry, colindx) => {\n         if (entry) {\n            this.draw_g\n                .append('svg:path')\n                .attr('d', entry.path)\n                .style('fill', handle.palette.getColor(colindx));\n         }\n      });\n\n      this.updatePaletteDraw();\n\n      return handle;\n   }\n\n   /** @summary Draw histogram bins as contour */\n   drawBinsContour(funcs, frame_w, frame_h) {\n      const handle = this.prepareDraw({ rounding: false, extra: 100 }),\n          main = this.getFramePainter(),\n          palette = main.getHistPalette(),\n          levels = palette.getContour(),\n          func = main.getProjectionFunc(),\n\n       BuildPath = (xp, yp, iminus, iplus, do_close) => {\n         let cmd = '', last, pnt, first, isany;\n         for (let i = iminus; i <= iplus; ++i) {\n            if (func) {\n               pnt = func(xp[i], yp[i]);\n               pnt.x = Math.round(funcs.grx(pnt.x));\n               pnt.y = Math.round(funcs.gry(pnt.y));\n            } else\n               pnt = { x: Math.round(xp[i]), y: Math.round(yp[i]) };\n\n            if (!cmd) {\n               cmd = `M${pnt.x},${pnt.y}`; first = pnt;\n            } else if ((i === iplus) && first && (pnt.x === first.x) && (pnt.y === first.y)) {\n               if (!isany) return ''; // all same points\n               cmd += 'z'; do_close = false;\n            } else if ((pnt.x !== last.x) && (pnt.y !== last.y)) {\n               cmd += `l${pnt.x - last.x},${pnt.y - last.y}`; isany = true;\n            } else if (pnt.x !== last.x) {\n               cmd += `h${pnt.x - last.x}`; isany = true;\n            } else if (pnt.y !== last.y) {\n               cmd += `v${pnt.y - last.y}`; isany = true;\n            }\n            last = pnt;\n         }\n         if (do_close) cmd += 'z';\n         return cmd;\n      };\n\n      if (this.options.Contour === 14) {\n         this.draw_g\n             .append('svg:path')\n             .attr('d', `M0,0h${frame_w}v${frame_h}h${-frame_w}z`)\n             .style('fill', palette.getColor(0));\n      }\n\n      buildHist2dContour(this.getHisto(), handle, levels, palette,\n         (colindx, xp, yp, iminus, iplus) => {\n            const icol = palette.getColor(colindx);\n            let fillcolor = icol, lineatt;\n\n            switch (this.options.Contour) {\n               case 1: break;\n               case 11: fillcolor = 'none'; lineatt = this.createAttLine({ color: icol, std: false }); break;\n               case 12: fillcolor = 'none'; lineatt = this.createAttLine({ color: 1, style: (colindx%5 + 1), width: 1, std: false }); break;\n               case 13: fillcolor = 'none'; lineatt = this.lineatt; break;\n               case 14: break;\n            }\n\n            const dd = BuildPath(xp, yp, iminus, iplus, fillcolor !== 'none');\n            if (!dd) return;\n\n            const elem = this.draw_g\n                          .append('svg:path')\n                          .attr('d', dd)\n                          .style('fill', fillcolor);\n\n            if (lineatt)\n               elem.call(lineatt.func);\n         }\n      );\n\n      handle.hide_only_zeros = true; // text drawing suppress only zeros\n\n      return handle;\n   }\n\n   /** @summary Create poly bin */\n   createPolyBin() {\n      // see how TH2Painter is implemented\n      return '';\n   }\n\n   /** @summary Draw RH2 bins as text */\n   async drawBinsText(handle) {\n      if (!handle)\n         handle = this.prepareDraw({ rounding: false });\n\n      const histo = this.getHisto(),\n            textFont = this.v7EvalFont('text', { size: 20, color: 'black', align: 22 }),\n            text_offset = this.options.BarOffset || 0,\n            text_g = this.draw_g.append('svg:g').attr('class', 'th2_text'),\n            di = handle.stepi, dj = handle.stepj,\n            profile2d = false;\n\n      return this.startTextDrawingAsync(textFont, 'font', text_g).then(() => {\n         for (let i = handle.i1; i < handle.i2; i += di) {\n            for (let j = handle.j1; j < handle.j2; j += dj) {\n               let binz = histo.getBinContent(i+1, j+1);\n               if ((binz === 0) && !this._show_empty_bins) continue;\n\n               const binw = handle.grx[i+di] - handle.grx[i],\n                     binh = handle.gry[j] - handle.gry[j+dj];\n\n               if (profile2d)\n                  binz = histo.getBinEntries(i+1, j+1);\n\n               const text = (binz === Math.round(binz)) ? binz.toString() : floatToString(binz, gStyle.fPaintTextFormat);\n\n               let x, y, width, height;\n\n               if (textFont.angle) {\n                  x = Math.round(handle.grx[i] + binw*0.5);\n                  y = Math.round(handle.gry[j+dj] + binh*(0.5 + text_offset));\n                  width = height = 0;\n               } else {\n                  x = Math.round(handle.grx[i] + binw*0.1);\n                  y = Math.round(handle.gry[j+dj] + binh*(0.1 + text_offset));\n                  width = Math.round(binw*0.8);\n                  height = Math.round(binh*0.8);\n               }\n\n               this.drawText({ align: 22, x, y, width, height, text, latex: 0, draw_g: text_g });\n            }\n         }\n\n         handle.hide_only_zeros = true; // text drawing suppress only zeros\n\n         return this.finishTextDrawing(text_g, true);\n      }).then(() => handle);\n   }\n\n   /** @summary Draw RH2 bins as arrows */\n   drawBinsArrow() {\n      const histo = this.getHisto(),\n            handle = this.prepareDraw({ rounding: false }),\n            scale_x = (handle.grx[handle.i2] - handle.grx[handle.i1])/(handle.i2 - handle.i1 + 1-0.03)/2,\n            scale_y = (handle.gry[handle.j2] - handle.gry[handle.j1])/(handle.j2 - handle.j1 + 1-0.03)/2,\n            di = handle.stepi, dj = handle.stepj,\n            makeLine = (dx, dy) => dx ? (dy ? `l${dx},${dy}` : `h${dx}`) : (dy ? `v${dy}` : '');\n      let cmd = '', i, j, dn = 1e-30, dx, dy, xc, yc,\n          dxn, dyn, x1, x2, y1, y2, anr, si, co;\n\n      for (let loop = 0; loop < 2; ++loop) {\n         for (i = handle.i1; i < handle.i2; i += di) {\n            for (j = handle.j1; j < handle.j2; j += dj) {\n               if (i === handle.i1)\n                  dx = histo.getBinContent(i+1+di, j+1) - histo.getBinContent(i+1, j+1);\n                else if (i >= handle.i2-di)\n                  dx = histo.getBinContent(i+1, j+1) - histo.getBinContent(i+1-di, j+1);\n                else\n                  dx = 0.5*(histo.getBinContent(i+1+di, j+1) - histo.getBinContent(i+1-di, j+1));\n\n               if (j === handle.j1)\n                  dy = histo.getBinContent(i+1, j+1+dj) - histo.getBinContent(i+1, j+1);\n                else if (j >= handle.j2-dj)\n                  dy = histo.getBinContent(i+1, j+1) - histo.getBinContent(i+1, j+1-dj);\n                else\n                  dy = 0.5*(histo.getBinContent(i+1, j+1+dj) - histo.getBinContent(i+1, j+1-dj));\n\n\n               if (loop === 0)\n                  dn = Math.max(dn, Math.abs(dx), Math.abs(dy));\n                else {\n                  xc = (handle.grx[i] + handle.grx[i+di])/2;\n                  yc = (handle.gry[j] + handle.gry[j+dj])/2;\n                  dxn = scale_x*dx/dn;\n                  dyn = scale_y*dy/dn;\n                  x1 = xc - dxn;\n                  x2 = xc + dxn;\n                  y1 = yc - dyn;\n                  y2 = yc + dyn;\n                  dx = Math.round(x2-x1);\n                  dy = Math.round(y2-y1);\n\n                  if ((dx !== 0) || (dy !== 0)) {\n                     cmd += 'M'+Math.round(x1)+','+Math.round(y1) + makeLine(dx, dy);\n\n                     if (Math.abs(dx) > 5 || Math.abs(dy) > 5) {\n                        anr = Math.sqrt(2/(dx**2 + dy**2));\n                        si = Math.round(anr*(dx + dy));\n                        co = Math.round(anr*(dx - dy));\n                        if (si || co)\n                           cmd += `m${-si},${co}` + makeLine(si, -co) + makeLine(-co, -si);\n                     }\n                  }\n               }\n            }\n         }\n      }\n\n      this.draw_g\n         .append('svg:path')\n         .attr('d', cmd)\n         .style('fill', 'none')\n         .call(this.lineatt.func);\n\n      return handle;\n   }\n\n   /** @summary Draw RH2 bins as boxes */\n   drawBinsBox() {\n      const histo = this.getHisto(),\n            handle = this.prepareDraw({ rounding: false }),\n            main = this.getFramePainter();\n\n      if (main.maxbin === main.minbin) {\n         main.maxbin = this.gmaxbin;\n         main.minbin = this.gminbin;\n         main.minposbin = this.gminposbin;\n      }\n      if (main.maxbin === main.minbin)\n         main.minbin = Math.min(0, main.maxbin-1);\n\n      const absmax = Math.max(Math.abs(main.maxbin), Math.abs(main.minbin)),\n            absmin = Math.max(0, main.minbin),\n            di = handle.stepi, dj = handle.stepj;\n      let i, j, binz, absz, res = '', cross = '', btn1 = '', btn2 = '',\n          zdiff, dgrx, dgry, xx, yy, ww, hh,\n          xyfactor, uselogz = false, logmin = 0;\n\n      if (main.logz && (absmax > 0)) {\n         uselogz = true;\n         const logmax = Math.log(absmax);\n         if (absmin > 0)\n            logmin = Math.log(absmin);\n         else if ((main.minposbin >= 1) && (main.minposbin < 100))\n            logmin = Math.log(0.7);\n          else\n            logmin = (main.minposbin > 0) ? Math.log(0.7*main.minposbin) : logmax - 10;\n         if (logmin >= logmax) logmin = logmax - 10;\n         xyfactor = 1.0 / (logmax - logmin);\n      } else\n         xyfactor = 1.0 / (absmax - absmin);\n\n\n      // now start build\n      for (i = handle.i1; i < handle.i2; i += di) {\n         for (j = handle.j1; j < handle.j2; j += dj) {\n            binz = histo.getBinContent(i + 1, j + 1);\n            absz = Math.abs(binz);\n            if ((absz === 0) || (absz < absmin)) continue;\n\n            zdiff = uselogz ? ((absz > 0) ? Math.log(absz) - logmin : 0) : (absz - absmin);\n            // area of the box should be proportional to absolute bin content\n            zdiff = 0.5 * ((zdiff < 0) ? 1 : (1 - Math.sqrt(zdiff * xyfactor)));\n            // avoid oversized bins\n            if (zdiff < 0) zdiff = 0;\n\n            ww = handle.grx[i+di] - handle.grx[i];\n            hh = handle.gry[j] - handle.gry[j+dj];\n\n            dgrx = zdiff * ww;\n            dgry = zdiff * hh;\n\n            xx = Math.round(handle.grx[i] + dgrx);\n            yy = Math.round(handle.gry[j+dj] + dgry);\n\n            ww = Math.max(Math.round(ww - 2*dgrx), 1);\n            hh = Math.max(Math.round(hh - 2*dgry), 1);\n\n            res += `M${xx},${yy}v${hh}h${ww}v${-hh}z`;\n\n            if ((binz < 0) && (this.options.BoxStyle === 10))\n               cross += `M${xx},${yy}l${ww},${hh}M${xx+ww},${yy}l${-ww},${hh}`;\n\n            if ((this.options.BoxStyle === 11) && (ww>5) && (hh>5)) {\n               const pww = Math.round(ww*0.1),\n                     phh = Math.round(hh*0.1),\n                     side1 = `M${xx},${yy}h${ww}l${-pww},${phh}h${2*pww-ww}v${hh-2*phh}l${-pww},${phh}z`,\n                     side2 = `M${xx+ww},${yy+hh}v${-hh}l${-pww},${phh}v${hh-2*phh}h${2*pww-ww}l${-pww},${phh}z`;\n               btn2 += (binz < 0) ? side1 : side2;\n               btn1 += (binz < 0) ? side2 : side1;\n            }\n         }\n      }\n\n      if (res) {\n         const elem = this.draw_g\n                        .append('svg:path')\n                        .attr('d', res)\n                        .call(this.fillatt.func);\n         if ((this.options.BoxStyle !== 11) && this.fillatt.empty())\n            elem.call(this.lineatt.func);\n      }\n\n      if (btn1 && this.fillatt.hasColor()) {\n         this.draw_g.append('svg:path')\n                    .attr('d', btn1)\n                    .call(this.fillatt.func)\n                    .style('fill', d3_rgb(this.fillatt.color).brighter(0.5).formatRgb());\n      }\n\n      if (btn2) {\n         this.draw_g.append('svg:path')\n                    .attr('d', btn2)\n                    .call(this.fillatt.func)\n                    .style('fill', !this.fillatt.hasColor() ? 'red' : d3_rgb(this.fillatt.color).darker(0.5).formatRgb());\n      }\n\n      if (cross) {\n         const elem = this.draw_g.append('svg:path')\n                               .attr('d', cross)\n                               .style('fill', 'none');\n         if (!this.lineatt.empty())\n            elem.call(this.lineatt.func);\n      }\n\n      return handle;\n   }\n\n   /** @summary Draw RH2 bins as scatter plot */\n   drawBinsScatter() {\n      const histo = this.getHisto(),\n            handle = this.prepareDraw({ rounding: true, pixel_density: true, scatter_plot: true }),\n            colPaths = [], currx = [], curry = [], cell_w = [], cell_h = [],\n            scale = this.options.ScatCoef * ((this.gmaxbin) > 2000 ? 2000 / this.gmaxbin : 1),\n            di = handle.stepi, dj = handle.stepj,\n            rnd = new TRandom(handle.sumz);\n      let colindx, cmd1, cmd2, i, j, binz, cw, ch, factor = 1;\n\n      if (scale*handle.sumz < 1e5) {\n         // one can use direct drawing of scatter plot without any patterns\n\n         this.createv7AttMarker();\n\n         this.markeratt.resetPos();\n\n         let path = '', k, npix;\n         for (i = handle.i1; i < handle.i2; i += di) {\n            cw = handle.grx[i+di] - handle.grx[i];\n            for (j = handle.j1; j < handle.j2; j += dj) {\n               ch = handle.gry[j] - handle.gry[j+dj];\n               binz = histo.getBinContent(i + 1, j + 1);\n\n               npix = Math.round(scale*binz);\n               if (npix <= 0) continue;\n\n               for (k = 0; k < npix; ++k) {\n                  path += this.markeratt.create(\n                            Math.round(handle.grx[i] + cw * rnd.random()),\n                            Math.round(handle.gry[j+1] + ch * rnd.random()));\n               }\n            }\n         }\n\n         this.draw_g\n              .append('svg:path')\n              .attr('d', path)\n              .call(this.markeratt.func);\n\n         return handle;\n      }\n\n      // limit filling factor, do not try to produce as many points as filled area;\n      if (this.maxbin > 0.7) factor = 0.7/this.maxbin;\n\n      // now start build\n      for (i = handle.i1; i < handle.i2; i += di) {\n         for (j = handle.j1; j < handle.j2; j += dj) {\n            binz = histo.getBinContent(i + 1, j + 1);\n            if ((binz <= 0) || (binz < this.minbin)) continue;\n\n            cw = handle.grx[i+di] - handle.grx[i];\n            ch = handle.gry[j] - handle.gry[j+dj];\n            if (cw*ch <= 0) continue;\n\n            colindx = handle.palette.getContourIndex(binz/cw/ch);\n            if (colindx < 0) continue;\n\n            cmd1 = `M${handle.grx[i]},${handle.gry[j+dj]}`;\n            if (colPaths[colindx] === undefined) {\n               colPaths[colindx] = cmd1;\n               cell_w[colindx] = cw;\n               cell_h[colindx] = ch;\n            } else {\n               cmd2 = `m${handle.grx[i]-currx[colindx]},${handle.gry[j+dj]-curry[colindx]}`;\n               colPaths[colindx] += (cmd2.length < cmd1.length) ? cmd2 : cmd1;\n               cell_w[colindx] = Math.max(cell_w[colindx], cw);\n               cell_h[colindx] = Math.max(cell_h[colindx], ch);\n            }\n\n            currx[colindx] = handle.grx[i];\n            curry[colindx] = handle.gry[j+dj];\n\n            colPaths[colindx] += `v${ch}h${cw}v${-ch}z`;\n         }\n      }\n\n      const layer = this.getFrameSvg().selectChild('.main_layer');\n      let defs = layer.selectChild('def');\n      if (defs.empty() && (colPaths.length > 0))\n         defs = layer.insert('svg:defs', ':first-child');\n\n      this.createv7AttMarker();\n\n      const cntr = handle.palette.getContour();\n\n      for (colindx = 0; colindx < colPaths.length; ++colindx) {\n         if ((colPaths[colindx] !== undefined) && (colindx<cntr.length)) {\n            const pattern_id = (this.pad_name || 'canv') + `_scatter_${colindx}`;\n            let pattern = defs.selectChild(`#${pattern_id}`);\n            if (pattern.empty()) {\n               pattern = defs.append('svg:pattern')\n                             .attr('id', pattern_id)\n                             .attr('patternUnits', 'userSpaceOnUse');\n            } else\n               pattern.selectAll('*').remove();\n\n            let npix = Math.round(factor*cntr[colindx]*cell_w[colindx]*cell_h[colindx]);\n            if (npix < 1) npix = 1;\n\n            const arrx = new Float32Array(npix), arry = new Float32Array(npix);\n\n           if (npix === 1)\n              arrx[0] = arry[0] = 0.5;\n            else {\n              for (let n = 0; n < npix; ++n) {\n                 arrx[n] = rnd.random();\n                 arry[n] = rnd.random();\n              }\n           }\n\n           this.markeratt.resetPos();\n\n           let path = '';\n\n           for (let n = 0; n < npix; ++n)\n              path += this.markeratt.create(arrx[n] * cell_w[colindx], arry[n] * cell_h[colindx]);\n\n           pattern.attr('width', cell_w[colindx])\n                  .attr('height', cell_h[colindx])\n                  .append('svg:path')\n                  .attr('d', path)\n                  .call(this.markeratt.func);\n\n           this.draw_g\n               .append('svg:path')\n               .attr('scatter-index', colindx)\n               .style('fill', `url(#${pattern_id})`)\n               .attr('d', colPaths[colindx]);\n        }\n}\n\n      return handle;\n   }\n\n   /** @summary Draw RH2 bins in 2D mode */\n   async draw2DBins() {\n      if (!this.draw_content) {\n         this.removeG();\n         return false;\n      }\n\n      this.createHistDrawAttributes();\n\n      this.createG(true);\n\n      const pmain = this.getFramePainter(),\n            rect = pmain.getFrameRect(),\n            funcs = pmain.getGrFuncs(this.options.second_x, this.options.second_y);\n      let handle = null, pr = null;\n\n      if (this.options.Scat)\n         handle = this.drawBinsScatter();\n      else if (this.options.Color)\n         handle = this.drawBinsColor();\n      else if (this.options.Box)\n         handle = this.drawBinsBox();\n      else if (this.options.Arrow)\n         handle = this.drawBinsArrow();\n      else if (this.options.Contour > 0)\n         handle = this.drawBinsContour(funcs, rect.width, rect.height);\n\n      if (this.options.Text)\n         pr = this.drawBinsText(handle);\n\n      if (!handle && !pr)\n         handle = this.drawBinsColor();\n\n      if (!pr) pr = Promise.resolve(handle);\n\n      return pr.then(h => {\n         this.tt_handle = h;\n         return this;\n      });\n   }\n\n   /** @summary Provide text information (tooltips) for histogram bin */\n   getBinTooltips(i, j) {\n      const lines = [],\n            histo = this.getHisto();\n      let binz = histo.getBinContent(i+1, j+1),\n          di = 1, dj = 1;\n\n      if (this.isDisplayItem()) {\n         di = histo.stepx || 1;\n         dj = histo.stepy || 1;\n      }\n\n      lines.push(this.getObjectHint() || 'histo<2>',\n                 'x = ' + this.getAxisBinTip('x', i, di),\n                 'y = ' + this.getAxisBinTip('y', j, dj),\n                 `bin = ${i+1}, ${j+1}`);\n\n      if (histo.$baseh) binz -= histo.$baseh.getBinContent(i+1, j+1);\n\n      const lbl = 'entries = ' + ((di > 1) || (dj > 1) ? '~' : '');\n\n      if (binz === Math.round(binz))\n         lines.push(lbl + binz);\n      else\n         lines.push(lbl + floatToString(binz, gStyle.fStatFormat));\n\n      return lines;\n   }\n\n   /** @summary Provide text information (tooltips) for poly bin */\n   getPolyBinTooltips() {\n      // see how TH2Painter is implemented\n      return [];\n   }\n\n   /** @summary Process tooltip event */\n   processTooltipEvent(pnt) {\n      const histo = this.getHisto(),\n            h = this.tt_handle;\n      let ttrect = this.draw_g?.selectChild('.tooltip_bin');\n\n      if (!pnt || !this.draw_content || !this.draw_g || !h || this.options.Proj) {\n         ttrect?.remove();\n         return null;\n      }\n\n      if (h.poly) {\n         // process tooltips from TH2Poly - see TH2Painter\n         return null;\n      }\n\n      let i, j, binz = 0, colindx = null;\n\n      // search bins position\n      for (i = h.i1; i < h.i2; ++i)\n         if ((pnt.x>=h.grx[i]) && (pnt.x<=h.grx[i+1])) break;\n\n      for (j = h.j1; j < h.j2; ++j)\n         if ((pnt.y>=h.gry[j+1]) && (pnt.y<=h.gry[j])) break;\n\n      if ((i < h.i2) && (j < h.j2)) {\n         binz = histo.getBinContent(i+1, j+1);\n         if (this.is_projection)\n            colindx = 0; // just to avoid hide\n          else if (h.hide_only_zeros)\n            colindx = (binz === 0) && !this._show_empty_bins ? null : 0;\n          else {\n            colindx = h.palette.getContourIndex(binz);\n            if ((colindx === null) && (binz === 0) && this._show_empty_bins) colindx = 0;\n         }\n      }\n\n      if (colindx === null) {\n         ttrect.remove();\n         return null;\n      }\n\n      const res = { name: 'histo', title: histo.fTitle || 'title',\n                  x: pnt.x, y: pnt.y,\n                  color1: this.lineatt?.color ?? 'green',\n                  color2: this.fillatt?.getFillColorAlt('blue') ?? 'blue',\n                  lines: this.getBinTooltips(i, j), exact: true, menu: true };\n\n      if (this.options.Color)\n         res.color2 = h.palette.getColor(colindx);\n\n      if (pnt.disabled && !this.is_projection) {\n         ttrect.remove();\n         res.changed = true;\n      } else {\n         if (ttrect.empty()) {\n            ttrect = this.draw_g.append('svg:path')\n                                .attr('class', 'tooltip_bin')\n                                .style('pointer-events', 'none')\n                                .call(addHighlightStyle);\n         }\n\n         const pmain = this.getFramePainter();\n         let i1 = i, i2 = i+1,\n             j1 = j, j2 = j+1,\n             x1 = h.grx[i1], x2 = h.grx[i2],\n             y1 = h.gry[j2], y2 = h.gry[j1],\n             binid = i*10000 + j, path;\n\n         if (this.is_projection) {\n            const pwx = this.projection_widthX || 1, ddx = (pwx - 1) / 2;\n            if ((this.is_projection.indexOf('X')) >= 0 && (pwx > 1)) {\n               if (j2+ddx >= h.j2) {\n                  j2 = Math.min(Math.round(j2+ddx), h.j2);\n                  j1 = Math.max(j2-pwx, h.j1);\n               } else {\n                  j1 = Math.max(Math.round(j1-ddx), h.j1);\n                  j2 = Math.min(j1+pwx, h.j2);\n               }\n            }\n            const pwy = this.projection_widthY || 1, ddy = (pwy - 1) / 2;\n            if ((this.is_projection.indexOf('Y')) >= 0 && (pwy > 1)) {\n               if (i2+ddy >= h.i2) {\n                  i2 = Math.min(Math.round(i2+ddy), h.i2);\n                  i1 = Math.max(i2-pwy, h.i1);\n               } else {\n                  i1 = Math.max(Math.round(i1-ddy), h.i1);\n                  i2 = Math.min(i1+pwy, h.i2);\n               }\n            }\n         }\n\n         if (this.is_projection === 'X') {\n            x1 = 0; x2 = pmain.getFrameWidth();\n            y1 = h.gry[j2]; y2 = h.gry[j1];\n            binid = j1*777 + j2*333;\n         } else if (this.is_projection === 'Y') {\n            y1 = 0; y2 = pmain.getFrameHeight();\n            x1 = h.grx[i1]; x2 = h.grx[i2];\n            binid = i1*777 + i2*333;\n         } else if (this.is_projection === 'XY') {\n            y1 = h.gry[j2]; y2 = h.gry[j1];\n            x1 = h.grx[i1]; x2 = h.grx[i2];\n            binid = i1*789 + i2*653 + j1*12345 + j2*654321;\n            path = `M${x1},0H${x2}V${y1}H${pmain.getFrameWidth()}V${y2}H${x2}V${pmain.getFrameHeight()}H${x1}V${y2}H0V${y1}H${x1}Z`;\n         }\n\n         res.changed = ttrect.property('current_bin') !== binid;\n\n         if (res.changed) {\n            ttrect.attr('d', path || `M${x1},${y1}H${x2}V${y2}H${x1}Z`)\n                  .style('opacity', '0.7')\n                  .property('current_bin', binid);\n         }\n\n         if (this.is_projection && res.changed)\n            this.redrawProjection(i1, i2, j1, j2);\n      }\n\n      if (res.changed) {\n         res.user_info = { obj: histo, name: 'histo',\n                           bin: histo.getBin(i+1, j+1), cont: binz, binx: i+1, biny: j+1,\n                           grx: pnt.x, gry: pnt.y };\n      }\n\n      return res;\n   }\n\n   /** @summary Checks if it makes sense to zoom inside specified axis range */\n   canZoomInside(axis, min, max) {\n      if (axis === 'z') return true;\n      const obj = this.getAxis(axis);\n      return obj.FindBin(max, 0.5) - obj.FindBin(min, 0) > 1;\n   }\n\n   /** @summary Performs 2D drawing of histogram\n     * @return {Promise} when ready */\n   async draw2D(reason) {\n      this.clear3DScene();\n\n      return this.drawFrameAxes().then(res => {\n        return res ? this.drawingBins(reason) : false;\n      }).then(res => {\n         if (res) return this.draw2DBins().then(() => this.addInteractivity());\n      }).then(() => this);\n   }\n\n   /** @summary Performs 3D drawing of histogram\n     * @return {Promise} when ready */\n   async draw3D(reason) {\n      console.log('3D drawing is disabled, load ./hist/RH1Painter.mjs');\n      return this.draw2D(reason);\n   }\n\n   /** @summary Call drawing function depending from 3D mode */\n   async callDrawFunc(reason) {\n      const main = this.getFramePainter();\n\n      if (main && (main.mode3d !== this.options.Mode3D) && !this.isMainPainter())\n         this.options.Mode3D = main.mode3d;\n\n      return this.options.Mode3D ? this.draw3D(reason) : this.draw2D(reason);\n   }\n\n   /** @summary Redraw histogram */\n   async redraw(reason) {\n      return this.callDrawFunc(reason);\n   }\n\n   /** @summary Draw histogram using painter instance\n     * @private */\n   static async _draw(painter /* , opt */) {\n      return ensureRCanvas(painter).then(() => {\n         painter.setAsMainPainter();\n\n         painter.options = { Hist: false, Error: false, Zero: false, Mark: false,\n                             Line: false, Fill: false, Lego: 0, Surf: 0,\n                             Text: true, TextAngle: 0, TextKind: '',\n                             BaseLine: false, Mode3D: false, AutoColor: 0,\n                             Color: false, Scat: false, ScatCoef: 1, Box: false, BoxStyle: 0, Arrow: false, Contour: 0, Proj: 0,\n                             BarOffset: 0, BarWidth: 1, minimum: kNoZoom, maximum: kNoZoom,\n                             FrontBox: false, BackBox: false };\n\n         const kind = painter.v7EvalAttr('kind', ''),\n               sub = painter.v7EvalAttr('sub', 0),\n               o = painter.options;\n\n         o.Text = painter.v7EvalAttr('drawtext', false);\n\n         switch (kind) {\n            case 'lego': o.Lego = sub > 0 ? 10+sub : 12; o.Mode3D = true; break;\n            case 'surf': o.Surf = sub > 0 ? 10+sub : 1; o.Mode3D = true; break;\n            case 'box': o.Box = true; o.BoxStyle = 10 + sub; break;\n            case 'err': o.Error = true; o.Mode3D = true; break;\n            case 'cont': o.Contour = sub > 0 ? 10+sub : 1; break;\n            case 'arr': o.Arrow = true; break;\n            case 'scat': o.Scat = true; break;\n            case 'col': o.Color = true; break;\n            default: if (!o.Text) o.Color = true;\n         }\n\n         // here we deciding how histogram will look like and how will be shown\n         // painter.decodeOptions(opt);\n\n         painter._show_empty_bins = false;\n\n         painter.scanContent();\n\n         return painter.callDrawFunc();\n      });\n   }\n\n   /** @summary draw RH2 object */\n   static async draw(dom, obj, opt) {\n      // create painter and add it to canvas\n      return RH2Painter._draw(new RH2Painter(dom, obj), opt);\n   }\n\n} //  class RH2Painter\n\nexport { RH2Painter };\n","import { settings, gStyle, kNoZoom } from '../core.mjs';\nimport { RH2Painter as RH2Painter2D } from '../hist2d/RH2Painter.mjs';\nimport { RAxisPainter } from '../gpad/RAxisPainter.mjs';\nimport { assignFrame3DMethods, drawBinsLego, drawBinsError3D, drawBinsContour3D, drawBinsSurf3D } from './hist3d.mjs';\n\n\nclass RH2Painter extends RH2Painter2D {\n\n   /** Draw histogram bins in 3D, using provided draw options */\n   draw3DBins() {\n      if (!this.draw_content) return;\n\n      if (this.options.Surf)\n         return drawBinsSurf3D(this, true);\n\n      if (this.options.Error)\n         return drawBinsError3D(this, true);\n\n      if (this.options.Contour)\n         return drawBinsContour3D(this, true, true);\n\n      drawBinsLego(this, true);\n      this.updatePaletteDraw();\n   }\n\n   draw3D(reason) {\n      this.mode3d = true;\n\n      const main = this.getFramePainter(), // who makes axis drawing\n            is_main = this.isMainPainter(); // is main histogram\n      let pr = Promise.resolve(this);\n\n      if (reason === 'resize') {\n         if (is_main && main.resize3D()) main.render3D();\n         return pr;\n      }\n\n      let zmult = 1 + 2*gStyle.fHistTopMargin;\n\n      this.zmin = main.logz ? this.gminposbin * 0.3 : this.gminbin;\n      this.zmax = this.gmaxbin;\n      if (this.options.minimum !== kNoZoom) this.zmin = this.options.minimum;\n      if (this.options.maximum !== kNoZoom) { this.zmax = this.options.maximum; zmult = 1; }\n      if (main.logz && (this.zmin <= 0)) this.zmin = this.zmax * 1e-5;\n\n      this.deleteAttr();\n\n      if (is_main) {\n         assignFrame3DMethods(main);\n         pr = main.create3DScene(this.options.Render3D).then(() => {\n            main.setAxesRanges(this.getAxis('x'), this.xmin, this.xmax, this.getAxis('y'), this.ymin, this.ymax, null, this.zmin, this.zmax);\n            main.set3DOptions(this.options);\n            main.drawXYZ(main.toplevel, RAxisPainter, { zmult, zoom: settings.Zooming, ndim: 2, draw: true, v7: true });\n         });\n      }\n\n      if (!main.mode3d)\n         return pr;\n\n      return pr.then(() => this.drawingBins(reason)).then(() => {\n         // called when bins received from server, must be reentrant\n         const main = this.getFramePainter();\n\n         this.draw3DBins();\n         main.render3D();\n         main.addKeysHandler();\n\n         return this;\n      });\n   }\n\n      /** @summary draw RH2 object */\n   static async draw(dom, obj, opt) {\n      // create painter and add it to canvas\n      return RH2Painter._draw(new RH2Painter(dom, obj), opt);\n   }\n\n} // class RH2Painter\n\nexport { RH2Painter };\n"],"x_google_ignoreList":[0,1]}