"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[306],{6306:(w,y,o)=>{o.r(y),o.d(y,{TEfficiencyPainter:()=>E});var H=o(5774),l=o(4186),A=o(2481),P=o(825),M=o(9754),x=o(1631),C=o(1085);const T=(0,l.BIT)(14),L=(0,l.BIT)(15),B=(0,l.BIT)(17),D=(0,l.BIT)(18),u=(_,t)=>_.fBeta_bin_params.length>t?_.fBeta_bin_params[t].first:_.fBeta_alpha,m=(_,t)=>_.fBeta_bin_params.length>t?_.fBeta_bin_params[t].second:_.fBeta_beta;class E extends A.JW{getEfficiency(t,a){const r=t.fTotalHistogram.fArray[a],f=t.fPassedHistogram.fArray[a];if(t.TestBit(T)){const e=t.TestBit(B)?u(t,a):t.fBeta_alpha,n=t.TestBit(B)?m(t,a):t.fBeta_beta;let c,h;if(t.TestBit(D)){const d=r,p=t.fTotalHistogram.fSumw2?t.fTotalHistogram.fSumw2[a]:Math.abs(r);if(p<=0)return f/d;const O=d/p;c=f*O+e,h=(d-f)*O+n}else c=f+e,h=r-f+n;return t.TestBit(L)?((e,n)=>{if(e<=0||n<=0)return 0;if(e<=1||n<=1){if(e<n)return 0;if(e>n)return 1;if(e===n)return.5}return(e-1)/(e+n-2)})(c,h):((e,n)=>e<=0||n<=0?0:e/(e+n))(c,h)}return r?f/r:0}getEfficiencyErrorLow(t,a,i){const s=t.fTotalHistogram.fArray[a],r=t.fPassedHistogram.fArray[a];let f=0,e=0;return t.TestBit(T)&&(f=t.TestBit(B)?u(t,a):t.fBeta_alpha,e=t.TestBit(B)?m(t,a):t.fBeta_beta),i-this.fBoundary(s,r,t.fConfLevel,!1,f,e)}getEfficiencyErrorUp(t,a,i){const s=t.fTotalHistogram.fArray[a],r=t.fPassedHistogram.fArray[a];let f=0,e=0;return t.TestBit(T)&&(f=t.TestBit(B)?u(t,a):t.fBeta_alpha,e=t.TestBit(B)?m(t,a):t.fBeta_beta),this.fBoundary(s,r,t.fConfLevel,!0,f,e)-i}copyAttributes(t,a){["fLineColor","fLineStyle","fLineWidth","fFillColor","fFillStyle","fMarkerColor","fMarkerStyle","fMarkerSize"].forEach(i=>{t[i]=a[i]})}createGraph(){const t=(0,l.create)(P.clTGraphAsymmErrors);return t.fName="eff_graph",t}createHisto(t){const s=(0,l.createHistogram)(l.clTH2F,t.fTotalHistogram.fXaxis.fNbins,t.fTotalHistogram.fYaxis.fNbins);return Object.assign(s.fXaxis,t.fTotalHistogram.fXaxis),Object.assign(s.fYaxis,t.fTotalHistogram.fYaxis),s.fName="eff_histo",s}fillGraph(t,a){const i=this.getObject(),s=i.fTotalHistogram.fXaxis,r=s.fNbins,f=a.indexOf("e0")>=0;for(let e=0,n=0;e<r;++e){if(!f&&0===i.fTotalHistogram.getBinContent(e+1))continue;const c=this.getEfficiency(i,e+1);t.fX[n]=s.GetBinCenter(e+1),t.fY[n]=c,t.fEXlow[n]=s.GetBinCenter(e+1)-s.GetBinLowEdge(e+1),t.fEXhigh[n]=s.GetBinLowEdge(e+2)-s.GetBinCenter(e+1),t.fEYlow[n]=this.getEfficiencyErrorLow(i,e+1,c),t.fEYhigh[n]=this.getEfficiencyErrorUp(i,e+1,c),t.fNpoints=++n}t.fTitle=i.fTitle,this.copyAttributes(t,i)}fillHisto(t){const a=this.getObject(),i=t.fXaxis.fNbins,s=t.fYaxis.fNbins;for(let r=0;r<i+2;++r)for(let f=0;f<s+2;++f){const e=t.getBin(r,f),n=this.getEfficiency(a,e);t.fArray[e]=n}t.fTitle=a.fTitle,t.fBits=t.fBits|l.kNoStats,this.copyAttributes(t,a)}drawFunction(t){const a=this.getObject();return!a?.fFunctions||t>=a.fFunctions.arr.length?this:M.TF1Painter.draw(this.getDom(),a.fFunctions.arr[t],a.fFunctions.opt[t]).then(()=>this.drawFunction(t+1))}static draw(t,a,i){return(0,H.A)(function*(){if(!a||!a.fTotalHistogram)return null;(!i||!(0,l.isStr)(i))&&(i=""),i=i.toLowerCase();let s=0;if(0===a.fTotalHistogram._typename.indexOf(l.clTH1))s=1;else{if(0!==a.fTotalHistogram._typename.indexOf(l.clTH2))return null;s=2}const r=new E(t,a);let f;if(r.ndim=s,r.fBoundary=(0,C.getTEfficiencyBoundaryFunc)(a.fStatisticOption,a.TestBit(T)),1===s){i||(i="ap"),i.indexOf("same")<0&&i.indexOf("a")<0&&(i+="a"),i.indexOf("p")<0&&(i+="p");const e=r.createGraph(a);r.fillGraph(e,i),f=P.TGraphPainter.draw(t,e,i)}else{i||(i="col");const e=r.createHisto(a);r.fillHisto(e,i),f=x.AJ.draw(t,e,i)}return f.then(()=>(r.addToPadPrimitives(),r.drawFunction(0)))})()}}}}]);
//# sourceMappingURL=306.26144549b12b181f.js.map